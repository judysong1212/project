<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="Psnl0115">
	
	<typeAlias alias="hashMap" type="java.util.HashMap"/>
    <typeAlias alias="list" type="java.util.List"/>
    <typeAlias alias="int" type="java.lang.Integer"/>
    <typeAlias alias="string" type="java.lang.String"/>
	<typeAlias alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias alias="infcPsnl0115Dto" type="com.app.exterms.personal.client.dto.InfcPsnl0115DTO"/>
	<typeAlias alias="infcPsnl0115SerarchVO" type="com.app.exterms.personal.server.vo.InfcPsnl0115DefaultVO"/>
	
	<resultMap id="infcPsnl0115" class="com.app.exterms.personal.server.vo.InfcPsnl0115VO">
		<result property="dpobCd" column="DPOB_CD" columnIndex="1"/>
		<result property="systemkey" column="SYSTEMKEY" columnIndex="2"/>
		<result property="famySeilNum" column="FAMY_SEIL_NUM" columnIndex="3"/>
		<result property="famyRelaDivCd" column="FAMY_RELA_DIV_CD" columnIndex="4"/>
		<result property="famyNm" column="FAMY_NM" columnIndex="5"/>
		<result property="famyResnRegnNum" column="FAMY_RESN_REGN_NUM" columnIndex="6"/>
		<result property="yoobhMnthDay" column="YOOBH_MNTH_DAY" columnIndex="7"/>
		<result property="sclcDivCd" column="SCLC_DIV_CD" columnIndex="8"/>
		<result property="acadAbtyDivCd" column="ACAD_ABTY_DIV_CD" columnIndex="9"/>
		<result property="schlNm" column="SCHL_NM" columnIndex="10"/>
		<result property="crrCd" column="CRR_CD" columnIndex="11"/>
		<result property="wkOfcNm" column="WK_OFC_NM" columnIndex="12"/>
		<result property="inbyNm" column="INBY_NM" columnIndex="13"/>
		<result property="frgnrYn" column="FRGNR_YN" columnIndex="14"/>
		<result property="dabtyDivCd" column="DABTY_DIV_CD" columnIndex="15"/>
		<result property="dabtyGrdeCd" column="DABTY_GRDE_CD" columnIndex="16"/>
		<result property="famyPartNoteCtnt" column="FAMY_PART_NOTE_CTNT" columnIndex="17"/>
		<result property="natnCd" column="NATN_CD" columnIndex="18"/>
		<result property="famyChbttYn" column="FAMY_CHBTT_YN" columnIndex="19"/>
		<result property="famyAllwYn" column="FAMY_ALLW_YN" columnIndex="20"/>
		<result property="schlExpnAdmclYn" column="SCHL_EXPN_ADMCL_YN" columnIndex="21"/>
		<result property="yrtxYn" column="YRTX_YN" columnIndex="22"/>
		<result property="kybdr" column="KYBDR" columnIndex="23"/>
		<result property="inptDt" column="INPT_DT" columnIndex="24"/>
		<result property="inptAddr" column="INPT_ADDR" columnIndex="25"/>
		<result property="ismt" column="ISMT" columnIndex="26"/>
		<result property="revnDt" column="REVN_DT" columnIndex="27"/>
		<result property="revnAddr" column="REVN_ADDR" columnIndex="28"/>
	</resultMap>
	
	
	<insert id="infcPsnl0115DAO.insertPsnl0115" parameterClass="infcPsnl0115Dto">
		<![CDATA[
			INSERT INTO PSNL0115 
				( DPOB_CD
				  , SYSTEMKEY
				  , FAMY_SEIL_NUM
				  , FAMY_RELA_DIV_CD
				  , FAMY_NM
				  , FAMY_RESN_REGN_NUM
				  , YOOBH_MNTH_DAY
				  , SCLC_DIV_CD
				  , ACAD_ABTY_DIV_CD
				  , SCHL_NM
				  , CRR_CD
				  , WK_OFC_NM
				  , INBY_NM
				  , FRGNR_YN
				  , DABTY_DIV_CD
				  , DABTY_GRDE_CD
				  , FAMY_PART_NOTE_CTNT
				  , NATN_CD
				  , FAMY_CHBTT_YN
				  , FAMY_ALLW_YN
				  , SCHL_EXPN_ADMCL_YN
				  , YRTX_YN
				  , KYBDR
				  , INPT_DT
				  , INPT_ADDR
				  , ISMT
				  , REVN_DT
				  , REVN_ADDR )
			VALUES ( #dpobCd#
				  , #systemkey#
				  , (select NVL(MAX(FAMY_SEIL_NUM)+1,1) from PSNL0115 WHERE DPOB_CD = #dpobCd# AND SYSTEMKEY = #systemkey#)
				  , #famyRelaDivCd#
				  , #famyNm#
				  , replace(#famyResnRegnNum#, '-', '')
				  , #yoobhMnthDay#
				  , #sclcDivCd#
				  , #acadAbtyDivCd#
				  , #schlNm#
				  , #crrCd#
				  , #wkOfcNm#
				  , #inbyNm#
				  , #frgnrYn#
				  , #dabtyDivCd#
				  , #dabtyGrdeCd#
				  , #famyPartNoteCtnt#
				  , #natnCd#
				  , #famyChbttYn#
				  , #famyAllwYn#
				  , #schlExpnAdmclYn#
				  , #yrtxYn#
				  , #ismt#
				  , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				  , #revnAddr#
				  , #ismt#
				  , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				  , #revnAddr# )
		]]>
	</insert>
	
	<update id="infcPsnl0115DAO.updatePsnl0115" parameterClass="infcPsnl0115Dto">
		
			UPDATE PSNL0115
			SET REVN_DT= TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				<isNotNull property="famyRelaDivCd"><isNotEmpty property="famyRelaDivCd">, FAMY_RELA_DIV_CD=#famyRelaDivCd#</isNotEmpty></isNotNull>
				<isNotNull property="famyNm"><isNotEmpty property="famyNm">, FAMY_NM=#famyNm#</isNotEmpty></isNotNull>
				<isNotNull property="famyResnRegnNum"><isNotEmpty property="famyResnRegnNum">, FAMY_RESN_REGN_NUM= replace(#famyResnRegnNum#, '-', '')</isNotEmpty></isNotNull>
				<isNotNull property="yoobhMnthDay"><isNotEmpty property="yoobhMnthDay">, YOOBH_MNTH_DAY=#yoobhMnthDay#</isNotEmpty></isNotNull>
				<isNotNull property="sclcDivCd"><isNotEmpty property="sclcDivCd">, SCLC_DIV_CD=#sclcDivCd#</isNotEmpty></isNotNull>
				<isNotNull property="acadAbtyDivCd"><isNotEmpty property="acadAbtyDivCd">, ACAD_ABTY_DIV_CD=#acadAbtyDivCd#</isNotEmpty></isNotNull>
				<isNotNull property="schlNm"><isNotEmpty property="schlNm">, SCHL_NM=#schlNm#</isNotEmpty></isNotNull>
				<isNotNull property="crrCd"><isNotEmpty property="crrCd">, CRR_CD=#crrCd#</isNotEmpty></isNotNull>
				<isNotNull property="wkOfcNm"><isNotEmpty property="wkOfcNm">, WK_OFC_NM=#wkOfcNm#</isNotEmpty></isNotNull>
				<isNotNull property="inbyNm"><isNotEmpty property="inbyNm">, INBY_NM=#inbyNm#</isNotEmpty></isNotNull>
				<isNotNull property="frgnrYn"><isNotEmpty property="frgnrYn">, FRGNR_YN=#frgnrYn#</isNotEmpty></isNotNull>
				<isNotNull property="dabtyDivCd"><isNotEmpty property="dabtyDivCd">, DABTY_DIV_CD=#dabtyDivCd#</isNotEmpty></isNotNull>
				<isNotNull property="dabtyGrdeCd"><isNotEmpty property="dabtyGrdeCd">, DABTY_GRDE_CD=#dabtyGrdeCd#</isNotEmpty></isNotNull>
				<isNotNull property="famyPartNoteCtnt"><isNotEmpty property="famyPartNoteCtnt">, FAMY_PART_NOTE_CTNT=#famyPartNoteCtnt#</isNotEmpty></isNotNull>
				<isNotNull property="natnCd"><isNotEmpty property="natnCd">, NATN_CD=#natnCd#</isNotEmpty></isNotNull>
				<isNotNull property="famyChbttYn"><isNotEmpty property="famyChbttYn">, FAMY_CHBTT_YN=#famyChbttYn#</isNotEmpty></isNotNull>
				<isNotNull property="famyAllwYn"><isNotEmpty property="famyAllwYn">, FAMY_ALLW_YN=#famyAllwYn#</isNotEmpty></isNotNull>
				<isNotNull property="schlExpnAdmclYn"><isNotEmpty property="schlExpnAdmclYn">, SCHL_EXPN_ADMCL_YN=#schlExpnAdmclYn#</isNotEmpty></isNotNull>
				<isNotNull property="yrtxYn"><isNotEmpty property="yrtxYn">, YRTX_YN=#yrtxYn#</isNotEmpty></isNotNull>
				<isNotNull property="ismt"><isNotEmpty property="ismt">, ISMT=#ismt#</isNotEmpty></isNotNull>
				<isNotNull property="revnAddr"><isNotEmpty property="revnAddr">, REVN_ADDR=#revnAddr#</isNotEmpty></isNotNull>
			WHERE DPOB_CD=#dpobCd#
			AND SYSTEMKEY=#systemkey#
			AND FAMY_SEIL_NUM=#famySeilNum#
	
	</update>
	
	<delete id="infcPsnl0115DAO.deletePsnl0115" parameterClass="infcPsnl0115Dto">
		<![CDATA[
			DELETE FROM PSNL0115 
						WHERE DPOB_CD=#dpobCd#
								AND SYSTEMKEY=#systemkey#
								AND FAMY_SEIL_NUM=#famySeilNum#
				]]>
	</delete>
	
	<select id="infcPsnl0115DAO.selectPsnl0115" resultClass="egovMap" parameterClass="hashMap">
		<![CDATA[
			SELECT
				DPOB_CD
				, SYSTEMKEY
				, FAMY_SEIL_NUM
				, FAMY_RELA_DIV_CD
				, FAMY_NM
				, SUBSTR(FAMY_RESN_REGN_NUM,1,6)||'-'||SUBSTR(FAMY_RESN_REGN_NUM,-7) as FAMY_RESN_REGN_NUM
				, YOOBH_MNTH_DAY
				, SCLC_DIV_CD
				, ACAD_ABTY_DIV_CD
				, SCHL_NM
				, CRR_CD
				, WK_OFC_NM
				, INBY_NM
				, FRGNR_YN
				, DABTY_DIV_CD
				, DABTY_GRDE_CD
				, FAMY_PART_NOTE_CTNT
				, NATN_CD
				, FAMY_CHBTT_YN
				, FAMY_ALLW_YN
				, SCHL_EXPN_ADMCL_YN
				, YRTX_YN
				, KYBDR
				, INPT_DT
				, INPT_ADDR
				, ISMT
				, REVN_DT
				, REVN_ADDR
			FROM PSNL0115
						WHERE DPOB_CD=#dpobCd#
								AND SYSTEMKEY=#systemkey#
								
				]]>
	<isNotNull property="famySeilNum">
	    <isNotEmpty property="famySeilNum">
	        AND FAMY_SEIL_NUM=#famySeilNum#
	    </isNotEmpty>
	</isNotNull>				
	</select>
	

</sqlMap>
