<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="PkgInfcYe169010_2023">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="infcPkgYe169010Srh_2023_VO" type="com.app.smrmf.infc.yearendtax.server.vo.yeta2023.InfcPkgYe169010Srh_2023_VO"/>
	
	<resultMap id="infcPkgYe169010_2023" class="com.app.smrmf.infc.yearendtax.server.vo.yeta2023.InfcPkgYe169010_2023_VO">
		<result property="dpobCd" column="DPOB_CD" columnIndex="1"/>
		<result property="yrtxBlggYr" column="YRTX_BLGG_YR" columnIndex="2"/>
		<result property="clutSeptCd" column="CLUT_SEPT_CD" columnIndex="3"/>
		<result property="systemkey" column="SYSTEMKEY" columnIndex="4"/>
		<result property="yeta00c6" column="YETA_00C6" columnIndex="5"/>
		<result property="yeta00c9" column="YETA_00C9" columnIndex="6"/>
		<result property="yeta0c9a" column="YETA_0C9A" columnIndex="7"/>
		<result property="yeta0c15" column="YETA_0C15" columnIndex="8"/>
		<result property="yeta0c22" column="YETA_0C22" columnIndex="9"/>
		<result property="yeta0c23" column="YETA_0C23" columnIndex="10"/>
		<result property="yeta0c24" column="YETA_0C24" columnIndex="11"/>
		<result property="yeta0c25" column="YETA_0C25" columnIndex="12"/>
		<result property="yeta0c26" column="YETA_0C26" columnIndex="13"/>
		<result property="yeta0c27" column="YETA_0C27" columnIndex="14"/>
		<result property="yeta0c29" column="YETA_0C29" columnIndex="15"/>
		<result property="yetaC30G01" column="YETA_C30_G01" columnIndex="16"/>
		<result property="yetaC31H01" column="YETA_C31_H01" columnIndex="17"/>
		<result property="yetaC32H05" column="YETA_C32_H05" columnIndex="18"/>
		<result property="yetaC33H06" column="YETA_C33_H06" columnIndex="19"/>
		<result property="yetaC34H07" column="YETA_C34_H07" columnIndex="20"/>
		<result property="yetaC35H08" column="YETA_C35_H08" columnIndex="21"/>
		<result property="yetaC36H09" column="YETA_C36_H09" columnIndex="22"/>
		<result property="yetaC37H10" column="YETA_C37_H10" columnIndex="23"/>
		<result property="yetaC38H14" column="YETA_C38_H14" columnIndex="24"/>
		<result property="yetaC39H15" column="YETA_C39_H15" columnIndex="25"/>
		<result property="yetaC40H11" column="YETA_C40_H11" columnIndex="26"/>
		<result property="yetaC41H12" column="YETA_C41_H12" columnIndex="27"/>
		<result property="yetaC42H13" column="YETA_C42_H13" columnIndex="28"/>
		<result property="yetaC43H16" column="YETA_C43_H16" columnIndex="29"/>
		<result property="yetaC44I01" column="YETA_C44_I01" columnIndex="30"/>
		<result property="yetaC45K01" column="YETA_C45_K01" columnIndex="31"/>
		<result property="yetaC46M01" column="YETA_C46_M01" columnIndex="32"/>
		<result property="yetaC47M02" column="YETA_C47_M02" columnIndex="33"/>
		<result property="yetaC48M03" column="YETA_C48_M03" columnIndex="34"/>
		<result property="yetaC49O01" column="YETA_C49_O01" columnIndex="35"/>
		<result property="yetaC50Q01" column="YETA_C50_Q01" columnIndex="36"/>
		<result property="yetaC51R10" column="YETA_C51_R10" columnIndex="37"/>
		<result property="yetaC52R11" column="YETA_C52_R11" columnIndex="38"/>
		<result property="yetaC53S01" column="YETA_C53_S01" columnIndex="39"/>
		<result property="yetaC54T01" column="YETA_C54_T01" columnIndex="40"/>
		<result property="yetaC55Y02" column="YETA_C55_Y02" columnIndex="41"/>
		<result property="yetaC56Y03" column="YETA_C56_Y03" columnIndex="42"/>
		<result property="yetaC56aY04" column="YETA_C56A_Y04" columnIndex="43"/>
		<result property="yetaC56Y21" column="YETA_C56_Y21" columnIndex="44"/>
		<result property="yetaC57Y22" column="YETA_C57_Y22" columnIndex="45"/>
		<result property="yetaC58T10" column="YETA_C58_T10" columnIndex="46"/>
		<result property="yetaC58aT11" column="YETA_C58A_T11" columnIndex="47"/>
		<result property="yetaC58bT12" column="YETA_C58B_T12" columnIndex="48"/>
		<result property="yetaC59T20" column="YETA_C59_T20" columnIndex="49"/>
		<result property="yeta0c60" column="YETA_0C60" columnIndex="50"/>
		<result property="yeta0c61" column="YETA_0C61" columnIndex="51"/>
		<result property="yeta0c63" column="YETA_0C63" columnIndex="52"/>
		<result property="yeta0c64" column="YETA_0C64" columnIndex="53"/>
		<result property="yeta0c65" column="YETA_0C65" columnIndex="54"/>
		<result property="yeta0c66" column="YETA_0C66" columnIndex="55"/>
		<result property="yeta0c67" column="YETA_0C67" columnIndex="56"/>
		<result property="yeta0c68" column="YETA_0C68" columnIndex="57"/>
		<result property="yeta0c69" column="YETA_0C69" columnIndex="58"/>
		<result property="yeta0c70" column="YETA_0C70" columnIndex="59"/>
		<result property="yeta0c71" column="YETA_0C71" columnIndex="60"/>
		<result property="yeta0c72" column="YETA_0C72" columnIndex="61"/>
		<result property="yeta0c73" column="YETA_0C73" columnIndex="62"/>
		<result property="yeta0c74" column="YETA_0C74" columnIndex="63"/>
		<result property="yeta0c75" column="YETA_0C75" columnIndex="64"/>
		<result property="yeta0c76" column="YETA_0C76" columnIndex="65"/>
		<result property="yeta0c77" column="YETA_0C77" columnIndex="66"/>
		<result property="yeta0c78" column="YETA_0C78" columnIndex="67"/>
		<result property="yeta0c79" column="YETA_0C79" columnIndex="68"/>
		<result property="yeta0c80" column="YETA_0C80" columnIndex="69"/>
		<result property="yeta0c81" column="YETA_0C81" columnIndex="70"/>
		<result property="yeta0c82" column="YETA_0C82" columnIndex="71"/>
		<result property="yeta0c83" column="YETA_0C83" columnIndex="72"/>
		<result property="yeta0c84" column="YETA_0C84" columnIndex="73"/>
		<result property="yeta0c85" column="YETA_0C85" columnIndex="74"/>
		<result property="yeta0c86" column="YETA_0C86" columnIndex="75"/>
		<result property="yeta0c87" column="YETA_0C87" columnIndex="76"/>
		<result property="yeta0c88" column="YETA_0C88" columnIndex="77"/>
		<result property="yeta0c89" column="YETA_0C89" columnIndex="78"/>
		<result property="yeta0c90" column="YETA_0C90" columnIndex="79"/>
		<result property="yeta0c91" column="YETA_0C91" columnIndex="80"/>
		<result property="yeta0c92" column="YETA_0C92" columnIndex="81"/>
		<result property="yeta0c93" column="YETA_0C93" columnIndex="82"/>
		<result property="yeta0c94" column="YETA_0C94" columnIndex="83"/>
		<result property="yeta0c96" column="YETA_0C96" columnIndex="84"/>
		<result property="yeta0c97" column="YETA_0C97" columnIndex="85"/>
		<result property="yeta0c98" column="YETA_0C98" columnIndex="86"/>
		<result property="yeta0c99" column="YETA_0C99" columnIndex="87"/>
		<result property="yetaC100" column="YETA_C100" columnIndex="88"/>
		<result property="yetaC101" column="YETA_C101" columnIndex="89"/>
		<result property="yetaC102" column="YETA_C102" columnIndex="90"/>
		<result property="yetaC103" column="YETA_C103" columnIndex="91"/>
		<result property="yetaC104" column="YETA_C104" columnIndex="92"/>
		<result property="yetaC105" column="YETA_C105" columnIndex="93"/>
		<result property="yetaC107" column="YETA_C107" columnIndex="94"/>
		<result property="yetaC108" column="YETA_C108" columnIndex="95"/>
		<result property="yetaC109" column="YETA_C109" columnIndex="96"/>
		<result property="yetaC110" column="YETA_C110" columnIndex="97"/>
		<result property="yetaC111" column="YETA_C111" columnIndex="98"/>
		<result property="yetaC112" column="YETA_C112" columnIndex="99"/>
		<result property="yetaC113" column="YETA_C113" columnIndex="100"/>
		<result property="yetaC114" column="YETA_C114" columnIndex="101"/>
		<result property="yetaC115" column="YETA_C115" columnIndex="102"/>
		<result property="yetaC116" column="YETA_C116" columnIndex="103"/>
		<result property="yetaC117" column="YETA_C117" columnIndex="104"/>
		<result property="yetaC119" column="YETA_C119" columnIndex="105"/>
		<result property="yetaC120" column="YETA_C120" columnIndex="106"/>
		<result property="yetaC121" column="YETA_C121" columnIndex="107"/>
		<result property="yetaC122" column="YETA_C122" columnIndex="108"/>
		<result property="yetaC123" column="YETA_C123" columnIndex="109"/>
		<result property="yetaC124" column="YETA_C124" columnIndex="110"/>
		<result property="yetaC125" column="YETA_C125" columnIndex="111"/>
		<result property="yetaC126" column="YETA_C126" columnIndex="112"/>
		<result property="yetaC127" column="YETA_C127" columnIndex="113"/>
		<result property="yetaC128" column="YETA_C128" columnIndex="114"/>
		<result property="yetaC129" column="YETA_C129" columnIndex="115"/>
		<result property="yetaC130" column="YETA_C130" columnIndex="116"/>
		<result property="yetaC131" column="YETA_C131" columnIndex="117"/>
		<result property="yetaC132" column="YETA_C132" columnIndex="118"/>
		<result property="yetaC133" column="YETA_C133" columnIndex="119"/>
		<result property="yetaC134" column="YETA_C134" columnIndex="120"/>
		<result property="yetaC135" column="YETA_C135" columnIndex="121"/>
		<result property="yetaC136" column="YETA_C136" columnIndex="122"/>
		<result property="yetaC137" column="YETA_C137" columnIndex="123"/>
		<result property="yetaC138" column="YETA_C138" columnIndex="124"/>
		<result property="yetaC139" column="YETA_C139" columnIndex="125"/>
		<result property="yetaC140" column="YETA_C140" columnIndex="126"/>
		<result property="yetaC141" column="YETA_C141" columnIndex="127"/>
		<result property="yetaC142" column="YETA_C142" columnIndex="128"/>
		<result property="yetaC143" column="YETA_C143" columnIndex="129"/>
		<result property="yetaC144" column="YETA_C144" columnIndex="130"/>
		<result property="yetaC145" column="YETA_C145" columnIndex="131"/>
		<result property="yetaC146" column="YETA_C146" columnIndex="132"/>
		<result property="yetaC147" column="YETA_C147" columnIndex="133"/>
		<result property="yetaC148" column="YETA_C148" columnIndex="134"/>
		<result property="yetaC149" column="YETA_C149" columnIndex="135"/>
		<result property="yetaC150" column="YETA_C150" columnIndex="136"/>
		<result property="yetaC150a" column="YETA_C150A" columnIndex="137"/>
		<result property="yetaC150b" column="YETA_C150B" columnIndex="138"/>
		<result property="yetaC151" column="YETA_C151" columnIndex="139"/>
		<result property="yetaC152" column="YETA_C152" columnIndex="140"/>
		<result property="yetaC153" column="YETA_C153" columnIndex="141"/>
		<result property="yetaC154" column="YETA_C154" columnIndex="142"/>
		<result property="yetaC155" column="YETA_C155" columnIndex="143"/>
		<result property="yetaC156" column="YETA_C156" columnIndex="144"/>
		<result property="yetaC157" column="YETA_C157" columnIndex="145"/>
		<result property="yetaC158" column="YETA_C158" columnIndex="146"/>
		<result property="yetaC159" column="YETA_C159" columnIndex="147"/>
		<result property="yetaC160" column="YETA_C160" columnIndex="148"/>
		<result property="yetaC161" column="YETA_C161" columnIndex="149"/>
		<result property="yetaC162" column="YETA_C162" columnIndex="150"/>
		<result property="yetaC163" column="YETA_C163" columnIndex="151"/>
		<result property="yetaC164" column="YETA_C164" columnIndex="152"/>
		<result property="yetaC165" column="YETA_C165" columnIndex="153"/>
		<result property="yetaC166" column="YETA_C166" columnIndex="154"/>
		<result property="yetaC167" column="YETA_C167" columnIndex="155"/>
		<result property="yetaC168" column="YETA_C168" columnIndex="156"/>
		<result property="yetaC169" column="YETA_C169" columnIndex="157"/>
		<result property="yetaC170" column="YETA_C170" columnIndex="158"/>
		<result property="kybdr" column="KYBDR" columnIndex="159"/>
		<result property="inptDt" column="INPT_DT" columnIndex="160"/>
		<result property="inptAddr" column="INPT_ADDR" columnIndex="161"/>
		<result property="ismt" column="ISMT" columnIndex="162"/>
		<result property="revnDt" column="REVN_DT" columnIndex="163"/>
		<result property="revnAddr" column="REVN_ADDR" columnIndex="164"/>
	</resultMap>
	
	
<!-- +++++++++++++++++++++++++ 2017년도 귀속 로직  시작 ++++++++++++++++++++++++++++++ -->

	<insert id="infcPkgYe169010_2023_DAO.fnYeta8100_YE169010_PAYR_2023_CREATE_Insert_S">
		<![CDATA[
			INSERT INTO YE169010 
				(   DPOB_CD
				  , YRTX_BLGG_YR
				  , CLUT_SEPT_CD
				  , SYSTEMKEY
				  , YETA_00C6
				  , YETA_00C9
				  , YETA_0C9A
				  , YETA_0C15
				  , YETA_0C22
				  , YETA_0C23
				  , YETA_0C24
				  , YETA_0C25
				  , YETA_0C26
				  , YETA_0C27
				  , YETA_0C29
				  , YETA_C30_G01
				  , YETA_C31_H01
				  , YETA_C32_H05
				  , YETA_C33_H06
				  , YETA_C34_H07
				  , YETA_C35_H08
				  , YETA_C36_H09
				  , YETA_C37_H10
				  , YETA_C38_H14
				  , YETA_C39_H15
				  , YETA_C40_H11
				  , YETA_C41_H12
				  , YETA_C42_H13
				  , YETA_C43_H16
				  , YETA_C44_I01
				  , YETA_C45_K01
				  , YETA_C46_M01
				  , YETA_C47_M02
				  , YETA_C48_M03
				  , YETA_C49_O01
				  , YETA_C50_Q01
				  , YETA_C51_R10
				  , YETA_C52_R11
				  , YETA_C53_S01
				  , YETA_C54_T01
				  , YETA_C55_Y02
				  , YETA_C56_Y03
				  , YETA_C56A_Y04
				  , YETA_C56_Y21
				  , YETA_C57_Y22
				  , YETA_C58_T10
				  , YETA_C58A_T11
				  , YETA_C58B_T12
				  , YETA_C59_T20
				  , YETA_0C60
				  , YETA_0C61
				  , YETA_0C63
				  , YETA_0C64
				  , YETA_0C65
				  , YETA_0C66
				  , YETA_0C67
				  , YETA_0C68
				  , YETA_0C69
				  , YETA_0C70
				  , YETA_0C71
				  , YETA_0C72
				  , YETA_0C73
				  , YETA_0C74
				  , YETA_0C75
				  , YETA_0C76
				  , YETA_0C77
				  , YETA_0C78
				  , YETA_0C79
				  , YETA_0C80
				  , YETA_0C81
				  , YETA_0C82
				  , YETA_0C83
				  , YETA_0C84
				  , YETA_0C85
				  , YETA_0C86
				  , YETA_0C87
				  , YETA_0C88
				  , YETA_0C89
				  , YETA_0C90
				  , YETA_0C91
				  , YETA_0C92
				  , YETA_0C93
				  , YETA_0C94
				  , YETA_0C96
				  , YETA_0C97
				  , YETA_0C98
				  , YETA_0C99
				  , YETA_C100
				  , YETA_C101
				  , YETA_C102
				  , YETA_C103
				  , YETA_C104
				  , YETA_C105
				  , YETA_C107
				  , YETA_C108
				  , YETA_C109
				  , YETA_C110
				  , YETA_C111
				  , YETA_C112
				  , YETA_C113
				  , YETA_C114
				  , YETA_C115
				  , YETA_C116
				  , YETA_C117
				  , YETA_C119
				  , YETA_C120
				  , YETA_C121
				  , YETA_C122
				  , YETA_C123
				  , YETA_C124
				  , YETA_C125
				  , YETA_C126
				  , YETA_C127
				  , YETA_C128
				  , YETA_C129
				  , YETA_C130
				  , YETA_C131
				  , YETA_C132
				  , YETA_C133
				  , YETA_C134
				  , YETA_C135
				  , YETA_C136
				  , YETA_C137
				  , YETA_C138
				  , YETA_C139
				  , YETA_C140
				  , YETA_C141
				  , YETA_C142
				  , YETA_C143
				  , YETA_C144
				  , YETA_C145
				  , YETA_C146
				  , YETA_C147
				  , YETA_C148
				  , YETA_C149
				  , YETA_C150
				  , YETA_C150A
				  , YETA_C150B
				  , YETA_C151
				  , YETA_C152
				  , YETA_C153
				  , YETA_C154
				  , YETA_C155
				  , YETA_C156
				  , YETA_C157
				  , YETA_C158
				  , YETA_C159
				  , YETA_C160
				  , YETA_C161
				  , YETA_C162
				  , YETA_C163
				  , YETA_C164
				  , YETA_C165
				  , YETA_C166
				  , YETA_C167
				  , YETA_C168
				  , YETA_C169
				  , YETA_C170
				  , KYBDR
				  , INPT_DT
				  , INPT_ADDR
				  , ISMT
				  , REVN_DT
				  , REVN_ADDR )
			VALUES ( #dpobCd#
				  , #yrtxBlggYr#
				  , #clutSeptCd#
				  , #systemkey#
				  , 0
				  , 'N'
				  , '2'
				  , ''
				  , ( SELECT SUM(YE160401.SUPR_TXAM )                                                                           
							FROM ( SELECT DPOB_CD
											, YRTX_BLGG_YR
											, ELCT_YYMM
											, SYSTEMKEY
											, CLUT_SEPT_CD
											, SUM(NVL(SUPR_TXAM,0)) AS SUPR_TXAM                                           
					          		FROM YE160401                                                                         
					       			GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                             
					        	   ) YE160401                                                                                
							WHERE YE160401.SYSTEMKEY = #systemkey#                                               
					 			AND YE160401.YRTX_BLGG_YR = #yrtxBlggYr#                                                
								AND YE160401.CLUT_SEPT_CD = #clutSeptCd#
					     		AND YE160401.DPOB_CD =  #dpobCd#)  			  /* 주근무지_급여총액  */     
				  , ( SELECT SUM(YE160401.BUAM_TXAM)                                                                   
                         	 FROM ( SELECT DPOB_CD
                         	 				, YRTX_BLGG_YR
                         	 				, ELCT_YYMM
                         	 				, SYSTEMKEY
                         	 				, CLUT_SEPT_CD
                         	 				, SUM(NVL(BUAM_TXAM,0)) AS BUAM_TXAM                          
	                           		FROM YE160401                                                                         
					       			GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                    
	                              ) YE160401                                                                       
                          WHERE YE160401.SYSTEMKEY = #systemkey#                                               
					 			AND YE160401.YRTX_BLGG_YR = #yrtxBlggYr#                                                
								AND YE160401.CLUT_SEPT_CD = #clutSeptCd#
					     		AND YE160401.DPOB_CD =  #dpobCd# )   				  /* 주근무지_상여총액 */  
				  , ( SELECT SUM(YE160401.INBS_AMNT)                                                                 
			         			FROM ( SELECT DPOB_CD
			         							, YRTX_BLGG_YR
			         							, ELCT_YYMM
			         							, SYSTEMKEY
			         							, CLUT_SEPT_CD
			         							, SUM(NVL(INBS_AMNT,0)) AS INBS_AMNT                                      
			                      		FROM YE160401                                                                 
			                 			GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                      
			                              ) YE160401                                                                      
			                          WHERE YE160401.SYSTEMKEY = #systemkey#                                               
					 			AND YE160401.YRTX_BLGG_YR = #yrtxBlggYr#                                                
								AND YE160401.CLUT_SEPT_CD = #clutSeptCd#
					     		AND YE160401.DPOB_CD =  #dpobCd#  )  		  /* 주근무지_인정상여총액 */  
				  , ( SELECT SUM(YE160401.STCK_INAM )                                                                 
			            		FROM ( SELECT DPOB_CD
			            						, YRTX_BLGG_YR
			            						, ELCT_YYMM
			            						, SYSTEMKEY
			            						, CLUT_SEPT_CD
			            						, SUM(NVL(STCK_INAM,0)) AS STCK_INAM                                     
			                   			FROM YE160401                                                                
			                        	GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                  
			                              ) YE160401                                                                      
			                          WHERE YE160401.SYSTEMKEY = #systemkey#                                               
					 			AND YE160401.YRTX_BLGG_YR = #yrtxBlggYr#                                                
								AND YE160401.CLUT_SEPT_CD = #clutSeptCd#
					     		AND YE160401.DPOB_CD =  #dpobCd# ) 		 /* 주근무지_주식행사이익 */    
				  ,( SELECT SUM(YE160401.CURR_WORK_EMPTK_WDRW_SUM  )                                                                
			            		FROM ( SELECT DPOB_CD
			            						, YRTX_BLGG_YR
			            						, ELCT_YYMM
			            						, SYSTEMKEY
			            						, CLUT_SEPT_CD
			            						, SUM(NVL(CURR_WORK_EMPTK_WDRW_SUM,0)) AS CURR_WORK_EMPTK_WDRW_SUM                                     
			                   			FROM YE160401                                                                
			                        	GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                  
			                              ) YE160401                                                                      
			                          WHERE YE160401.SYSTEMKEY = #systemkey#                                               
							 			AND YE160401.YRTX_BLGG_YR = #yrtxBlggYr#                                                
										AND YE160401.CLUT_SEPT_CD = #clutSeptCd#
							     		AND YE160401.DPOB_CD =  #dpobCd# ) 		 /*  	현근무지우리사주조합인출금액  */  
				  , ( SELECT SUM(YE160401.CURR_WORK_ECTE_RETCE_SUM   )                                                               
			            		FROM ( SELECT DPOB_CD
			            						, YRTX_BLGG_YR
			            						, ELCT_YYMM
			            						, SYSTEMKEY
			            						, CLUT_SEPT_CD
			            						, SUM(NVL(CURR_WORK_ECTE_RETCE_SUM,0)) AS CURR_WORK_ECTE_RETCE_SUM                                     
			                   			FROM YE160401                                                                
			                        	GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                  
			                              ) YE160401                                                                      
			                          WHERE YE160401.SYSTEMKEY = #systemkey#                                               
							 			AND YE160401.YRTX_BLGG_YR = #yrtxBlggYr#                                                
										AND YE160401.CLUT_SEPT_CD = #clutSeptCd#
							     		AND YE160401.DPOB_CD =  #dpobCd#  ) 		 /* 현근무지임원퇴직소득금액한도초과금액 */  
				  ,  ( SELECT ( SUM(YE160401.SUPR_TXAM) 
             							+ SUM(YE160401.BUAM_TXAM )
             							+ SUM(YE160401.INBS_AMNT )
             							+ SUM(YE160401.STCK_INAM )
						 				+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0)) 
						 				+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0)))    
		     					FROM ( SELECT DPOB_CD
		     									, YRTX_BLGG_YR
		     									, ELCT_YYMM
		     									, SYSTEMKEY
		     									, CLUT_SEPT_CD
		     									, SUM(NVL(SUPR_TXAM,0)) AS SUPR_TXAM
		     									, SUM(NVL(BUAM_TXAM,0)) AS BUAM_TXAM
		     									, SUM(NVL(INBS_AMNT,0)) AS INBS_AMNT
		     									, SUM(NVL(STCK_INAM,0)) AS STCK_INAM       
											, SUM(CURR_WORK_EMPTK_WDRW_SUM) AS CURR_WORK_EMPTK_WDRW_SUM
										        , SUM(CURR_WORK_ECTE_RETCE_SUM) AS CURR_WORK_ECTE_RETCE_SUM	
		                    			FROM YE160401                                                               
		                                GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                  
		                              ) YE160401                                                                     
		                           WHERE YE160401.SYSTEMKEY = #systemkey#                                               
							 			AND YE160401.YRTX_BLGG_YR = #yrtxBlggYr#                                                
										AND YE160401.CLUT_SEPT_CD = #clutSeptCd#
							     		AND YE160401.DPOB_CD =  #dpobCd#) 		 	/* 주근무지총급여액 */    
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , ( SELECT ( SUM(YE160401.SUPR_TXAM) 
              							+ SUM(YE160401.BUAM_TXAM )
              							+ SUM(YE160401.INBS_AMNT )
              							+ SUM(YE160401.STCK_INAM )
						 				+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0))
						 				+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 			  )  
                          		FROM ( SELECT DPOB_CD
                          						, YRTX_BLGG_YR
                          						, ELCT_YYMM
                          						, SYSTEMKEY
                          						, CLUT_SEPT_CD
                          						, SUM(NVL(SUPR_TXAM,0)) AS SUPR_TXAM
                          						, SUM(NVL(BUAM_TXAM,0)) AS BUAM_TXAM
		                                      	, SUM(NVL(INBS_AMNT,0)) AS INBS_AMNT
		                                      	, SUM(NVL(STCK_INAM,0)) AS STCK_INAM
		                                      	, SUM(NVL(SPBM_TXAM,0)) AS SPBM_TXAM
												, SUM(CURR_WORK_EMPTK_WDRW_SUM) AS CURR_WORK_EMPTK_WDRW_SUM
							  					, SUM(CURR_WORK_ECTE_RETCE_SUM) AS CURR_WORK_ECTE_RETCE_SUM	
		                                      /*	, SUM(NVL(TAXM_EARN,0)) AS TAXM_EARN
		                                       	, SUM(NVL(TXET_TXAM,0)) AS TXET_TXAM
		                                      	, SUM(NVL(TAXM_ETAM,0)) AS TAXM_ETAM   */
		                                      	, SUM(NVL(ECIN_TXAM,0)) AS ECIN_TXAM
		                                      	, SUM(NVL(TAXM_ECIN,0)) AS TAXM_ECIN
		                                      	, SUM(NVL(SPCI_HLTH,0)) AS SPCI_HLTH
		                                      	, SUM(NVL(SPCI_EMPF,0)) AS SPCI_EMPF
		                                      	, SUM(NVL(NATN_PSNF,0)) AS NATN_PSNF
		                                      	, SUM(NVL(EARN_TAXN,0)) AS EARN_TAXN
		                                      	, SUM(NVL(IHTX_TAXN,0)) AS IHTX_TAXN                                
		                         		FROM YE160401                                                           
		                    			GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                               
		                              ) YE160401                                                                 
                             	      WHERE YE160401.SYSTEMKEY = #systemkey#                                               
							 			AND YE160401.YRTX_BLGG_YR = #yrtxBlggYr#                                                
										AND YE160401.CLUT_SEPT_CD = #clutSeptCd#
							     		AND YE160401.DPOB_CD =  #dpobCd# )  					 /* 총급여_현_전*/   
				  , ( SELECT  ( CASE WHEN ( SUM(YE160401.SUPR_TXAM) 
              											+ SUM(YE160401.BUAM_TXAM) 
              											+ SUM(YE160401.INBS_AMNT )
              											+ SUM(YE160401.STCK_INAM )
						 								+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0)) 
						 								+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 						   )  <= 5000000                
			                          		THEN ( SUM(YE160401.SUPR_TXAM )
			                          				+ SUM(YE160401.BUAM_TXAM )
			                          				+ SUM(YE160401.INBS_AMNT )
			                          				+ SUM(YE160401.STCK_INAM )
						 							+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 							+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 						  )  * 0.7                                 
			                                                                                                        
			                          	 WHEN 15000000 >= ( SUM(YE160401.SUPR_TXAM )
			                          	 						+ SUM(YE160401.BUAM_TXAM )
			                          	 						+ SUM(YE160401.INBS_AMNT )
			                          	 						+ SUM(YE160401.STCK_INAM )
						 										+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 										+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 								  )                       
			                          		THEN 3500000 + ((( SUM(YE160401.SUPR_TXAM )
			                          							+ SUM(YE160401.BUAM_TXAM )
			                          							+ SUM(YE160401.INBS_AMNT )
			                          							+ SUM(YE160401.STCK_INAM )
						 										+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 										+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0) )
						 									   )  - 5000000)   * 0.4)         
			                                                                                                        
			                          	 WHEN 45000000 >= ( SUM(YE160401.SUPR_TXAM) 
			                          	 						+ SUM(YE160401.BUAM_TXAM )
			                          	 						+ SUM(YE160401.INBS_AMNT )
			                          	 						+ SUM(YE160401.STCK_INAM )
						 										+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0)) 
						 										+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 								  )                      
			                          		THEN 7500000 + ((( SUM(YE160401.SUPR_TXAM )
			                          							+ SUM(YE160401.BUAM_TXAM )
			                          							+ SUM(YE160401.INBS_AMNT )
			                          							+ SUM(YE160401.STCK_INAM )
						 										+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 										+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 									  )  - 15000000)   * 0.15)        
			                                                                                                         
			                          	 WHEN 100000000 >= ( SUM(YE160401.SUPR_TXAM )
			                          	 						+ SUM(YE160401.BUAM_TXAM )
			                          	 						+ SUM(YE160401.INBS_AMNT )
			                          	 						+ SUM(YE160401.STCK_INAM )
						 										+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 										+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 									)                        
			                          		THEN 12000000 + ((( SUM(YE160401.SUPR_TXAM )
			                          								+ SUM(YE160401.BUAM_TXAM )
			                          								+ SUM(YE160401.INBS_AMNT )
			                          								+ SUM(YE160401.STCK_INAM )
						 											+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 											+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 										)  
						 										- 45000000)   * 0.05)       
			                                                                                                         
			                             ELSE 14750000 + ((( SUM(YE160401.SUPR_TXAM )
			                             						+ SUM(YE160401.BUAM_TXAM )
			                             						+ SUM(YE160401.INBS_AMNT )
			                             						+ SUM(YE160401.STCK_INAM )
						 										+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0)) 
						 										+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 									)  
						 									- 100000000)   * 0.02)       
			                            END) AS PAYR_IN01                                                            
	                          FROM ( SELECT DPOB_CD
	                          				, YRTX_BLGG_YR
	                          				, ELCT_YYMM
	                          				, SYSTEMKEY
	                          				, CLUT_SEPT_CD
		                                    , SUM(NVL(SUPR_TXAM,0)) AS SUPR_TXAM
		                                    , SUM(NVL(BUAM_TXAM,0)) AS BUAM_TXAM
		                                    , SUM(NVL(INBS_AMNT,0)) AS INBS_AMNT
		                                    , SUM(NVL(STCK_INAM,0)) AS STCK_INAM
		                                    , SUM(NVL(SPBM_TXAM,0)) AS SPBM_TXAM
						    				, SUM(CURR_WORK_EMPTK_WDRW_SUM) AS CURR_WORK_EMPTK_WDRW_SUM
							 				, SUM(CURR_WORK_ECTE_RETCE_SUM) AS CURR_WORK_ECTE_RETCE_SUM	
		                                  /*  , SUM(NVL(TAXM_EARN,0)) AS TAXM_EARN
		                                    , SUM(NVL(TXET_TXAM,0)) AS TXET_TXAM
		                                    , SUM(NVL(TAXM_ETAM,0)) AS TAXM_ETAM  */
		                                    , SUM(NVL(ECIN_TXAM,0)) AS ECIN_TXAM
		                                    , SUM(NVL(TAXM_ECIN,0)) AS TAXM_ECIN
		                                    , SUM(NVL(SPCI_HLTH,0)) AS SPCI_HLTH
		                                    , SUM(NVL(SPCI_EMPF,0)) AS SPCI_EMPF
		                                    , SUM(NVL(NATN_PSNF,0)) AS NATN_PSNF
		                                    , SUM(NVL(EARN_TAXN,0)) AS EARN_TAXN
		                                    , SUM(NVL(IHTX_TAXN,0)) AS IHTX_TAXN                                
		                      			FROM YE160401                                                           
		                                GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                
		                              ) YE160401                                                                 
	                         WHERE YE160401.SYSTEMKEY = #systemkey#                                               
							 			AND YE160401.YRTX_BLGG_YR = #yrtxBlggYr#                                                
										AND YE160401.CLUT_SEPT_CD = #clutSeptCd#
							     		AND YE160401.DPOB_CD =  #dpobCd#)  					 	/* 근로소득공제 */  
				  ,  ( SELECT ( ( SUM(YE160401.SUPR_TXAM )
              								+ SUM(YE160401.BUAM_TXAM )
              								+ SUM(YE160401.INBS_AMNT )
              								+ SUM(YE160401.STCK_INAM )
						 					+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 					+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 			  ) 
              							- ( CASE WHEN ( SUM(YE160401.SUPR_TXAM )
              												+ SUM(YE160401.BUAM_TXAM )
              												+ SUM(YE160401.INBS_AMNT )
              												+ SUM(YE160401.STCK_INAM )
						 									+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 									+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 								) <= 5000000                 
					                          		THEN ( SUM(YE160401.SUPR_TXAM )
					                          				+ SUM(YE160401.BUAM_TXAM) 
					                          				+ SUM(YE160401.INBS_AMNT )
					                          				+ SUM(YE160401.STCK_INAM )
							 								+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
							 								+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
							 							 ) * 0.7                                  
				                                                                                                        
				                          	  	WHEN 15000000 >= ( SUM(YE160401.SUPR_TXAM )
				                          	  						+ SUM(YE160401.BUAM_TXAM )
				                          	  						+ SUM(YE160401.INBS_AMNT )
				                          	  						+ SUM(YE160401.STCK_INAM )
						 											+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 											+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 										  )                    
				                          			THEN 3500000 + ((( SUM(YE160401.SUPR_TXAM )
				                          								+ SUM(YE160401.BUAM_TXAM )
				                          								+ SUM(YE160401.INBS_AMNT )
				                          								+ SUM(YE160401.STCK_INAM )
						 												+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0)) 
						 												+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 											  ) - 5000000)   * 0.4)          
				                                                                                                         
				                          	  	WHEN 45000000 >= ( SUM(YE160401.SUPR_TXAM )
				                          	  						+ SUM(YE160401.BUAM_TXAM )
				                          	  						+ SUM(YE160401.INBS_AMNT )
				                          	  						+ SUM(YE160401.STCK_INAM )
						 											+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0)) 
						 											+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0)) 
						 										 )                     
				                          			THEN 7500000 + ((( SUM(YE160401.SUPR_TXAM )
				                          								+ SUM(YE160401.BUAM_TXAM )
				                          								+ SUM(YE160401.INBS_AMNT )
				                          								+ SUM(YE160401.STCK_INAM )
						 												+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 												+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 											   ) - 15000000)   * 0.15)        
				                                                                                                         
				                              	WHEN 100000000 >= ( SUM(YE160401.SUPR_TXAM )
				                              							+ SUM(YE160401.BUAM_TXAM )
				                              							+ SUM(YE160401.INBS_AMNT )
				                              							+ SUM(YE160401.STCK_INAM )
						 												+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 												+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 											)                      
				                          			THEN 12000000 + ((( SUM(YE160401.SUPR_TXAM )
				                          									+ SUM(YE160401.BUAM_TXAM )
				                          									+ SUM(YE160401.INBS_AMNT )
				                          									+ SUM(YE160401.STCK_INAM )
						 													+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 													+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0) )
						 											    ) - 45000000)   * 0.05)       
				                          	  ELSE 14750000 + ((( SUM(YE160401.SUPR_TXAM )
				                          	  						+ SUM(YE160401.BUAM_TXAM )
				                          	  						+ SUM(YE160401.INBS_AMNT )
				                          	  						+ SUM(YE160401.STCK_INAM )
						 											+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 											+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 										  ) - 100000000)   * 0.02)       
				                          	END)) AS PAYR_IN02    
				                          	                                                          
	                          FROM ( SELECT DPOB_CD
	                          				, YRTX_BLGG_YR
	                          				, ELCT_YYMM
	                          				, SYSTEMKEY
	                                      	, CLUT_SEPT_CD
	                                      	, SUM(NVL(SUPR_TXAM,0)) AS SUPR_TXAM
	                                      	, SUM(NVL(BUAM_TXAM,0)) AS BUAM_TXAM
	                                      	, SUM(NVL(INBS_AMNT,0)) AS INBS_AMNT
	                                      	, SUM(NVL(STCK_INAM,0)) AS STCK_INAM
	                                      	, SUM(NVL(SPBM_TXAM,0)) AS SPBM_TXAM
						 					, SUM(CURR_WORK_EMPTK_WDRW_SUM) AS CURR_WORK_EMPTK_WDRW_SUM
							  				, SUM(CURR_WORK_ECTE_RETCE_SUM) AS CURR_WORK_ECTE_RETCE_SUM	
	                                      /*	, SUM(NVL(TAXM_EARN,0)) AS TAXM_EARN
	                                      	, SUM(NVL(TXET_TXAM,0)) AS TXET_TXAM
	                                      	, SUM(NVL(TAXM_ETAM,0)) AS TAXM_ETAM  */
	                                      	, SUM(NVL(ECIN_TXAM,0)) AS ECIN_TXAM
	                                      	, SUM(NVL(TAXM_ECIN,0)) AS TAXM_ECIN
	                                      	, SUM(NVL(SPCI_HLTH,0)) AS SPCI_HLTH
	                                      	, SUM(NVL(SPCI_EMPF,0)) AS SPCI_EMPF
	                                      	, SUM(NVL(NATN_PSNF,0)) AS NATN_PSNF
	                                      	, SUM(NVL(EARN_TAXN,0)) AS EARN_TAXN
	                                      	, SUM(NVL(IHTX_TAXN,0)) AS IHTX_TAXN                                  
	                                 	FROM YE160401                                                             
	                                	GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                 
	                              	) YE160401                                                                   
                                      WHERE YE160401.SYSTEMKEY = #systemkey#                                               
							 			AND YE160401.YRTX_BLGG_YR = #yrtxBlggYr#                                                
										AND YE160401.CLUT_SEPT_CD = #clutSeptCd#
							     		AND YE160401.DPOB_CD =  #dpobCd# )  				  /* 근로소득금액 */ 
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , ( SELECT SUM(YE161050.NP_HTHR_AREA_DDC_AMT )                                                              
	                          FROM ( SELECT DPOB_CD
	                          				, YRTX_BLGG_YR 
	                          				, SYSTEMKEY
	                          				, CLUT_SEPT_CD
	                          				, SUM(NVL(NP_HTHR_AREA_DDC_AMT,0)) AS NP_HTHR_AREA_DDC_AMT                                    
	                          		FROM YE161050                                                               
	                           		GROUP BY DPOB_CD, YRTX_BLGG_YR , SYSTEMKEY ,CLUT_SEPT_CD                                    
	                              ) YE161050                                                                    
	                          WHERE YE161050.SYSTEMKEY = #systemkey#                                               
							 			AND YE161050.YRTX_BLGG_YR = #yrtxBlggYr#                                                
										AND YE161050.CLUT_SEPT_CD = #clutSeptCd#
							     		AND YE161050.DPOB_CD =  #dpobCd# )   			  /* 국민연금보험료 공제 */  
				  , ( SELECT SUM(YE161055.PUOFER_ANTY_DDUC_SUM )                                                              
	                          FROM ( SELECT DPOB_CD
	                          				, YRTX_BLGG_YR 
	                          				, SYSTEMKEY
	                          				, CLUT_SEPT_CD
	                          				, SUM(NVL(PUOFER_ANTY_DDUC_SUM,0)) AS PUOFER_ANTY_DDUC_SUM                                    
	                          		FROM YE161055                                                              
	                           		GROUP BY DPOB_CD, YRTX_BLGG_YR , SYSTEMKEY ,CLUT_SEPT_CD                                    
	                              ) YE161055                                                                    
	                          WHERE YE161055.SYSTEMKEY = #systemkey#                                               
							 			AND YE161055.YRTX_BLGG_YR = #yrtxBlggYr#                                                
										AND YE161055.CLUT_SEPT_CD = #clutSeptCd#
							     		AND YE161055.DPOB_CD =  #dpobCd# )   			  /* 공적연금_공무원연금공제금액 */  
				  , ( SELECT SUM(YE161055.MLTYM_ANTY_DDUC_SUM )                                                              
	                          FROM ( SELECT DPOB_CD
	                          				, YRTX_BLGG_YR 
	                          				, SYSTEMKEY
	                          				, CLUT_SEPT_CD
	                          				, SUM(NVL(MLTYM_ANTY_DDUC_SUM,0)) AS MLTYM_ANTY_DDUC_SUM                                    
	                          		FROM YE161055                                                              
	                           		GROUP BY DPOB_CD, YRTX_BLGG_YR , SYSTEMKEY ,CLUT_SEPT_CD                                    
	                              ) YE161055                                                                    
	                          WHERE YE161055.SYSTEMKEY = #systemkey#                                               
							 			AND YE161055.YRTX_BLGG_YR = #yrtxBlggYr#                                                
										AND YE161055.CLUT_SEPT_CD = #clutSeptCd#
							     		AND YE161055.DPOB_CD =  #dpobCd# )   			  /* 공적연금_군인연금공제금액 */  
				  , ( SELECT SUM(YE161055.PRTAFIR_SCHL_DDUC_SUM )                                                              
	                          FROM ( SELECT DPOB_CD
	                          				, YRTX_BLGG_YR 
	                          				, SYSTEMKEY
	                          				, CLUT_SEPT_CD
	                          				, SUM(NVL(PRTAFIR_SCHL_DDUC_SUM,0)) AS PRTAFIR_SCHL_DDUC_SUM                                    
	                          		FROM YE161055                                                              
	                           		GROUP BY DPOB_CD, YRTX_BLGG_YR , SYSTEMKEY ,CLUT_SEPT_CD                                    
	                              ) YE161055                                                                    
	                          WHERE YE161055.SYSTEMKEY = #systemkey#                                               
							 			AND YE161055.YRTX_BLGG_YR = #yrtxBlggYr#                                                
										AND YE161055.CLUT_SEPT_CD = #clutSeptCd#
							     		AND YE161055.DPOB_CD =  #dpobCd# )   			  /* 공적연금_사립학교직원연금공제금액 */  
				  , ( SELECT SUM(YE161055.SPILDTN_PSTOFIC_DDUC_SUM )                                                              
	                          FROM ( SELECT DPOB_CD
	                          				, YRTX_BLGG_YR 
	                          				, SYSTEMKEY
	                          				, CLUT_SEPT_CD
	                          				, SUM(NVL(SPILDTN_PSTOFIC_DDUC_SUM,0)) AS SPILDTN_PSTOFIC_DDUC_SUM                                    
	                          		FROM YE161055                                                              
	                           		GROUP BY DPOB_CD, YRTX_BLGG_YR , SYSTEMKEY ,CLUT_SEPT_CD                                    
	                              ) YE161055                                                                    
	                          WHERE YE161055.SYSTEMKEY = #systemkey#                                               
							 			AND YE161055.YRTX_BLGG_YR = #yrtxBlggYr#                                                
										AND YE161055.CLUT_SEPT_CD = #clutSeptCd#
							     		AND YE161055.DPOB_CD =  #dpobCd# )   			  /* 공적연금_별정우체국연금공제금액 */  
				  ,  ( SELECT SUM(YE161060.MCUR_HIFE_DDC_AMT )                                                              
	                          FROM ( SELECT DPOB_CD
	                          				, YRTX_BLGG_YR 
	                          				, SYSTEMKEY
	                          				, CLUT_SEPT_CD
	                          				, SUM(NVL(HTHR_HIFE_DDC_AMT,0) + NVL(MCUR_HIFE_DDC_AMT,0) + NVL(MCUR_HIFE_AREA_DDC_AMT,0)) AS MCUR_HIFE_DDC_AMT                                    
	                          		FROM YE161060                                                              
	                           		GROUP BY DPOB_CD, YRTX_BLGG_YR , SYSTEMKEY ,CLUT_SEPT_CD                                    
	                              ) YE161060                                                                    
	                          WHERE YE161060.SYSTEMKEY = #systemkey#                                               
							 			AND YE161060.YRTX_BLGG_YR = #yrtxBlggYr#                                                
										AND YE161060.CLUT_SEPT_CD = #clutSeptCd#
							     		AND YE161060.DPOB_CD =  #dpobCd# )   			  /* 국민건강보험_보험료공제액 */  
				  ,   ( SELECT SUM(YE161060.MCUR_UI_DDC_AMT )                                                              
	                          FROM ( SELECT DPOB_CD
	                          				, YRTX_BLGG_YR 
	                          				, SYSTEMKEY
	                          				, CLUT_SEPT_CD
	                          				, SUM(NVL(HTHR_UI_DDC_AMT,0) + NVL(MCUR_UI_DDC_AMT,0) ) AS MCUR_UI_DDC_AMT                                    
	                          		FROM YE161060                                                              
	                           		GROUP BY DPOB_CD, YRTX_BLGG_YR , SYSTEMKEY ,CLUT_SEPT_CD                                    
	                              ) YE161060                                                                    
	                          WHERE YE161060.SYSTEMKEY = #systemkey#                                               
							 			AND YE161060.YRTX_BLGG_YR = #yrtxBlggYr#                                                
										AND YE161060.CLUT_SEPT_CD = #clutSeptCd#
							     		AND YE161060.DPOB_CD =  #dpobCd# )   			  /* 고용보험_보험료공제액 */  
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  
				  , ( SELECT SUM(YE160401.EARN_TAXN)                                                                
	                          FROM ( SELECT DPOB_CD
	                          				, YRTX_BLGG_YR
	                          				, ELCT_YYMM
	                          				, SYSTEMKEY
	                          				, CLUT_SEPT_CD
	                          				, SUM(NVL(EARN_TAXN,0)) AS EARN_TAXN                                   
	                          		FROM YE160401                                                              
	                        		GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                   
	                   			) YE160401                                                                    
	                          WHERE YE160401.SYSTEMKEY = #systemkey#                                               
							 			AND YE160401.YRTX_BLGG_YR = #yrtxBlggYr#                                                
										AND YE160401.CLUT_SEPT_CD = #clutSeptCd#
							     		AND YE160401.DPOB_CD =  #dpobCd# )   		  /* 기납부세액 소득 */  
				  , ( SELECT SUM(YE160401.IHTX_TAXN )                                                             
                          		FROM ( SELECT DPOB_CD
                          						, YRTX_BLGG_YR
                          						, ELCT_YYMM
                          						, SYSTEMKEY
		                                      	, CLUT_SEPT_CD
		                                      	, SUM(NVL(IHTX_TAXN,0)) AS IHTX_TAXN                                  
		                          		FROM YE160401                                                              
		                                GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                  
		                              ) YE160401                                                                   
                           WHERE YE160401.SYSTEMKEY = #systemkey#                                               
							 			AND YE160401.YRTX_BLGG_YR = #yrtxBlggYr#                                                
										AND YE160401.CLUT_SEPT_CD = #clutSeptCd#
							     		AND YE160401.DPOB_CD =  #dpobCd# )    			  /* 기납부 주민세 */ 
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  , 0
				  
				  , #kybdr#
				  , #inptDt#
				  , #inptAddr#
				  , #ismt#
				  , #revnDt#
				  , #revnAddr# )
		]]>
	</insert>

<!-- +++++++++++++++++++++++++ 2017년도 귀속 로직  종료 ++++++++++++++++++++++++++++++ -->
	
	
	
	<update id="infcPkgYe169010_2023_DAO.updateYe169010_S">
		<![CDATA[
			UPDATE YE169010
			SET DPOB_CD=#dpobCd#
				, YRTX_BLGG_YR=#yrtxBlggYr#
				, CLUT_SEPT_CD=#clutSeptCd#
				, SYSTEMKEY=#systemkey#
				, YETA_00C6=#yeta00c6#
				, YETA_00C9=#yeta00c9#
				, YETA_0C9A=#yeta0c9a#
				, YETA_0C15=#yeta0c15#
				, YETA_0C22=#yeta0c22#
				, YETA_0C23=#yeta0c23#
				, YETA_0C24=#yeta0c24#
				, YETA_0C25=#yeta0c25#
				, YETA_0C26=#yeta0c26#
				, YETA_0C27=#yeta0c27#
				, YETA_0C29=#yeta0c29#
				, YETA_C30_G01=#yetaC30G01#
				, YETA_C31_H01=#yetaC31H01#
				, YETA_C32_H05=#yetaC32H05#
				, YETA_C33_H06=#yetaC33H06#
				, YETA_C34_H07=#yetaC34H07#
				, YETA_C35_H08=#yetaC35H08#
				, YETA_C36_H09=#yetaC36H09#
				, YETA_C37_H10=#yetaC37H10#
				, YETA_C38_H14=#yetaC38H14#
				, YETA_C39_H15=#yetaC39H15#
				, YETA_C40_H11=#yetaC40H11#
				, YETA_C41_H12=#yetaC41H12#
				, YETA_C42_H13=#yetaC42H13#
				, YETA_C43_H16=#yetaC43H16#
				, YETA_C44_I01=#yetaC44I01#
				, YETA_C45_K01=#yetaC45K01#
				, YETA_C46_M01=#yetaC46M01#
				, YETA_C47_M02=#yetaC47M02#
				, YETA_C48_M03=#yetaC48M03#
				, YETA_C49_O01=#yetaC49O01#
				, YETA_C50_Q01=#yetaC50Q01#
				, YETA_C51_R10=#yetaC51R10#
				, YETA_C52_R11=#yetaC52R11#
				, YETA_C53_S01=#yetaC53S01#
				, YETA_C54_T01=#yetaC54T01#
				, YETA_C55_Y02=#yetaC55Y02#
				, YETA_C56_Y03=#yetaC56Y03#
				, YETA_C56A_Y04=#yetaC56aY04#
				, YETA_C56_Y21=#yetaC56Y21#
				, YETA_C57_Y22=#yetaC57Y22#
				, YETA_C58_T10=#yetaC58T10#
				, YETA_C58A_T11=#yetaC58aT11#
				, YETA_C58B_T12=#yetaC58bT12#
				, YETA_C59_T20=#yetaC59T20#
				, YETA_0C60=#yeta0c60#
				, YETA_0C61=#yeta0c61#
				, YETA_0C63=#yeta0c63#
				, YETA_0C64=#yeta0c64#
				, YETA_0C65=#yeta0c65#
				, YETA_0C66=#yeta0c66#
				, YETA_0C67=#yeta0c67#
				, YETA_0C68=#yeta0c68#
				, YETA_0C69=#yeta0c69#
				, YETA_0C70=#yeta0c70#
				, YETA_0C71=#yeta0c71#
				, YETA_0C72=#yeta0c72#
				, YETA_0C73=#yeta0c73#
				, YETA_0C74=#yeta0c74#
				, YETA_0C75=#yeta0c75#
				, YETA_0C76=#yeta0c76#
				, YETA_0C77=#yeta0c77#
				, YETA_0C78=#yeta0c78#
				, YETA_0C79=#yeta0c79#
				, YETA_0C80=#yeta0c80#
				, YETA_0C81=#yeta0c81#
				, YETA_0C82=#yeta0c82#
				, YETA_0C83=#yeta0c83#
				, YETA_0C84=#yeta0c84#
				, YETA_0C85=#yeta0c85#
				, YETA_0C86=#yeta0c86#
				, YETA_0C87=#yeta0c87#
				, YETA_0C88=#yeta0c88#
				, YETA_0C89=#yeta0c89#
				, YETA_0C90=#yeta0c90#
				, YETA_0C91=#yeta0c91#
				, YETA_0C92=#yeta0c92#
				, YETA_0C93=#yeta0c93#
				, YETA_0C94=#yeta0c94#
				, YETA_0C96=#yeta0c96#
				, YETA_0C97=#yeta0c97#
				, YETA_0C98=#yeta0c98#
				, YETA_0C99=#yeta0c99#
				, YETA_C100=#yetaC100#
				, YETA_C101=#yetaC101#
				, YETA_C102=#yetaC102#
				, YETA_C103=#yetaC103#
				, YETA_C104=#yetaC104#
				, YETA_C105=#yetaC105#
				, YETA_C107=#yetaC107#
				, YETA_C108=#yetaC108#
				, YETA_C109=#yetaC109#
				, YETA_C110=#yetaC110#
				, YETA_C111=#yetaC111#
				, YETA_C112=#yetaC112#
				, YETA_C113=#yetaC113#
				, YETA_C114=#yetaC114#
				, YETA_C115=#yetaC115#
				, YETA_C116=#yetaC116#
				, YETA_C117=#yetaC117#
				, YETA_C119=#yetaC119#
				, YETA_C120=#yetaC120#
				, YETA_C121=#yetaC121#
				, YETA_C122=#yetaC122#
				, YETA_C123=#yetaC123#
				, YETA_C124=#yetaC124#
				, YETA_C125=#yetaC125#
				, YETA_C126=#yetaC126#
				, YETA_C127=#yetaC127#
				, YETA_C128=#yetaC128#
				, YETA_C129=#yetaC129#
				, YETA_C130=#yetaC130#
				, YETA_C131=#yetaC131#
				, YETA_C132=#yetaC132#
				, YETA_C133=#yetaC133#
				, YETA_C134=#yetaC134#
				, YETA_C135=#yetaC135#
				, YETA_C136=#yetaC136#
				, YETA_C137=#yetaC137#
				, YETA_C138=#yetaC138#
				, YETA_C139=#yetaC139#
				, YETA_C140=#yetaC140#
				, YETA_C141=#yetaC141#
				, YETA_C142=#yetaC142#
				, YETA_C143=#yetaC143#
				, YETA_C144=#yetaC144#
				, YETA_C145=#yetaC145#
				, YETA_C146=#yetaC146#
				, YETA_C147=#yetaC147#
				, YETA_C148=#yetaC148#
				, YETA_C149=#yetaC149#
				, YETA_C150=#yetaC150#
				, YETA_C150A=#yetaC150a#
				, YETA_C150B=#yetaC150b#
				, YETA_C151=#yetaC151#
				, YETA_C152=#yetaC152#
				, YETA_C153=#yetaC153#
				, YETA_C154=#yetaC154#
				, YETA_C155=#yetaC155#
				, YETA_C156=#yetaC156#
				, YETA_C157=#yetaC157#
				, YETA_C158=#yetaC158#
				, YETA_C159=#yetaC159#
				, YETA_C160=#yetaC160#
				, YETA_C161=#yetaC161#
				, YETA_C162=#yetaC162#
				, YETA_C163=#yetaC163#
				, YETA_C164=#yetaC164#
				, YETA_C165=#yetaC165#
				, YETA_C166=#yetaC166#
				, YETA_C167=#yetaC167#
				, YETA_C168=#yetaC168#
				, YETA_C169=#yetaC169#
				, YETA_C170=#yetaC170#
				, KYBDR=#kybdr#
				, INPT_DT=#inptDt#
				, INPT_ADDR=#inptAddr#
				, ISMT=#ismt#
				, REVN_DT=#revnDt#
				, REVN_ADDR=#revnAddr#
						WHERE DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
								AND SYSTEMKEY=#systemkey#
				]]>
	</update>
	
	<delete id="infcPkgYe169010_2023_DAO.deleteYe169010_S">
		<![CDATA[
			DELETE FROM YE169010 
						WHERE DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
								AND SYSTEMKEY=#systemkey#
				]]>
	</delete>
	
	<select id="infcPkgYe169010_2023_DAO.selectYe169010_S" resultMap="infcPkgYe169010_2023">
		<![CDATA[
			SELECT
				DPOB_CD
				, YRTX_BLGG_YR
				, CLUT_SEPT_CD
				, SYSTEMKEY
				, YETA_00C6
				, YETA_00C9
				, YETA_0C9A
				, YETA_0C15
				, YETA_0C22
				, YETA_0C23
				, YETA_0C24
				, YETA_0C25
				, YETA_0C26
				, YETA_0C27
				, YETA_0C29
				, YETA_C30_G01
				, YETA_C31_H01
				, YETA_C32_H05
				, YETA_C33_H06
				, YETA_C34_H07
				, YETA_C35_H08
				, YETA_C36_H09
				, YETA_C37_H10
				, YETA_C38_H14
				, YETA_C39_H15
				, YETA_C40_H11
				, YETA_C41_H12
				, YETA_C42_H13
				, YETA_C43_H16
				, YETA_C44_I01
				, YETA_C45_K01
				, YETA_C46_M01
				, YETA_C47_M02
				, YETA_C48_M03
				, YETA_C49_O01
				, YETA_C50_Q01
				, YETA_C51_R10
				, YETA_C52_R11
				, YETA_C53_S01
				, YETA_C54_T01
				, YETA_C55_Y02
				, YETA_C56_Y03
				, YETA_C56A_Y04
				, YETA_C56_Y21
				, YETA_C57_Y22
				, YETA_C58_T10
				, YETA_C58A_T11
				, YETA_C58B_T12
				, YETA_C59_T20
				, YETA_0C60
				, YETA_0C61
				, YETA_0C63
				, YETA_0C64
				, YETA_0C65
				, YETA_0C66
				, YETA_0C67
				, YETA_0C68
				, YETA_0C69
				, YETA_0C70
				, YETA_0C71
				, YETA_0C72
				, YETA_0C73
				, YETA_0C74
				, YETA_0C75
				, YETA_0C76
				, YETA_0C77
				, YETA_0C78
				, YETA_0C79
				, YETA_0C80
				, YETA_0C81
				, YETA_0C82
				, YETA_0C83
				, YETA_0C84
				, YETA_0C85
				, YETA_0C86
				, YETA_0C87
				, YETA_0C88
				, YETA_0C89
				, YETA_0C90
				, YETA_0C91
				, YETA_0C92
				, YETA_0C93
				, YETA_0C94
				, YETA_0C96
				, YETA_0C97
				, YETA_0C98
				, YETA_0C99
				, YETA_C100
				, YETA_C101
				, YETA_C102
				, YETA_C103
				, YETA_C104
				, YETA_C105
				, YETA_C107
				, YETA_C108
				, YETA_C109
				, YETA_C110
				, YETA_C111
				, YETA_C112
				, YETA_C113
				, YETA_C114
				, YETA_C115
				, YETA_C116
				, YETA_C117
				, YETA_C119
				, YETA_C120
				, YETA_C121
				, YETA_C122
				, YETA_C123
				, YETA_C124
				, YETA_C125
				, YETA_C126
				, YETA_C127
				, YETA_C128
				, YETA_C129
				, YETA_C130
				, YETA_C131
				, YETA_C132
				, YETA_C133
				, YETA_C134
				, YETA_C135
				, YETA_C136
				, YETA_C137
				, YETA_C138
				, YETA_C139
				, YETA_C140
				, YETA_C141
				, YETA_C142
				, YETA_C143
				, YETA_C144
				, YETA_C145
				, YETA_C146
				, YETA_C147
				, YETA_C148
				, YETA_C149
				, YETA_C150
				, YETA_C150A
				, YETA_C150B
				, YETA_C151
				, YETA_C152
				, YETA_C153
				, YETA_C154
				, YETA_C155
				, YETA_C156
				, YETA_C157
				, YETA_C158
				, YETA_C159
				, YETA_C160
				, YETA_C161
				, YETA_C162
				, YETA_C163
				, YETA_C164
				, YETA_C165
				, YETA_C166
				, YETA_C167
				, YETA_C168
				, YETA_C169
				, YETA_C170
				, KYBDR
				, INPT_DT
				, INPT_ADDR
				, ISMT
				, REVN_DT
				, REVN_ADDR
			FROM YE169010
						WHERE DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
								AND SYSTEMKEY=#systemkey#
				]]>
	</select>
	
	<select id="infcPkgYe169010_2023_DAO.selectYe169010List_D" parameterClass="infcPkgYe169010Srh_2023_VO" resultClass="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (
				SELECT
								DPOB_CD
								, YRTX_BLGG_YR
								, CLUT_SEPT_CD
								, SYSTEMKEY
								, YETA_00C6
								, YETA_00C9
								, YETA_0C9A
								, YETA_0C15
								, YETA_0C22
								, YETA_0C23
								, YETA_0C24
								, YETA_0C25
								, YETA_0C26
								, YETA_0C27
								, YETA_0C29
								, YETA_C30_G01
								, YETA_C31_H01
								, YETA_C32_H05
								, YETA_C33_H06
								, YETA_C34_H07
								, YETA_C35_H08
								, YETA_C36_H09
								, YETA_C37_H10
								, YETA_C38_H14
								, YETA_C39_H15
								, YETA_C40_H11
								, YETA_C41_H12
								, YETA_C42_H13
								, YETA_C43_H16
								, YETA_C44_I01
								, YETA_C45_K01
								, YETA_C46_M01
								, YETA_C47_M02
								, YETA_C48_M03
								, YETA_C49_O01
								, YETA_C50_Q01
								, YETA_C51_R10
								, YETA_C52_R11
								, YETA_C53_S01
								, YETA_C54_T01
								, YETA_C55_Y02
								, YETA_C56_Y03
								, YETA_C56A_Y04
								, YETA_C56_Y21
								, YETA_C57_Y22
								, YETA_C58_T10
								, YETA_C58A_T11
								, YETA_C58B_T12
								, YETA_C59_T20
								, YETA_0C60
								, YETA_0C61
								, YETA_0C63
								, YETA_0C64
								, YETA_0C65
								, YETA_0C66
								, YETA_0C67
								, YETA_0C68
								, YETA_0C69
								, YETA_0C70
								, YETA_0C71
								, YETA_0C72
								, YETA_0C73
								, YETA_0C74
								, YETA_0C75
								, YETA_0C76
								, YETA_0C77
								, YETA_0C78
								, YETA_0C79
								, YETA_0C80
								, YETA_0C81
								, YETA_0C82
								, YETA_0C83
								, YETA_0C84
								, YETA_0C85
								, YETA_0C86
								, YETA_0C87
								, YETA_0C88
								, YETA_0C89
								, YETA_0C90
								, YETA_0C91
								, YETA_0C92
								, YETA_0C93
								, YETA_0C94
								, YETA_0C96
								, YETA_0C97
								, YETA_0C98
								, YETA_0C99
								, YETA_C100
								, YETA_C101
								, YETA_C102
								, YETA_C103
								, YETA_C104
								, YETA_C105
								, YETA_C107
								, YETA_C108
								, YETA_C109
								, YETA_C110
								, YETA_C111
								, YETA_C112
								, YETA_C113
								, YETA_C114
								, YETA_C115
								, YETA_C116
								, YETA_C117
								, YETA_C119
								, YETA_C120
								, YETA_C121
								, YETA_C122
								, YETA_C123
								, YETA_C124
								, YETA_C125
								, YETA_C126
								, YETA_C127
								, YETA_C128
								, YETA_C129
								, YETA_C130
								, YETA_C131
								, YETA_C132
								, YETA_C133
								, YETA_C134
								, YETA_C135
								, YETA_C136
								, YETA_C137
								, YETA_C138
								, YETA_C139
								, YETA_C140
								, YETA_C141
								, YETA_C142
								, YETA_C143
								, YETA_C144
								, YETA_C145
								, YETA_C146
								, YETA_C147
								, YETA_C148
								, YETA_C149
								, YETA_C150
								, YETA_C150A
								, YETA_C150B
								, YETA_C151
								, YETA_C152
								, YETA_C153
								, YETA_C154
								, YETA_C155
								, YETA_C156
								, YETA_C157
								, YETA_C158
								, YETA_C159
								, YETA_C160
								, YETA_C161
								, YETA_C162
								, YETA_C163
								, YETA_C164
								, YETA_C165
								, YETA_C166
								, YETA_C167
								, YETA_C168
								, YETA_C169
								, YETA_C170
								, KYBDR
								, INPT_DT
								, INPT_ADDR
								, ISMT
								, REVN_DT
								, REVN_ADDR
						FROM YE169010
				WHERE 1=1
				<isEqual prepend="AND" property="searchCondition" compareValue="0">
					DPOB_CD = #searchKeyword#
				</isEqual>
				<isEqual prepend="AND" property="searchCondition" compareValue="1">
					YRTX_BLGG_YR LIKE '%' || #searchKeyword# || '%'
				</isEqual>
					ORDER BY 
						DPOB_CD DESC
							, YRTX_BLGG_YR DESC
							, CLUT_SEPT_CD DESC
							, SYSTEMKEY DESC
		
		<![CDATA[					
	) A WHERE ROWNUM <= #lastIndex#
)WHERE RNUM > #firstIndex#
]]>
	</select>	
	<select id="infcPkgYe169010_2023_DAO.selectYe169010ListTotCnt_S" parameterClass="infcPkgYe169010Srh_2023_VO" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM YE169010
			WHERE 1=1
			<isEqual prepend="AND" property="searchCondition" compareValue="0">
				DPOB_CD = #searchKeyword#
			</isEqual>
			<isEqual prepend="AND" property="searchCondition" compareValue="1">
				YRTX_BLGG_YR LIKE '%' || #searchKeyword# || '%'
			</isEqual>
	</select>

	
 <!-- {공제단계 시작 -소득공제 02}     총급여액,근로소득금액,근로소득공제금액  -->
	   <update id="infcPkgYe169010_2023_DAO.fnYeta8300_YE169010_Tax_gun_Update_S">
		<![CDATA[
			   UPDATE YE169010                                                                                   
           SET     /*  WKER_DDCT IS '근로소득공제    */                                                                   
               YETA_0C64 =  TRUNC((CASE WHEN YETA_0C63 <= 5000000                                 
                                 THEN                                                                       
                                 YETA_0C63 * 0.7                                              
                                 WHEN 15000000 >= YETA_0C63                                     
                                 THEN                                                                       
                                 3500000 + ((YETA_0C63 - 5000000)   * 0.4)                      
                                                                                                            
                                 WHEN 45000000 >= YETA_0C63                                     
                                 THEN                                                                       
                                 7500000 + ((YETA_0C63 - 15000000)   * 0.15)                    
                                                                                                            
                                 WHEN 100000000 >= YETA_0C63                                     
                                 THEN                                                                       
                                 12000000 + ((YETA_0C63 - 45000000)   * 0.05)                               
                                 ELSE                                                                       
                                 14750000 + ((YETA_0C63 - 100000000)   * 0.02)                   
                                 END)) ,                                                                    
          /*  YETA_0C65 IS '근로소득금액        */                                                               
           YETA_0C65 = (YETA_0C63 -                                                             
                                 (                                                                          
                                 CASE WHEN YETA_0C63 <= 5000000                               
                                 THEN                                                                       
                                 YETA_0C63 * 0.7                                              
                                 WHEN 15000000 >= YETA_0C63                                     
                                 THEN                                                                       
                                 3500000 + ((YETA_0C63 - 5000000)   * 0.4)                      
                                                                                                            
                                 WHEN 45000000 >= YETA_0C63                                     
                                 THEN                                                                       
                                 7500000 + ((YETA_0C63 - 15000000)   * 0.15)                    
                                                                                                            
                                 WHEN 100000000 >= YETA_0C63                                      
                                 THEN                                                                       
                                 12000000 + ((YETA_0C63 - 45000000)   * 0.05)                   
                                                                                                            
                                 ELSE                                                                       
                                 14750000 + ((YETA_0C63 - 100000000)   * 0.02)                   
                                 END                                                                        
                                 )) 
                                  , ISMT=#ismt#
				   			, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				   			, REVN_ADDR=#revnAddr#                                                                             
             WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#  
				]]>
	</update>		
	 

</sqlMap>
