<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="InfcPkgYeta3200">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="infcPkgYeta3200SerarchVO" type="com.app.smrmf.infc.yearendtax.server.vo.InfcPkgYeta3200SrhVO"/>
	
	<resultMap id="infcPkgYeta3200" class="com.app.smrmf.infc.yearendtax.server.vo.InfcPkgYeta3200VO">
		<result property="dpobCd" column="DPOB_CD" columnIndex="1"/>
		<result property="edacRvyy" column="EDAC_RVYY" columnIndex="2"/>
		<result property="settGbcd" column="SETT_GBCD" columnIndex="3"/> 
		<result property="systemkey" column="SYSTEMKEY" columnIndex="4"/>
		<result property="siteNumb" column="SITE_NUMB" columnIndex="5"/>
		<result property="taxmEa01" column="TAXM_EA01" columnIndex="6"/>
		<result property="taxmEb01" column="TAXM_EB01" columnIndex="7"/>
		<result property="taxmEc01" column="TAXM_EC01" columnIndex="8"/>
		<result property="taxmEd01" column="TAXM_ED01" columnIndex="9"/>
		<result property="taxmEe01" column="TAXM_EE01" columnIndex="10"/>
		<result property="taxmEe02" column="TAXM_EE02" columnIndex="11"/>
		<result property="taxmEe10" column="TAXM_EE10" columnIndex="12"/>
		<result property="taxmEf01" column="TAXM_EF01" columnIndex="13"/>
		<result property="taxmEg01" column="TAXM_EG01" columnIndex="14"/>
		<result property="taxmEh01" column="TAXM_EH01" columnIndex="15"/>
		<result property="taxmEh02" column="TAXM_EH02" columnIndex="16"/>
		<result property="taxmEh03" column="TAXM_EH03" columnIndex="17"/>
		<result property="taxmEh04" column="TAXM_EH04" columnIndex="18"/>
		<result property="taxmEh05" column="TAXM_EH05" columnIndex="19"/>
		<result property="taxmEh06" column="TAXM_EH06" columnIndex="20"/>
		<result property="taxmEh07" column="TAXM_EH07" columnIndex="21"/>
		<result property="taxmEh08" column="TAXM_EH08" columnIndex="22"/>
		<result property="taxmEh09" column="TAXM_EH09" columnIndex="23"/>
		<result property="taxmEh10" column="TAXM_EH10" columnIndex="24"/>
		<result property="taxmEh14" column="TAXM_EH14" columnIndex="25"/>
		<result property="taxmEh15" column="TAXM_EH15" columnIndex="26"/>
		<result property="taxmEh11" column="TAXM_EH11" columnIndex="27"/>
		<result property="taxmEh12" column="TAXM_EH12" columnIndex="28"/>
		<result property="taxmEh13" column="TAXM_EH13" columnIndex="29"/>
		<result property="taxmEh16" column="TAXM_EH16" columnIndex="30"/>
		<result property="taxmEi01" column="TAXM_EI01" columnIndex="31"/>
		<result property="taxmEj01" column="TAXM_EJ01" columnIndex="32"/>
		<result property="taxmEj10" column="TAXM_EJ10" columnIndex="33"/>
		<result property="taxmEk01" column="TAXM_EK01" columnIndex="34"/>
		<result property="taxmEl01" column="TAXM_EL01" columnIndex="35"/>
		<result property="taxmEm01" column="TAXM_EM01" columnIndex="36"/>
		<result property="taxmEm02" column="TAXM_EM02" columnIndex="37"/>
		<result property="taxmEm03" column="TAXM_EM03" columnIndex="38"/>
		<result property="taxmEn01" column="TAXM_EN01" columnIndex="39"/>
		<result property="taxmEo01" column="TAXM_EO01" columnIndex="40"/>
		<result property="taxmEp01" column="TAXM_EP01" columnIndex="41"/>
		<result property="taxmEp02" column="TAXM_EP02" columnIndex="42"/>
		<result property="taxmEq01" column="TAXM_EQ01" columnIndex="43"/>
		<result property="taxmEr01" column="TAXM_ER01" columnIndex="44"/>
		<result property="taxmEr10" column="TAXM_ER10" columnIndex="45"/>
		<result property="taxmEs01" column="TAXM_ES01" columnIndex="46"/>
		<result property="taxmEy02" column="TAXM_EY02" columnIndex="47"/>
		<result property="taxmEy03" column="TAXM_EY03" columnIndex="48"/>
		<result property="taxmEy21" column="TAXM_EY21" columnIndex="49"/>
		<result property="taxmEy22" column="TAXM_EY22" columnIndex="50"/>
		<result property="taxmEt01" column="TAXM_ET01" columnIndex="51"/>
		<result property="taxmEt10" column="TAXM_ET10" columnIndex="52"/> 
		<result property="taxmEt20" column="TAXM_ET20" columnIndex="53"/>
		<result property="kybdr" column="KYBDR" columnIndex="54"/>
		<result property="inptDt" column="INPT_DT" columnIndex="55"/>
		<result property="inptAddr" column="INPT_ADDR" columnIndex="56"/>
		<result property="ismt" column="ISMT" columnIndex="57"/>
		<result property="revnDt" column="REVN_DT" columnIndex="58"/>
		<result property="revnAddr" column="REVN_ADDR" columnIndex="59"/>
	</resultMap>
	
	<insert id="infcPkgYeta3200DAO.insertYetaPrc3200_S">
		<![CDATA[
			INSERT INTO YETA3200 
				( DPOB_CD
				  , EDAC_RVYY
				  , SETT_GBCD 
				  , SYSTEMKEY
				  , SITE_NUMB
				  , TAXM_EA01
				  , TAXM_EB01
				  , TAXM_EC01
				  , TAXM_ED01
				  , TAXM_EE01
				  , TAXM_EE02
				  , TAXM_EE10
				  , TAXM_EF01
				  , TAXM_EG01
				  , TAXM_EH01
				  , TAXM_EH02
				  , TAXM_EH03
				  , TAXM_EH04
				  , TAXM_EH05
				  , TAXM_EH06
				  , TAXM_EH07
				  , TAXM_EH08
				  , TAXM_EH09
				  , TAXM_EH10
				  , TAXM_EH14
				  , TAXM_EH15
				  , TAXM_EH11
				  , TAXM_EH12
				  , TAXM_EH13
				  , TAXM_EH16
				  , TAXM_EI01
				  , TAXM_EJ01
				  , TAXM_EJ10
				  , TAXM_EK01
				  , TAXM_EL01
				  , TAXM_EM01
				  , TAXM_EM02
				  , TAXM_EM03
				  , TAXM_EN01
				  , TAXM_EO01
				  , TAXM_EP01
				  , TAXM_EP02
				  , TAXM_EQ01
				  , TAXM_ER01
				  , TAXM_ER10
				  , TAXM_ES01
				  , TAXM_EY02
				  , TAXM_EY03
				  , TAXM_EY04
				  , TAXM_EY21
				  , TAXM_EY22
				  , TAXM_ET01
				  , TAXM_ET10
				   , TAXM_ET11
				    , TAXM_ET12
				  , TAXM_ET20
				  , KYBDR
				  , INPT_DT
				  , INPT_ADDR
				  , ISMT
				  , REVN_DT
				  , REVN_ADDR )
			VALUES ( #dpobCd#
				  , #edacRvyy#
				  , #settGbcd#
				  , #systemkey#
				  , #siteNumb#
				  , #taxmEa01#
				  , #taxmEb01#
				  , #taxmEc01#
				  , #taxmEd01#
				  , #taxmEe01#
				  , #taxmEe02#
				  , #taxmEe10#
				  , #taxmEf01#
				  , #taxmEg01#
				  , #taxmEh01#
				  , #taxmEh02#
				  , #taxmEh03#
				  , #taxmEh04#
				  , #taxmEh05#
				  , #taxmEh06#
				  , #taxmEh07#
				  , #taxmEh08#
				  , #taxmEh09#
				  , #taxmEh10#
				  , #taxmEh14#
				  , #taxmEh15#
				  , #taxmEh11#
				  , #taxmEh12#
				  , #taxmEh13#
				  , #taxmEh16#
				  , #taxmEi01#
				  , #taxmEj01#
				  , #taxmEj10#
				  , #taxmEk01#
				  , #taxmEl01#
				  , #taxmEm01#
				  , #taxmEm02#
				  , #taxmEm03#
				  , #taxmEn01#
				  , #taxmEo01#
				  , #taxmEp01#
				  , #taxmEp02#
				  , #taxmEq01#
				  , #taxmEr01#
				  , #taxmEr10#
				  , #taxmEs01#
				  , #taxmEy02#
				  , #taxmEy03#
				  , #taxmEy04#
				  , #taxmEy21#
				  , #taxmEy22#
				  , #taxmEt01#
				  , #taxmEt10#
				   , #taxmEt11#
				    , #taxmEt12#
				  , #taxmEt20#
				  , #kybdr#
				  , #inptDt#
				  , #inptAddr#
				  , #ismt#
				  , #revnDt#
				  , #revnAddr# )
		]]>
	</insert>
	
	<!-- yeta0100 화면  -->
	<insert id="infcPkgYeta3200DAO.fnPayr06420_YETA3200_2015_CREATE_Insert_S">
		<![CDATA[
			INSERT INTO YETA3200 
				(   DPOB_CD
				  , EDAC_RVYY
				  , SETT_GBCD 
				  , SYSTEMKEY
				  , SITE_NUMB
				  , TAXM_EA01
				  , TAXM_EB01
				  , TAXM_EC01
				  , TAXM_ED01
				  , TAXM_EE01
				  , TAXM_EE02
				  , TAXM_EE10
				  , TAXM_EF01
				  , TAXM_EG01
				  , TAXM_EH01
				  , TAXM_EH02
				  , TAXM_EH03
				  , TAXM_EH04
				  , TAXM_EH05
				  , TAXM_EH06
				  , TAXM_EH07
				  , TAXM_EH08
				  , TAXM_EH09
				  , TAXM_EH10
				  , TAXM_EH14
				  , TAXM_EH15
				  , TAXM_EH11
				  , TAXM_EH12
				  , TAXM_EH13
				  , TAXM_EH16
				  , TAXM_EI01
				  , TAXM_EJ01
				  , TAXM_EJ10
				  , TAXM_EK01
				  , TAXM_EL01
				  , TAXM_EM01
				  , TAXM_EM02
				  , TAXM_EM03
				  , TAXM_EN01
				  , TAXM_EO01
				  , TAXM_EP01
				  , TAXM_EP02
				  , TAXM_EQ01
				  , TAXM_ER01
				  , TAXM_ER10
				  , TAXM_ES01
				  , TAXM_EY02
				  , TAXM_EY03
				   , TAXM_EY04
				  , TAXM_EY21
				  , TAXM_EY22
				  , TAXM_ET01
				  , TAXM_ET10
				  , TAXM_ET11
				  , TAXM_ET12
				  , TAXM_ET20
				  , KYBDR
				  , INPT_DT
				  , INPT_ADDR
				  , ISMT
				  , REVN_DT
				  , REVN_ADDR )
				  (
				  SELECT AA.DPOB_CD
					      , #edacRvyy#
						  , #settGbcd#
					      ,AA.SYSTEMKEY  
						  , '0000000000' AS SITE_NUMB
					      ,(0) AS taxmEa01
					      ,(0) AS taxmEb01
					      ,(0) AS taxmEc01
						  ,(0) AS taxmEd01
						  ,(0) AS taxmEe01
						  ,(0) AS taxmEe02
						  ,(0) AS taxmEe10
						  ,(0) AS taxmEf01
						  ,(0) AS taxmEg01
						  ,(0) AS taxmEh01
						  ,(0) AS taxmEh02 
						   ,  NVL( ( 
						             SELECT SUM(PYMT_DDUC_FREE_DTY_SUM)
						             FROM 
						             (SELECT DPOB_CD
						                    ,PYMT_YR_MNTH
						                    , SYSTEMKEY
						                    , PAY_ITEM_CD
						                    , PYMT_DDUC_FREE_DTY_SUM  
							              FROM  PAYR0302
							             WHERE PAY_ITEM_CD  = 'C9100200'
							         UNION ALL
							         SELECT  DPOB_CD
						                    ,PYYT_YR_MNTH
						                    ,SYSTEMKEY
						                    ,PYYT_ITEM_CD
						                    ,PYYT_PYDD_FREE_DTY_SUM  
							              FROM  PYYT0302
							             WHERE PYYT_ITEM_CD   = 'C9100200' ) A03   
							             WHERE  A03.DPOB_CD = AA.DPOB_CD
							               AND  A03.PYMT_YR_MNTH = AA.PYMT_YR_MNTH 
							               AND  A03.SYSTEMKEY = AA.SYSTEMKEY
							               AND  A03.PAY_ITEM_CD  = 'C9100200' 
							             )
							          , 0)   AS taxmEh03 /*  자가운전보조금    */
						  ,(0) AS taxmEh04
						  ,(0) AS taxmEh05
						  ,(0) AS taxmEh06
						  ,(0) AS taxmEh07
						  ,(0) AS taxmEh08
						  ,(0) AS taxmEh09
						  ,(0) AS taxmEh10
						  ,(0) AS taxmEh14
						  ,(0) AS taxmEh15
						  ,(0) AS taxmEh11
						  ,(0) AS taxmEh12
						  ,(0) AS taxmEh13
						  ,(0) AS taxmEh16
						  ,(0) AS taxmEi01
						  ,(0) AS taxmEj01
						  ,(0) AS taxmEj10
						  ,(0) AS taxmEk01
						  ,(0) AS taxmEl01
						  ,(0) AS taxmEm01
						  ,(0) AS taxmEm02
						  ,(0) AS taxmEm03
						  ,(0) AS taxmEn01
						  ,(0) AS taxmEo01	  
						   , NVL( ( 
						             SELECT SUM(PYMT_DDUC_FREE_DTY_SUM)
						             FROM 
						             (SELECT DPOB_CD
						                    ,PYMT_YR_MNTH
						                    , SYSTEMKEY
						                    , PAY_ITEM_CD
						                    , PYMT_DDUC_FREE_DTY_SUM  
							              FROM  PAYR0302
							             WHERE PAY_ITEM_CD  = 'C9080100'
							         UNION ALL
							         SELECT DPOB_CD
						                    ,PYYT_YR_MNTH
						                    ,SYSTEMKEY
						                    ,PYYT_ITEM_CD
						                    ,PYYT_PYDD_FREE_DTY_SUM  
							              FROM  PYYT0302
							             WHERE PYYT_ITEM_CD   = 'C9080100' ) A03   
							             WHERE  A03.DPOB_CD = AA.DPOB_CD
							               AND  A03.PYMT_YR_MNTH = AA.PYMT_YR_MNTH 
							               AND  A03.SYSTEMKEY = AA.SYSTEMKEY
							               AND  A03.PAY_ITEM_CD  = 'C9080100' 
							             )
							          , 0)   AS TAXM_EP01 
						,(0) AS taxmEp02			     
					   
					                , NVL( ( 
						             SELECT SUM(PYMT_DDUC_FREE_DTY_SUM)
						             FROM 
						             (SELECT DPOB_CD
						                    ,PYMT_YR_MNTH
						                    , SYSTEMKEY
						                    , PAY_ITEM_CD
						                    , PYMT_DDUC_FREE_DTY_SUM  
							              FROM  PAYR0302
							             WHERE PAY_ITEM_CD  = 'C9050100'
							         UNION ALL
							         SELECT  DPOB_CD
						                    ,PYYT_YR_MNTH
						                    ,SYSTEMKEY
						                    ,PYYT_ITEM_CD
						                    ,PYYT_PYDD_FREE_DTY_SUM  
							              FROM  PYYT0302
							             WHERE PYYT_ITEM_CD   = 'C9050100' ) A03   
							             WHERE  A03.DPOB_CD = AA.DPOB_CD
							               AND  A03.PYMT_YR_MNTH = AA.PYMT_YR_MNTH 
							               AND  A03.SYSTEMKEY = AA.SYSTEMKEY
							               AND  A03.PAY_ITEM_CD  = 'C9050100' 
							             )
							          , 0)  AS TAXM_EQ01
					  	,(0) AS taxmEr01	
						,(0) AS taxmEr10	
						,(0) AS taxmEs01	
						,(0) AS taxmEy02	
						,(0) AS taxmEy03	
						,(0) AS taxmEy04	
						,(0) AS taxmEy21	
						,(0) AS taxmEy22	
						,(0) AS taxmEt01	
						,(0) AS taxmEt10	
						,(0) AS taxmEt11
						,(0) AS taxmEt12
						,(0) AS taxmEt20	
					    , #kybdr#
					    , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
					    , #inptAddr#
					    , #ismt#
					    , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
					    , #revnAddr# 
					       ]]>        
					  FROM  (
         SELECT   DISTINCT  AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_CLS_DIV_CD,  DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_CLS_DIV_CD,AD01.DTIL_OCCU_CLS_DIV_CD) ) AS DTIL_OCCU_CLS_DIV_CD 
                                              , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT 
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01, (SELECT
											DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
											   PAY_CD,  PAYR_MANG_DEPT_CD, 
											   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
											   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
											     ODTY_CD, PYSP_CD, 
											     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
											   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
											   HDOFC_DIV_CD, RETRY_DT 
											FROM
											(SELECT 
											   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
											   PAY_CD,  PAYR_MANG_DEPT_CD, 
											   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
											   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
											     ODTY_CD, PYSP_CD, 
											     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
											   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
											   HDOFC_DIV_CD, RETRY_DT 
											FROM  PAYR0304 
											UNION ALL
											SELECT 
											   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY, (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
											   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
											   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
											   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
											   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
											   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
											   HDOFC_DIV_CD, RETRY_DT 
											FROM  PYYT0304)) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #edacRvyy# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY  
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                   SELECT      SEL_NUM ,
												                                    DPOB_CD,
												                                    PYMT_YR_MNTH ,
												                                    PAY_CD ,
												                                    SYSTEMKEY,
												                                    PAYR_SEIL_NUM 
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304
																		WHERE   PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                          GROUP BY SYSTEMKEY
																                   )
									                                            )
									                                            ORDER BY  SEL_NUM DESC 
										                                            ) MM  
										                                             WHERE ROWNUM = 1   
										                                               <isNotEmpty prepend="AND" property="systemkey" >
																	                         SYSTEMKEY=#systemkey#
																	                   </isNotEmpty> 
									                                             ) GG
									                            WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                      /*   AND NN.PAYR_SEIL_NUM =  GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */ 
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #edacRvyy# ||'%'   
         ) AA , 
         	<![CDATA[
          (
          SELECT DISTINCT  AC01.DPOB_CD, AC01.PYMT_YR_MNTH, AC01.SYSTEMKEY, 
                  AC01.PAYR_MANG_DEPT_CD, 
                  AC01.EMYMT_DIV_CD, AC01.HAN_NM,  
                  AC02.PAY_PYMT_DT
            FROM  PAYR0304 AC01 ,(SELECT  A03.DPOB_CD, A03.PYMT_YR_MNTH, A03.SYSTEMKEY
                                       ,MAX (A02.PAY_PYMT_DT) PAY_PYMT_DT
                          FROM PAYR0300 A02 , PAYR0304 A03
                         WHERE     A02.DPOB_CD = A03.DPOB_CD
                               AND A02.PYMT_YR_MNTH = A03.PYMT_YR_MNTH
                               AND A02.PAY_CD = A03.PAY_CD
                               AND A02.PAYR_SEIL_NUM = A03.PAYR_SEIL_NUM 
                               GROUP BY A03.DPOB_CD, A03.PYMT_YR_MNTH, A03.SYSTEMKEY
               )  AC02
               WHERE AC01.DPOB_CD = AC02.DPOB_CD
                 AND AC01.PYMT_YR_MNTH = AC02.PYMT_YR_MNTH
                 AND AC01.SYSTEMKEY = AC02.SYSTEMKEY
      ) BB 
					 WHERE  AA.DPOB_CD = BB.DPOB_CD
					   AND  AA.SYSTEMKEY = BB.SYSTEMKEY 
					   AND  BB.PYMT_YR_MNTH LIKE #edacRvyy# ||'%'  
                      AND AA.DPOB_CD=#dpobCd# 
                    ]]>  
                        AND EXISTS  (
                         SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' )) ) C
                                            WHERE     C.DPOB_CD = AA.DPOB_CD
						                        AND C.DEPT_CD = AA.DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(AA.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(AA.DTIL_OCCU_INTTN_CD,'TT')
                                        	    <isNotEmpty prepend="AND" property="deptCd" >
							                       C.DEPT_CD = #deptCd#
							                   </isNotEmpty>
                                          ) 
                       <isNotEmpty prepend="AND" property="businCd" >
                         AA.BUSIN_CD=#businCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                         BB.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="emymtDivCd" >
                         AA.EMYMT_DIV_CD=#emymtDivCd#
                         </isNotEmpty>  
                    <isNotEmpty prepend="AND" property="typOccuCd" >
                      AA.TYP_OCCU_CD = #typOccuCd#
                   </isNotEmpty> 
                     <isNotEmpty prepend="AND" property="dtilOccuInttnCd" >
                      AA.DTIL_OCCU_INTTN_CD = #dtilOccuInttnCd#
                   </isNotEmpty> 
                          <isNotEmpty prepend="AND" property="systemkey" >
                         AA.SYSTEMKEY=#systemkey#
                       </isNotEmpty>  
                       <isNotEmpty prepend="AND" property="hanNm" >
                         AA.HAN_NM LIKE '%' || #hanNm# || '%'
                       </isNotEmpty>  
                       <isEqual prepend="AND" property="addCheck" compareValue="ADD"> 
                    NOT EXISTS (
                       SELECT * FROM   YETA3200 KK01
                        WHERE KK01.DPOB_CD = AA.DPOB_CD
                          AND KK01.EDAC_RVYY = #edacRvyy#
                          AND KK01.SETT_GBCD = #settGbcd#
                          AND KK01.EDAC_RVYY = SUBSTR(BB.PYMT_YR_MNTH,1,4)
                          AND KK01.SYSTEMKEY =  AA.SYSTEMKEY 
                    )
                  </isEqual>
                    
					   GROUP BY AA.DPOB_CD 
					      ,AA.SYSTEMKEY   
				  ) 
	</insert>
	
	
	<update id="infcPkgYeta3200DAO.updateYetaPrc3200_S">
		<![CDATA[
			UPDATE YETA3200
			SET DPOB_CD=#dpobCd#
				, EDAC_RVYY=#edacRvyy#
				, SETT_GBCD=#settGbcd#
				, SYSTEMKEY=#systemkey#
				, SITE_NUMB=#siteNumb#
				, TAXM_EA01=#taxmEa01#
				, TAXM_EB01=#taxmEb01#
				, TAXM_EC01=#taxmEc01#
				, TAXM_ED01=#taxmEd01#
				, TAXM_EE01=#taxmEe01#
				, TAXM_EE02=#taxmEe02#
				, TAXM_EE10=#taxmEe10#
				, TAXM_EF01=#taxmEf01#
				, TAXM_EG01=#taxmEg01#
				, TAXM_EH01=#taxmEh01#
				, TAXM_EH02=#taxmEh02#
				, TAXM_EH03=#taxmEh03#
				, TAXM_EH04=#taxmEh04#
				, TAXM_EH05=#taxmEh05#
				, TAXM_EH06=#taxmEh06#
				, TAXM_EH07=#taxmEh07#
				, TAXM_EH08=#taxmEh08#
				, TAXM_EH09=#taxmEh09#
				, TAXM_EH10=#taxmEh10#
				, TAXM_EH14=#taxmEh14#
				, TAXM_EH15=#taxmEh15#
				, TAXM_EH11=#taxmEh11#
				, TAXM_EH12=#taxmEh12#
				, TAXM_EH13=#taxmEh13#
				, TAXM_EH16=#taxmEh16#
				, TAXM_EI01=#taxmEi01#
				, TAXM_EJ01=#taxmEj01#
				, TAXM_EJ10=#taxmEj10#
				, TAXM_EK01=#taxmEk01#
				, TAXM_EL01=#taxmEl01#
				, TAXM_EM01=#taxmEm01#
				, TAXM_EM02=#taxmEm02#
				, TAXM_EM03=#taxmEm03#
				, TAXM_EN01=#taxmEn01#
				, TAXM_EO01=#taxmEo01#
				, TAXM_EP01=#taxmEp01#
				, TAXM_EP02=#taxmEp02#
				, TAXM_EQ01=#taxmEq01#
				, TAXM_ER01=#taxmEr01#
				, TAXM_ER10=#taxmEr10#
				, TAXM_ES01=#taxmEs01#
				, TAXM_EY02=#taxmEy02#
				, TAXM_EY03=#taxmEy03#
				, TAXM_EY21=#taxmEy21#
				, TAXM_EY22=#taxmEy22#
				, TAXM_ET01=#taxmEt01#
				, TAXM_ET10=#taxmEt10#
				, TAXM_ET20=#taxmEt20#
				, KYBDR=#kybdr#
				, INPT_DT=#inptDt#
				, INPT_ADDR=#inptAddr#
				, ISMT=#ismt#
				, REVN_DT=#revnDt#
				, REVN_ADDR=#revnAddr#
						WHERE DPOB_CD=#dpobCd#
								AND EDAC_RVYY=#edacRvyy#
								AND SETT_GBCD=#settGbcd#
								AND SYSTEMKEY=#systemkey#
								AND SITE_NUMB=#siteNumb#
				]]>
	</update>
	
	<delete id="infcPkgYeta3200DAO.deleteYetaPrc3200_S">
		<![CDATA[
			DELETE FROM YETA3200 
						WHERE DPOB_CD=#dpobCd#
								AND EDAC_RVYY=#edacRvyy#
								AND SETT_GBCD=#settGbcd#
								AND SYSTEMKEY=#systemkey#
								AND SITE_NUMB=#siteNumb#
				]]>
	</delete>
	
	<!-- yeta0100 화면 연말정산 대상자삭제 -->
		<delete id="infcPkgYeta3200DAO.fnPayr06430_Yeta3200_CREATE_Delete_S">
		<![CDATA[
			DELETE FROM YETA3200 
						WHERE DPOB_CD=#dpobCd#
								AND EDAC_RVYY=#edacRvyy#
								AND SETT_GBCD=#settGbcd# 
				]]>
				 <isNotEmpty prepend="AND" property="systemkey" >
                      SYSTEMKEY=#systemkey#
                   </isNotEmpty> 
	</delete>
	
	
	
	<select id="infcPkgYeta3200DAO.selectYetaPrc3200_S" resultMap="infcPkgYeta3200">
		<![CDATA[
			SELECT
				DPOB_CD
				, EDAC_RVYY
				, SETT_GBCD
				, SYSTEMKEY
				, SITE_NUMB
				, TAXM_EA01
				, TAXM_EB01
				, TAXM_EC01
				, TAXM_ED01
				, TAXM_EE01
				, TAXM_EE02
				, TAXM_EE10
				, TAXM_EF01
				, TAXM_EG01
				, TAXM_EH01
				, TAXM_EH02
				, TAXM_EH03
				, TAXM_EH04
				, TAXM_EH05
				, TAXM_EH06
				, TAXM_EH07
				, TAXM_EH08
				, TAXM_EH09
				, TAXM_EH10
				, TAXM_EH14
				, TAXM_EH15
				, TAXM_EH11
				, TAXM_EH12
				, TAXM_EH13
				, TAXM_EH16
				, TAXM_EI01
				, TAXM_EJ01
				, TAXM_EJ10
				, TAXM_EK01
				, TAXM_EL01
				, TAXM_EM01
				, TAXM_EM02
				, TAXM_EM03
				, TAXM_EN01
				, TAXM_EO01
				, TAXM_EP01
				, TAXM_EP02
				, TAXM_EQ01
				, TAXM_ER01
				, TAXM_ER10
				, TAXM_ES01
				, TAXM_EY02
				, TAXM_EY03
				, TAXM_EY21
				, TAXM_EY22
				, TAXM_ET01
				, TAXM_ET10
				, TAXM_ET20
				, KYBDR
				, INPT_DT
				, INPT_ADDR
				, ISMT
				, REVN_DT
				, REVN_ADDR
			FROM YETA3200
						WHERE DPOB_CD=#dpobCd#
								AND EDAC_RVYY=#edacRvyy#
								AND SETT_GBCD=#settGbcd#
								AND SYSTEMKEY=#systemkey#
								AND SITE_NUMB=#siteNumb#
				]]>
	</select>
	
	<select id="infcPkgYeta3200DAO.selectYetaPrc3200List_D" parameterClass="infcPkgYeta3200SerarchVO" resultClass="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (
				SELECT
								DPOB_CD
								, EDAC_RVYY
								, SETT_GBCD
								, SYSTEMKEY
								, SITE_NUMB
								, TAXM_EA01
								, TAXM_EB01
								, TAXM_EC01
								, TAXM_ED01
								, TAXM_EE01
								, TAXM_EE02
								, TAXM_EE10
								, TAXM_EF01
								, TAXM_EG01
								, TAXM_EH01
								, TAXM_EH02
								, TAXM_EH03
								, TAXM_EH04
								, TAXM_EH05
								, TAXM_EH06
								, TAXM_EH07
								, TAXM_EH08
								, TAXM_EH09
								, TAXM_EH10
								, TAXM_EH14
								, TAXM_EH15
								, TAXM_EH11
								, TAXM_EH12
								, TAXM_EH13
								, TAXM_EH16
								, TAXM_EI01
								, TAXM_EJ01
								, TAXM_EJ10
								, TAXM_EK01
								, TAXM_EL01
								, TAXM_EM01
								, TAXM_EM02
								, TAXM_EM03
								, TAXM_EN01
								, TAXM_EO01
								, TAXM_EP01
								, TAXM_EP02
								, TAXM_EQ01
								, TAXM_ER01
								, TAXM_ER10
								, TAXM_ES01
								, TAXM_EY02
								, TAXM_EY03
								, TAXM_EY21
								, TAXM_EY22
								, TAXM_ET01
								, TAXM_ET10
								, TAXM_ET20
								, KYBDR
								, INPT_DT
								, INPT_ADDR
								, ISMT
								, REVN_DT
								, REVN_ADDR
						FROM YETA3200
				WHERE 1=1
				<isEqual prepend="AND" property="searchCondition" compareValue="0">
					DPOB_CD = #searchKeyword#
				</isEqual>
				<isEqual prepend="AND" property="searchCondition" compareValue="1">
					EDAC_RVYY LIKE '%' || #searchKeyword# || '%'
				</isEqual>
					ORDER BY 
						DPOB_CD DESC
							, EDAC_RVYY DESC
							, SETT_GBCD DESC
							, SYSTEMKEY DESC
							, SITE_NUMB DESC
		
		<![CDATA[					
	) A WHERE ROWNUM <= #lastIndex#
)WHERE RNUM > #firstIndex#
]]>
	</select>	
	<select id="infcPkgYeta3200DAO.selectYetaPrc3200ListTotCnt_S" parameterClass="infcPkgYeta3200SerarchVO" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM YETA3200
			WHERE 1=1
			<isEqual prepend="AND" property="searchCondition" compareValue="0">
				DPOB_CD = #searchKeyword#
			</isEqual>
			<isEqual prepend="AND" property="searchCondition" compareValue="1">
				EDAC_RVYY LIKE '%' || #searchKeyword# || '%'
			</isEqual>
	</select>

</sqlMap>
