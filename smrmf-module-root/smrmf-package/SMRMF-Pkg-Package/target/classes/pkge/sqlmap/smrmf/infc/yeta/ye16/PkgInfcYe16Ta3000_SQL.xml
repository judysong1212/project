<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="InfcPkgYeta3000">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="infcPkgYeta3000SerarchVO" type="com.app.smrmf.infc.yearendtax.server.vo.InfcPkgYeta3000SrhVO"/>
	
	<resultMap id="infcPkgYeta3000" class="com.app.smrmf.infc.yearendtax.server.vo.InfcPkgYeta3000VO">
		<result property="dpobCd" column="DPOB_CD" columnIndex="1"/>
		<result property="edacRvyy" column="EDAC_RVYY" columnIndex="2"/>
		<result property="settGbcd" column="SETT_GBCD" columnIndex="3"/>
		<result property="systemkey" column="SYSTEMKEY" columnIndex="4"/>
		<result property="befoScnt" column="BEFO_SCNT" columnIndex="5"/>
		<result property="payrTamt" column="PAYR_TAMT" columnIndex="6"/>
		<result property="bonsToam" column="BONS_TOAM" columnIndex="7"/>
		<result property="dtmnBsam" column="DTMN_BSAM" columnIndex="8"/>
		<result property="stckPrft" column="STCK_PRFT" columnIndex="9"/>
		<result property="currTots" column="CURR_TOTS" columnIndex="10"/>
		<result property="taxmSfam" column="TAXM_SFAM" columnIndex="11"/>
		<result property="taxmEtam" column="TAXM_ETAM" columnIndex="12"/>
		<result property="taxmBoin" column="TAXM_BOIN" columnIndex="13"/>
		<result property="txecAmnt" column="TXEC_AMNT" columnIndex="14"/>
		<result property="totlSala" column="TOTL_SALA" columnIndex="15"/>
		<result property="wkerDdct" column="WKER_DDCT" columnIndex="16"/>
		<result property="wkerAmnt" column="WKER_AMNT" columnIndex="17"/>
		<result property="baseSelf" column="BASE_SELF" columnIndex="18"/>
		<result property="baseWife" column="BASE_WIFE" columnIndex="19"/>
		<result property="baseFyam" column="BASE_FYAM" columnIndex="20"/>
		<result property="addrHdam" column="ADDR_HDAM" columnIndex="21"/>
		<result property="addrRpt70" column="ADDR_RPT70" columnIndex="22"/>
		<result property="addrFame" column="ADDR_FAME" columnIndex="23"/>
		<result property="addrChld" column="ADDR_CHLD" columnIndex="24"/>
		<result property="addrBrth" column="ADDR_BRTH" columnIndex="25"/>
		<result property="pantOnam" column="PANT_ONAM" columnIndex="26"/>
		<result property="addrMcam" column="ADDR_MCAM" columnIndex="27"/>
		<result property="bnatDdct" column="BNAT_DDCT" columnIndex="28"/>
		<result property="jnatDdct" column="JNAT_DDCT" columnIndex="29"/>
		<result property="bpssDdct" column="BPSS_DDCT" columnIndex="30"/>
		<result property="bpssHsol" column="BPSS_HSOL" columnIndex="31"/>
		<result property="bpssHtec" column="BPSS_HTEC" columnIndex="32"/>
		<result property="bpssHpul" column="BPSS_HPUL" columnIndex="33"/>
		<result property="jpssDdct" column="JPSS_DDCT" columnIndex="34"/>
		<result property="jpssHsol" column="JPSS_HSOL" columnIndex="35"/>
		<result property="jpssHtec" column="JPSS_HTEC" columnIndex="36"/>
		<result property="jpssHpul" column="JPSS_HPUL" columnIndex="37"/>
		<result property="brtrHict" column="BRTR_HICT" columnIndex="38"/>
		<result property="brtrPsrn" column="BRTR_PSRN" columnIndex="39"/>
		<result property="brtrHnsv" column="BRTR_HNSV" columnIndex="40"/>
		<result property="jrtrHict" column="JRTR_HICT" columnIndex="41"/>
		<result property="jrtrPsrn" column="JRTR_PSRN" columnIndex="42"/>
		<result property="jrtrHnsv" column="JRTR_HNSV" columnIndex="43"/>
		<result property="rrptYnam" column="RRPT_YNAM" columnIndex="44"/>
		<result property="spciBhth" column="SPCI_BHTH" columnIndex="45"/>
		<result property="spciJhth" column="SPCI_JHTH" columnIndex="46"/>
		<result property="spciBepf" column="SPCI_BEPF" columnIndex="47"/>
		<result property="spciJepf" column="SPCI_JEPF" columnIndex="48"/>
		<result property="spciGurt" column="SPCI_GURT" columnIndex="49"/>
		<result property="spciHdrc" column="SPCI_HDRC" columnIndex="50"/>
		<result property="spciRtde" column="SPCI_RTDE" columnIndex="51"/>
		<result property="spciHrto" column="SPCI_HRTO" columnIndex="52"/>
		<result property="spciSelf" column="SPCI_SELF" columnIndex="53"/>
		<result property="spciHe65" column="SPCI_HE65" columnIndex="54"/>
		<result property="spciHbps" column="SPCI_HBPS" columnIndex="55"/>
		<result property="spciDetc" column="SPCI_DETC" columnIndex="56"/>
		<result property="spciTxcr" column="SPCI_TXCR" columnIndex="57"/>
		<result property="spciMeto" column="SPCI_METO" columnIndex="58"/>
		<result property="spedSelf" column="SPED_SELF" columnIndex="59"/>
		<result property="spedGrde" column="SPED_GRDE" columnIndex="60"/>
		<result property="spedGdto" column="SPED_GDTO" columnIndex="61"/>
		<result property="spedCldv" column="SPED_CLDV" columnIndex="62"/>
		<result property="spciSpec" column="SPCI_SPEC" columnIndex="63"/>
		<result property="spedTxcr" column="SPED_TXCR" columnIndex="64"/>
		<result property="spedToam" column="SPED_TOAM" columnIndex="65"/>
		<result property="spciRefn" column="SPCI_REFN" columnIndex="66"/>
		<result property="spciResf" column="SPCI_RESF" columnIndex="67"/>
		<result property="spciTgrt" column="SPCI_TGRT" columnIndex="68"/>
		<result property="spciRtam" column="SPCI_RTAM" columnIndex="69"/>
		<result property="spchRefn" column="SPCH_REFN" columnIndex="70"/>
		<result property="spchRe15" column="SPCH_RE15" columnIndex="71"/>
		<result property="spchRe29" column="SPCH_RE29" columnIndex="72"/>
		<result property="spchRe30" column="SPCH_RE30" columnIndex="73"/>
		<result property="spciRefx" column="SPCI_REFX" columnIndex="74"/>
		<result property="spciReec" column="SPCI_REEC" columnIndex="75"/>
		<result property="spci15fx" column="SPCI_15FX" columnIndex="76"/>
		<result property="spci15fb" column="SPCI_15FB" columnIndex="77"/>
		<result property="spci15ec" column="SPCI_15EC" columnIndex="78"/>
		<result property="spci10fb" column="SPCI_10FB" columnIndex="79"/>
		<result property="spci10ec" column="SPCI_10EC" columnIndex="80"/>
		<result property="spchReto" column="SPCH_RETO" columnIndex="81"/>
		<result property="taxdPltc" column="TAXD_PLTC" columnIndex="82"/>
		<result property="spciPltc" column="SPCI_PLTC" columnIndex="83"/>
		<result property="spciFbam" column="SPCI_FBAM" columnIndex="84"/>
		<result property="spciExam" column="SPCI_EXAM" columnIndex="85"/>
		<result property="spciUnon" column="SPCI_UNON" columnIndex="86"/>
		<result property="spciRfam" column="SPCI_RFAM" columnIndex="87"/>
		<result property="spciYamt" column="SPCI_YAMT" columnIndex="88"/>
		<result property="spciNamt" column="SPCI_NAMT" columnIndex="89"/>
		<result property="spciDgcr" column="SPCI_DGCR" columnIndex="90"/>
		<result property="spciSsum" column="SPCI_SSUM" columnIndex="91"/>
		<result property="spciDdct" column="SPCI_DDCT" columnIndex="92"/>
		<result property="subtEram" column="SUBT_ERAM" columnIndex="93"/>
		<result property="etcpPsnv" column="ETCP_PSNV" columnIndex="94"/>
		<result property="etcpNsav" column="ETCP_NSAV" columnIndex="95"/>
		<result property="prcmToam" column="PRCM_TOAM" columnIndex="96"/>
		<result property="etchPrep" column="ETCH_PREP" columnIndex="97"/>
		<result property="etcsComp" column="ETCS_COMP" columnIndex="98"/>
		<result property="etwkSbam" column="ETWK_SBAM" columnIndex="99"/>
		<result property="etwkSvam" column="ETWK_SVAM" columnIndex="100"/>
		<result property="etwkLgam" column="ETWK_LGAM" columnIndex="101"/>
		<result property="etwkBdam" column="ETWK_BDAM" columnIndex="102"/>
		<result property="etctConc" column="ETCT_CONC" columnIndex="103"/>
		<result property="etgd09af" column="ETGD_09AF" columnIndex="104"/>
		<result property="etgdH13h" column="ETGD_H13H" columnIndex="105"/>
		<result property="etgdD14f" column="ETGD_D14F" columnIndex="106"/>
		<result property="etgdDdam" column="ETGD_DDAM" columnIndex="107"/>
		<result property="etccCard" column="ETCC_CARD" columnIndex="108"/>
		<result property="etckUnon" column="ETCK_UNON" columnIndex="109"/>
		<result property="etckUncr" column="ETCK_UNCR" columnIndex="110"/>
		<result property="etepMsam" column="ETEP_MSAM" columnIndex="111"/>
		<result property="etgdHtra" column="ETGD_HTRA" columnIndex="112"/>
		<result property="etepSecr" column="ETEP_SECR" columnIndex="113"/>
		<result property="etclTo01" column="ETCL_TO01" columnIndex="114"/>
		<result property="etclTo02" column="ETCL_TO02" columnIndex="115"/>
		<result property="etclTo03" column="ETCL_TO03" columnIndex="116"/>
		<result property="etclHmto" column="ETCL_HMTO" columnIndex="117"/>
		<result property="etcdTsum" column="ETCD_TSUM" columnIndex="118"/>
		<result property="spchExli" column="SPCH_EXLI" columnIndex="119"/>
		<result property="stndIncm" column="STND_INCM" columnIndex="120"/>
		<result property="prddTaxn" column="PRDD_TAXN" columnIndex="121"/>
		<result property="taxdIcax" column="TAXD_ICAX" columnIndex="122"/>
		<result property="taxdSpct" column="TAXD_SPCT" columnIndex="123"/>
		<result property="txlgCl30" column="TXLG_CL30" columnIndex="124"/>
		<result property="txlgHxtt" column="TXLG_HXTT" columnIndex="125"/>
		<result property="taxdTsum" column="TAXD_TSUM" columnIndex="126"/>
		<result property="taxdWken" column="TAXD_WKEN" columnIndex="127"/>
		<result property="taxdUnin" column="TAXD_UNIN" columnIndex="128"/>
		<result property="taxdLoan" column="TAXD_LOAN" columnIndex="129"/>
		<result property="taxdPaid" column="TAXD_PAID" columnIndex="130"/>
		<result property="taxdRedu" column="TAXD_REDU" columnIndex="131"/>
		<result property="addrMccr" column="ADDR_MCCR" columnIndex="132"/>
		<result property="spciDcto" column="SPCI_DCTO" columnIndex="133"/>
		<result property="taxdCsum" column="TAXD_CSUM" columnIndex="134"/>
		<result property="dcsnIncm" column="DCSN_INCM" columnIndex="135"/>
		<result property="dcsnInhb" column="DCSN_INHB" columnIndex="136"/>
		<result property="dcsnFafv" column="DCSN_FAFV" columnIndex="137"/>
		<result property="alryPinx" column="ALRY_PINX" columnIndex="138"/>
		<result property="alryPhbx" column="ALRY_PHBX" columnIndex="139"/>
		<result property="alryYvtx" column="ALRY_YVTX" columnIndex="140"/>
		<result property="dcsnTots" column="DCSN_TOTS" columnIndex="141"/>
		<result property="dcsnItax" column="DCSN_ITAX" columnIndex="142"/>
		<result property="dcsnBtax" column="DCSN_BTAX" columnIndex="143"/>
		<result property="fafvTaxi" column="FAFV_TAXI" columnIndex="144"/>
		<result property="subtEtax" column="SUBT_ETAX" columnIndex="145"/>
		<result property="subtInhb" column="SUBT_INHB" columnIndex="146"/>
		<result property="subtFafv" column="SUBT_FAFV" columnIndex="147"/>
		<result property="subtAmsu" column="SUBT_AMSU" columnIndex="148"/>
		<result property="jrtrHnto" column="JRTR_HNTO" columnIndex="149"/>
		<result property="spciOnon" column="SPCI_ONON" columnIndex="150"/>
		<result property="spciObam" column="SPCI_OBAM" columnIndex="151"/>
		<result property="spciOyam" column="SPCI_OYAM" columnIndex="152"/>
		<result property="spciOnam" column="SPCI_ONAM" columnIndex="153"/>
		<result property="kybdr" column="KYBDR" columnIndex="154"/>
		<result property="inptDt" column="INPT_DT" columnIndex="155"/>
		<result property="inptAddr" column="INPT_ADDR" columnIndex="156"/>
		<result property="ismt" column="ISMT" columnIndex="157"/>
		<result property="revnDt" column="REVN_DT" columnIndex="158"/>
		<result property="revnAddr" column="REVN_ADDR" columnIndex="159"/>
	</resultMap>
	
	
	
	
	<!-- yeta1100 화면 연말정산 상세   -->
	<insert id="infcPkgYeta3000DAO.fnYeta1100_YETA3000_2016_CREATE_Insert_S">
		<![CDATA[
			INSERT INTO YETA3000 
				( DPOB_CD
				  , EDAC_RVYY
				  , SETT_GBCD
				  , SYSTEMKEY 
				  , PAYR_TAMT
				  , BONS_TOAM
				  , DTMN_BSAM
				  , STCK_PRFT
				   ,CURR_WORK_EMPTK_WDRW_SUM	 
                  , CURR_WORK_ECTE_RETCE_SUM	   
				  , CURR_TOTS
				  , TAXM_BOIN
				  , TXEC_AMNT
				  , TOTL_SALA
				  , WKER_DDCT
				  , WKER_AMNT
				  , BASE_SELF
				  , JNAT_DDCT 
				  , SPCI_JHTH  
				  , SPCI_JEPF  
				  , ALRY_PINX  
				  , ALRY_PHBX  
				  , ALRY_YVTX
				  , KYBDR
				  , INPT_DT
				  , INPT_ADDR
				  , ISMT
				  , REVN_DT
				  , REVN_ADDR )
			( SELECT   CC.DPOB_CD,                                                            
           CC.EDAC_RVYY, 
           BB.CLUT_SEPT_CD,                                            
           AA.SYSTEMKEY,                                         
           BB.SUPR_TXAM,                                         
           BB.BUAM_TXAM,                                         
           BB.INBS_AMNT,                                         
           BB.STCK_INAM, 
           BB.CURR_WORK_EMPTK_WDRW_SUM,	 
           BB.CURR_WORK_ECTE_RETCE_SUM	,                                        
           (BB.SUPR_TXAM + BB.BUAM_TXAM + BB.INBS_AMNT + BB.STCK_INAM 
            + NVL(BB.CURR_WORK_EMPTK_WDRW_SUM,0) + NVL(BB.CURR_WORK_ECTE_RETCE_SUM,0)),     
           (0)  AS TAXM_BOIN,                                                                 
           BB.TAXM_ECIN,                                                                 
           (BB.SUPR_TXAM + BB.BUAM_TXAM + BB.INBS_AMNT + BB.STCK_INAM 
            + NVL(BB.CURR_WORK_EMPTK_WDRW_SUM,0) + NVL(BB.CURR_WORK_ECTE_RETCE_SUM,0)),                         
      
            (CASE WHEN (BB.SUPR_TXAM + BB.BUAM_TXAM + BB.INBS_AMNT + BB.STCK_INAM 
            + NVL(BB.CURR_WORK_EMPTK_WDRW_SUM,0) + NVL(BB.CURR_WORK_ECTE_RETCE_SUM,0)) <= 5000000                     
           THEN                                                                               
           (BB.SUPR_TXAM + BB.BUAM_TXAM + BB.INBS_AMNT + BB.STCK_INAM 
            + NVL(BB.CURR_WORK_EMPTK_WDRW_SUM,0) + NVL(BB.CURR_WORK_ECTE_RETCE_SUM,0)) * 0.7                                      
                                                                                              
           WHEN 15000000 > (BB.SUPR_TXAM + BB.BUAM_TXAM + BB.INBS_AMNT + BB.STCK_INAM 
            + NVL(BB.CURR_WORK_EMPTK_WDRW_SUM,0) + NVL(BB.CURR_WORK_ECTE_RETCE_SUM,0))                            
           THEN                                                                               
           3500000 + (((BB.SUPR_TXAM + BB.BUAM_TXAM + BB.INBS_AMNT + BB.STCK_INAM 
            + NVL(BB.CURR_WORK_EMPTK_WDRW_SUM,0) + NVL(BB.CURR_WORK_ECTE_RETCE_SUM,0)) - 5000000)   * 0.4)              
                                                                                              
           WHEN 45000000 >= (BB.SUPR_TXAM + BB.BUAM_TXAM + BB.INBS_AMNT + BB.STCK_INAM 
            + NVL(BB.CURR_WORK_EMPTK_WDRW_SUM,0) + NVL(BB.CURR_WORK_ECTE_RETCE_SUM,0))                          
           THEN                                                                               
           7500000 + (((BB.SUPR_TXAM + BB.BUAM_TXAM + BB.INBS_AMNT + BB.STCK_INAM 
            + NVL(BB.CURR_WORK_EMPTK_WDRW_SUM,0) + NVL(BB.CURR_WORK_ECTE_RETCE_SUM,0)) - 15000000)   * 0.15)           
                                                                                              
           WHEN 100000000 >= (BB.SUPR_TXAM + BB.BUAM_TXAM + BB.INBS_AMNT + BB.STCK_INAM 
            + NVL(BB.CURR_WORK_EMPTK_WDRW_SUM,0) + NVL(BB.CURR_WORK_ECTE_RETCE_SUM,0))                            
           THEN                                                                               
           12000000 + (((BB.SUPR_TXAM + BB.BUAM_TXAM + BB.INBS_AMNT + BB.STCK_INAM 
            + NVL(BB.CURR_WORK_EMPTK_WDRW_SUM,0) + NVL(BB.CURR_WORK_ECTE_RETCE_SUM,0)) - 45000000)   * 0.05)            
                                                                                              
           ELSE                                                                               
           14750000 + (((BB.SUPR_TXAM + BB.BUAM_TXAM + BB.INBS_AMNT + BB.STCK_INAM 
            + NVL(BB.CURR_WORK_EMPTK_WDRW_SUM,0) + NVL(BB.CURR_WORK_ECTE_RETCE_SUM,0)) - 100000000)   * 0.02)           
           END) AS PAYR_IN01,                                                                 
           ((BB.SUPR_TXAM + BB.BUAM_TXAM + BB.INBS_AMNT + BB.STCK_INAM 
            + NVL(BB.CURR_WORK_EMPTK_WDRW_SUM,0) + NVL(BB.CURR_WORK_ECTE_RETCE_SUM,0)) -                                         
           (CASE WHEN (BB.SUPR_TXAM + BB.BUAM_TXAM + BB.INBS_AMNT + BB.STCK_INAM 
            + NVL(BB.CURR_WORK_EMPTK_WDRW_SUM,0) + NVL(BB.CURR_WORK_ECTE_RETCE_SUM,0)) <= 5000000                      
           THEN                                                                               
           (BB.SUPR_TXAM + BB.BUAM_TXAM + BB.INBS_AMNT + BB.STCK_INAM 
            + NVL(BB.CURR_WORK_EMPTK_WDRW_SUM,0) + NVL(BB.CURR_WORK_ECTE_RETCE_SUM,0)) * 0.7                                      
                                                                                              
           WHEN 15000000 >= (BB.SUPR_TXAM + BB.BUAM_TXAM + BB.INBS_AMNT + BB.STCK_INAM 
            + NVL(BB.CURR_WORK_EMPTK_WDRW_SUM,0) + NVL(BB.CURR_WORK_ECTE_RETCE_SUM,0))                             
           THEN                                                                               
           3500000 + (((BB.SUPR_TXAM + BB.BUAM_TXAM + BB.INBS_AMNT + BB.STCK_INAM 
            + NVL(BB.CURR_WORK_EMPTK_WDRW_SUM,0) + NVL(BB.CURR_WORK_ECTE_RETCE_SUM,0)) - 5000000)   * 0.4)              
                                                                                              
           WHEN 45000000 >= (BB.SUPR_TXAM + BB.BUAM_TXAM + BB.INBS_AMNT + BB.STCK_INAM 
            + NVL(BB.CURR_WORK_EMPTK_WDRW_SUM,0) + NVL(BB.CURR_WORK_ECTE_RETCE_SUM,0))                            
           THEN                                                                               
           7500000 + (((BB.SUPR_TXAM + BB.BUAM_TXAM + BB.INBS_AMNT + BB.STCK_INAM 
            + NVL(BB.CURR_WORK_EMPTK_WDRW_SUM,0) + NVL(BB.CURR_WORK_ECTE_RETCE_SUM,0)) - 15000000)   * 0.15)            
                                                                                              
           WHEN 100000000 >= (BB.SUPR_TXAM + BB.BUAM_TXAM + BB.INBS_AMNT + BB.STCK_INAM 
            + NVL(BB.CURR_WORK_EMPTK_WDRW_SUM,0) + NVL(BB.CURR_WORK_ECTE_RETCE_SUM,0))                             
           THEN                                                                               
           12000000 + (((BB.SUPR_TXAM + BB.BUAM_TXAM + BB.INBS_AMNT + BB.STCK_INAM 
            + NVL(BB.CURR_WORK_EMPTK_WDRW_SUM,0) + NVL(BB.CURR_WORK_ECTE_RETCE_SUM,0)) - 45000000)   * 0.05)     
           ELSE                                                                               
           14750000 + (((BB.SUPR_TXAM + BB.BUAM_TXAM + BB.INBS_AMNT + BB.STCK_INAM 
            + NVL(BB.CURR_WORK_EMPTK_WDRW_SUM,0) + NVL(BB.CURR_WORK_ECTE_RETCE_SUM,0)) - 100000000)   * 0.02)           
           END)) AS PAYR_IN02,                                                                
           1500000,                                                                           
           BB.NATN_PSNF,                                               
           BB.CURR_WORK_RCP_AGGR_SUM,                                               
           BB.SPCI_EMPF,                                               
           BB.EARN_TAXN,                                                  
           BB.IHTX_TAXN,
           BB.NNKS_SSUM   
          , #kybdr#
		  , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
		  , #inptAddr#
		  , #ismt#
		  , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
		  , #revnAddr#    
		   ]]>                                                                       
           FROM  (
SELECT  DISTINCT   AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                 ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT 
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01, (SELECT
											DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY, PAYR_SEIL_NUM,
											   PAY_CD,  PAYR_MANG_DEPT_CD, 
											   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
											   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
											     ODTY_CD, PYSP_CD, 
											     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
											   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
											   HDOFC_DIV_CD, RETRY_DT 
											FROM
											(SELECT 
											   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY, PAYR_SEIL_NUM,
											   PAY_CD,  PAYR_MANG_DEPT_CD, 
											   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
											   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
											     ODTY_CD, PYSP_CD, 
											     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
											   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
											   HDOFC_DIV_CD, RETRY_DT 
											FROM  PAYR0304 
											UNION ALL
											SELECT 
											   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,(0) AS PAYR_SEIL_NUM, ('B0150000') AS PAY_CD,
											   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
											   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
											   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
											   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
											   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
											   HDOFC_DIV_CD, RETRY_DT 
											FROM  PYYT0304)) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #edacRvyy# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY 
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                   SELECT      SEL_NUM ,
												                                    DPOB_CD,
												                                    PYMT_YR_MNTH ,
												                                    PAY_CD ,
												                                    SYSTEMKEY,
												                                    PAYR_SEIL_NUM 
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		WHERE   PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                          GROUP BY SYSTEMKEY
																                   )
									                                            )
									                                            ORDER BY  SEL_NUM DESC 
										                                            ) MM  
										                                             WHERE ROWNUM = 1   
										                                               <isNotEmpty prepend="AND" property="systemkey" >
																	                         SYSTEMKEY=#systemkey#
																	                   </isNotEmpty> 
									                                             ) GG
									                            WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                        /* AND NN.PAYR_SEIL_NUM =  GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 	AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 	AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 	AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 	AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   	AND AD02.PAY_CD  = AD03.PAY_CD
                                                 	AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  	AND AD02.PYMT_YR_MNTH LIKE #edacRvyy# ||'%'  
              ) AA ,    
               <![CDATA[                                                                 
               (                                                                              
                SELECT DPOB_CD,YRTX_BLGG_YR,                                                             
                       SYSTEMKEY,                                                             
                       CLUT_SEPT_CD,                                                             
                       SUM(SUPR_TXAM) AS SUPR_TXAM,                                  
                       SUM(BUAM_TXAM) AS BUAM_TXAM,                                  
                       SUM(INBS_AMNT) AS INBS_AMNT,                                  
                       SUM(STCK_INAM) AS STCK_INAM,    
                       SUM(CURR_WORK_EMPTK_WDRW_SUM) AS CURR_WORK_EMPTK_WDRW_SUM,
                       SUM(CURR_WORK_ECTE_RETCE_SUM) AS CURR_WORK_ECTE_RETCE_SUM ,	                       
                       SUM(SPCI_HLTH) AS SPCI_HLTH ,   /* 현근무지건강보험료금액 */
                       SUM(ECIN_TXAM) AS ECIN_TXAM,	/* 외국인소득금액_과세 */	 
                       SUM(TAXM_ECIN) AS TAXM_ECIN,	/* 외국인소득금액_비과세	 */
					   SUM(CURR_WORK_RCP_INSUR_SUM) AS CURR_WORK_RCP_INSUR_SUM ,	/* 현근무지요양보험료금액 */
					   SUM(CURR_WORK_RCP_AGGR_SUM) AS CURR_WORK_RCP_AGGR_SUM ,	/* 현근무지건강요양보험료합계금액 */ 
                       SUM(SPCI_EMPF) AS SPCI_EMPF,                                  
                       SUM(NATN_PSNF) AS NATN_PSNF,                                  
                       SUM(EARN_TAXN) AS EARN_TAXN,                                  
                       SUM(IHTX_TAXN) AS IHTX_TAXN,
                       SUM(NNKS_SSUM) AS NNKS_SSUM,
                       SUM(ETCC_TXAM) AS ETCC_TXAM,
                       SUM(ETCC_ETAM) AS ETCC_ETAM,
                       SUM(SPBM_TXAM) AS SPBM_TXAM   /* 현근무지 과세합계금액  */                                   
                  FROM YE160401                                                                
                 WHERE DPOB_CD = #dpobCd#
                   AND YRTX_BLGG_YR = #edacRvyy#
                   AND CLUT_SEPT_CD = #settGbcd#                                               
                 GROUP BY DPOB_CD, YRTX_BLGG_YR, SYSTEMKEY,  CLUT_SEPT_CD  ) BB
            , YETA2000 CC                                                             
           WHERE BB.DPOB_CD   = AA.DPOB_CD 
             AND BB.SYSTEMKEY = AA.SYSTEMKEY  
             AND BB.DPOB_CD   = CC.DPOB_CD                                      
             AND BB.SYSTEMKEY = CC.SYSTEMKEY                                        
             AND BB.YRTX_BLGG_YR = CC.EDAC_RVYY                                        
             AND BB.CLUT_SEPT_CD = CC.SETT_GBCD 
             AND CC.EDAC_RVYY = #edacRvyy#                                  
             AND CC.DPOB_CD   = #dpobCd#                                             
             AND CC.SETT_GBCD = #settGbcd# 
             ]]>  
              <isNotEmpty prepend="AND" property="systemkey" >
                        CC.SYSTEMKEY=#systemkey#
             </isNotEmpty> 
                 AND EXISTS  (
                               SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             ( 
                                              SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#edacRvyy# )) ) C 
                                            WHERE     C.DPOB_CD = CC.DPOB_CD
						                        AND C.DEPT_CD = CC.DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(CC.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(CC.DTIL_OCCU_INTTN_CD,'TT')
                                        	   <isNotEmpty prepend="AND" property="deptCd" >
							                       C.DEPT_CD = #deptCd#
							                   </isNotEmpty>
                                          ) 
                       <isNotEmpty prepend="AND" property="businCd" >
                         CC.BUSIN_CD=#businCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                         CC.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="emymtDivCd" >
                         CC.EMYMT_DIV_CD=#emymtDivCd#
                         </isNotEmpty>   
                           <isNotEmpty property="typOccuCd" prepend="AND">
                    <![CDATA[
                     CC.TYP_OCCU_CD
                    ]]>
                    <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
                     #typOccuCdArr[]#
                    </iterate>
                    </isNotEmpty>  
                  
                    <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 CC.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate> 
				  </isNotEmpty>	
                   <!-- <isNotEmpty prepend="AND" property="typOccuCd" >
                      CC.TYP_OCCU_CD = #typOccuCd#
                   </isNotEmpty> 
                     <isNotEmpty prepend="AND" property="dtilOccuInttnCd" >
                      CC.DTIL_OCCU_INTTN_CD = #dtilOccuInttnCd#
                   </isNotEmpty>  -->
                    <isEqual prepend="AND" property="addCheck" compareValue="ADD">
                  EXISTS
                      (SELECT *
                         FROM (SELECT  KF01.DPOB_CD 
                                     , KF01.EDAC_RVYY
                                     , KF01.SETT_GBCD 
                                     , KF01.SYSTEMKEY 
                                 FROM YETA2000 KF01
                                 WHERE NOT EXISTS (
                                           SELECT 1 FROM 
                                            YETA3000 KK02
                                        WHERE KK02.DPOB_CD = KF01.DPOB_CD
                                          AND KK02.EDAC_RVYY = #edacRvyy#
                                          AND KK02.SETT_GBCD = #settGbcd#
                                          AND KK02.EDAC_RVYY = KF01.EDAC_RVYY
                                          AND KK02.SETT_GBCD = KF01.SETT_GBCD
                                          AND KK02.SYSTEMKEY = KF01.SYSTEMKEY
                                 )) KK01
                        WHERE     KK01.DPOB_CD = CC.DPOB_CD
                              AND KK01.EDAC_RVYY =  #edacRvyy#
                              AND KK01.SETT_GBCD = #settGbcd#
                              AND KK01.EDAC_RVYY = CC.EDAC_RVYY
                              AND KK01.SETT_GBCD = BB.CLUT_SEPT_CD
                              AND KK01.SYSTEMKEY = AA.SYSTEMKEY) 
                  </isEqual>
		)
	</insert> 
	
	
 	<!-- *****급여자료 이관 - 연말정산 YETA3000 업데이트   [5]**  -->
	<update id="infcPkgYeta3000DAO.fnYeta1100_YETA3000_PAYR_2016_CREATE_Update">
		<![CDATA[
		                                                               
UPDATE  YETA3000                                                                                         
		SET   PAYR_TAMT = ( SELECT SUM(YE160401.SUPR_TXAM )                                                                           
							FROM ( SELECT DPOB_CD
											, YRTX_BLGG_YR
											, ELCT_YYMM
											, SYSTEMKEY
											, CLUT_SEPT_CD
											, SUM(NVL(SUPR_TXAM,0)) AS SUPR_TXAM                                           
					          		FROM YE160401                                                                         
					       			GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                             
					        	   ) YE160401                                                                                
							WHERE YE160401.SYSTEMKEY = YETA3000.SYSTEMKEY                                                  
					 			AND YE160401.YRTX_BLGG_YR = YETA3000.EDAC_RVYY                                                   
								AND YE160401.CLUT_SEPT_CD = YETA3000.SETT_GBCD 
					     		AND YE160401.DPOB_CD = YETA3000.DPOB_CD)  			  /* 주근무지_급여총액  */            
              
             , BONS_TOAM = ( SELECT SUM(YE160401.BUAM_TXAM)                                                                   
                         	 FROM ( SELECT DPOB_CD
                         	 				, YRTX_BLGG_YR
                         	 				, ELCT_YYMM
                         	 				, SYSTEMKEY
                         	 				, CLUT_SEPT_CD
                         	 				, SUM(NVL(BUAM_TXAM,0)) AS BUAM_TXAM                          
	                           		FROM YE160401                                                                         
					       			GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                    
	                              ) YE160401                                                                       
                          WHERE YE160401.SYSTEMKEY = YETA3000.SYSTEMKEY                                          
                            AND YE160401.YRTX_BLGG_YR = YETA3000.EDAC_RVYY                                         
                            AND YE160401.CLUT_SEPT_CD = YETA3000.SETT_GBCD
                            AND YE160401.DPOB_CD = YETA3000.DPOB_CD )   				  /* 주근무지_상여총액 */  
                                      
             , DTMN_BSAM = ( SELECT SUM(YE160401.INBS_AMNT)                                                                 
			         			FROM ( SELECT DPOB_CD
			         							, YRTX_BLGG_YR
			         							, ELCT_YYMM
			         							, SYSTEMKEY
			         							, CLUT_SEPT_CD
			         							, SUM(NVL(INBS_AMNT,0)) AS INBS_AMNT                                      
			                      		FROM YE160401                                                                 
			                 			GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                      
			                              ) YE160401                                                                      
			                          WHERE YE160401.SYSTEMKEY = YETA3000.SYSTEMKEY                                        
			                            AND YE160401.YRTX_BLGG_YR = YETA3000.EDAC_RVYY                                        
			                            AND YE160401.CLUT_SEPT_CD = YETA3000.SETT_GBCD
			                            AND YE160401.DPOB_CD = YETA3000.DPOB_CD )  		  /* 주근무지_인정상여총액 */  
			                                  
             , STCK_PRFT = ( SELECT SUM(YE160401.STCK_INAM )                                                                 
			            		FROM ( SELECT DPOB_CD
			            						, YRTX_BLGG_YR
			            						, ELCT_YYMM
			            						, SYSTEMKEY
			            						, CLUT_SEPT_CD
			            						, SUM(NVL(STCK_INAM,0)) AS STCK_INAM                                     
			                   			FROM YE160401                                                                
			                        	GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                  
			                              ) YE160401                                                                      
			                          WHERE YE160401.SYSTEMKEY = YETA3000.SYSTEMKEY                                        
			                            AND YE160401.YRTX_BLGG_YR = YETA3000.EDAC_RVYY                                        
			                            AND YE160401.CLUT_SEPT_CD = YETA3000.SETT_GBCD
			                            AND YE160401.DPOB_CD = YETA3000.DPOB_CD ) 		 /* 주근무지_주식행사이익 */    

                    , CURR_WORK_EMPTK_WDRW_SUM = ( SELECT SUM(YE160401.CURR_WORK_EMPTK_WDRW_SUM  )                                                                
			            		FROM ( SELECT DPOB_CD
			            						, YRTX_BLGG_YR
			            						, ELCT_YYMM
			            						, SYSTEMKEY
			            						, CLUT_SEPT_CD
			            						, SUM(NVL(CURR_WORK_EMPTK_WDRW_SUM,0)) AS CURR_WORK_EMPTK_WDRW_SUM                                     
			                   			FROM YE160401                                                                
			                        	GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                  
			                              ) YE160401                                                                      
			                          WHERE YE160401.SYSTEMKEY = YETA3000.SYSTEMKEY                                        
			                            AND YE160401.YRTX_BLGG_YR = YETA3000.EDAC_RVYY                                        
			                            AND YE160401.CLUT_SEPT_CD = YETA3000.SETT_GBCD
			                            AND YE160401.DPOB_CD = YETA3000.DPOB_CD ) 		 /*  	현근무지우리사주조합인출금액  */    

                  , CURR_WORK_ECTE_RETCE_SUM = ( SELECT SUM(YE160401.CURR_WORK_ECTE_RETCE_SUM   )                                                               
			            		FROM ( SELECT DPOB_CD
			            						, YRTX_BLGG_YR
			            						, ELCT_YYMM
			            						, SYSTEMKEY
			            						, CLUT_SEPT_CD
			            						, SUM(NVL(CURR_WORK_ECTE_RETCE_SUM,0)) AS CURR_WORK_ECTE_RETCE_SUM                                     
			                   			FROM YE160401                                                                
			                        	GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                  
			                              ) YE160401                                                                      
			                          WHERE YE160401.SYSTEMKEY = YETA3000.SYSTEMKEY                                        
			                            AND YE160401.YRTX_BLGG_YR = YETA3000.EDAC_RVYY                                        
			                            AND YE160401.CLUT_SEPT_CD = YETA3000.SETT_GBCD
			                            AND YE160401.DPOB_CD = YETA3000.DPOB_CD ) 		 /* 현근무지임원퇴직소득금액한도초과금액 */    
			                               
             , CURR_TOTS = ( SELECT ( SUM(YE160401.SUPR_TXAM) 
             							+ SUM(YE160401.BUAM_TXAM )
             							+ SUM(YE160401.INBS_AMNT )
             							+ SUM(YE160401.STCK_INAM )
						 				+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0)) 
						 				+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0)))    
		     					FROM ( SELECT DPOB_CD
		     									, YRTX_BLGG_YR
		     									, ELCT_YYMM
		     									, SYSTEMKEY
		     									, CLUT_SEPT_CD
		     									, SUM(NVL(SUPR_TXAM,0)) AS SUPR_TXAM
		     									, SUM(NVL(BUAM_TXAM,0)) AS BUAM_TXAM
		     									, SUM(NVL(INBS_AMNT,0)) AS INBS_AMNT
		     									, SUM(NVL(STCK_INAM,0)) AS STCK_INAM       
											, SUM(CURR_WORK_EMPTK_WDRW_SUM) AS CURR_WORK_EMPTK_WDRW_SUM
										        , SUM(CURR_WORK_ECTE_RETCE_SUM) AS CURR_WORK_ECTE_RETCE_SUM	
		                    			FROM YE160401                                                               
		                                GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                  
		                              ) YE160401                                                                     
		                          WHERE YE160401.SYSTEMKEY = YETA3000.SYSTEMKEY                                       
		                           	AND YE160401.YRTX_BLGG_YR = YETA3000.EDAC_RVYY                                        
			                    	AND YE160401.CLUT_SEPT_CD = YETA3000.SETT_GBCD
		                            AND YE160401.DPOB_CD = YETA3000.DPOB_CD ) 		 	/* 주근무지총급여액 */    
		                                    
              , TAXM_SFAM = 0		 /* 비과세_자가운전보조금액 */    
                            
              , TAXM_ETAM = 0 		 /* 비과세_급양비금액*/           
              , TAXM_BOIN = 0  														 	/* 비과세_보육수당*/                                                       
              , TXEC_AMNT = ( SELECT SUM(YE160401.TAXM_ECIN )                                                               
			             		FROM ( SELECT DPOB_CD
			             						, YRTX_BLGG_YR
			             						, ELCT_YYMM
			             						, SYSTEMKEY
			             						, CLUT_SEPT_CD
			             						, SUM(NVL(TAXM_ECIN,0)) AS TAXM_ECIN                                   
			                   			FROM YE160401                                                               
			                           	GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                  
			                		) YE160401                                                                    
			           			WHERE YE160401.SYSTEMKEY = YETA3000.SYSTEMKEY                                      
			                 		AND YE160401.YRTX_BLGG_YR = YETA3000.EDAC_RVYY                                        
			                    	AND YE160401.CLUT_SEPT_CD = YETA3000.SETT_GBCD
			                  		AND YE160401.DPOB_CD = YETA3000.DPOB_CD)  		 /* 비과세_외국인소득금액*/   
			                  		    
              , TOTL_SALA = ( SELECT ( SUM(YE160401.SUPR_TXAM) 
              							+ SUM(YE160401.BUAM_TXAM )
              							+ SUM(YE160401.INBS_AMNT )
              							+ SUM(YE160401.STCK_INAM )
						 				+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0))
						 				+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 			  )  
                          		FROM ( SELECT DPOB_CD
                          						, YRTX_BLGG_YR
                          						, ELCT_YYMM
                          						, SYSTEMKEY
                          						, CLUT_SEPT_CD
                          						, SUM(NVL(SUPR_TXAM,0)) AS SUPR_TXAM
                          						, SUM(NVL(BUAM_TXAM,0)) AS BUAM_TXAM
		                                      	, SUM(NVL(INBS_AMNT,0)) AS INBS_AMNT
		                                      	, SUM(NVL(STCK_INAM,0)) AS STCK_INAM
		                                      	, SUM(NVL(SPBM_TXAM,0)) AS SPBM_TXAM
												, SUM(CURR_WORK_EMPTK_WDRW_SUM) AS CURR_WORK_EMPTK_WDRW_SUM
							  					, SUM(CURR_WORK_ECTE_RETCE_SUM) AS CURR_WORK_ECTE_RETCE_SUM	
		                                      /*	, SUM(NVL(TAXM_EARN,0)) AS TAXM_EARN
		                                       	, SUM(NVL(TXET_TXAM,0)) AS TXET_TXAM
		                                      	, SUM(NVL(TAXM_ETAM,0)) AS TAXM_ETAM   */
		                                      	, SUM(NVL(ECIN_TXAM,0)) AS ECIN_TXAM
		                                      	, SUM(NVL(TAXM_ECIN,0)) AS TAXM_ECIN
		                                      	, SUM(NVL(SPCI_HLTH,0)) AS SPCI_HLTH
		                                      	, SUM(NVL(SPCI_EMPF,0)) AS SPCI_EMPF
		                                      	, SUM(NVL(NATN_PSNF,0)) AS NATN_PSNF
		                                      	, SUM(NVL(EARN_TAXN,0)) AS EARN_TAXN
		                                      	, SUM(NVL(IHTX_TAXN,0)) AS IHTX_TAXN                                
		                         		FROM YE160401                                                           
		                    			GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                               
		                              ) YE160401                                                                 
                          	WHERE YE160401.SYSTEMKEY = YETA3000.SYSTEMKEY                                   
                            	AND YE160401.YRTX_BLGG_YR = YETA3000.EDAC_RVYY                                        
			                    AND YE160401.CLUT_SEPT_CD = YETA3000.SETT_GBCD
                          		AND YE160401.DPOB_CD = YETA3000.DPOB_CD )  					 /* 총급여_현_전*/   
                          		          
              , WKER_DDCT = ( SELECT  ( CASE WHEN ( SUM(YE160401.SUPR_TXAM) 
              											+ SUM(YE160401.BUAM_TXAM) 
              											+ SUM(YE160401.INBS_AMNT )
              											+ SUM(YE160401.STCK_INAM )
						 								+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0)) 
						 								+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 						   )  <= 5000000                
			                          		THEN ( SUM(YE160401.SUPR_TXAM )
			                          				+ SUM(YE160401.BUAM_TXAM )
			                          				+ SUM(YE160401.INBS_AMNT )
			                          				+ SUM(YE160401.STCK_INAM )
						 							+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 							+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 						  )  * 0.7                                 
			                                                                                                        
			                          	 WHEN 15000000 >= ( SUM(YE160401.SUPR_TXAM )
			                          	 						+ SUM(YE160401.BUAM_TXAM )
			                          	 						+ SUM(YE160401.INBS_AMNT )
			                          	 						+ SUM(YE160401.STCK_INAM )
						 										+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 										+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 								  )                       
			                          		THEN 3500000 + ((( SUM(YE160401.SUPR_TXAM )
			                          							+ SUM(YE160401.BUAM_TXAM )
			                          							+ SUM(YE160401.INBS_AMNT )
			                          							+ SUM(YE160401.STCK_INAM )
						 										+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 										+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0) )
						 									   )  - 5000000)   * 0.4)         
			                                                                                                        
			                          	 WHEN 45000000 >= ( SUM(YE160401.SUPR_TXAM) 
			                          	 						+ SUM(YE160401.BUAM_TXAM )
			                          	 						+ SUM(YE160401.INBS_AMNT )
			                          	 						+ SUM(YE160401.STCK_INAM )
						 										+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0)) 
						 										+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 								  )                      
			                          		THEN 7500000 + ((( SUM(YE160401.SUPR_TXAM )
			                          							+ SUM(YE160401.BUAM_TXAM )
			                          							+ SUM(YE160401.INBS_AMNT )
			                          							+ SUM(YE160401.STCK_INAM )
						 										+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 										+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 									  )  - 15000000)   * 0.15)        
			                                                                                                         
			                          	 WHEN 100000000 >= ( SUM(YE160401.SUPR_TXAM )
			                          	 						+ SUM(YE160401.BUAM_TXAM )
			                          	 						+ SUM(YE160401.INBS_AMNT )
			                          	 						+ SUM(YE160401.STCK_INAM )
						 										+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 										+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 									)                        
			                          		THEN 12000000 + ((( SUM(YE160401.SUPR_TXAM )
			                          								+ SUM(YE160401.BUAM_TXAM )
			                          								+ SUM(YE160401.INBS_AMNT )
			                          								+ SUM(YE160401.STCK_INAM )
						 											+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 											+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 										)  
						 										- 45000000)   * 0.05)       
			                                                                                                         
			                             ELSE 14750000 + ((( SUM(YE160401.SUPR_TXAM )
			                             						+ SUM(YE160401.BUAM_TXAM )
			                             						+ SUM(YE160401.INBS_AMNT )
			                             						+ SUM(YE160401.STCK_INAM )
						 										+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0)) 
						 										+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 									)  
						 									- 100000000)   * 0.02)       
			                            END) AS PAYR_IN01                                                            
	                          FROM ( SELECT DPOB_CD
	                          				, YRTX_BLGG_YR
	                          				, ELCT_YYMM
	                          				, SYSTEMKEY
	                          				, CLUT_SEPT_CD
		                                    , SUM(NVL(SUPR_TXAM,0)) AS SUPR_TXAM
		                                    , SUM(NVL(BUAM_TXAM,0)) AS BUAM_TXAM
		                                    , SUM(NVL(INBS_AMNT,0)) AS INBS_AMNT
		                                    , SUM(NVL(STCK_INAM,0)) AS STCK_INAM
		                                    , SUM(NVL(SPBM_TXAM,0)) AS SPBM_TXAM
						    				, SUM(CURR_WORK_EMPTK_WDRW_SUM) AS CURR_WORK_EMPTK_WDRW_SUM
							 				, SUM(CURR_WORK_ECTE_RETCE_SUM) AS CURR_WORK_ECTE_RETCE_SUM	
		                                  /*  , SUM(NVL(TAXM_EARN,0)) AS TAXM_EARN
		                                    , SUM(NVL(TXET_TXAM,0)) AS TXET_TXAM
		                                    , SUM(NVL(TAXM_ETAM,0)) AS TAXM_ETAM  */
		                                    , SUM(NVL(ECIN_TXAM,0)) AS ECIN_TXAM
		                                    , SUM(NVL(TAXM_ECIN,0)) AS TAXM_ECIN
		                                    , SUM(NVL(SPCI_HLTH,0)) AS SPCI_HLTH
		                                    , SUM(NVL(SPCI_EMPF,0)) AS SPCI_EMPF
		                                    , SUM(NVL(NATN_PSNF,0)) AS NATN_PSNF
		                                    , SUM(NVL(EARN_TAXN,0)) AS EARN_TAXN
		                                    , SUM(NVL(IHTX_TAXN,0)) AS IHTX_TAXN                                
		                      			FROM YE160401                                                           
		                                GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                
		                              ) YE160401                                                                 
	                          WHERE YE160401.SYSTEMKEY = YETA3000.SYSTEMKEY                                   
	                   			AND YE160401.YRTX_BLGG_YR = YETA3000.EDAC_RVYY                                        
			                    AND YE160401.CLUT_SEPT_CD = YETA3000.SETT_GBCD
                            AND YE160401.DPOB_CD = YETA3000.DPOB_CD)  					 	/* 근로소득공제 */       
                                  
              , WKER_AMNT = ( SELECT ( ( SUM(YE160401.SUPR_TXAM )
              								+ SUM(YE160401.BUAM_TXAM )
              								+ SUM(YE160401.INBS_AMNT )
              								+ SUM(YE160401.STCK_INAM )
						 					+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 					+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 			  )
						 					
              							- ( CASE WHEN ( SUM(YE160401.SUPR_TXAM )
              												+ SUM(YE160401.BUAM_TXAM )
              												+ SUM(YE160401.INBS_AMNT )
              												+ SUM(YE160401.STCK_INAM )
						 									+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 									+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 								) <= 5000000                 
					                          		THEN ( SUM(YE160401.SUPR_TXAM )
					                          				+ SUM(YE160401.BUAM_TXAM) 
					                          				+ SUM(YE160401.INBS_AMNT )
					                          				+ SUM(YE160401.STCK_INAM )
							 								+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
							 								+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
							 							 ) * 0.7                                  
				                                                                                                        
				                          	  	WHEN 15000000 >= ( SUM(YE160401.SUPR_TXAM )
				                          	  						+ SUM(YE160401.BUAM_TXAM )
				                          	  						+ SUM(YE160401.INBS_AMNT )
				                          	  						+ SUM(YE160401.STCK_INAM )
						 											+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 											+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 										  )                    
				                          			THEN 3500000 + ((( SUM(YE160401.SUPR_TXAM )
				                          								+ SUM(YE160401.BUAM_TXAM )
				                          								+ SUM(YE160401.INBS_AMNT )
				                          								+ SUM(YE160401.STCK_INAM )
						 												+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0)) 
						 												+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 											  ) - 5000000)   * 0.4)          
				                                                                                                         
				                          	  	WHEN 45000000 >= ( SUM(YE160401.SUPR_TXAM )
				                          	  						+ SUM(YE160401.BUAM_TXAM )
				                          	  						+ SUM(YE160401.INBS_AMNT )
				                          	  						+ SUM(YE160401.STCK_INAM )
						 											+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0)) 
						 											+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0)) 
						 										 )                     
				                          			THEN 7500000 + ((( SUM(YE160401.SUPR_TXAM )
				                          								+ SUM(YE160401.BUAM_TXAM )
				                          								+ SUM(YE160401.INBS_AMNT )
				                          								+ SUM(YE160401.STCK_INAM )
						 												+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 												+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 											   ) - 15000000)   * 0.15)        
				                                                                                                         
				                              	WHEN 100000000 >= ( SUM(YE160401.SUPR_TXAM )
				                              							+ SUM(YE160401.BUAM_TXAM )
				                              							+ SUM(YE160401.INBS_AMNT )
				                              							+ SUM(YE160401.STCK_INAM )
						 												+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 												+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 											)                      
				                          			THEN 12000000 + ((( SUM(YE160401.SUPR_TXAM )
				                          									+ SUM(YE160401.BUAM_TXAM )
				                          									+ SUM(YE160401.INBS_AMNT )
				                          									+ SUM(YE160401.STCK_INAM )
						 													+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 													+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0) )
						 											    ) - 45000000)   * 0.05)       
				                          	  ELSE 14750000 + ((( SUM(YE160401.SUPR_TXAM )
				                          	  						+ SUM(YE160401.BUAM_TXAM )
				                          	  						+ SUM(YE160401.INBS_AMNT )
				                          	  						+ SUM(YE160401.STCK_INAM )
						 											+ SUM(NVL(YE160401.CURR_WORK_EMPTK_WDRW_SUM,0) )
						 											+ SUM(NVL(YE160401.CURR_WORK_ECTE_RETCE_SUM,0))
						 										  ) - 100000000)   * 0.02)       
				                          	END)) AS PAYR_IN02    
				                          	                                                          
	                          FROM ( SELECT DPOB_CD
	                          				, YRTX_BLGG_YR
	                          				, ELCT_YYMM
	                          				, SYSTEMKEY
	                                      	, CLUT_SEPT_CD
	                                      	, SUM(NVL(SUPR_TXAM,0)) AS SUPR_TXAM
	                                      	, SUM(NVL(BUAM_TXAM,0)) AS BUAM_TXAM
	                                      	, SUM(NVL(INBS_AMNT,0)) AS INBS_AMNT
	                                      	, SUM(NVL(STCK_INAM,0)) AS STCK_INAM
	                                      	, SUM(NVL(SPBM_TXAM,0)) AS SPBM_TXAM
						 					, SUM(CURR_WORK_EMPTK_WDRW_SUM) AS CURR_WORK_EMPTK_WDRW_SUM
							  				, SUM(CURR_WORK_ECTE_RETCE_SUM) AS CURR_WORK_ECTE_RETCE_SUM	
	                                      /*	, SUM(NVL(TAXM_EARN,0)) AS TAXM_EARN
	                                      	, SUM(NVL(TXET_TXAM,0)) AS TXET_TXAM
	                                      	, SUM(NVL(TAXM_ETAM,0)) AS TAXM_ETAM  */
	                                      	, SUM(NVL(ECIN_TXAM,0)) AS ECIN_TXAM
	                                      	, SUM(NVL(TAXM_ECIN,0)) AS TAXM_ECIN
	                                      	, SUM(NVL(SPCI_HLTH,0)) AS SPCI_HLTH
	                                      	, SUM(NVL(SPCI_EMPF,0)) AS SPCI_EMPF
	                                      	, SUM(NVL(NATN_PSNF,0)) AS NATN_PSNF
	                                      	, SUM(NVL(EARN_TAXN,0)) AS EARN_TAXN
	                                      	, SUM(NVL(IHTX_TAXN,0)) AS IHTX_TAXN                                  
	                                 	FROM YE160401                                                             
	                                	GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                 
	                              	) YE160401                                                                   
                          WHERE YE160401.SYSTEMKEY = YETA3000.SYSTEMKEY                                     
                            	AND YE160401.YRTX_BLGG_YR = YETA3000.EDAC_RVYY                                        
			                    AND YE160401.CLUT_SEPT_CD = YETA3000.SETT_GBCD
			                    ]]>
                           	 	AND YE160401.DPOB_CD = YETA3000.DPOB_CD )  				<!-- /* 근로소득금액 */  -->             
                                                                                                          
             , JNAT_DDCT = ( SELECT SUM(YE160401.NATN_PSNF )                                                              
	                          FROM ( SELECT DPOB_CD
	                          				, YRTX_BLGG_YR
	                          				, ELCT_YYMM
	                          				, SYSTEMKEY
	                          				, CLUT_SEPT_CD
	                          				, SUM(NVL(NATN_PSNF,0)) AS NATN_PSNF                                    
	                          		FROM YE160401                                                               
	                           		GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                    
	                              ) YE160401                                                                    
	                          WHERE YE160401.SYSTEMKEY = YETA3000.SYSTEMKEY                                      
	                            AND YE160401.YRTX_BLGG_YR = YETA3000.EDAC_RVYY                                        
			                    AND YE160401.CLUT_SEPT_CD = YETA3000.SETT_GBCD 
	                            AND YE160401.DPOB_CD = YETA3000.DPOB_CD )   			<!-- /* 국민연금보험료 공제 */ -->    
                               
             , SPCI_JHTH = ( SELECT SUM(YE160401.SPCI_HLTH   )                                                             
			         			FROM ( SELECT DPOB_CD
			         							, YRTX_BLGG_YR
			         							, ELCT_YYMM
			         							, SYSTEMKEY
			         							, CLUT_SEPT_CD
			         							, SUM(NVL(CURR_WORK_RCP_AGGR_SUM,0)) AS SPCI_HLTH                                    
			                      		FROM YE160401                                                               
			                    		GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                    
			                   			) YE160401                                                                     
			           		WHERE YE160401.SYSTEMKEY = YETA3000.SYSTEMKEY                                       
			         			AND YE160401.YRTX_BLGG_YR = YETA3000.EDAC_RVYY                                        
			                    AND YE160401.CLUT_SEPT_CD = YETA3000.SETT_GBCD
			            		AND YE160401.DPOB_CD = YETA3000.DPOB_CD )  				<!-- /* 특별공제 주건강보험 */  -->       
                             
             , SPCI_JEPF = ( SELECT SUM(YE160401.SPCI_EMPF   )                                                              
		                		FROM ( SELECT DPOB_CD
		                						, YRTX_BLGG_YR
		                						, ELCT_YYMM
		                						, SYSTEMKEY
		                						, CLUT_SEPT_CD
		                						, SUM(NVL(SPCI_EMPF,0)) AS SPCI_EMPF                                    
		                        		FROM YE160401                                                               
		                                GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                  
		                 			) YE160401                                                                    
		                		WHERE YE160401.SYSTEMKEY = YETA3000.SYSTEMKEY                                       
		                            AND YE160401.YRTX_BLGG_YR = YETA3000.EDAC_RVYY                                        
			                    	AND YE160401.CLUT_SEPT_CD = YETA3000.SETT_GBCD
		                            AND YE160401.DPOB_CD = YETA3000.DPOB_CD )   		<!-- /* 주고용보험료 */   -->   
                                      
             , ALRY_PINX = ( SELECT SUM(YE160401.EARN_TAXN)                                                                
	                          FROM ( SELECT DPOB_CD
	                          				, YRTX_BLGG_YR
	                          				, ELCT_YYMM
	                          				, SYSTEMKEY
	                          				, CLUT_SEPT_CD
	                          				, SUM(NVL(EARN_TAXN,0)) AS EARN_TAXN                                   
	                          		FROM YE160401                                                              
	                        		GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                   
	                   			) YE160401                                                                    
	                          WHERE YE160401.SYSTEMKEY = YETA3000.SYSTEMKEY                                      
	                            AND YE160401.YRTX_BLGG_YR = YETA3000.EDAC_RVYY                                        
			                    AND YE160401.CLUT_SEPT_CD = YETA3000.SETT_GBCD
	                            AND YE160401.DPOB_CD = YETA3000.DPOB_CD)   			<!-- /* 기납부세액 소득 */   -->     
                                
             , ALRY_PHBX  = ( SELECT SUM(YE160401.IHTX_TAXN )                                                             
                          		FROM ( SELECT DPOB_CD
                          						, YRTX_BLGG_YR
                          						, ELCT_YYMM
                          						, SYSTEMKEY
		                                      	, CLUT_SEPT_CD
		                                      	, SUM(NVL(IHTX_TAXN,0)) AS IHTX_TAXN                                  
		                          		FROM YE160401                                                              
		                                GROUP BY DPOB_CD, YRTX_BLGG_YR ,ELCT_YYMM ,SYSTEMKEY ,CLUT_SEPT_CD                                  
		                              ) YE160401                                                                   
                          	WHERE YE160401.SYSTEMKEY = YETA3000.SYSTEMKEY                                      
                            	AND YE160401.YRTX_BLGG_YR = YETA3000.EDAC_RVYY                                        
			                    AND YE160401.CLUT_SEPT_CD = YETA3000.SETT_GBCD  
                            	AND YE160401.DPOB_CD = YETA3000.DPOB_CD)    			<!-- /* 기납부 주민세 */  -->   
                                    
 	        , ISMT=#ismt#
			, REVN_DT=#revnDt#
			, REVN_ADDR=#revnAddr#
		WHERE DPOB_CD=#dpobCd#
			AND EDAC_RVYY=#yrtxBlggYr#
			AND SETT_GBCD=#clutSeptCd#
			AND SYSTEMKEY=#systemkey#   
				
	</update>		
	
	
	
	
	
	
	
	
	
	
	
	
	<insert id="infcPkgYeta3000DAO.insertYetaPrc3000_S">
		<![CDATA[
			INSERT INTO YETA3000 
				( DPOB_CD
				  , EDAC_RVYY
				  , SETT_GBCD
				  , SYSTEMKEY
				  , BEFO_SCNT
				  , PAYR_TAMT
				  , BONS_TOAM
				  , DTMN_BSAM
				  , STCK_PRFT
				  , CURR_TOTS
				  , TAXM_SFAM
				  , TAXM_ETAM
				  , TAXM_BOIN
				  , TXEC_AMNT
				  , TOTL_SALA
				  , WKER_DDCT
				  , WKER_AMNT
				  , BASE_SELF
				  , BASE_WIFE
				  , BASE_FYAM
				  , ADDR_HDAM
				  , ADDR_RPT70
				  , ADDR_FAME
				  , ADDR_CHLD
				  , ADDR_BRTH
				  , PANT_ONAM
				  , ADDR_MCAM
				  , BNAT_DDCT
				  , JNAT_DDCT
				  , BPSS_DDCT
				  , BPSS_HSOL
				  , BPSS_HTEC
				  , BPSS_HPUL
				  , JPSS_DDCT
				  , JPSS_HSOL
				  , JPSS_HTEC
				  , JPSS_HPUL
				  , BRTR_HICT
				  , BRTR_PSRN
				  , BRTR_HNSV
				  , JRTR_HICT
				  , JRTR_PSRN
				  , JRTR_HNSV
				  , RRPT_YNAM
				  , SPCI_BHTH
				  , SPCI_JHTH
				  , SPCI_BEPF
				  , SPCI_JEPF
				  , SPCI_GURT
				  , SPCI_HDRC
				  , SPCI_RTDE
				  , SPCI_HRTO
				  , SPCI_SELF
				  , SPCI_HE65
				  , SPCI_HBPS
				  , SPCI_DETC
				  , SPCI_TXCR
				  , SPCI_METO
				  , SPED_SELF
				  , SPED_GRDE
				  , SPED_GDTO
				  , SPED_CLDV
				  , SPCI_SPEC
				  , SPED_TXCR
				  , SPED_TOAM
				  , SPCI_REFN
				  , SPCI_RESF
				  , SPCI_TGRT
				  , SPCI_RTAM
				  , SPCH_REFN
				  , SPCH_RE15
				  , SPCH_RE29
				  , SPCH_RE30
				  , SPCI_REFX
				  , SPCI_REEC
				  , SPCI_15FX
				  , SPCI_15FB
				  , SPCI_15EC
				  , SPCI_10FB
				  , SPCI_10EC
				  , SPCH_RETO
				  , TAXD_PLTC
				  , SPCI_PLTC
				  , SPCI_FBAM
				  , SPCI_EXAM
				  , SPCI_UNON
				  , SPCI_RFAM
				  , SPCI_YAMT
				  , SPCI_NAMT
				  , SPCI_DGCR
				  , SPCI_SSUM
				  , SPCI_DDCT
				  , SUBT_ERAM
				  , ETCP_PSNV
				  , ETCP_NSAV
				  , PRCM_TOAM
				  , ETCH_PREP
				  , ETCS_COMP
				  , ETWK_SBAM
				  , ETWK_SVAM
				  , ETWK_LGAM
				  , ETWK_BDAM
				  , ETCT_CONC
				  , ETGD_09AF
				  , ETGD_H13H
				  , ETGD_D14F
				  , ETGD_DDAM
				  , ETCC_CARD
				  , ETCK_UNON
				  , ETCK_UNCR
				  , ETEP_MSAM
				  , ETGD_HTRA
				  , ETEP_SECR
				  , ETCL_TO01
				  , ETCL_TO02
				  , ETCL_TO03
				  , ETCL_HMTO
				  , ETCD_TSUM
				  , SPCH_EXLI
				  , STND_INCM
				  , PRDD_TAXN
				  , TAXD_ICAX
				  , TAXD_SPCT
				  , TXLG_CL30
				  , TXLG_HXTT
				  , TAXD_TSUM
				  , TAXD_WKEN
				  , TAXD_UNIN
				  , TAXD_LOAN
				  , TAXD_PAID
				  , TAXD_REDU
				  , ADDR_MCCR
				  , SPCI_DCTO
				  , TAXD_CSUM
				  , DCSN_INCM
				  , DCSN_INHB
				  , DCSN_FAFV
				  , ALRY_PINX
				  , ALRY_PHBX
				  , ALRY_YVTX
				  , DCSN_TOTS
				  , DCSN_ITAX
				  , DCSN_BTAX
				  , FAFV_TAXI
				  , SUBT_ETAX
				  , SUBT_INHB
				  , SUBT_FAFV
				  , SUBT_AMSU
				  , JRTR_HNTO
				  , SPCI_ONON
				  , SPCI_OBAM
				  , SPCI_OYAM
				  , SPCI_ONAM
				  , KYBDR
				  , INPT_DT
				  , INPT_ADDR
				  , ISMT
				  , REVN_DT
				  , REVN_ADDR )
			VALUES ( #dpobCd#
				  , #edacRvyy#
				  , #settGbcd#
				  , #systemkey#
				  , #befoScnt#
				  , #payrTamt#
				  , #bonsToam#
				  , #dtmnBsam#
				  , #stckPrft#
				  , #currTots#
				  , #taxmSfam#
				  , #taxmEtam#
				  , #taxmBoin#
				  , #txecAmnt#
				  , #totlSala#
				  , #wkerDdct#
				  , #wkerAmnt#
				  , #baseSelf#
				  , #baseWife#
				  , #baseFyam#
				  , #addrHdam#
				  , #addrRpt70#
				  , #addrFame#
				  , #addrChld#
				  , #addrBrth#
				  , #pantOnam#
				  , #addrMcam#
				  , #bnatDdct#
				  , #jnatDdct#
				  , #bpssDdct#
				  , #bpssHsol#
				  , #bpssHtec#
				  , #bpssHpul#
				  , #jpssDdct#
				  , #jpssHsol#
				  , #jpssHtec#
				  , #jpssHpul#
				  , #brtrHict#
				  , #brtrPsrn#
				  , #brtrHnsv#
				  , #jrtrHict#
				  , #jrtrPsrn#
				  , #jrtrHnsv#
				  , #rrptYnam#
				  , #spciBhth#
				  , #spciJhth#
				  , #spciBepf#
				  , #spciJepf#
				  , #spciGurt#
				  , #spciHdrc#
				  , #spciRtde#
				  , #spciHrto#
				  , #spciSelf#
				  , #spciHe65#
				  , #spciHbps#
				  , #spciDetc#
				  , #spciTxcr#
				  , #spciMeto#
				  , #spedSelf#
				  , #spedGrde#
				  , #spedGdto#
				  , #spedCldv#
				  , #spciSpec#
				  , #spedTxcr#
				  , #spedToam#
				  , #spciRefn#
				  , #spciResf#
				  , #spciTgrt#
				  , #spciRtam#
				  , #spchRefn#
				  , #spchRe15#
				  , #spchRe29#
				  , #spchRe30#
				  , #spciRefx#
				  , #spciReec#
				  , #spci15fx#
				  , #spci15fb#
				  , #spci15ec#
				  , #spci10fb#
				  , #spci10ec#
				  , #spchReto#
				  , #taxdPltc#
				  , #spciPltc#
				  , #spciFbam#
				  , #spciExam#
				  , #spciUnon#
				  , #spciRfam#
				  , #spciYamt#
				  , #spciNamt#
				  , #spciDgcr#
				  , #spciSsum#
				  , #spciDdct#
				  , #subtEram#
				  , #etcpPsnv#
				  , #etcpNsav#
				  , #prcmToam#
				  , #etchPrep#
				  , #etcsComp#
				  , #etwkSbam#
				  , #etwkSvam#
				  , #etwkLgam#
				  , #etwkBdam#
				  , #etctConc#
				  , #etgd09af#
				  , #etgdH13h#
				  , #etgdD14f#
				  , #etgdDdam#
				  , #etccCard#
				  , #etckUnon#
				  , #etckUncr#
				  , #etepMsam#
				  , #etgdHtra#
				  , #etepSecr#
				  , #etclTo01#
				  , #etclTo02#
				  , #etclTo03#
				  , #etclHmto#
				  , #etcdTsum#
				  , #spchExli#
				  , #stndIncm#
				  , #prddTaxn#
				  , #taxdIcax#
				  , #taxdSpct#
				  , #txlgCl30#
				  , #txlgHxtt#
				  , #taxdTsum#
				  , #taxdWken#
				  , #taxdUnin#
				  , #taxdLoan#
				  , #taxdPaid#
				  , #taxdRedu#
				  , #addrMccr#
				  , #spciDcto#
				  , #taxdCsum#
				  , #dcsnIncm#
				  , #dcsnInhb#
				  , #dcsnFafv#
				  , #alryPinx#
				  , #alryPhbx#
				  , #alryYvtx#
				  , #dcsnTots#
				  , #dcsnItax#
				  , #dcsnBtax#
				  , #fafvTaxi#
				  , #subtEtax#
				  , #subtInhb#
				  , #subtFafv#
				  , #subtAmsu#
				  , #jrtrHnto#
				  , #spciOnon#
				  , #spciObam#
				  , #spciOyam#
				  , #spciOnam#
				  , #kybdr#
				  , #inptDt#
				  , #inptAddr#
				  , #ismt#
				  , #revnDt#
				  , #revnAddr# )
		]]>
	</insert>
	
	<!-- yeta0100 화면 연말정산 상세   -->
	<insert id="infcPkgYeta3000DAO.fnPayr06430_PAYR425_2014_CREATE_Insert_S">
		<![CDATA[
			INSERT INTO YETA3000 
				( DPOB_CD
				  , EDAC_RVYY
				  , SETT_GBCD
				  , SYSTEMKEY 
				  , PAYR_TAMT
				  , BONS_TOAM
				  , DTMN_BSAM
				  , STCK_PRFT
				  , CURR_TOTS
				  , TAXM_SFAM
				  , TAXM_ETAM
				  , TAXM_BOIN
				  , TXEC_AMNT
				  , TOTL_SALA
				  , WKER_DDCT
				  , WKER_AMNT
				  , BASE_SELF
				  , JNAT_DDCT 
				  , SPCI_JHTH  
				  , SPCI_JEPF  
				  , ALRY_PINX  
				  , ALRY_PHBX  
				  , KYBDR
				  , INPT_DT
				  , INPT_ADDR
				  , ISMT
				  , REVN_DT
				  , REVN_ADDR )
			( SELECT     CC.DPOB_CD,                                                            
           CC.EDAC_RVYY, 
           BB.SETT_GBCD,                                            
           AA.SYSTEMKEY,                                         
           BB.SUPR_TXAM,                                         
           BB.BUAM_TXAM,                                         
           BB.INBS_AMNT,                                         
           BB.STCK_INAM,                                         
           BB.SUPR_TXAM + BB.BUAM_TXAM + BB.INBS_AMNT + BB.STCK_INAM,     
           BB.TAXM_EARN,                                        
           BB.TAXM_ETAM,                                                                 
           (0)  AS TAXM_BOIN,                                                                 
           BB.TAXM_ECIN,                                                                 
           BB.SUPR_TXAM + BB.BUAM_TXAM + BB.INBS_AMNT + BB.STCK_INAM,                         
            (CASE WHEN (BB.SUPR_TXAM + BB.BUAM_TXAM) <= 5000000                     
	           THEN                                                                               
	           (BB.SUPR_TXAM + BB.BUAM_TXAM) * 0.7                                      
	                                                                                              
	           WHEN 15000000 > (BB.SUPR_TXAM + BB.BUAM_TXAM)                             
	           THEN                                                                               
	           3500000 + ((BB.SUPR_TXAM + BB.BUAM_TXAM - 5000000)   * 0.4)              
                                                                                              
           WHEN 45000000 >= (BB.SUPR_TXAM + BB.BUAM_TXAM)                              
	           THEN                                                                               
	           7500000 + ((BB.SUPR_TXAM + BB.BUAM_TXAM - 15000000)   * 0.15)           
	                                                                                              
	       WHEN 100000000 >= (BB.SUPR_TXAM + BB.BUAM_TXAM)                             
	           THEN                                                                               
	           12000000 + ((BB.SUPR_TXAM + BB.BUAM_TXAM - 45000000)   * 0.05)            
                                                                                              
           ELSE                                                                               
           		14750000 + ((BB.SUPR_TXAM + BB.BUAM_TXAM - 100000000)   * 0.02)           
           END) AS PAYR_IN01,                                                                 
           ((BB.SUPR_TXAM + BB.BUAM_TXAM) -                                         
									           (CASE WHEN (BB.SUPR_TXAM + BB.BUAM_TXAM) <= 5000000                      
										           	THEN                                                                               
										           (BB.SUPR_TXAM + BB.BUAM_TXAM) * 0.7                                      
										                                                                                              
										           WHEN 15000000 >= (BB.SUPR_TXAM + BB.BUAM_TXAM)                             
											           THEN                                                                               
											           3500000 + ((BB.SUPR_TXAM + BB.BUAM_TXAM - 5000000)   * 0.4)              
										                                                                                              
										           WHEN 45000000 >= (BB.SUPR_TXAM + BB.BUAM_TXAM)                             
											           THEN                                                                               
											           7500000 + ((BB.SUPR_TXAM + BB.BUAM_TXAM - 15000000)   * 0.15)            
										                                                                                              
										           WHEN 100000000 >= (BB.SUPR_TXAM + BB.BUAM_TXAM)                              
											           THEN                                                                               
											           12000000 + ((BB.SUPR_TXAM + BB.BUAM_TXAM - 45000000)   * 0.05)           
										                                                                                              
										           ELSE                                                                               
										           		14750000 + ((BB.SUPR_TXAM + BB.BUAM_TXAM - 100000000)   * 0.02)           
										        END)						
           ) AS PAYR_IN02,					                                                                
           1500000,                                                                           
           BB.NATN_PSNF,                                               
           BB.SPCI_HLTH,                                               
           BB.SPCI_EMPF,                                               
           BB.EARN_TAXN,                                                  
           BB.IHTX_TAXN   
          , #kybdr#
		  , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
		  , #inptAddr#
		  , #ismt#
		  , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
		  , #revnAddr#    
		   ]]>                                                                       
           FROM  (
SELECT   DISTINCT  AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                             ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_CLS_DIV_CD,  DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_CLS_DIV_CD,AD01.DTIL_OCCU_CLS_DIV_CD) ) AS DTIL_OCCU_CLS_DIV_CD 
                                              , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT 
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01, (SELECT
											DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
											   PAY_CD,  PAYR_MANG_DEPT_CD, 
											   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
											   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
											     ODTY_CD, PYSP_CD, 
											     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
											   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
											   HDOFC_DIV_CD, RETRY_DT 
											FROM
											(SELECT 
											   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
											   PAY_CD,  PAYR_MANG_DEPT_CD, 
											   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
											   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
											     ODTY_CD, PYSP_CD, 
											     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
											   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
											   HDOFC_DIV_CD, RETRY_DT 
											FROM  PAYR0304 
											UNION ALL
											SELECT 
											   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY, (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
											   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
											   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
											   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
											   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
											   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
											   HDOFC_DIV_CD, RETRY_DT 
											FROM  PYYT0304)) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #edacRvyy# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY  
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                   SELECT      SEL_NUM ,
												                                    DPOB_CD,
												                                    PYMT_YR_MNTH ,
												                                    PAY_CD ,
												                                    SYSTEMKEY,
												                                    PAYR_SEIL_NUM 
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304
																		WHERE   PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                          GROUP BY SYSTEMKEY
																                   )
									                                            )
									                                            ORDER BY  SEL_NUM DESC 
										                                            ) MM  
										                                             WHERE ROWNUM = 1   
										                                               <isNotEmpty prepend="AND" property="systemkey" >
																	                         SYSTEMKEY=#systemkey#
																	                   </isNotEmpty> 
									                                             ) GG
									                            WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                      /*   AND NN.PAYR_SEIL_NUM =  GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #edacRvyy# ||'%'  
              ) AA ,    
               <![CDATA[                                                                 
               (                                                                              
               SELECT DPOB_CD,YRTX_BLGG_YR,                                                             
                       SYSTEMKEY,                                                             
                       CLUT_SEPT_CD,                                                             
                       SUM(SUPR_TXAM) AS SUPR_TXAM,                                  
                       SUM(BUAM_TXAM) AS BUAM_TXAM,                                  
                       SUM(INBS_AMNT) AS INBS_AMNT,                                  
                       SUM(STCK_INAM) AS STCK_INAM,    
                       SUM(CURR_WORK_EMPTK_WDRW_SUM) AS CURR_WORK_EMPTK_WDRW_SUM,
                       SUM(CURR_WORK_ECTE_RETCE_SUM) AS CURR_WORK_ECTE_RETCE_SUM ,	                       
                       SUM(SPCI_HLTH) AS SPCI_HLTH ,   /* 현근무지건강보험료금액 */
                       SUM(ECIN_TXAM) AS ECIN_TXAM,	/* 외국인소득금액_과세 */	 
                       SUM(TAXM_ECIN) AS TAXM_ECIN,	/* 외국인소득금액_비과세	 */
					   SUM(CURR_WORK_RCP_INSUR_SUM) AS CURR_WORK_RCP_INSUR_SUM ,	/* 현근무지요양보험료금액 */
					   SUM(CURR_WORK_RCP_AGGR_SUM) AS CURR_WORK_RCP_AGGR_SUM ,	/* 현근무지건강요양보험료합계금액 */ 
                       SUM(SPCI_EMPF) AS SPCI_EMPF,                                  
                       SUM(NATN_PSNF) AS NATN_PSNF,                                  
                       SUM(EARN_TAXN) AS EARN_TAXN,                                  
                       SUM(IHTX_TAXN) AS IHTX_TAXN,
                       SUM(NNKS_SSUM) AS NNKS_SSUM,
                       SUM(ETCC_TXAM) AS ETCC_TXAM,
                       SUM(ETCC_ETAM) AS ETCC_ETAM,
                       SUM(SPBM_TXAM) AS SPBM_TXAM   /* 현근무지 과세합계금액  */                                   
                  FROM YE160401                                                                
                 WHERE DPOB_CD = #dpobCd#
                   AND YRTX_BLGG_YR = #edacRvyy#
                   AND CLUT_SEPT_CD = #settGbcd#                                               
                 GROUP BY DPOB_CD, YRTX_BLGG_YR, SYSTEMKEY,  CLUT_SEPT_CD     
               ) BB, YETA2000 CC                                                             
           WHERE BB.DPOB_CD   = AA.DPOB_CD 
             AND BB.SYSTEMKEY = AA.SYSTEMKEY  
             AND BB.DPOB_CD   = CC.DPOB_CD                                      
             AND BB.SYSTEMKEY = CC.SYSTEMKEY                                        
             AND BB.YRTX_BLGG_YR = CC.EDAC_RVYY                                        
             AND BB.CLUT_SEPT_CD = CC.SETT_GBCD 
             AND CC.EDAC_RVYY = #edacRvyy#                                  
             AND CC.DPOB_CD   = #dpobCd#                                             
             AND CC.SETT_GBCD = #settGbcd# 
             ]]>  
              <isNotEmpty prepend="AND" property="systemkey" >
                        CC.SYSTEMKEY=#systemkey#
             </isNotEmpty> 
                 AND EXISTS  (
                             SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#edacRvyy# )) ) C 
                                            WHERE     C.DPOB_CD = CC.DPOB_CD
						                        AND C.DEPT_CD = CC.DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(CC.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(CC.DTIL_OCCU_INTTN_CD,'TT')
                                        	   <isNotEmpty prepend="AND" property="deptCd" >
							                       C.DEPT_CD = #deptCd#
							                   </isNotEmpty>
                                          ) 
                       <isNotEmpty prepend="AND" property="businCd" >
                         CC.BUSIN_CD=#businCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                         CC.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="emymtDivCd" >
                         CC.EMYMT_DIV_CD=#emymtDivCd#
                         </isNotEmpty>   
                   <isNotEmpty prepend="AND" property="typOccuCd" >
                      CC.TYP_OCCU_CD = #typOccuCd#
                   </isNotEmpty> 
                     <isNotEmpty prepend="AND" property="dtilOccuInttnCd" >
                      CC.DTIL_OCCU_INTTN_CD = #dtilOccuInttnCd#
                   </isNotEmpty> 
                    <isEqual prepend="AND" property="addCheck" compareValue="ADD">
                  EXISTS
                      (SELECT *
                         FROM (SELECT  KF01.DPOB_CD 
                                     , KF01.EDAC_RVYY
                                     , KF01.SETT_GBCD 
                                     , KF01.SYSTEMKEY 
                                 FROM YETA2000 KF01
                                 WHERE NOT EXISTS (
                                           SELECT 1 FROM 
                                            YETA3000 KK02
                                        WHERE KK02.DPOB_CD = KF01.DPOB_CD
                                          AND KK02.EDAC_RVYY = #edacRvyy#
                                          AND KK02.SETT_GBCD = #settGbcd#
                                          AND KK02.EDAC_RVYY = KF01.EDAC_RVYY
                                          AND KK02.SETT_GBCD = KF01.SETT_GBCD
                                          AND KK02.SYSTEMKEY = KF01.SYSTEMKEY
                                 )) KK01
                        WHERE     KK01.DPOB_CD = CC.DPOB_CD
                              AND KK01.EDAC_RVYY =  #edacRvyy#
                              AND KK01.SETT_GBCD = #settGbcd#
                              AND KK01.EDAC_RVYY = CC.EDAC_RVYY
                              AND KK01.SETT_GBCD = BB.SETT_GBCD
                              AND KK01.SYSTEMKEY = AA.SYSTEMKEY) 
                  </isEqual>
		)
	</insert> 
	
	<update id="infcPkgYeta3000DAO.updateYetaPrc3000_S">
		<![CDATA[
			UPDATE YETA3000
			SET DPOB_CD=#dpobCd#
				, EDAC_RVYY=#edacRvyy#
				, SETT_GBCD=#settGbcd#
				, SYSTEMKEY=#systemkey#
				, BEFO_SCNT=#befoScnt#
				, PAYR_TAMT=#payrTamt#
				, BONS_TOAM=#bonsToam#
				, DTMN_BSAM=#dtmnBsam#
				, STCK_PRFT=#stckPrft#
				, CURR_TOTS=#currTots#
				, TAXM_SFAM=#taxmSfam#
				, TAXM_ETAM=#taxmEtam#
				, TAXM_BOIN=#taxmBoin#
				, TXEC_AMNT=#txecAmnt#
				, TOTL_SALA=#totlSala#
				, WKER_DDCT=#wkerDdct#
				, WKER_AMNT=#wkerAmnt#
				, BASE_SELF=#baseSelf#
				, BASE_WIFE=#baseWife#
				, BASE_FYAM=#baseFyam#
				, ADDR_HDAM=#addrHdam#
				, ADDR_RPT70=#addrRpt70#
				, ADDR_FAME=#addrFame#
				, ADDR_CHLD=#addrChld#
				, ADDR_BRTH=#addrBrth#
				, PANT_ONAM=#pantOnam#
				, ADDR_MCAM=#addrMcam#
				, BNAT_DDCT=#bnatDdct#
				, JNAT_DDCT=#jnatDdct#
				, BPSS_DDCT=#bpssDdct#
				, BPSS_HSOL=#bpssHsol#
				, BPSS_HTEC=#bpssHtec#
				, BPSS_HPUL=#bpssHpul#
				, JPSS_DDCT=#jpssDdct#
				, JPSS_HSOL=#jpssHsol#
				, JPSS_HTEC=#jpssHtec#
				, JPSS_HPUL=#jpssHpul#
				, BRTR_HICT=#brtrHict#
				, BRTR_PSRN=#brtrPsrn#
				, BRTR_HNSV=#brtrHnsv#
				, JRTR_HICT=#jrtrHict#
				, JRTR_PSRN=#jrtrPsrn#
				, JRTR_HNSV=#jrtrHnsv#
				, RRPT_YNAM=#rrptYnam#
				, SPCI_BHTH=#spciBhth#
				, SPCI_JHTH=#spciJhth#
				, SPCI_BEPF=#spciBepf#
				, SPCI_JEPF=#spciJepf#
				, SPCI_GURT=#spciGurt#
				, SPCI_HDRC=#spciHdrc#
				, SPCI_RTDE=#spciRtde#
				, SPCI_HRTO=#spciHrto#
				, SPCI_SELF=#spciSelf#
				, SPCI_HE65=#spciHe65#
				, SPCI_HBPS=#spciHbps#
				, SPCI_DETC=#spciDetc#
				, SPCI_TXCR=#spciTxcr#
				, SPCI_METO=#spciMeto#
				, SPED_SELF=#spedSelf#
				, SPED_GRDE=#spedGrde#
				, SPED_GDTO=#spedGdto#
				, SPED_CLDV=#spedCldv#
				, SPCI_SPEC=#spciSpec#
				, SPED_TXCR=#spedTxcr#
				, SPED_TOAM=#spedToam#
				, SPCI_REFN=#spciRefn#
				, SPCI_RESF=#spciResf#
				, SPCI_TGRT=#spciTgrt#
				, SPCI_RTAM=#spciRtam#
				, SPCH_REFN=#spchRefn#
				, SPCH_RE15=#spchRe15#
				, SPCH_RE29=#spchRe29#
				, SPCH_RE30=#spchRe30#
				, SPCI_REFX=#spciRefx#
				, SPCI_REEC=#spciReec#
				, SPCI_15FX=#spci15fx#
				, SPCI_15FB=#spci15fb#
				, SPCI_15EC=#spci15ec#
				, SPCI_10FB=#spci10fb#
				, SPCI_10EC=#spci10ec#
				, SPCH_RETO=#spchReto#
				, TAXD_PLTC=#taxdPltc#
				, SPCI_PLTC=#spciPltc#
				, SPCI_FBAM=#spciFbam#
				, SPCI_EXAM=#spciExam#
				, SPCI_UNON=#spciUnon#
				, SPCI_RFAM=#spciRfam#
				, SPCI_YAMT=#spciYamt#
				, SPCI_NAMT=#spciNamt#
				, SPCI_DGCR=#spciDgcr#
				, SPCI_SSUM=#spciSsum#
				, SPCI_DDCT=#spciDdct#
				, SUBT_ERAM=#subtEram#
				, ETCP_PSNV=#etcpPsnv#
				, ETCP_NSAV=#etcpNsav#
				, PRCM_TOAM=#prcmToam#
				, ETCH_PREP=#etchPrep#
				, ETCS_COMP=#etcsComp#
				, ETWK_SBAM=#etwkSbam#
				, ETWK_SVAM=#etwkSvam#
				, ETWK_LGAM=#etwkLgam#
				, ETWK_BDAM=#etwkBdam#
				, ETCT_CONC=#etctConc#
				, ETGD_09AF=#etgd09af#
				, ETGD_H13H=#etgdH13h#
				, ETGD_D14F=#etgdD14f#
				, ETGD_DDAM=#etgdDdam#
				, ETCC_CARD=#etccCard#
				, ETCK_UNON=#etckUnon#
				, ETCK_UNCR=#etckUncr#
				, ETEP_MSAM=#etepMsam#
				, ETGD_HTRA=#etgdHtra#
				, ETEP_SECR=#etepSecr#
				, ETCL_TO01=#etclTo01#
				, ETCL_TO02=#etclTo02#
				, ETCL_TO03=#etclTo03#
				, ETCL_HMTO=#etclHmto#
				, ETCD_TSUM=#etcdTsum#
				, SPCH_EXLI=#spchExli#
				, STND_INCM=#stndIncm#
				, PRDD_TAXN=#prddTaxn#
				, TAXD_ICAX=#taxdIcax#
				, TAXD_SPCT=#taxdSpct#
				, TXLG_CL30=#txlgCl30#
				, TXLG_HXTT=#txlgHxtt#
				, TAXD_TSUM=#taxdTsum#
				, TAXD_WKEN=#taxdWken#
				, TAXD_UNIN=#taxdUnin#
				, TAXD_LOAN=#taxdLoan#
				, TAXD_PAID=#taxdPaid#
				, TAXD_REDU=#taxdRedu#
				, ADDR_MCCR=#addrMccr#
				, SPCI_DCTO=#spciDcto#
				, TAXD_CSUM=#taxdCsum#
				, DCSN_INCM=#dcsnIncm#
				, DCSN_INHB=#dcsnInhb#
				, DCSN_FAFV=#dcsnFafv#
				, ALRY_PINX=#alryPinx#
				, ALRY_PHBX=#alryPhbx#
				, ALRY_YVTX=#alryYvtx#
				, DCSN_TOTS=#dcsnTots#
				, DCSN_ITAX=#dcsnItax#
				, DCSN_BTAX=#dcsnBtax#
				, FAFV_TAXI=#fafvTaxi#
				, SUBT_ETAX=#subtEtax#
				, SUBT_INHB=#subtInhb#
				, SUBT_FAFV=#subtFafv#
				, SUBT_AMSU=#subtAmsu#
				, JRTR_HNTO=#jrtrHnto#
				, SPCI_ONON=#spciOnon#
				, SPCI_OBAM=#spciObam#
				, SPCI_OYAM=#spciOyam#
				, SPCI_ONAM=#spciOnam#
				, KYBDR=#kybdr#
				, INPT_DT=#inptDt#
				, INPT_ADDR=#inptAddr#
				, ISMT=#ismt#
				, REVN_DT=#revnDt#
				, REVN_ADDR=#revnAddr#
						WHERE DPOB_CD=#dpobCd#
								AND EDAC_RVYY=#edacRvyy#
								AND SETT_GBCD=#settGbcd#
								AND SYSTEMKEY=#systemkey#
				]]>
	</update>
	
 <!-- *****급여자료 이관 - 연말정산 425 업데이트   [4]**  -->
	<update id="infcPkgYeta3000DAO.fnPayr06530_PAYR425_2015_CREATE1_Update">
		<![CDATA[
			  UPDATE  YETA3000                                                                                         
          SET                                                                                              
              PAYR_TAMT = (SELECT                                                                          
              YE160401.SUPR_TXAM                                                                            
              FROM                                                                                         
                  (                                                                                         
                   SELECT DPOB_CD,EDAC_RVYY,                                                                        
                          SYSTEMKEY,                                                                        
                          SETT_GBCD,                                                                          
                          SUM(NVL(SUPR_TXAM,0)) AS SUPR_TXAM                                           
                     FROM YE160401                                                                         
                    GROUP BY DPOB_CD,EDAC_RVYY, SYSTEMKEY,  SETT_GBCD                                             
                  ) YE160401                                                                                
              WHERE  YE160401.SYSTEMKEY = YETA3000.SYSTEMKEY                                   
                            AND YE160401.YRTX_BLGG_YR = YETA3000.EDAC_RVYY                                   
                            AND YE160401.CLUT_SEPT_CD = YETA3000.SETT_GBCD
                            AND YE160401.DPOB_CD = YETA3000.DPOB_CD) , <!-- /*주근무지_급여총액 */        -->                 
              BONS_TOAM = (SELECT                                                                            
                          YE160401.BUAM_TXAM                                                                   
                          FROM                                                                                 
                              (                                                                              
                               SELECT DPOB_CD,EDAC_RVYY,                                                              
                                      SYSTEMKEY,                                                              
                                      SETT_GBCD,  SUM(NVL(BUAM_TXAM,0)) AS BUAM_TXAM                          
                                 FROM YE160401                                                                 
                                GROUP BY DPOB_CD,EDAC_RVYY, SYSTEMKEY,  SETT_GBCD                                     
                              ) YE160401                                                                       
                          WHERE  YE160401.SYSTEMKEY = YETA3000.SYSTEMKEY                                   
                            AND YE160401.YRTX_BLGG_YR = YETA3000.EDAC_RVYY                                   
                            AND YE160401.CLUT_SEPT_CD = YETA3000.SETT_GBCD
                            AND YE160401.DPOB_CD = YETA3000.DPOB_CD ) ,  <!-- /* 주근무지_상여총액 */ -->            
              DTMN_BSAM  = (SELECT                                                                            
                          YETA3210.INBS_AMNT                                                                   
                          FROM                                                                                
                              (                                                                               
                               SELECT DPOB_CD,YRTX_BLGG_YR ,                                                              
                                      SYSTEMKEY,                                                              
                                      CLUT_SEPT_CD,                                                              
                                      SUM(NVL(INBS_AMNT,0)) AS INBS_AMNT                                      
                                 FROM YE160401                                                                 
                                GROUP BY DPOB_CD,YRTX_BLGG_YR, SYSTEMKEY,  CLUT_SEPT_CD                                     
                              ) YE160401                                                                      
                          WHERE  YE160401.SYSTEMKEY = YETA3000.SYSTEMKEY                                   
                            AND YE160401.YRTX_BLGG_YR = YETA3000.EDAC_RVYY                                   
                            AND YE160401.CLUT_SEPT_CD = YETA3000.SETT_GBCD
                            AND YE160401.DPOB_CD = YETA3000.DPOB_CD ) , <!-- /* 주근무지_인정상여총액 */ -->        
              STCK_PRFT =  (SELECT                                                                           
                          YETA3210.STCK_INAM                                                                  
                          FROM                                                                               
                             (                                                                               
                               SELECT DPOB_CD,YRTX_BLGG_YR ,                                                              
                                      SYSTEMKEY,                                                              
                                      CLUT_SEPT_CD,                                                              
                                      SUM(NVL(STCK_INAM,0)) AS STCK_INAM                                      
                                 FROM YE160401                                                                 
                                GROUP BY DPOB_CD,YRTX_BLGG_YR, SYSTEMKEY,  CLUT_SEPT_CD                                     
                              ) YE160401                                                                      
                          WHERE  YE160401.SYSTEMKEY = YETA3000.SYSTEMKEY                                   
                            AND YE160401.YRTX_BLGG_YR = YETA3000.EDAC_RVYY                                   
                            AND YE160401.CLUT_SEPT_CD = YETA3000.SETT_GBCD
                            AND YE160401.DPOB_CD = YETA3000.DPOB_CD ) , <!-- /* 주근무지_주식행사이익 */   -->      
              CURR_TOTS =  (SELECT                                                                           
                          YETA3210.SUPR_TXAM + YETA3210.BUAM_TXAM + YETA3210.INBS_AMNT + YETA3210.STCK_INAM      
                          FROM                                                                                
                              (                                                                              
                               SELECT DPOB_CD, EDAC_RVYY,                                                             
                                      SYSTEMKEY,                                                            
                                      SETT_GBCD,                                                             
                                      SUM(NVL(SUPR_TXAM,0)) AS SUPR_TXAM,                                  
                                      SUM(NVL(BUAM_TXAM,0)) AS BUAM_TXAM,                                    
                                      SUM(NVL(INBS_AMNT,0)) AS INBS_AMNT,                                    
                                      SUM(NVL(STCK_INAM,0)) AS STCK_INAM                                    
                                 FROM YETA3210                                                               
                                GROUP BY DPOB_CD,EDAC_RVYY, SYSTEMKEY,  SETT_GBCD                                    
                              ) YETA3210                                                                     
                          WHERE YETA3210.SYSTEMKEY = YETA3000.SYSTEMKEY                                       
                            AND YETA3210.EDAC_RVYY = YETA3000.EDAC_RVYY                                       
                            AND YETA3210.SETT_GBCD = YETA3000.SETT_GBCD
                            AND YETA3210.DPOB_CD = YETA3000.DPOB_CD ) , <!-- /* 주근무지총급여액 */  -->          
              TAXM_SFAM =  (SELECT                                                                          
                          YETA3210.TAXM_EARN                                                                 
                          FROM                                                                              
                              (                                                                            
                               SELECT DPOB_CD,EDAC_RVYY,                                                            
                                      SYSTEMKEY,                                                            
                                      SETT_GBCD,                                                           
                                      SUM(NVL(TAXM_EARN,0)) AS TAXM_EARN                                   
                                 FROM YETA3210                                                              
                                GROUP BY DPOB_CD,EDAC_RVYY, SYSTEMKEY,  SETT_GBCD                                   
                              ) YETA3210                                                                    
                          WHERE YETA3210.SYSTEMKEY = YETA3000.SYSTEMKEY                                      
                            AND YETA3210.EDAC_RVYY = YETA3000.EDAC_RVYY                                      
                            AND YETA3210.SETT_GBCD = YETA3000.SETT_GBCD
                            AND YETA3210.DPOB_CD = YETA3000.DPOB_CD ) , <!-- /* 비과세_자가운전보조금액 */  -->   
              TAXM_ETAM =  (SELECT                                                                         
                          YETA3210.TAXM_ETAM                                                                
                          FROM                                                                             
                              (                                                                            
                               SELECT DPOB_CD,EDAC_RVYY,                                                           
                                      SYSTEMKEY,                                                           
                                      SETT_GBCD,                                                           
                                      SUM(NVL(TAXM_ETAM,0)) AS TAXM_ETAM                                  
                                 FROM YETA3210                                                             
                                GROUP BY DPOB_CD,EDAC_RVYY, SYSTEMKEY,  SETT_GBCD                                 
                              ) YETA3210                                                                   
                          WHERE YETA3210.SYSTEMKEY = YETA3000.SYSTEMKEY                                     
                            AND YETA3210.EDAC_RVYY = YETA3000.EDAC_RVYY                                     
                            AND YETA3210.SETT_GBCD = YETA3000.SETT_GBCD 
                            AND YETA3210.DPOB_CD = YETA3000.DPOB_CD) , <!-- /* 비과세_급양비금액*/ -->          
              TAXM_BOIN =  (SELECT                                                                         
                          YETA3210.ADDR_BHTX                                                                
                          FROM                                                                             
                              (                                                                           
                               SELECT DPOB_CD,EDAC_RVYY,                                                          
                                      SYSTEMKEY,                                                          
                                      SETT_GBCD,                                                           
                                      SUM(NVL(ADDR_BHTX,0)) AS ADDR_BHTX                                   
                                FROM YETA3210                                                               
                                GROUP BY DPOB_CD,EDAC_RVYY, SYSTEMKEY,  SETT_GBCD                                  
                              ) YETA3210                                                                    
                          WHERE YETA3210.SYSTEMKEY = YETA3000.SYSTEMKEY                                      
                            AND YETA3210.EDAC_RVYY = YETA3000.EDAC_RVYY                                      
                            AND YETA3210.SETT_GBCD = YETA3000.SETT_GBCD 
                            AND YETA3210.DPOB_CD = YETA3000.DPOB_CD) , <!-- /* 비과세_보육수당*/  -->                                                       
              TXEC_AMNT =  (SELECT                                                                         
                          YETA3210.TAXM_ECIN                                                                
                          FROM                                                                             
                              (                                                                           
                               SELECT DPOB_CD,EDAC_RVYY,                                                          
                                      SYSTEMKEY,                                                          
                                      SETT_GBCD,                                                           
                                      SUM(NVL(TAXM_ECIN,0)) AS TAXM_ECIN                                   
                                FROM YETA3210                                                               
                                GROUP BY DPOB_CD,EDAC_RVYY, SYSTEMKEY,  SETT_GBCD                                  
                              ) YETA3210                                                                    
                          WHERE YETA3210.SYSTEMKEY = YETA3000.SYSTEMKEY                                      
                            AND YETA3210.EDAC_RVYY = YETA3000.EDAC_RVYY                                      
                            AND YETA3210.SETT_GBCD = YETA3000.SETT_GBCD 
                            AND YETA3210.DPOB_CD = YETA3000.DPOB_CD) , <!-- /* 비과세_외국인소득금액*/  -->      
              TOTL_SALA =  (SELECT                                                                         
                          YE160401.SUPR_TXAM + YE160401.BUAM_TXAM + YE160401.INBS_AMNT + YE160401.STCK_INAM  
                           + YE160401.CURR_WORK_EMPTK_WDRW_SUM  
                            + YE160401.CURR_WORK_ECTE_RETCE_SUM    
                          FROM                                                                           
                              (                                                                          
                                 SELECT DPOB_CD,YRTX_BLGG_YR,                                                      
				                        SYSTEMKEY,                                                      
				                        CLUT_SEPT_CD,         
				                          SUM(SUPR_TXAM) AS SUPR_TXAM,                                  
					                       SUM(BUAM_TXAM) AS BUAM_TXAM,                                  
					                       SUM(INBS_AMNT) AS INBS_AMNT,                                  
					                       SUM(STCK_INAM) AS STCK_INAM,    
					                       SUM(CURR_WORK_EMPTK_WDRW_SUM) AS CURR_WORK_EMPTK_WDRW_SUM,
					                       SUM(CURR_WORK_ECTE_RETCE_SUM) AS CURR_WORK_ECTE_RETCE_SUM ,	                       
					                       SUM(SPCI_HLTH) AS SPCI_HLTH ,   /* 현근무지건강보험료금액 */ 
										   SUM(CURR_WORK_RCP_INSUR_SUM) AS CURR_WORK_RCP_INSUR_SUM ,	/* 현근무지요양보험료금액 */
										   SUM(CURR_WORK_RCP_AGGR_SUM) AS CURR_WORK_RCP_AGGR_SUM ,	/* 현근무지건강요양보험료합계금액 */ 
					                       SUM(SPCI_EMPF) AS SPCI_EMPF,                                  
					                       SUM(NATN_PSNF) AS NATN_PSNF,                                  
					                       SUM(EARN_TAXN) AS EARN_TAXN,                                  
					                       SUM(IHTX_TAXN) AS IHTX_TAXN,
					                       SUM(NNKS_SSUM) AS NNKS_SSUM,
					                       SUM(ETCC_TXAM) AS ETCC_TXAM,
					                       SUM(ETCC_ETAM) AS ETCC_ETAM,
					                       SUM(SPBM_TXAM) AS SPBM_TXAM   /* 현근무지 과세합계금액  */    
				                   FROM YE160401                                                         
				                  GROUP BY DPOB_CD, YRTX_BLGG_YR, SYSTEMKEY,  CLUT_SEPT_CD                             
                              ) YE160401                                                                 
                          WHERE YE160401.SYSTEMKEY = YETA3000.SYSTEMKEY                                   
                            AND YE160401.YRTX_BLGG_YR = YETA3000.EDAC_RVYY                                   
                            AND YE160401.CLUT_SEPT_CD = YETA3000.SETT_GBCD
                            AND YE160401.DPOB_CD = YETA3000.DPOB_CD ) , <!-- /* 총급여_현_전*/   -->           
              WKER_DDCT =  (SELECT                                                                      
                           (CASE WHEN (YETA3210.SUPR_TXAM + YETA3210.BUAM_TXAM) <= 5000000                
                          THEN                                                                          
                          (YETA3210.SUPR_TXAM + YETA3210.BUAM_TXAM) * 0.7                                 
                                                                                                        
                          WHEN 15000000 >= (YETA3210.SUPR_TXAM + YETA3210.BUAM_TXAM)                      
                          THEN                                                                          
                          3500000 + ((YETA3210.SUPR_TXAM + YETA3210.BUAM_TXAM - 5000000)   * 0.4)         
                                                                                                        
                          WHEN 45000000 >= (YETA3210.SUPR_TXAM + YETA3210.BUAM_TXAM)                      
                          THEN                                                                           
                          7500000 + ((YETA3210.SUPR_TXAM + YETA3210.BUAM_TXAM - 15000000)   * 0.15)        
                                                                                                         
                          WHEN 100000000 >= (YETA3210.SUPR_TXAM + YETA3210.BUAM_TXAM)                       
                          THEN                                                                           
                          12000000 + ((YETA3210.SUPR_TXAM + YETA3210.BUAM_TXAM - 45000000)   * 0.05)       
                                                                                                         
                          ELSE                                                                          
                          14750000 + ((YETA3210.SUPR_TXAM + YETA3210.BUAM_TXAM - 100000000)   * 0.02)       
                          END) AS PAYR_IN01                                                            
                          FROM                                                                         
                              (                                                                        
                               SELECT DPOB_CD,EDAC_RVYY,                                                       
                                      SYSTEMKEY,                                                       
                                      SETT_GBCD,                                                       
                                      SUM(NVL(SUPR_TXAM,0)) AS SUPR_TXAM,                              
                                      SUM(NVL(BUAM_TXAM,0)) AS BUAM_TXAM,                              
                                      SUM(NVL(INBS_AMNT,0)) AS INBS_AMNT,                              
                                      SUM(NVL(STCK_INAM,0)) AS STCK_INAM,                             
                                      SUM(NVL(SPBM_TXAM,0)) AS SPBM_TXAM,                             
                                      SUM(NVL(TAXM_EARN,0)) AS TAXM_EARN,                              
                                      SUM(NVL(TXET_TXAM,0)) AS TXET_TXAM,                               
                                      SUM(NVL(TAXM_ETAM,0)) AS TAXM_ETAM,                               
                                      SUM(NVL(ECIN_TXAM,0)) AS ECIN_TXAM,                               
                                      SUM(NVL(TAXM_ECIN,0)) AS TAXM_ECIN,                               
                                      SUM(NVL(SPCI_HLTH,0)) AS SPCI_HLTH,                                 
                                      SUM(NVL(SPCI_EMPF,0)) AS SPCI_EMPF,                               
                                      SUM(NVL(NATN_PSNF,0)) AS NATN_PSNF,                               
                                      SUM(NVL(EARN_TAXN,0)) AS EARN_TAXN,                               
                                      SUM(NVL(IHTX_TAXN,0)) AS IHTX_TAXN                                
                                 FROM YETA3210                                                           
                                GROUP BY DPOB_CD,EDAC_RVYY, SYSTEMKEY,  SETT_GBCD                               
                              ) YETA3210                                                                 
                          WHERE YETA3210.SYSTEMKEY = YETA3000.SYSTEMKEY                                   
                            AND YETA3210.EDAC_RVYY = YETA3000.EDAC_RVYY                                   
                            AND YETA3210.SETT_GBCD = YETA3000.SETT_GBCD 
                            AND YETA3210.DPOB_CD = YETA3000.DPOB_CD) , <!-- /* 근로소득공제 */  -->           
              WKER_AMNT =  (SELECT                                                                      
                          ((YETA3210.SUPR_TXAM + YETA3210.BUAM_TXAM) -                                     
                          (CASE WHEN (YETA3210.SUPR_TXAM + YETA3210.BUAM_TXAM) <= 5000000                 
                          THEN                                                                          
                          (YETA3210.SUPR_TXAM + YETA3210.BUAM_TXAM) * 0.7                                  
                                                                                                        
                          WHEN 15000000 >= (YETA3210.SUPR_TXAM + YETA3210.BUAM_TXAM)                       
                          THEN                                                                           
                          3500000 + ((YETA3210.SUPR_TXAM + YETA3210.BUAM_TXAM - 5000000)   * 0.4)          
                                                                                                         
                          WHEN 45000000 >= (YETA3210.SUPR_TXAM + YETA3210.BUAM_TXAM)                       
                          THEN                                                                           
                          7500000 + ((YETA3210.SUPR_TXAM + YETA3210.BUAM_TXAM - 15000000)   * 0.15)        
                                                                                                         
                          WHEN 100000000 >= (YETA3210.SUPR_TXAM + YETA3210.BUAM_TXAM)                       
                          THEN                                                                           
                          12000000 + ((YETA3210.SUPR_TXAM + YETA3210.BUAM_TXAM - 45000000)   * 0.05)       
                                                                                                         
                          ELSE                                                                           
                          14750000 + ((YETA3210.SUPR_TXAM + YETA3210.BUAM_TXAM - 100000000)   * 0.02)       
                          END)) AS PAYR_IN02                                                              
                          FROM                                                                            
                              (                                                                          
                               SELECT DPOB_CD,EDAC_RVYY,                                                         
                                      SYSTEMKEY,                                                          
                                      SETT_GBCD,                                                          
                                      SUM(NVL(SUPR_TXAM,0)) AS SUPR_TXAM,                                 
                                      SUM(NVL(BUAM_TXAM,0)) AS BUAM_TXAM,                                 
                                      SUM(NVL(INBS_AMNT,0)) AS INBS_AMNT,                                 
                                      SUM(NVL(STCK_INAM,0)) AS STCK_INAM,                                 
                                      SUM(NVL(SPBM_TXAM,0)) AS SPBM_TXAM,                                
                                      SUM(NVL(TAXM_EARN,0)) AS TAXM_EARN,                                  
                                      SUM(NVL(TXET_TXAM,0)) AS TXET_TXAM,                                  
                                      SUM(NVL(TAXM_ETAM,0)) AS TAXM_ETAM,                                  
                                      SUM(NVL(ECIN_TXAM,0)) AS ECIN_TXAM,                                 
                                      SUM(NVL(TAXM_ECIN,0)) AS TAXM_ECIN,                                 
                                      SUM(NVL(SPCI_HLTH,0)) AS SPCI_HLTH,                                 
                                      SUM(NVL(SPCI_EMPF,0)) AS SPCI_EMPF,                                 
                                      SUM(NVL(NATN_PSNF,0)) AS NATN_PSNF,                                 
                                      SUM(NVL(EARN_TAXN,0)) AS EARN_TAXN,                                 
                                      SUM(NVL(IHTX_TAXN,0)) AS IHTX_TAXN                                  
                                 FROM YETA3210                                                             
                                GROUP BY DPOB_CD,EDAC_RVYY, SYSTEMKEY,  SETT_GBCD                                 
                              ) YETA3210                                                                   
                          WHERE YETA3210.SYSTEMKEY = YETA3000.SYSTEMKEY                                     
                            AND YETA3210.EDAC_RVYY = YETA3000.EDAC_RVYY                                     
                            AND YETA3210.SETT_GBCD = YETA3000.SETT_GBCD
                            AND YETA3210.DPOB_CD = YETA3000.DPOB_CD ) , <!-- /* 근로소득금액 */  -->             
                                                                                                          
              JNAT_DDCT  =  (SELECT                                                                       
                          YETA3210.NATN_PSNF                                                               
                          FROM                                                                            
                              (                                                                           
                               SELECT DPOB_CD,EDAC_RVYY,                                                          
                                      SYSTEMKEY,                                                           
                                      SETT_GBCD,                                                           
                                      SUM(NVL(NATN_PSNF,0)) AS NATN_PSNF                                    
                                 FROM YETA3210                                                               
                                GROUP BY DPOB_CD,EDAC_RVYY, SYSTEMKEY,  SETT_GBCD                                   
                              ) YETA3210                                                                    
                          WHERE YETA3210.SYSTEMKEY = YETA3000.SYSTEMKEY                                      
                            AND YETA3210.EDAC_RVYY = YETA3000.EDAC_RVYY                                       
                            AND YETA3210.SETT_GBCD = YETA3000.SETT_GBCD
                            AND YETA3210.DPOB_CD = YETA3000.DPOB_CD ) ,  <!-- /* 국민연금보험료 공제 */ -->       
              SPCI_JHTH  =  (SELECT                                                                         
                          YETA3210.SPCI_HLTH                                                                
                          FROM                                                                              
                              (                                                                             
                               SELECT DPOB_CD,EDAC_RVYY,                                                            
                                      SYSTEMKEY,                                                            
                                      SETT_GBCD,                                                             
                                      SUM(NVL(SPCI_HLTH,0)) AS SPCI_HLTH                                    
                                 FROM YETA3210                                                               
                                GROUP BY DPOB_CD,EDAC_RVYY, SYSTEMKEY,  SETT_GBCD                                   
                              ) YETA3210                                                                     
                          WHERE YETA3210.SYSTEMKEY = YETA3000.SYSTEMKEY                                       
                            AND YETA3210.EDAC_RVYY = YETA3000.EDAC_RVYY                                       
                            AND YETA3210.SETT_GBCD = YETA3000.SETT_GBCD
                            AND YETA3210.DPOB_CD = YETA3000.DPOB_CD ) , <!-- /* 특별공제 주건강보험 */  -->        
              SPCI_JEPF =  (SELECT                                                                          
                          YETA3210.SPCI_EMPF                                                                 
                          FROM                                                                               
                              (                                                                             
                               SELECT DPOB_CD,EDAC_RVYY,                                                            
                                      SYSTEMKEY,                                                            
                                      SETT_GBCD,                                                            
                                      SUM(NVL(SPCI_EMPF,0)) AS SPCI_EMPF                                    
                                 FROM YETA3210                                                               
                                GROUP BY DPOB_CD,EDAC_RVYY, SYSTEMKEY,  SETT_GBCD                                   
                              ) YETA3210                                                                    
                          WHERE YETA3210.SYSTEMKEY = YETA3000.SYSTEMKEY                                       
                            AND YETA3210.EDAC_RVYY = YETA3000.EDAC_RVYY                                       
                            AND YETA3210.SETT_GBCD = YETA3000.SETT_GBCD
                            AND YETA3210.DPOB_CD = YETA3000.DPOB_CD ) ,  <!-- /* 주고용보험료 */   -->             
              ALRY_PINX =  (SELECT                                                                         
                          YETA3210.EARN_TAXN                                                                
                          FROM                                                                             
                              (                                                                            
                               SELECT DPOB_CD,EDAC_RVYY,                                                           
                                      SYSTEMKEY,                                                            
                                      SETT_GBCD,                                                           
                                      SUM(NVL(EARN_TAXN,0)) AS EARN_TAXN                                   
                                 FROM YETA3210                                                              
                                GROUP BY DPOB_CD,EDAC_RVYY, SYSTEMKEY,  SETT_GBCD                                  
                              ) YETA3210                                                                    
                          WHERE YETA3210.SYSTEMKEY = YETA3000.SYSTEMKEY                                      
                            AND YETA3210.EDAC_RVYY = YETA3000.EDAC_RVYY                                      
                            AND YETA3210.SETT_GBCD = YETA3000.SETT_GBCD 
                            AND YETA3210.DPOB_CD = YETA3000.DPOB_CD) ,  <!-- /* 기납부세액 소득 */   -->         
              ALRY_PHBX  =  (SELECT                                                                        
                          YETA3210.IHTX_TAXN                                                                
                          FROM                                                                            
                              (                                                                            
                               SELECT DPOB_CD,EDAC_RVYY,                                                           
                                      SYSTEMKEY,                                                          
                                      SETT_GBCD,                                                          
                                      SUM(NVL(IHTX_TAXN,0)) AS IHTX_TAXN                                  
                                 FROM YETA3210                                                              
                                GROUP BY DPOB_CD,EDAC_RVYY, SYSTEMKEY,  SETT_GBCD                                  
                              ) YETA3210                                                                   
                          WHERE YETA3210.SYSTEMKEY = YETA3000.SYSTEMKEY                                      
                            AND YETA3210.EDAC_RVYY = YETA3000.EDAC_RVYY                                     
                            AND YETA3210.SETT_GBCD = YETA3000.SETT_GBCD 
                            AND YETA3210.DPOB_CD = YETA3000.DPOB_CD) ,   <!-- /* 기납부 주민세 */  -->           
 	          ISMT=#ismt#
				, REVN_DT=#revnDt#
				, REVN_ADDR=#revnAddr#
						WHERE DPOB_CD=#dpobCd#
								AND EDAC_RVYY=#edacRvyy#
								AND SETT_GBCD=#settGbcd#
								AND SYSTEMKEY=#systemkey#                                                                  

				]]>
	</update>
	
	<delete id="infcPkgYeta3000DAO.deleteYetaPrc3000_S">
		<![CDATA[
			DELETE FROM YETA3000 
						WHERE DPOB_CD=#dpobCd#
								AND EDAC_RVYY=#edacRvyy#
								AND SETT_GBCD=#settGbcd#
								AND SYSTEMKEY=#systemkey#
				]]>
	</delete>
	
	<!-- yeta0100 화면 연말정산 대상자  관리  -->
	<delete id="infcPkgYeta3000DAO.fnPayr06430_PAYR425_CREATE_Delete_S">
		<![CDATA[
			DELETE FROM YETA3000 
						WHERE DPOB_CD=#dpobCd#
								AND EDAC_RVYY=#edacRvyy#
								AND SETT_GBCD=#settGbcd# 
				]]>
				  <isNotEmpty prepend="AND" property="systemkey" >
                      SYSTEMKEY=#systemkey#
                   </isNotEmpty> 
	</delete>	
	
	
	<select id="infcPkgYeta3000DAO.selectYetaPrc3000_S" resultMap="infcPkgYeta3000">
		<![CDATA[
			SELECT
				DPOB_CD
				, EDAC_RVYY
				, SETT_GBCD
				, SYSTEMKEY
				, BEFO_SCNT
				, PAYR_TAMT
				, BONS_TOAM
				, DTMN_BSAM
				, STCK_PRFT
				, CURR_TOTS
				, TAXM_SFAM
				, TAXM_ETAM
				, TAXM_BOIN
				, TXEC_AMNT
				, TOTL_SALA
				, WKER_DDCT
				, WKER_AMNT
				, BASE_SELF
				, BASE_WIFE
				, BASE_FYAM
				, ADDR_HDAM
				, ADDR_RPT70
				, ADDR_FAME
				, ADDR_CHLD
				, ADDR_BRTH
				, PANT_ONAM
				, ADDR_MCAM
				, BNAT_DDCT
				, JNAT_DDCT
				, BPSS_DDCT
				, BPSS_HSOL
				, BPSS_HTEC
				, BPSS_HPUL
				, JPSS_DDCT
				, JPSS_HSOL
				, JPSS_HTEC
				, JPSS_HPUL
				, BRTR_HICT
				, BRTR_PSRN
				, BRTR_HNSV
				, JRTR_HICT
				, JRTR_PSRN
				, JRTR_HNSV
				, RRPT_YNAM
				, SPCI_BHTH
				, SPCI_JHTH
				, SPCI_BEPF
				, SPCI_JEPF
				, SPCI_GURT
				, SPCI_HDRC
				, SPCI_RTDE
				, SPCI_HRTO
				, SPCI_SELF
				, SPCI_HE65
				, SPCI_HBPS
				, SPCI_DETC
				, SPCI_TXCR
				, SPCI_METO
				, SPED_SELF
				, SPED_GRDE
				, SPED_GDTO
				, SPED_CLDV
				, SPCI_SPEC
				, SPED_TXCR
				, SPED_TOAM
				, SPCI_REFN
				, SPCI_RESF
				, SPCI_TGRT
				, SPCI_RTAM
				, SPCH_REFN
				, SPCH_RE15
				, SPCH_RE29
				, SPCH_RE30
				, SPCI_REFX
				, SPCI_REEC
				, SPCI_15FX
				, SPCI_15FB
				, SPCI_15EC
				, SPCI_10FB
				, SPCI_10EC
				, SPCH_RETO
				, TAXD_PLTC
				, SPCI_PLTC
				, SPCI_FBAM
				, SPCI_EXAM
				, SPCI_UNON
				, SPCI_RFAM
				, SPCI_YAMT
				, SPCI_NAMT
				, SPCI_DGCR
				, SPCI_SSUM
				, SPCI_DDCT
				, SUBT_ERAM
				, ETCP_PSNV
				, ETCP_NSAV
				, PRCM_TOAM
				, ETCH_PREP
				, ETCS_COMP
				, ETWK_SBAM
				, ETWK_SVAM
				, ETWK_LGAM
				, ETWK_BDAM
				, ETCT_CONC
				, ETGD_09AF
				, ETGD_H13H
				, ETGD_D14F
				, ETGD_DDAM
				, ETCC_CARD
				, ETCK_UNON
				, ETCK_UNCR
				, ETEP_MSAM
				, ETGD_HTRA
				, ETEP_SECR
				, ETCL_TO01
				, ETCL_TO02
				, ETCL_TO03
				, ETCL_HMTO
				, ETCD_TSUM
				, SPCH_EXLI
				, STND_INCM
				, PRDD_TAXN
				, TAXD_ICAX
				, TAXD_SPCT
				, TXLG_CL30
				, TXLG_HXTT
				, TAXD_TSUM
				, TAXD_WKEN
				, TAXD_UNIN
				, TAXD_LOAN
				, TAXD_PAID
				, TAXD_REDU
				, ADDR_MCCR
				, SPCI_DCTO
				, TAXD_CSUM
				, DCSN_INCM
				, DCSN_INHB
				, DCSN_FAFV
				, ALRY_PINX
				, ALRY_PHBX
				, ALRY_YVTX
				, DCSN_TOTS
				, DCSN_ITAX
				, DCSN_BTAX
				, FAFV_TAXI
				, SUBT_ETAX
				, SUBT_INHB
				, SUBT_FAFV
				, SUBT_AMSU
				, JRTR_HNTO
				, SPCI_ONON
				, SPCI_OBAM
				, SPCI_OYAM
				, SPCI_ONAM
				, KYBDR
				, INPT_DT
				, INPT_ADDR
				, ISMT
				, REVN_DT
				, REVN_ADDR
			FROM YETA3000
						WHERE DPOB_CD=#dpobCd#
								AND EDAC_RVYY=#edacRvyy#
								AND SETT_GBCD=#settGbcd#
								AND SYSTEMKEY=#systemkey#
				]]>
	</select>
	
	
	<!-- 세액계산 처리를 위한 부분으로 yeta0300 화면  -->
		<select id="infcPkgYeta3000DAO.fnPayr06430_PAYR425_ReTax_2016_SPCI_Select_Update" resultMap="infcPkgYeta3000">
		<![CDATA[
			SELECT
				DPOB_CD
				, EDAC_RVYY
				, SETT_GBCD
				, SYSTEMKEY
				, nvl(BEFO_SCNT,0) as BEFO_SCNT
				, nvl(PAYR_TAMT,0) as PAYR_TAMT
				, nvl(BONS_TOAM,0) as BONS_TOAM
				, nvl(DTMN_BSAM,0) as DTMN_BSAM
				, nvl(STCK_PRFT,0) as STCK_PRFT
				, nvl(CURR_TOTS,0) as CURR_TOTS
				, nvl(TAXM_SFAM,0) as TAXM_SFAM
				, nvl(TAXM_ETAM,0) as TAXM_ETAM
				, nvl(TAXM_BOIN,0) as TAXM_BOIN
				, nvl(TXEC_AMNT,0) as TXEC_AMNT
				, nvl(TOTL_SALA,0) as TOTL_SALA
				, nvl(WKER_DDCT,0) as WKER_DDCT
				, nvl( WKER_AMNT,0) as WKER_AMNT
				, nvl(BASE_SELF,0) as BASE_SELF
				, nvl(BASE_WIFE,0) as BASE_WIFE
				, nvl(BASE_FYAM,0) as BASE_FYAM
				, nvl(ADDR_HDAM,0) as ADDR_HDAM
				, nvl(ADDR_RPT70,0) as ADDR_RPT70
				, nvl(ADDR_FAME,0) as ADDR_FAME
				, nvl(ADDR_CHLD,0) as ADDR_CHLD
				, nvl(ADDR_BRTH,0) as ADDR_BRTH
				,  nvl(PANT_ONAM,0) as PANT_ONAM
				, nvl(ADDR_MCAM,0) as ADDR_MCAM
				, nvl(BNAT_DDCT,0) as BNAT_DDCT
				, nvl(JNAT_DDCT,0) as JNAT_DDCT
				, nvl(BPSS_DDCT,0) as BPSS_DDCT
				, nvl(BPSS_HSOL,0) as BPSS_HSOL
				, nvl(BPSS_HTEC,0) as BPSS_HTEC
				, nvl(BPSS_HPUL,0) as BPSS_HPUL
				, nvl(JPSS_DDCT,0) as JPSS_DDCT
				, nvl(JPSS_HSOL,0) as JPSS_HSOL
				, nvl(JPSS_HTEC,0) as JPSS_HTEC
				, nvl(JPSS_HPUL,0) as JPSS_HPUL
				, nvl(BRTR_HICT,0) as BRTR_HICT
				, nvl(BRTR_PSRN,0) as BRTR_PSRN
				, nvl(BRTR_HNSV,0) as BRTR_HNSV
				, nvl(JRTR_HICT,0) as JRTR_HICT
				, nvl(JRTR_PSRN,0) as JRTR_PSRN
				, nvl(JRTR_HNSV,0) as JRTR_HNSV
				, nvl(RRPT_YNAM,0) as RRPT_YNAM
				, nvl(SPCI_BHTH,0) as SPCI_BHTH
				, nvl(SPCI_JHTH,0) as SPCI_JHTH
				, nvl(SPCI_BEPF,0) as SPCI_BEPF
				, nvl(SPCI_JEPF,0) as SPCI_JEPF
				, nvl(SPCI_GURT,0) as SPCI_GURT
				, nvl(SPCI_HDRC,0) as SPCI_HDRC
				, nvl(SPCI_RTDE,0) as SPCI_RTDE
				, nvl(SPCI_HRTO,0) as SPCI_HRTO
				, nvl(SPCI_SELF,0) as SPCI_SELF
				, nvl(SPCI_HE65,0) as SPCI_HE65
				, nvl(SPCI_HBPS,0) as SPCI_HBPS
				, nvl(SPCI_DETC,0) as SPCI_DETC
				, nvl(SPCI_TXCR,0) as SPCI_TXCR
				, nvl(SPCI_METO,0) as SPCI_METO
				, nvl(SPED_SELF,0) as SPED_SELF
				, nvl(SPED_GRDE,0) as SPED_GRDE
				, nvl(SPED_GDTO,0) as SPED_GDTO
				, nvl(SPED_CLDV,0) as SPED_CLDV
				, nvl(SPCI_SPEC,0) as SPCI_SPEC
				, nvl(SPED_TXCR,0) as SPED_TXCR
				, nvl(SPED_TOAM,0) as SPED_TOAM
				, nvl(SPCI_REFN,0) as SPCI_REFN
				, nvl(SPCI_RESF,0) as SPCI_RESF
				, nvl(SPCI_TGRT,0) as SPCI_TGRT
				, nvl(SPCI_RTAM,0) as SPCI_RTAM
				, nvl(SPCH_REFN,0) as SPCH_REFN
				, nvl(SPCH_RE15,0) as SPCH_RE15
				, nvl(SPCH_RE29,0) as SPCH_RE29
				, nvl(SPCH_RE30,0) as SPCH_RE30
				, nvl(SPCI_REFX,0) as SPCI_REFX
				, nvl(SPCI_REEC,0) as SPCI_REEC
				, nvl(SPCI_15FX,0) as SPCI_15FX
				, nvl(SPCI_15FB,0) as SPCI_15FB
				, nvl(SPCI_15EC,0) as SPCI_15EC
				, nvl(SPCI_10FB,0) as SPCI_10FB
				, nvl(SPCI_10EC,0) as SPCI_10EC
				, nvl(SPCH_RETO,0) as SPCH_RETO
				, nvl(TAXD_PLTC,0) as TAXD_PLTC
				, nvl(SPCI_PLTC,0) as SPCI_PLTC
				, nvl(SPCI_FBAM,0) as SPCI_FBAM
				, nvl(SPCI_EXAM,0) as SPCI_EXAM
				, nvl(SPCI_UNON,0) as SPCI_UNON
				, nvl(SPCI_RFAM,0) as SPCI_RFAM
				, nvl(SPCI_YAMT,0) as SPCI_YAMT
				, nvl(SPCI_NAMT,0) as SPCI_NAMT
				, nvl(SPCI_DGCR,0) as SPCI_DGCR
				, nvl(SPCI_SSUM,0) as SPCI_SSUM
				, nvl(SPCI_DDCT,0) as SPCI_DDCT
				, nvl(SUBT_ERAM,0) as SUBT_ERAM
				, nvl(ETCP_PSNV,0) as ETCP_PSNV
				, nvl(ETCP_NSAV,0) as ETCP_NSAV
				, nvl(PRCM_TOAM,0) as PRCM_TOAM
				, nvl(ETCH_PREP,0) as ETCH_PREP
				, nvl(ETCS_COMP,0) as ETCS_COMP
				, nvl(ETWK_SBAM,0) as ETWK_SBAM
				, nvl(ETWK_SVAM,0) as ETWK_SVAM
				, nvl(ETWK_LGAM,0) as ETWK_LGAM
				, nvl(ETWK_BDAM,0) as ETWK_BDAM
				, nvl(ETCT_CONC,0) as ETCT_CONC
				, nvl(ETGD_09AF,0) as ETGD_09AF
				, nvl(ETGD_H13H,0) as ETGD_H13H
				, nvl(ETGD_D14F,0) as ETGD_D14F
				, nvl(ETGD_D14B,0) as ETGD_D14B
				, nvl(ETGD_D15F,0) as ETGD_D15F
				, nvl(ETGD_D15B,0) as ETGD_D15B
				, nvl(ETGD_D16F,0) as ETGD_D16F
				, nvl(ETGD_D16B,0) as ETGD_D16B
				, nvl(ETGD_DDAM,0) as ETGD_DDAM
				, nvl(ETCC_CARD,0) as ETCC_CARD
				, nvl(ETCK_UNON,0) as ETCK_UNON
				, nvl(ETCK_UNCR,0) as ETCK_UNCR
				, nvl(ETEP_MSAM,0) as ETEP_MSAM
				, nvl(ETGD_HTRA,0) as ETGD_HTRA
				, nvl(ETEP_SECR,0) as ETEP_SECR
				, nvl(ETCL_TO01,0) as ETCL_TO01
				, nvl(ETCL_TO02,0) as ETCL_TO02
				, nvl(ETCL_TO03,0) as ETCL_TO03
				, nvl(ETCL_HMTO,0) as ETCL_HMTO
				, nvl(ETCD_TSUM,0) as ETCD_TSUM
				, nvl(SPCH_EXLI,0) as SPCH_EXLI
				, nvl(STND_INCM,0) as STND_INCM
				, nvl(PRDD_TAXN,0) as PRDD_TAXN
				, nvl(TAXD_ICAX,0) as TAXD_ICAX
				, nvl(TAXD_SPCT,0) as TAXD_SPCT
				, nvl(TXLG_CL30,0) as TXLG_CL30
				, nvl(TXLG_HXTT,0) as TXLG_HXTT
				, nvl(TAXD_TSUM,0) as TAXD_TSUM
				, nvl(TAXD_WKEN,0) as TAXD_WKEN
				, nvl(TAXD_UNIN,0) as TAXD_UNIN
				, nvl(TAXD_LOAN,0) as TAXD_LOAN
				, nvl(TAXD_PAID,0) as TAXD_PAID
				, nvl(TAXD_REDU,0) as TAXD_REDU
				, nvl(ADDR_MCCR,0) as ADDR_MCCR
				, nvl(SPCI_DCTO,0) as SPCI_DCTO
				, nvl(TAXD_CSUM,0) as TAXD_CSUM
				, nvl(DCSN_INCM,0) as DCSN_INCM
				, nvl(DCSN_INHB,0) as DCSN_INHB
				, nvl(DCSN_FAFV,0) as DCSN_FAFV
				, nvl(ALRY_PINX,0) as ALRY_PINX
				, nvl(ALRY_PHBX,0) as ALRY_PHBX
				, nvl(ALRY_YVTX,0) as ALRY_YVTX
				, nvl(DCSN_TOTS,0) as DCSN_TOTS
				, nvl(DCSN_ITAX,0) as DCSN_ITAX
				, nvl(DCSN_BTAX,0) as DCSN_BTAX
				, nvl(FAFV_TAXI,0) as FAFV_TAXI
				, nvl(SUBT_ETAX,0) as SUBT_ETAX
				, nvl(SUBT_INHB,0) as SUBT_INHB
				, nvl(SUBT_FAFV,0) as SUBT_FAFV
				, nvl(SUBT_AMSU,0) as SUBT_AMSU
				, nvl(JRTR_HNTO,0) as JRTR_HNTO
				, nvl(SPCI_ONON,0) as SPCI_ONON
				, nvl(SPCI_OBAM,0) as SPCI_OBAM
				, nvl(SPCI_OYAM,0) as SPCI_OYAM
				, nvl(SPCI_ONAM,0) as SPCI_ONAM
				, KYBDR
				, INPT_DT
				, INPT_ADDR
				, ISMT
				, REVN_DT
				, REVN_ADDR
			FROM YETA3000
						WHERE DPOB_CD=#dpobCd#
								AND EDAC_RVYY=#edacRvyy#
								AND SETT_GBCD=#settGbcd#
								AND SYSTEMKEY=#systemkey#
				]]>
	</select>
	
 
	
	<select id="infcPkgYeta3000DAO.selectYetaPrc3000List_D" parameterClass="infcPkgYeta3000SerarchVO" resultClass="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (
				SELECT
								DPOB_CD
								, EDAC_RVYY
								, SETT_GBCD
								, SYSTEMKEY
								, BEFO_SCNT
								, PAYR_TAMT
								, BONS_TOAM
								, DTMN_BSAM
								, STCK_PRFT
								, CURR_TOTS
								, TAXM_SFAM
								, TAXM_ETAM
								, TAXM_BOIN
								, TXEC_AMNT
								, TOTL_SALA
								, WKER_DDCT
								, WKER_AMNT
								, BASE_SELF
								, BASE_WIFE
								, BASE_FYAM
								, ADDR_HDAM
								, ADDR_RPT70
								, ADDR_FAME
								, ADDR_CHLD
								, ADDR_BRTH
								, PANT_ONAM
								, ADDR_MCAM
								, BNAT_DDCT
								, JNAT_DDCT
								, BPSS_DDCT
								, BPSS_HSOL
								, BPSS_HTEC
								, BPSS_HPUL
								, JPSS_DDCT
								, JPSS_HSOL
								, JPSS_HTEC
								, JPSS_HPUL
								, BRTR_HICT
								, BRTR_PSRN
								, BRTR_HNSV
								, JRTR_HICT
								, JRTR_PSRN
								, JRTR_HNSV
								, RRPT_YNAM
								, SPCI_BHTH
								, SPCI_JHTH
								, SPCI_BEPF
								, SPCI_JEPF
								, SPCI_GURT
								, SPCI_HDRC
								, SPCI_RTDE
								, SPCI_HRTO
								, SPCI_SELF
								, SPCI_HE65
								, SPCI_HBPS
								, SPCI_DETC
								, SPCI_TXCR
								, SPCI_METO
								, SPED_SELF
								, SPED_GRDE
								, SPED_GDTO
								, SPED_CLDV
								, SPCI_SPEC
								, SPED_TXCR
								, SPED_TOAM
								, SPCI_REFN
								, SPCI_RESF
								, SPCI_TGRT
								, SPCI_RTAM
								, SPCH_REFN
								, SPCH_RE15
								, SPCH_RE29
								, SPCH_RE30
								, SPCI_REFX
								, SPCI_REEC
								, SPCI_15FX
								, SPCI_15FB
								, SPCI_15EC
								, SPCI_10FB
								, SPCI_10EC
								, SPCH_RETO
								, TAXD_PLTC
								, SPCI_PLTC
								, SPCI_FBAM
								, SPCI_EXAM
								, SPCI_UNON
								, SPCI_RFAM
								, SPCI_YAMT
								, SPCI_NAMT
								, SPCI_DGCR
								, SPCI_SSUM
								, SPCI_DDCT
								, SUBT_ERAM
								, ETCP_PSNV
								, ETCP_NSAV
								, PRCM_TOAM
								, ETCH_PREP
								, ETCS_COMP
								, ETWK_SBAM
								, ETWK_SVAM
								, ETWK_LGAM
								, ETWK_BDAM
								, ETCT_CONC
								, ETGD_09AF
								, ETGD_H13H
								, ETGD_D14F
								, ETGD_DDAM
								, ETCC_CARD
								, ETCK_UNON
								, ETCK_UNCR
								, ETEP_MSAM
								, ETGD_HTRA
								, ETEP_SECR
								, ETCL_TO01
								, ETCL_TO02
								, ETCL_TO03
								, ETCL_HMTO
								, ETCD_TSUM
								, SPCH_EXLI
								, STND_INCM
								, PRDD_TAXN
								, TAXD_ICAX
								, TAXD_SPCT
								, TXLG_CL30
								, TXLG_HXTT
								, TAXD_TSUM
								, TAXD_WKEN
								, TAXD_UNIN
								, TAXD_LOAN
								, TAXD_PAID
								, TAXD_REDU
								, ADDR_MCCR
								, SPCI_DCTO
								, TAXD_CSUM
								, DCSN_INCM
								, DCSN_INHB
								, DCSN_FAFV
								, ALRY_PINX
								, ALRY_PHBX
								, ALRY_YVTX
								, DCSN_TOTS
								, DCSN_ITAX
								, DCSN_BTAX
								, FAFV_TAXI
								, SUBT_ETAX
								, SUBT_INHB
								, SUBT_FAFV
								, SUBT_AMSU
								, JRTR_HNTO
								, SPCI_ONON
								, SPCI_OBAM
								, SPCI_OYAM
								, SPCI_ONAM
								, KYBDR
								, INPT_DT
								, INPT_ADDR
								, ISMT
								, REVN_DT
								, REVN_ADDR
						FROM YETA3000
				WHERE 1=1
				<isEqual prepend="AND" property="searchCondition" compareValue="0">
					DPOB_CD = #searchKeyword#
				</isEqual>
				<isEqual prepend="AND" property="searchCondition" compareValue="1">
					EDAC_RVYY LIKE '%' || #searchKeyword# || '%'
				</isEqual>
					ORDER BY 
						DPOB_CD DESC
							, EDAC_RVYY DESC
							, SETT_GBCD DESC
							, SYSTEMKEY DESC
		
		<![CDATA[					
	) A WHERE ROWNUM <= #lastIndex#
)WHERE RNUM > #firstIndex#
]]>
	</select>	
	<select id="infcPkgYeta3000DAO.selectYetaPrc3000ListTotCnt_S" parameterClass="infcPkgYeta3000SerarchVO" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM YETA3000
			WHERE 1=1
			<isEqual prepend="AND" property="searchCondition" compareValue="0">
				DPOB_CD = #searchKeyword#
			</isEqual>
			<isEqual prepend="AND" property="searchCondition" compareValue="1">
				EDAC_RVYY LIKE '%' || #searchKeyword# || '%'
			</isEqual>
	</select>

</sqlMap>
