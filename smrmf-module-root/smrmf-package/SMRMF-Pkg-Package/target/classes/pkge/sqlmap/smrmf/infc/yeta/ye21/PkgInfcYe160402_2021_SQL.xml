<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="PkgInfcYe160402_2021">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="infcPkgYe170402Srh_2021_Vo" type="com.app.smrmf.infc.yearendtax.server.vo.InfcPkgYe160402SrhVO"/>
	
	<resultMap id="infcPkgYe170402_2021" class="com.app.smrmf.infc.yearendtax.server.vo.InfcPkgYe160402VO">
		<result property="systemkey" column="SYSTEMKEY" columnIndex="1"/>
		<result property="elctYymm" column="ELCT_YYMM" columnIndex="2"/>
		<result property="dpobCd" column="DPOB_CD" columnIndex="3"/>
		<result property="yrtxBlggYr" column="YRTX_BLGG_YR" columnIndex="4"/>
		<result property="clutSeptCd" column="CLUT_SEPT_CD" columnIndex="5"/>
		<result property="taxmSa01Ka" column="TAXM_SA01_KA" columnIndex="6"/>
		<result property="taxmSb01Ka" column="TAXM_SB01_KA" columnIndex="7"/>
		<result property="taxmSc01Ka" column="TAXM_SC01_KA" columnIndex="8"/>
		<result property="taxmSd01Ka" column="TAXM_SD01_KA" columnIndex="9"/>
		<result property="taxmSe01Ka" column="TAXM_SE01_KA" columnIndex="10"/>
		<result property="taxmSe02Ka" column="TAXM_SE02_KA" columnIndex="11"/>
		<result property="taxmSe10Ka" column="TAXM_SE10_KA" columnIndex="12"/>
		<result property="taxmSf01Ka" column="TAXM_SF01_KA" columnIndex="13"/>
		<result property="taxmSg01Ka" column="TAXM_SG01_KA" columnIndex="14"/>
		<result property="taxmSh01Ka" column="TAXM_SH01_KA" columnIndex="15"/>
		<result property="taxmSh02Ka" column="TAXM_SH02_KA" columnIndex="16"/>
		<result property="taxmSh03Ka" column="TAXM_SH03_KA" columnIndex="17"/>
		<result property="taxmSh04Ka" column="TAXM_SH04_KA" columnIndex="18"/>
		<result property="taxmSh05Ka" column="TAXM_SH05_KA" columnIndex="19"/>
		<result property="taxmSh06Ka" column="TAXM_SH06_KA" columnIndex="20"/>
		<result property="taxmSh07Ka" column="TAXM_SH07_KA" columnIndex="21"/>
		<result property="taxmSh08Ka" column="TAXM_SH08_KA" columnIndex="22"/>
		<result property="taxmSh09Ka" column="TAXM_SH09_KA" columnIndex="23"/>
		<result property="taxmSh10Ka" column="TAXM_SH10_KA" columnIndex="24"/>
		<result property="taxmSh14Ka" column="TAXM_SH14_KA" columnIndex="25"/>
		<result property="taxmSh15Ka" column="TAXM_SH15_KA" columnIndex="26"/>
		<result property="taxmSh11Ka" column="TAXM_SH11_KA" columnIndex="27"/>
		<result property="taxmSh12Ka" column="TAXM_SH12_KA" columnIndex="28"/>
		<result property="taxmSh13Ka" column="TAXM_SH13_KA" columnIndex="29"/>
		<result property="taxmSh16Ka" column="TAXM_SH16_KA" columnIndex="30"/>
		<result property="taxmSi01Ka" column="TAXM_SI01_KA" columnIndex="31"/>
		<result property="taxmSj01Ka" column="TAXM_SJ01_KA" columnIndex="32"/>
		<result property="taxmSj10Ka" column="TAXM_SJ10_KA" columnIndex="33"/>
		<result property="taxmSk01Ka" column="TAXM_SK01_KA" columnIndex="34"/>
		<result property="taxmSl01Ka" column="TAXM_SL01_KA" columnIndex="35"/>
		<result property="taxmSm01Ka" column="TAXM_SM01_KA" columnIndex="36"/>
		<result property="taxmSm02Ka" column="TAXM_SM02_KA" columnIndex="37"/>
		<result property="taxmSm03Ka" column="TAXM_SM03_KA" columnIndex="38"/>
		<result property="taxmSn01Ka" column="TAXM_SN01_KA" columnIndex="39"/>
		<result property="taxmSo01Ka" column="TAXM_SO01_KA" columnIndex="40"/>
		<result property="taxmSp01Ka" column="TAXM_SP01_KA" columnIndex="41"/>
		<result property="taxmSp02Ka" column="TAXM_SP02_KA" columnIndex="42"/>
		<result property="taxmSq01Ka" column="TAXM_SQ01_KA" columnIndex="43"/>
		<result property="taxmSr01Ka" column="TAXM_SR01_KA" columnIndex="44"/>
		<result property="taxmSr10Ka" column="TAXM_SR10_KA" columnIndex="45"/>
		<result property="taxmSs01Ka" column="TAXM_SS01_KA" columnIndex="46"/>
		<result property="taxmSy02Ka" column="TAXM_SY02_KA" columnIndex="47"/>
		<result property="taxmSy03Ka" column="TAXM_SY03_KA" columnIndex="48"/>
		<result property="taxmSy04Ka" column="TAXM_SY04_KA" columnIndex="49"/>
		<result property="taxmSy21Ka" column="TAXM_SY21_KA" columnIndex="50"/>
		<result property="taxmSy22Ka" column="TAXM_SY22_KA" columnIndex="51"/>
		<result property="taxmSt01Ka" column="TAXM_ST01_KA" columnIndex="52"/>
		<result property="taxmSt10Ka" column="TAXM_ST10_KA" columnIndex="53"/>
		<result property="taxmSt11Ka" column="TAXM_ST11_KA" columnIndex="54"/>
		<result property="taxmSt12Ka" column="TAXM_ST12_KA" columnIndex="55"/>
		<result property="taxmSt20Ka" column="TAXM_ST20_KA" columnIndex="56"/>
		<result property="kybdr" column="KYBDR" columnIndex="57"/>
		<result property="inptDt" column="INPT_DT" columnIndex="58"/>
		<result property="inptAddr" column="INPT_ADDR" columnIndex="59"/>
		<result property="ismt" column="ISMT" columnIndex="60"/>
		<result property="revnDt" column="REVN_DT" columnIndex="61"/>
		<result property="revnAddr" column="REVN_ADDR" columnIndex="62"/>
		<result property="taxmSr11Ka" column="TAXM_SR11_KA" columnIndex="63"/>
		
	</resultMap>
	 
	
	<!-- 연말정산 급여이관 생성 -->
	<insert id="infcPkgYe170402_2021_DAO.fnYeta6100_YE160402_PAYR_2021_CREATE_Insert_S">
		<![CDATA[
			INSERT INTO YE160402 
				(  DPOB_CD
				  , ELCT_YYMM
				  ,SYSTEMKEY
				  , YRTX_BLGG_YR
				  , CLUT_SEPT_CD
				  , TAXM_SA01_KA
				  , TAXM_SB01_KA
				  , TAXM_SC01_KA
				  , TAXM_SD01_KA
				  , TAXM_SE01_KA
				  , TAXM_SE02_KA
				  , TAXM_SE10_KA
				  , TAXM_SF01_KA
				  , TAXM_SG01_KA
				  , TAXM_SH01_KA
				  , TAXM_SH02_KA
				  , TAXM_SH03_KA
				  , TAXM_SH04_KA
				  , TAXM_SH05_KA
				  , TAXM_SH06_KA
				  , TAXM_SH07_KA
				  , TAXM_SH08_KA
				  , TAXM_SH09_KA
				  , TAXM_SH10_KA
				  , TAXM_SH14_KA
				  , TAXM_SH15_KA
				  , TAXM_SH11_KA
				  , TAXM_SH12_KA
				  , TAXM_SH13_KA
				  , TAXM_SH16_KA
				  , TAXM_SI01_KA
				  , TAXM_SJ01_KA
				  , TAXM_SJ10_KA
				  , TAXM_SK01_KA
				  , TAXM_SL01_KA
				  , TAXM_SM01_KA
				  , TAXM_SM02_KA
				  , TAXM_SM03_KA
				  , TAXM_SN01_KA
				  , TAXM_SO01_KA
				  , TAXM_SP01_KA
				  , TAXM_SP02_KA
				  , TAXM_SQ01_KA
				  , TAXM_SR01_KA
				  , TAXM_SR10_KA
				   , TAXM_SR11_KA
				  , TAXM_SS01_KA
				  , TAXM_SY02_KA
				  , TAXM_SY03_KA
				  , TAXM_SY04_KA
				  , TAXM_SY21_KA
				  , TAXM_SY22_KA
				  , TAXM_ST01_KA
				  , TAXM_ST10_KA
				  , TAXM_ST11_KA
				  , TAXM_ST12_KA
				  , TAXM_ST20_KA
				  , KYBDR
				  , INPT_DT
				  , INPT_ADDR
				  , ISMT
				  , REVN_DT
				  , REVN_ADDR )
				( SELECT  DPOB_CD 
				      ,  PYMT_YR_MNTH 
				      ,  SYSTEMKEY 
                          , #yrtxBlggYr# 
                          , #clutSeptCd#
                          , (0) AS TAXM_SA01_KA
                          , (0) AS TAXM_SB01_KA
                          , (0) AS TAXM_SC01_KA
                          , (0) AS TAXM_SD01_KA
                          , (0) AS TAXM_SE01_KA
                          , (0) AS TAXM_SE02_KA
                          , (0) AS TAXM_SE10_KA
                          , (0) AS TAXM_SF01_KA
                          , (0) AS TAXM_SG01_KA
                          , (0) AS TAXM_SH01_KA
                          , (0) AS TAXM_SH02_KA 
                           , SUM(TAXM_SH03_KA ) AS TAXM_SH03_KA  /*  자가운전보조금    */
                          , (0) AS TAXM_SH04_KA
                          , (0) AS TAXM_SH05_KA
                          , (0) AS TAXM_SH06_KA
                          , (0) AS TAXM_SH07_KA
                          , (0) AS TAXM_SH08_KA
                          , (0) AS TAXM_SH09_KA
                          , (0) AS TAXM_SH10_KA
                          , (0) AS TAXM_SH14_KA
                          , (0) AS TAXM_SH15_KA
                          , (0) AS TAXM_SH11_KA
                          , (0) AS TAXM_SH12_KA
                          , (0) AS TAXM_SH13_KA
                          , (0) AS TAXM_SH16_KA
                          , (0) AS TAXM_SI01_KA
                          , (0) AS TAXM_SJ01_KA
                          , (0) AS TAXM_SJ10_KA
                          , (0) AS TAXM_SK01_KA
                          , (0) AS TAXM_SL01_KA
                          , (0) AS TAXM_SM01_KA
                          , (0) AS TAXM_SM02_KA
                          , (0) AS TAXM_SM03_KA
                          , (0) AS TAXM_SN01_KA
                          , (0) AS TAXM_SO01_KA
                          ,  SUM(TAXM_SP01_KA) AS TAXM_SP01_KA   /* 정액급식비  */                                       
                          , (0) AS TAXM_SP02_KA
                          , SUM( TAXM_SQ01_KA) AS TAXM_SQ01_KA /*  출산,보육수당   */
                          , (0) AS TAXM_SR01_KA
                          , (0) AS TAXM_SR10_KA
                          , (0) AS TAXM_SR11_KA
                          , (0) AS TAXM_SS01_KA
                          , (0) AS TAXM_SY02_KA
                          , (0) AS TAXM_SY03_KA
                          , (0) AS TAXM_SY04_KA
                          , (0) AS TAXM_SY21_KA
                          , (0) AS TAXM_SY22_KA
                          , (0) AS TAXM_ST01_KA
                          , (0) AS TAXM_ST10_KA
                          , (0) AS TAXM_ST11_KA
                          , (0) AS TAXM_ST12_KA
                          , (0) AS TAXM_ST20_KA
                          , #kybdr#
                          , TO_CHAR(SYSDATE, 'YYYYMMDD')
                          , #inptAddr#
                          , #ismt#
                          , TO_CHAR(SYSDATE, 'YYYYMMDD')
                          , #revnAddr# 
FROM
(
SELECT   BB.DPOB_CD 
      ,  BB.PYMT_YR_MNTH 
      ,  BB.SYSTEMKEY 
   ,  NVL (
              (SELECT SUM (PYMT_DDUC_TXTN_AMNT)
                 FROM (SELECT DPOB_CD,
                              PYMT_YR_MNTH,
                              SYSTEMKEY,
                              PAY_ITEM_CD,
                              PYMT_DDUC_TXTN_AMNT
                         FROM PAYR0302
                        WHERE     PAY_ITEM_CD = 'C9100200'
                              AND NOT EXISTS
                                         (SELECT *
                                            FROM (SELECT KW01.DPOB_CD,
                                                         KW01.PYYT_YR_MNTH,
                                                         KW01.SYSTEMKEY,
                                                           KW01.PAY_CD
                                                    FROM PYYT0304 KW01) KW02
                                           WHERE     KW02.DPOB_CD =
                                                        PAYR0302.DPOB_CD
                                                 AND KW02.PYYT_YR_MNTH =
                                                        PAYR0302.PYMT_YR_MNTH
                                                 AND KW02.SYSTEMKEY =
                                                        PAYR0302.SYSTEMKEY
                                                      AND KW02.PAY_CD = PAYR0302.PAY_CD)
                       UNION ALL
                       SELECT DPOB_CD,
                              PYYT_YR_MNTH,
                              SYSTEMKEY,
                              PYYT_ITEM_CD,
                              PYYT_PYDD_TXTN_AMNT
                         FROM PYYT0302
                        WHERE PYYT_ITEM_CD = 'C9100200') A03
                WHERE     A03.DPOB_CD = BB.DPOB_CD
                      AND A03.PYMT_YR_MNTH = BB.PYMT_YR_MNTH
                      AND A03.SYSTEMKEY = BB.SYSTEMKEY
                      AND A03.PAY_ITEM_CD = 'C9100200'),
              0)
              AS TAXM_SH03_KA                                    /* 자가운전보조금 */
                             
          
        ,   NVL (
              (SELECT SUM (PYMT_DDUC_TXTN_AMNT)
                 FROM (SELECT DPOB_CD,
                              PYMT_YR_MNTH,
                              SYSTEMKEY,
                              PAY_ITEM_CD,
                              PYMT_DDUC_TXTN_AMNT
                         FROM PAYR0302
                        WHERE     PAY_ITEM_CD = 'C9080100'
                              AND NOT EXISTS
                                         (SELECT *
                                            FROM (SELECT KW01.DPOB_CD,
                                                         KW01.PYYT_YR_MNTH,
                                                         KW01.SYSTEMKEY,
                                                           KW01.PAY_CD
                                                    FROM PYYT0304 KW01) KW02
                                           WHERE     KW02.DPOB_CD =
                                                        PAYR0302.DPOB_CD
                                                 AND KW02.PYYT_YR_MNTH =
                                                        PAYR0302.PYMT_YR_MNTH
                                                 AND KW02.SYSTEMKEY =
                                                        PAYR0302.SYSTEMKEY
                                                 AND   KW02.PAY_CD =   PAYR0302.PAY_CD       )
                       UNION ALL
                       SELECT DPOB_CD,
                              PYYT_YR_MNTH,
                              SYSTEMKEY,
                              PYYT_ITEM_CD,
                              PYYT_PYDD_TXTN_AMNT
                         FROM PYYT0302
                        WHERE PYYT_ITEM_CD = 'C9100200') A03
                WHERE     A03.DPOB_CD = BB.DPOB_CD
                      AND A03.PYMT_YR_MNTH = BB.PYMT_YR_MNTH
                      AND A03.SYSTEMKEY = BB.SYSTEMKEY
                      AND A03.PAY_ITEM_CD = 'C9080100'),
              0)
              AS TAXM_SP01_KA                                      /* 정액급식비 */
                           
        ,   NVL (
              (SELECT SUM (PYMT_DDUC_TXTN_AMNT)
                 FROM (SELECT DPOB_CD,
                              PYMT_YR_MNTH,
                              SYSTEMKEY,
                              PAY_ITEM_CD,
                              PYMT_DDUC_TXTN_AMNT
                         FROM PAYR0302
                        WHERE     PAY_ITEM_CD = 'C9050100'
                              AND NOT EXISTS
                                         (SELECT *
                                            FROM (SELECT KW01.DPOB_CD,
                                                         KW01.PYYT_YR_MNTH,
                                                         KW01.SYSTEMKEY,
                                                           KW01.PAY_CD
                                                    FROM PYYT0304 KW01) KW02
                                           WHERE     KW02.DPOB_CD =
                                                        PAYR0302.DPOB_CD
                                                 AND KW02.PYYT_YR_MNTH =
                                                        PAYR0302.PYMT_YR_MNTH
                                                 AND KW02.SYSTEMKEY =
                                                        PAYR0302.SYSTEMKEY
                                                 AND   KW02.PAY_CD =   PAYR0302.PAY_CD       )
                       UNION ALL
                       SELECT DPOB_CD,
                              PYYT_YR_MNTH,
                              SYSTEMKEY,
                              PYYT_ITEM_CD,
                              PYYT_PYDD_TXTN_AMNT
                         FROM PYYT0302
                        WHERE PYYT_ITEM_CD = 'C9100200') A03
                WHERE     A03.DPOB_CD = BB.DPOB_CD
                      AND A03.PYMT_YR_MNTH = BB.PYMT_YR_MNTH
                      AND A03.SYSTEMKEY = BB.SYSTEMKEY
                      AND A03.PAY_ITEM_CD = 'C9050100'),
              0)
              AS TAXM_SQ01_KA                                    /* 출산,보육수당 */
  FROM   ( SELECT  DISTINCT   AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PYMT_YR_MNTH
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
                                             , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
                                            , DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
                                            , DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
                                            , DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
                                            , DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
                                            , DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
                                            , DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT 
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT   
                                                FROM PSNL0100 AD01, ( SELECT 
                                               DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
                                               PAY_CD,  PAYR_MANG_DEPT_CD, 
                                               EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
                                               DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
                                                 ODTY_CD, PYSP_CD, 
                                                 LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
                                               FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
                                               HDOFC_DIV_CD, RETRY_DT 
                                            FROM  PAYR0304 
                                            ) AD02,
                                                (SELECT NN.DPOB_CD,
                                                                       NN.PYMT_YR_MNTH,
                                                                       NN.PAY_CD,
                                                                       NN.SYSTEMKEY,
                                                                       NN.PAYR_SEIL_NUM
                                                             FROM    
                                                             (SELECT           DPOB_CD,
                                                                               PYMT_YR_MNTH,
                                                                               PAY_CD,
                                                                               SYSTEMKEY,
                                                                               MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
                                                                          FROM (SELECT 
                                                                               DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
                                                                               PAY_CD,  PAYR_MANG_DEPT_CD, 
                                                                               EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
                                                                               DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
                                                                                 ODTY_CD, PYSP_CD, 
                                                                                 LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
                                                                               FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
                                                                               HDOFC_DIV_CD, RETRY_DT 
                                                                            FROM  PAYR0304 
                                                                         ) PAYR0304
                                                                         WHERE     PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'  
                                                                             GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY  
                                                                         ) NN,
                                                                          (  
                                                                           SELECT        MM.DPOB_CD,
                                                                                         MM.PYMT_YR_MNTH ,
                                                                                         MM.PAY_CD , 
                                                                                         MM.SYSTEMKEY ,
                                                                                         MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
                                                                             FROM    
                                                                             (  
                                                                            SELECT       SEL_NUM,
                                                                                         DPOB_CD,
                                                                                         PYMT_YR_MNTH ,
                                                                                         PAY_CD , 
                                                                                         SYSTEMKEY ,
                                                                                         PAYR_SEIL_NUM
                                                                             FROM 
                                                                              (SELECT  ROW_NUMBER ()
                                                                                         OVER (ORDER BY
                                                                                                  DPOB_CD,
                                                                                                  SYSTEMKEY,
                                                                                                  PYMT_YR_MNTH ASC,
                                                                                                  PAY_CD ASC,
                                                                                                  PAYR_SEIL_NUM DESC) AS SEL_NUM,
                                                                                         DPOB_CD,
                                                                                         PYMT_YR_MNTH ,
                                                                                         PAY_CD , 
                                                                                         SYSTEMKEY ,
                                                                                         PAYR_SEIL_NUM
                                                                                    FROM PAYR0304   
                                                                                      WHERE   PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
                                                                                       AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
                                                                                          SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
                                                                                        FROM PAYR0304 NNAA 
                                                                                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
                                                                                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
                                                                                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
                                                                                          AND NNAA.PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
                                                                                          GROUP BY SYSTEMKEY
                                                                                                       )
                                                                                    )
                                                                                      ORDER BY  SEL_NUM DESC 
                                                                                    ) MM  
                                                                                     WHERE ROWNUM = 1  
                                                                                     AND SYSTEMKEY=#systemkey# 
                                                                                     ) GG
                                                                    WHERE NN.DPOB_CD = GG.DPOB_CD
                                                                      AND NN.SYSTEMKEY = GG.SYSTEMKEY   
                                                                      AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH 
                                                                  /*    AND NN.PAY_CD = GG.PAY_CD 
                                                                      AND NN.PAYR_SEIL_NUM = GG.PAYR_SEIL_NUM  */
                                                                              ) AD03
                                                             WHERE     AD02.DPOB_CD = AD01.DPOB_CD
                                                                   AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                                   AND AD02.DPOB_CD = AD03.DPOB_CD
                                                                   AND AD02.PYMT_YR_MNTH = AD03.PYMT_YR_MNTH
                                                                   AND AD02.SYSTEMKEY = AD03.SYSTEMKEY
                                                                   AND AD02.PAY_CD = AD03.PAY_CD
                                                                   AND AD02.PAYR_SEIL_NUM = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'  ) AA ,  (
                     SELECT       AC01.DPOB_CD,AC01.PAY_CD,
                                    AC01.PYMT_YR_MNTH, 
                                    AC01.SYSTEMKEY,
                                    AC01.PAYR_MANG_DEPT_CD,
                                    AC01.EMYMT_DIV_CD,
                                    AC01.HAN_NM,
                                       AC02.PAY_PYMT_DT
                      FROM PAYR0304 AC01,
                           (  SELECT A03.DPOB_CD,
                                     A03.PYMT_YR_MNTH, 
                                     A03.SYSTEMKEY,
                                     MAX (A02.PAY_PYMT_DT) PAY_PYMT_DT
                                FROM PAYR0300 A02, PAYR0304 A03
                               WHERE     A02.DPOB_CD = A03.DPOB_CD
                                     AND A02.PYMT_YR_MNTH = A03.PYMT_YR_MNTH
                                     AND A02.PAY_CD = A03.PAY_CD
                                     AND A02.PAYR_SEIL_NUM = A03.PAYR_SEIL_NUM
                            GROUP BY A03.DPOB_CD,
                                     A03.PYMT_YR_MNTH, 
                                     A03.SYSTEMKEY) AC02
                     WHERE     AC01.DPOB_CD = AC02.DPOB_CD
                           AND AC01.PYMT_YR_MNTH = AC02.PYMT_YR_MNTH 
                           AND AC01.SYSTEMKEY = AC02.SYSTEMKEY
                           AND AC01.SYSTEMKEY=#systemkey# 
                            GROUP BY AC01.DPOB_CD,
                                    AC01.PYMT_YR_MNTH, 
                                    AC01.PAY_CD,
                                    AC01.SYSTEMKEY,
                                    AC01.PAYR_MANG_DEPT_CD,
                                    AC01.EMYMT_DIV_CD,
                                    AC01.HAN_NM  ,
                                    AC02.PAY_PYMT_DT
      ) BB   
 WHERE   BB.DPOB_CD=#dpobCd#  
      AND BB.SYSTEMKEY=#systemkey# 
      AND  BB.PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'  
      AND  BB.DPOB_CD = AA.DPOB_CD
      AND  BB.SYSTEMKEY = AA.SYSTEMKEY
         ]]> 
                   <isEqual prepend="AND" property="addCheck" compareValue="ADD">
                      NOT  EXISTS (SELECT *
                                     FROM (SELECT  KF01.DPOB_CD 
                                                 , KF01.YRTX_BLGG_YR
                                                 , KF01.CLUT_SEPT_CD 
                                                 , KF01.SYSTEMKEY 
                                             FROM YE160401 KF01 ) KK01
                                    WHERE     KK01.DPOB_CD = AA.DPOB_CD
                                          AND KK01.YRTX_BLGG_YR = #yrtxBlggYr#
                                          AND KK01.CLUT_SEPT_CD = #clutSeptCd# 
                                          AND KK01.SYSTEMKEY = AA.SYSTEMKEY)  
                  </isEqual>  
           <![CDATA[          
                   AND NOT EXISTS
                              (SELECT *
                                 FROM (SELECT KW01.DPOB_CD,
                                              KW01.PYYT_YR_MNTH, 
                                              KW01.SYSTEMKEY,
                                                KW01.PAY_CD
                                         FROM PYYT0304 KW01) KW02
                                WHERE     KW02.DPOB_CD = BB.DPOB_CD
                                      AND KW02.PYYT_YR_MNTH = BB.PYMT_YR_MNTH
                                      AND KW02.SYSTEMKEY = BB.SYSTEMKEY
                                      AND KW02.PAY_CD = BB.PAY_CD)   
                    GROUP BY                    BB.DPOB_CD 
      ,  BB.PYMT_YR_MNTH 
      ,  BB.SYSTEMKEY         
UNION ALL
SELECT BB.DPOB_CD 
      ,BB.PYMT_YR_MNTH 
      ,BB.SYSTEMKEY 
  ,  NVL (
              (SELECT SUM (PYMT_DDUC_TXTN_AMNT)
                 FROM (SELECT DPOB_CD,
                              PYMT_YR_MNTH,
                              SYSTEMKEY,
                              PAY_ITEM_CD,
                              PYMT_DDUC_TXTN_AMNT
                         FROM PAYR0302
                        WHERE     PAY_ITEM_CD = 'C9100200'
                              AND NOT EXISTS
                                         (SELECT *
                                            FROM (SELECT KW01.DPOB_CD,
                                                         KW01.PYYT_YR_MNTH,
                                                         KW01.SYSTEMKEY,
                                                           KW01.PAY_CD
                                                    FROM PYYT0304 KW01) KW02
                                           WHERE     KW02.DPOB_CD =
                                                        PAYR0302.DPOB_CD
                                                 AND KW02.PYYT_YR_MNTH =
                                                        PAYR0302.PYMT_YR_MNTH
                                                 AND KW02.SYSTEMKEY =
                                                        PAYR0302.SYSTEMKEY
                                                 AND   KW02.PAY_CD =  PAYR0302.PAY_CD       )
                       UNION ALL
                       SELECT DPOB_CD,
                              PYYT_YR_MNTH,
                              SYSTEMKEY,
                              PYYT_ITEM_CD,
                              PYYT_PYDD_TXTN_AMNT
                         FROM PYYT0302
                        WHERE PYYT_ITEM_CD = 'C9100200') A03
                WHERE     A03.DPOB_CD = BB.DPOB_CD
                      AND A03.PYMT_YR_MNTH = BB.PYMT_YR_MNTH
                      AND A03.SYSTEMKEY = BB.SYSTEMKEY
                      AND A03.PAY_ITEM_CD = 'C9100200'),
              0)
              AS TAXM_SH03_KA                                    /* 자가운전보조금 */
                             ,
          
           NVL (
              (SELECT SUM (PYMT_DDUC_TXTN_AMNT)
                 FROM (SELECT DPOB_CD,
                              PYMT_YR_MNTH,
                              SYSTEMKEY,
                              PAY_ITEM_CD,
                              PYMT_DDUC_TXTN_AMNT
                         FROM PAYR0302
                        WHERE     PAY_ITEM_CD = 'C9080100'
                              AND NOT EXISTS
                                         (SELECT *
                                            FROM (SELECT KW01.DPOB_CD,
                                                         KW01.PYYT_YR_MNTH,
                                                         KW01.SYSTEMKEY,
                                                           KW01.PAY_CD
                                                    FROM PYYT0304 KW01) KW02
                                           WHERE     KW02.DPOB_CD =
                                                        PAYR0302.DPOB_CD
                                                 AND KW02.PYYT_YR_MNTH =
                                                        PAYR0302.PYMT_YR_MNTH
                                                 AND KW02.SYSTEMKEY =
                                                        PAYR0302.SYSTEMKEY
                                                        AND   KW02.PAY_CD =   PAYR0302.PAY_CD)
                       UNION ALL
                       SELECT DPOB_CD,
                              PYYT_YR_MNTH,
                              SYSTEMKEY,
                              PYYT_ITEM_CD,
                              PYYT_PYDD_TXTN_AMNT
                         FROM PYYT0302
                        WHERE PYYT_ITEM_CD = 'C9100200') A03
                WHERE     A03.DPOB_CD = BB.DPOB_CD
                      AND A03.PYMT_YR_MNTH = BB.PYMT_YR_MNTH
                      AND A03.SYSTEMKEY = BB.SYSTEMKEY
                      AND A03.PAY_ITEM_CD = 'C9080100'),
              0)
              AS TAXM_SP01_KA                                      /* 정액급식비 */
                             , 
           NVL (
              (SELECT SUM (PYMT_DDUC_TXTN_AMNT)
                 FROM (SELECT DPOB_CD,
                              PYMT_YR_MNTH,
                              SYSTEMKEY,
                              PAY_ITEM_CD,
                              PYMT_DDUC_TXTN_AMNT
                         FROM PAYR0302
                        WHERE     PAY_ITEM_CD = 'C9050100'
                              AND NOT EXISTS
                                         (SELECT *
                                            FROM (SELECT KW01.DPOB_CD,
                                                         KW01.PYYT_YR_MNTH,
                                                         KW01.SYSTEMKEY,
                                                           KW01.PAY_CD
                                                    FROM PYYT0304 KW01) KW02
                                           WHERE     KW02.DPOB_CD =
                                                        PAYR0302.DPOB_CD
                                                 AND KW02.PYYT_YR_MNTH =
                                                        PAYR0302.PYMT_YR_MNTH
                                                 AND KW02.SYSTEMKEY =
                                                        PAYR0302.SYSTEMKEY
                                                        AND   KW02.PAY_CD =   PAYR0302.PAY_CD)
                       UNION ALL
                       SELECT DPOB_CD,
                              PYYT_YR_MNTH,
                              SYSTEMKEY,
                              PYYT_ITEM_CD,
                              PYYT_PYDD_TXTN_AMNT
                         FROM PYYT0302
                        WHERE PYYT_ITEM_CD = 'C9100200') A03
                WHERE     A03.DPOB_CD = BB.DPOB_CD
                      AND A03.PYMT_YR_MNTH = BB.PYMT_YR_MNTH
                      AND A03.SYSTEMKEY = BB.SYSTEMKEY
                      AND A03.PAY_ITEM_CD = 'C9050100'),
              0)
              AS TAXM_SQ01_KA                                    /* 출산,보육수당 */
  FROM   (
        SELECT   DISTINCT  AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PYYT_YR_MNTH 
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD  
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
                                              , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
                                                , DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
                                                , DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
                                                , DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
                                                , DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
                                                , DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
                                                , DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT 
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT  
                                               FROM PSNL0100 AD01, ( 
                                            SELECT 
                                               DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY, (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                               PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
                                               RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
                                               TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
                                               PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
                                               FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
                                               HDOFC_DIV_CD, RETRY_DT 
                                            FROM  PYYT0304 ) AD02 ,
                                                (SELECT NN.DPOB_CD,
                                                        NN.PYYT_YR_MNTH ,
                                                        NN.SYSTEMKEY 
                                                 FROM    
                                                 (  SELECT   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                               PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
                                                                               RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
                                                                               TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
                                                                               PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
                                                                               FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
                                                                               HDOFC_DIV_CD, RETRY_DT 
                                                                            FROM  PYYT0304 
                                                                         WHERE     PYYT_YR_MNTH LIKE #yrtxBlggYr# ||'%'  
                                                             ) NN,
                                                              (  
                                                               SELECT        MM.DPOB_CD,
                                                                             MM.PYYT_YR_MNTH , 
                                                                             MM.SYSTEMKEY ,     MM.SEL_NUM
                                                                 FROM    
                                                                 (  
                                                                SELECT       SEL_NUM,
                                                                             DPOB_CD,
                                                                             PYYT_YR_MNTH , 
                                                                             SYSTEMKEY  
                                                                 FROM 
                                                                  (SELECT  ROW_NUMBER ()
                                                                             OVER (ORDER BY
                                                                                      DPOB_CD,
                                                                                      SYSTEMKEY,
                                                                                      PYYT_YR_MNTH ASC ) AS SEL_NUM,
                                                                             DPOB_CD,
                                                                             PYYT_YR_MNTH , 
                                                                             SYSTEMKEY   
                                                                        FROM PYYT0304   
                                                                           WHERE   PYYT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
                                                                                       AND (SYSTEMKEY,PYYT_YR_MNTH) IN (
                                                                                          SELECT SYSTEMKEY, MAX(PYYT_YR_MNTH)
                                                                                            FROM PYYT0304 NNAA 
                                                                                            WHERE  NNAA.DPOB_CD = PYYT0304.DPOB_CD 
                                                                                              AND NNAA.PYYT_YR_MNTH = PYYT0304.PYYT_YR_MNTH
                                                                                              AND NNAA.SYSTEMKEY = PYYT0304.SYSTEMKEY
                                                                                              AND NNAA.PYYT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
                                                                                              GROUP BY SYSTEMKEY
                   )
                                                                        )
                                                                          ORDER BY  SEL_NUM DESC 
                                                                        ) MM  
                                                                         WHERE ROWNUM = 1 
                                                                           AND DPOB_CD=#dpobCd#
                                                                           AND SYSTEMKEY=#systemkey# 
                                                                         ) GG
                                                        WHERE NN.DPOB_CD = GG.DPOB_CD
                                                          AND NN.SYSTEMKEY = GG.SYSTEMKEY  
                                                          AND NN.PYYT_YR_MNTH = GG.PYYT_YR_MNTH   
                                                                  ) AD03
                                                 WHERE     AD02.DPOB_CD = AD01.DPOB_CD
                                                       AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                       AND AD02.DPOB_CD = AD03.DPOB_CD
                                                       AND AD02.PYYT_YR_MNTH = AD03.PYYT_YR_MNTH
                                                       AND AD02.SYSTEMKEY = AD03.SYSTEMKEY 
                                                  AND AD02.PYYT_YR_MNTH LIKE #yrtxBlggYr# ||'%'  
         ) AA ,  (
         SELECT   AC01.DPOB_CD,AC01.PAY_CD,
                                    AC01.PYYT_YR_MNTH AS PYMT_YR_MNTH ,
                                    AC01.SYSTEMKEY,
                                    AC01.PAYR_MANG_DEPT_CD,
                                    AC01.EMYMT_DIV_CD,
                                    AC01.HAN_NM,
                                    ('') AS PAY_PYMT_DT
                      FROM PYYT0304 AC01
                      WHERE  AC01.SYSTEMKEY=#systemkey# 
                       GROUP BY AC01.DPOB_CD,
                                    AC01.PYYT_YR_MNTH, 
                                    AC01.PAY_CD,
                                    AC01.SYSTEMKEY,
                                    AC01.PAYR_MANG_DEPT_CD,
                                    AC01.EMYMT_DIV_CD,
                                    AC01.HAN_NM 
      ) BB   
            WHERE    BB.DPOB_CD=#dpobCd#  
               AND   BB.SYSTEMKEY=#systemkey# 
                   AND BB.DPOB_CD = AA.DPOB_CD
                   AND  BB.SYSTEMKEY = AA.SYSTEMKEY  
                   AND  BB.PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%' 
                    ]]>  
                   <isEqual prepend="AND" property="addCheck" compareValue="ADD">
                      NOT  EXISTS (SELECT *
                                     FROM (SELECT  KF01.DPOB_CD 
                                                 , KF01.YRTX_BLGG_YR
                                                 , KF01.CLUT_SEPT_CD 
                                                 , KF01.SYSTEMKEY 
                                             FROM YE160401 KF01 ) KK01
                                    WHERE     KK01.DPOB_CD = AA.DPOB_CD
                                          AND KK01.YRTX_BLGG_YR = #yrtxBlggYr#
                                          AND KK01.CLUT_SEPT_CD = #clutSeptCd# 
                                          AND KK01.SYSTEMKEY = AA.SYSTEMKEY)  
                  </isEqual>
                    <![CDATA[
                       GROUP BY                    BB.DPOB_CD 
      ,  BB.PYMT_YR_MNTH 
      ,  BB.SYSTEMKEY  
        )   
         GROUP BY       DPOB_CD 
				      ,  PYMT_YR_MNTH 
				      ,  SYSTEMKEY                                                            
    )
        ]]> 
	</insert>	
	 
	
	
	
	<insert id="infcPkgYe170402_2021_DAO.insertYe160402_S">
		<![CDATA[
			INSERT INTO YE160402 
				( SYSTEMKEY
				  , ELCT_YYMM
				  , DPOB_CD
				  , YRTX_BLGG_YR
				  , CLUT_SEPT_CD
				  , TAXM_SA01_KA
				  , TAXM_SB01_KA
				  , TAXM_SC01_KA
				  , TAXM_SD01_KA
				  , TAXM_SE01_KA
				  , TAXM_SE02_KA
				  , TAXM_SE10_KA
				  , TAXM_SF01_KA
				  , TAXM_SG01_KA
				  , TAXM_SH01_KA
				  , TAXM_SH02_KA
				  , TAXM_SH03_KA
				  , TAXM_SH04_KA
				  , TAXM_SH05_KA
				  , TAXM_SH06_KA
				  , TAXM_SH07_KA
				  , TAXM_SH08_KA
				  , TAXM_SH09_KA
				  , TAXM_SH10_KA
				  , TAXM_SH14_KA
				  , TAXM_SH15_KA
				  , TAXM_SH11_KA
				  , TAXM_SH12_KA
				  , TAXM_SH13_KA
				  , TAXM_SH16_KA
				  , TAXM_SI01_KA
				  , TAXM_SJ01_KA
				  , TAXM_SJ10_KA
				  , TAXM_SK01_KA
				  , TAXM_SL01_KA
				  , TAXM_SM01_KA
				  , TAXM_SM02_KA
				  , TAXM_SM03_KA
				  , TAXM_SN01_KA
				  , TAXM_SO01_KA
				  , TAXM_SP01_KA
				  , TAXM_SP02_KA
				  , TAXM_SQ01_KA
				  , TAXM_SR01_KA
				  , TAXM_SR10_KA
				   , TAXM_SR11_KA
				  , TAXM_SS01_KA
				  , TAXM_SY02_KA
				  , TAXM_SY03_KA
				  , TAXM_SY04_KA
				  , TAXM_SY21_KA
				  , TAXM_SY22_KA
				  , TAXM_ST01_KA
				  , TAXM_ST10_KA
				  , TAXM_ST11_KA
				  , TAXM_ST12_KA
				  , TAXM_ST20_KA
				  , KYBDR
				  , INPT_DT
				  , INPT_ADDR
				  , ISMT
				  , REVN_DT
				  , REVN_ADDR )
			VALUES ( #systemkey#
				  , #elctYymm#
				  , #dpobCd#
				  , #yrtxBlggYr#
				  , #clutSeptCd#
				  , #taxmSa01Ka#
				  , #taxmSb01Ka#
				  , #taxmSc01Ka#
				  , #taxmSd01Ka#
				  , #taxmSe01Ka#
				  , #taxmSe02Ka#
				  , #taxmSe10Ka#
				  , #taxmSf01Ka#
				  , #taxmSg01Ka#
				  , #taxmSh01Ka#
				  , #taxmSh02Ka#
				  , #taxmSh03Ka#
				  , #taxmSh04Ka#
				  , #taxmSh05Ka#
				  , #taxmSh06Ka#
				  , #taxmSh07Ka#
				  , #taxmSh08Ka#
				  , #taxmSh09Ka#
				  , #taxmSh10Ka#
				  , #taxmSh14Ka#
				  , #taxmSh15Ka#
				  , #taxmSh11Ka#
				  , #taxmSh12Ka#
				  , #taxmSh13Ka#
				  , #taxmSh16Ka#
				  , #taxmSi01Ka#
				  , #taxmSj01Ka#
				  , #taxmSj10Ka#
				  , #taxmSk01Ka#
				  , #taxmSl01Ka#
				  , #taxmSm01Ka#
				  , #taxmSm02Ka#
				  , #taxmSm03Ka#
				  , #taxmSn01Ka#
				  , #taxmSo01Ka#
				  , #taxmSp01Ka#
				  , #taxmSp02Ka#
				  , #taxmSq01Ka#
				  , #taxmSr01Ka#
				  , #taxmSr10Ka#
				   , #taxmSr11Ka#
				  , #taxmSs01Ka#
				  , #taxmSy02Ka#
				  , #taxmSy03Ka#
				  , #taxmSy04Ka#
				  , #taxmSy21Ka#
				  , #taxmSy22Ka#
				  , #taxmSt01Ka#
				  , #taxmSt10Ka#
				  , #taxmSt11Ka#
				  , #taxmSt12Ka#
				  , #taxmSt20Ka#
				  , #kybdr#
				  , #inptDt#
				  , #inptAddr#
				  , #ismt#
				  , #revnDt#
				  , #revnAddr# )
		]]>
	</insert>
	
	<update id="infcPkgYe170402_2021_DAO.updateYe160402_S">
		<![CDATA[
			UPDATE YE160402
			SET SYSTEMKEY=#systemkey#
				, ELCT_YYMM=#elctYymm#
				, DPOB_CD=#dpobCd#
				, YRTX_BLGG_YR=#yrtxBlggYr#
				, CLUT_SEPT_CD=#clutSeptCd#
				, TAXM_SA01_KA=#taxmSa01Ka#
				, TAXM_SB01_KA=#taxmSb01Ka#
				, TAXM_SC01_KA=#taxmSc01Ka#
				, TAXM_SD01_KA=#taxmSd01Ka#
				, TAXM_SE01_KA=#taxmSe01Ka#
				, TAXM_SE02_KA=#taxmSe02Ka#
				, TAXM_SE10_KA=#taxmSe10Ka#
				, TAXM_SF01_KA=#taxmSf01Ka#
				, TAXM_SG01_KA=#taxmSg01Ka#
				, TAXM_SH01_KA=#taxmSh01Ka#
				, TAXM_SH02_KA=#taxmSh02Ka#
				, TAXM_SH03_KA=#taxmSh03Ka#
				, TAXM_SH04_KA=#taxmSh04Ka#
				, TAXM_SH05_KA=#taxmSh05Ka#
				, TAXM_SH06_KA=#taxmSh06Ka#
				, TAXM_SH07_KA=#taxmSh07Ka#
				, TAXM_SH08_KA=#taxmSh08Ka#
				, TAXM_SH09_KA=#taxmSh09Ka#
				, TAXM_SH10_KA=#taxmSh10Ka#
				, TAXM_SH14_KA=#taxmSh14Ka#
				, TAXM_SH15_KA=#taxmSh15Ka#
				, TAXM_SH11_KA=#taxmSh11Ka#
				, TAXM_SH12_KA=#taxmSh12Ka#
				, TAXM_SH13_KA=#taxmSh13Ka#
				, TAXM_SH16_KA=#taxmSh16Ka#
				, TAXM_SI01_KA=#taxmSi01Ka#
				, TAXM_SJ01_KA=#taxmSj01Ka#
				, TAXM_SJ10_KA=#taxmSj10Ka#
				, TAXM_SK01_KA=#taxmSk01Ka#
				, TAXM_SL01_KA=#taxmSl01Ka#
				, TAXM_SM01_KA=#taxmSm01Ka#
				, TAXM_SM02_KA=#taxmSm02Ka#
				, TAXM_SM03_KA=#taxmSm03Ka#
				, TAXM_SN01_KA=#taxmSn01Ka#
				, TAXM_SO01_KA=#taxmSo01Ka#
				, TAXM_SP01_KA=#taxmSp01Ka#
				, TAXM_SP02_KA=#taxmSp02Ka#
				, TAXM_SQ01_KA=#taxmSq01Ka#
				, TAXM_SR01_KA=#taxmSr01Ka#
				, TAXM_SR10_KA=#taxmSr10Ka#
				 , TAXM_SR11_KA=#taxmSr11Ka#
				, TAXM_SS01_KA=#taxmSs01Ka#
				, TAXM_SY02_KA=#taxmSy02Ka#
				, TAXM_SY03_KA=#taxmSy03Ka#
				, TAXM_SY04_KA=#taxmSy04Ka#
				, TAXM_SY21_KA=#taxmSy21Ka#
				, TAXM_SY22_KA=#taxmSy22Ka#
				, TAXM_ST01_KA=#taxmSt01Ka#
				, TAXM_ST10_KA=#taxmSt10Ka#
				, TAXM_ST11_KA=#taxmSt11Ka#
				, TAXM_ST12_KA=#taxmSt12Ka#
				, TAXM_ST20_KA=#taxmSt20Ka#
				, KYBDR=#kybdr#
				, INPT_DT=#inptDt#
				, INPT_ADDR=#inptAddr#
				, ISMT=#ismt#
				, REVN_DT=#revnDt#
				, REVN_ADDR=#revnAddr#
						WHERE SYSTEMKEY=#systemkey#
								AND ELCT_YYMM=#elctYymm#
								AND DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
				]]>
	</update>
	
	<delete id="infcPkgYe170402_2021_DAO.deleteYe160402_S">
		<![CDATA[
			DELETE FROM YE160402 
						WHERE SYSTEMKEY=#systemkey#
								AND ELCT_YYMM=#elctYymm#
								AND DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
				]]>
	</delete>
	
	<delete id="infcPkgYe170402_2021_DAO.fnYeta1100_Ye160402_CREATE_Delete">
		<![CDATA[
			DELETE FROM YE160402 
						WHERE SYSTEMKEY=#systemkey#
								AND ELCT_YYMM=#elctYymm#
								AND DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
				]]>
	</delete>
	
	<select id="infcPkgYe170402_2021_DAO.selectYe160402_S" resultMap="infcPkgYe170402_2021">
		<![CDATA[
			SELECT
				SYSTEMKEY
				, ELCT_YYMM
				, DPOB_CD
				, YRTX_BLGG_YR
				, CLUT_SEPT_CD
				, TAXM_SA01_KA
				, TAXM_SB01_KA
				, TAXM_SC01_KA
				, TAXM_SD01_KA
				, TAXM_SE01_KA
				, TAXM_SE02_KA
				, TAXM_SE10_KA
				, TAXM_SF01_KA
				, TAXM_SG01_KA
				, TAXM_SH01_KA
				, TAXM_SH02_KA
				, TAXM_SH03_KA
				, TAXM_SH04_KA
				, TAXM_SH05_KA
				, TAXM_SH06_KA
				, TAXM_SH07_KA
				, TAXM_SH08_KA
				, TAXM_SH09_KA
				, TAXM_SH10_KA
				, TAXM_SH14_KA
				, TAXM_SH15_KA
				, TAXM_SH11_KA
				, TAXM_SH12_KA
				, TAXM_SH13_KA
				, TAXM_SH16_KA
				, TAXM_SI01_KA
				, TAXM_SJ01_KA
				, TAXM_SJ10_KA
				, TAXM_SK01_KA
				, TAXM_SL01_KA
				, TAXM_SM01_KA
				, TAXM_SM02_KA
				, TAXM_SM03_KA
				, TAXM_SN01_KA
				, TAXM_SO01_KA
				, TAXM_SP01_KA
				, TAXM_SP02_KA
				, TAXM_SQ01_KA
				, TAXM_SR01_KA
				, TAXM_SR10_KA
				 , TAXM_SR11_KA
				, TAXM_SS01_KA
				, TAXM_SY02_KA
				, TAXM_SY03_KA
				, TAXM_SY04_KA
				, TAXM_SY21_KA
				, TAXM_SY22_KA
				, TAXM_ST01_KA
				, TAXM_ST10_KA
				, TAXM_ST11_KA
				, TAXM_ST12_KA
				, TAXM_ST20_KA
				, KYBDR
				, INPT_DT
				, INPT_ADDR
				, ISMT
				, REVN_DT
				, REVN_ADDR
			FROM YE160402
						WHERE SYSTEMKEY=#systemkey#
								AND ELCT_YYMM=#elctYymm#
								AND DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
				]]>
	</select>
	
	<select id="infcPkgYe170402_2021_DAO.selectYe160402List_D" parameterClass="infcPkgYe170402Srh_2021_Vo" resultClass="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (
				SELECT
								SYSTEMKEY
								, ELCT_YYMM
								, DPOB_CD
								, YRTX_BLGG_YR
								, CLUT_SEPT_CD
								, TAXM_SA01_KA
								, TAXM_SB01_KA
								, TAXM_SC01_KA
								, TAXM_SD01_KA
								, TAXM_SE01_KA
								, TAXM_SE02_KA
								, TAXM_SE10_KA
								, TAXM_SF01_KA
								, TAXM_SG01_KA
								, TAXM_SH01_KA
								, TAXM_SH02_KA
								, TAXM_SH03_KA
								, TAXM_SH04_KA
								, TAXM_SH05_KA
								, TAXM_SH06_KA
								, TAXM_SH07_KA
								, TAXM_SH08_KA
								, TAXM_SH09_KA
								, TAXM_SH10_KA
								, TAXM_SH14_KA
								, TAXM_SH15_KA
								, TAXM_SH11_KA
								, TAXM_SH12_KA
								, TAXM_SH13_KA
								, TAXM_SH16_KA
								, TAXM_SI01_KA
								, TAXM_SJ01_KA
								, TAXM_SJ10_KA
								, TAXM_SK01_KA
								, TAXM_SL01_KA
								, TAXM_SM01_KA
								, TAXM_SM02_KA
								, TAXM_SM03_KA
								, TAXM_SN01_KA
								, TAXM_SO01_KA
								, TAXM_SP01_KA
								, TAXM_SP02_KA
								, TAXM_SQ01_KA
								, TAXM_SR01_KA
								, TAXM_SR10_KA
								 , TAXM_SR11_KA
								, TAXM_SS01_KA
								, TAXM_SY02_KA
								, TAXM_SY03_KA
								, TAXM_SY04_KA
								, TAXM_SY21_KA
								, TAXM_SY22_KA
								, TAXM_ST01_KA
								, TAXM_ST10_KA
								, TAXM_ST11_KA
								, TAXM_ST12_KA
								, TAXM_ST20_KA
								, KYBDR
								, INPT_DT
								, INPT_ADDR
								, ISMT
								, REVN_DT
								, REVN_ADDR
						FROM YE160402
				WHERE 1=1
				<isEqual prepend="AND" property="searchCondition" compareValue="0">
					SYSTEMKEY = #searchKeyword#
				</isEqual>
				<isEqual prepend="AND" property="searchCondition" compareValue="1">
					ELCT_YYMM LIKE '%' || #searchKeyword# || '%'
				</isEqual>
					ORDER BY 
						SYSTEMKEY DESC
							, ELCT_YYMM DESC
							, DPOB_CD DESC
							, YRTX_BLGG_YR DESC
							, CLUT_SEPT_CD DESC
		
		<![CDATA[					
	) A WHERE ROWNUM <= #lastIndex#
)WHERE RNUM >= #firstIndex#
]]>
	</select>	
	<select id="infcPkgYe170402_2021_DAO.selectYe160402ListTotCnt_S" parameterClass="infcPkgYe170402Srh_2021_Vo" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM YE160402
			WHERE 1=1
			<isEqual prepend="AND" property="searchCondition" compareValue="0">
				SYSTEMKEY = #searchKeyword#
			</isEqual>
			<isEqual prepend="AND" property="searchCondition" compareValue="1">
				ELCT_YYMM LIKE '%' || #searchKeyword# || '%'
			</isEqual>
	</select>

</sqlMap>
