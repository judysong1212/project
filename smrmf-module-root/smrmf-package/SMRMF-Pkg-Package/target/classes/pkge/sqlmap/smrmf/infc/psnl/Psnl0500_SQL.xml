<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="Psnl0500">
	
	<typeAlias alias="hashMap" type="java.util.HashMap"/>
    <typeAlias alias="list" type="java.util.List"/>
    <typeAlias alias="int" type="java.lang.Integer"/>
    <typeAlias alias="string" type="java.lang.String"/>
	<typeAlias alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias alias="infcPsnl0500Dto" type="com.app.exterms.personal.client.dto.InfcPsnl0500DTO"/>
	
	<select id="infcPsnl0500DAO.selectPsnl0500" parameterClass="infcPsnl0500Dto" resultClass="egovMap">
	    
	    SELECT A.DPOB_CD,
		       A.SYSTEMKEY,
		       A.HAN_NM,
		       SUBSTR(A.RESN_REGN_NUM,1,6)||'-'||SUBSTR(A.RESN_REGN_NUM,7,7) as RESN_REGN_NUM,
		       FCBASS0300CDNM (A.DPOB_CD, A.EMYMT_DIV_CD) AS EMYMT_DIV_CD,
		       A.CURR_AFFN_DEPT_CD as DEPT_CD,
		       FCBASS0400CDNM (A.DPOB_CD, A.CURR_AFFN_DEPT_CD, '2') AS DEPT_CD_NM,
		       FCBASS0500CDNM(A.DPOB_CD, SUBSTR(A.EMYMT_BGNN_DT,1,4), CURR_AFFN_DEPT_CD, BUSIN_CD) as BUSIN_CD,
		       FCBASS0300CDNM (A.DPOB_CD, A.HDOFC_CODTN_CD) AS HDOFC_CODTN_CD,
		       A.TYP_OCCU_CD,
		       FCBASS0300CDNM (A.DPOB_CD, A.TYP_OCCU_CD) AS TYP_OCCU_CD_NM,
		       fcBass0350CDNM(A.DPOB_CD, A.TYP_OCCU_CD,A.DTIL_OCCU_CLS_DIV_CD,'1') AS DTIL_OCCU_CLS_DIV_CD
		  FROM PSNL0100 A
		 WHERE 1=1
		   
	    <isNotNull property="hanNm">
		     <isNotEmpty property="hanNm">
		         AND A.HAN_NM = #hanNm#  
		     </isNotEmpty>
		 </isNotNull>
		 <isNotNull property="resnRegnNum">
		     <isNotEmpty property="resnRegnNum">
		         AND A.RESN_REGN_NUM = REPLACE(#resnRegnNum#,'-','')  
		     </isNotEmpty>
		 </isNotNull>
		 <isNotNull property="emymtDivCd">
		     <isNotEmpty property="emymtDivCd">
		         AND A.EMYMT_DIV_CD = #emymtDivCd#  
		     </isNotEmpty>
		 </isNotNull>
		 <isNotNull property="hdofcCodtnCd">
		     <isNotEmpty property="hdofcCodtnCd">
		         AND A.HDOFC_CODTN_CD = #hdofcCodtnCd#  
		     </isNotEmpty>
		 </isNotNull>
		 <isNotNull property="deptCd">
		     <isNotEmpty property="deptCd">
		         AND A.DEPT_CD = #deptCd#  
		     </isNotEmpty>
		 </isNotNull>
		 <isNotNull property="currAffnDeptCd">
		     <isNotEmpty property="currAffnDeptCd">
		         AND A.CURR_AFFN_DEPT_CD = #currAffnDeptCd#  
		     </isNotEmpty>
		 </isNotNull>
		 <isNotNull property="businCd">
		     <isNotEmpty property="businCd">
		         AND A.BUSIN_CD = #businCd#  
		     </isNotEmpty>
		 </isNotNull>
		 ORDER BY A.CURR_AFFN_DEPT_CD, A.HDOFC_CODTN_CD, A.HAN_NM
	</select>
	
	<insert id="infcPsnl0500DAO.insertPsnl0560" parameterClass="infcPsnl0500Dto">
	    INSERT INTO PSNL0560 (DPOB_CD,
                      PSPT_ISS_NUM,
                      SYSTEMKEY,
                      DEPT_CD,
                      TYP_OCCU_CD,
                      PSPT_ISS_DT,
                      PSPT_ISS_EMP_NUM,
                      KYBDR,
                      INPT_DT,
                      INPT_ADDR,
                      ISMT,
                      REVN_DT,
                      REVN_ADDR)
     VALUES (#dpobCd#,
             #psptIssNum#,
             #systemkey#,
             #deptCd#,
             #typOccuCd#,
             TO_CHAR(SYSDATE,'YYYYMMDD'),
             #psptIssEmpNum#,
             #ismt#,
           TO_CHAR(SYSDATE,'YYYYMMDDHHMISS'),
             #revnAddr#,
             #ismt#,
             TO_CHAR(SYSDATE,'YYYYMMDDHHMISS'),
             #revnAddr#)
	    
    </insert>
	
	<select id="infcPsnl0500DAO.getPsptIssNum" resultClass="string">
		SELECT COUNT(*)+1 FROM PSNL0560
	</select>
	
	
	
</sqlMap>
