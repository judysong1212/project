<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<!-- <!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd"> -->

<sqlMap namespace="InfcPkgYeta17Tax_2022">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>  
	<typeAlias  alias="yeta17TaxYe161010_2022" type="com.app.smrmf.infc.yearendtax.server.vo.yeta2022.InfcPkgYe161010_2022_VO"/>
	<typeAlias  alias="yeta17TaxYe161020_2022" type="com.app.smrmf.infc.yearendtax.server.vo.yeta2022.InfcPkgYe161020_2022_VO"/>
	<typeAlias  alias="yeta17TaxYe161055_2022" type="com.app.smrmf.infc.yearendtax.server.vo.yeta2022.InfcPkgYe161055_2022_VO"/>
	<typeAlias  alias="yeta17TaxYe161050_2022" type="com.app.smrmf.infc.yearendtax.server.vo.yeta2022.InfcPkgYe161050_2022_VO"/>
	<typeAlias  alias="yeta17TaxYe169010_2022" type="com.app.smrmf.infc.yearendtax.server.vo.yeta2022.InfcPkgYe169010_2022_VO"/>
	<typeAlias  alias="yeta17TaxYe165030Srh_2022_Vo" type="com.app.smrmf.infc.yearendtax.server.vo.yeta2022.InfcPkgYe165030Srh_2022_VO"/> 
	<typeAlias  alias="yeta17TaxYe169010Srh_2022" type="com.app.smrmf.infc.yearendtax.server.vo.yeta2022.InfcPkgYe169010Srh_2022_VO"/>
	 
     <!-- 의료비/교육비/기부금저일 쿼리 저장등 처리 완료후 재 정비   삭제 -->
	  <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_TaxPkg01_2022_Update">
		<![CDATA[
		UPDATE YE161070 AA
			SET SBC_SVNG_USE_AMT	= NVL((SELECT SUM(NVL(HSNG_PRPT_SVNG_PYM_AMT,0))
			 								FROM	 YE162030 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											 	AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
												AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
												AND BB.SYSTEMKEY=AA.SYSTEMKEY 
												AND BB.HSNG_PRPT_SVNG_SVNG_CL = 'Y0040050'
			  							  ),0)   /* 주택마련저축_청약저축납입금액  */
			,HSNG_SVNG_USE_AMT	= NVL((SELECT SUM(NVL(HSNG_PRPT_SVNG_PYM_AMT,0))
			 								FROM	 YE162030 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											 	AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
												AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
												AND BB.SYSTEMKEY=AA.SYSTEMKEY 
												AND BB.HSNG_PRPT_SVNG_SVNG_CL = 'Y0040060'
			  							  ),0)  /* 주택마련저축_근로자주택마련저축납입금액  */
			,LBRR_PRPT_SVNG_USE_AMT	= NVL((SELECT SUM(NVL(HSNG_PRPT_SVNG_PYM_AMT,0))
			 								FROM	 YE162030 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											 	AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
												AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
												AND BB.SYSTEMKEY=AA.SYSTEMKEY 
												AND BB.HSNG_PRPT_SVNG_SVNG_CL = 'Y0040080'
			  							  ),0)    /* 주택마련저축_주택청약종합저축납입금액  */
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				 , REVN_ADDR=#inptAddr#
				WHERE DPOB_CD=#dpobCd#
						AND YRTX_BLGG_YR=#yrtxBlggYr#
						AND CLUT_SEPT_CD=#clutSeptCd#
						AND SYSTEMKEY=#systemkey# 
						
				]]>
	</update> 
	
	  
	  <!-- 의료비정리 합계  -->
	<update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_B101Y_YE161080_2022_Update">
		<![CDATA[ 
			UPDATE YE161080 AA
			   SET   MDXPS_SFT_SPRCD_USE_AMT  =  NVL( (SELECT SUM(NVL(USE_AMT,0))
			 												FROM	YE161030 CC, YE164010 BB
							 							     WHERE CC.DPOB_CD=BB.DPOB_CD
														 	AND CC.YRTX_BLGG_YR=BB.YRTX_BLGG_YR
															AND CC.CLUT_SEPT_CD=BB.CLUT_SEPT_CD
															AND CC.SYSTEMKEY=BB.SYSTEMKEY 
															AND CC.TXPR_DSCM_NO_CNTN =  BB.RESNO_ENC_CNTN
															AND BB.DPOB_CD=AA.DPOB_CD
														 	AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
															AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
															AND BB.SYSTEMKEY=AA.SYSTEMKEY  
															AND BB.YN2 = '1' AND BB.YN4 <> '1'
							  							) ,0)	/* 의료비_난임시술비납입금액 */ 
					,MDXPS_PRS_USE_AMT = NVL((SELECT SUM(NVL(USE_AMT,0))
			 								FROM YE161030 CC, YE164010 BB
			 							   WHERE CC.DPOB_CD=BB.DPOB_CD
										 	AND CC.YRTX_BLGG_YR=BB.YRTX_BLGG_YR
											AND CC.CLUT_SEPT_CD=BB.CLUT_SEPT_CD
											AND CC.SYSTEMKEY=BB.SYSTEMKEY 
											AND CC.TXPR_DSCM_NO_CNTN =  BB.RESNO_ENC_CNTN
											AND ((CC.DSBR_DDC_CL_CD = '1')
											     OR (CC.FAMY_RELA_DIV_CD = 'A0190001')
											     OR ( (CASE WHEN (CASE WHEN (SUBSTR(CC.TXPR_DSCM_NO_CNTN,7,1)) IN ('3','4') THEN '20' || SUBSTR(CC.TXPR_DSCM_NO_CNTN,1,6)   
				                                    ELSE '19' ||  SUBSTR(CC.TXPR_DSCM_NO_CNTN,1,6) END) <= '19571231'     
				                                THEN '1'  ELSE '0' END) = '1' ))
			 							    AND BB.DPOB_CD=AA.DPOB_CD
										 	AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY 
										    AND BB.YN2 <> '1' AND BB.YN3 <> '1'
			  							),0)
			  							+	NVL((SELECT SUM(LEAST(2000000,NVL(USE_AMT,0)))
			 								FROM YE161030 CC, YE164010 BB, YE169010 DD
			 							   WHERE CC.DPOB_CD=BB.DPOB_CD
										 	AND CC.YRTX_BLGG_YR=BB.YRTX_BLGG_YR
											AND CC.CLUT_SEPT_CD=BB.CLUT_SEPT_CD
											AND CC.SYSTEMKEY=BB.SYSTEMKEY 
											AND CC.TXPR_DSCM_NO_CNTN =  BB.RESNO_ENC_CNTN
											AND ((CC.DSBR_DDC_CL_CD = '1')
											     OR (CC.FAMY_RELA_DIV_CD = 'A0190001')
											     OR ( (CASE WHEN (CASE WHEN (SUBSTR(CC.TXPR_DSCM_NO_CNTN,7,1)) IN ('3','4') THEN '20' || SUBSTR(CC.TXPR_DSCM_NO_CNTN,1,6)   
				                                    ELSE '19' ||  SUBSTR(CC.TXPR_DSCM_NO_CNTN,1,6) END) <= '19571231'     
				                                THEN '1'  ELSE '0' END) = '1' ))
			 							    AND BB.DPOB_CD=AA.DPOB_CD
										 	AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY
											AND AA.DPOB_CD = DD.DPOB_CD
											AND AA.YRTX_BLGG_YR = DD.YRTX_BLGG_YR
											AND AA.CLUT_SEPT_CD = DD.CLUT_SEPT_CD
											AND AA.SYSTEMKEY=DD.SYSTEMKEY 
										    AND BB.YN3 = '1' AND BB.YN2 <> '1' AND BB.YN4 <> '1'),0)
			  						/* 의료비_본인65세이상장애인납입금액 산후조리원비용추가 */
					,MDXPS_OTH_USE_AMT	= NVL((SELECT SUM(NVL(USE_AMT,0))
			 								FROM YE161030 CC, YE164010 BB
			 							   WHERE CC.DPOB_CD=BB.DPOB_CD
										 	AND CC.YRTX_BLGG_YR=BB.YRTX_BLGG_YR
											AND CC.CLUT_SEPT_CD=BB.CLUT_SEPT_CD
											AND CC.SYSTEMKEY=BB.SYSTEMKEY 
											AND CC.TXPR_DSCM_NO_CNTN =  BB.RESNO_ENC_CNTN
											AND ( CC.DPOB_CD
											    , CC.YRTX_BLGG_YR
											    , CC.CLUT_SEPT_CD
											    , CC.SYSTEMKEY
											    , CC.TXPR_DSCM_NO_CNTN) NOT IN  (SELECT DD.DPOB_CD
																  , DD.YRTX_BLGG_YR
																  , DD.CLUT_SEPT_CD
																  , DD.SYSTEMKEY
																  , DD.TXPR_DSCM_NO_CNTN
																 FROM YE161030 DD
																 WHERE  ((DD.DSBR_DDC_CL_CD = '1')
																     OR (DD.FAMY_RELA_DIV_CD = 'A0190001')
																     OR ( (CASE WHEN (CASE WHEN (SUBSTR(DD.TXPR_DSCM_NO_CNTN,7,1)) IN ('3','4') THEN '20' || SUBSTR(DD.TXPR_DSCM_NO_CNTN,1,6)   
									                                    ELSE '19' ||  SUBSTR(DD.TXPR_DSCM_NO_CNTN,1,6) END) <= '19571231'     
									                                THEN '1'  ELSE '0' END) = '1' ))) 
			 							    AND BB.DPOB_CD=AA.DPOB_CD
										 	AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY 
										    AND BB.YN2 <> '1'  AND BB.YN3 <> '1'
			  							),0)
			  							+	NVL((SELECT SUM(LEAST(2000000,NVL(USE_AMT,0)))
			 								FROM YE161030 CC, YE164010 BB, YE169010 DD
			 							   WHERE CC.DPOB_CD=BB.DPOB_CD
										 	AND CC.YRTX_BLGG_YR=BB.YRTX_BLGG_YR
											AND CC.CLUT_SEPT_CD=BB.CLUT_SEPT_CD
											AND CC.SYSTEMKEY=BB.SYSTEMKEY 
											AND CC.TXPR_DSCM_NO_CNTN =  BB.RESNO_ENC_CNTN
											AND ( CC.DPOB_CD
											    , CC.YRTX_BLGG_YR
											    , CC.CLUT_SEPT_CD
											    , CC.SYSTEMKEY
											    , CC.TXPR_DSCM_NO_CNTN) NOT IN  (SELECT DD.DPOB_CD
																  , DD.YRTX_BLGG_YR
																  , DD.CLUT_SEPT_CD
																  , DD.SYSTEMKEY
																  , DD.TXPR_DSCM_NO_CNTN
																 FROM YE161030 DD
																 WHERE  ((DD.DSBR_DDC_CL_CD = '1')
																     OR (DD.FAMY_RELA_DIV_CD = 'A0190001')
																     OR ( (CASE WHEN (CASE WHEN (SUBSTR(DD.TXPR_DSCM_NO_CNTN,7,1)) IN ('3','4') THEN '20' || SUBSTR(DD.TXPR_DSCM_NO_CNTN,1,6)   
									                                    ELSE '19' ||  SUBSTR(DD.TXPR_DSCM_NO_CNTN,1,6) END) <= '19571231'     
									                                THEN '1'  ELSE '0' END) = '1' ))) 
			 							    AND BB.DPOB_CD=AA.DPOB_CD
										 	AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY
											AND AA.DPOB_CD = DD.DPOB_CD
											AND AA.YRTX_BLGG_YR = DD.YRTX_BLGG_YR
											AND AA.CLUT_SEPT_CD = DD.CLUT_SEPT_CD 
											AND AA.SYSTEMKEY=DD.SYSTEMKEY
										    AND BB.YN3 = '1' AND BB.YN2 <> '1' AND BB.YN4 <> '1' 
			  							),0)
			  							/* 의료비_그밖의공제대상자납입금액  산후조리원비용추가*/
			  	, MDXPS_LS_INSR_TR_AMT = NVL( (SELECT SUM(NVL(USE_AMT,0))
			 												FROM	YE161030 CC, YE164010 BB
							 							     WHERE CC.DPOB_CD=BB.DPOB_CD
														 	AND CC.YRTX_BLGG_YR=BB.YRTX_BLGG_YR
															AND CC.CLUT_SEPT_CD=BB.CLUT_SEPT_CD
															AND CC.SYSTEMKEY=BB.SYSTEMKEY 
															AND CC.TXPR_DSCM_NO_CNTN =  BB.RESNO_ENC_CNTN
															AND BB.DPOB_CD=AA.DPOB_CD
														 	AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
															AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
															AND BB.SYSTEMKEY=AA.SYSTEMKEY  
															AND BB.YN4 = '1' 
							  							) ,0)	/* 의료비_실손보험금보전금액 */ 
 
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr# 
				 WHERE DPOB_CD=#dpobCd#
					AND YRTX_BLGG_YR=#yrtxBlggYr#
					AND CLUT_SEPT_CD=#clutSeptCd#
					AND SYSTEMKEY=#systemkey# 
				]]>
	</update>
	 
	<!-- 합계금액계 -->
		<update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_All_YE161080_2022_Update">
		<![CDATA[
				UPDATE YE161080 
			SET  PNSN_ACC_USE_AMT_SUM = 	(SCTC_HP_USE_AMT + RTPN_USE_AMT + PNSN_SVNG_USE_AMT)	/*  연금계좌납입금액합계  */
				,ISA_USE_AMT_SUM = (RTPN_ISA_USE_AMT + PNSN_SVNG_ISA_USE_AMT)	/* ISA연금계좌납입금액합계 */
				,INFEE_PYM_USE_AMT_SUM = (CVRG_INSC_USE_AMT + DSBR_EU_CVRG_USE_AMT)		/*  보험료납입금액합계			 */
				,MDXPS_USE_AMT_SUM =(MDXPS_SFT_SPRCD_USE_AMT + MDXPS_PRS_USE_AMT + MDXPS_OTH_USE_AMT) /*+ MDXPS_LS_INSR_TR_AMT)*/	/*  의료비납입금액합계  */
				,SCXPS_USE_AMT_SUM =(SCXPS_PRS_USE_AMT + SCXPS_KID_USE_AMT + SCXPS_STD_USE_AMT + SCXPS_UND_USE_AMT + SCXPS_DSBR_USE_AMT)		/*  교육비납입금액합계  */
				,CONB_USE_AMT_SUM = (CONB10TTSW_LT_USE_AMT + CONB10EXCS_LT_USE_AMT + CONB_LGL_USE_AMT + CONB_EMST_ASCT_USE_AMT + CONB_RELI_ORG_OTH_USE_AMT + CONB_RELI_ORG_USE_AMT) /*  기부금납입금액합계  */
				,MMR_USE_AMT = NVL( (SELECT SUM(NVL(MNTH_RNTTY_YRLY_MNTH_SUM,0))
			 												FROM  YE162510 BB
							 							   WHERE BB.DPOB_CD=YE161080.DPOB_CD
														 	AND BB.YRTX_BLGG_YR=YE161080.YRTX_BLGG_YR
															AND BB.CLUT_SEPT_CD=YE161080.CLUT_SEPT_CD
															AND BB.SYSTEMKEY=YE161080.SYSTEMKEY  
							  							) ,0)		  		
						WHERE DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
								AND SYSTEMKEY=#systemkey#
				 
				]]>
	</update>
	
	
	  <!--  인원수 산정 하기  -->
	  <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE161020_Tax_2022_01_Update">
		<![CDATA[ 
	    UPDATE YE161020 AC01                                                                                                               
           /* 기본공제_배우자수   AND AD01.FAMY_RELA_DIV_CD IN ('A0190002','A0190007') */                                                                                       
          SET BASE_WIYN = NVL((SELECT DECODE(NVL(COUNT(AD01.TXPR_DSCM_NO_CNTN), 0), 0, 0, 1)                                      
                             FROM (SELECT * FROM YE161030 
                                           WHERE BSC_DDC_CL_CD = '1' 
                                             AND SUPT_FMLY_RLT_CL_CD IN ('Y0120003')) AD01                       
                            WHERE AD01.SYSTEMKEY(+) = AC01.SYSTEMKEY                                                   
                              AND AD01.YRTX_BLGG_YR(+) = AC01.YRTX_BLGG_YR                                                   
                              AND AD01.CLUT_SEPT_CD(+) = AC01.CLUT_SEPT_CD  
                              AND AD01.DPOB_CD(+) = AC01.DPOB_CD                                                           
                          ),0),                                                                                              
          /*     기본공제_부양가족수  */                                                                                         
              BSC_DDCN_FP_CNT = NVL((SELECT COUNT(AD01.TXPR_DSCM_NO_CNTN)                                                         
                             FROM (SELECT * FROM YE161030 WHERE BSC_DDC_CL_CD = '1' 
                                                            AND SUPT_FMLY_RLT_CL_CD NOT IN ('Y0120003','Y0120000')) AD01                              
                            WHERE AD01.SYSTEMKEY(+) = AC01.SYSTEMKEY                                                   
                              AND AD01.YRTX_BLGG_YR(+) = AC01.YRTX_BLGG_YR                                                   
                              AND AD01.CLUT_SEPT_CD(+) = AC01.CLUT_SEPT_CD  
                               AND AD01.DPOB_CD(+)    = AC01.DPOB_CD                                                      
                          ),0),                                                                                              
          /*  추가공제_장애인수    */                                                                                         
              DSBR_NFP_CNT = NVL((SELECT COUNT(AD01.TXPR_DSCM_NO_CNTN)                                                               
                             FROM (SELECT * FROM YE161030 
                                           WHERE NVL(DSBR_DDC_CL_CD,'T') IN ('1','2','3')) AD01                              
                            WHERE AD01.SYSTEMKEY(+) = AC01.SYSTEMKEY                                                   
                              AND AD01.YRTX_BLGG_YR(+) = AC01.YRTX_BLGG_YR                                                   
                              AND AD01.CLUT_SEPT_CD(+) = AC01.CLUT_SEPT_CD  
                               AND AD01.DPOB_CD(+) = AC01.DPOB_CD                                                         
                          ),0),                                                                                              
                  /* 추가공제_경로우대_70세이상수  */                                                                                
              SCC_NFP_CNT = NVL((SELECT COUNT(AD01.TXPR_DSCM_NO_CNTN)                                                               
                             FROM (SELECT * FROM YE161030 
                                           WHERE SCC_DDC_CL_CD = '1') AD01                              
                            WHERE AD01.SYSTEMKEY(+) = AC01.SYSTEMKEY                                                   
                              AND AD01.YRTX_BLGG_YR(+) = AC01.YRTX_BLGG_YR                                                   
                              AND AD01.CLUT_SEPT_CD(+) = AC01.CLUT_SEPT_CD  
                               AND AD01.DPOB_CD(+) = AC01.DPOB_CD                                                          
                          ),0),                                                                                              
          /*   추가공제_부녀자수   */                                                                                          
              WMN_NFP_CNT = NVL((SELECT COUNT(AD01.TXPR_DSCM_NO_CNTN)                                                               
                             FROM (SELECT * FROM YE161030 WHERE WMN_DDC_CL_CD = '1') AD01                              
                            WHERE AD01.SYSTEMKEY(+) = AC01.SYSTEMKEY                                                   
                              AND AD01.YRTX_BLGG_YR(+) = AC01.YRTX_BLGG_YR                                                   
                              AND AD01.CLUT_SEPT_CD(+) = AC01.CLUT_SEPT_CD  
                               AND AD01.DPOB_CD(+) = AC01.DPOB_CD                                                         
                          ),0),                                                                                              
                 /* 추가공제_자녀양육비양육수    */                                                                        
              AGE6LT_NFP_CNT = NVL((SELECT COUNT(AD01.TXPR_DSCM_NO_CNTN)                                                               
                             FROM (SELECT * FROM YE161030 WHERE AGE6_LT = '1') AD01                              
                            WHERE AD01.SYSTEMKEY(+) = AC01.SYSTEMKEY                                                   
                              AND AD01.YRTX_BLGG_YR(+) = AC01.YRTX_BLGG_YR                                                   
                              AND AD01.CLUT_SEPT_CD(+) = AC01.CLUT_SEPT_CD  
                               AND AD01.DPOB_CD(+) = AC01.DPOB_CD                                                         
                          ),0),                                                                                              
                 /* 추가공제_출산자녀양육수 */                                                                               
              CHBT_ADOP_NFP_CNT = NVL((SELECT COUNT(AD01.TXPR_DSCM_NO_CNTN)                                                               
                             FROM (SELECT * FROM YE161030 WHERE CHBT_ATPR_DDC_CL_CD IN ('1','2','3')) AD01                              
                            WHERE AD01.SYSTEMKEY(+) = AC01.SYSTEMKEY                                                   
                              AND AD01.YRTX_BLGG_YR(+) = AC01.YRTX_BLGG_YR                                                   
                              AND AD01.CLUT_SEPT_CD(+) = AC01.CLUT_SEPT_CD   
                               AND AD01.DPOB_CD(+) = AC01.DPOB_CD                                                          
                          ),0),                                                                                              

                /*  추가공제_한부모수   */                                                                              
              SNPRNT_NFP_CNT = NVL((SELECT COUNT(AD01.TXPR_DSCM_NO_CNTN)                                                               
                             FROM (SELECT * FROM YE161030 WHERE SNPRNT_FMLY_DDC_CL_CD = '1') AD01                              
                            WHERE AD01.SYSTEMKEY(+) = AC01.SYSTEMKEY                                                   
                              AND AD01.YRTX_BLGG_YR(+) = AC01.YRTX_BLGG_YR                                                   
                              AND AD01.CLUT_SEPT_CD(+) = AC01.CLUT_SEPT_CD   
                               AND AD01.DPOB_CD(+) = AC01.DPOB_CD                                                         
                          ),0),                                                                                              

          /*  추가공제_자녀세액공제 2021귀속    */                                                                                    
              CHILD = NVL((SELECT   COUNT(AD01.TXPR_DSCM_NO_CNTN)                                                                  
                             FROM (SELECT * FROM YE161030 WHERE BSC_DDC_CL_CD = '1' 
                                                            AND SUPT_FMLY_RLT_CL_CD IN ('Y0120004','Y0120008')
                                                            AND ((((CASE WHEN (SUBSTR(TXPR_DSCM_NO_CNTN,7,1)) IN ('3','4') 
                                                            			THEN '20' || SUBSTR(TXPR_DSCM_NO_CNTN,1,6)   
				                                    					ELSE '19' ||  SUBSTR(TXPR_DSCM_NO_CNTN,1,6) END) <= 20151231)
																  AND 
																  ((CASE WHEN (SUBSTR(TXPR_DSCM_NO_CNTN,7,1)) IN ('3','4') 
                                                            			THEN '20' || SUBSTR(TXPR_DSCM_NO_CNTN,1,6)   
				                                    					ELSE '19' ||  SUBSTR(TXPR_DSCM_NO_CNTN,1,6) END) >= 20020101)
																  )
                                                            	)
                                   ) AD01                    
                            WHERE AD01.SYSTEMKEY(+) = AC01.SYSTEMKEY                                                   
                              AND AD01.YRTX_BLGG_YR(+) = AC01.YRTX_BLGG_YR                                                   
                              AND AD01.CLUT_SEPT_CD(+) = AC01.CLUT_SEPT_CD  
                               AND AD01.DPOB_CD(+) = AC01.DPOB_CD                                                          
                          ),0)                                                                                                                                    
	            , ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#                                                                                    
             	 WHERE DPOB_CD=#dpobCd#
					AND YRTX_BLGG_YR=#yrtxBlggYr#
					AND CLUT_SEPT_CD=#clutSeptCd#
					AND SYSTEMKEY=#systemkey#
			 
				]]>
	</update> 
	
	<!--  
	ELSE '19' ||  SUBSTR(TXPR_DSCM_NO_CNTN,1,6) END) >= 20020101)
																  )
                                                            	) 다음구문 2022연말정산_추가 : 자녀세액공제대상인원수에서  취학전아동도 해당되는 조건 제외
	
	
	OR
                                                            	 (((CASE WHEN (SUBSTR(TXPR_DSCM_NO_CNTN,7,1)) IN ('3','4') 
                                                            			THEN '20' || SUBSTR(TXPR_DSCM_NO_CNTN,1,6)   
				                                    					ELSE '19' ||  SUBSTR(TXPR_DSCM_NO_CNTN,1,6) END) > 20141231) 
																  AND SCHOOL_YN = '1')
	-->
	
	  <!-- 국민연금 금액 산정하기  --> 
	 	<update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE161055_Tax_2022_02_Update">
		<![CDATA[
			UPDATE YE161055 AC01
			SET         /*  종근무지_국민연금관련   */                                                                                   
			          ( NAT_PENN_PRMM_SUM,
					        NAT_PENN_ARA_PRMM_SUM,
					        NAT_PENN_DDUC_SUM,
					        PUOFER_ANTY,
					        PUOFER_ANTY_DDUC_SUM,
					        MLTYM_ANTY,
					        MLTYM_ANTY_DDUC_SUM,
					        PRTAFIR_SCHL_FALYMM_ANTY,
					        PRTAFIR_SCHL_DDUC_SUM,
					        SPILDTN_PSTOFIC_ANTY,
					        SPILDTN_PSTOFIC_DDUC_SUM) =
					          (  SELECT SUM (NVL(AD01.NAT_PENN_PRMM_SUM, 0)),
					                    SUM (NVL(AD01.NAT_PENN_ARA_PRMM_SUM, 0)),
					                    (  SUM (NVL(AD01.NAT_PENN_PRMM_SUM, 0))
					                     + SUM (NVL(AD01.NAT_PENN_ARA_PRMM_SUM, 0))),
					                    SUM (NVL(AD01.PUOFER_ANTY, 0)),
					                    SUM (NVL(AD01.PUOFER_ANTY, 0)),
					                    SUM (NVL(AD01.MLTYM_ANTY, 0)),
					                    SUM (NVL(AD01.MLTYM_ANTY, 0)),
					                    SUM (NVL(AD01.PRTAFIR_SCHL_FALYMM_ANTY, 0)),
					                    SUM (NVL(AD01.PRTAFIR_SCHL_FALYMM_ANTY, 0)),
					                    SUM (NVL(AD01.SPILDTN_PSTOFIC_ANTY, 0)),
					                    SUM (NVL(AD01.SPILDTN_PSTOFIC_ANTY, 0))
					               FROM (SELECT NC01.DPOB_CD,
					                            NC01.YRTX_BLGG_YR,
					                            NC01.CLUT_SEPT_CD,
					                            NC01.SYSTEMKEY,
					                            NC02.WHDG_DEBR_BUSOPR_RGSTNUM,
					                            NC02.NAT_PENN_PRMM_SUM,
					                            NC02.NAT_PENN_DDUC_SUM,
					                            NC02.NAT_PENN_ARA_PRMM_SUM, 
					                            NC02.PUOFER_ANTY,
					                            NC02.PUOFER_ANTY_DDUC_SUM,
					                            NC02.MLTYM_ANTY,
					                            NC02.MLTYM_ANTY_DDUC_SUM,
					                            NC02.PRTAFIR_SCHL_FALYMM_ANTY,
					                            NC02.PRTAFIR_SCHL_DDUC_SUM,
					                            NC02.SPILDTN_PSTOFIC_ANTY,
					                            NC02.SPILDTN_PSTOFIC_DDUC_SUM
					                       FROM YE160404 NC01, YE160406 NC02
					                      WHERE     NC01.WHDG_DEBR_BUSOPR_RGSTNUM =
					                                   NC02.WHDG_DEBR_BUSOPR_RGSTNUM
					                            AND NC01.YRTX_BLGG_YR = NC02.YRTX_BLGG_YR
					                            AND NC01.CLUT_SEPT_CD = NC02.CLUT_SEPT_CD
					                            AND NC01.SYSTEMKEY = NC02.SYSTEMKEY
					                            AND NC01.DPOB_CD = NC02.DPOB_CD
					                            AND NC01.PRCSP_PRCS_YN = '1'
					                            AND NC01.PRCSP_WHDG_REIP_SUMT_YN = '1') AD01
					              WHERE     AD01.SYSTEMKEY(+) = AC01.SYSTEMKEY
					                    AND AD01.YRTX_BLGG_YR(+) = AC01.YRTX_BLGG_YR
					                    AND AD01.CLUT_SEPT_CD(+) = AC01.CLUT_SEPT_CD
					                    AND AD01.DPOB_CD(+) = AC01.DPOB_CD                                             
								        GROUP BY AC01.SYSTEMKEY                                                                       
								                          )  
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
						WHERE DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
								AND SYSTEMKEY=#systemkey# 
								AND PICL_EMPL_DIV_CD = 'Y0130002'    
				]]>
	</update> 
	  
	 <!-- 국민연금 합계산정  --> 
	 	<update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE161050_Tax_2022_03_Update">
		<![CDATA[
		  UPDATE YE161050 AA 
			  SET NP_HTHR_WA_INFEE_AMT	= NVL((SELECT SUM(NVL(NAT_PENN_PRMM_SUM,0))  
			 								FROM	 YE161055 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY  
											AND BB.PICL_EMPL_DIV_CD='Y0130002'    /* 종근무지 */ 
			  							  ),0)  	/* 국민연금보험료_종근무지보험료금액           */ 
			  							  
					,NP_HTHR_WA_INFEE_DDC_AMT = NVL((SELECT  SUM(NVL(NAT_PENN_PRMM_SUM,0))  
			 								FROM	 YE161055 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY  
											AND BB.PICL_EMPL_DIV_CD='Y0130002'    /* 종근무지 */ 
			  							  ),0)  	/* 국민연금보험료_종근무지보험료공제액	     */
			  							  
					,NP_HTHR_MCUR_WKAR_INFEE_AMT= NVL((SELECT SUM(NVL(NAT_PENN_PRMM_SUM,0))  
			 								FROM	 YE161055 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY  
											AND BB.PICL_EMPL_DIV_CD='Y0130001'    /* 주근무지 */ 
			  							  ),0)  	/* 국민연금보험료_주근무지보험료금액	     */
			  							  
					,NP_HTHR_MCUR_WKAR_DDC_AMT= NVL((SELECT SUM(NVL(NAT_PENN_PRMM_SUM,0)) 
			 								FROM	 YE161055 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY  
											AND BB.PICL_EMPL_DIV_CD='Y0130001'    /* 주근무지 */ 
			  							  ),0)  	/* 국민연금보험료_주근무지보험료공제액	     */
			  							  
					,NP_HTHR_AREA_INFEE_AMT= NVL((SELECT SUM(NVL(NAT_PENN_ARA_PRMM_SUM,0))
			 								FROM	 YE161055 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY  
											AND BB.PICL_EMPL_DIV_CD IN ('Y0130001','Y0130002')    /* 주근무지 종근무지*/ 
			  							  ),0)  		/* 국민연금보험료_지역보험료금액		      */
			  							  
					,NP_HTHR_AREA_DDC_AMT= NVL((SELECT SUM(NVL(NAT_PENN_ARA_PRMM_SUM,0))
			 								FROM	 YE161055 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY  
											AND BB.PICL_EMPL_DIV_CD IN ('Y0130001','Y0130002')    /* 주근무지 종근무지 */ 
			  							  ),0)  		/* 국민연금보험료-지역보험료공제액	     */
			  							  
					,HTHR_PBLC_PNSN_INFEE_AMT= NVL((SELECT SUM(NVL(PUOFER_ANTY,0)) + SUM(NVL(MLTYM_ANTY,0)) + SUM(NVL(PRTAFIR_SCHL_FALYMM_ANTY,0)) + SUM(NVL(SPILDTN_PSTOFIC_ANTY,0))
			 								FROM	 YE161055 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY  
											AND BB.PICL_EMPL_DIV_CD='Y0130002'    /* 종근무지 */ 
			  							  ),0)  	/* 국민연금보험료외_공적연금종근무지보험료금액    */
			  							  
					,HTHR_PBLC_PNSN_INFEE_DDC_AMT= NVL((SELECT SUM(NVL(PUOFER_ANTY_DDUC_SUM,0)) + SUM(NVL(MLTYM_ANTY_DDUC_SUM,0)) + SUM(NVL(PRTAFIR_SCHL_DDUC_SUM,0)) + SUM(NVL(SPILDTN_PSTOFIC_DDUC_SUM,0))
			 								FROM	 YE161055 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY  
											AND BB.PICL_EMPL_DIV_CD='Y0130002'    /* 종근무지 */ 
			  							  ),0)  	/* 국민연금보험료외_공적연금종근무지보험료공제액   */
			  							  
					,MCUR_PBLC_PNSN_INFEE_AMT= NVL((SELECT SUM(NVL(PUOFER_ANTY,0)) + SUM(NVL(MLTYM_ANTY,0)) + SUM(NVL(PRTAFIR_SCHL_FALYMM_ANTY,0)) + SUM(NVL(SPILDTN_PSTOFIC_ANTY,0))
			 								FROM	 YE161055 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY  
											AND BB.PICL_EMPL_DIV_CD='Y0130001'    /* 주근무지 */ 
			  							  ),0)  	/* 국민연금보험료외_공적연금주근무지보험료금액    */
			  							  
					,MCUR_PBLC_PNSN_INFEE_DDC_AMT= NVL((SELECT SUM(NVL(PUOFER_ANTY_DDUC_SUM,0)) + SUM(NVL(MLTYM_ANTY_DDUC_SUM,0)) + SUM(NVL(PRTAFIR_SCHL_DDUC_SUM,0)) + SUM(NVL(SPILDTN_PSTOFIC_DDUC_SUM,0))
			 								FROM	 YE161055 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY  
											AND BB.PICL_EMPL_DIV_CD='Y0130001'    /* 주근무지 */ 
			  							  ),0)  	/* 국민연금보험료외_공적연금주근무지보험료공제액   */
			  							  
					,PNSN_INFEE_USE_AMT_SUM= NVL((SELECT SUM(NVL(NAT_PENN_PRMM_SUM,0)) +  SUM(NVL(NAT_PENN_ARA_PRMM_SUM,0)) + SUM(NVL(PUOFER_ANTY,0)) + SUM(NVL(MLTYM_ANTY,0)) + SUM(NVL(PRTAFIR_SCHL_FALYMM_ANTY,0)) + SUM(NVL(SPILDTN_PSTOFIC_ANTY,0))
			 								FROM	 YE161055 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY   
			  							  ),0)  		/* 연금보험료보험료합계		     */
			  							  
					,PNSN_INFEE_DDC_AMT_SUM	= NVL((SELECT SUM(NVL(NAT_PENN_PRMM_SUM,0)) +  SUM(NVL(NAT_PENN_ARA_PRMM_SUM,0)) + SUM(NVL(PUOFER_ANTY_DDUC_SUM,0)) + SUM(NVL(MLTYM_ANTY_DDUC_SUM,0)) + SUM(NVL(PRTAFIR_SCHL_DDUC_SUM,0)) + SUM(NVL(SPILDTN_PSTOFIC_DDUC_SUM,0))
			 								FROM	 YE161055 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY   
			  							  ),0)  	/* 연금보험료공제액합계		     */ 
			    						
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
						WHERE AA.DPOB_CD=#dpobCd#
								AND AA.YRTX_BLGG_YR=#yrtxBlggYr#
								AND AA.CLUT_SEPT_CD=#clutSeptCd#
								AND AA.SYSTEMKEY=#systemkey# 
				]]>
	</update> 
	   
	 	
	 	
	<update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_04_Update">
		<![CDATA[
			UPDATE YE169010 AC01
			SET   ( YETA_C30_G01 
				, YETA_C31_H01 
				, YETA_C32_H05 
				, YETA_C33_H06 
				, YETA_C34_H07 
				, YETA_C35_H08 
				, YETA_C36_H09 
				, YETA_C37_H10 
				, YETA_C38_H14 
				, YETA_C39_H15 
				, YETA_C40_H11 
				, YETA_C41_H12 
				, YETA_C42_H13 
				, YETA_C43_H16 
				, YETA_C44_I01 
				, YETA_C45_K01 
				, YETA_C46_M01 
				, YETA_C47_M02 
				, YETA_C48_M03 
				, YETA_C49_O01 
				, YETA_C50_Q01 
				, YETA_C51_R10 
				, YETA_C52_R11 
				, YETA_C53_S01 
				, YETA_C54_T01 
				, YETA_C55_Y02 
				, YETA_C56_Y03 
				, YETA_C56A_Y04 
				, YETA_C56_Y21 
				, YETA_C57_Y22 
				, YETA_C58_T10 
				, YETA_C58A_T11 
				, YETA_C58B_T12 
				, YETA_C59_T20) =( SELECT   SUM(NVL(TAXM_SG01_BI,0))
				                           , SUM(NVL(TAXM_SH01_BI ,0))
				                           , SUM(NVL(TAXM_SH05_BI ,0))
				                           , SUM(NVL(TAXM_SH06_BI ,0))
				                           , SUM(NVL(TAXM_SH07_BI ,0))
				                           , SUM(NVL(TAXM_SH08_BI ,0))
				                           , SUM(NVL(TAXM_SH09_BI ,0))
				                           , SUM(NVL(TAXM_SH10_BI ,0))
				                        , SUM(NVL(TAXM_SH14_BI ,0))
									   , SUM(NVL(TAXM_SH15_BI ,0))
									   , SUM(NVL(TAXM_SH11_BI ,0))
									   , SUM(NVL(TAXM_SH12_BI ,0))
									   , SUM(NVL(TAXM_SH13_BI ,0))
									   , SUM(NVL(TAXM_SH16_BI ,0))
									   , SUM(NVL(TAXM_SI01_BI ,0))
									   , SUM(NVL(TAXM_SK01_BI ,0))
									   , SUM(NVL(TAXM_SM01_BI ,0))
									   , SUM(NVL(TAXM_SM02_BI ,0))
									   , SUM(NVL(TAXM_SM03_BI ,0))
									   , SUM(NVL(TAXM_SO01_BI ,0))
									   , (CASE WHEN SUM(NVL(TAXM_SQ01_BI ,0)) > 1200000 THEN 1200000
									          ELSE SUM(NVL(TAXM_SQ01_BI ,0)) END) 
									   , SUM(NVL(TAXM_SR10_BI ,0))
									   , SUM(NVL(TAXM_SR11_BI ,0))
									   , SUM(NVL(TAXM_SS01_BI ,0))
									   , SUM(NVL(TAXM_ST01_BI ,0))
									   , SUM(NVL(TAXM_SY02_BI ,0))
									   , SUM(NVL(TAXM_SY03_BI ,0))
									   , SUM(NVL(TAXM_SY04_BI ,0))
									   , SUM(NVL(TAXM_SY21_BI ,0))
									   , SUM(NVL(TAXM_SY22_BI ,0))
									   , SUM(NVL(TAXM_ST10_BI ,0))
									   , SUM(NVL(TAXM_ST11_BI ,0))
									   , SUM(NVL(TAXM_ST12_BI ,0))
									   , SUM(NVL(TAXM_ST20_BI ,0))
									 FROM  YE160403 AD01
									  WHERE AD01.DPOB_CD=AC01.DPOB_CD
											AND AD01.YRTX_BLGG_YR=AC01.YRTX_BLGG_YR
											AND AD01.CLUT_SEPT_CD=AC01.CLUT_SEPT_CD
											AND AD01.SYSTEMKEY=AC01.SYSTEMKEY  )
				 /*   BEFO_SCNT IS '종전근무지수     */                                                                                                 
              , YETA_00C6  =   NVL((SELECT COUNT(*)                                                                                         
                               FROM (SELECT *                                                                                               
                                       FROM YE160404                                                                                         
                                      WHERE  PRCSP_PRCS_YN = '1'                                                                         
                                        AND  PRCSP_WHDG_REIP_SUMT_YN = '1') YE160404                                                                
                              WHERE YE160404.SYSTEMKEY(+) = AC01.SYSTEMKEY                                                                
                                AND YE160404.YRTX_BLGG_YR(+) = AC01.YRTX_BLGG_YR                                                                
                                AND YE160404.CLUT_SEPT_CD(+) = AC01.CLUT_SEPT_CD      
                                 AND YE160404.DPOB_CD(+) = AC01.DPOB_CD                                                           
                              GROUP BY AC01.SYSTEMKEY                                                                                    
                            ),0) 	
                 , (DCSN_ITAX ,DCSN_BTAX ,FAFV_TAXI)  =  (SELECT    SUM(NVL(YE160404.PRCSP_INCM_TX_SUM,0))
																	,SUM(NVL(YE160404.PRCSP_RGON_INCM_TX_SUM,0))
																	,SUM(NVL(YE160404.PRCSP_NNKS_SUM,0))                                                                                      
                               FROM (SELECT *                                                                                               
                                       FROM YE160404                                                                                         
                                      WHERE  PRCSP_PRCS_YN = '1'                                                                         
                                        AND  PRCSP_WHDG_REIP_SUMT_YN = '1') YE160404                                                                
                              WHERE YE160404.SYSTEMKEY(+) = AC01.SYSTEMKEY                                                                
                                AND YE160404.YRTX_BLGG_YR(+) = AC01.YRTX_BLGG_YR                                                                
                                AND YE160404.CLUT_SEPT_CD(+) = AC01.CLUT_SEPT_CD      
                                 AND YE160404.DPOB_CD(+) = AC01.DPOB_CD                                                           
                              GROUP BY AC01.SYSTEMKEY                                                                                    
                            )  		             				 
			     , ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
						WHERE AC01.DPOB_CD=#dpobCd#
								AND AC01.YRTX_BLGG_YR=#yrtxBlggYr#
								AND AC01.CLUT_SEPT_CD=#clutSeptCd#
								AND AC01.SYSTEMKEY=#systemkey#
				]]>
	</update>  
	
	 
	  <!-- {공제단계 시작 01}  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_05_Update">
		<![CDATA[
	  UPDATE YE169010                                                                                                                          
         SET                                                                                         
  /*   DCSN_TOTS IS '종전근무지)총급여  + 현근무지 총급여    */                                                                                              
            YETA_0C63 = YETA_0C29 + NVL((SELECT SUM(NVL(PRCSP_AGGR_SUM,0))           
                              FROM (SELECT *                                                                                                
                                      FROM YE160404                                                                                          
                                     WHERE PRCSP_PRCS_YN = '1'                                                                          
                                       AND PRCSP_WHDG_REIP_SUMT_YN = '1') YE160404                                                                 
                             WHERE YE160404.SYSTEMKEY(+) = YE169010.SYSTEMKEY                                                                 
                               AND YE160404.YRTX_BLGG_YR(+) = YE169010.YRTX_BLGG_YR                                                                 
                               AND YE160404.CLUT_SEPT_CD(+) = YE169010.CLUT_SEPT_CD   
                                AND YE160404.DPOB_CD(+) = YE169010.DPOB_CD                                                               
                             GROUP BY YE169010.SYSTEMKEY                                                                                     
                           ), 0)  ,                                                                                                         
                                                                                                             
         /*   BASE_SELF IS '기본공제)본인  */                                                                                                  
              YETA_0C66 = (CASE WHEN YETA_0C65 > 1500000 THEN 1500000 ELSE YETA_0C65 END) ,                                                  
         /* BASE_WIFE IS '기본공제)배우자   */                                                                                                
             YETA_0C67 = NVL((SELECT (CASE WHEN AD01.BASE_WIYN = '1' THEN  1500000 ELSE 0 END)                                                                                     
                          FROM (SELECT *                                                                                                    
                                  FROM YE161020 ) AD01                                    
                         WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                        
                           AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                        
                           AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD 
                            AND AD01.DPOB_CD = YE169010.DPOB_CD   ), 0)  ,       
  /*   YETA_0C68 IS '기본공제)부양가족'수   */                                                                                       
             YETA_0C68 =   NVL((SELECT NVL(AD01.BSC_DDCN_FP_CNT,0)                                                                                    
                              FROM YE161020 AD01                
                             WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                    
                               AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                    
                               AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD  
                                AND AD01.DPOB_CD = YE169010.DPOB_CD  ), 0)   ,                                                                                                   
 /*   YETA_0C69 IS '기본공제)부양가족'   */                                                                                       
             YETA_0C69 =   NVL((SELECT NVL(AD01.BSC_DDCN_FP_CNT,0) * 1500000                                                                                   
                              FROM (SELECT *                                                                                                
                                      FROM YE161020 ) AD01                
                             WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                    
                               AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                    
                               AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD  
                                AND AD01.DPOB_CD = YE169010.DPOB_CD   ), 0)   ,    
                             
/*  YETA_0C70 IS '추가공제)경로우대70   */                                                                                           
              YETA_0C70 =  NVL((SELECT NVL(AD01.SCC_NFP_CNT, 0)                                                                        
                              FROM (SELECT *                                                                                                
                                      FROM YE161020 ) AD01                                     
                            WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                     
                               AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                    
                               AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                AND AD01.DPOB_CD = YE169010.DPOB_CD                                                                                      
                               ), 0),   
/*  YETA_0C71 IS '추가공제)경로우대70   */                                                                                           
              YETA_0C71 =  NVL((SELECT NVL(AD01.SCC_NFP_CNT, 0) * 1000000                                                                          
                              FROM (SELECT *                                                                                                
                                      FROM YE161020 ) AD01                                     
                            WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                     
                               AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                    
                               AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                AND AD01.DPOB_CD = YE169010.DPOB_CD                                                                           
                               ), 0),                                                             
                             
                                                                                                    
 /* YETA_0C72 IS '추가공제)장애인    */                                                                                           
            YETA_0C72 =    NVL((SELECT NVL(AD01.DSBR_NFP_CNT,0)                                                                               
                              FROM (SELECT *                                                                                                
                                      FROM YE161020 ) AD01                                     
                             WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                    
                               AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                    
                               AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD     
                                AND AD01.DPOB_CD = YE169010.DPOB_CD  ), 0) ,                                                                             
   
 /* YETA_0C73 IS '추가공제)장애인    */                                                                                           
            YETA_0C73 =    NVL((SELECT NVL(AD01.DSBR_NFP_CNT,0) * 2000000                                                                                   
                              FROM (SELECT *                                                                                                
                                      FROM YE161020 ) AD01                                     
                             WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                    
                               AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                    
                               AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD     
                                AND AD01.DPOB_CD = YE169010.DPOB_CD  ), 0) , 
                             
                                                                                                                                    
 /* YETA_0C74 IS '추가공제)부녀자     */                                                                                             
              YETA_0C74  =  NVL((SELECT NVL(AD01.WMN_NFP_CNT, 0) * 500000                                                                           
                               FROM (SELECT *                                                                                               
                                      FROM YE161020 ) AD01                                     
                            WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                     
                               AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                    
                               AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD 
                                AND AD01.DPOB_CD = YE169010.DPOB_CD                                                                           
                               ), 0) ,  
                                                                                                   

 /*  YETA_0C75 IS '추가공제)한부모공제   */                                                                                      
             YETA_0C75 =    NVL((SELECT (CASE WHEN NVL(AD01.SNPRNT_NFP_CNT, 0) > 0 THEN  1000000 ELSE 0 END)                                                                         
                               FROM (SELECT *                                                                                               
                                      FROM YE161020  ) AD01                                     
                            WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                     
                               AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                    
                               AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD  
                                AND AD01.DPOB_CD = YE169010.DPOB_CD                                                                           
                               ), 0) 
                    , ISMT=#ismt#
				   , REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				   , REVN_ADDR=#revnAddr#                                                                                                    
                              WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                AND SYSTEMKEY=#systemkey#  
			 
				]]>
	</update>
	
 <!-- {공제단계 시작 -소득공제 02}     총급여액,근로소득금액,근로소득공제금액  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_06_Update">
		<![CDATA[
			   UPDATE YE169010                                                                                   
           SET     /*  WKER_DDCT IS '근로소득공제    */                                                                   
               YETA_0C64 =  TRUNC((CASE WHEN YETA_0C63 <= 5000000                                 
                                 THEN                                                                       
                                 YETA_0C63 * 0.7                                              
                                 WHEN 15000000 >= YETA_0C63                                     
                                 THEN                                                                       
                                 3500000 + ((YETA_0C63 - 5000000)   * 0.4)                      
                                                                                                            
                                 WHEN 45000000 >= YETA_0C63                                     
                                 THEN                                                                       
                                 7500000 + ((YETA_0C63 - 15000000)   * 0.15)                    
                                                                                                            
                                 WHEN 100000000 >= YETA_0C63                                     
                                 THEN                                                                       
                                 12000000 + ((YETA_0C63 - 45000000)   * 0.05)                               
                                 ELSE                                                                       
                                 14750000 + ((YETA_0C63 - 100000000)   * 0.02)                   
                                 END)) ,                                                                    
          /*  YETA_0C65 IS '근로소득금액        */                                                               
           YETA_0C65 = (YETA_0C63 -                                                             
                                 (                                                                          
                                 CASE WHEN YETA_0C63 <= 5000000                               
                                 THEN                                                                       
                                 YETA_0C63 * 0.7                                              
                                 WHEN 15000000 >= YETA_0C63                                     
                                 THEN                                                                       
                                 3500000 + ((YETA_0C63 - 5000000)   * 0.4)                      
                                                                                                            
                                 WHEN 45000000 >= YETA_0C63                                     
                                 THEN                                                                       
                                 7500000 + ((YETA_0C63 - 15000000)   * 0.15)                    
                                                                                                            
                                 WHEN 100000000 >= YETA_0C63                                      
                                 THEN                                                                       
                                 12000000 + ((YETA_0C63 - 45000000)   * 0.05)                   
                                                                                                            
                                 ELSE                                                                       
                                 14750000 + ((YETA_0C63 - 100000000)   * 0.02)                   
                                 END                                                                        
                                 )) 
                                  , ISMT=#ismt#
				   			, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				   			, REVN_ADDR=#revnAddr#                                                                             
             WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#  
				]]>
	</update>	
	
	
	 <!-- {공제단계 시작 -연금보험료공제 03} 연금보험료공제  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_07_Update">
		<![CDATA[
		 UPDATE YE169010                                                                      
               SET                                                                          
             /*  YETA_0C76 IS ' 국민연금보험료공제              */                      
                 YETA_0C76 =  0  ,   
                                                                         
                /*  YETA_0C77 IS  국민연금외공무원연금공제  */                         
               YETA_0C77 = NVL((SELECT  SUM(NVL(AD01.PUOFER_ANTY_DDUC_SUM, 0))                             
                                  FROM YE161055 AD01       
                                 WHERE AD01.SYSTEMKEY(+) = YE169010.SYSTEMKEY              
                                  AND AD01.YRTX_BLGG_YR(+) = YE169010.YRTX_BLGG_YR              
                                  AND AD01.CLUT_SEPT_CD(+) = YE169010.CLUT_SEPT_CD  
                                   AND AD01.DPOB_CD(+)  = YE169010.DPOB_CD              
                                GROUP BY YE169010.SYSTEMKEY                                  
                              ),0) ,                                                           
  /*  //YETA_0C78 군인연금보험료공제 */
                YETA_0C78 =  NVL((SELECT  SUM(NVL(AD01.MLTYM_ANTY_DDUC_SUM, 0))                             
                                  FROM YE161055 AD01       
                                 WHERE AD01.SYSTEMKEY(+) = YE169010.SYSTEMKEY              
                                  AND AD01.YRTX_BLGG_YR(+) = YE169010.YRTX_BLGG_YR              
                                  AND AD01.CLUT_SEPT_CD(+) = YE169010.CLUT_SEPT_CD  
                                   AND AD01.DPOB_CD(+)  = YE169010.DPOB_CD              
                                GROUP BY YE169010.SYSTEMKEY                                  
                              ),0),                                                           
  /*  // YETA_0C79교직원연금보험료공제 */
                YETA_0C79 = NVL((SELECT  SUM(NVL(AD01.PRTAFIR_SCHL_DDUC_SUM, 0))                             
                                  FROM YE161055 AD01       
                                 WHERE AD01.SYSTEMKEY(+) = YE169010.SYSTEMKEY              
                                  AND AD01.YRTX_BLGG_YR(+) = YE169010.YRTX_BLGG_YR              
                                  AND AD01.CLUT_SEPT_CD(+) = YE169010.CLUT_SEPT_CD  
                                   AND AD01.DPOB_CD(+)  = YE169010.DPOB_CD              
                                GROUP BY YE169010.SYSTEMKEY                                  
                              ),0),                                                           
 /* // C80_연금보험료_공적연금보험료공제_별정우체국연금 */
                YETA_0C80 = NVL((SELECT  SUM(NVL(AD01.SPILDTN_PSTOFIC_DDUC_SUM, 0))                             
                                  FROM YE161055 AD01       
                                 WHERE AD01.SYSTEMKEY(+) = YE169010.SYSTEMKEY              
                                  AND AD01.YRTX_BLGG_YR(+) = YE169010.YRTX_BLGG_YR              
                                  AND AD01.CLUT_SEPT_CD(+) = YE169010.CLUT_SEPT_CD  
                                   AND AD01.DPOB_CD(+)  = YE169010.DPOB_CD              
                                GROUP BY YE169010.SYSTEMKEY                                  
                              ),0) ,
          /*  YETA_0C81 IS '특별공제_건강보험료  */                                   
                   YETA_0C81 = NVL((SELECT NVL(HTHR_HIFE_DDC_AMT, 0) + NVL(MCUR_HIFE_DDC_AMT, 0)+ NVL(MCUR_HIFE_AREA_DDC_AMT, 0)                                  
                                   FROM YE161060  AD01       
                                  WHERE AD01.SYSTEMKEY(+) = YE169010.SYSTEMKEY           
                                    AND AD01.YRTX_BLGG_YR(+) = YE169010.YRTX_BLGG_YR           
                                    AND AD01.CLUT_SEPT_CD(+) = YE169010.CLUT_SEPT_CD     
                                    AND AD01.DPOB_CD(+)  = YE169010.DPOB_CD                 
                                 ),0)  ,                                                       
                /*  YETA_0C82 IS '특별공제_고용보험     SPCI_JHTH 전액공제    SPCI_BEPF IS '특별공제_종고용보험료   */                                   
                  YETA_0C82 =  NVL((SELECT  NVL(HTHR_UI_DDC_AMT, 0) + NVL(MCUR_UI_DDC_AMT, 0)                           
                                   FROM YE161060  AD01       
                                  WHERE AD01.SYSTEMKEY(+) = YE169010.SYSTEMKEY           
                                    AND AD01.YRTX_BLGG_YR(+) = YE169010.YRTX_BLGG_YR           
                                    AND AD01.CLUT_SEPT_CD(+) = YE169010.CLUT_SEPT_CD     
                                    AND AD01.DPOB_CD(+)  = YE169010.DPOB_CD                 
                                 ),0)       
                                , ISMT=#ismt#
				   			, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				   			, REVN_ADDR=#revnAddr#   
                   WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#                                                                       
				]]>
	</update>
	
	  <!--  {공제단계 시작 -특별공제 - 주택임차차임금 상환액  09 } 특별공제 - 주택임차차임금 상환액-   -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_08_Update">
		<![CDATA[
			  UPDATE YE169010                                                                                                                                                                                              
                         SET                                                                                                                                                                                          
                        /* YETA_0C83 IS '특별공제)차입금원리금상환액_대출기관    */                                                                                                                                                
                          YETA_0C83  =  (SELECT CASE WHEN (NVL(AD01.BRW_LNPB_SRM_AMT,0) * 0.4)  > (4000000)                                                                                                               
                                                    THEN 4000000                                                                                                                                                      
                                                    ELSE NVL(AD01.BRW_LNPB_SRM_AMT,0) * 0.4                                                                                                                               
                                                    END                                                                                                                                                               
                                            FROM YE161060 AD01                                                                                                                                                              
                                          WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                                                 
                                            AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                                                 
                                            AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                            AND AD01.DPOB_CD  = YE169010.DPOB_CD                                                                                                                               
                                            )  ,                                                                                                                                                                      
                                                                                                                                                                                                                                               
                        /*  YETA_0C84 IS '특별공제)차입금원리금상환액_거주자  */                                                                                                                                       
                          YETA_0C84  =  (SELECT CASE WHEN (NVL(AD01.BRW_LNPB_SRM_AMT,0) * 0.4)  > (4000000)                                                                                                               
                                                    THEN 0                                                                                                                                                           
                                                    ELSE                                                                                                                                                        
                                                           (CASE WHEN (NVL(AD01.RSDT_LNPB_SRM_AMT,0) * 0.4)  >  (4000000  - (NVL(AD01.BRW_LNPB_SRM_AMT,0) * 0.4) )                                 
                                                             THEN                                                                                                                          
                                                                  4000000  - (NVL(AD01.BRW_LNPB_SRM_AMT,0) * 0.4)                                                                             
                                                             ELSE                                                                                                                          
                                                                  (NVL(AD01.RSDT_LNPB_SRM_AMT,0) * 0.4)                                                                                       
                                                             END)                                                                                                                          
                                                    END                                                                                                                                                               
                                            FROM YE161060 AD01                                                                                                                                                              
                                          WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                                                 
                                            AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                                                 
                                            AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD 
                                              AND AD01.DPOB_CD  = YE169010.DPOB_CD                                                                                                                               
                                            ) ,
                          /* YETA_C156 SPCI_TGRT IS '특별공제)_월세세액대상금액 액  */                                                                                                                                            
                               YETA_C156  =  (SELECT (CASE WHEN  NVL(AD01.MMR_USE_AMT,0) > 7500000 THEN  7500000       
                                                           ELSE  NVL(AD01.MMR_USE_AMT,0)   END)               
                                            FROM YE161080 AD01                                                
                                          WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                                                 
                                            AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                                                 
                                            AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD  
                                            AND AD01.DPOB_CD  = YE169010.DPOB_CD                                                                                                                                
                                            ) ,   
                                 /* SPCI_RTAM IS '특별공제)_월세세액공제액  */                                                                                                                                            
                               YETA_C157  =  (SELECT (CASE WHEN  ((CASE WHEN  NVL(AD01.MMR_USE_AMT,0) > 7500000 THEN  7500000       
                                                                       ELSE  NVL(AD01.MMR_USE_AMT,0)   END) * (
		CASE
			WHEN YE169010.yeta_0C29 > 55000000
			AND YE169010.yeta_0C29 <= 70000000 THEN 0.15
			WHEN YE169010.yeta_0C29 <= 55000000 THEN 0.17
			ELSE 0.00
		END )) > 750000 THEN  750000       
                                                           ELSE   (CASE WHEN  NVL(AD01.MMR_USE_AMT,0) > 7500000 THEN  7500000       
                                                                        ELSE  NVL(AD01.MMR_USE_AMT,0)   END) * (
		CASE
			WHEN YE169010.yeta_0C29 > 55000000
			AND YE169010.yeta_0C29 <= 70000000 THEN 0.15
			WHEN YE169010.yeta_0C29 <= 55000000 THEN 0.17
			ELSE 0.00
		END )      END)               
                                            FROM YE161080  AD01                                              
                                          WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                                                 
                                            AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                                                 
                                            AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD  
                                            AND AD01.DPOB_CD  = YE169010.DPOB_CD                                                                                                                                
                                            )                        
                             , ISMT=#ismt#
				   			, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				   			, REVN_ADDR=#revnAddr#              
                                WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#               
				]]>
	</update>
	
	   
	   
	   	   <!-- {공제단계 시작 -특별공제 - 주택마련저축  10 } 	 기타공제)주택마련저축  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_09_Update">
		<![CDATA[
			                                                                                                                                   
        UPDATE YE169010                                                                                                                                              
                         SET                                                                                                                                       
                        /*  YETA_C100 ETCS_COMP IS '기타공제)청약저축  -  */                                                                                                                 
      YETA_C100 =           NVL((SELECT (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0) ))  < (    
                                 (CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END)   * 0.4)                                                                                                                                                             
                                                                               THEN                                                                                         
                                        (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  ))               
                               ELSE  ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END)  * 0.4)                                
                              END)                                                                                                                                          
            FROM YE161070 AD01                                                                                                                                                    
          WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                                       
            AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                                       
            AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD  
            AND AD01.DPOB_CD  = YE169010.DPOB_CD                                                                                                                      
                                                        ),0) ,                                                                                                                 
                                                                                                                                                                            
    /*  YETA_C101 ETWK_SBAM IS '기타공제)주택청약종합저 축 ETWK_HSBM  */                                                                                                                  
                                                                                                                                                                            
      YETA_C101 =             NVL((SELECT (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  )                             
                   -  (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  ))  < ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0)       
               > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END)  * 0.4)                                      
                                                    THEN                                                                                                                    
                                                             (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  ))                     
                                                    ELSE  ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END)  * 0.4)              
                                                   END)                                                                                                                     
         )  < ((CASE WHEN  NVL(AD01.HSNG_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.HSNG_SVNG_USE_AMT,0) END)  * 0.4)                                                         
                                                    THEN                                                                                                                    
                                   (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  )                                             
                                                     -  (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  ))         
              < ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)    
                                                                                                THEN                                                                        
                                                                                                         (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  ))  
                                                                                                ELSE  ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)  
                                                                                               END)                                                                         
                                                     )                                                                                                                      
                            ELSE  ((CASE WHEN  NVL(AD01.HSNG_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.HSNG_SVNG_USE_AMT,0) END) * 0.4)                                    
                           END)                                                                                                                                             
         FROM YE161070 AD01                                                                                                                                                       
       WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                                          
         AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                                          
         AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD    
         AND AD01.DPOB_CD  = YE169010.DPOB_CD                                                                                                                           
     ),0),                                                                                                                                                                     
     
	 /* YETA_C102 ETWK_SVAM IS '기타공제)근로자주택마련 ETWK_HSVM    */                                                                                                                           
                                                                                                                                                                                    
         YETA_C102 =    NVL((SELECT (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  )                                                
                                                              -  (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  )) 
                < ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)   
                                                  THEN                                                                                                                              
                                                           (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  ))                              
                                                  ELSE  ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)                       
                                                 END)                                                                                                                               
       -   (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0) )                                                                     
       -  (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  ))  < ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4) 
                                                  THEN                                                                                                                              
                                                           (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  ))                             
                                                  ELSE  ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)                        
                                                 END)                                                                                                                               
            )  < ((CASE WHEN  NVL(AD01.HSNG_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.HSNG_SVNG_USE_AMT,0) END) * 0.4)                                                              
                                                  THEN                                                                                                                              
               (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  )                                                                          
                                 -  (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  ))   
              < ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)      
                                                                            THEN                                                                                                    
                                                                                     (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  ))   
                                                                            ELSE  ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)   
                                                                           END)                                                                                                     
                                 )                                                                                                                                                  
        ELSE  ((CASE WHEN  NVL(AD01.HSNG_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.HSNG_SVNG_USE_AMT,0) END) * 0.4)                                                                  
       END)                                                                                                                                                                         
      -  (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0) )                                                                      
       -  (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  ))  < ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)
                                                  THEN                                                                                                                              
                                                           (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  ))                             
                                                  ELSE  ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)                        
                                                 END)                                                                                                                               
       -   (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  )                                                                     
       -  (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0) ))  < ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)
                                                                                          THEN                                                                                      
                                                           (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0) ))                               
                                                  ELSE  ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)                       
                                                 END)                                                                                                                               
            )  < ((CASE WHEN  NVL(AD01.HSNG_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.HSNG_SVNG_USE_AMT,0) END) * 0.4)                                                             
                                                  THEN                                                                                                                              
                  (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0) )                                                                        
                                    -  (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0) ))  
               < ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)  
                                                                               THEN                                                                                                 
                                                                                        (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  ))  
                                                                               ELSE  ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4) 
                                                                              END)                                                                                                  
                                    )                                                                                                                                               
           ELSE  ((CASE WHEN  NVL(AD01.HSNG_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.HSNG_SVNG_USE_AMT,0) END) * 0.4)                                                             
                                                  END)                                                                                                                              
       )  < (0 * 0.4)                                                                                                                                        
                                                         THEN                                                                                                                       
     (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0) )                                                                                    
      -  (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0) ))  < ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4) 
                                                 THEN                                                                                                                               
                                                          (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0) ))                              
                                                 ELSE  ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)                      
                                                END)                                                                                                                                
      -   (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0) )                                                                     
      -  (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  ))  < ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)
                                                 THEN                                                                                                                               
                                                          (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0) ))                               
                                                 ELSE  ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)                       
                                                END)                                                                                                                                
           )  < ((CASE WHEN  NVL(AD01.HSNG_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.HSNG_SVNG_USE_AMT,0) END) * 0.4)                                                              
                                                 THEN                                                                                                                               
          (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0) )                                                                              
                            -  (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  ))   
              < ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)                                     
                                                                       THEN                                                                                                         
                                                                                (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  ))   
                                                                       ELSE  ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4) 
                                                                      END)                                                                                                          
                            )                                                                                                                                                       
                                                 ELSE  ((CASE WHEN  NVL(AD01.HSNG_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.HSNG_SVNG_USE_AMT,0) END) * 0.4)                
                                                END)                                                                                                                                
      )                                                                                                                                                                             
                                                         ELSE  (0 * 0.4)                                                                                     
                                                        END)                                                                                                                        
                      )   < ((CASE WHEN  NVL(AD01.LBRR_PRPT_SVNG_USE_AMT,0) > 1800000 THEN 1800000 ELSE NVL(AD01.LBRR_PRPT_SVNG_USE_AMT,0) END) * 0.4)                                                                                                                        
                                                                 THEN                                                                                                               
               (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  )                                                                                                     
      -  (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  ))  < ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4) 
                                                 THEN                                                                                                                               
                                                          (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  ))                               
                                                 ELSE  ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)                        
                                                END)                                                                                                                                
      -   (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  )                                                                     
      -  (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0) ))  < ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4) 
                                                 THEN                                                                                                                               
                                                          (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  ))                               
                                                 ELSE  ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)                        
                                                END)                                                                                                                                
           )  < ((CASE WHEN  NVL(AD01.HSNG_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.HSNG_SVNG_USE_AMT,0) END) * 0.4)                                                               
                                                 THEN                                                                                                                               
                                                        (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  )                                                            
                                                                          -  (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  ))  
                < ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)    
                                                                                                                     THEN                                                                        
                                                                                                                              (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  ))  
                                                                                                                     ELSE  ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4) 
                                                                                                                    END)                                                    
                                                                          )                                                                                                 
                                                 ELSE  ((CASE WHEN  NVL(AD01.HSNG_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.HSNG_SVNG_USE_AMT,0) END) * 0.4)               
                                                END)                                                                                                                        
     -  (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0) )                                                               
      -  (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0) ))  < ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4) 
                                                 THEN                                                                                                                       
                                                          (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0) ))                        
                                                 ELSE  ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)              
                                                END)                                                                                                                        
      -   (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) +  NVL(YE169010.YETA_0C84,0)  )                                                            
      -  (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) +  NVL(YE169010.YETA_0C84,0)  ))  < ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4) 
                                            THEN                                                                                                                            
                                                     (4000000 - (NVL(YE169010.YETA_0C83,0) +  NVL(YE169010.YETA_0C84,0) ))                           
                                            ELSE  ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)                     
                                           END)                                                                                                                             
      )  < ((CASE WHEN  NVL(AD01.HSNG_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.HSNG_SVNG_USE_AMT,0) END) * 0.4)                                                             
                                            THEN                                                                                                                            
                                                   (4000000 - (NVL(YE169010.YETA_0C83,0) +  NVL(YE169010.YETA_0C84,0)  )                              
                                                                     -  (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0) )) 
                < ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)      
                                                                                                                THEN                                                                          
                                                                                                                         (4000000 - (NVL(YE169010.YETA_0C83,0) +  NVL(YE169010.YETA_0C84,0)  ))    
                                                                                                                ELSE  ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4) 
                                                                                                               END)                                                          
                                                                     )                                                                                                       
                                            ELSE  ((CASE WHEN  NVL(AD01.HSNG_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.HSNG_SVNG_USE_AMT,0) END) * 0.4)                       
                                           END)                                                                                                                              
                 )  < (0 * 0.4)                                                                                                                       
            THEN                                                                                                                                                             
                    (4000000 - (NVL(YE169010.YETA_0C83,0) +  NVL(YE169010.YETA_0C84,0) )                                                                                         
                     -  (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) +  NVL(YE169010.YETA_0C84,0) ))  
               < ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)
                                                                THEN                                                                                                         
                                                                         (4000000 - (NVL(YE169010.YETA_0C83,0) +  NVL(YE169010.YETA_0C84,0)  ))                                   
                                                                ELSE  ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)                              
                                                               END)                                                                                                          
                     -   (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0) )                                                                         
                     -  (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) +  NVL(YE169010.YETA_0C84,0)  ))  
               < ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)                                     
                                                                THEN                                                                                                         
                                                                         (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0) ))                                   
                                                                ELSE  ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)     
                                                               END)                                                                                                          
                          )  < ((CASE WHEN  NVL(AD01.HSNG_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.HSNG_SVNG_USE_AMT,0) END) * 0.4)                                            
        THEN                                                                                                                                                                 
               (4000000 - (NVL(YE169010.YETA_0C83,0) +  NVL(YE169010.YETA_0C84,0) )                                                                     
                                 -  (CASE WHEN (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0)  )) 
                < ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)                         
                                                                            THEN                                                                                             
                                                                                     (4000000 - (NVL(YE169010.YETA_0C83,0) + NVL(YE169010.YETA_0C84,0) ))   
                                                                            ELSE  ((CASE WHEN  NVL(AD01.SBC_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.SBC_SVNG_USE_AMT,0) END) * 0.4)   
                                                                           END)                                                                                              
                                 )                                                                                                                                           
        ELSE  ((CASE WHEN  NVL(AD01.HSNG_SVNG_USE_AMT,0) > 2400000 THEN 2400000 ELSE NVL(AD01.HSNG_SVNG_USE_AMT,0) END) * 0.4)                                                          
       END)                                                                                                                                                                  
                     )                                                                                                                                                       
            ELSE  (0 * 0.4)                                                                                                                           
           END)                                                                                                                                                              
                      )                                                                                                                                                      
                                                                 ELSE  ((CASE WHEN  NVL(AD01.LBRR_PRPT_SVNG_USE_AMT,0) > 1800000 THEN 1800000 ELSE NVL(AD01.LBRR_PRPT_SVNG_USE_AMT,0) END) * 0.4)                                                                       
                                                                END)                                                                                                         
                                              FROM YE161070  AD01                                                                                                                 
                                            WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                      
                                              AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                      
                                              AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD    
                                              AND AD01.DPOB_CD  = YE169010.DPOB_CD                                                                                   
                                          ) ,0)      
    
                  WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#                                                                                                                                                                                         
                           
				]]>
	</update>
	 
	
	   <!-- {공제단계 시작 -특별공제 - 택마련저축 합계  10-1 }  기타공제)주택마련저축  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_10_Update">
		<![CDATA[
		
		 UPDATE YE169010                                                                                                                                                                                      
                  SET                                                                                                                                                                                  
                    /* YETA_0C85 SPCH_RE15 IS '특별공제)장기주택이자상환액  - WKER_AMNT    */                                                                                                                      
                          YETA_0C85 = (SELECT CASE WHEN NVL(AD01.LTH_YR15_BLW_ITR_AMT, 0)  > 0 
                          						   THEN (CASE WHEN NVL(AD01.LTH_YR15_BLW_ITR_AMT, 0)  > 0 AND NVL(AD01.LTH_YR29_ITR_AMT, 0) = 0 AND  NVL(AD01.LTH_Y30_OVER_ITR_AMT, 0) = 0                                                                        
                                              	     		  THEN CASE WHEN NVL(AD01.LTH_YR15_BLW_ITR_AMT, 0) > 6000000 -((YE169010.YETA_C100+YE169010.YETA_C101+YE169010.YETA_C102)+YE169010.YETA_0C83+NVL(YE169010.YETA_0C84,0))                                      
                                                          			    THEN 6000000-((YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + YE169010.YETA_0C83 + NVL(YE169010.YETA_0C84,0)  )                                      
                                                               			ELSE NVL(AD01.LTH_YR15_BLW_ITR_AMT, 0)                                                                                                                     
                                                           			    END                                                                                                                                         
                                             			  	  ELSE CASE WHEN NVL(AD01.LTH_Y30_OVER_ITR_AMT, 0) > 0                                                                                                                      
                                                         			    THEN CASE WHEN NVL(AD01.LTH_YR15_BLW_ITR_AMT, 0) > 15000000-((YE169010.YETA_C100+YE169010.YETA_C101+YE169010.YETA_C102)+YE169010.YETA_0C83+NVL(YE169010.YETA_0C84,0))       
                                                                    			  THEN 15000000 - ((YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + YE169010.YETA_0C83 +  NVL(YE169010.YETA_0C84,0) )                           
                                                                    			  ELSE NVL(AD01.LTH_YR15_BLW_ITR_AMT, 0)                                                                                                              
                                                                    			  END                                                                                                                                  
                                                         				ELSE CASE WHEN NVL(AD01.LTH_YR15_BLW_ITR_AMT, 0) > 10000000 - ((YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + YE169010.YETA_0C83 +  NVL(YE169010.YETA_0C84,0)  )      
                                                                     			  THEN 10000000 - ((YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + YE169010.YETA_0C83 +  NVL(YE169010.YETA_0C84,0)  )                          
                                                                    			  ELSE NVL(AD01.LTH_YR15_BLW_ITR_AMT, 0)                                                                                                              
                                                                   				  END                                                                                                                                 
                                                          			    END                                                                                                                                          
                                              END )
                                              ELSE 0 END                                                                                                                                                      
                                               FROM YE161060 AD01                                                                                                                                           
                                              WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                              
                                               AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                               
                                               AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD 
                                               AND AD01.DPOB_CD  = YE169010.DPOB_CD  )   
                              WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#       
                                 
				]]>
	</update>
	<!-- 
			    UPDATE YE161070                                                                                                                                              
                    SET                                                                                                                                       
       /*  ETWK_BDAM IS '기타공제)주택마련저축 계-       */                                                                                                                      
    			 HSNG_INC_DDC_AMT_SUM =  (SELECT (AD01.YETA_C100 + AD01.YETA_C101 + AD01.YETA_C102 )  
    			               FROM YE169010 AD01                                                                                                                                                       
							       WHERE AD01.SYSTEMKEY = YE161070.SYSTEMKEY                                                                                                                          
							         AND AD01.YRTX_BLGG_YR = YE161070.YRTX_BLGG_YR                                                                                                                          
							         AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD    
							         AND AD01.DPOB_CD  = YE161070.DPOB_CD )                                                     
           WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#    -->
	   
	   
  <!-- {공제단계 시작 -특별공제 - 장기주택이자상환액  10-2 } 특별공제 -장기주택이자상환액    -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_11_Update">
		<![CDATA[
			 UPDATE YE169010                                                                                                                                                                                      
                  SET   YETA_0C86 =  (SELECT    CASE WHEN NVL(AD01.LTH_YR29_ITR_AMT, 0)  > 0 THEN  
                                               (CASE WHEN NVL(AD01.LTH_YR29_ITR_AMT, 0) > 0 AND  NVL(AD01.LTH_Y30_OVER_ITR_AMT, 0) = 0                                                                                                   
                                              THEN                                                                                                                                                     
                                                   CASE WHEN   NVL(AD01.LTH_YR29_ITR_AMT, 0)  >                                                                                                                    
                                                         10000000   - (YE169010.YETA_0C85 + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + YE169010.YETA_0C83 +  NVL(YE169010.YETA_0C84,0)  )                      
                                                    THEN                                                                                                                                               
                                                        10000000   - (YE169010.YETA_0C85 + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + YE169010.YETA_0C83 + NVL(YE169010.YETA_0C84,0) )                       
                                                   ELSE                                                                                                                                                
                                                       NVL(AD01.LTH_YR29_ITR_AMT, 0)                                                                                                                               
                                                 END                                                                                                                                                   
                                              ELSE                                                                                                                                                     
                                                    CASE WHEN   NVL(AD01.LTH_YR29_ITR_AMT, 0)  >                                                                                                                   
                                                         15000000   - (YE169010.YETA_0C85 + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + YE169010.YETA_0C83 +  NVL(YE169010.YETA_0C84,0) )                      
                                                   THEN                                                                                                                                                
                                                        15000000   - (YE169010.YETA_0C85 + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + YE169010.YETA_0C83 + NVL(YE169010.YETA_0C84,0)  )                       
                                                  ELSE                                                                                                                                                 
                                                      NVL(AD01.LTH_YR29_ITR_AMT, 0)                                                                                                                                
                                                   END                                                                                                                                                 
                                               END   )
                                              ELSE 0 END                                                                                                                                                       
                                             FROM YE161060  AD01                                                                                                                                             
                                           WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                                 
                                             AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                                 
                                             AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
                                             AND AD01.DPOB_CD  = YE169010.DPOB_CD   ) 
                              WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#                 
                                             
				]]>
	</update>
	  	   	
<!-- C87 2011이전차입분   -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_12_Update">
		<![CDATA[
			  UPDATE YE169010                                                                                                                                                                                      
                  SET                                                                                                                                                                                  
                 YETA_0C87 =  (SELECT  CASE WHEN NVL(AD01.LTH_Y30_OVER_ITR_AMT, 0)  > 0 THEN  
                                               ( CASE WHEN NVL(AD01.LTH_Y30_OVER_ITR_AMT, 0)  >                                                                                                                                  
                                                    15000000  - (YE169010.YETA_0C86 +  YE169010.YETA_0C85 + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + YE169010.YETA_0C83 +  NVL(YE169010.YETA_0C84,0) )       
                                                   THEN                                                                                                                                                
                                                      15000000  - (YE169010.YETA_0C86 +  YE169010.YETA_0C85 + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + YE169010.YETA_0C83 +  NVL(YE169010.YETA_0C84,0)  )     
                                                  ELSE                                                                                                                                                 
                                                    NVL(AD01.LTH_Y30_OVER_ITR_AMT, 0)                                                                                                                                  
                                                 END  )
                                              ELSE 0 END                                                                                                                                                    
                                          FROM YE161060  AD01                                                                                                                                                
                                              WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                              
                                                 AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                             
                                                 AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD 
                                                 AND AD01.DPOB_CD  = YE169010.DPOB_CD )  ,
                              /*   ADDR_CHLD IS '추가공제)6세이하공제 소득세법 소급제정  NVL(COUNT(*), 0) * 150000     */                                                                                     
              YETA_C123 =  0 ,         
               /*   ADDR_CHLD IS '추가공제)6세이하공제 소득세법 소급제정  NVL(COUNT(*), 0) * 150000     */                                                                                     
              YETA_C124 =  0 ,         
                                                                                                                                               
          /*  ADDR_BRTH IS '추가공제)출산자녀양육비 소득세법 소급제정    */                                                                                    
             YETA_C125 =    NVL((SELECT  NVL(CHBT_ADOP_NFP_CNT, 0)                                                                          
                               FROM (SELECT *                                                                                               
                                      FROM YE161020  ) AD01                                     
                            WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                     
                               AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                    
                               AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                AND AD01.DPOB_CD = YE169010.DPOB_CD                                                                           
                               ), 0) ,     
                               
               /*  ADDR_BRTH IS '추가공제)출산자녀양육비 소득세법 소급제정    */                                                                                    
             YETA_C126 =    NVL((SELECT  SUM((CASE WHEN  CHBT_ATPR_DDC_CL_CD = '1'  THEN 300000
                                              WHEN  CHBT_ATPR_DDC_CL_CD = '2'  THEN 500000
                                              WHEN  CHBT_ATPR_DDC_CL_CD = '3'  THEN 700000  
                                              ELSE 0 END))                                      
                               FROM (SELECT *                                                                                               
                                      FROM YE161030  
                                      WHERE CHBT_ATPR_DDC_CL_CD IN ('1','2','3')) AD01                                     
                            WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                     
                               AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                    
                               AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                AND AD01.DPOB_CD = YE169010.DPOB_CD                                                            
                               ), 0) ,   
                               
            /* ADDR_MCAM IS '추가공제)자녀수 세액공제로 교체 됨.    ADDR_MCAM -사용안함.    */                                                                                            
              YETA_C121    =   NVL((SELECT NVL(CHILD, 0)     
                               		FROM  (SELECT *                                                                                               
                                      		FROM YE161020) AD01                         
                            WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                     
                               AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                    
                               AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                AND AD01.DPOB_CD = YE169010.DPOB_CD                                                                       
                               ), 0) ,                
			        /* ADDR_MCAM IS '추가공제)자녀수 세액공제로 교체 됨 */                                                                                            
              YETA_C122    =   NVL((SELECT CASE WHEN NVL(CHILD, 0) > 2 THEN 300000 + ((NVL(CHILD, 0) - 2) * 300000)   
                                  				ELSE (CASE WHEN NVL(CHILD, 0) = 2 THEN 300000 
                                  						   ELSE (CASE WHEN NVL(CHILD, 0) = 1 THEN 150000 ELSE 0 END) END) END
                               FROM (SELECT *                                                                                               
                                      FROM YE161020  ) AD01                           
                            WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                     
                               AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                    
                               AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                AND AD01.DPOB_CD = YE169010.DPOB_CD                                                                          
                               ), 0)                                 
                                                  
                  WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#    
				]]>
	</update>	   
	   
	      <!--  {공제단계 시작 -특별공제 - 장기주택이자상환액 고정금리 비거치  10-3 }
    //장기주택저장차입금. 추가사항 반영
  특별공제 -장기주택이자상환액 고정금리 비거치 
  -->
	  <!-- {공제단계 시작 -특별공제 - 장기주택이자상환액 기타 대출  10-4 } //장기주택저장차입금. 추가사항 반영 특별공제 -장기주택이자상환액 기타 대출    -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_13_Update">
		<![CDATA[
			DECLARE BEGIN 
            
			  UPDATE YE169010                                                                                                                                                                                      
                SET    
                YETA_0C88 = (SELECT CASE WHEN NVL(AD01.LTH_YR2012_AFTH_Y15_AMT, 0)  > 0 THEN  
                                               ( CASE WHEN   NVL(AD01.LTH_YR2012_AFTH_Y15_AMT, 0)  >                                                                                                                                  
                                                   15000000  - (YE169010.YETA_0C87 + YE169010.YETA_0C86 +  YE169010.YETA_0C85 + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + YE169010.YETA_0C83 +  NVL(YE169010.YETA_0C84,0)  )       
                                                  THEN                                                                                                                                                
                                                    15000000  - (YE169010.YETA_0C87 + YE169010.YETA_0C86 + YE169010.YETA_0C85 +(YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + YE169010.YETA_0C83 + NVL(YE169010.YETA_0C84,0)  )        
                                                 ELSE                                                                                                                                                 
                                                   NVL(AD01.LTH_YR2012_AFTH_Y15_AMT, 0)                                                                                                                                  
                                                END   )
                                              ELSE 0 END                                                                                                                                                   
                                         FROM YE161060 AD01                                                                                                                                                 
                                             WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                              
                                                AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                             
                                                AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD 
                                                AND AD01.DPOB_CD  = YE169010.DPOB_CD)                                                                                                         
			               WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey# ;   
                                 
           
           
           		  UPDATE YE169010                                                                                                                                                                                      
                SET   YETA_0C89 = (SELECT CASE WHEN NVL(AD01.LTH_YR2012_ETC_BRW_ITR_AMT, 0)  > 0 THEN  
                                               (CASE WHEN   NVL(AD01.LTH_YR2012_ETC_BRW_ITR_AMT, 0)  >                                                                                                                                  
                                                   5000000  - (YE169010.YETA_0C87 + YE169010.YETA_0C86 +  YE169010.YETA_0C85 + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + YE169010.YETA_0C83 +  NVL(YE169010.YETA_0C84,0) )       
                                                  THEN                                                                                                                                                
                                                     (CASE WHEN 5000000  - (YE169010.YETA_0C87 + YE169010.YETA_0C86 + YE169010.YETA_0C85 +(YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + YE169010.YETA_0C83 + NVL(YE169010.YETA_0C84,0) )   < 0 
               THEN 0 ELSE  5000000  - (YE169010.YETA_0C87 + YE169010.YETA_0C86 + YE169010.YETA_0C85 +(YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + YE169010.YETA_0C83 + NVL(YE169010.YETA_0C84,0)  )   END)        
                                                 ELSE                                                                                                                                                 
                                                   NVL(AD01.LTH_YR2012_ETC_BRW_ITR_AMT, 0)                                                                                                                                  
                                                END   )
                                              ELSE 0 END                                                                                                                                                  
                                         FROM YE161060 AD01                                                                                                                                                
                                             WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                              
                                                AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                             
                                                AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
                                                AND AD01.DPOB_CD  = YE169010.DPOB_CD )                                                                                                         
			               WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#  ;
                            
               
END;                   
                                                       
				]]>
	</update>	   
	   
  <!-- {공제단계 시작 -특별공제 - 장기주택이자상환액 2015년이후 고정금리이면서 비거치상환 대출 15  10-4_1 }
 //장기주택저장차입금. 추가사항 반영 특별공제 -장기주택이자상환액  
          2015년이후 15년이상 고정금이거나비거치상환 대출 104-2
          2015년이상 기타대출 10-4-3
          2015년 이후 10년 ~ 15년 고정금리이거나 비거치 상환 대출 
  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_14_Update">
		<![CDATA[
			       UPDATE YE169010                                                                                                                                                                                      
                SET                                                                                                                                                                                  
                  YETA_0C90 = (SELECT CASE WHEN NVL(AD01.LTH_YR2015_AFTH_FXN_IR_ITR_AMT, 0)  > 0 THEN  
                                               (CASE WHEN   NVL(AD01.LTH_YR2015_AFTH_FXN_IR_ITR_AMT, 0)  >                                                                                                                                  
                                                   18000000  - (YE169010.YETA_0C88 + YE169010.YETA_0C89 + YE169010.YETA_0C87 + YE169010.YETA_0C86
                                                             +  YE169010.YETA_0C85 + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + YE169010.YETA_0C83 +  NVL(YE169010.YETA_0C84,0)  )       
                                                  THEN                                                                                                                                                
                                                    18000000  - (YE169010.YETA_0C88 + YE169010.YETA_0C89 + YE169010.YETA_0C87 + YE169010.YETA_0C86 
                                                              + YE169010.YETA_0C85 +(YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + YE169010.YETA_0C83 + NVL(YE169010.YETA_0C84,0)  )        
                                                 ELSE                                                                                                                                                 
                                                   NVL(AD01.LTH_YR2015_AFTH_FXN_IR_ITR_AMT, 0)                                                                                                                                  
                                                END    )
                                              ELSE 0 END                                                                                                                                                     
                                         FROM YE161060 AD01                                                                                                                                                
                                             WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                              
                                                AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                             
                                                AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD 
                                                AND AD01.DPOB_CD  = YE169010.DPOB_CD)     ,  
                 YETA_0C91 = (SELECT  CASE WHEN NVL(AD01.LTH_YR2015_AFTH_Y15_AMT, 0)  > 0 THEN  
                                               (CASE WHEN   NVL(AD01.LTH_YR2015_AFTH_Y15_AMT, 0)  >                                                                                                                                  
                                                   15000000  - (YE169010.YETA_0C88 + YE169010.YETA_0C89 + YE169010.YETA_0C87 + YE169010.YETA_0C86
                                                             +  YE169010.YETA_0C85 + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + YE169010.YETA_0C83 +  NVL(YE169010.YETA_0C84,0)  )       
                                                  THEN                                                                                                                                                
                                                    15000000  - (YE169010.YETA_0C88 + YE169010.YETA_0C89 + YE169010.YETA_0C87 + YE169010.YETA_0C86 
                                                              + YE169010.YETA_0C85 +(YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + YE169010.YETA_0C83 + NVL(YE169010.YETA_0C84,0)  )        
                                                 ELSE                                                                                                                                                 
                                                   NVL(AD01.LTH_YR2015_AFTH_Y15_AMT, 0)                                                                                                                                  
                                                END    )
                                              ELSE 0 END                                                                                                                                                     
                                         FROM YE161060 AD01                                                                                                                                                   
                                             WHERE  AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                              
                                                AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                             
                                                AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD 
                                                AND AD01.DPOB_CD  = YE169010.DPOB_CD)     ,     
                YETA_0C92 = (SELECT CASE WHEN NVL(AD01.LTH_YR2015_AFTH_ETC_AMT, 0)  > 0 THEN  
                                               (CASE WHEN   NVL(AD01.LTH_YR2015_AFTH_ETC_AMT, 0)  >                                                                                                                                  
                                                    5000000  - (YE169010.YETA_0C88 + YE169010.YETA_0C89 + YE169010.YETA_0C87 + YE169010.YETA_0C86
                                                             +  YE169010.YETA_0C85 + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + YE169010.YETA_0C83 +  NVL(YE169010.YETA_0C84,0)  )       
                                                  THEN                                                                                                                                                
                                                     5000000  - (YE169010.YETA_0C88 + YE169010.YETA_0C89 + YE169010.YETA_0C87 + YE169010.YETA_0C86 
                                                              + YE169010.YETA_0C85 +(YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + YE169010.YETA_0C83 + NVL(YE169010.YETA_0C84,0)  )        
                                                 ELSE                                                                                                                                                 
                                                   NVL(AD01.LTH_YR2015_AFTH_ETC_AMT, 0)                                                                                                                                  
                                                END     )
                                              ELSE 0 END                                                                                                                                                   
                                         FROM YE161060 AD01                                                                                                                                                   
                                             WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                              
                                                AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                             
                                                AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD 
                                                AND AD01.DPOB_CD  = YE169010.DPOB_CD)     ,                                                                        
                YETA_0C93 = (SELECT CASE WHEN NVL(AD01.LTH_YR2015_AFTH_YR15_AMT, 0)  > 0 THEN  
                                               (CASE WHEN   NVL(AD01.LTH_YR2015_AFTH_YR15_AMT, 0)  >                                                                                                                                  
                                                    3000000  - (YE169010.YETA_0C88 + YE169010.YETA_0C89 + YE169010.YETA_0C87 + YE169010.YETA_0C86
                                                             +  YE169010.YETA_0C85 + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + YE169010.YETA_0C83 +  NVL(YE169010.YETA_0C84,0)  )       
                                                  THEN                                                                                                                                                
                                                     3000000  - (YE169010.YETA_0C88 + YE169010.YETA_0C89 + YE169010.YETA_0C87 + YE169010.YETA_0C86 
                                                              + YE169010.YETA_0C85 +(YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + YE169010.YETA_0C83 + NVL(YE169010.YETA_0C84,0)  )        
                                                 ELSE                                                                                                                                                 
                                                   NVL(AD01.LTH_YR2015_AFTH_YR15_AMT, 0)                                                                                                                                  
                                                END    )
                                              ELSE 0 END                                                                                                                                                    
                                         FROM YE161060 AD01                                                                                                                                                   
                                             WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                              
                                                AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                             
                                                AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD 
                                                AND AD01.DPOB_CD  = YE169010.DPOB_CD)                                                                                                                                       
			                  WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                AND SYSTEMKEY=#systemkey#    
				]]>
	</update>	   
	   
	   
	
	
 <!-- 기타소득공제 -     -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_15_Update">
		<![CDATA[
			 UPDATE YE169010                                                                                                           
                           SET   
                                                                                                                               
                           /* YETA_0C98 ETCP_PSNV IS '기타공제)개인연금저축불입액_2000년이전  */                                                   
                           YETA_0C98 = (SELECT CASE WHEN (NVL(AD01.YR2000_PNSN_SVNG_USE_AMT,0) * 0.4)  > (720000)                                
                                                      THEN 720000                                                                    
                                                      ELSE NVL(AD01.YR2000_PNSN_SVNG_USE_AMT,0) * 0.4                                            
                                                      END                                                                            
                                              FROM YE161070 AD01                                                                             
                                            WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                              
                                              AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                              
                                              AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD      
                                              AND AD01.DPOB_CD  = YE169010.DPOB_CD                                        
                                              ) ,                                                                                    
                        
                          /*  YETA_0C99 IS '기타공제)소기업공제부금   */                                                                                                  
                           YETA_0C99 = (SELECT  CASE WHEN NVL(YE169010.YETA_0C65,0) <= 40000000 THEN 
                                                       (CASE WHEN NVL(AD01.SMCE_SBIZ_USE_AMT,0)  > (5000000)                                                                                
                                                             THEN 5000000                                                                                                    
                                                             ELSE AD01.SMCE_SBIZ_USE_AMT                                                                                          
                                                             END)
                                                     WHEN NVL(YE169010.YETA_0C65,0) <= 100000000 THEN 
                                                          (CASE WHEN NVL(AD01.SMCE_SBIZ_USE_AMT,0)  > (3000000)                                                                                
                                                             THEN 3000000                                                                                                    
                                                             ELSE AD01.SMCE_SBIZ_USE_AMT                                                                                          
                                                             END) 
                                                     ELSE  
                                                        (CASE WHEN NVL(AD01.SMCE_SBIZ_USE_AMT,0)  > (2000000)                                                                                
                                                             THEN 2000000                                                                                                    
                                                             ELSE AD01.SMCE_SBIZ_USE_AMT                                                                                          
                                                             END) 
                                                     END
                                                                                                                                       
                                              FROM YE161070 AD01                                                                                                             
                                            WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                               
                                              AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                               
                                              AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD       
                                              AND AD01.DPOB_CD  = YE169010.DPOB_CD                                                                        
                                              )           
                      WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#                                       
				]]>
	</update>	   
	   
	 <!-- 기타소득공제 -투자조합출자등소득공제 2020년이후     YE161070 테이블에서 처리 후  YE169010 으로 적용 함 -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_16_Update">
		<![CDATA[
			 UPDATE YE161070                                                                                                           
                           SET                                                                                                       
                                 /* 2020년도 이후 출자금액 기타공제_투자조합출자금액_2020년이후 */ 
          CPIV20_ASCT_DDC_AMT     = (
                  SELECT CASE WHEN (NVL(YE161070.CPIV20_ASCT_USE_AMT,0) * 0.1)  <  (NVL(AD01.YETA_0C65,0) * 0.5)                                       
                                                               THEN (NVL(YE161070.CPIV20_ASCT_USE_AMT,0) * 0.1)                                                                   
                                                               ELSE CASE WHEN ((NVL(AD01.YETA_0C65,0) * 0.5) ) <= 0 
                                                               THEN 0 ELSE ((NVL(AD01.YETA_0C65,0) * 0.5) )  END          
                                                              END                                                                                                     
                                                      FROM YE169010 AD01                                                                                                    
                                                      WHERE AD01.SYSTEMKEY= YE161070.SYSTEMKEY                                                                      
                                              AND AD01.YRTX_BLGG_YR = YE161070.YRTX_BLGG_YR                                                                               
                                              AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD   
                                              AND AD01.DPOB_CD  = YE161070.DPOB_CD 
                       ), 
         CPIV20_ASCT_TWO_DDC_AMT = (SELECT (CASE
           								WHEN (NVL (CPIV20_ASCT_TWO_USE_AMT, 0) * 0.1) < 30000000
           								THEN
              								(CASE
                  								WHEN (NVL (CPIV20_ASCT_TWO_USE_AMT, 0) * 0.1) <
                          						(  (NVL (AD01.YETA_0C65, 0) * 0.5)
                           							- (NVL (YE161070.CPIV20_ASCT_USE_AMT, 0) * 0.1))
                  								THEN
                     							(NVL (CPIV20_ASCT_TWO_USE_AMT, 0) * 0.1)
                  								ELSE
                     								(CASE
                         								WHEN (  (NVL (AD01.YETA_0C65, 0) * 0.5)
                               									- (NVL (YE161070.CPIV20_ASCT_USE_AMT, 0) * 0.1)) <= 0
                         								THEN
                            								0
                         								ELSE
                            								(  (NVL (AD01.YETA_0C65, 0) * 0.5)
                             									- (NVL (YE161070.CPIV20_ASCT_USE_AMT, 0) * 0.1))
                      								END)
               									END)
        									END)
  											FROM YE169010 AD01
 											WHERE     AD01.SYSTEMKEY = YE161070.SYSTEMKEY
       										AND AD01.YRTX_BLGG_YR = YE161070.YRTX_BLGG_YR
       										AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD
       										AND AD01.DPOB_CD = YE161070.DPOB_CD
       						),              
         CPIV20_VNT_DDC_AMT     = (SELECT (CASE
           									WHEN NVL (YE161070.CPIV20_VNT_USE_AMT, 0) <= 30000000 
           									THEN
              									(CASE
                  								WHEN (NVL (YE161070.CPIV20_VNT_USE_AMT, 0) * 1) < (NVL (AD01.YETA_0C65, 0) * 0.5)
                          								- (CASE
                                							WHEN (  NVL (YE161070.CPIV20_ASCT_USE_AMT, 0) * 0.1) < ( (NVL (AD01.YETA_0C65, 0) * 0.5))
                                							THEN
                                   								(  NVL (YE161070.CPIV20_ASCT_USE_AMT, 0) * 0.1)
                                							ELSE
                                   								CASE
                                      							WHEN ( (NVL (AD01.YETA_0C65, 0) * 0.5)) <= 0
                                      							THEN
                                         							0
                                      							ELSE
                                         							( (NVL (AD01.YETA_0C65, 0) * 0.5))
                                   								END
                             								END)
                          								- (CASE
                                							WHEN (NVL (CPIV20_ASCT_TWO_USE_AMT, 0) * 0.1) < 30000000
                                							THEN
                                   								(CASE
                                       								WHEN (  NVL (CPIV20_ASCT_TWO_USE_AMT,0) * 0.1) < (  (  NVL (AD01.YETA_0C65, 0) * 0.5) 
                                       										- (  NVL (YE161070.CPIV20_ASCT_USE_AMT,0) * 0.1))
                                       								THEN
                                          								(  NVL (CPIV20_ASCT_TWO_USE_AMT, 0) * 0.1)
                                       								ELSE
                                          								(CASE
                                              								WHEN (  (  NVL (AD01.YETA_0C65, 0) * 0.5)
                                                    								- (  NVL ( YE161070.CPIV20_ASCT_USE_AMT,0) * 0.1)) <= 0
                                              								THEN
                                                 								0
                                              								ELSE
                                                 								(  (  NVL (AD01.YETA_0C65,0) * 0.5)
                                                  									- (  NVL (YE161070.CPIV20_ASCT_USE_AMT,0) * 0.1))
                                           									END)
                                    								END)
                             								END)
                  										THEN
                     										(NVL (YE161070.CPIV20_VNT_USE_AMT, 0) * 1) 
                  										ELSE
                     										(CASE
                         										WHEN (NVL (YE161070.CPIV20_VNT_USE_AMT, 0) * 1) <= 0 
                         										THEN
                            									0
                         										ELSE     
                            										(  (NVL (AD01.YETA_0C65, 0) * 0.5)
                             										- (SELECT CASE
                                          										WHEN (  NVL (YE161070.CPIV20_ASCT_USE_AMT,0) * 0.1) <
                                                  									(  NVL (AD01.YETA_0C65, 0) * 0.5)
                                          										THEN
                                             										(  NVL (YE161070.CPIV20_ASCT_USE_AMT,0) * 0.1)
                                          										ELSE
                                             										CASE
                                                									WHEN ( (  NVL ( AD01.YETA_0C65,0) * 0.5)) <= 0
                                                									THEN
                                                   										0
                                                									ELSE
                                                   										( (  NVL (AD01.YETA_0C65, 0) * 0.5))
                                             										END
                                       											END
                                  									FROM YE169010 AD01
                                 									WHERE     AD01.SYSTEMKEY = YE161070.SYSTEMKEY
                                       								AND AD01.YRTX_BLGG_YR = YE161070.YRTX_BLGG_YR
                                       								AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD
                                       								AND AD01.DPOB_CD = YE161070.DPOB_CD)
                             										- (SELECT (CASE
                                           										WHEN (  NVL (CPIV20_ASCT_TWO_USE_AMT,0) * 0.1) < 30000000
                                          										THEN
                                              										(CASE
                                                  									WHEN (  NVL (CPIV20_ASCT_TWO_USE_AMT,0) * 0.1) <
                                                          								(  (  NVL (AD01.YETA_0C65,0) * 0.5)
                                                           									- (  NVL (YE161070.CPIV20_ASCT_USE_AMT,0) * 0.1))
                                                  									THEN
                                                     									(  NVL (CPIV20_ASCT_TWO_USE_AMT, 0) * 0.1)
                                                 							 		ELSE
                                                     									(CASE
                                                         								WHEN (  (  NVL (AD01.YETA_0C65,0) * 0.5)
                                                         	      							- (  NVL (YE161070.CPIV20_ASCT_USE_AMT,0) * 0.1)) <= 0
                                                         								THEN
                                                            								0
                                                         								ELSE
                                                            								(  (  NVL (AD01.YETA_0C65,0)* 0.5)
                                                             								- (  NVL (YE161070.CPIV20_ASCT_USE_AMT,0)* 0.1))
                                                      									END)
                                               										END)
                                        										END)
                                  										FROM YE169010 AD01
                                		 								WHERE     AD01.SYSTEMKEY = YE161070.SYSTEMKEY
                                       									AND AD01.YRTX_BLGG_YR = YE161070.YRTX_BLGG_YR
                                       									AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD
                                       									AND AD01.DPOB_CD = YE161070.DPOB_CD))
                      												END)
               													END)
           											WHEN     (NVL (YE161070.CPIV20_VNT_USE_AMT, 0) > 30000000)
                									AND (NVL (YE161070.CPIV20_VNT_USE_AMT, 0) <= 50000000)
           											THEN
              											(CASE
                  										WHEN (NVL (YE161070.CPIV20_VNT_USE_AMT, 0) * 0.7) < (NVL (AD01.YETA_0C65, 0) * 0.5)
                          									- (CASE
                                								WHEN (  NVL (YE161070.CPIV20_ASCT_USE_AMT, 0) * 0.1) < ( (NVL (AD01.YETA_0C65, 0) * 0.5))
                                								THEN
                                   									(  NVL (YE161070.CPIV20_ASCT_USE_AMT, 0) * 0.1)
                                								ELSE
                                  	 								CASE
                                      								WHEN ( (NVL (AD01.YETA_0C65, 0) * 0.5)) <= 0
                                      								THEN
                                         								0
                                      								ELSE
                                         								( (NVL (AD01.YETA_0C65, 0) * 0.5))
                                   									END
                             									END)
                          									- (CASE
                                								WHEN (NVL (CPIV20_ASCT_TWO_USE_AMT, 0) * 0.1) < 30000000
                                								THEN
                                   									(CASE
                                       								WHEN (  NVL (CPIV20_ASCT_TWO_USE_AMT,0) * 0.1) < (  (  NVL (AD01.YETA_0C65, 0) * 0.5)
                                                							- (  NVL ( YE161070.CPIV20_ASCT_USE_AMT, 0) * 0.1))
                                       								THEN
                                          									(  NVL (CPIV20_ASCT_TWO_USE_AMT, 0) * 0.1)
                                       								ELSE
                                          								(CASE
                                              							WHEN (  (  NVL (AD01.YETA_0C65,0) * 0.5)
                                                    							- (  NVL ( YE161070.CPIV20_ASCT_USE_AMT, 0) * 0.1)) <= 0
                                              							THEN
                                                 							0
                                              							ELSE
                                                 							(  (  NVL (AD01.YETA_0C65, 0) * 0.5)
                                                 							 - (  NVL ( YE161070.CPIV20_ASCT_USE_AMT, 0) * 0.1))
                                           								END)
                                   									 END)
                            									 END)
                 											 THEN
                     											(NVL (YE161070.CPIV20_VNT_USE_AMT, 0) * 0.7) 
                  											ELSE
                     											(CASE
                         										WHEN (NVL (YE161070.CPIV20_VNT_USE_AMT, 0) * 0.7) <= 0                      
                        										THEN
                            										0
                         										ELSE     
                            										(  (NVL (AD01.YETA_0C65, 0) * 0.5) - (SELECT CASE
                                          						WHEN (  NVL ( YE161070.CPIV20_ASCT_USE_AMT, 0) * 0.1) < (  NVL (AD01.YETA_0C65, 0) * 0.5)
                                          						THEN
                                             						(  NVL ( YE161070.CPIV20_ASCT_USE_AMT, 0) * 0.1)
                                          						ELSE
                                             						CASE
                                                					WHEN ( (  NVL (AD01.YETA_0C65,0) * 0.5)) <= 0
                                                					THEN
                                                   					0
                                                					ELSE
                                                   						( (  NVL (AD01.YETA_0C65,0) * 0.5))
                                             						END
                                       							END
                                  							FROM YE169010 AD01
                                 							WHERE     AD01.SYSTEMKEY =YE161070.SYSTEMKEY
                                       						AND AD01.YRTX_BLGG_YR =YE161070.YRTX_BLGG_YR
                                       						AND AD01.CLUT_SEPT_CD =YE161070.CLUT_SEPT_CD
                                       						AND AD01.DPOB_CD = YE161070.DPOB_CD)
                             								- (SELECT (CASE
                                           							WHEN (  NVL (CPIV20_ASCT_TWO_USE_AMT,0) * 0.1) < 30000000
                                           							THEN
                                              							(CASE
                                                  						WHEN (  NVL (CPIV20_ASCT_TWO_USE_AMT,0) * 0.1) < (  (  NVL (AD01.YETA_0C65,0) * 0.5)
                                                           					- (  NVL (YE161070.CPIV20_ASCT_USE_AMT,0) * 0.1))
                                                  						THEN
                                                     						(  NVL (CPIV20_ASCT_TWO_USE_AMT,0) * 0.1)
                                                  						ELSE
                                                     						(CASE
                                                     	    				WHEN (  (  NVL (AD01.YETA_0C65,0) * 0.5)
                                                               						- (  NVL (YE161070.CPIV20_ASCT_USE_AMT,0) * 0.1)) <= 0
                                                         					THEN
                                                            					0
                                                         					ELSE
                                                            					(  (  NVL (AD01.YETA_0C65,0) * 0.5) - (  NVL (YE161070.CPIV20_ASCT_USE_AMT,0) * 0.1))
                                                      						END)
                                               							END)
                                        							END)
                                  						FROM YE169010 AD01
                                 						WHERE     AD01.SYSTEMKEY =YE161070.SYSTEMKEY
                                       					AND AD01.YRTX_BLGG_YR =YE161070.YRTX_BLGG_YR
                                       					AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD
                                       					AND AD01.DPOB_CD = YE161070.DPOB_CD))
                      								END)
               									END)
           									ELSE
              									(CASE
                  									WHEN (NVL (YE161070.CPIV20_VNT_USE_AMT, 0) * 0.3) <  (NVL (AD01.YETA_0C65, 0) * 0.5)
                         						 - (CASE
                                						WHEN (  NVL (YE161070.CPIV20_ASCT_USE_AMT, 0) * 0.1) < ( (NVL (AD01.YETA_0C65, 0) * 0.5))
                                						THEN
                                   							(  NVL (YE161070.CPIV20_ASCT_USE_AMT, 0) * 0.1)
                               							ELSE
                                   							CASE
                                      						WHEN ( (NVL (AD01.YETA_0C65, 0) * 0.5)) <= 0
                                      						THEN
                                         						0
                                      						ELSE
                                         						( (NVL (AD01.YETA_0C65, 0) * 0.5))
                                   							END
                             							END)
                          						- (CASE
                                					WHEN (NVL (CPIV20_ASCT_TWO_USE_AMT, 0) * 0.1) < 30000000
                                					THEN
                                   					(CASE
                                       					WHEN (  NVL (CPIV20_ASCT_TWO_USE_AMT,0) * 0.1) < (  (  NVL (AD01.YETA_0C65, 0) * 0.5)
                                                				- (  NVL (YE161070.CPIV20_ASCT_USE_AMT, 0) * 0.1))
                                       					THEN
                                          					(  NVL (CPIV20_ASCT_TWO_USE_AMT, 0) * 0.1)
                                       					ELSE
                                          					(CASE
                                              				WHEN (  (  NVL (AD01.YETA_0C65,0) * 0.5) - (  NVL (YE161070.CPIV20_ASCT_USE_AMT, 0) * 0.1)) <= 0
                                              				THEN
                                                 				0
                                              				ELSE
                                                 				(  (  NVL (AD01.YETA_0C65,0) * 0.5)
                                                  				- (  NVL (YE161070.CPIV20_ASCT_USE_AMT, 0)* 0.1))
                                           					END)
                                    					END)
                             						END)
                 	 							THEN
                     								(NVL (YE161070.CPIV20_VNT_USE_AMT, 0) * 0.3) 
                  								ELSE
                     								(CASE
                         							WHEN (NVL (YE161070.CPIV20_VNT_USE_AMT, 0) * 0.3) <= 0                       
                         							THEN
                           								0
                         							ELSE     
                            							(  (NVL (AD01.YETA_0C65, 0) * 0.5)
                             								- (SELECT CASE
                                          							WHEN (  NVL (YE161070.CPIV20_ASCT_USE_AMT,0) * 0.1) < (  NVL (AD01.YETA_0C65, 0) * 0.5)
                                          							THEN
                                             							(  NVL (YE161070.CPIV20_ASCT_USE_AMT,0) * 0.1)
                                          							ELSE
                                             							CASE
                                                						WHEN ( (  NVL (AD01.YETA_0C65,0) * 0.5)) <= 0
                                                						THEN
                                                   							0
                                                						ELSE
                                                   							( (  NVL (AD01.YETA_0C65,0) * 0.5))
                                             							END
                                       								END
                                  					FROM YE169010 AD01
                                 					WHERE     AD01.SYSTEMKEY = YE161070.SYSTEMKEY
                                       				AND AD01.YRTX_BLGG_YR = YE161070.YRTX_BLGG_YR
                                       				AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD
                                       				AND AD01.DPOB_CD = YE161070.DPOB_CD)
                             				- (SELECT (CASE
                                           				WHEN (  NVL (CPIV20_ASCT_TWO_USE_AMT,0) * 0.1) < 30000000
                                           				THEN
                                              				(CASE
                                                  			WHEN (  NVL (CPIV20_ASCT_TWO_USE_AMT,0) * 0.1) < (  (  NVL (AD01.YETA_0C65,0) * 0.5)
                                                           			- (  NVL (YE161070.CPIV20_ASCT_USE_AMT,0) * 0.1))
                                                  			THEN
                                                     			(  NVL (CPIV20_ASCT_TWO_USE_AMT,0) * 0.1)
                                                 			ELSE
                                                     			(CASE
                                                         		WHEN (  (  NVL (AD01.YETA_0C65,0) * 0.5)
                                                               		- (  NVL (YE161070.CPIV20_ASCT_USE_AMT,0) * 0.1)) <= 0
                                                         		THEN
                                                           		0
                                                         		ELSE
                                                            		(  (  NVL (AD01.YETA_0C65,0) * 0.5)
                                                             		- (  NVL (YE161070.CPIV20_ASCT_USE_AMT,0) * 0.1))
                                                      			END)
                                               				END)
                                        				END)
                                  		FROM YE169010 AD01
                                 		WHERE     AD01.SYSTEMKEY = YE161070.SYSTEMKEY
                                       	AND AD01.YRTX_BLGG_YR = YE161070.YRTX_BLGG_YR
                                       	AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD
                                       	AND AD01.DPOB_CD = YE161070.DPOB_CD))
                      				END)
              					END)
        					END)
  					FROM YE169010 AD01
 					WHERE     AD01.SYSTEMKEY = YE161070.SYSTEMKEY
       				AND AD01.YRTX_BLGG_YR = YE161070.YRTX_BLGG_YR
       				AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD
       				AND AD01.DPOB_CD = YE161070.DPOB_CD
       				)
                    WHERE DPOB_CD=#dpobCd#
                    AND YRTX_BLGG_YR=#yrtxBlggYr#
                    AND CLUT_SEPT_CD=#clutSeptCd#
                    AND SYSTEMKEY=#systemkey#                                       
				]]>
	</update>	   
	   
	   <!-- 기타소득공제 -투자조합출자등소득공제 2021년       -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_17_Update">
		<![CDATA[
			  UPDATE YE161070                                                                                                           
                           SET                                                                                                       
                                 /* 2021년도 이후 출자금액 기타공제_투자조합출자금액_2021년이후 */ 
          CPIV21_ASCT_DDC_AMT     = (
                  SELECT CASE WHEN (NVL(YE161070.CPIV21_ASCT_USE_AMT,0) * 0.1)  <  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))                                       
                                                               THEN (NVL(YE161070.CPIV21_ASCT_USE_AMT,0) * 0.1)                                                                   
                                                               ELSE CASE WHEN ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT)) <= 0 
                                                               THEN 0 ELSE ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))  END          
                                                              END                                                                                                     
                                                      FROM YE169010 AD01                                                                                                    
                                                      WHERE AD01.SYSTEMKEY= YE161070.SYSTEMKEY                                                                      
                                              AND AD01.YRTX_BLGG_YR = YE161070.YRTX_BLGG_YR                                                                               
                                              AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD   
                                              AND AD01.DPOB_CD  = YE161070.DPOB_CD 
                       ), 
         CPIV21_ASCT_TWO_DDC_AMT = (SELECT (CASE
           								WHEN (NVL (CPIV21_ASCT_TWO_USE_AMT, 0) * 0.1) < 30000000
           								THEN
              								(CASE
                  								WHEN (NVL (CPIV21_ASCT_TWO_USE_AMT, 0) * 0.1) <
                          						(  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                           							- (NVL (YE161070.CPIV21_ASCT_USE_AMT, 0) * 0.1))
                  								THEN
                     							(NVL (CPIV21_ASCT_TWO_USE_AMT, 0) * 0.1)
                  								ELSE
                     								(CASE
                         								WHEN (  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                               									- (NVL (YE161070.CPIV21_ASCT_USE_AMT, 0) * 0.1)) <= 0
                         								THEN
                            								0
                         								ELSE
                            								(  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                             									- (NVL (YE161070.CPIV21_ASCT_USE_AMT, 0) * 0.1))
                      								END)
               									END)
        									END)
  											FROM YE169010 AD01
 											WHERE     AD01.SYSTEMKEY = YE161070.SYSTEMKEY
       										AND AD01.YRTX_BLGG_YR = YE161070.YRTX_BLGG_YR
       										AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD
       										AND AD01.DPOB_CD = YE161070.DPOB_CD
       						),              
         CPIV21_VNT_DDC_AMT     = (SELECT (CASE
           									WHEN NVL (YE161070.CPIV21_VNT_USE_AMT, 0) <= 30000000 
           									THEN
              									(CASE
                  								WHEN (NVL (YE161070.CPIV21_VNT_USE_AMT, 0) * 1) < ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                          								- (CASE
                                							WHEN (  NVL (YE161070.CPIV21_ASCT_USE_AMT, 0) * 0.1) < ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                							THEN
                                   								(  NVL (YE161070.CPIV21_ASCT_USE_AMT, 0) * 0.1)
                                							ELSE
                                   								CASE
                                      							WHEN ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT)) <= 0
                                      							THEN
                                         							0
                                      							ELSE
                                         							((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                   								END
                             								END)
                          								- (CASE
                                							WHEN (NVL (CPIV21_ASCT_TWO_USE_AMT, 0) * 0.1) < 30000000
                                							THEN
                                   								(CASE
                                       								WHEN (  NVL (CPIV21_ASCT_TWO_USE_AMT,0) * 0.1) < (  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT)) 
                                       										- (  NVL (YE161070.CPIV21_ASCT_USE_AMT,0) * 0.1))
                                       								THEN
                                          								(  NVL (CPIV21_ASCT_TWO_USE_AMT, 0) * 0.1)
                                       								ELSE
                                          								(CASE
                                              								WHEN (  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                                    								- (  NVL ( YE161070.CPIV21_ASCT_USE_AMT,0) * 0.1)) <= 0
                                              								THEN
                                                 								0
                                              								ELSE
                                                 								(  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                                  									- (  NVL (YE161070.CPIV21_ASCT_USE_AMT,0) * 0.1))
                                           									END)
                                    								END)
                             								END)
                  										THEN
                     										(NVL (YE161070.CPIV21_VNT_USE_AMT, 0) * 1) 
                  										ELSE
                     										(CASE
                         										WHEN (NVL (YE161070.CPIV21_VNT_USE_AMT, 0) * 1) <= 0 
                         										THEN
                            									0
                         										ELSE     
                            										(  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                             										- (SELECT CASE
                                          										WHEN (  NVL (YE161070.CPIV21_ASCT_USE_AMT,0) * 0.1) <
                                                  									((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                          										THEN
                                             										(  NVL (YE161070.CPIV21_ASCT_USE_AMT,0) * 0.1)
                                          										ELSE
                                             										CASE
                                                									WHEN ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT)) <= 0
                                                									THEN
                                                   										0
                                                									ELSE
                                                   										((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                             										END
                                       											END
                                  									FROM YE169010 AD01
                                 									WHERE     AD01.SYSTEMKEY = YE161070.SYSTEMKEY
                                       								AND AD01.YRTX_BLGG_YR = YE161070.YRTX_BLGG_YR
                                       								AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD
                                       								AND AD01.DPOB_CD = YE161070.DPOB_CD)
                             										- (SELECT (CASE
                                           										WHEN (  NVL (CPIV21_ASCT_TWO_USE_AMT,0) * 0.1) < 30000000
                                          										THEN
                                              										(CASE
                                                  									WHEN (  NVL (CPIV21_ASCT_TWO_USE_AMT,0) * 0.1) <
                                                          								(  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                                           									- (  NVL (YE161070.CPIV21_ASCT_USE_AMT,0) * 0.1))
                                                  									THEN
                                                     									(  NVL (CPIV21_ASCT_TWO_USE_AMT, 0) * 0.1)
                                                 							 		ELSE
                                                     									(CASE
                                                         								WHEN (  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                                         	      							- (  NVL (YE161070.CPIV21_ASCT_USE_AMT,0) * 0.1)) <= 0
                                                         								THEN
                                                            								0
                                                         								ELSE
                                                            								(  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                                             								- (  NVL (YE161070.CPIV21_ASCT_USE_AMT,0)* 0.1))
                                                      									END)
                                               										END)
                                        										END)
                                  										FROM YE169010 AD01
                                		 								WHERE     AD01.SYSTEMKEY = YE161070.SYSTEMKEY
                                       									AND AD01.YRTX_BLGG_YR = YE161070.YRTX_BLGG_YR
                                       									AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD
                                       									AND AD01.DPOB_CD = YE161070.DPOB_CD))
                      												END)
               													END)
           											WHEN     (NVL (YE161070.CPIV21_VNT_USE_AMT, 0) > 30000000)
                									AND (NVL (YE161070.CPIV21_VNT_USE_AMT, 0) <= 50000000)
           											THEN
              											(CASE
                  										WHEN (NVL (YE161070.CPIV21_VNT_USE_AMT, 0) * 0.7) < ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                          									- (CASE
                                								WHEN (  NVL (YE161070.CPIV21_ASCT_USE_AMT, 0) * 0.1) < ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                								THEN
                                   									(  NVL (YE161070.CPIV21_ASCT_USE_AMT, 0) * 0.1)
                                								ELSE
                                  	 								CASE
                                      								WHEN ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT)) <= 0
                                      								THEN
                                         								0
                                      								ELSE
                                         								((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                   									END
                             									END)
                          									- (CASE
                                								WHEN (NVL (CPIV21_ASCT_TWO_USE_AMT, 0) * 0.1) < 30000000
                                								THEN
                                   									(CASE
                                       								WHEN (  NVL (CPIV21_ASCT_TWO_USE_AMT,0) * 0.1) < (  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                                							- (  NVL ( YE161070.CPIV21_ASCT_USE_AMT, 0) * 0.1))
                                       								THEN
                                          									(  NVL (CPIV21_ASCT_TWO_USE_AMT, 0) * 0.1)
                                       								ELSE
                                          								(CASE
                                              							WHEN (  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                                    							- (  NVL ( YE161070.CPIV21_ASCT_USE_AMT, 0) * 0.1)) <= 0
                                              							THEN
                                                 							0
                                              							ELSE
                                                 							(  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                                 							 - (  NVL ( YE161070.CPIV21_ASCT_USE_AMT, 0) * 0.1))
                                           								END)
                                   									 END)
                            									 END)
                 											 THEN
                     											(NVL (YE161070.CPIV21_VNT_USE_AMT, 0) * 0.7) 
                  											ELSE
                     											(CASE
                         										WHEN (NVL (YE161070.CPIV21_VNT_USE_AMT, 0) * 0.7) <= 0                      
                        										THEN
                            										0
                         										ELSE     
                            										(  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT)) - (SELECT CASE
                                          						WHEN (  NVL ( YE161070.CPIV21_ASCT_USE_AMT, 0) * 0.1) < ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                          						THEN
                                             						(  NVL ( YE161070.CPIV21_ASCT_USE_AMT, 0) * 0.1)
                                          						ELSE
                                             						CASE
                                                					WHEN ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT)) <= 0
                                                					THEN
                                                   					0
                                                					ELSE
                                                   						((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                             						END
                                       							END
                                  							FROM YE169010 AD01
                                 							WHERE     AD01.SYSTEMKEY =YE161070.SYSTEMKEY
                                       						AND AD01.YRTX_BLGG_YR =YE161070.YRTX_BLGG_YR
                                       						AND AD01.CLUT_SEPT_CD =YE161070.CLUT_SEPT_CD
                                       						AND AD01.DPOB_CD = YE161070.DPOB_CD)
                             								- (SELECT (CASE
                                           							WHEN (  NVL (CPIV21_ASCT_TWO_USE_AMT,0) * 0.1) < 30000000
                                           							THEN
                                              							(CASE
                                                  						WHEN (  NVL (CPIV21_ASCT_TWO_USE_AMT,0) * 0.1) < (  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                                           					- (  NVL (YE161070.CPIV21_ASCT_USE_AMT,0) * 0.1))
                                                  						THEN
                                                     						(  NVL (CPIV21_ASCT_TWO_USE_AMT,0) * 0.1)
                                                  						ELSE
                                                     						(CASE
                                                     	    				WHEN (  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                                               						- (  NVL (YE161070.CPIV21_ASCT_USE_AMT,0) * 0.1)) <= 0
                                                         					THEN
                                                            					0
                                                         					ELSE
                                                            					(  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT)) - (  NVL (YE161070.CPIV21_ASCT_USE_AMT,0) * 0.1))
                                                      						END)
                                               							END)
                                        							END)
                                  						FROM YE169010 AD01
                                 						WHERE     AD01.SYSTEMKEY =YE161070.SYSTEMKEY
                                       					AND AD01.YRTX_BLGG_YR =YE161070.YRTX_BLGG_YR
                                       					AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD
                                       					AND AD01.DPOB_CD = YE161070.DPOB_CD))
                      								END)
               									END)
           									ELSE
              									(CASE
                  									WHEN (NVL (YE161070.CPIV21_VNT_USE_AMT, 0) * 0.3) <  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                         						 - (CASE
                                						WHEN (  NVL (YE161070.CPIV21_ASCT_USE_AMT, 0) * 0.1) < ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                						THEN
                                   							(  NVL (YE161070.CPIV21_ASCT_USE_AMT, 0) * 0.1)
                               							ELSE
                                   							CASE
                                      						WHEN ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT)) <= 0
                                      						THEN
                                         						0
                                      						ELSE
                                         						((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                   							END
                             							END)
                          						- (CASE
                                					WHEN (NVL (CPIV21_ASCT_TWO_USE_AMT, 0) * 0.1) < 30000000
                                					THEN
                                   					(CASE
                                       					WHEN (  NVL (CPIV21_ASCT_TWO_USE_AMT,0) * 0.1) < (  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                                				- (  NVL (YE161070.CPIV21_ASCT_USE_AMT, 0) * 0.1))
                                       					THEN
                                          					(  NVL (CPIV21_ASCT_TWO_USE_AMT, 0) * 0.1)
                                       					ELSE
                                          					(CASE
                                              				WHEN (  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT)) - (  NVL (YE161070.CPIV21_ASCT_USE_AMT, 0) * 0.1)) <= 0
                                              				THEN
                                                 				0
                                              				ELSE
                                                 				(  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                                  				- (  NVL (YE161070.CPIV21_ASCT_USE_AMT, 0)* 0.1))
                                           					END)
                                    					END)
                             						END)
                 	 							THEN
                     								(NVL (YE161070.CPIV21_VNT_USE_AMT, 0) * 0.3) 
                  								ELSE
                     								(CASE
                         							WHEN (NVL (YE161070.CPIV21_VNT_USE_AMT, 0) * 0.3) <= 0                       
                         							THEN
                           								0
                         							ELSE     
                            							(  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                             								- (SELECT CASE
                                          							WHEN (  NVL (YE161070.CPIV21_ASCT_USE_AMT,0) * 0.1) < ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                          							THEN
                                             							(  NVL (YE161070.CPIV21_ASCT_USE_AMT,0) * 0.1)
                                          							ELSE
                                             							CASE
                                                						WHEN ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT)) <= 0
                                                						THEN
                                                   							0
                                                						ELSE
                                                   							((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                             							END
                                       								END
                                  					FROM YE169010 AD01
                                 					WHERE     AD01.SYSTEMKEY = YE161070.SYSTEMKEY
                                       				AND AD01.YRTX_BLGG_YR = YE161070.YRTX_BLGG_YR
                                       				AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD
                                       				AND AD01.DPOB_CD = YE161070.DPOB_CD)
                             				- (SELECT (CASE
                                           				WHEN (  NVL (CPIV21_ASCT_TWO_USE_AMT,0) * 0.1) < 30000000
                                           				THEN
                                              				(CASE
                                                  			WHEN (  NVL (CPIV21_ASCT_TWO_USE_AMT,0) * 0.1) < (  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                                           			- (  NVL (YE161070.CPIV21_ASCT_USE_AMT,0) * 0.1))
                                                  			THEN
                                                     			(  NVL (CPIV21_ASCT_TWO_USE_AMT,0) * 0.1)
                                                 			ELSE
                                                     			(CASE
                                                         		WHEN (  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                                               		- (  NVL (YE161070.CPIV21_ASCT_USE_AMT,0) * 0.1)) <= 0
                                                         		THEN
                                                           		0
                                                         		ELSE
                                                            		(  ((NVL (AD01.YETA_0C65, 0) * 0.5)- (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT+ CPIV20_VNT_DDC_AMT))
                                                             		- (  NVL (YE161070.CPIV21_ASCT_USE_AMT,0) * 0.1))
                                                      			END)
                                               				END)
                                        				END)
                                  		FROM YE169010 AD01
                                 		WHERE     AD01.SYSTEMKEY = YE161070.SYSTEMKEY
                                       	AND AD01.YRTX_BLGG_YR = YE161070.YRTX_BLGG_YR
                                       	AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD
                                       	AND AD01.DPOB_CD = YE161070.DPOB_CD))
                      				END)
              					END)
        					END)
  					FROM YE169010 AD01
 					WHERE     AD01.SYSTEMKEY = YE161070.SYSTEMKEY
       				AND AD01.YRTX_BLGG_YR = YE161070.YRTX_BLGG_YR
       				AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD
       				AND AD01.DPOB_CD = YE161070.DPOB_CD
       				)
                    WHERE DPOB_CD=#dpobCd#
                    AND YRTX_BLGG_YR=#yrtxBlggYr#
                    AND CLUT_SEPT_CD=#clutSeptCd#
                    AND SYSTEMKEY=#systemkey#                                      
				]]>
	</update>   
	   
	   <!-- 기타소득공제 -투자조합출자등소득공제 2022년       -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_18_Update">
		<![CDATA[
			  UPDATE YE161070                                                                                                           
                           SET                                                                                                       
                                 /* 2022년도 이후 출자금액 기타공제_투자조합출자금액_2022년이후 */ 
          CPIV22_ASCT_DDC_AMT     = (
                  SELECT CASE WHEN (NVL(YE161070.CPIV22_ASCT_USE_AMT,0) * 0.1)  <  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))                                       
                                                               THEN (NVL(YE161070.CPIV22_ASCT_USE_AMT,0) * 0.1)                                                                   
                                                               ELSE CASE WHEN ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT)) <= 0 
                                                               THEN 0 ELSE ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))  END          
                                                              END                                                                                                     
                                                      FROM YE169010 AD01                                                                                                    
                                                      WHERE AD01.SYSTEMKEY= YE161070.SYSTEMKEY                                                                      
                                              AND AD01.YRTX_BLGG_YR = YE161070.YRTX_BLGG_YR                                                                               
                                              AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD   
                                              AND AD01.DPOB_CD  = YE161070.DPOB_CD 
                       ), 
         CPIV22_ASCT_TWO_DDC_AMT = (SELECT (CASE
           								WHEN (NVL (CPIV22_ASCT_TWO_USE_AMT, 0) * 0.1) < 30000000
           								THEN
              								(CASE
                  								WHEN (NVL (CPIV22_ASCT_TWO_USE_AMT, 0) * 0.1) <
                          						(  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                           							- (NVL (YE161070.CPIV22_ASCT_USE_AMT, 0) * 0.1))
                  								THEN
                     							(NVL (CPIV22_ASCT_TWO_USE_AMT, 0) * 0.1)
                  								ELSE
                     								(CASE
                         								WHEN (  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                               									- (NVL (YE161070.CPIV21_ASCT_USE_AMT, 0) * 0.1)) <= 0
                         								THEN
                            								0
                         								ELSE
                            								(  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                             									- (NVL (YE161070.CPIV22_ASCT_USE_AMT, 0) * 0.1))
                      								END)
               									END)
        									END)
  											FROM YE169010 AD01
 											WHERE     AD01.SYSTEMKEY = YE161070.SYSTEMKEY
       										AND AD01.YRTX_BLGG_YR = YE161070.YRTX_BLGG_YR
       										AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD
       										AND AD01.DPOB_CD = YE161070.DPOB_CD
       						),              
         CPIV22_VNT_DDC_AMT     = (SELECT (CASE
           									WHEN NVL (YE161070.CPIV22_VNT_USE_AMT, 0) <= 30000000 
           									THEN
              									(CASE
                  								WHEN (NVL (YE161070.CPIV22_VNT_USE_AMT, 0) * 1) < ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                          								- (CASE
                                							WHEN (  NVL (YE161070.CPIV22_ASCT_USE_AMT, 0) * 0.1) < ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                							THEN
                                   								(  NVL (YE161070.CPIV22_ASCT_USE_AMT, 0) * 0.1)
                                							ELSE
                                   								CASE
                                      							WHEN ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT)) <= 0
                                      							THEN
                                         							0
                                      							ELSE
                                         							((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                   								END
                             								END)
                          								- (CASE
                                							WHEN (NVL (CPIV22_ASCT_TWO_USE_AMT, 0) * 0.1) < 30000000
                                							THEN
                                   								(CASE
                                       								WHEN (  NVL (CPIV22_ASCT_TWO_USE_AMT,0) * 0.1) < (  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT)) 
                                       										- (  NVL (YE161070.CPIV22_ASCT_USE_AMT,0) * 0.1))
                                       								THEN
                                          								(  NVL (CPIV22_ASCT_TWO_USE_AMT, 0) * 0.1)
                                       								ELSE
                                          								(CASE
                                              								WHEN (  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                                    								- (  NVL ( YE161070.CPIV22_ASCT_USE_AMT,0) * 0.1)) <= 0
                                              								THEN
                                                 								0
                                              								ELSE
                                                 								(  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                                  									- (  NVL (YE161070.CPIV22_ASCT_USE_AMT,0) * 0.1))
                                           									END)
                                    								END)
                             								END)
                  										THEN
                     										(NVL (YE161070.CPIV22_VNT_USE_AMT, 0) * 1) 
                  										ELSE
                     										(CASE
                         										WHEN (NVL (YE161070.CPIV22_VNT_USE_AMT, 0) * 1) <= 0 
                         										THEN
                            									0
                         										ELSE     
                            										(  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                             										- (SELECT CASE
                                          										WHEN (  NVL (YE161070.CPIV22_ASCT_USE_AMT,0) * 0.1) <
                                                  									((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                          										THEN
                                             										(  NVL (YE161070.CPIV22_ASCT_USE_AMT,0) * 0.1)
                                          										ELSE
                                             										CASE
                                                									WHEN ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT)) <= 0
                                                									THEN
                                                   										0
                                                									ELSE
                                                   										((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                             										END
                                       											END
                                  									FROM YE169010 AD01
                                 									WHERE     AD01.SYSTEMKEY = YE161070.SYSTEMKEY
                                       								AND AD01.YRTX_BLGG_YR = YE161070.YRTX_BLGG_YR
                                       								AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD
                                       								AND AD01.DPOB_CD = YE161070.DPOB_CD)
                             										- (SELECT (CASE
                                           										WHEN (  NVL (CPIV22_ASCT_TWO_USE_AMT,0) * 0.1) < 30000000
                                          										THEN
                                              										(CASE
                                                  									WHEN (  NVL (CPIV22_ASCT_TWO_USE_AMT,0) * 0.1) <
                                                          								(  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                                           									- (  NVL (YE161070.CPIV22_ASCT_USE_AMT,0) * 0.1))
                                                  									THEN
                                                     									(  NVL (CPIV22_ASCT_TWO_USE_AMT, 0) * 0.1)
                                                 							 		ELSE
                                                     									(CASE
                                                         								WHEN (  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                                         	      							- (  NVL (YE161070.CPIV22_ASCT_USE_AMT,0) * 0.1)) <= 0
                                                         								THEN
                                                            								0
                                                         								ELSE
                                                            								(  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                                             								- (  NVL (YE161070.CPIV22_ASCT_USE_AMT,0)* 0.1))
                                                      									END)
                                               										END)
                                        										END)
                                  										FROM YE169010 AD01
                                		 								WHERE     AD01.SYSTEMKEY = YE161070.SYSTEMKEY
                                       									AND AD01.YRTX_BLGG_YR = YE161070.YRTX_BLGG_YR
                                       									AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD
                                       									AND AD01.DPOB_CD = YE161070.DPOB_CD))
                      												END)
               													END)
           											WHEN     (NVL (YE161070.CPIV22_VNT_USE_AMT, 0) > 30000000)
                									AND (NVL (YE161070.CPIV22_VNT_USE_AMT, 0) <= 50000000)
           											THEN
              											(CASE
                  										WHEN (NVL (YE161070.CPIV22_VNT_USE_AMT, 0) * 0.7) < ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                          									- (CASE
                                								WHEN (  NVL (YE161070.CPIV22_ASCT_USE_AMT, 0) * 0.1) < ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                								THEN
                                   									(  NVL (YE161070.CPIV22_ASCT_USE_AMT, 0) * 0.1)
                                								ELSE
                                  	 								CASE
                                      								WHEN ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT)) <= 0
                                      								THEN
                                         								0
                                      								ELSE
                                         								((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                   									END
                             									END)
                          									- (CASE
                                								WHEN (NVL (CPIV22_ASCT_TWO_USE_AMT, 0) * 0.1) < 30000000
                                								THEN
                                   									(CASE
                                       								WHEN (  NVL (CPIV22_ASCT_TWO_USE_AMT,0) * 0.1) < (  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                                							- (  NVL ( YE161070.CPIV22_ASCT_USE_AMT, 0) * 0.1))
                                       								THEN
                                          									(  NVL (CPIV22_ASCT_TWO_USE_AMT, 0) * 0.1)
                                       								ELSE
                                          								(CASE
                                              							WHEN (  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                                    							- (  NVL ( YE161070.CPIV22_ASCT_USE_AMT, 0) * 0.1)) <= 0
                                              							THEN
                                                 							0
                                              							ELSE
                                                 							(  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                                 							 - (  NVL ( YE161070.CPIV22_ASCT_USE_AMT, 0) * 0.1))
                                           								END)
                                   									 END)
                            									 END)
                 											 THEN
                     											(NVL (YE161070.CPIV22_VNT_USE_AMT, 0) * 0.7) 
                  											ELSE
                     											(CASE
                         										WHEN (NVL (YE161070.CPIV22_VNT_USE_AMT, 0) * 0.7) <= 0                      
                        										THEN
                            										0
                         										ELSE     
                            										(  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT)) - (SELECT CASE
                                          						WHEN (  NVL ( YE161070.CPIV22_ASCT_USE_AMT, 0) * 0.1) < ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                          						THEN
                                             						(  NVL ( YE161070.CPIV22_ASCT_USE_AMT, 0) * 0.1)
                                          						ELSE
                                             						CASE
                                                					WHEN ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT)) <= 0
                                                					THEN
                                                   					0
                                                					ELSE
                                                   						((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                             						END
                                       							END
                                  							FROM YE169010 AD01
                                 							WHERE     AD01.SYSTEMKEY =YE161070.SYSTEMKEY
                                       						AND AD01.YRTX_BLGG_YR =YE161070.YRTX_BLGG_YR
                                       						AND AD01.CLUT_SEPT_CD =YE161070.CLUT_SEPT_CD
                                       						AND AD01.DPOB_CD = YE161070.DPOB_CD)
                             								- (SELECT (CASE
                                           							WHEN (  NVL (CPIV22_ASCT_TWO_USE_AMT,0) * 0.1) < 30000000
                                           							THEN
                                              							(CASE
                                                  						WHEN (  NVL (CPIV22_ASCT_TWO_USE_AMT,0) * 0.1) < (  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                                           					- (  NVL (YE161070.CPIV22_ASCT_USE_AMT,0) * 0.1))
                                                  						THEN
                                                     						(  NVL (CPIV22_ASCT_TWO_USE_AMT,0) * 0.1)
                                                  						ELSE
                                                     						(CASE
                                                     	    				WHEN (  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                                               						- (  NVL (YE161070.CPIV21_ASCT_USE_AMT,0) * 0.1)) <= 0
                                                         					THEN
                                                            					0
                                                         					ELSE
                                                            					(  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT)) - (  NVL (YE161070.CPIV22_ASCT_USE_AMT,0) * 0.1))
                                                      						END)
                                               							END)
                                        							END)
                                  						FROM YE169010 AD01
                                 						WHERE     AD01.SYSTEMKEY =YE161070.SYSTEMKEY
                                       					AND AD01.YRTX_BLGG_YR =YE161070.YRTX_BLGG_YR
                                       					AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD
                                       					AND AD01.DPOB_CD = YE161070.DPOB_CD))
                      								END)
               									END)
           									ELSE
              									(CASE
                  									WHEN (NVL (YE161070.CPIV22_VNT_USE_AMT, 0) * 0.3) <  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                         						 - (CASE
                                						WHEN (  NVL (YE161070.CPIV22_ASCT_USE_AMT, 0) * 0.1) < ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                						THEN
                                   							(  NVL (YE161070.CPIV22_ASCT_USE_AMT, 0) * 0.1)
                               							ELSE
                                   							CASE
                                      						WHEN ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT)) <= 0
                                      						THEN
                                         						0
                                      						ELSE
                                         						((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                   							END
                             							END)
                          						- (CASE
                                					WHEN (NVL (CPIV22_ASCT_TWO_USE_AMT, 0) * 0.1) < 30000000
                                					THEN
                                   					(CASE
                                       					WHEN (  NVL (CPIV22_ASCT_TWO_USE_AMT,0) * 0.1) < (  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                                				- (  NVL (YE161070.CPIV22_ASCT_USE_AMT, 0) * 0.1))
                                       					THEN
                                          					(  NVL (CPIV22_ASCT_TWO_USE_AMT, 0) * 0.1)
                                       					ELSE
                                          					(CASE
                                              				WHEN (  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT)) - (  NVL (YE161070.CPIV22_ASCT_USE_AMT, 0) * 0.1)) <= 0
                                              				THEN
                                                 				0
                                              				ELSE
                                                 				(  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                                  				- (  NVL (YE161070.CPIV22_ASCT_USE_AMT, 0)* 0.1))
                                           					END)
                                    					END)
                             						END)
                 	 							THEN
                     								(NVL (YE161070.CPIV22_VNT_USE_AMT, 0) * 0.3) 
                  								ELSE
                     								(CASE
                         							WHEN (NVL (YE161070.CPIV22_VNT_USE_AMT, 0) * 0.3) <= 0                       
                         							THEN
                           								0
                         							ELSE     
                            							(  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                             								- (SELECT CASE
                                          							WHEN (  NVL (YE161070.CPIV22_ASCT_USE_AMT,0) * 0.1) < ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                          							THEN
                                             							(  NVL (YE161070.CPIV22_ASCT_USE_AMT,0) * 0.1)
                                          							ELSE
                                             							CASE
                                                						WHEN ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT)) <= 0
                                                						THEN
                                                   							0
                                                						ELSE
                                                   							((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                             							END
                                       								END
                                  					FROM YE169010 AD01
                                 					WHERE     AD01.SYSTEMKEY = YE161070.SYSTEMKEY
                                       				AND AD01.YRTX_BLGG_YR = YE161070.YRTX_BLGG_YR
                                       				AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD
                                       				AND AD01.DPOB_CD = YE161070.DPOB_CD)
                             				- (SELECT (CASE
                                           				WHEN (  NVL (CPIV22_ASCT_TWO_USE_AMT,0) * 0.1) < 30000000
                                           				THEN
                                              				(CASE
                                                  			WHEN (  NVL (CPIV22_ASCT_TWO_USE_AMT,0) * 0.1) < (  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                                           			- (  NVL (YE161070.CPIV22_ASCT_USE_AMT,0) * 0.1))
                                                  			THEN
                                                     			(  NVL (CPIV22_ASCT_TWO_USE_AMT,0) * 0.1)
                                                 			ELSE
                                                     			(CASE
                                                         		WHEN (  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                                               		- (  NVL (YE161070.CPIV22_ASCT_USE_AMT,0) * 0.1)) <= 0
                                                         		THEN
                                                           		0
                                                         		ELSE
                                                            		(  ((NVL (AD01.YETA_0C65, 0) * 0.5) - (CPIV20_ASCT_DDC_AMT + CPIV20_ASCT_TWO_DDC_AMT + CPIV20_VNT_DDC_AMT + CPIV21_ASCT_DDC_AMT + CPIV21_ASCT_TWO_DDC_AMT + CPIV21_VNT_DDC_AMT))
                                                             		- (  NVL (YE161070.CPIV22_ASCT_USE_AMT,0) * 0.1))
                                                      			END)
                                               				END)
                                        				END)
                                  		FROM YE169010 AD01
                                 		WHERE     AD01.SYSTEMKEY = YE161070.SYSTEMKEY
                                       	AND AD01.YRTX_BLGG_YR = YE161070.YRTX_BLGG_YR
                                       	AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD
                                       	AND AD01.DPOB_CD = YE161070.DPOB_CD))
                      				END)
              					END)
        					END)
  					FROM YE169010 AD01
 					WHERE     AD01.SYSTEMKEY = YE161070.SYSTEMKEY
       				AND AD01.YRTX_BLGG_YR = YE161070.YRTX_BLGG_YR
       				AND AD01.CLUT_SEPT_CD = YE161070.CLUT_SEPT_CD
       				AND AD01.DPOB_CD = YE161070.DPOB_CD
       				)
                    WHERE DPOB_CD=#dpobCd#
                    AND YRTX_BLGG_YR=#yrtxBlggYr#
                    AND CLUT_SEPT_CD=#clutSeptCd#
                    AND SYSTEMKEY=#systemkey#                                      
				]]>
	</update>   
	
	
	<update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_18_1_Update">
	<![CDATA[
	DECLARE BEGIN 
            
			  UPDATE PDF_G107Y A                                                                                                                                                                                    
                SET    
                	A.USE_PLACE_CD = '1'                                                                                                        
			    WHERE 
			    	(SELECT B.YETA_0C63 FROM YE169010 B 
						WHERE B.DPOB_CD = A.DPOB_CD 
						AND B.YRTX_BLGG_YR = A.YRTX_BLGG_YR 
						AND B.CLUT_SEPT_CD = A.CLUT_SEPT_CD
						AND B.SYSTEMKEY = A.SYSTEMKEY
					) > 70000000
				AND A.DPOB_CD=#dpobCd#
                AND A.YRTX_BLGG_YR=#yrtxBlggYr#
                AND A.CLUT_SEPT_CD=#clutSeptCd#
                AND A.SYSTEMKEY=#systemkey# 
                AND A.USE_PLACE_CD = '4';   
                
                
               UPDATE PDF_G207Y A                                                                                                                                                                                    
                SET    
                	A.USE_PLACE_CD = '1'                                                                                                        
			    WHERE 
			    	(SELECT B.YETA_0C63 FROM YE169010 B 
						WHERE B.DPOB_CD = A.DPOB_CD 
						AND B.YRTX_BLGG_YR = A.YRTX_BLGG_YR 
						AND B.CLUT_SEPT_CD = A.CLUT_SEPT_CD
						AND B.SYSTEMKEY = A.SYSTEMKEY
					) > 70000000
				AND A.DPOB_CD=#dpobCd#
                AND A.YRTX_BLGG_YR=#yrtxBlggYr#
                AND A.CLUT_SEPT_CD=#clutSeptCd#
                AND A.SYSTEMKEY=#systemkey# 
                AND A.USE_PLACE_CD = '4';
               
               
               UPDATE PDF_G307Y A                                                                                                                                                                                    
                SET    
                	A.USE_PLACE_CD = '1'                                                                                                        
			    WHERE 
			    	(SELECT B.YETA_0C63 FROM YE169010 B 
						WHERE B.DPOB_CD = A.DPOB_CD 
						AND B.YRTX_BLGG_YR = A.YRTX_BLGG_YR 
						AND B.CLUT_SEPT_CD = A.CLUT_SEPT_CD
						AND B.SYSTEMKEY = A.SYSTEMKEY
					) > 70000000
				AND A.DPOB_CD=#dpobCd#
                AND A.YRTX_BLGG_YR=#yrtxBlggYr#
                AND A.CLUT_SEPT_CD=#clutSeptCd#
                AND A.SYSTEMKEY=#systemkey# 
                AND A.USE_PLACE_CD = '4';
                
               UPDATE PDF_G407Y A                                                                                                                                                                                    
                SET    
                	A.USE_PLACE_CD = '1'                                                                                                        
			    WHERE 
			    	(SELECT B.YETA_0C63 FROM YE169010 B 
						WHERE B.DPOB_CD = A.DPOB_CD 
						AND B.YRTX_BLGG_YR = A.YRTX_BLGG_YR 
						AND B.CLUT_SEPT_CD = A.CLUT_SEPT_CD
						AND B.SYSTEMKEY = A.SYSTEMKEY
					) > 70000000
				AND A.DPOB_CD=#dpobCd#
                AND A.YRTX_BLGG_YR=#yrtxBlggYr#
                AND A.CLUT_SEPT_CD=#clutSeptCd#
                AND A.SYSTEMKEY=#systemkey# 
                AND A.USE_PLACE_CD = '4';
                                 
			  
                            
               
END; 
	
	]]>
	</update>  
	
	
	
	
	<update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_18_2_Update">
	<![CDATA[
	DECLARE BEGIN 
            
			  UPDATE PDF_G107M A
				SET 
					A.GNRL_SUM = NVL(A.GNRL_SUM,0) + NVL(A.ISLD_SUM,0), 
					A.TFHY_GNRL_SUM = NVL(A.TFHY_GNRL_SUM,0) + NVL(A.TFHY_ISLD_SUM,0),
					A.SHFY_GNRL_SUM = NVL(A.SHFY_GNRL_SUM,0) + NVL(A.SHFY_ISLD_SUM,0)
				WHERE 
					(SELECT B.YETA_0C63 FROM YE169010 B 
						WHERE B.DPOB_CD = A.DPOB_CD 
						AND B.YRTX_BLGG_YR = A.YRTX_BLGG_YR 
						AND B.CLUT_SEPT_CD = A.CLUT_SEPT_CD
						AND B.SYSTEMKEY = A.SYSTEMKEY
					) > 70000000
					AND A.DPOB_CD=#dpobCd#
                	AND A.YRTX_BLGG_YR=#yrtxBlggYr#
                	AND A.CLUT_SEPT_CD=#clutSeptCd#
                	AND A.SYSTEMKEY=#systemkey# ; 
                
                
               UPDATE PDF_G207M A
				SET 
					A.GNRL_SUM = NVL(A.GNRL_SUM,0) + NVL(A.ISLD_SUM,0), 
					A.TFHY_GNRL_SUM = NVL(A.TFHY_GNRL_SUM,0) + NVL(A.TFHY_ISLD_SUM,0),
					A.SHFY_GNRL_SUM = NVL(A.SHFY_GNRL_SUM,0) + NVL(A.SHFY_ISLD_SUM,0)
				WHERE 
					(SELECT B.YETA_0C63 FROM YE169010 B 
						WHERE B.DPOB_CD = A.DPOB_CD 
						AND B.YRTX_BLGG_YR = A.YRTX_BLGG_YR 
						AND B.CLUT_SEPT_CD = A.CLUT_SEPT_CD
						AND B.SYSTEMKEY = A.SYSTEMKEY
					) > 70000000
					AND A.DPOB_CD=#dpobCd#
                	AND A.YRTX_BLGG_YR=#yrtxBlggYr#
                	AND A.CLUT_SEPT_CD=#clutSeptCd#
                	AND A.SYSTEMKEY=#systemkey# ; 
               
               
               UPDATE PDF_G307M A
				SET 
					A.GNRL_SUM = NVL(A.GNRL_SUM,0) + NVL(A.ISLD_SUM,0), 
					A.TFHY_GNRL_SUM = NVL(A.TFHY_GNRL_SUM,0) + NVL(A.TFHY_ISLD_SUM,0),
					A.SHFY_GNRL_SUM = NVL(A.SHFY_GNRL_SUM,0) + NVL(A.SHFY_ISLD_SUM,0)
				WHERE 
					(SELECT B.YETA_0C63 FROM YE169010 B 
						WHERE B.DPOB_CD = A.DPOB_CD 
						AND B.YRTX_BLGG_YR = A.YRTX_BLGG_YR 
						AND B.CLUT_SEPT_CD = A.CLUT_SEPT_CD
						AND B.SYSTEMKEY = A.SYSTEMKEY
					) > 70000000
					AND A.DPOB_CD=#dpobCd#
                	AND A.YRTX_BLGG_YR=#yrtxBlggYr#
                	AND A.CLUT_SEPT_CD=#clutSeptCd#
                	AND A.SYSTEMKEY=#systemkey# ; 
                
               UPDATE PDF_G407M A
				SET 
					A.GNRL_SUM = NVL(A.GNRL_SUM,0) + NVL(A.ISLD_SUM,0), 
					A.TFHY_GNRL_SUM = NVL(A.TFHY_GNRL_SUM,0) + NVL(A.TFHY_ISLD_SUM,0),
					A.SHFY_GNRL_SUM = NVL(A.SHFY_GNRL_SUM,0) + NVL(A.SHFY_ISLD_SUM,0)
				WHERE 
					(SELECT B.YETA_0C63 FROM YE169010 B 
						WHERE B.DPOB_CD = A.DPOB_CD 
						AND B.YRTX_BLGG_YR = A.YRTX_BLGG_YR 
						AND B.CLUT_SEPT_CD = A.CLUT_SEPT_CD
						AND B.SYSTEMKEY = A.SYSTEMKEY
					) > 70000000
					AND A.DPOB_CD=#dpobCd#
                	AND A.YRTX_BLGG_YR=#yrtxBlggYr#
                	AND A.CLUT_SEPT_CD=#clutSeptCd#
                	AND A.SYSTEMKEY=#systemkey# ; 
                                 
			  
                            
               
END; 
	
	]]>
	</update>  
	
	
	
	
	<update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_18_3_Update">
	<![CDATA[
	DECLARE BEGIN 
            
			  UPDATE PDF_G107M A
				SET 
					A.ISLD_SUM = 0, 
					A.TFHY_ISLD_SUM = 0,
					A.SHFY_ISLD_SUM = 0
				WHERE 
					(SELECT B.YETA_0C63 FROM YE169010 B 
						WHERE B.DPOB_CD = A.DPOB_CD 
						AND B.YRTX_BLGG_YR = A.YRTX_BLGG_YR 
						AND B.CLUT_SEPT_CD = A.CLUT_SEPT_CD
						AND B.SYSTEMKEY = A.SYSTEMKEY
					) > 70000000
					AND A.DPOB_CD=#dpobCd#
                	AND A.YRTX_BLGG_YR=#yrtxBlggYr#
                	AND A.CLUT_SEPT_CD=#clutSeptCd#
                	AND A.SYSTEMKEY=#systemkey# ; 
                
                
               UPDATE PDF_G207M A
				SET 
					A.ISLD_SUM = 0, 
					A.TFHY_ISLD_SUM = 0,
					A.SHFY_ISLD_SUM = 0
				WHERE 
					(SELECT B.YETA_0C63 FROM YE169010 B 
						WHERE B.DPOB_CD = A.DPOB_CD 
						AND B.YRTX_BLGG_YR = A.YRTX_BLGG_YR 
						AND B.CLUT_SEPT_CD = A.CLUT_SEPT_CD
						AND B.SYSTEMKEY = A.SYSTEMKEY
					) > 70000000
					AND A.DPOB_CD=#dpobCd#
                	AND A.YRTX_BLGG_YR=#yrtxBlggYr#
                	AND A.CLUT_SEPT_CD=#clutSeptCd#
                	AND A.SYSTEMKEY=#systemkey# ; 
               
               
               UPDATE PDF_G307M A
				SET 
					A.ISLD_SUM = 0, 
					A.TFHY_ISLD_SUM = 0,
					A.SHFY_ISLD_SUM = 0
				WHERE 
					(SELECT B.YETA_0C63 FROM YE169010 B 
						WHERE B.DPOB_CD = A.DPOB_CD 
						AND B.YRTX_BLGG_YR = A.YRTX_BLGG_YR 
						AND B.CLUT_SEPT_CD = A.CLUT_SEPT_CD
						AND B.SYSTEMKEY = A.SYSTEMKEY
					) > 70000000
					AND A.DPOB_CD=#dpobCd#
                	AND A.YRTX_BLGG_YR=#yrtxBlggYr#
                	AND A.CLUT_SEPT_CD=#clutSeptCd#
                	AND A.SYSTEMKEY=#systemkey# ; 
                
               UPDATE PDF_G407M A
				SET 
					A.ISLD_SUM = 0, 
					A.TFHY_ISLD_SUM = 0,
					A.SHFY_ISLD_SUM = 0
				WHERE 
					(SELECT B.YETA_0C63 FROM YE169010 B 
						WHERE B.DPOB_CD = A.DPOB_CD 
						AND B.YRTX_BLGG_YR = A.YRTX_BLGG_YR 
						AND B.CLUT_SEPT_CD = A.CLUT_SEPT_CD
						AND B.SYSTEMKEY = A.SYSTEMKEY
					) > 70000000
					AND A.DPOB_CD=#dpobCd#
                	AND A.YRTX_BLGG_YR=#yrtxBlggYr#
                	AND A.CLUT_SEPT_CD=#clutSeptCd#
                	AND A.SYSTEMKEY=#systemkey# ; 
                                 
			  
                            
               
END; 
	
	]]>
	</update>  
	
	
	
	<update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_18_4_Update">
	<![CDATA[
		   UPDATE YE161040 AA  
			  SET 
			   
			  
			  CRDC_DDC_TRGT_AMT=NVL((SELECT SUM(NVL(CARD_AMT_SUM,0))
			 								FROM	 PDF_G107Y BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY
											AND BB.RESID = AA.TXPR_DSCM_NO_CNTN 
											AND BB.USE_PLACE_CD = '1'
										    AND BB.PDF_DAT_APP_YN = 'Y'
			  							),0)  			 


			  ,CSHPT_DDC_TRGT_AMT=NVL(
			                          (SELECT SUM(NVL(CASH_CARD_SUM,0))
			 								FROM	 PDF_G207Y BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY
											AND BB.RESID = AA.TXPR_DSCM_NO_CNTN 
											AND BB.USE_PLACE_CD = '1'
										    AND BB.PDF_DAT_APP_YN = 'Y'
			  							),0)  

			  ,DRTP_CARD_DDC_TRGT_AMT=NVL((SELECT SUM(NVL(DIR_CARD_AMT_SUM,0))
			 								FROM	 PDF_G307Y BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY
											AND BB.RESID = AA.TXPR_DSCM_NO_CNTN 
											AND BB.USE_PLACE_CD = '1'
										    AND BB.PDF_DAT_APP_YN = 'Y'
			  							),0)  

			  ,ZRTD_DDC_TRGT_AMT=NVL((SELECT SUM(NVL(ZERO_AMT_SUM,0))
			 								FROM	 PDF_G407Y BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY
											AND BB.RESID = AA.TXPR_DSCM_NO_CNTN 
											AND BB.USE_PLACE_CD = '1'
										    AND BB.PDF_DAT_APP_YN = 'Y'
			  							),0)  
			  
										/* 2022 도서구입비 junhee */
			  ,BOOK_SHOW_AMT=NVL( (SELECT SUM(NVL(BB01.CARD_AMT_SUM,0)) FROM 
			                               (SELECT  (NVL(CARD_AMT_SUM,0)) AS CARD_AMT_SUM, RESID
			 								FROM	 PDF_G107Y BB
			 							   WHERE  BB.DPOB_CD=#dpobCd#
												AND BB.YRTX_BLGG_YR=#yrtxBlggYr#
												AND BB.CLUT_SEPT_CD=#clutSeptCd#
												AND BB.SYSTEMKEY=#systemkey#
											AND BB.USE_PLACE_CD = '4'
										    AND BB.PDF_DAT_APP_YN = 'Y'
								UNION ALL
								SELECT  (NVL(CASH_CARD_SUM,0)) AS CARD_AMT_SUM, RESID
			 								FROM	 PDF_G207Y BB
			 							   WHERE  BB.DPOB_CD=#dpobCd#
												AND BB.YRTX_BLGG_YR=#yrtxBlggYr#
												AND BB.CLUT_SEPT_CD=#clutSeptCd#
												AND BB.SYSTEMKEY=#systemkey# 
											AND BB.USE_PLACE_CD = '4'
										    AND BB.PDF_DAT_APP_YN = 'Y'
							   UNION ALL
							   SELECT  (NVL(DIR_CARD_AMT_SUM,0)) AS CARD_AMT_SUM, RESID
			 								FROM	 PDF_G307Y BB
			 							   WHERE  BB.DPOB_CD=#dpobCd#
												AND BB.YRTX_BLGG_YR=#yrtxBlggYr#
												AND BB.CLUT_SEPT_CD=#clutSeptCd#
												AND BB.SYSTEMKEY=#systemkey# 
											AND BB.USE_PLACE_CD = '4'
										    AND BB.PDF_DAT_APP_YN = 'Y'
								UNION ALL
							   	SELECT  (NVL(ZERO_AMT_SUM,0)) AS ZERO_AMT_SUM, RESID
			 								FROM	 PDF_G407Y BB
			 							   WHERE  BB.DPOB_CD=#dpobCd#
												AND BB.YRTX_BLGG_YR=#yrtxBlggYr#
												AND BB.CLUT_SEPT_CD=#clutSeptCd#
												AND BB.SYSTEMKEY=#systemkey# 
											AND BB.USE_PLACE_CD = '4'
										    AND BB.PDF_DAT_APP_YN = 'Y'
			  							) BB01
			  							WHERE BB01.RESID = AA.TXPR_DSCM_NO_CNTN 
			  							),0)  								
										
										
			  ,TFHY_CRDC_AMT=NVL((SELECT SUM(NVL(BB01.TFHY_GNRL_SUM,0)) FROM 
			                    ((SELECT  (NVL(TFHY_GNRL_SUM,0)) AS TFHY_GNRL_SUM, RESID
			 					 	FROM PDF_G107M BB
			 							   WHERE BB.DPOB_CD=#dpobCd#
												AND BB.YRTX_BLGG_YR=#yrtxBlggYr#
												AND BB.CLUT_SEPT_CD=#clutSeptCd#
												AND BB.SYSTEMKEY=#systemkey#	
								UNION ALL		    
								SELECT  (NVL(TFHY_GNRL_SUM,0)) AS TFHY_GNRL_SUM, RESID
			 								FROM	 PDF_G207M BB
			 							   WHERE  BB.DPOB_CD=#dpobCd#
												AND BB.YRTX_BLGG_YR=#yrtxBlggYr#
												AND BB.CLUT_SEPT_CD=#clutSeptCd#
												AND BB.SYSTEMKEY=#systemkey#
								UNION ALL		    
							    SELECT  (NVL(TFHY_GNRL_SUM,0)) AS TFHY_GNRL_SUM, RESID
			 								FROM	 PDF_G307M BB
			 							   WHERE  BB.DPOB_CD=#dpobCd#
												AND BB.YRTX_BLGG_YR=#yrtxBlggYr#
												AND BB.CLUT_SEPT_CD=#clutSeptCd#
												AND BB.SYSTEMKEY=#systemkey#
								UNION ALL		    
							    SELECT  (NVL(TFHY_GNRL_SUM,0)) AS TFHY_GNRL_SUM, RESID
			 								FROM	 PDF_G407M BB
			 							   WHERE  BB.DPOB_CD=#dpobCd#
												AND BB.YRTX_BLGG_YR=#yrtxBlggYr#
												AND BB.CLUT_SEPT_CD=#clutSeptCd#
												AND BB.SYSTEMKEY=#systemkey#
			  							)) BB01
			  							WHERE BB01.RESID = AA.TXPR_DSCM_NO_CNTN 
			  							),0)
										
				,TFHY_BOOK_SHOW_AMT=NVL((SELECT SUM(NVL(BB01.TFHY_ISLD_SUM,0)) FROM 
			                    ((SELECT  (NVL(TFHY_ISLD_SUM,0)) AS TFHY_ISLD_SUM, RESID
			 					 	FROM PDF_G107M BB
			 							   WHERE BB.DPOB_CD=#dpobCd#
												AND BB.YRTX_BLGG_YR=#yrtxBlggYr#
												AND BB.CLUT_SEPT_CD=#clutSeptCd#
												AND BB.SYSTEMKEY=#systemkey#	
								UNION ALL		    
								SELECT  (NVL(TFHY_ISLD_SUM,0)) AS TFHY_ISLD_SUM, RESID
			 								FROM	 PDF_G207M BB
			 							   WHERE  BB.DPOB_CD=#dpobCd#
												AND BB.YRTX_BLGG_YR=#yrtxBlggYr#
												AND BB.CLUT_SEPT_CD=#clutSeptCd#
												AND BB.SYSTEMKEY=#systemkey#
								UNION ALL		    
							    SELECT  (NVL(TFHY_ISLD_SUM,0)) AS TFHY_ISLD_SUM, RESID
			 								FROM	 PDF_G307M BB
			 							   WHERE  BB.DPOB_CD=#dpobCd#
												AND BB.YRTX_BLGG_YR=#yrtxBlggYr#
												AND BB.CLUT_SEPT_CD=#clutSeptCd#
												AND BB.SYSTEMKEY=#systemkey#
								UNION ALL		    
							    SELECT  (NVL(TFHY_ISLD_SUM,0)) AS TFHY_ISLD_SUM, RESID
			 								FROM	 PDF_G407M BB
			 							   WHERE  BB.DPOB_CD=#dpobCd#
												AND BB.YRTX_BLGG_YR=#yrtxBlggYr#
												AND BB.CLUT_SEPT_CD=#clutSeptCd#
												AND BB.SYSTEMKEY=#systemkey#
			  							)) BB01
			  							WHERE BB01.RESID = AA.TXPR_DSCM_NO_CNTN 
			  							),0)
										
				,SHFY_CRDC_AMT=NVL((SELECT SUM(NVL(BB01.SHFY_GNRL_SUM,0)) FROM 
			                    ((SELECT  (NVL(SHFY_GNRL_SUM,0)) AS SHFY_GNRL_SUM, RESID
			 					 	FROM PDF_G107M BB
			 							   WHERE BB.DPOB_CD=#dpobCd#
												AND BB.YRTX_BLGG_YR=#yrtxBlggYr#
												AND BB.CLUT_SEPT_CD=#clutSeptCd#
												AND BB.SYSTEMKEY=#systemkey#	
								UNION ALL		    
								SELECT  (NVL(SHFY_GNRL_SUM,0)) AS SHFY_GNRL_SUM, RESID
			 								FROM	 PDF_G207M BB
			 							   WHERE  BB.DPOB_CD=#dpobCd#
												AND BB.YRTX_BLGG_YR=#yrtxBlggYr#
												AND BB.CLUT_SEPT_CD=#clutSeptCd#
												AND BB.SYSTEMKEY=#systemkey#
								UNION ALL		    
							    SELECT  (NVL(SHFY_GNRL_SUM,0)) AS SHFY_GNRL_SUM, RESID
			 								FROM	 PDF_G307M BB
			 							   WHERE  BB.DPOB_CD=#dpobCd#
												AND BB.YRTX_BLGG_YR=#yrtxBlggYr#
												AND BB.CLUT_SEPT_CD=#clutSeptCd#
												AND BB.SYSTEMKEY=#systemkey#
								UNION ALL		    
							    SELECT  (NVL(SHFY_GNRL_SUM,0)) AS SHFY_GNRL_SUM, RESID
			 								FROM	 PDF_G407M BB
			 							   WHERE  BB.DPOB_CD=#dpobCd#
												AND BB.YRTX_BLGG_YR=#yrtxBlggYr#
												AND BB.CLUT_SEPT_CD=#clutSeptCd#
												AND BB.SYSTEMKEY=#systemkey#
			  							)) BB01
			  							WHERE BB01.RESID = AA.TXPR_DSCM_NO_CNTN 
			  							),0)
										
										
				,SHFY_BOOK_SHOW_AMT=NVL((SELECT SUM(NVL(BB01.SHFY_ISLD_SUM,0)) FROM 
			                    ((SELECT  (NVL(SHFY_ISLD_SUM,0)) AS SHFY_ISLD_SUM, RESID
			 					 	FROM PDF_G107M BB
			 							   WHERE BB.DPOB_CD=#dpobCd#
												AND BB.YRTX_BLGG_YR=#yrtxBlggYr#
												AND BB.CLUT_SEPT_CD=#clutSeptCd#
												AND BB.SYSTEMKEY=#systemkey#	
								UNION ALL		    
								SELECT  (NVL(SHFY_ISLD_SUM,0)) AS SHFY_ISLD_SUM, RESID
			 								FROM	 PDF_G207M BB
			 							   WHERE  BB.DPOB_CD=#dpobCd#
												AND BB.YRTX_BLGG_YR=#yrtxBlggYr#
												AND BB.CLUT_SEPT_CD=#clutSeptCd#
												AND BB.SYSTEMKEY=#systemkey#
								UNION ALL		    
							    SELECT  (NVL(SHFY_ISLD_SUM,0)) AS SHFY_ISLD_SUM, RESID
			 								FROM	 PDF_G307M BB
			 							   WHERE  BB.DPOB_CD=#dpobCd#
												AND BB.YRTX_BLGG_YR=#yrtxBlggYr#
												AND BB.CLUT_SEPT_CD=#clutSeptCd#
												AND BB.SYSTEMKEY=#systemkey#
								UNION ALL		    
							    SELECT  (NVL(SHFY_ISLD_SUM,0)) AS SHFY_ISLD_SUM, RESID
			 								FROM	 PDF_G407M BB
			 							   WHERE  BB.DPOB_CD=#dpobCd#
												AND BB.YRTX_BLGG_YR=#yrtxBlggYr#
												AND BB.CLUT_SEPT_CD=#clutSeptCd#
												AND BB.SYSTEMKEY=#systemkey#
			  							)) BB01
			  							WHERE BB01.RESID = AA.TXPR_DSCM_NO_CNTN 
			  							),0)
			  															
						WHERE (SELECT B.YETA_0C63 FROM YE169010 B 
								WHERE B.DPOB_CD = AA.DPOB_CD 
								AND B.YRTX_BLGG_YR = AA.YRTX_BLGG_YR 
								AND B.CLUT_SEPT_CD = AA.CLUT_SEPT_CD
								AND B.SYSTEMKEY = AA.SYSTEMKEY
									) > 70000000
								AND AA.DPOB_CD=#dpobCd#
								AND AA.YRTX_BLGG_YR=#yrtxBlggYr#
								AND AA.CLUT_SEPT_CD=#clutSeptCd#
								AND AA.SYSTEMKEY=#systemkey#
								AND AA.CD_VVAL_KRN_CD='Y0140000'  /* 국세청 */   
            ]]>
	</update>  
	
	
	
	<update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_18_5_Update">
	<![CDATA[
			UPDATE YE166020 AA
			SET   
				
				CRDC_USE_AMT_SUM=   NVL((SELECT  NVL(CRDC_DDC_TRGT_AMT,0) 
			                                      +  NVL(DRTP_CARD_DDC_TRGT_AMT,0)
			                                       +  NVL(CSHPT_DDC_TRGT_AMT,0)
			                                        +  NVL(TDMR_DDC_TRGT_AMT,0)
			                                         +  NVL(PBT_DDC_TRGT_AMT,0) 
													 +  NVL(BOOK_SHOW_AMT,0) 
													 +  NVL(ZRTD_USE_AMT,0) 
													 FROM
			 									 YE161040 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY
											AND BB.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN  
											AND BB.CD_VVAL_KRN_CD = AA.DATA_CD     
			  							),CRDC_USE_AMT_SUM)  
			 
				, CRDC_USE_AMT= NVL((SELECT  NVL(CRDC_DDC_TRGT_AMT,0) FROM
			 									 YE161040 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY
											AND BB.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN  
											AND BB.CD_VVAL_KRN_CD = AA.DATA_CD     
			  							),CRDC_USE_AMT)  
				, CSHPT_USE_AMT= NVL((SELECT  NVL(CSHPT_DDC_TRGT_AMT,0) FROM
			 									 YE161040 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY
											AND BB.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN  
											AND BB.CD_VVAL_KRN_CD = AA.DATA_CD     
			  							),CSHPT_USE_AMT)  
				, DRTP_CARD_USE_AMT= NVL((SELECT  NVL(DRTP_CARD_DDC_TRGT_AMT,0) FROM
			 									 YE161040 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY
											AND BB.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN  
											AND BB.CD_VVAL_KRN_CD = AA.DATA_CD     
			  							),DRTP_CARD_USE_AMT)  
				  
				, BOOK_SHOW_AMT= NVL((SELECT  NVL(BOOK_SHOW_AMT,0) FROM
			 									 YE161040 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY
											AND BB.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN  
											AND BB.CD_VVAL_KRN_CD = AA.DATA_CD     
			  							),BOOK_SHOW_AMT)  
				
			  	, ZRTD_USE_AMT= NVL((SELECT NVL(ZRTD_DDC_TRGT_AMT,0) FROM
			  									YE161040 BB
			  								WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY
											AND BB.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN
											AND BB.CD_VVAL_KRN_CD = AA.DATA_CD
										),ZRTD_USE_AMT)
					
				 
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
						WHERE (SELECT B.YETA_0C63 FROM YE169010 B 
								WHERE B.DPOB_CD = AA.DPOB_CD 
								AND B.YRTX_BLGG_YR = AA.YRTX_BLGG_YR 
								AND B.CLUT_SEPT_CD = AA.CLUT_SEPT_CD
								AND B.SYSTEMKEY = AA.SYSTEMKEY
									) > 70000000
								AND AA.DPOB_CD=#dpobCd#
								AND AA.YRTX_BLGG_YR=#yrtxBlggYr#
								AND AA.CLUT_SEPT_CD=#clutSeptCd#
								AND AA.SYSTEMKEY=#systemkey#
				]]>	
				  <isNotEmpty prepend="AND" property="famResnoEncCntn" >
                       	  AA.FAM_RESNO_ENC_CNTN=#famResnoEncCntn#
                  </isNotEmpty> 		
	</update>  
	
	
	
	<update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_18_6_Update">
	<![CDATA[
			UPDATE YE161070  AA
			SET  
				
				  CRDC_USE_AMT= NVL((SELECT SUM(NVL(CRDC_DDC_TRGT_AMT,0)) 
			 								FROM	 YE161040 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY  
			  						 ),0)  
			  						 
			  	,  CSHPT_USE_AMT= NVL((SELECT SUM(NVL(CSHPT_DDC_TRGT_AMT,0)) 
			 								FROM	 YE161040 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY  
			  						 ),0)  
			  						 
			  	,DRTP_CARD_USE_AMT= NVL((SELECT SUM(NVL(DRTP_CARD_DDC_TRGT_AMT,0)) 
			 								FROM	 YE161040 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY  
			  						 ),0)  
			  						 
			  	,ZRTD_USE_AMT= NVL((SELECT SUM(NVL(ZRTD_DDC_TRGT_AMT,0)) 
			 								FROM	 YE161040 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY  
			  						 ),0)  
			  						 
			    ,  BOOK_SHOW_AMT= NVL((SELECT SUM(NVL(BOOK_SHOW_AMT,0)) 
			 								FROM	 YE161040 BB
			 							   WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY  
			  						 ),0)  	
			  	, CRDC_SUM_USE_AMT= NVL((SELECT (SUM(NVL(BB.CRDC_DDC_TRGT_AMT,0))
										+SUM(NVL(BB.DRTP_CARD_DDC_TRGT_AMT,0))
										+SUM(NVL(BB.CSHPT_DDC_TRGT_AMT,0))
										+SUM(NVL(BB.ZRTD_DDC_TRGT_AMT,0))
										+SUM(NVL(BB.BOOK_SHOW_AMT,0))
										+SUM(NVL(BB.TDMR_DDC_TRGT_AMT,0))
										+SUM(NVL(BB.PBT_DDC_TRGT_AMT,0))) AS CRDC_SUM_USE_AMT
										FROM	 YE161040 BB
										WHERE BB.DPOB_CD=AA.DPOB_CD
											AND BB.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
											AND BB.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
											AND BB.SYSTEMKEY=AA.SYSTEMKEY
										),0)
									 					 
				WHERE (SELECT B.YETA_0C63 FROM YE169010 B 
						WHERE B.DPOB_CD = AA.DPOB_CD 
						AND B.YRTX_BLGG_YR = AA.YRTX_BLGG_YR 
						AND B.CLUT_SEPT_CD = AA.CLUT_SEPT_CD
						AND B.SYSTEMKEY = AA.SYSTEMKEY
					) > 70000000
						AND AA.DPOB_CD=#dpobCd#
						AND AA.YRTX_BLGG_YR=#yrtxBlggYr#
						AND AA.CLUT_SEPT_CD=#clutSeptCd#
						AND AA.SYSTEMKEY=#systemkey# 
				]]>	
	</update>  
	
	
	
	
	   
	   
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_19_Update">
		<![CDATA[
		      UPDATE YE169010                                                                                                           
               SET   /*  C103_기타소득공제_투자조합출자등소득공제금액  */
             YETA_C103  =  (SELECT (AD01.CPIV20_ASCT_DDC_AMT + AD01.CPIV20_ASCT_TWO_DDC_AMT + AD01.CPIV20_VNT_DDC_AMT + AD01.CPIV21_ASCT_DDC_AMT + AD01.CPIV21_ASCT_TWO_DDC_AMT + AD01.CPIV21_VNT_DDC_AMT + AD01.CPIV22_ASCT_DDC_AMT + AD01.CPIV22_ASCT_TWO_DDC_AMT + AD01.CPIV22_VNT_DDC_AMT)
                               FROM  YE161070 AD01                                                                                                    
                             WHERE AD01.SYSTEMKEY= YE169010.SYSTEMKEY                                                                      
                              AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                               
                              AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                              AND AD01.DPOB_CD  = YE169010.DPOB_CD)  ,
                                                                                                                
      /*  ETCC_CARD IS '기타공제)신용카드등  ETCT_CARD //카드  ETCH_UEAM  현금영수증   ETCH_BCED 대중교통   ETCH_BCBS 직불카드  ETCH_MGVD 전통시장  */                                                                                        
YETA_C104 =  (TRUNC((
SELECT (CASE
           WHEN NVL (AD01.CRDC_SUM_USE_AMT, 0) >= (YE169010.YETA_0C63 * 0.25)
           THEN
                (CASE
                    WHEN (CASE
                             WHEN FUN_YETA_2022_01(YE169010.YETA_0C63) >= FUN_YETA_2022_02(YE169010.YETA_0C63, CRDC_USE_AMT, CSHPT_USE_AMT, DRTP_CARD_USE_AMT, ZRTD_USE_AMT, BOOK_SHOW_AMT, TDMR_USE_AMT, TFHY_PBT_USE_AMT, SHFY_PBT_USE_AMT, CRDC_PRE_USE_AMT, CRDC_CURR_USE_AMT, TDMR_PRE_USE_AMT, TDMR_CURR_USE_AMT)
                             THEN FUN_YETA_2022_02(YE169010.YETA_0C63, CRDC_USE_AMT, CSHPT_USE_AMT, DRTP_CARD_USE_AMT, ZRTD_USE_AMT, BOOK_SHOW_AMT, TDMR_USE_AMT, TFHY_PBT_USE_AMT, SHFY_PBT_USE_AMT, CRDC_PRE_USE_AMT, CRDC_CURR_USE_AMT, TDMR_PRE_USE_AMT, TDMR_CURR_USE_AMT)
                             ELSE FUN_YETA_2022_01(YE169010.YETA_0C63)
                          END) > 0
                    THEN
                       (CASE
                           WHEN FUN_YETA_2022_01(YE169010.YETA_0C63) >= FUN_YETA_2022_02(YE169010.YETA_0C63, CRDC_USE_AMT, CSHPT_USE_AMT, DRTP_CARD_USE_AMT, ZRTD_USE_AMT, BOOK_SHOW_AMT, TDMR_USE_AMT, TFHY_PBT_USE_AMT, SHFY_PBT_USE_AMT, CRDC_PRE_USE_AMT, CRDC_CURR_USE_AMT, TDMR_PRE_USE_AMT, TDMR_CURR_USE_AMT)
                           THEN FUN_YETA_2022_02(YE169010.YETA_0C63, CRDC_USE_AMT, CSHPT_USE_AMT, DRTP_CARD_USE_AMT, ZRTD_USE_AMT, BOOK_SHOW_AMT, TDMR_USE_AMT, TFHY_PBT_USE_AMT, SHFY_PBT_USE_AMT, CRDC_PRE_USE_AMT, CRDC_CURR_USE_AMT, TDMR_PRE_USE_AMT, TDMR_CURR_USE_AMT)
                           ELSE FUN_YETA_2022_01(YE169010.YETA_0C63)
                        END)
                    ELSE
                       0
                 END)
				+ FUN_YETA_2022_03(YE169010.YETA_0C63, CRDC_USE_AMT, CSHPT_USE_AMT, DRTP_CARD_USE_AMT, ZRTD_USE_AMT, BOOK_SHOW_AMT, TDMR_USE_AMT, TFHY_PBT_USE_AMT, SHFY_PBT_USE_AMT, CRDC_PRE_USE_AMT, CRDC_CURR_USE_AMT, TDMR_PRE_USE_AMT, TDMR_CURR_USE_AMT)
				+ FUN_YETA_2022_04(YE169010.YETA_0C63, CRDC_USE_AMT, CSHPT_USE_AMT, DRTP_CARD_USE_AMT, ZRTD_USE_AMT, BOOK_SHOW_AMT, TDMR_USE_AMT, TFHY_PBT_USE_AMT, SHFY_PBT_USE_AMT, CRDC_PRE_USE_AMT, CRDC_CURR_USE_AMT, TDMR_PRE_USE_AMT, TDMR_CURR_USE_AMT)
				+ FUN_YETA_2022_05(YE169010.YETA_0C63, CRDC_USE_AMT, CSHPT_USE_AMT, DRTP_CARD_USE_AMT, ZRTD_USE_AMT, BOOK_SHOW_AMT, TDMR_USE_AMT, TFHY_PBT_USE_AMT, SHFY_PBT_USE_AMT, CRDC_PRE_USE_AMT, CRDC_CURR_USE_AMT, TDMR_PRE_USE_AMT, TDMR_CURR_USE_AMT)
				+ FUN_YETA_2022_06(YE169010.YETA_0C63, CRDC_USE_AMT, CSHPT_USE_AMT, DRTP_CARD_USE_AMT, ZRTD_USE_AMT, BOOK_SHOW_AMT, TDMR_USE_AMT, TFHY_PBT_USE_AMT, SHFY_PBT_USE_AMT, CRDC_PRE_USE_AMT, CRDC_CURR_USE_AMT, TDMR_PRE_USE_AMT, TDMR_CURR_USE_AMT)
           ELSE
              0
        END)
  FROM YE161070 AD01
 WHERE     AD01.SYSTEMKEY = YE169010.SYSTEMKEY
       AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR
       AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
       AND AD01.DPOB_CD = YE169010.DPOB_CD
                                  )))  ,    

                         /*  ETCK_UNON IS '기타공제)우리사주조합    */                                                                              
                               YETA_C105 = (SELECT CASE WHEN (NVL(AD01.EMST_ASCT_CNTR_USE_AMT,0) > 4000000 )                                              
                                                                 THEN 4000000                                                                   
                                                                 ELSE NVL(AD01.EMST_ASCT_CNTR_USE_AMT,0)                                                  
                                                                 END                                                                            
                                                         FROM YE161070 AD01                                                                          
                                                         WHERE AD01.SYSTEMKEY= YE169010.SYSTEMKEY                                             
                                              AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                         
                                              AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD       
                                              AND AD01.DPOB_CD  = YE169010.DPOB_CD                                                    
                                                         )  ,                                                                                    
 
 
                         /*     ETEP_MSAM IS 기타공제_고용유지중소기업근로자임금삭감공제액  */                                                
                         YETA_C107  =  (SELECT (CASE WHEN   10000000 > (NVL(AD01.EMP_MNTN_SNMC_USE_AMT,0) * 0.5)                                                   
                                                                       THEN                                                                
                                                                             (NVL(AD01.EMP_MNTN_SNMC_USE_AMT,0) * 0.5)                                           
                                                                       ELSE                                                               
                                                                               10000000                                                  
                                                                       END)           
                                                   FROM YE161070 AD01                                                                  
                                               WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY          
                                                 AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR         
                                                 AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
                                                 AND AD01.DPOB_CD  = YE169010.DPOB_CD   ) ,    
      /*   //목돈안드는 전세 이자상환액공제 */
                           YETA_C108  =  0, /* (SELECT (CASE WHEN   3000000 > (NVL(ETGD_CTRA,0) * 0.4)                                                   
                                                                       THEN                                                                
                                                                             (NVL(ETGD_CTRA,0) * 0.4)                                           
                                                                       ELSE                                                               
                                                                               3000000                                                  
                                                                       END)           
                                               FROM YE161020                                                                  
                                               WHERE YE161020.SYSTEMKEY = YE169010.SYSTEMKEY          
                                                 AND YE161020.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR         
                                                 AND YE161020.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD 
                                                 AND YE161020.DPOB_CD  = YE169010.DPOB_CD  ) */    
           /*   //장기집합투자증권저축  */
                           YETA_C109  =  NVL((SELECT NVL((CASE WHEN   2400000 > (NVL(AD01.LTRM_CNI_SS_USE_AMT,0) * 0.4)                                                   
                                                                       THEN                                                                
                                                                             (NVL(AD01.LTRM_CNI_SS_USE_AMT,0) * 0.4)                                           
                                                                       ELSE                                                               
                                                                               2400000                                                  
                                                                       END) ,0)          
                                                 FROM YE161070 AD01                                                                  
                                               WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY          
                                                 AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR         
                                                 AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
                                                 AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                 AND YE169010.YETA_0C63 < 80000000),0)  ,
                                                 
                           /*청년형장기집합투자증권저축*/                      
                          YETA_C109Y  =  NVL((SELECT NVL((CASE WHEN   2400000 > (NVL(AD01.LTRM_CNI_YY_USE_AMT,0) * 0.4)                                                   
                                                                       THEN                                                                
                                                                             (NVL(AD01.LTRM_CNI_YY_USE_AMT,0) * 0.4)                                           
                                                                       ELSE                                                               
                                                                               2400000                                                  
                                                                       END) ,0)          
                                                 FROM YE161070 AD01                                                                  
                                               WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY          
                                                 AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR         
                                                 AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
                                                 AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                 AND YE169010.YETA_0C63 < 80000000),0)  ,
                                                 
                                               
                 /*    '주근무지_퇴직연금 소득공제 대상금액   */                                 
              YETA_C129 = (SELECT CASE WHEN NVL(AP01.YETA_0C63,0) <= 120000000
					THEN (CASE WHEN (CASE WHEN SUBSTR(AP02.RESNO_ENC_CNTN,7,1) IN ('3','4')
								     THEN '20' || SUBSTR(AP02.RESNO_ENC_CNTN,1,6)
									 ELSE '19' || SUBSTR(AP02.RESNO_ENC_CNTN,1,6)
									 END) > 19721231
						  THEN (CASE WHEN 7000000 - NVL(AP03.RTPN_USE_AMT,0) <= 0
								THEN 7000000
								ELSE NVL(AP03.RTPN_USE_AMT,0)
								END)
						  ELSE (CASE WHEN 9000000 - NVL(AP03.RTPN_USE_AMT,0) <= 0
								THEN 9000000
								ELSE NVL(AP03.RTPN_USE_AMT,0)
								END)
						  END)
					ELSE (CASE WHEN 7000000 - NVL(AP03.RTPN_USE_AMT,0) <= 0
								THEN 7000000
								ELSE NVL(AP03.RTPN_USE_AMT,0)
								END)
					END
			FROM YE169010 AP01 , YE161020 AP02 , YE161080 AP03
			WHERE AP01.DPOB_CD = AP02.DPOB_CD
			AND AP02.DPOB_CD = AP03.DPOB_CD
			AND AP01.YRTX_BLGG_YR = AP02.YRTX_BLGG_YR
			AND AP02.YRTX_BLGG_YR = AP03.YRTX_BLGG_YR
			AND AP01.SYSTEMKEY = AP02.SYSTEMKEY
			AND AP02.SYSTEMKEY = AP03.SYSTEMKEY
			AND AP01.CLUT_SEPT_CD = AP02.CLUT_SEPT_CD
			AND AP02.CLUT_SEPT_CD = AP03.CLUT_SEPT_CD
			AND AP01.DPOB_CD = #dpobCd#
			AND AP01.YRTX_BLGG_YR = #yrtxBlggYr#
			AND AP01.CLUT_SEPT_CD = #clutSeptCd#
			AND AP01.SYSTEMKEY = #systemkey#)
			   WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#
				]]>
	</update>   
	
	
	
	<update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_19_S_Update">
		<![CDATA[
		UPDATE YE169010 AD01
		SET
		YETA_0C76 = (SELECT (CASE WHEN (NVL(AD01.YETA_0C65,0) - (NVL(AD01.YETA_0C66,0) + NVL(AD01.YETA_0C67,0) + NVL(AD01.YETA_0C69,0) + NVL(AD01.YETA_0C71,0) + NVL(AD01.YETA_0C73,0) + NVL(AD01.YETA_0C74,0) + NVL(AD01.YETA_0C75,0)
							   + NVL(AD01.YETA_0C81,0) + NVL(AD01.YETA_0C82,0) + NVL(AD01.YETA_0C83,0) + NVL(AD01.YETA_0C84,0) + NVL(AD01.YETA_0C85,0) + NVL(AD01.YETA_0C86,0) + NVL(AD01.YETA_0C87,0) + NVL(AD01.YETA_0C88,0) + NVL(AD01.YETA_0C89,0) 
							   + NVL(AD01.YETA_0C90,0) + NVL(AD01.YETA_0C91,0) + NVL(AD01.YETA_0C92,0) + NVL(AD01.YETA_0C93,0) + NVL(AD01.YETA_0C94,0)
							   + NVL(AD01.YETA_0C98,0) + NVL(AD01.YETA_C100,0) + NVL(AD01.YETA_C101,0) + NVL(AD01.YETA_C102,0) + NVL(AD01.YETA_C103,0) + NVL(AD01.YETA_C104,0) + NVL(AD01.YETA_C105,0) + NVL(AD01.YETA_C109,0) + NVL(AD01.YETA_C109Y,0))) > 0
			THEN (CASE WHEN (NVL(AD01.YETA_0C65,0) - (NVL(AD01.YETA_0C66,0) + NVL(AD01.YETA_0C67,0) + NVL(AD01.YETA_0C69,0) + NVL(AD01.YETA_0C71,0) + NVL(AD01.YETA_0C73,0) + NVL(AD01.YETA_0C74,0) + NVL(AD01.YETA_0C75,0)
										+ NVL(AD01.YETA_0C81,0) + NVL(AD01.YETA_0C82,0) + NVL(AD01.YETA_0C83,0) + NVL(AD01.YETA_0C84,0) + NVL(AD01.YETA_0C85,0) + NVL(AD01.YETA_0C86,0) + NVL(AD01.YETA_0C87,0) + NVL(AD01.YETA_0C88,0) + NVL(AD01.YETA_0C89,0) 
										+ NVL(AD01.YETA_0C90,0) + NVL(AD01.YETA_0C91,0) + NVL(AD01.YETA_0C92,0) + NVL(AD01.YETA_0C93,0) + NVL(AD01.YETA_0C94,0)
										+ NVL(AD01.YETA_0C98,0) + NVL(AD01.YETA_C100,0) + NVL(AD01.YETA_C101,0) + NVL(AD01.YETA_C102,0) + NVL(AD01.YETA_C103,0) + NVL(AD01.YETA_C104,0) + NVL(AD01.YETA_C105,0) + NVL(AD01.YETA_C109,0) + NVL(AD01.YETA_C109Y,0))) 
											>= (SELECT  NVL(AD02.NP_HTHR_WA_INFEE_DDC_AMT, 0) +  NVL(AD02.NP_HTHR_MCUR_WKAR_DDC_AMT, 0) + NVL(AD02.NP_HTHR_AREA_DDC_AMT, 0) 
												FROM YE161050 AD02
												WHERE AD02.DPOB_CD = AD01.DPOB_CD
												AND AD02.YRTX_BLGG_YR = AD01.YRTX_BLGG_YR
												AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
												AND AD02.CLUT_SEPT_CD = AD01.CLUT_SEPT_CD
												AND AD02.DPOB_CD = #dpobCd#
												AND AD02.SYSTEMKEY = #systemkey#
												AND AD02.CLUT_SEPT_CD = #clutSeptCd#
												AND AD02.YRTX_BLGG_YR = #yrtxBlggYr#)
					  THEN (SELECT  NVL(AD02.NP_HTHR_WA_INFEE_DDC_AMT, 0) +  NVL(AD02.NP_HTHR_MCUR_WKAR_DDC_AMT, 0) + NVL(AD02.NP_HTHR_AREA_DDC_AMT, 0) 
							FROM YE161050 AD02
							WHERE AD02.DPOB_CD = AD01.DPOB_CD
							AND AD02.YRTX_BLGG_YR = AD01.YRTX_BLGG_YR
							AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
							AND AD02.CLUT_SEPT_CD = AD01.CLUT_SEPT_CD
							AND AD02.DPOB_CD = #dpobCd#
							AND AD02.SYSTEMKEY = #systemkey#
							AND AD02.CLUT_SEPT_CD = #clutSeptCd#
							AND AD02.YRTX_BLGG_YR = #yrtxBlggYr#)
					  ELSE (NVL(AD01.YETA_0C65,0) - (NVL(AD01.YETA_0C66,0) + NVL(AD01.YETA_0C67,0) + NVL(AD01.YETA_0C69,0) + NVL(AD01.YETA_0C71,0) + NVL(AD01.YETA_0C73,0) + NVL(AD01.YETA_0C74,0) + NVL(AD01.YETA_0C75,0)
										+ NVL(AD01.YETA_0C81,0) + NVL(AD01.YETA_0C82,0) + NVL(AD01.YETA_0C83,0) + NVL(AD01.YETA_0C84,0) + NVL(AD01.YETA_0C85,0) + NVL(AD01.YETA_0C86,0) + NVL(AD01.YETA_0C87,0) + NVL(AD01.YETA_0C88,0) 
										+ NVL(AD01.YETA_0C89,0) + NVL(AD01.YETA_0C90,0) + NVL(AD01.YETA_0C91,0) + NVL(AD01.YETA_0C92,0) + NVL(AD01.YETA_0C93,0) + NVL(AD01.YETA_0C94,0)
										+ NVL(AD01.YETA_0C98,0) + NVL(AD01.YETA_C100,0) + NVL(AD01.YETA_C101,0) + NVL(AD01.YETA_C102,0) + NVL(AD01.YETA_C103,0) + NVL(AD01.YETA_C104,0) + NVL(AD01.YETA_C105,0) + NVL(AD01.YETA_C109,0) + NVL(AD01.YETA_C109Y,0)))
					  END)
			ELSE 0
			END)
		FROM YE169010 AD01
		WHERE AD01.DPOB_CD = #dpobCd#
		AND AD01.YRTX_BLGG_YR = #yrtxBlggYr#
		AND AD01.CLUT_SEPT_CD = #clutSeptCd#
		AND AD01.SYSTEMKEY = #systemkey#)
WHERE AD01.DPOB_CD = #dpobCd#
AND AD01.YRTX_BLGG_YR = #yrtxBlggYr#
AND AD01.CLUT_SEPT_CD = #clutSeptCd#
AND AD01.SYSTEMKEY = #systemkey#
		
				]]>
	</update> 
	
	
	
	<update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_19_S_1_Update">
		<![CDATA[
			  UPDATE YE161050 AD01                                                                                                                                                                                     
                SET    
                 AD01.PNSN_INFEE_DDC_AMT_SUM = (SELECT NVL(AD02.YETA_0C76,0) 
                 								FROM YE169010 AD02 
                 								WHERE AD01.DPOB_CD = AD02.DPOB_CD
                 								AND AD01.YRTX_BLGG_YR = AD02.YRTX_BLGG_YR
                 								AND AD01.CLUT_SEPT_CD = AD02.CLUT_SEPT_CD
                 								AND AD01.SYSTEMKEY = AD02.SYSTEMKEY
                 								AND AD02.DPOB_CD=#dpobCd#
                                				AND AD02.YRTX_BLGG_YR=#yrtxBlggYr#
                                				AND AD02.CLUT_SEPT_CD=#clutSeptCd#
                                 				AND AD02.SYSTEMKEY=#systemkey#)
			               WHERE AD01.DPOB_CD=#dpobCd#
                           AND AD01.YRTX_BLGG_YR=#yrtxBlggYr#
                           AND AD01.CLUT_SEPT_CD=#clutSeptCd#
                           AND AD01.SYSTEMKEY=#systemkey# 
				]]>
	</update> 
	
	   
	   
	   
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_19_1_Update">
	   <![CDATA[  
	   UPDATE YE169010                                                                      
              SET   
	   		/*  JRTR_PTAR IS '주근무지_근로자연금저축소득공제 대상금액  */                                  
               YETA_C131 = (SELECT CASE WHEN NVL(AP01.YETA_0C63,0) <= 120000000
				   THEN (CASE WHEN (CASE WHEN SUBSTR(AP02.RESNO_ENC_CNTN,7,1) IN ('3','4')
										 THEN '20' || SUBSTR(AP02.RESNO_ENC_CNTN,1,6)
										 ELSE '19' || SUBSTR(AP02.RESNO_ENC_CNTN,1,6)
										 END) > 19721231
						      THEN (CASE WHEN 7000000 - NVL(AP01.YETA_C129,0) <= 0
										 THEN 0
										 ELSE (CASE WHEN NVL(AP03.PNSN_SVNG_USE_AMT,0) >= 4000000
													THEN (CASE WHEN 7000000 - NVL(AP01.YETA_C129,0) >= 4000000
															   THEN 4000000
															   ELSE 7000000 - NVL(AP01.YETA_C129,0)
															   END
														  )
													ELSE (CASE WHEN 7000000 - NVL(AP01.YETA_C129,0) >= NVL(AP03.PNSN_SVNG_USE_AMT,0)
															   THEN NVL(AP03.PNSN_SVNG_USE_AMT,0)
															   ELSE 7000000 - NVL(AP01.YETA_C129,0)
															   END
														  )
													END)
										 END)
							  ELSE (CASE WHEN 9000000 - NVL(AP01.YETA_C129,0) <= 0
										 THEN 0
										 ELSE (CASE WHEN NVL(AP03.PNSN_SVNG_USE_AMT,0) >= 6000000
													THEN (CASE WHEN 9000000 - NVL(AP01.YETA_C129,0) >= 6000000
															   THEN 6000000
															   ELSE 9000000 - NVL(AP01.YETA_C129,0)
															   END
														  )
													ELSE (CASE WHEN 9000000 - NVL(AP01.YETA_C129,0) >= NVL(AP03.PNSN_SVNG_USE_AMT,0)
															   THEN NVL(AP03.PNSN_SVNG_USE_AMT,0)
															   ELSE 9000000 - NVL(AP01.YETA_C129,0)
															   END
														  )
													END)
										 END)
							  END)
				   ELSE (CASE WHEN 7000000 - NVL(AP01.YETA_C129,0) <= 0
							  THEN 0
							  ELSE (CASE WHEN NVL(AP03.PNSN_SVNG_USE_AMT,0) >= 3000000
										 THEN (CASE WHEN 7000000 - NVL(AP01.YETA_C129,0) >= 3000000
													THEN 3000000
													ELSE 7000000 - NVL(AP01.YETA_C129,0)
													END)
										 ELSE (CASE WHEN 7000000 - NVL(AP01.YETA_C129,0) >= NVL(AP03.PNSN_SVNG_USE_AMT,0)
													THEN NVL(AP03.PNSN_SVNG_USE_AMT,0)
													ELSE 7000000 - NVL(AP01.YETA_C129,0)
													END)
										 END)
							  END)
				   END
			FROM YE169010 AP01 , YE161020 AP02 , YE161080 AP03
			WHERE AP01.DPOB_CD = AP02.DPOB_CD
			AND AP02.DPOB_CD = AP03.DPOB_CD
			AND AP01.YRTX_BLGG_YR = AP02.YRTX_BLGG_YR
			AND AP02.YRTX_BLGG_YR = AP03.YRTX_BLGG_YR
			AND AP01.SYSTEMKEY = AP02.SYSTEMKEY
			AND AP02.SYSTEMKEY = AP03.SYSTEMKEY
			AND AP01.CLUT_SEPT_CD = AP02.CLUT_SEPT_CD
			AND AP02.CLUT_SEPT_CD = AP03.CLUT_SEPT_CD
			AND AP01.DPOB_CD = #dpobCd#
			AND AP01.YRTX_BLGG_YR = #yrtxBlggYr#
			AND AP01.CLUT_SEPT_CD = #clutSeptCd#
			AND AP01.SYSTEMKEY = #systemkey#)
			WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey# 
	   
	   
	   ]]>
	   </update>
	   
	   
	  <!-- {공제단계 시작 -연금보험료공제 연금보험료공제  대상금액 04} -연금보험료공제  대상금액 넣기    -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_20_Update">
		<![CDATA[          
               UPDATE YE169010                                                                      
              SET                                                                          
             /*  JRTR_CTAR IS '주근무지_과학기술인공제_퇴직연금소득공제 대상금액, 해당인원없어서 사용은안함  */                                  
              YETA_C127 = (SELECT (  CASE WHEN (NVL(AD01.SCTC_HP_USE_AMT,0) + NVL(AD01.RTPN_USE_AMT,0) +  YE169010.YETA_C131)  <= 7000000        
                                         THEN NVL(AD01.SCTC_HP_USE_AMT,0)                                                                                 
                                         ELSE                                                                                                    
                                            CASE WHEN (NVL(AD01.SCTC_HP_USE_AMT,0)  + YE169010.YETA_C131) <= 7000000                          
                                            THEN                                                                                             
                                                  NVL(AD01.SCTC_HP_USE_AMT,0)                                           
                                            ELSE  (CASE WHEN  (7000000 - YE169010.YETA_C131)    <=  NVL(AD01.SCTC_HP_USE_AMT,0)      
                                                      THEN   (7000000 - YE169010.YETA_C131)                                     
                                                      ELSE    NVL(AD01.SCTC_HP_USE_AMT,0)    END)
                                            END                                                                                  
                                        END     )
                                            FROM YE161080 AD01                                                                  
                                               WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY          
                                                 AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR         
                                                 AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
                                                 AND AD01.DPOB_CD  = YE169010.DPOB_CD ) ,                                                  
                                                 
                       /*  ISA 연금공제대상금액 */
                       YETA_C13A = NVL((SELECT TRUNC((SELECT CASE WHEN NVL(AP01.YETA_0C63,0) <= 120000000 
														   THEN (CASE WHEN (CASE WHEN SUBSTR(AP02.RESNO_ENC_CNTN,7,1) IN ('3','4') 
																				 THEN '20' || SUBSTR(AP02.RESNO_ENC_CNTN,1,6)
																				 ELSE '19' || SUBSTR(AP02.RESNO_ENC_CNTN,1,6)
																				 END) > 19721231
																	  THEN LEAST(7000000 + LEAST(((NVL(AP03.RTPN_ISA_USE_AMT,0) + NVL(AP03.PNSN_SVNG_ISA_USE_AMT,0))*0.1) , 3000000) - (NVL(AP01.YETA_C129,0) + NVL(AP01.YETA_C131,0)) 
																		         , NVL(AP03.RTPN_ISA_USE_AMT,0))
																	  ELSE LEAST(9000000 + LEAST(((NVL(AP03.RTPN_ISA_USE_AMT,0) + NVL(AP03.PNSN_SVNG_ISA_USE_AMT,0))*0.1) , 3000000) - (NVL(AP01.YETA_C129,0) + NVL(AP01.YETA_C131,0)) 
																			     , NVL(AP03.RTPN_ISA_USE_AMT,0)) 
																	  END)		
														   ELSE LEAST(7000000 + LEAST(((NVL(AP03.RTPN_ISA_USE_AMT,0) + NVL(AP03.PNSN_SVNG_ISA_USE_AMT,0))*0.1) , 3000000) - (NVL(AP01.YETA_C129,0) + NVL(AP01.YETA_C131,0)) 
																	  , NVL(AP03.RTPN_ISA_USE_AMT,0)) 
														   END
											   FROM YE169010 AP01 , YE161020 AP02 , YE161080 AP03
											   WHERE AP01.DPOB_CD = AP02.DPOB_CD
											   AND AP02.DPOB_CD = AP03.DPOB_CD
											   AND AP01.YRTX_BLGG_YR = AP02.YRTX_BLGG_YR
											   AND AP02.YRTX_BLGG_YR = AP03.YRTX_BLGG_YR
											   AND AP01.SYSTEMKEY = AP02.SYSTEMKEY
											   AND AP02.SYSTEMKEY = AP03.SYSTEMKEY
											   AND AP01.CLUT_SEPT_CD = AP02.CLUT_SEPT_CD
											   AND AP02.CLUT_SEPT_CD = AP03.CLUT_SEPT_CD
											   AND AP01.DPOB_CD = #dpobCd#
											   AND AP01.YRTX_BLGG_YR = #yrtxBlggYr#
											   AND AP01.CLUT_SEPT_CD = #clutSeptCd#
											   AND AP01.SYSTEMKEY = #systemkey#),0)
								FROM YE169010 AP01 , YE161020 AP02 , YE161080 AP03
							    WHERE AP01.DPOB_CD = AP02.DPOB_CD
								AND AP02.DPOB_CD = AP03.DPOB_CD
								AND AP01.YRTX_BLGG_YR = AP02.YRTX_BLGG_YR
								AND AP02.YRTX_BLGG_YR = AP03.YRTX_BLGG_YR
								AND AP01.SYSTEMKEY = AP02.SYSTEMKEY
								AND AP02.SYSTEMKEY = AP03.SYSTEMKEY
								AND AP01.CLUT_SEPT_CD = AP02.CLUT_SEPT_CD
								AND AP02.CLUT_SEPT_CD = AP03.CLUT_SEPT_CD
								AND AP01.DPOB_CD = #dpobCd#
								AND AP01.YRTX_BLGG_YR = #yrtxBlggYr#
								AND AP01.CLUT_SEPT_CD = #clutSeptCd#
								AND AP01.SYSTEMKEY = #systemkey#),0)
								
								+  NVL((SELECT TRUNC((SELECT CASE WHEN NVL(AP01.YETA_0C63,0) <= 120000000 
																		  THEN (CASE WHEN (CASE WHEN SUBSTR(AP02.RESNO_ENC_CNTN,7,1) IN ('3','4') 
																								THEN '20' || SUBSTR(AP02.RESNO_ENC_CNTN,1,6)
																								ELSE '19' || SUBSTR(AP02.RESNO_ENC_CNTN,1,6)
																								END) > 19721231
																						  
																					 THEN LEAST(((7000000 + LEAST(((NVL(AP03.RTPN_ISA_USE_AMT,0) + NVL(AP03.PNSN_SVNG_ISA_USE_AMT,0))*0.1) , 3000000) - (NVL(AP01.YETA_C129,0) + NVL(AP01.YETA_C131,0)))
																							     - LEAST(7000000 + LEAST(((NVL(AP03.RTPN_ISA_USE_AMT,0) + NVL(AP03.PNSN_SVNG_ISA_USE_AMT,0))*0.1) , 3000000) - (NVL(AP01.YETA_C129,0) + NVL(AP01.YETA_C131,0))
																										 , NVL(AP03.RTPN_ISA_USE_AMT,0))) 
																								 , (4000000 + LEAST(NVL(AP03.PNSN_SVNG_ISA_USE_AMT,0)*0.1,3000000) - NVL(AP01.YETA_C131,0))
																								 , NVL(AP03.PNSN_SVNG_ISA_USE_AMT,0)
																								)
																					 ELSE LEAST(((9000000 + LEAST(((NVL(AP03.RTPN_ISA_USE_AMT,0) + NVL(AP03.PNSN_SVNG_ISA_USE_AMT,0))*0.1) , 3000000) - (NVL(AP01.YETA_C129,0) + NVL(AP01.YETA_C131,0)))
																							     - LEAST(9000000 + LEAST(((NVL(AP03.RTPN_ISA_USE_AMT,0) + NVL(AP03.PNSN_SVNG_ISA_USE_AMT,0))*0.1) , 3000000) - (NVL(AP01.YETA_C129,0) + NVL(AP01.YETA_C131,0))
																										 , NVL(AP03.RTPN_ISA_USE_AMT,0)))  
																								 , (6000000 + LEAST(NVL(AP03.PNSN_SVNG_ISA_USE_AMT,0)*0.1,3000000) - NVL(AP01.YETA_C131,0))
																								 , NVL(AP03.PNSN_SVNG_ISA_USE_AMT,0)
																								)
																					 END)		
																		  ELSE LEAST(((7000000 + LEAST(((NVL(AP03.RTPN_ISA_USE_AMT,0) + NVL(AP03.PNSN_SVNG_ISA_USE_AMT,0))*0.1) , 3000000) - (NVL(AP01.YETA_C129,0) + NVL(AP01.YETA_C131,0)))
																							     - LEAST(7000000 + LEAST(((NVL(AP03.RTPN_ISA_USE_AMT,0) + NVL(AP03.PNSN_SVNG_ISA_USE_AMT,0))*0.1) , 3000000) - (NVL(AP01.YETA_C129,0) + NVL(AP01.YETA_C131,0))
																										 , NVL(AP03.RTPN_ISA_USE_AMT,0)))
																								 , (4000000 + LEAST(NVL(AP03.PNSN_SVNG_ISA_USE_AMT,0)*0.1,3000000) - NVL(AP01.YETA_C131,0))
																								 , NVL(AP03.PNSN_SVNG_ISA_USE_AMT,0)
																								)
																		  END
											                       FROM YE169010 AP01 , YE161020 AP02 , YE161080 AP03
											                       WHERE AP01.DPOB_CD = AP02.DPOB_CD
											                       AND AP02.DPOB_CD = AP03.DPOB_CD
											                       AND AP01.YRTX_BLGG_YR = AP02.YRTX_BLGG_YR
											                       AND AP02.YRTX_BLGG_YR = AP03.YRTX_BLGG_YR
											                       AND AP01.SYSTEMKEY = AP02.SYSTEMKEY
											                       AND AP02.SYSTEMKEY = AP03.SYSTEMKEY
											                       AND AP01.CLUT_SEPT_CD = AP02.CLUT_SEPT_CD
											                       AND AP02.CLUT_SEPT_CD = AP03.CLUT_SEPT_CD
											                       AND AP01.DPOB_CD = #dpobCd#
											                       AND AP01.YRTX_BLGG_YR = #yrtxBlggYr#
											                       AND AP01.CLUT_SEPT_CD = #clutSeptCd#
											                       AND AP01.SYSTEMKEY = #systemkey#),0)
													 FROM YE169010 AP01 , YE161020 AP02 , YE161080 AP03
													 WHERE AP01.DPOB_CD = AP02.DPOB_CD
													 AND AP02.DPOB_CD = AP03.DPOB_CD
													 AND AP01.YRTX_BLGG_YR = AP02.YRTX_BLGG_YR
													 AND AP02.YRTX_BLGG_YR = AP03.YRTX_BLGG_YR
													 AND AP01.SYSTEMKEY = AP02.SYSTEMKEY
													 AND AP02.SYSTEMKEY = AP03.SYSTEMKEY
													 AND AP01.CLUT_SEPT_CD = AP02.CLUT_SEPT_CD
													 AND AP02.CLUT_SEPT_CD = AP03.CLUT_SEPT_CD
													 AND AP01.DPOB_CD = #dpobCd#
													 AND AP01.YRTX_BLGG_YR = #yrtxBlggYr#
													 AND AP01.CLUT_SEPT_CD = #clutSeptCd#
													 AND AP01.SYSTEMKEY = #systemkey#),0)
								                           
            					WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#                                                                        
			 
				]]>
	</update>   
	   
	   <!-- {공제단계 시작 -연금보험료공제 03_1 대상금액 구하는 로직 추가  05} 연금보험료공제 2014년 귀속 분 부터 세액공제 전환  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_21_Update">
		<![CDATA[
			 UPDATE YE169010                                                                      
               SET                                                                          
               /* JRTR_HICT IS '주근무지_과학기술인공제_퇴직연금소득공제  */                                   
               YETA_C128 =(CASE WHEN YE169010.YETA_0C63 <= 55000000 THEN  NVL(YETA_C127,0) * 0.15  
                                       ELSE    NVL( YETA_C127,0) * 0.12  END  )   ,                                                  

              /*  JRTR_PSRN IS '주근무지_근로자퇴직연금소득공제    */                                 
               YETA_C130 =(  CASE WHEN YE169010.YETA_0C63 <= 55000000 THEN NVL(YETA_C129,0) * 0.15   
                                       ELSE   NVL(YE169010.YETA_C129,0) * 0.12   END  ) ,                                                    

              /*   S '주근무지_연금계좌 소득공제   */                                  
               YETA_C132 =(CASE WHEN YE169010.YETA_0C63 <= 55000000 THEN  NVL(YETA_C131,0) * 0.15   
                                       ELSE  NVL(YE169010.YETA_C131,0) * 0.12 END) ,
                             
               YETA_C13B =(CASE WHEN YE169010.YETA_0C63 <= 55000000 THEN  NVL(YETA_C13A,0) * 0.15   
                                       ELSE  NVL(YE169010.YETA_C13A,0) * 0.12 END)                                                        
			 WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey# 
				]]>
	</update>   
	   
	
	   <!-- {공제단계 시작 -특별공제 - 보험료 - 2개로 분리하여 사용함. 06}  //특별공제 - 보험료 특별공제 - 보험료   -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_22_Update">
		<![CDATA[
			   UPDATE YE169010                                                                        
                  SET                                                                       
               /*  SPCI_GURT IS '특별공제_보장성보험료  대상금액   */                                  
                     YETA_C133 = (SELECT  ( CASE WHEN NVL(AD01.CVRG_INSC_USE_AMT,0) > 1000000      
                                             THEN 1000000                                   
                                             ELSE AD01.CVRG_INSC_USE_AMT                          
                                             END      )   
                                             FROM YE161080 AD01                                                                  
                                               WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY          
                                                 AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR         
                                                 AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
                                                 AND AD01.DPOB_CD  = YE169010.DPOB_CD )   ,                                                   
                /*  SPCI_HDRC IS '특별공제_장애인보장성보험료 대상금액 */                               
                       YETA_C135 = (SELECT  (  CASE WHEN NVL(AD01.DSBR_EU_CVRG_USE_AMT,0) > 1000000      
                                             THEN 1000000                                   
                                             ELSE AD01.DSBR_EU_CVRG_USE_AMT                          
                                             END         ) 
                                               FROM YE161080 AD01                                                                  
                                               WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY          
                                                 AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR         
                                                 AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
                                                 AND AD01.DPOB_CD  = YE169010.DPOB_CD )  
                WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#                                        
				]]>
	</update>   
		  
	   <!-- //특별공제 - 보험료 특별공제 - 보험료 -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_23_Update">
		<![CDATA[
			   UPDATE YE169010                                                                        
                  SET                                                                       
 
                  /* SPCI_GURT IS '특별공제_보장성보험료  */                                     
                     YETA_C134 =  (SELECT   TRUNC( (CASE WHEN NVL(AD01.CVRG_INSC_USE_AMT,0) > 1000000      
                                             THEN 1000000  * 0.12                                  
                                             ELSE AD01.CVRG_INSC_USE_AMT * 0.12                         
                                             END),-1)
                                                FROM YE161080 AD01                                                                  
                                               WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY          
                                                 AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR         
                                                 AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
                                                 AND AD01.DPOB_CD  = YE169010.DPOB_CD )    ,                                                   
                 /* SPCI_HDRC IS '특별공제_장애인보장성보험료      */                           
                      YETA_C136 =  (SELECT TRUNC((  CASE WHEN NVL(AD01.DSBR_EU_CVRG_USE_AMT,0) > 1000000      
                                             THEN 1000000  * 0.15                                 
                                             ELSE AD01.DSBR_EU_CVRG_USE_AMT  * 0.15                        
                                             END    ),-1)   
                                              FROM YE161080 AD01                                                                  
                                               WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY          
                                                 AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR         
                                                 AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
                                                 AND AD01.DPOB_CD  = YE169010.DPOB_CD )               
                  WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#      
				]]>
	</update>   
	   
	   <!-- 2021귀속부터 산후조리원비용 공제포함 --><!-- 여기여기 -->
	   <!--  {공제단계 시작 -특별공제 - 의료비  대상금액  07} -특별공제 - 의료비 대상금액구하는 루틴    -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_24_Update"> 
		<![CDATA[
			   UPDATE YE169010                                                                                                                                               
                        SET    
                        /*   SPCI_DTAR IS '특별공제)의료비공제대상금액 */
                   YETA_C137 =  GREATEST((SELECT  ( CASE WHEN  (NVL(AD01.MDXPS_OTH_USE_AMT,0) - (NVL(YE169010.YETA_0C63,0) * 0.03)) >= 0 /* 그밖의공제대상자 지출액이 총급여3% 초과 */                            
								                 THEN                                                                                                                              
								                       ( NVL(AD01.MDXPS_PRS_USE_AMT ,0) + NVL(AD01.MDXPS_SFT_SPRCD_USE_AMT ,0))                                         
								                 ELSE                                                                                                                             
								                     CASE WHEN ( (NVL(AD01.MDXPS_PRS_USE_AMT ,0) + NVL(AD01.MDXPS_SFT_SPRCD_USE_AMT ,0)) 
								                                          +  (NVL(AD01.MDXPS_OTH_USE_AMT,0) - (NVL(YE169010.YETA_0C63,0) * 0.03))) < 0    
			                                              THEN                                                                                                                                  
			                                                     0                                                                                                                               
			                                              ELSE                                                                                                                                      
			                                                ( (  NVL(AD01.MDXPS_PRS_USE_AMT ,0) +   NVL(AD01.MDXPS_SFT_SPRCD_USE_AMT ,0))
			                                                  +  (NVL(AD01.MDXPS_OTH_USE_AMT,0) - NVL(AD01.MEDXPS_USE_AMT_SUM,0) - (NVL(YE169010.YETA_0C63,0) * 0.03)))    
			                                              END                                                                                                                        
								                 END) 
								                 + ( CASE WHEN  (NVL(AD01.MDXPS_OTH_USE_AMT,0) - (NVL(YE169010.YETA_0C63,0) * 0.03)) >= 0 /* 그밖의공제대상자 지출액이 총급여3% 초과 */ 
						                                  THEN                                                                          
						                                     (CASE WHEN  (NVL(AD01.MDXPS_OTH_USE_AMT,0) - (NVL(YE169010.YETA_0C63,0) * 0.03))  > 7000000   
						                                           THEN    7000000                                                           
						                                           ELSE                                                                      
						                         	                 ( NVL(AD01.MDXPS_OTH_USE_AMT,0) - NVL(AD01.MEDXPS_USE_AMT_SUM,0) - (NVL(YE169010.YETA_0C63,0) * 0.03))             
						                                           END)                                                                        
						                                 ELSE                                                                                    
						                            	    0        
						                                  END )                                                                                                                     
                                               FROM YE161080 AD01                                                                  
                                               WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY          
                                                 AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR         
                                                 AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
                                                 AND AD01.DPOB_CD  = YE169010.DPOB_CD ),0)   
			WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#  
				]]>
	</update>	   
	   
	  <!--  특별공제 - 의료비  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_25_Update">   
		<![CDATA[
			    UPDATE YE161080  AD01                                                                                                                                             
                        SET    
                 /*   MDXPS_SFT_SPRCD_DDC_TRGT_AMT IS '특별공제)의료비공제대상금액 */
                   MDXPS_SFT_SPRCD_DDC_TRGT_AMT =  (SELECT  (  CASE WHEN ( (NVL(AD01.MDXPS_PRS_USE_AMT ,0) + NVL(AD01.MDXPS_SFT_SPRCD_USE_AMT ,0)) 
					                                           +  (NVL(AD01.MDXPS_OTH_USE_AMT,0) - (NVL(YE169010.YETA_0C63,0) * 0.03))) < 0    
					                                              THEN                                                                                                                                  
					                                                      CASE WHEN  ( (NVL(AD01.MDXPS_PRS_USE_AMT ,0) + NVL(AD01.MDXPS_SFT_SPRCD_USE_AMT ,0)) 
					                                                         +  (NVL(AD01.MDXPS_OTH_USE_AMT,0) - (NVL(YE169010.YETA_0C63,0) * 0.03)))  <= 0 THEN 0
					                                                       ELSE 
					                                                           ( (NVL(AD01.MDXPS_PRS_USE_AMT ,0) + NVL(AD01.MDXPS_SFT_SPRCD_USE_AMT ,0)) 
					                                                           +  (NVL(AD01.MDXPS_OTH_USE_AMT,0) - (NVL(YE169010.YETA_0C63,0) * 0.03)))
					                                                       END                                                                                                                            
					                                             ELSE                                                                                                                                      
					                                                   NVL(AD01.MDXPS_SFT_SPRCD_USE_AMT ,0)  
					                                             END     )                                                                                                       
                                               FROM YE169010                                                                  
                                               WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY          
                                                 AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR         
                                                 AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
                                                 AND AD01.DPOB_CD  = YE169010.DPOB_CD ),   
                   MDXPS_PRS_DDC_TRGT_AMT =  (SELECT  (CASE WHEN  (NVL(AD01.MDXPS_OTH_USE_AMT,0) - (NVL(YE169010.YETA_0C63,0) * 0.03)) >= 0                                                    
								                 THEN                                                                                                                              
								                         NVL(AD01.MDXPS_PRS_USE_AMT ,0)                                          
								                 ELSE                                                                                                                             
								                     CASE WHEN  (NVL(AD01.MDXPS_PRS_USE_AMT ,0)  +  (NVL(AD01.MDXPS_OTH_USE_AMT,0) - (NVL(YE169010.YETA_0C63,0) * 0.03))) < 0    
								                                              THEN                                                                                                                                  
								                                                     0                                                                                                                               
								                                             ELSE                                                                                                                                      
								                                                (  NVL(AD01.MDXPS_PRS_USE_AMT ,0)  
								                                                  + NVL(AD01.MDXPS_OTH_USE_AMT,0) - (NVL(YE169010.YETA_0C63,0) * 0.03))  
								                                             END                                                                                                                        
								                 END)                                                                                      
                                               FROM YE169010                                                                  
                                               WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY          
                                                 AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR         
                                                 AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
                                                 AND AD01.DPOB_CD  = YE169010.DPOB_CD ), 
                    MDXPS_OTH_DDC_TRGT_AMT = (SELECT ( CASE WHEN  (NVL(AD01.MDXPS_OTH_USE_AMT,0) - (NVL(YE169010.YETA_0C63,0) * 0.03)) >= 0         
			                                        THEN                                                                          
			                                           (CASE WHEN  (NVL(AD01.MDXPS_OTH_USE_AMT,0) - (NVL(YE169010.YETA_0C63,0) * 0.03))  > 7000000   
			                                                 THEN    7000000                                                           
			                                                 ELSE                                                                      
			                                                    ( NVL(AD01.MDXPS_OTH_USE_AMT,0) - (NVL(YE169010.YETA_0C63,0) * 0.03))             
			                                                 END)                                                                        
			                                        ELSE                                                                                    
			                                         0        
			                                        END )                                                                                                                     
                                               FROM YE169010                                                                  
                                               WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY          
                                                 AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR         
                                                 AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
                                                 AND AD01.DPOB_CD  = YE169010.DPOB_CD ) 
			 WHERE AD01.DPOB_CD=#dpobCd#
                                AND AD01.YRTX_BLGG_YR=#yrtxBlggYr#
                                AND AD01.CLUT_SEPT_CD=#clutSeptCd#
                                 AND AD01.SYSTEMKEY=#systemkey# 
				]]>
	</update>
	
	     <!--  특별공제 - 의료비 세분화하여공제함 그리고 합산처리  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_25_01_Update">   
		<![CDATA[
			  UPDATE YE161080                                                                                                                                
                        SET    
                        MDXPS_SFT_SPRCD_DDC_AMT  = 	(NVL(MDXPS_SFT_SPRCD_DDC_TRGT_AMT,0) * 0.3) ,  
						MDXPS_PRS_DDC_AMT        = 	(NVL(MDXPS_PRS_DDC_TRGT_AMT,0) * 0.15) , 
						MDXPS_OTH_DDC_AMT        = 	(NVL(MDXPS_OTH_DDC_TRGT_AMT,0) * 0.15) ,
						MDXPS_USE_AMT_SUM	     = (NVL(MDXPS_SFT_SPRCD_USE_AMT,0)+NVL(MDXPS_PRS_USE_AMT,0)/*+ NVL(MDXPS_LS_INSR_TR_AMT,0)*/+NVL(MDXPS_OTH_USE_AMT,0)),
						MDXPS_DDC_TRGT_AMT_SUM   = 
										(CASE WHEN 
										(NVL(MDXPS_SFT_SPRCD_DDC_TRGT_AMT,0) + NVL(MDXPS_PRS_DDC_TRGT_AMT,0) + NVL(MDXPS_OTH_DDC_TRGT_AMT,0) - NVL(MEDXPS_USE_AMT_SUM,0)) >= 0
										THEN
										 (NVL(MDXPS_SFT_SPRCD_DDC_TRGT_AMT,0) + NVL(MDXPS_PRS_DDC_TRGT_AMT,0) + NVL(MDXPS_OTH_DDC_TRGT_AMT,0) - NVL(MEDXPS_USE_AMT_SUM,0))
										ELSE 
										  0
										END),
						MDXPS_DDC_AMT_SUM        = 
										(CASE WHEN
											(NVL(MDXPS_SFT_SPRCD_DDC_TRGT_AMT,0) + NVL(MDXPS_PRS_DDC_TRGT_AMT,0) + NVL(MDXPS_OTH_DDC_TRGT_AMT,0) - NVL(MEDXPS_USE_AMT_SUM,0)) >= 0
										THEN
											(CASE WHEN
												(NVL(MDXPS_OTH_DDC_TRGT_AMT,0) - NVL(MEDXPS_USE_AMT_SUM,0)) >= 0
											THEN
												((NVL(MDXPS_OTH_DDC_TRGT_AMT,0) - NVL(MEDXPS_USE_AMT_SUM,0)) * 0.15) 
												+ (NVL(MDXPS_SFT_SPRCD_DDC_TRGT_AMT,0) * 0.3) 
												+ (NVL(MDXPS_PRS_DDC_TRGT_AMT,0) * 0.15)
											ELSE
												(CASE WHEN
													((NVL(MDXPS_OTH_DDC_TRGT_AMT,0) + NVL(MDXPS_PRS_DDC_TRGT_AMT,0)) - NVL(MEDXPS_USE_AMT_SUM,0)) >= 0
												 THEN
													((NVL(MDXPS_PRS_DDC_TRGT_AMT,0) + (NVL(MDXPS_OTH_DDC_TRGT_AMT,0) - NVL(MEDXPS_USE_AMT_SUM,0))) * 0.15)
													+ (NVL(MDXPS_SFT_SPRCD_DDC_TRGT_AMT,0) * 0.3)
												 ELSE
													(CASE WHEN
														((NVL(MDXPS_OTH_DDC_TRGT_AMT,0) + NVL(MDXPS_PRS_DDC_TRGT_AMT,0) + NVL(MDXPS_SFT_SPRCD_DDC_TRGT_AMT,0)) - NVL(MEDXPS_USE_AMT_SUM,0)) >= 0
													 THEN
														((NVL(MDXPS_SFT_SPRCD_DDC_TRGT_AMT,0) + ((NVL(MDXPS_OTH_DDC_TRGT_AMT,0) + NVL(MDXPS_PRS_DDC_TRGT_AMT,0)) - NVL(MEDXPS_USE_AMT_SUM,0))) * 0.3)
													 ELSE
														0
													 END
													)
												 END
												)
											END
											)
										ELSE
											0
										END)				
			            WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey# 
				]]>
	</update>
	
  <!-- {공제단계 시작 -특별공제 - 교육비 대상금액 08 -1 }  특별공제 - 교육비   -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_26_Update">
		<![CDATA[
			 UPDATE YE161080                                                                                                                 
                        SET       
                      /*  SPED_SFTR IS '특별공제)교육비_본인 - 전액  */                                                                
                         SCXPS_PRS_DDC_TRGT_AMT =        NVL(SCXPS_PRS_USE_AMT,0)  ,                                                                                      
                      /*  SPED_EDTR IS '특별공제)교육비_자녀등_미초중고 - 명당 300만원      */                                         
                         SCXPS_KID_DDC_TRGT_AMT =       ( SELECT    SUM(CASE WHEN NVL( AN01.DY00300100010 +  AN01.DY00300100020  + AN01.DY00300100040,0) > 3000000        
                                                           THEN 3000000                                                    
                                                           ELSE NVL( AN01.DY00300100010 +  AN01.DY00300100020  + AN01.DY00300100040,0)                                                          
                                                           END) AS  DY00300100010     
                                                         FROM 
                                                       (SELECT       YE161030.DPOB_CD 
                                                        ,YE161030.YRTX_BLGG_YR 
                                                        ,YE161030.CLUT_SEPT_CD 
                                                        ,YE161030.SYSTEMKEY  
                                                        ,YE161030.TXPR_DSCM_NO_CNTN 
                                                         ,   NVL((SELECT  SUM(SCXPS_USE_AMT) AS SCXPS_USE_AMT 
                                                                 FROM YE161090 AA 
                                                                WHERE  AA.SCXPS_STD = 'Y0030010'
                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200010','Y0200030','Y0200050')
                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ),0) AS DY00300100010
                                                                ,(CASE WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                    FROM YE161090 AA
                                                                    WHERE  AA.SCXPS_STD = 'Y0030010'
                                                                      AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200020')
                                                                      AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                      AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                      AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                      AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                      AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) < 300000 THEN 
                                                                       (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                    FROM YE161090 AA
                                                                    WHERE  AA.SCXPS_STD = 'Y0030010'
                                                                      AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200020')
                                                                      AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                      AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                      AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                      AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                      AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN )
                                                                  WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                    FROM YE161090 AA
                                                                    WHERE  AA.SCXPS_STD = 'Y0030010'
                                                                      AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200020')
                                                                      AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                      AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                      AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                      AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                      AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) >=  300000 
                                                                      THEN 300000 ELSE 0 END) AS DY00300100020 
                                                              , (CASE WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                                 FROM YE161090 AA
                                                                                WHERE  AA.SCXPS_STD = 'Y0030010'
                                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200040')
                                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) < 500000 THEN
                                                                              (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                                 FROM YE161090 AA
                                                                                WHERE  AA.SCXPS_STD = 'Y0030010'
                                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200040')
                                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN )
                                                                    WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                                 FROM YE161090 AA
                                                                                WHERE  AA.SCXPS_STD = 'Y0030010'
                                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200040')
                                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) >=  500000 
                                                                       THEN   500000 ELSE 0 END) AS DY00300100040
                                                                       
                                                              , NVL((SELECT  SUM(SCXPS_USE_AMT) AS SCXPS_USE_AMT 
                                                                 FROM YE161090 AA 
                                                                WHERE  AA.SCXPS_STD = 'Y0030020'
                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200010','Y0200030','Y0200050')
                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ),0) AS DY00300200010
                                                                ,(CASE WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                    FROM YE161090 AA
                                                                    WHERE  AA.SCXPS_STD = 'Y0030020'
                                                                      AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200020')
                                                                      AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                      AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                      AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                      AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                      AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) < 300000 THEN 
                                                                       (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                    FROM YE161090 AA
                                                                    WHERE  AA.SCXPS_STD = 'Y0030020'
                                                                      AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200020')
                                                                      AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                      AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                      AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                      AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                      AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN )
                                                                  WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                    FROM YE161090 AA
                                                                    WHERE  AA.SCXPS_STD = 'Y0030020'
                                                                      AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200020')
                                                                      AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                      AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                      AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                      AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                      AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) >=  300000 
                                                                      THEN 300000 ELSE 0 END) AS DY00300200020 
                                                              , (CASE WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                                 FROM YE161090 AA
                                                                                WHERE  AA.SCXPS_STD = 'Y0030020'
                                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200040')
                                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) < 500000 THEN
                                                                              (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                                 FROM YE161090 AA
                                                                                WHERE  AA.SCXPS_STD = 'Y0030020'
                                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200040')
                                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN )
                                                                    WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                                 FROM YE161090 AA
                                                                                WHERE  AA.SCXPS_STD = 'Y0030020'
                                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200040')
                                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) >=  500000 
                                                                       THEN   500000 ELSE 0 END) AS DY00300200040
                                               , NVL((SELECT  SUM(SCXPS_USE_AMT) AS SCXPS_USE_AMT 
                                                                 FROM YE161090 AA 
                                                                WHERE  AA.SCXPS_STD = 'Y0030030'
                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200010','Y0200030','Y0200050')
                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ),0) AS DY00300300010                        
                                                     FROM    YE161030       
                                                    WHERE    DPOB_CD=#dpobCd#
							                                AND YRTX_BLGG_YR=#yrtxBlggYr#
							                                AND CLUT_SEPT_CD=#clutSeptCd#
							                                 AND SYSTEMKEY=#systemkey#) AN01 
                                                       WHERE   YE161080.DPOB_CD=AN01.DPOB_CD
                                                        AND YE161080.YRTX_BLGG_YR=AN01.YRTX_BLGG_YR
                                                        AND YE161080.CLUT_SEPT_CD=AN01.CLUT_SEPT_CD
                                                        AND YE161080.SYSTEMKEY=AN01.SYSTEMKEY )  ,                                                                                     
                       /*  SPED_GDTR IS '특별공제_교육비_초중고  명당 300만원 교복구입비로 루틴 추가 체험학습비   */                                                      
                        SCXPS_STD_DDC_TRGT_AMT   =  ( SELECT    SUM(CASE WHEN NVL(  AN01.DY00300200010 + AN01.DY00300200020  + AN01.DY00300200040,0) > 3000000              
                                                       THEN 3000000                                                    
                                                       ELSE  AN01.DY00300200010 + AN01.DY00300200020  + AN01.DY00300200040                                                          
                                                       END) AS   DY00300200010   
                                                         FROM 
                                                       (SELECT       YE161030.DPOB_CD 
                                                        ,YE161030.YRTX_BLGG_YR 
                                                        ,YE161030.CLUT_SEPT_CD 
                                                        ,YE161030.SYSTEMKEY  
                                                        ,YE161030.TXPR_DSCM_NO_CNTN 
                                                         ,   NVL((SELECT  SUM(SCXPS_USE_AMT) AS SCXPS_USE_AMT 
                                                                 FROM YE161090 AA 
                                                                WHERE  AA.SCXPS_STD = 'Y0030010'
                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200010','Y0200030','Y0200050')
                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ),0) AS DY00300100010
                                                                ,(CASE WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                    FROM YE161090 AA
                                                                    WHERE  AA.SCXPS_STD = 'Y0030010'
                                                                      AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200020')
                                                                      AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                      AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                      AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                      AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                      AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) < 300000 THEN 
                                                                       (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                    FROM YE161090 AA
                                                                    WHERE  AA.SCXPS_STD = 'Y0030010'
                                                                      AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200020')
                                                                      AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                      AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                      AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                      AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                      AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN )
                                                                  WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                    FROM YE161090 AA
                                                                    WHERE  AA.SCXPS_STD = 'Y0030010'
                                                                      AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200020')
                                                                      AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                      AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                      AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                      AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                      AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) >=  300000 
                                                                      THEN 300000 ELSE 0 END) AS DY00300100020 
                                                              , (CASE WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                                 FROM YE161090 AA
                                                                                WHERE  AA.SCXPS_STD = 'Y0030010'
                                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200040')
                                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) < 500000 THEN
                                                                              (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                                 FROM YE161090 AA
                                                                                WHERE  AA.SCXPS_STD = 'Y0030010'
                                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200040')
                                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN )
                                                                    WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                                 FROM YE161090 AA
                                                                                WHERE  AA.SCXPS_STD = 'Y0030010'
                                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200040')
                                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) >=  500000 
                                                                       THEN   500000 ELSE 0 END) AS DY00300100040
                                                                       
                                                              , NVL((SELECT  SUM(SCXPS_USE_AMT) AS SCXPS_USE_AMT 
                                                                 FROM YE161090 AA 
                                                                WHERE  AA.SCXPS_STD = 'Y0030020'
                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200010','Y0200030','Y0200050')
                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ),0) AS DY00300200010
                                                                ,(CASE WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                    FROM YE161090 AA
                                                                    WHERE  AA.SCXPS_STD = 'Y0030020'
                                                                      AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200020')
                                                                      AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                      AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                      AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                      AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                      AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) < 300000 THEN 
                                                                       (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                    FROM YE161090 AA
                                                                    WHERE  AA.SCXPS_STD = 'Y0030020'
                                                                      AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200020')
                                                                      AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                      AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                      AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                      AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                      AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN )
                                                                  WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                    FROM YE161090 AA
                                                                    WHERE  AA.SCXPS_STD = 'Y0030020'
                                                                      AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200020')
                                                                      AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                      AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                      AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                      AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                      AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) >=  300000 
                                                                      THEN 300000 ELSE 0 END) AS DY00300200020 
                                                              , (CASE WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                                 FROM YE161090 AA
                                                                                WHERE  AA.SCXPS_STD = 'Y0030020'
                                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200040')
                                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) < 500000 THEN
                                                                              (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                                 FROM YE161090 AA
                                                                                WHERE  AA.SCXPS_STD = 'Y0030020'
                                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200040')
                                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN )
                                                                    WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                                 FROM YE161090 AA
                                                                                WHERE  AA.SCXPS_STD = 'Y0030020'
                                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200040')
                                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) >=  500000 
                                                                       THEN   500000 ELSE 0 END) AS DY00300200040
                                               , NVL((SELECT  SUM(SCXPS_USE_AMT) AS SCXPS_USE_AMT 
                                                                 FROM YE161090 AA 
                                                                WHERE  AA.SCXPS_STD = 'Y0030030'
                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200010','Y0200030','Y0200050')
                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ),0) AS DY00300300010                        
                                                     FROM    YE161030       
                                                    WHERE    DPOB_CD=#dpobCd#
							                                AND YRTX_BLGG_YR=#yrtxBlggYr#
							                                AND CLUT_SEPT_CD=#clutSeptCd#
							                                 AND SYSTEMKEY=#systemkey#) AN01 
                                                       WHERE   YE161080.DPOB_CD=AN01.DPOB_CD
                                                        AND YE161080.YRTX_BLGG_YR=AN01.YRTX_BLGG_YR
                                                        AND YE161080.CLUT_SEPT_CD=AN01.CLUT_SEPT_CD
                                                        AND YE161080.SYSTEMKEY=AN01.SYSTEMKEY )  
                                                  ,                                                                                     
                      /*  SPED_CVTR IS '특별공제)교육비_자녀등_대학교     */                                                           
                         SCXPS_UND_DDC_TRGT_AMT   =           ( SELECT    SUM(CASE WHEN NVL( AN01.DY00300300010,0) > 9000000           
                                                                       THEN 9000000                                                  
                                                                       ELSE  NVL( AN01.DY00300300010,0)                                                          
                                                                       END   ) AS DY00300300010  
                                                         FROM 
                                                       (SELECT       YE161030.DPOB_CD 
                                                        ,YE161030.YRTX_BLGG_YR 
                                                        ,YE161030.CLUT_SEPT_CD 
                                                        ,YE161030.SYSTEMKEY  
                                                        ,YE161030.TXPR_DSCM_NO_CNTN 
                                                         ,   NVL((SELECT  SUM(SCXPS_USE_AMT) AS SCXPS_USE_AMT 
                                                                 FROM YE161090 AA 
                                                                WHERE  AA.SCXPS_STD = 'Y0030010'
                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200010','Y0200030','Y0200050')
                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ),0) AS DY00300100010
                                                                ,(CASE WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                    FROM YE161090 AA
                                                                    WHERE  AA.SCXPS_STD = 'Y0030010'
                                                                      AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200020')
                                                                      AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                      AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                      AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                      AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                      AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) < 300000 THEN 
                                                                       (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                    FROM YE161090 AA
                                                                    WHERE  AA.SCXPS_STD = 'Y0030010'
                                                                      AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200020')
                                                                      AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                      AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                      AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                      AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                      AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN )
                                                                  WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                    FROM YE161090 AA
                                                                    WHERE  AA.SCXPS_STD = 'Y0030010'
                                                                      AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200020')
                                                                      AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                      AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                      AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                      AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                      AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) >=  300000 
                                                                      THEN 300000 ELSE 0 END) AS DY00300100020 
                                                              , (CASE WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                                 FROM YE161090 AA
                                                                                WHERE  AA.SCXPS_STD = 'Y0030010'
                                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200040')
                                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) < 500000 THEN
                                                                              (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                                 FROM YE161090 AA
                                                                                WHERE  AA.SCXPS_STD = 'Y0030010'
                                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200040')
                                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN )
                                                                    WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                                 FROM YE161090 AA
                                                                                WHERE  AA.SCXPS_STD = 'Y0030010'
                                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200040')
                                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) >=  500000 
                                                                       THEN   500000 ELSE 0 END) AS DY00300100040
                                                                       
                                                              , NVL((SELECT  SUM(SCXPS_USE_AMT) AS SCXPS_USE_AMT 
                                                                 FROM YE161090 AA 
                                                                WHERE  AA.SCXPS_STD = 'Y0030020'
                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200010','Y0200030','Y0200050')
                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ),0) AS DY00300200010
                                                                ,(CASE WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                    FROM YE161090 AA
                                                                    WHERE  AA.SCXPS_STD = 'Y0030020'
                                                                      AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200020')
                                                                      AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                      AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                      AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                      AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                      AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) < 300000 THEN 
                                                                       (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                    FROM YE161090 AA
                                                                    WHERE  AA.SCXPS_STD = 'Y0030020'
                                                                      AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200020')
                                                                      AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                      AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                      AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                      AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                      AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN )
                                                                  WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                    FROM YE161090 AA
                                                                    WHERE  AA.SCXPS_STD = 'Y0030020'
                                                                      AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200020')
                                                                      AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                      AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                      AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                      AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                      AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) >=  300000 
                                                                      THEN 300000 ELSE 0 END) AS DY00300200020 
                                                              , (CASE WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                                 FROM YE161090 AA
                                                                                WHERE  AA.SCXPS_STD = 'Y0030020'
                                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200040')
                                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) < 500000 THEN
                                                                              (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                                 FROM YE161090 AA
                                                                                WHERE  AA.SCXPS_STD = 'Y0030020'
                                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200040')
                                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN )
                                                                    WHEN (SELECT   SUM(SCXPS_USE_AMT)  AS SCXPS_USE_AMT 
                                                                                 FROM YE161090 AA
                                                                                WHERE  AA.SCXPS_STD = 'Y0030020'
                                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200040')
                                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ) >=  500000 
                                                                       THEN   500000 ELSE 0 END) AS DY00300200040
                                               , NVL((SELECT  SUM(SCXPS_USE_AMT) AS SCXPS_USE_AMT 
                                                                 FROM YE161090 AA 
                                                                WHERE  AA.SCXPS_STD = 'Y0030030'
                                                                     AND AA.SCXPS_STD_CL_DIV_CD IN ( 'Y0200010','Y0200030','Y0200050')
                                                                        AND YE161030.DPOB_CD=AA.DPOB_CD
                                                                        AND YE161030.YRTX_BLGG_YR=AA.YRTX_BLGG_YR
                                                                        AND YE161030.CLUT_SEPT_CD=AA.CLUT_SEPT_CD
                                                                        AND YE161030.SYSTEMKEY=AA.SYSTEMKEY 
                                                                        AND YE161030.TXPR_DSCM_NO_CNTN = AA.FAM_RESNO_ENC_CNTN ),0) AS DY00300300010                        
                                                     FROM    YE161030       
                                                    WHERE   DPOB_CD=#dpobCd#
							                                AND YRTX_BLGG_YR=#yrtxBlggYr#
							                                AND CLUT_SEPT_CD=#clutSeptCd#
							                                 AND SYSTEMKEY=#systemkey# ) AN01 
                                                       WHERE   YE161080.DPOB_CD=AN01.DPOB_CD
                                                        AND YE161080.YRTX_BLGG_YR=AN01.YRTX_BLGG_YR
                                                        AND YE161080.CLUT_SEPT_CD=AN01.CLUT_SEPT_CD
                                                        AND YE161080.SYSTEMKEY=AN01.SYSTEMKEY )  ,                                                                                    
                       /*  SPCI_SCTR IS '특별공제)장애인특수교육비    */                                                               
                        SCXPS_DSBR_DDC_TRGT_AMT =   NVL(SCXPS_DSBR_USE_AMT,0)               
    					 WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#
				]]>
	</update>	   
   <!-- {공제단계 시작 -특별공제 - 교육비 공제  08 -2 } 특별공제 - 교육비   -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_27_Update">
		<![CDATA[
			  UPDATE YE161080                                                                                                                 
                        SET                                                                                                        
                       /* SPED_SELF IS '특별공제)교육비_본인 - 전액   */                                                               
                         SCXPS_PRS_DDC_AMT =   TRUNC((  NVL(SCXPS_PRS_DDC_TRGT_AMT,0)  * 0.15   ),0),                                                                                      
                       /* SPED_GRDE IS '특별공제)교육비_자녀등_미초중고 - 명당 300만원 */                                              
                         SCXPS_KID_DDC_AMT =       TRUNC((  NVL(SCXPS_KID_DDC_TRGT_AMT,0)  * 0.15  ),0) ,                                                                                     
                       /*  SPED_GDTO IS '특별공제_교육비_초중고  명당 300만원  */                                                      
                        SCXPS_STD_DDC_AMT   = TRUNC((   NVL(SCXPS_STD_DDC_TRGT_AMT,0)  * 0.15   ),0) ,                                                                                     
                      /*  SPED_CLDV IS '특별공제)교육비_자녀등_대학교 */                                                               
                         SCXPS_UND_DDC_AMT   =   TRUNC((   NVL(SCXPS_UND_DDC_TRGT_AMT,0)  * 0.15 ),0)  ,                                                                                    
                       /*  SPCI_SPEC IS '특별공제)장애인특수교육비   */                                                                
                        SCXPS_DSBR_DDC_AMT = TRUNC((NVL(SCXPS_DSBR_DDC_TRGT_AMT,0)  * 0.15 ),0)             
                     WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey# 
				]]>
	</update>	   
	   
	   <!-- 임시  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnPayr06430_PAYR425_ReTax_2016_CREATE_06_1_Update">
		<![CDATA[
			  UPDATE YETA3180  
                  SET  CRTB_CNCD =   NVL((CASE WHEN CRTB_TYCD IS NULL THEN (CASE WHEN CRTB_CNCD IN ('A0190001')  THEN 'Y0180001'                                                                                                                    
										           WHEN CRTB_CNCD IN ('A0190002','A0190007')  THEN 'Y0180002'                                                                                                                
										           WHEN CRTB_CNCD IN ('A0190003','A0190004','A0190009','A0190010','A0190017','A0190018','A0190019' ,'A0190053','A0190054','A0190055','A0190056','A0190051','A0190050','A0190078','A0190079')  THEN 'Y0180004'    
										           WHEN CRTB_CNCD IN ('A0190011','A0190012','A0190013','A0190021','A0190023')  THEN 'Y0180006'                                                                                           
										           WHEN CRTB_CNCD IN ('A0190005','A0190040' ,'A0190099','A0190076')  THEN  'Y0180003'                                                                                        
										           WHEN CRTB_CNCD IN ('A0190020' ,'A0190022' ,'A0190025','A0190033','A0190035' ,'A0190051','A0190052' ,'A0190032','A0190038')  THEN 'Y0180005'   
										           WHEN CRTB_CNCD IN ('A0190109','A01900ZZ','A01900A7','A0190032')  THEN 'Y0180006'                             
										           WHEN CRTB_CNCD IN ('A0190100')  THEN 'Y0180006'  ELSE 
												          YETA3180.CRTB_TYCD
                                                  END)
					                           	ELSE YETA3180.CRTB_TYCD  END),CRTB_CNCD)  , 
                    CRTB_TYCD  = NVL((SELECT CASE WHEN YE161030.FAMY_SUPPT_RELA_DIV_CD = 'Y0120000' THEN  'Y0180001' 
								                    WHEN YE161030.FAMY_SUPPT_RELA_DIV_CD = 'Y0120003' THEN  'Y0180002' 
								                    WHEN YE161030.FAMY_SUPPT_RELA_DIV_CD IN ('Y0120004','Y0120005') THEN  'Y0180003' 
								                    WHEN YE161030.FAMY_SUPPT_RELA_DIV_CD  IN ('Y0120001','Y0120002') THEN  'Y0180004' 
								                    WHEN YE161030.FAMY_SUPPT_RELA_DIV_CD = 'Y0120006' THEN  'Y0180005' 
								                    ELSE   'Y0180006' END                                 
                                  FROM YE161030                                                                               
                               WHERE YE161030.SYSTEMKEY = YETA3180.SYSTEMKEY                                                   
                                 AND YE161030.YRTX_BLGG_YR = YETA3180.YRTX_BLGG_YR                                                   
                                 AND YE161030.CLUT_SEPT_CD = YETA3180.CLUT_SEPT_CD 
                                   AND YE161030.DPOB_CD = YETA3180.DPOB_CD
                                   AND YE161030.RSNO_NUMB = YETA3180.RSNO_NUMB                                                       
                                  ), CRTB_TYCD) ,                     
                    CTRB_NCNT   =  DECODE(NVL(CTRB_NCNT,'0'),'0','1',CTRB_NCNT)	
                      WHERE    DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey# 
				]]>
	</update>   
	   
		   <!-- {공제단계 시작 -특별공제 - 기부금공제     12 } 기부금공제 1   -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_29_Update">
		<![CDATA[
	   UPDATE YE169010                                                                                                                                                                         
                SET  
                 YETA_C138 = (SELECT   NVL(MDXPS_DDC_AMT_SUM,0)                                                                                                                     
                                              FROM YE161080 AD01                                                                                                                                                                       
				                              WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                                                          
				                                AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                                                          
				                                AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
				                                AND AD01.DPOB_CD  = YE169010.DPOB_CD     ),
                                                 
                /* 교육비 데이타 업데이트   */
                  YETA_C139 = (SELECT NVL(AD01.SCXPS_PRS_DDC_TRGT_AMT,0) + NVL(AD01.SCXPS_KID_DDC_TRGT_AMT,0) + NVL(AD01.SCXPS_STD_DDC_TRGT_AMT,0) + NVL(AD01.SCXPS_UND_DDC_TRGT_AMT,0) + NVL(AD01.SCXPS_DSBR_DDC_TRGT_AMT,0)                                                            
                               FROM YE161080 AD01                                                                                                                                                                       
                              WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                                                          
                                AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                                                          
                                AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
                                AND AD01.DPOB_CD  = YE169010.DPOB_CD                                                                                                                                          
                          ),   
                  YETA_C140 = (SELECT NVL(AD01.SCXPS_PRS_DDC_AMT,0) + NVL(AD01.SCXPS_KID_DDC_AMT,0) + NVL(AD01.SCXPS_STD_DDC_AMT,0) + NVL(AD01.SCXPS_UND_DDC_AMT,0) + NVL(AD01.SCXPS_DSBR_DDC_AMT,0)                                                            
                               FROM YE161080 AD01                                                                                                                                                                       
                              WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                                                          
                                AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                                                          
                                AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
                                AND AD01.DPOB_CD  = YE169010.DPOB_CD                                                                                                                                          
                          ),             
 /*  //정치 기부금 10만원처리 부분..... TAXD_10TG 이하대상금액  */
                YETA_C141 = (SELECT NVL(AD01.CONB10TTSW_LT_USE_AMT,0)                                                           
                               FROM YE161080 AD01                                                                                                                                                                       
                              WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                                                          
                                AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                                                          
                                AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
                                AND AD01.DPOB_CD  = YE169010.DPOB_CD                                                                                                                                          
                          ),                                                                                                                                                                                       

 /*  //특별공제 기부금 _정치   10만원초과 금액 대상금액  */
                               YETA_C143 = (SELECT (CASE WHEN NVL(AD01.CONB10EXCS_LT_USE_AMT,0) > NVL(YE169010.YETA_0C65,0)                                                                                   
                                                             THEN  NVL(YE169010.YETA_0C65,0)  
                                                             ELSE  NVL(AD01.CONB10EXCS_LT_USE_AMT,0)  
                                                            END)                                                                                                                                    
                                                       FROM YE161080 AD01                                                                                                                                                                       
							                              WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                                                          
							                                AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                                                          
							                                AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
							                                AND AD01.DPOB_CD  = YE169010.DPOB_CD                                                                                               
                                                     )                                                                                                                                              
                           WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey# 
				]]>
	</update>   
	   
	   <!--  기부금공제 1  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_30_Update">
		<![CDATA[
			                UPDATE YE169010                                                                                                                                                                          
                               SET                                                                                                                                         
/* //정치 기부금 10만원처리 부분..... TAXD_10TG 이하금액 */
/* (기부금*100/110)이 근로소득보다 적으면 (기부금*100/110) 크면 근로소득만큼만 */
                YETA_C142 = (  CASE WHEN  NVL(YE169010.YETA_0C65,0) >= TRUNC(NVL(YETA_C141,0) * (100/110))     
                                    THEN  TRUNC(NVL(YETA_C141,0) * (100/110))                                   
                                    ELSE  NVL(YE169010.YETA_0C65,0)  END),                                                                                                                                                                                                                                                                                                                                                                     

/*   //특별공제 기부금 _정치   10만원초과 금액 공제새액 SPCI_PLTC */
               YETA_C144 = ( CASE WHEN NVL(YETA_C143,0) > NVL((YE169010.YETA_0C65 - YE169010.YETA_C141),0)                                                                                   
                                  THEN CASE WHEN NVL(YE169010.YETA_0C65,0) <= 30000000 
                                  			THEN NVL(YE169010.YETA_0C65,0) * 0.15  
                                            ELSE (30000000 * 0.15) +  ((NVL(YE169010.YETA_0C65,0)  - 30000000) * 0.25) END 
                                  ELSE CASE WHEN NVL(YETA_C143,0)  <= 30000000
                                  			THEN NVL(YETA_C143,0)  * 0.15           
                                            ELSE (30000000 * 0.15) +  ((NVL(YETA_C143,0)  - 30000000) * 0.25) END  
                                   END),                                                                                                                                             
 /*   년도별 기부금 정리 작업  법정기부금  */
                      SPCI_FB15 = (SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2015'
                                                          AND AD01.CTRB_TYCD = '10'    ) ,    
/*   년도별 기부금 정리 작업  법정기부금  */
                      SPCI_FB16 = (SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2016'
                                                          AND AD01.CTRB_TYCD = '10'    ) ,      
                     SPCI_FB17 = (SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2017'
                                                          AND AD01.CTRB_TYCD = '10'    ) ,                                                                                                    
                     SPCI_FB18 = (SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2018'
                                                          AND AD01.CTRB_TYCD = '10'    ) ,
                    SPCI_FB19 = (SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2019'
                                                          AND AD01.CTRB_TYCD = '10'    ) , 
                    SPCI_FB20 = (SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2020'
                                                          AND AD01.CTRB_TYCD = '10'    ) , 
                    SPCI_FB21 = (SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2021'
                                                          AND AD01.CTRB_TYCD = '10'    ) ,
                    SPCI_FB22 = (SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2022'
                                                          AND AD01.CTRB_TYCD = '10'    ) ,                             
                                                                                                                                                                                                                                                        
						/* 년도별 기부금 정리 작업  종교단체외기부금   */
                           SPCI_NA15 = (SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2015'
                                                          AND AD01.CTRB_TYCD = '40'    ) ,
                           SPCI_NA16 = (SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2016'
                                                          AND AD01.CTRB_TYCD = '40'    ) ,      
                     SPCI_NA17 = (SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2017'
                                                          AND AD01.CTRB_TYCD = '40'    ) ,                                                                                                    
                     SPCI_NA18 = (SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2018'
                                                          AND AD01.CTRB_TYCD = '40'    ) , 
                     SPCI_NA19 = (SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2019'
                                                          AND AD01.CTRB_TYCD = '40'    ) ,
                     SPCI_NA20 = NVL((SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2020'
                                                          AND AD01.CTRB_TYCD = '40'    ),0) ,
                     SPCI_NA21 = NVL((SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2021'
                                                          AND AD01.CTRB_TYCD = '40'    ),0) ,
                    SPCI_NA22 = NVL((SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2022'
                                                          AND AD01.CTRB_TYCD = '40'    ),0) ,                        
    /*   년도별 기부금 정리 작업  종교단체기부금   */
                           SPCI_YA15 = (SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2015'
                                                          AND AD01.CTRB_TYCD = '41'    ) ,    
                           SPCI_YA16 = (SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2016'
                                                          AND AD01.CTRB_TYCD = '41'    ) ,      
                     SPCI_YA17 = (SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2017'
                                                          AND AD01.CTRB_TYCD = '41'    ) ,                                                                                                    
                     SPCI_YA18 = (SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2018'
                                                          AND AD01.CTRB_TYCD = '41'    ) ,       
                     SPCI_YA19 = (SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2019'
                                                          AND AD01.CTRB_TYCD = '41'    ) ,
                     SPCI_YA20 = (SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2020'
                                                          AND AD01.CTRB_TYCD = '41'    ) ,      
                     SPCI_YA21 = (SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2021'
                                                          AND AD01.CTRB_TYCD = '41'    ) ,
                     SPCI_YA22 = (SELECT SUM(NVL(AD01.USE_AMT,0) - NVL(AD01.PYR_DDC_AMT,0))                                                                                                                                   
                                                       FROM YE165030 AD01                                                                                                                                
                                                        WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                 
                                                          AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                 
                                                          AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                                          AND AD01.DPOB_CD  = YE169010.DPOB_CD 
                                                          AND AD01.ATTR_YR = '2022'
                                                          AND AD01.CTRB_TYCD = '41'    )
                                                                                                                                 
 					 WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey# 
				]]>
	</update>

	   <!-- 기부금공제 1-법정기부금 대상금액 --><!-- 기부금공제순서변경하기 15년-16년 공제  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_31_Update">
		<![CDATA[
			       	UPDATE YE169010 SET
					SPCI_FBTG15 = LEAST(NVL(SPCI_FB15,0), (NVL(YE169010.YETA_0C65,0) - (NVL(YETA_C143,0) + NVL(YETA_C141,0)))),
					SPCI_FBTG16 = LEAST(NVL(SPCI_FB16,0), (NVL(YE169010.YETA_0C65,0) - (NVL(YETA_C143,0) + NVL(YETA_C141,0)) 
																					 - LEAST(NVL(SPCI_FB15,0),
																						(NVL(YE169010.YETA_0C65,0) - (NVL(YETA_C143,0) + NVL(YETA_C141,0))))))
					WHERE DPOB_CD=#dpobCd#
					AND YRTX_BLGG_YR=#yrtxBlggYr#
					AND CLUT_SEPT_CD=#clutSeptCd#
					AND SYSTEMKEY=#systemkey#
				]]>
	</update> 
	
	     <!-- 기부금공제 1-법정기부금 대상금액  17년-18년-19년 공제 -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_31_01_Update">
		<![CDATA[
			        UPDATE YE169010 SET
					SPCI_FBTG17 =  LEAST(NVL(SPCI_FB17,0), (NVL(YE169010.YETA_0C65,0) - (NVL(YETA_C143,0) + NVL(YETA_C141,0)) 
																  - NVL(SPCI_FBTG15,0) 
																  - NVL(SPCI_FBTG16,0))),
					SPCI_FBTG18 =  LEAST(NVL(SPCI_FB18,0), (NVL(YE169010.YETA_0C65,0) - (NVL(YETA_C143,0) + NVL(YETA_C141,0))  
																  - NVL(SPCI_FBTG15,0) 
																  - NVL(SPCI_FBTG16,0)
																  - (LEAST(NVL(SPCI_FB17,0), (NVL(YE169010.YETA_0C65,0) - 
																							(NVL(YETA_C143,0) + NVL(YETA_C141,0)) -
																							NVL(SPCI_FBTG15,0) - NVL(SPCI_FBTG16,0)))))),
					SPCI_FBTG19 =  LEAST(NVL(SPCI_FB19,0), (NVL(YE169010.YETA_0C65,0) - (NVL(YETA_C143,0) + NVL(YETA_C141,0))  
																  - NVL(SPCI_FBTG15,0) 
																  - NVL(SPCI_FBTG16,0)
																  - (LEAST(NVL(SPCI_FB17,0), (NVL(YE169010.YETA_0C65,0) 
																							- (NVL(YETA_C143,0) + NVL(YETA_C141,0)) 
																							- NVL(SPCI_FBTG15,0)
																							- NVL(SPCI_FBTG16,0))))
																  - (LEAST(NVL(SPCI_FB18,0), (NVL(YE169010.YETA_0C65,0) -
																							(NVL(YETA_C143,0) + NVL(YETA_C141,0))  
																							 - NVL(SPCI_FBTG15,0) 
																							 - NVL(SPCI_FBTG16,0)
																						     - (LEAST(NVL(SPCI_FB17,0), (NVL(YE169010.YETA_0C65,0) - 
																													    (NVL(YETA_C143,0) + NVL(YETA_C141,0)) 
																														- NVL(SPCI_FBTG15,0)
																														- NVL(SPCI_FBTG16,0))))))))),
					SPCI_FBTG20 = LEAST(NVL(SPCI_FB20,0), (NVL(YE169010.YETA_0C65,0) - (NVL(YETA_C143,0) + NVL(YETA_C141,0))
																- NVL(SPCI_FBTG15,0) 
																- NVL(SPCI_FBTG16,0)	
																- (LEAST(NVL(SPCI_FB17,0), (NVL(YE169010.YETA_0C65,0) 
																							- (NVL(YETA_C143,0) + NVL(YETA_C141,0)) 
																							- NVL(SPCI_FBTG15,0)
																							- NVL(SPCI_FBTG16,0))))														
																- (LEAST(NVL(SPCI_FB18,0), (NVL(YE169010.YETA_0C65,0) -
																							(NVL(YETA_C143,0) + NVL(YETA_C141,0))  
																							 - NVL(SPCI_FBTG15,0) 
																							 - NVL(SPCI_FBTG16,0)
																						     - (LEAST(NVL(SPCI_FB17,0), (NVL(YE169010.YETA_0C65,0) - 
																													    (NVL(YETA_C143,0) + NVL(YETA_C141,0)) 
																														- NVL(SPCI_FBTG15,0)
																														- NVL(SPCI_FBTG16,0)))))))							
																- (LEAST(NVL(SPCI_FB19,0), (NVL(YE169010.YETA_0C65,0) -
																							(NVL(YETA_C143,0) + NVL(YETA_C141,0))
																							 - NVL(SPCI_FBTG15,0) 
																							 - NVL(SPCI_FBTG16,0)
																							 - (LEAST(NVL(SPCI_FB17,0), (NVL(YE169010.YETA_0C65,0) - 
																													    (NVL(YETA_C143,0) + NVL(YETA_C141,0)) 
																														- NVL(SPCI_FBTG15,0)
																														- NVL(SPCI_FBTG16,0))))
																							 - (LEAST(NVL(SPCI_FB18,0), (NVL(YE169010.YETA_0C65,0) -
																								(NVL(YETA_C143,0) + NVL(YETA_C141,0))  
																							 	- NVL(SPCI_FBTG15,0) 
																							 	- NVL(SPCI_FBTG16,0)
																						     	- (LEAST(NVL(SPCI_FB17,0), (NVL(YE169010.YETA_0C65,0) - 
																													    (NVL(YETA_C143,0) + NVL(YETA_C141,0)) 
																														- NVL(SPCI_FBTG15,0)
																														- NVL(SPCI_FBTG16,0)))))))))))),
					SPCI_FBTG21 = LEAST(NVL(SPCI_FB21,0), (NVL(YE169010.YETA_0C65,0) - (NVL(YETA_C143,0) + NVL(YETA_C141,0))
																- NVL(SPCI_FBTG15,0) 
																- NVL(SPCI_FBTG16,0)
																- (LEAST(NVL(SPCI_FB17,0), (NVL(YE169010.YETA_0C65,0) 
																							- (NVL(YETA_C143,0) + NVL(YETA_C141,0)) 
																							- NVL(SPCI_FBTG15,0)
																							- NVL(SPCI_FBTG16,0))))
																- (LEAST(NVL(SPCI_FB18,0), (NVL(YE169010.YETA_0C65,0) -
																							(NVL(YETA_C143,0) + NVL(YETA_C141,0))  
																							 - NVL(SPCI_FBTG15,0) 
																							 - NVL(SPCI_FBTG16,0)
																						     - (LEAST(NVL(SPCI_FB17,0), (NVL(YE169010.YETA_0C65,0) - 
																													    (NVL(YETA_C143,0) + NVL(YETA_C141,0)) 
																														- NVL(SPCI_FBTG15,0)
																														- NVL(SPCI_FBTG16,0)))))))
																- (LEAST(NVL(SPCI_FB19,0), (NVL(YE169010.YETA_0C65,0) -
																							(NVL(YETA_C143,0) + NVL(YETA_C141,0))
																							 - NVL(SPCI_FBTG15,0) 
																							 - NVL(SPCI_FBTG16,0)
																							 - (LEAST(NVL(SPCI_FB17,0), (NVL(YE169010.YETA_0C65,0) - 
																													    (NVL(YETA_C143,0) + NVL(YETA_C141,0)) 
																														- NVL(SPCI_FBTG15,0)
																														- NVL(SPCI_FBTG16,0))))
																							 - (LEAST(NVL(SPCI_FB18,0), (NVL(YE169010.YETA_0C65,0) -
																								(NVL(YETA_C143,0) + NVL(YETA_C141,0))  
																							 	- NVL(SPCI_FBTG15,0) 
																							 	- NVL(SPCI_FBTG16,0)
																						     	- (LEAST(NVL(SPCI_FB17,0), (NVL(YE169010.YETA_0C65,0) - 
																													    (NVL(YETA_C143,0) + NVL(YETA_C141,0)) 
																														- NVL(SPCI_FBTG15,0)
																														- NVL(SPCI_FBTG16,0))))))))))))
																- (LEAST(NVL(SPCI_FB20,0), (NVL(YE169010.YETA_0C65,0) - 
																								(NVL(YETA_C143,0) + NVL(YETA_C141,0))
																								- NVL(SPCI_FBTG15,0) 
																								- NVL(SPCI_FBTG16,0)	
																								- (LEAST(NVL(SPCI_FB17,0), (NVL(YE169010.YETA_0C65,0) - 
																															(NVL(YETA_C143,0) + NVL(YETA_C141,0)) 
																															- NVL(SPCI_FBTG15,0)
																															- NVL(SPCI_FBTG16,0))))														
																							- (LEAST(NVL(SPCI_FB18,0), (NVL(YE169010.YETA_0C65,0) -
																								(NVL(YETA_C143,0) + NVL(YETA_C141,0))  
																							 	- NVL(SPCI_FBTG15,0) 
																							 	- NVL(SPCI_FBTG16,0)
																						     	- (LEAST(NVL(SPCI_FB17,0), (NVL(YE169010.YETA_0C65,0) - 
																													    (NVL(YETA_C143,0) + NVL(YETA_C141,0)) 
																														- NVL(SPCI_FBTG15,0)
																														- NVL(SPCI_FBTG16,0)))))))							
																							- (LEAST(NVL(SPCI_FB19,0), (NVL(YE169010.YETA_0C65,0) -
																							(NVL(YETA_C143,0) + NVL(YETA_C141,0))
																							 - NVL(SPCI_FBTG15,0) 
																							 - NVL(SPCI_FBTG16,0)
																							 - (LEAST(NVL(SPCI_FB17,0), (NVL(YE169010.YETA_0C65,0) - 
																													    (NVL(YETA_C143,0) + NVL(YETA_C141,0)) 
																														- NVL(SPCI_FBTG15,0)
																														- NVL(SPCI_FBTG16,0))))
																							 	- (LEAST(NVL(SPCI_FB18,0), (NVL(YE169010.YETA_0C65,0) -
																									(NVL(YETA_C143,0) + NVL(YETA_C141,0))  
																							 		- NVL(SPCI_FBTG15,0) 
																							 		- NVL(SPCI_FBTG16,0)
																						     		- (LEAST(NVL(SPCI_FB17,0), (NVL(YE169010.YETA_0C65,0) - 
																													    (NVL(YETA_C143,0) + NVL(YETA_C141,0)) 
																														- NVL(SPCI_FBTG15,0)
																														- NVL(SPCI_FBTG16,0)))))))))))))
					WHERE DPOB_CD=#dpobCd#
					AND YRTX_BLGG_YR=#yrtxBlggYr#
					AND CLUT_SEPT_CD=#clutSeptCd#
					AND SYSTEMKEY=#systemkey#
				]]>
	</update>  
	
	
	<update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_31_02_Update">
		<![CDATA[
				UPDATE YE169010 SET
						SPCI_FBTG22 = LEAST(NVL(SPCI_FB22,0), (NVL(YE169010.YETA_0C65,0) - (NVL(YETA_C143,0) + NVL(YETA_C141,0))
											- NVL(SPCI_FBTG15,0) 
											- NVL(SPCI_FBTG16,0)
											- NVL(SPCI_FBTG17,0)
											- NVL(SPCI_FBTG18,0)
											- NVL(SPCI_FBTG19,0)
											- NVL(SPCI_FBTG20,0)
											- NVL(SPCI_FBTG21,0)))
				WHERE DPOB_CD=#dpobCd#
					AND YRTX_BLGG_YR=#yrtxBlggYr#
					AND CLUT_SEPT_CD=#clutSeptCd#
					AND SYSTEMKEY=#systemkey#
			]]>
	</update>
	
	
	   
	
	        <!-- 기부금공제 1-우리사주조합   대상금액  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_32_Update">
		<![CDATA[
			  UPDATE YE169010 SET
			  /* 법정기부금 공제대상 금액
			  	YETA_C145 = NVL(SPCI_FBTG15,0) + NVL(SPCI_FBTG16,0) + NVL(SPCI_FBTG17,0) + NVL(SPCI_FBTG18,0) + NVL(SPCI_FBTG19,0) + NVL(SPCI_FBTG20,0) + NVL(SPCI_FBTG21,0) + NVL(SPCI_FBTG22,0), */
				YETA_C147 = (
							SELECT 
							LEAST(NVL(AD01.CONB_EMST_ASCT_USE_AMT,0),((NVL(YE169010.YETA_0C65,0) - (NVL(YETA_C143,0) + NVL(YETA_C141,0)) 
																								 - NVL(SPCI_FBTG15,0)
																								 - NVL(SPCI_FBTG16,0)
																								 - NVL(SPCI_FBTG17,0)
																								 - NVL(SPCI_FBTG18,0) 
																								 - NVL(SPCI_FBTG19,0)
																								 - NVL(SPCI_FBTG20,0)
																								 - NVL(SPCI_FBTG21,0)
																								 - NVL(SPCI_FBTG22,0)) * 0.3))
							FROM YE161080 AD01
							WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                                                  
							AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR  
							AND AD01.DPOB_CD  = YE169010.DPOB_CD                                                                                                                 
							AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD                                                                                                                 
							)                                             
				WHERE DPOB_CD=#dpobCd#
				AND YRTX_BLGG_YR=#yrtxBlggYr#
				AND CLUT_SEPT_CD=#clutSeptCd#
				AND SYSTEMKEY=#systemkey#                                                                                                                                            
 
				]]>
	</update>   
	   
	
	   
  <!--  종교외 기부금 이월분  -->
	<update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_33_Update">
	<![CDATA[ 
	UPDATE YE161060 SET									
	CONB_RELI_ORG_OTH_DDC_AMT = (SELECT  
										(CASE WHEN NVL(YE161060.CONB_RELI_ORG_OTH_USE_AMT,0) > 0
												 /* 기부금이월분_지정기부금_종교단체외납입액이 0보다 크다면*/
												  THEN                                       
												  (CASE WHEN (NVL(YE161060.CONB_RELI_ORG_USE_AMT,0) + NVL(AD02.CONB_RELI_ORG_USE_AMT,0)) > 0
															/*  종교단체납입액이 있다면 */
															THEN
															/*  LEAST(종교외납입액, (근로소득*10% +LEAST(종교외납입액,근로소득*20%))) */
															LEAST( NVL(YE161060.CONB_RELI_ORG_OTH_USE_AMT,0),
																	(((NVL(AD01.YETA_0C65,0) - (NVL(AD01.YETA_C143,0) + NVL(AD01.YETA_C141,0)) 
																							- NVL(AD01.SPCI_FBTG15,0) 
																							- NVL(AD01.SPCI_FBTG16,0) 
																							- NVL(AD01.SPCI_FBTG17,0) 
																							- NVL(AD01.SPCI_FBTG18,0)
																							- NVL(AD01.SPCI_FBTG19,0)
																							- NVL(AD01.SPCI_FBTG20,0)
																							- NVL(AD01.SPCI_FBTG21,0)
																							- NVL(AD01.SPCI_FBTG22,0)																	
																							- NVL(AD01.YETA_C147,0) ) * 0.10) 
																							+ LEAST(NVL(YE161060.CONB_RELI_ORG_OTH_USE_AMT,0), 
																								   ((NVL(AD01.YETA_0C65,0) - (NVL(AD01.YETA_C143,0) + NVL(AD01.YETA_C141,0)) 
																																	  - NVL(AD01.SPCI_FBTG15,0) 
																																	  - NVL(AD01.SPCI_FBTG16,0) 
																																	  - NVL(AD01.SPCI_FBTG17,0) 
																																	  - NVL(AD01.SPCI_FBTG18,0)
																																	  - NVL(AD01.SPCI_FBTG19,0)
																																	  - NVL(AD01.SPCI_FBTG20,0)
																																	  - NVL(AD01.SPCI_FBTG21,0)
																																	  - NVL(AD01.SPCI_FBTG22,0)
																																	  - NVL(AD01.YETA_C147,0) ) * 0.20))))
															ELSE    
															/* 종교단체납입액 없으면  LEAST(종교외납입액, 근로소득*30%) */
															LEAST( NVL(YE161060.CONB_RELI_ORG_OTH_USE_AMT,0),
																	((NVL(AD01.YETA_0C65,0) - (NVL(AD01.YETA_C143,0) + NVL(AD01.YETA_C141,0)) 
																							- NVL(AD01.SPCI_FBTG15,0) 
																							- NVL(AD01.SPCI_FBTG16,0) 
																							- NVL(AD01.SPCI_FBTG17,0) 
																							- NVL(AD01.SPCI_FBTG18,0)
																							- NVL(AD01.SPCI_FBTG19,0)
																							- NVL(AD01.SPCI_FBTG20,0)
																							- NVL(AD01.SPCI_FBTG21,0)
																							- NVL(AD01.SPCI_FBTG22,0)																	
																							- NVL(AD01.YETA_C147,0) ) * 0.30))
															END)                                                                                                                                                                                          
												 /* 기부금이월분_지정기부금_종교단체외납입액이 0보다 작으면 */
												  ELSE 0 END)
									FROM YE169010 AD01   , YE161080 AD02                                                                                                                                                                                        
									WHERE AD01.SYSTEMKEY= YE161060.SYSTEMKEY                                                                                                                                                               
									  AND AD01.YRTX_BLGG_YR = YE161060.YRTX_BLGG_YR                                                                                                                                                          
									  AND AD01.CLUT_SEPT_CD = YE161060.CLUT_SEPT_CD 
									  AND AD01.DPOB_CD  = YE161060.DPOB_CD  
									  AND AD02.SYSTEMKEY= YE161060.SYSTEMKEY                                                                                                                                                               
									  AND AD02.YRTX_BLGG_YR = YE161060.YRTX_BLGG_YR                                                                                                                                                          
									  AND AD02.CLUT_SEPT_CD = YE161060.CLUT_SEPT_CD 
									  AND AD02.DPOB_CD  = YE161060.DPOB_CD  
									)			  
	WHERE DPOB_CD=#dpobCd#
	AND YRTX_BLGG_YR=#yrtxBlggYr#
	AND CLUT_SEPT_CD=#clutSeptCd#
	AND SYSTEMKEY=#systemkey# 	
	]]>
	</update>   
	
  <!--  종교 기부금 이월분  -->
	<update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_33_02_Update">
		<![CDATA[ 
    UPDATE YE161060 SET
	  CONB_RELI_ORG_DDC_AMT = (SELECT
									(CASE WHEN (NVL(YE161060.CONB_RELI_ORG_USE_AMT,0) + NVL(AD02.CONB_RELI_ORG_USE_AMT,0)) > 0
											/* 종교단체납입액이 있다면 */
											THEN
											/* LEAST(종교납입액, (근로소득*10% +LEAST(종교외납입액,근로소득*20%))) */
											LEAST( NVL(YE161060.CONB_RELI_ORG_USE_AMT,0),
													(((NVL(AD01.YETA_0C65,0) - (NVL(AD01.YETA_C143,0) + NVL(AD01.YETA_C141,0)) 
																						- NVL(AD01.SPCI_FBTG15,0) 
																						- NVL(AD01.SPCI_FBTG16,0) 
																						- NVL(AD01.SPCI_FBTG17,0) 
																						- NVL(AD01.SPCI_FBTG18,0)
																						- NVL(AD01.SPCI_FBTG19,0)
																						- NVL(AD01.SPCI_FBTG20,0)
																						- NVL(AD01.SPCI_FBTG21,0)
																						- NVL(AD01.SPCI_FBTG22,0)																	
																						- NVL(AD01.YETA_C147,0) ) * 0.10) 
																						+ LEAST(NVL(YE161060.CONB_RELI_ORG_OTH_USE_AMT,0), 
																							   ((NVL(AD01.YETA_0C65,0) - (NVL(AD01.YETA_C143,0) + NVL(AD01.YETA_C141,0)) 
																																  - NVL(AD01.SPCI_FBTG15,0) 
																																  - NVL(AD01.SPCI_FBTG16,0) 
																																  - NVL(AD01.SPCI_FBTG17,0) 
																																  - NVL(AD01.SPCI_FBTG18,0)
																																  - NVL(AD01.SPCI_FBTG19,0)
																																  - NVL(AD01.SPCI_FBTG20,0)
																																  - NVL(AD01.SPCI_FBTG21,0)
																																  - NVL(AD01.SPCI_FBTG22,0)
																																  - NVL(AD01.YETA_C147,0) ) * 0.20))))
											ELSE 0 END)                                                                                                                                                                                                          
								FROM YE169010 AD01 , YE161080 AD02                                                                                                                                                                                          
								WHERE AD01.SYSTEMKEY= YE161060.SYSTEMKEY                                                                                                                                                               
								AND AD01.YRTX_BLGG_YR = YE161060.YRTX_BLGG_YR                                                                                                                                                          
								AND AD01.CLUT_SEPT_CD = YE161060.CLUT_SEPT_CD 
								AND AD01.DPOB_CD  = YE161060.DPOB_CD  
								AND  AD02.SYSTEMKEY= YE161060.SYSTEMKEY                                                                                                                                                               
								AND AD02.YRTX_BLGG_YR = YE161060.YRTX_BLGG_YR                                                                                                                                                          
								AND AD02.CLUT_SEPT_CD = YE161060.CLUT_SEPT_CD 
								AND AD02.DPOB_CD  = YE161060.DPOB_CD                                                                                                                                                    
								) 
	WHERE DPOB_CD=#dpobCd#
	AND YRTX_BLGG_YR=#yrtxBlggYr#
	AND CLUT_SEPT_CD=#clutSeptCd#
	AND SYSTEMKEY=#systemkey#            
                            
]]>
	</update>  	   
	    	    
  <!--  아마도 13년도 이월분 종교외+종교단체  -->
	<update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_33_03_Update">
		<![CDATA[  
          UPDATE YE169010                                                                                                                                                                                                                   
            SET YETA_0C94 = (  SELECT (NVL(AD01.CONB_RELI_ORG_OTH_DDC_AMT,0) + NVL(AD01.CONB_RELI_ORG_DDC_AMT,0))
                              FROM YE161060 AD01                                                                                                                                                                                           
                            WHERE AD01.SYSTEMKEY= YE169010.SYSTEMKEY                                                                                                                                                               
                                  AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                                                                                          
                                  AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD 
                                   AND AD01.DPOB_CD  = YE169010.DPOB_CD  )    
             WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#                         
                            
				]]>
	</update>  	   
	
	
<!--  종교단체외/종교단체기부금 공제한도금액  -->
	<update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_33_04_Update">
		<![CDATA[  
          UPDATE YE169010  AD01 SET
          /* 종교단체외기부금 공제한도 */
          YETA_NAMT01 = NVL(
							(SELECT 
							(CASE WHEN 
							/*종교단체기부금이 있다면*/
							(NVL(YE161060.CONB_RELI_ORG_USE_AMT,0) + NVL(AD02.CONB_RELI_ORG_USE_AMT,0))  > 0
									  THEN     /* 근로소득*10퍼 + LEAST(종교외기부금,근로소득*20퍼)*/
									  ((NVL(AD01.YETA_0C65,0) - (NVL(AD01.YETA_C143,0) + NVL(AD01.YETA_C141,0)) 
																						- NVL(AD01.SPCI_FBTG15,0) 
																						- NVL(AD01.SPCI_FBTG16,0) 
																						- NVL(AD01.SPCI_FBTG17,0) 
																						- NVL(AD01.SPCI_FBTG18,0)
																						- NVL(AD01.SPCI_FBTG19,0)
																						- NVL(AD01.SPCI_FBTG20,0)
																						- NVL(AD01.SPCI_FBTG21,0)
																						- NVL(AD01.SPCI_FBTG22,0)
																						- NVL(AD01.YETA_C147,0) ) * 0.10)
									  + LEAST((NVL(YE161060.CONB_RELI_ORG_OTH_USE_AMT,0) + NVL(AD02.CONB_RELI_ORG_OTH_USE_AMT,0)), 
									  ((NVL(AD01.YETA_0C65,0) - (NVL(AD01.YETA_C143,0) + NVL(AD01.YETA_C141,0)) 
																						- NVL(AD01.SPCI_FBTG15,0) 
																						- NVL(AD01.SPCI_FBTG16,0) 
																						- NVL(AD01.SPCI_FBTG17,0) 
																						- NVL(AD01.SPCI_FBTG18,0)
																						- NVL(AD01.SPCI_FBTG19,0)
																						- NVL(AD01.SPCI_FBTG20,0)
																						- NVL(AD01.SPCI_FBTG21,0)
																						- NVL(AD01.SPCI_FBTG22,0)
																						- NVL(AD01.YETA_C147,0) ) * 0.20))                                                  
									  ELSE          
                                         /* 종교단체 기부금이 없는 경우   */  
                                         ((NVL(AD01.YETA_0C65,0) - (NVL(AD01.YETA_C143,0) + NVL(AD01.YETA_C141,0)) 
																						- NVL(AD01.SPCI_FBTG15,0) 
																						- NVL(AD01.SPCI_FBTG16,0) 
																						- NVL(AD01.SPCI_FBTG17,0) 
																						- NVL(AD01.SPCI_FBTG18,0)
																						- NVL(AD01.SPCI_FBTG19,0)
																						- NVL(AD01.SPCI_FBTG20,0)
																						- NVL(AD01.SPCI_FBTG21,0)	
																						- NVL(AD01.SPCI_FBTG22,0)
																						- NVL(AD01.YETA_C147,0) ) * 0.30)	
									  END)                                             
							FROM YE161060 , YE161080 AD02                                            
							WHERE AD01.SYSTEMKEY = YE161060.SYSTEMKEY            
                            AND AD01.YRTX_BLGG_YR = YE161060.YRTX_BLGG_YR            
                            AND AD01.CLUT_SEPT_CD = YE161060.CLUT_SEPT_CD 
                            AND AD01.DPOB_CD  = YE161060.DPOB_CD  
                            AND  AD02.SYSTEMKEY= AD01.SYSTEMKEY           
                            AND AD02.YRTX_BLGG_YR = AD01.YRTX_BLGG_YR           
                            AND AD02.CLUT_SEPT_CD = AD01.CLUT_SEPT_CD 
                            AND AD02.DPOB_CD  = AD01.DPOB_CD 
						),0),
		 YETA_YAMT01 = NVL(
							(SELECT 
							(CASE WHEN
							/*종교단체기부금이 있다면*/
							(NVL(YE161060.CONB_RELI_ORG_USE_AMT,0) + NVL(AD02.CONB_RELI_ORG_USE_AMT,0))  > 0
								  THEN                                     
								  ((NVL(AD01.YETA_0C65,0) - (NVL(AD01.YETA_C143,0) + NVL(AD01.YETA_C141,0)) 
																	 - NVL(AD01.SPCI_FBTG15,0) 
																	 - NVL(AD01.SPCI_FBTG16,0) 
																	 - NVL(AD01.SPCI_FBTG17,0) 
																	 - NVL(AD01.SPCI_FBTG18,0)
																	 - NVL(AD01.SPCI_FBTG19,0)
																	 - NVL(AD01.SPCI_FBTG20,0)
																	 - NVL(AD01.SPCI_FBTG21,0)
																	 - NVL(AD01.SPCI_FBTG22,0)
																	 - NVL(AD01.YETA_C147,0) ) * 0.10)
								  + LEAST((NVL(YE161060.CONB_RELI_ORG_OTH_USE_AMT,0)
												+NVL(AD02.CONB_RELI_ORG_OTH_USE_AMT,0)), 
											 ((NVL(AD01.YETA_0C65,0) - (NVL(AD01.YETA_C143,0) + NVL(AD01.YETA_C141,0)) 
																				- NVL(AD01.SPCI_FBTG15,0) 
																				- NVL(AD01.SPCI_FBTG16,0) 
																				- NVL(AD01.SPCI_FBTG17,0) 
																				- NVL(AD01.SPCI_FBTG18,0)
																				- NVL(AD01.SPCI_FBTG19,0)
																				- NVL(AD01.SPCI_FBTG20,0)
																				- NVL(AD01.SPCI_FBTG21,0)
																				- NVL(AD01.SPCI_FBTG22,0)
																				- NVL(AD01.YETA_C147,0) ) * 0.20) )                                          
									ELSE 0 END)                                          
							FROM YE161060  , YE161080 AD02                                        
							WHERE AD01.SYSTEMKEY= YE161060.SYSTEMKEY                  
		                              AND AD01.YRTX_BLGG_YR = YE161060.YRTX_BLGG_YR                                         
		                              AND AD01.CLUT_SEPT_CD = YE161060.CLUT_SEPT_CD 
		                              AND AD01.DPOB_CD  = YE161060.DPOB_CD  
		                              AND  AD02.SYSTEMKEY= AD01.SYSTEMKEY   
		                              AND AD02.YRTX_BLGG_YR = AD01.YRTX_BLGG_YR          
		                              AND AD02.CLUT_SEPT_CD = AD01.CLUT_SEPT_CD 
		                              AND AD02.DPOB_CD  = AD01.DPOB_CD 
                         ),0)               
             WHERE DPOB_CD=#dpobCd#
             AND YRTX_BLGG_YR=#yrtxBlggYr#
             AND CLUT_SEPT_CD=#clutSeptCd#
             AND SYSTEMKEY=#systemkey#                         
               
				]]>
	</update>  	 	
	
	<!--   종교단체외 기부금대상금액  --> 
	   <update id="infcPkgYeta17Tax_2022_DAO.fnPayr06430_PAYR425_ReTax_2016_CREATE_09_021_Update">
		<![CDATA[ 
   		UPDATE YE169010 SET       
       SPCI_NATG15 =  (CASE WHEN NVL(SPCI_NA15,0) > 0
								  THEN LEAST(NVL(SPCI_NA15,0), 
								  				NVL(YETA_NAMT01,0) -  NVL(YETA_0C94,0))
								   ELSE 0 END)
	 , SPCI_NATG16 =  (CASE WHEN NVL(SPCI_NA16,0) > 0
					 	 	THEN LEAST(NVL(SPCI_NA16,0), (NVL(YETA_NAMT01,0) 
														  - NVL(YETA_0C94,0)
														  - LEAST(NVL(SPCI_NA15,0), (NVL(YETA_NAMT01,0) -  NVL(YETA_0C94,0)))))
						   	ELSE 0 END)
	 , SPCI_NATG17 =  (CASE WHEN NVL(SPCI_NA17,0) > 0
	 						THEN LEAST(NVL(SPCI_NA17,0), NVL(YETA_NAMT01,0) 
														  - NVL(YETA_0C94,0)
														  - LEAST(NVL(SPCI_NA15,0), NVL(YETA_NAMT01,0) -  NVL(YETA_0C94,0))
														  - LEAST(NVL(SPCI_NA16,0), NVL(YETA_NAMT01,0) 
																					- NVL(YETA_0C94,0)
																					- LEAST(NVL(SPCI_NA15,0), NVL(YETA_NAMT01,0) -  NVL(YETA_0C94,0))))
							ELSE 0 END)
	      WHERE DPOB_CD=#dpobCd#
          AND YRTX_BLGG_YR=#yrtxBlggYr#
          AND CLUT_SEPT_CD=#clutSeptCd#
          AND SYSTEMKEY=#systemkey#           
			]]>
	</update>
		 
	<!--   종교단체외 기부금대상금액  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnPayr06430_PAYR425_ReTax_2016_CREATE_09_022_Update">
		<![CDATA[ 
		UPDATE YE169010 SET  
        SPCI_NATG18 =  (CASE WHEN NVL(SPCI_NA18,0) > 0
							  THEN LEAST(NVL(SPCI_NA18,0), NVL(YETA_NAMT01,0) 
															  - NVL(YETA_0C94,0)
															  - NVL(SPCI_NA15,0)
															  - NVL(SPCI_NA16,0)
															  - NVL(SPCI_NA17,0)
															  )
							   ELSE 0 END)
		, SPCI_NATG19 =  (CASE WHEN NVL(SPCI_NA19,0) > 0
							  THEN LEAST(NVL(SPCI_NA19,0), NVL(YETA_NAMT01,0) 
															  - NVL(YETA_0C94,0)
															  - NVL(SPCI_NA15,0)
															  - NVL(SPCI_NA16,0)
															  - NVL(SPCI_NA17,0)
															  - LEAST(NVL(SPCI_NA18,0), NVL(YETA_NAMT01,0) 
																							  - NVL(YETA_0C94,0)
																							  - NVL(SPCI_NA15,0)
																							  - NVL(SPCI_NA16,0)
																							  - NVL(SPCI_NA17,0)
																							  ))
							   ELSE 0 END)
		 , SPCI_NATG20 =  (CASE WHEN NVL(SPCI_NA20,0) > 0
							   THEN LEAST(NVL(SPCI_NA20,0), NVL(YETA_NAMT01,0) 
							   								  - NVL(YETA_0C94,0) 
							   								  - NVL(SPCI_NA15,0) 
							   								  - NVL(SPCI_NA16,0) 
							   								  - NVL(SPCI_NA17,0)
							   								  - LEAST(NVL(SPCI_NA18,0), NVL(YETA_NAMT01,0) 
																							  - NVL(YETA_0C94,0)
																							  - NVL(SPCI_NA15,0)
																							  - NVL(SPCI_NA16,0)
																							  - NVL(SPCI_NA17,0)
																							  )
							   								  - LEAST(NVL(SPCI_NA19,0), NVL(YETA_NAMT01,0) 
															  								- NVL(YETA_0C94,0)
															  								- NVL(SPCI_NA15,0)
															  								- NVL(SPCI_NA16,0)
															  								- NVL(SPCI_NA17,0)
															  								- LEAST(NVL(SPCI_NA18,0), NVL(YETA_NAMT01,0) 
																							  								- NVL(YETA_0C94,0)
																							  								- NVL(SPCI_NA15,0)
																							  								- NVL(SPCI_NA16,0)
																							  								- NVL(SPCI_NA17,0)
																							  								))
							   )
							   ELSE 0 END)
		, SPCI_NATG21 = (CASE WHEN NVL(SPCI_NA21,0) > 0
							   THEN LEAST(NVL(SPCI_NA21,0), NVL(YETA_NAMT01,0) 
							   								  - NVL(YETA_0C94,0) 
							   								  - NVL(SPCI_NA15,0) 
							   								  - NVL(SPCI_NA16,0) 
							   								  - NVL(SPCI_NA17,0)
							    							  - LEAST(NVL(SPCI_NA18,0), NVL(YETA_NAMT01,0) 
																							  - NVL(YETA_0C94,0)
																							  - NVL(SPCI_NA15,0)
																							  - NVL(SPCI_NA16,0)
																							  - NVL(SPCI_NA17,0)
																							  )
															  - LEAST(NVL(SPCI_NA19,0), NVL(YETA_NAMT01,0) 
															  								- NVL(YETA_0C94,0)
															  								- NVL(SPCI_NA15,0)
															  								- NVL(SPCI_NA16,0)
															  								- NVL(SPCI_NA17,0)
															  								- LEAST(NVL(SPCI_NA18,0), NVL(YETA_NAMT01,0) 
																							  								- NVL(YETA_0C94,0)
																							  								- NVL(SPCI_NA15,0)
																							  								- NVL(SPCI_NA16,0)
																							  								- NVL(SPCI_NA17,0)
																							  								))
															  - LEAST(NVL(SPCI_NA20,0), NVL(YETA_NAMT01,0) 
							   								  								- NVL(YETA_0C94,0) 
							   								  								- NVL(SPCI_NA15,0) 
							   								  								- NVL(SPCI_NA16,0) 
							   								  								- NVL(SPCI_NA17,0)
							   								  								- LEAST(NVL(SPCI_NA18,0), NVL(YETA_NAMT01,0) 
																							  								- NVL(YETA_0C94,0)
																							  								- NVL(SPCI_NA15,0)
																							  								- NVL(SPCI_NA16,0)
																							  								- NVL(SPCI_NA17,0)
																							  								)
							   								  														- LEAST(NVL(SPCI_NA19,0), NVL(YETA_NAMT01,0) 
															  																					- NVL(YETA_0C94,0)
															  																					- NVL(SPCI_NA15,0)
															  																					- NVL(SPCI_NA16,0)
															  																					- NVL(SPCI_NA17,0)
															  																					- LEAST(NVL(SPCI_NA18,0), NVL(YETA_NAMT01,0) 
																							  																				- NVL(YETA_0C94,0)
																							  																				- NVL(SPCI_NA15,0)
																							  																				- NVL(SPCI_NA16,0)
																							  																				- NVL(SPCI_NA17,0)
																							  																				)))
							)
							   ELSE 0 END)
	      WHERE DPOB_CD=#dpobCd#
          AND YRTX_BLGG_YR=#yrtxBlggYr#
          AND CLUT_SEPT_CD=#clutSeptCd#
          AND SYSTEMKEY=#systemkey#           
				]]>
	</update>	   
	
	<update id="infcPkgYeta17Tax_2022_DAO.fnPayr06430_PAYR425_ReTax_2016_CREATE_09_023_Update">
		<![CDATA[ 
		UPDATE YE169010 SET  
        SPCI_NATG22 =  (CASE WHEN NVL(SPCI_NA22,0) > 0
							  THEN LEAST(NVL(SPCI_NA22,0), NVL(YETA_NAMT01,0) 
															  - NVL(YETA_0C94,0)
															  - NVL(SPCI_NA15,0)
															  - NVL(SPCI_NA16,0)
															  - NVL(SPCI_NA17,0)
															  - NVL(SPCI_NA18,0)
															  - NVL(SPCI_NA19,0)
															  - NVL(SPCI_NA20,0)
															  - NVL(SPCI_NA21,0)
															  )
							ELSE 0 END)
	      WHERE DPOB_CD=#dpobCd#
          AND YRTX_BLGG_YR=#yrtxBlggYr#
          AND CLUT_SEPT_CD=#clutSeptCd#
          AND SYSTEMKEY=#systemkey#      
				]]>
	</update>
	
	
	
	   
		<!--   종교단체 기부금대상금액  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnPayr06430_PAYR425_ReTax_2016_CREATE_09_031_Update">
		<![CDATA[
		UPDATE YE169010 SET  
		/* 종교단체외 기부금 공제대상금액
		YETA_C149 = NVL(SPCI_NATG17,0) + NVL(SPCI_NATG18,0) + NVL(SPCI_NATG19,0) + NVL(SPCI_NATG20,0) + NVL(SPCI_NATG21,0) + NVL(SPCI_NATG22,0),    */                                                                                                                                                                            
   		SPCI_YATG15 =  (CASE WHEN NVL(SPCI_YA15,0) > 0                         				
							 THEN
							 /* 종교단체기부금있으면 기부금액 공제한도 둘중 적은거 */
							 LEAST(NVL(SPCI_YA15,0), 
									  /* 공제한도-13년이월합산-종교외합산 */
									   NVL(YETA_YAMT01,0) - NVL(YETA_0C94,0) - (NVL(SPCI_NATG15,0)
																						 + NVL(SPCI_NATG16,0)
																						 + NVL(SPCI_NATG17,0)
																						 + NVL(SPCI_NATG18,0)
																						 + NVL(SPCI_NATG19,0)
																						 + NVL(SPCI_NATG20,0)
																						 + NVL(SPCI_NATG21,0)
																						 + NVL(SPCI_NATG22,0)))
							 ELSE 
							/* 종교단체기부금없으면 0  */
							 0 END)
		, SPCI_YATG16 =  (CASE WHEN NVL(SPCI_YA16,0) > 0                         				
							 THEN
							 /* 종교단체기부금있으면 기부금액 공제한도 둘중 적은거  */
							 LEAST(NVL(SPCI_YA16,0), 
								  /* 공제한도-13년이월합산-종교외합산*/
								   NVL(YETA_YAMT01,0) - NVL(YETA_0C94,0) - (NVL(SPCI_NATG15,0)
																					 + NVL(SPCI_NATG16,0)
																					 + NVL(SPCI_NATG17,0)
																					 + NVL(SPCI_NATG18,0)
																					 + NVL(SPCI_NATG19,0)
																					 + NVL(SPCI_NATG20,0)
																					 + NVL(SPCI_NATG21,0)
																					 + NVL(SPCI_NATG22,0))
										- (CASE WHEN NVL(SPCI_YA15,0) > 0                         				
												 THEN
												 LEAST(
														  NVL(SPCI_YA15,0), 
														    NVL(YETA_YAMT01,0) - NVL(YETA_0C94,0) - (NVL(SPCI_NATG15,0)
																						 + NVL(SPCI_NATG16,0)
																						 + NVL(SPCI_NATG17,0)
																						 + NVL(SPCI_NATG18,0)
																						 + NVL(SPCI_NATG19,0)
																						 + NVL(SPCI_NATG20,0)
																						 + NVL(SPCI_NATG21,0)
																						 + NVL(SPCI_NATG22,0)))
												 ELSE 0  END))
							 ELSE 
							/* 종교단체기부금없으면 0 */
							 0 END)
		, SPCI_YATG17 =  (CASE WHEN NVL(SPCI_YA17,0) > 0                         				
							 THEN
							 /*  종교단체기부금있으면 기부금액 공제한도 둘중 적은거 */
							 LEAST(NVL(SPCI_YA17,0), 
									  /* 공제한도-13년이월합산-종교외합산 */
									    NVL(YETA_YAMT01,0) - NVL(YETA_0C94,0) - (NVL(SPCI_NATG15,0)
																						 + NVL(SPCI_NATG16,0)
																						 + NVL(SPCI_NATG17,0)
																						 + NVL(SPCI_NATG18,0)
																						 + NVL(SPCI_NATG19,0)
																						 + NVL(SPCI_NATG20,0)
																						 + NVL(SPCI_NATG21,0)
																						 + NVL(SPCI_NATG22,0)))
										- (CASE WHEN NVL(SPCI_YA15,0) > 0                         				
												 THEN
												 LEAST(
														  NVL(SPCI_YA15,0), 
														   NVL(YETA_YAMT01,0) - NVL(YETA_0C94,0) - (NVL(SPCI_NATG15,0)
																											 + NVL(SPCI_NATG16,0)
																											 + NVL(SPCI_NATG17,0)
																											 + NVL(SPCI_NATG18,0)
																											 + NVL(SPCI_NATG19,0)
																											 + NVL(SPCI_NATG20,0)
																											 + NVL(SPCI_NATG21,0)
																											 + NVL(SPCI_NATG22,0)))
												 ELSE 0  END)
										- (CASE WHEN NVL(SPCI_YA16,0) > 0                         				
												 THEN
												 LEAST(
														  NVL(SPCI_YA16,0), 
														    NVL(YETA_YAMT01,0) - NVL(YETA_0C94,0) - (NVL(SPCI_NATG15,0)
																											 + NVL(SPCI_NATG16,0)
																											 + NVL(SPCI_NATG17,0)
																											 + NVL(SPCI_NATG18,0)
																											 + NVL(SPCI_NATG19,0)
																											 + NVL(SPCI_NATG20,0)
																											 + NVL(SPCI_NATG21,0)
																											 + NVL(SPCI_NATG22,0)))
														- (CASE WHEN NVL(SPCI_YA15,0) > 0                         				
																 THEN
																 LEAST(
																		  NVL(SPCI_YA15,0), 
																		    NVL(YETA_YAMT01,0) - NVL(YETA_0C94,0) - (NVL(SPCI_NATG15,0)
																															 + NVL(SPCI_NATG16,0)
																															 + NVL(SPCI_NATG17,0)
																															 + NVL(SPCI_NATG18,0)
																															 + NVL(SPCI_NATG19,0)
																															 + NVL(SPCI_NATG20,0)
																															 + NVL(SPCI_NATG21,0)
																															 + NVL(SPCI_NATG22,0)))
																 ELSE 0  END)
												 ELSE 
												 0  END)
							 ELSE 
							/* 종교단체기부금없으면 0 */
							0  END)
	      WHERE DPOB_CD=#dpobCd#
          AND YRTX_BLGG_YR=#yrtxBlggYr#
          AND CLUT_SEPT_CD=#clutSeptCd#
          AND SYSTEMKEY=#systemkey#           
		]]>
	</update>  
	  	   	   
	   
		<!--   종교단체 기부금대상금액  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnPayr06430_PAYR425_ReTax_2016_CREATE_09_032_Update">
		<![CDATA[
		UPDATE YE169010 SET   
     	SPCI_YATG18 =  (CASE WHEN NVL(SPCI_YA18,0) > 0                         				
							 THEN
							 /* 종교단체기부금있으면 기부금액 공제한도 둘중 적은거 */
							 LEAST(NVL(SPCI_YA18,0), 
									  /* 공제한도-13년이월합산-종교외합산*/
									   (NVL(YETA_YAMT01,0) - NVL(YETA_0C94,0) - (NVL(SPCI_NATG15,0)
																					 + NVL(SPCI_NATG16,0)
																					 + NVL(SPCI_NATG17,0)
																					 + NVL(SPCI_NATG18,0)
																					 + NVL(SPCI_NATG19,0)
																					 + NVL(SPCI_NATG20,0)
																					 + NVL(SPCI_NATG21,0)
																					 + NVL(SPCI_NATG22,0))
												- NVL(SPCI_YATG15,0) - NVL(SPCI_YATG16,0) - NVL(SPCI_YATG17,0)))
							 ELSE 
							/* 종교단체기부금없으면 0 */
							0  END)
		, SPCI_YATG19 = (CASE WHEN NVL(SPCI_YA19,0) > 0                         				
							 THEN
							 /* 종교단체기부금있으면 기부금액 공제한도 둘중 적은거 */
							 LEAST(NVL(SPCI_YA19,0), 
									 /* 공제한도-13년이월합산-종교외합산 */
								   NVL(YETA_YAMT01,0) - NVL(YETA_0C94,0) - (NVL(SPCI_NATG15,0)
																					 + NVL(SPCI_NATG16,0)
																					 + NVL(SPCI_NATG17,0)
																					 + NVL(SPCI_NATG18,0)
																					 + NVL(SPCI_NATG19,0)
																					 + NVL(SPCI_NATG20,0)
																					 + NVL(SPCI_NATG21,0)
																					 + NVL(SPCI_NATG22,0))
												- NVL(SPCI_YATG15,0) - NVL(SPCI_YATG16,0) - NVL(SPCI_YATG17,0)
											  - (CASE WHEN NVL(SPCI_YA18,0) > 0                         				
													 THEN
													 LEAST(NVL(SPCI_YA18,0), 
															   (NVL(YETA_YAMT01,0) - NVL(YETA_0C94,0) - (NVL(SPCI_NATG15,0)
																					 + NVL(SPCI_NATG16,0)
																					 + NVL(SPCI_NATG17,0)
																					 + NVL(SPCI_NATG18,0)
																					 + NVL(SPCI_NATG19,0)
																					 + NVL(SPCI_NATG20,0)
																					 + NVL(SPCI_NATG21,0)
																					 + NVL(SPCI_NATG22,0))
												- NVL(SPCI_YATG15,0) - NVL(SPCI_YATG16,0) - NVL(SPCI_YATG17,0)))
													 ELSE 
													0  END))
							 ELSE 
							/* 종교단체기부금없으면 0 */
							0  END)
		, SPCI_YATG20 = (CASE WHEN NVL(SPCI_YA20,0) > 0 
							THEN
							/* 종교단체기부금있으면 기부금액 공제한도 둘중 적은거 */
							LEAST(NVL(SPCI_YA20,0), 
									 /* 공제한도-13년이월합산-종교외합산 */
								   NVL(YETA_YAMT01,0) - NVL(YETA_0C94,0) - (NVL(SPCI_NATG15,0)
																					 + NVL(SPCI_NATG16,0)
																					 + NVL(SPCI_NATG17,0)
																					 + NVL(SPCI_NATG18,0)
																					 + NVL(SPCI_NATG19,0)
																					 + NVL(SPCI_NATG20,0)
																					 + NVL(SPCI_NATG21,0)
																					 + NVL(SPCI_NATG22,0))
												- NVL(SPCI_YATG15,0) - NVL(SPCI_YATG16,0) - NVL(SPCI_YATG17,0)
												- (CASE WHEN NVL(SPCI_YA18,0) > 0                         				
													 THEN
													 LEAST(NVL(SPCI_YA18,0), 
															   (NVL(YETA_YAMT01,0) - NVL(YETA_0C94,0) - (NVL(SPCI_NATG15,0)
																					 + NVL(SPCI_NATG16,0)
																					 + NVL(SPCI_NATG17,0)
																					 + NVL(SPCI_NATG18,0)
																					 + NVL(SPCI_NATG19,0)
																					 + NVL(SPCI_NATG20,0)
																					 + NVL(SPCI_NATG21,0)
																					 + NVL(SPCI_NATG22,0))
												- NVL(SPCI_YATG15,0) - NVL(SPCI_YATG16,0) - NVL(SPCI_YATG17,0)))
													 ELSE 
													0  END)
												- (CASE WHEN NVL(SPCI_YA19,0) > 0                         				
													THEN
													/* 종교단체기부금있으면 기부금액 공제한도 둘중 적은거 */
													LEAST(NVL(SPCI_YA19,0), 
													/* 공제한도-13년이월합산-종교외합산 */
													NVL(YETA_YAMT01,0) - NVL(YETA_0C94,0) - (NVL(SPCI_NATG15,0)
																					 + NVL(SPCI_NATG16,0)
																					 + NVL(SPCI_NATG17,0)
																					 + NVL(SPCI_NATG18,0)
																					 + NVL(SPCI_NATG19,0)
																					 + NVL(SPCI_NATG20,0)
																					 + NVL(SPCI_NATG21,0)
																					 + NVL(SPCI_NATG22,0))
															- NVL(SPCI_YATG15,0) - NVL(SPCI_YATG16,0) - NVL(SPCI_YATG17,0)
															- (CASE WHEN NVL(SPCI_YA18,0) > 0                         				
																THEN
																LEAST(NVL(SPCI_YA18,0), 
																		(NVL(YETA_YAMT01,0) - NVL(YETA_0C94,0) - (NVL(SPCI_NATG15,0)
																					 + NVL(SPCI_NATG16,0)
																					 + NVL(SPCI_NATG17,0)
																					 + NVL(SPCI_NATG18,0)
																					 + NVL(SPCI_NATG19,0)
																					 + NVL(SPCI_NATG20,0)
																					 + NVL(SPCI_NATG21,0)
																					 + NVL(SPCI_NATG22,0))
																		- NVL(SPCI_YATG15,0) - NVL(SPCI_YATG16,0) - NVL(SPCI_YATG17,0)))
																ELSE 
																0  END))
																ELSE 0 END))
							 ELSE 
							/* 종교단체기부금없으면 0 */
							0  END)
		, SPCI_YATG21 = (CASE
              			WHEN NVL (SPCI_YA21, 0) > 0
              			THEN
                 		/* 종교단체기부금있으면 기부금액 공제한도 둘중 적은거 */
                 		LEAST (NVL (SPCI_YA21, 0),
                      		/* 공제한도-13년이월합산-종교외합산 */
                      		NVL (YETA_YAMT01, 0)
                    			- NVL (YETA_0C94, 0) - (  NVL (SPCI_NATG15, 0)
                       					+ NVL (SPCI_NATG16, 0)
                       					+ NVL (SPCI_NATG17, 0)
                       					+ NVL (SPCI_NATG18, 0)
                       					+ NVL (SPCI_NATG19, 0)
                       					+ NVL (SPCI_NATG20, 0)
                       					+ NVL (SPCI_NATG21, 0)
                       					+ NVL (SPCI_NATG22, 0))
                    			- NVL (SPCI_YATG15, 0) - NVL (SPCI_YATG16, 0) - NVL (SPCI_YATG17, 0)
                    			- (CASE
                          			WHEN NVL (SPCI_YA18, 0) > 0
                          			THEN
                             		LEAST (NVL (SPCI_YA18, 0),(  NVL (YETA_YAMT01, 0) - NVL (YETA_0C94, 0)
                                 				- (  NVL (SPCI_NATG15, 0)
                                    			+ NVL (SPCI_NATG16, 0)
                                    			+ NVL (SPCI_NATG17, 0)
                                    			+ NVL (SPCI_NATG18, 0)
                                    			+ NVL (SPCI_NATG19, 0)
                                    			+ NVL (SPCI_NATG20, 0)
                                    			+ NVL (SPCI_NATG21, 0)
                                    			+ NVL (SPCI_NATG22, 0))
                                 				- NVL (SPCI_YATG15, 0) - NVL (SPCI_YATG16, 0) - NVL (SPCI_YATG17, 0)))
                          		ELSE
                             		0
                       				END)
                    			- (CASE
                          			WHEN NVL (SPCI_YA19, 0) > 0
                          			THEN
                             			/* 종교단체기부금있으면 기부금액 공제한도 둘중 적은거 */
                             		LEAST (NVL (SPCI_YA19, 0),
                                  		/* 공제한도-13년이월합산-종교외합산 */
                                  		NVL (YETA_YAMT01, 0)
                                		- NVL (YETA_0C94, 0)
                                			- (  NVL (SPCI_NATG15, 0)
                                   			+ NVL (SPCI_NATG16, 0)
                                   			+ NVL (SPCI_NATG17, 0)
                                   			+ NVL (SPCI_NATG18, 0)
                                   			+ NVL (SPCI_NATG19, 0)
                                   			+ NVL (SPCI_NATG20, 0)
                                   			+ NVL (SPCI_NATG21, 0)
                                   			+ NVL (SPCI_NATG22, 0))
                                			- NVL (SPCI_YATG15, 0) - NVL (SPCI_YATG16, 0) - NVL (SPCI_YATG17, 0)
                                			- (CASE
                                      			WHEN NVL (SPCI_YA18, 0) > 0
                                      			THEN
                                         		LEAST (NVL (SPCI_YA18, 0),(  NVL (YETA_YAMT01, 0)
                                             		- NVL (YETA_0C94, 0)
                                             		- (  NVL (SPCI_NATG15, 0)
                                                		+ NVL (SPCI_NATG16, 0)
                                                		+ NVL (SPCI_NATG17, 0)
                                                		+ NVL (SPCI_NATG18, 0)
                                                		+ NVL (SPCI_NATG19, 0)
                                                		+ NVL (SPCI_NATG20, 0)
                                                		+ NVL (SPCI_NATG21, 0)
                                                		+ NVL (SPCI_NATG22, 0))
                                             			- NVL (SPCI_YATG15, 0) - NVL (SPCI_YATG16, 0) - NVL (SPCI_YATG17, 0)))
                                      			ELSE
                                         			0
                                   				END))
                          						ELSE
                             						0
                       							END)
                    						- (CASE
                          						WHEN NVL (SPCI_YA20, 0) > 0
                          						THEN
                             						/* 종교단체기부금있으면 기부금액 공제한도 둘중 적은거 */
                             					LEAST (NVL (SPCI_YA20, 0),
                                  					/* 공제한도-13년이월합산-종교외합산 */
                                  					NVL (YETA_YAMT01, 0)
                                					- NVL (YETA_0C94, 0)
                                					- (  NVL (SPCI_NATG15, 0)
                                   					+ NVL (SPCI_NATG16, 0)
                                   					+ NVL (SPCI_NATG17, 0)
                                   					+ NVL (SPCI_NATG18, 0)
                                   					+ NVL (SPCI_NATG19, 0)
                                   					+ NVL (SPCI_NATG20, 0)
                                   					+ NVL (SPCI_NATG21, 0)
                                   					+ NVL (SPCI_NATG22, 0))
                                					- NVL (SPCI_YATG15, 0) - NVL (SPCI_YATG16, 0) - NVL (SPCI_YATG17, 0)
                                			- (CASE
                                      			WHEN NVL (SPCI_YA18, 0) > 0
                                      			THEN
                                         		LEAST (NVL (SPCI_YA18, 0),(  NVL (YETA_YAMT01, 0)
                                             		- NVL (YETA_0C94, 0)
                                             		- (  NVL (SPCI_NATG15, 0)
                                                	+ NVL (SPCI_NATG16, 0)
                                                	+ NVL (SPCI_NATG17, 0)
                                                	+ NVL (SPCI_NATG18, 0)
                                                	+ NVL (SPCI_NATG19, 0)
                                                	+ NVL (SPCI_NATG20, 0)
                                                	+ NVL (SPCI_NATG21, 0)
                                                	+ NVL (SPCI_NATG22, 0))
                                             		- NVL (SPCI_YATG15, 0) - NVL (SPCI_YATG16, 0) - NVL (SPCI_YATG17, 0)))
                                      			ELSE
                                         			0
                                   				END)
                                			- (CASE
                                      			WHEN NVL (SPCI_YA19, 0) > 0
                                      			THEN
                                         			/* 종교단체기부금있으면 기부금액 공제한도 둘중 적은거 */
                                         			LEAST (NVL (SPCI_YA19, 0),
                                              		/* 공제한도-13년이월합산-종교외합산 */
                                              		NVL (YETA_YAMT01, 0)
                                            		- NVL (YETA_0C94, 0)
                                            		- (  NVL (SPCI_NATG15, 0)
                                               		+ NVL (SPCI_NATG16, 0)
                                               		+ NVL (SPCI_NATG17, 0)
                                               		+ NVL (SPCI_NATG18, 0)
                                               		+ NVL (SPCI_NATG19, 0)
                                               		+ NVL (SPCI_NATG20, 0)
                                               		+ NVL (SPCI_NATG21, 0)
                                               		+ NVL (SPCI_NATG22, 0))
                                            		- NVL (SPCI_YATG15, 0) - NVL (SPCI_YATG16, 0) - NVL (SPCI_YATG17, 0)
                                            	- (CASE
                                                  	WHEN NVL (SPCI_YA18, 0) > 0
                                                  	THEN
                                                     	LEAST (NVL (SPCI_YA18, 0),(  NVL (YETA_YAMT01,0)
                                                         - NVL (YETA_0C94, 0)
                                                         - (  NVL (SPCI_NATG15,0)
                                                            + NVL (SPCI_NATG16,0)
                                                            + NVL (SPCI_NATG17,0)
                                                            + NVL (SPCI_NATG18,0)
                                                            + NVL (SPCI_NATG19,0)
                                                            + NVL (SPCI_NATG20,0)
                                                            + NVL (SPCI_NATG21,0)
                                                            + NVL (SPCI_NATG22,0))
                                                         - NVL (SPCI_YATG15,0)
                                                         - NVL (SPCI_YATG16,0)
                                                         - NVL (SPCI_YATG17,0)))
                                                  ELSE
                                                     0
                                               END))
                                      ELSE
                                         0
                                   END))
                          ELSE
                             /* 종교단체기부금없으면 0 */
                             0
                       END))
              ELSE
                 /* 종교단체기부금없으면 0 */
                 0
           END)
		WHERE DPOB_CD=#dpobCd#
        AND YRTX_BLGG_YR=#yrtxBlggYr#
        AND CLUT_SEPT_CD=#clutSeptCd#
        AND SYSTEMKEY=#systemkey#           
				]]>
	</update>
	
	
	<update id="infcPkgYeta17Tax_2022_DAO.fnPayr06430_PAYR425_ReTax_2016_CREATE_09_033_Update">
		<![CDATA[
			UPDATE YE169010 SET   
     	SPCI_YATG22 =  (CASE WHEN NVL(SPCI_YA22,0) > 0                         				
							 THEN
							 /* 종교단체기부금있으면 기부금액 공제한도 둘중 적은거 */
							 LEAST(NVL(SPCI_YA22,0), 
									  /* 공제한도-13년이월합산-종교외합산*/
									   (NVL(YETA_YAMT01,0) - NVL(YETA_0C94,0) - (NVL(SPCI_NATG15,0)
																					 + NVL(SPCI_NATG16,0)
																					 + NVL(SPCI_NATG17,0)
																					 + NVL(SPCI_NATG18,0)
																					 + NVL(SPCI_NATG19,0)
																					 + NVL(SPCI_NATG20,0)
																					 + NVL(SPCI_NATG21,0)
																					 + NVL(SPCI_NATG22,0))
												- NVL(SPCI_YATG15,0) - NVL(SPCI_YATG16,0) - NVL(SPCI_YATG17,0) - NVL(SPCI_YATG18,0)- NVL(SPCI_YATG19,0)
												- NVL(SPCI_YATG20,0)- NVL(SPCI_YATG21,0)))
							 ELSE 
							/* 종교단체기부금없으면 0 */
							0  END)
			WHERE DPOB_CD=#dpobCd#
        AND YRTX_BLGG_YR=#yrtxBlggYr#
        AND CLUT_SEPT_CD=#clutSeptCd#
        AND SYSTEMKEY=#systemkey#   
				]]>
	</update>
	
	
   <select id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_TgYear_Select" parameterClass="yeta17TaxYe169010_2022" resultClass="egovMap">
      SELECT    
          YE169010.DPOB_CD                               
       , YE169010.YRTX_BLGG_YR                     
       , YE169010.CLUT_SEPT_CD                     
       , YE169010.SYSTEMKEY   
		,(YE169010.SPCI_FB16   ) AS SPCI_FB16_10     /* 법정기부금 */  
		,(YE169010.SPCI_FB17   ) AS SPCI_FB17_10  
		,(YE169010.SPCI_FB18   ) AS SPCI_FB18_10  
		,(YE169010.SPCI_FB19   ) AS SPCI_FB19_10 
		,(YE169010.SPCI_FB20   ) AS SPCI_FB20_10
		,(YE169010.SPCI_FB21   ) AS SPCI_FB21_10
		,(YE169010.SPCI_FB22   ) AS SPCI_FB22_10
		,(YE169010.SPCI_FBTG16 ) AS SPCI_FBTG16_10
		,(YE169010.SPCI_FBTG17 ) AS SPCI_FBTG17_10
		,(YE169010.SPCI_FBTG18 ) AS SPCI_FBTG18_10
		,(YE169010.SPCI_FBTG19 ) AS SPCI_FBTG19_10
		,(YE169010.SPCI_FBTG20 ) AS SPCI_FBTG20_10
		,(YE169010.SPCI_FBTG21 ) AS SPCI_FBTG21_10
		,(YE169010.SPCI_FBTG22 ) AS SPCI_FBTG22_10
		,(YE169010.SPCI_FBSE16 ) AS SPCI_FBSE16_10
		,(YE169010.SPCI_FBSE17 ) AS SPCI_FBSE17_10
		,(YE169010.SPCI_FBSE18 ) AS SPCI_FBSE18_10
		,(YE169010.SPCI_FBSE19 ) AS SPCI_FBSE19_10
		,(YE169010.SPCI_FBSE20 ) AS SPCI_FBSE20_10
		,(YE169010.SPCI_FBSE21 ) AS SPCI_FBSE21_10
		,(YE169010.SPCI_FBSE22 ) AS SPCI_FBSE22_10
		,(YE169010.SPCI_NA16   ) AS SPCI_NA16_40    /* 종교단체외기부금 */  
		,(YE169010.SPCI_NA17   ) AS SPCI_NA17_40 
		,(YE169010.SPCI_NA18   ) AS SPCI_NA18_40  
		,(YE169010.SPCI_NA19   ) AS SPCI_NA19_40 
		,(YE169010.SPCI_NA20   ) AS SPCI_NA20_40
		,(YE169010.SPCI_NA21   ) AS SPCI_NA21_40 
		,(YE169010.SPCI_NA22   ) AS SPCI_NA22_40 
		,(YE169010.SPCI_NATG16 ) AS SPCI_NATG16_40
		,(YE169010.SPCI_NATG17 ) AS SPCI_NATG17_40
		,(YE169010.SPCI_NATG18 ) AS SPCI_NATG18_40
		,(YE169010.SPCI_NATG19 ) AS SPCI_NATG19_40
		,(YE169010.SPCI_NATG20 ) AS SPCI_NATG20_40
		,(YE169010.SPCI_NATG21 ) AS SPCI_NATG21_40
		,(YE169010.SPCI_NATG22 ) AS SPCI_NATG22_40
		,(YE169010.SPCI_NASE16 ) AS SPCI_NASE16_40
		,(YE169010.SPCI_NASE17 ) AS SPCI_NASE17_40
		,(YE169010.SPCI_NASE18 ) AS SPCI_NASE18_40
		,(YE169010.SPCI_NASE19 ) AS SPCI_NASE19_40
		,(YE169010.SPCI_NASE20 ) AS SPCI_NASE20_40
		,(YE169010.SPCI_NASE21 ) AS SPCI_NASE21_40
		,(YE169010.SPCI_NASE22 ) AS SPCI_NASE22_40
		,(YE169010.SPCI_YA16   ) AS SPCI_YA16_41    /* 종교단체기부금 */  
		,(YE169010.SPCI_YA17   ) AS SPCI_YA17_41  
		,(YE169010.SPCI_YA18   ) AS SPCI_YA18_41
		,(YE169010.SPCI_YA19   ) AS SPCI_YA19_41 
		,(YE169010.SPCI_YA20   ) AS SPCI_YA20_41 
		,(YE169010.SPCI_YA21   ) AS SPCI_YA21_41   
		,(YE169010.SPCI_YA22   ) AS SPCI_YA22_41 
		,(YE169010.SPCI_YATG16 ) AS SPCI_YATG16_41
		,(YE169010.SPCI_YATG17 ) AS SPCI_YATG17_41
		,(YE169010.SPCI_YATG18 ) AS SPCI_YATG18_41
		,(YE169010.SPCI_YATG19 ) AS SPCI_YATG19_41
		,(YE169010.SPCI_YATG20 ) AS SPCI_YATG20_41
		,(YE169010.SPCI_YATG21 ) AS SPCI_YATG21_41
		,(YE169010.SPCI_YATG22 ) AS SPCI_YATG22_41
		,(YE169010.SPCI_YASE16 ) AS SPCI_YASE16_41
		,(YE169010.SPCI_YASE17 ) AS SPCI_YASE17_41
		,(YE169010.SPCI_YASE18 ) AS SPCI_YASE18_41
		,(YE169010.SPCI_YASE19 ) AS SPCI_YASE19_41 
		,(YE169010.SPCI_YASE20 ) AS SPCI_YASE20_41
		,(YE169010.SPCI_YASE21 ) AS SPCI_YASE21_41
		,(YE169010.SPCI_YASE22 ) AS SPCI_YASE22_41
		,(YE169010.YETA_C141 ) AS YETA_C141
		,(YE169010.YETA_C143 ) AS YETA_C143
		,(YE169010.YETA_C147 ) AS YETA_C147  
		,(YE169010.YETA_C142 ) AS YETA_C142
		,(YE169010.YETA_C144 ) AS YETA_C144  
		,(YE161060.CONB_LGL_USE_AMT) AS	CONB_LGL_USE_AMT 		/* 기부금이월분_법정기부금기부금납입액  */
		,(YE161060.CONB_LGL_DDC_AMT) AS	CONB_LGL_DDC_AMT 		/* 기부금이월분_법정기부금기부금공제액 */
		,(YE161060.CONB_RELI_ORG_OTH_USE_AMT) AS CONB_RELI_ORG_OTH_USE_AMT	/* 기부금이월분_지정기부금_종교단체외납입액 */
		,(YE161060.CONB_RELI_ORG_OTH_DDC_AMT) AS CONB_RELI_ORG_OTH_DDC_AMT	/* 기부금이월분_지정기부금_종교단체외공제액 */
		,(YE161060.CONB_RELI_ORG_USE_AMT) AS CONB_RELI_ORG_USE_AMT		/* 기부금이월분_지정기부금_종교단체납입액 */
		,(YE161060.CONB_RELI_ORG_DDC_AMT) AS CONB_RELI_ORG_DDC_AMT		/* 기부금이월분_지정기부금_종교단체공제액 */ 
 		FROM YE169010 ,YE161020 ,YE161060 
        WHERE YE161020.SYSTEMKEY = YE169010.SYSTEMKEY  
        AND YE161020.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR 
        AND YE161020.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD 
        AND YE161020.DPOB_CD   = YE169010.DPOB_CD  
        AND YE161020.SYSTEMKEY = YE161060.SYSTEMKEY  
        AND YE161020.YRTX_BLGG_YR = YE161060.YRTX_BLGG_YR 
        AND YE161020.CLUT_SEPT_CD = YE161060.CLUT_SEPT_CD 
        AND YE161020.DPOB_CD   = YE161060.DPOB_CD  
        AND YE161020.DPOB_CD   = #dpobCd#                 
	    AND YE161020.SYSTEMKEY  = #systemkey#       
	    AND YE161020.CLUT_SEPT_CD = #clutSeptCd#    
	    AND YE161020.YRTX_BLGG_YR = #yrtxBlggYr#
	</select>	
	
   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_TgIn01_Update">
		<![CDATA[
			 	UPDATE YE161080
			SET  
				  CONB_LGL_DDC_TRGT_AMT=#conbLglDdcTrgtAmt#
				, CONB_LGL_DDC_AMT=#conbLglDdcAmt#
				, CONB_EMST_ASCT_DDC_TRGT_AMT=#conbEmstAsctDdcTrgtAmt#
				, CONB_EMST_ASCT_DDC_AMT=#conbEmstAsctDdcAmt#
				, CONB_RELI_ORG_OTH_DDC_TRGT_AMT=#conbReliOrgOthDdcTrgtAmt#
				, CONB_RELI_ORG_OTH_DDC_AMT=#conbReliOrgOthDdcAmt#
				, CONB_RELI_ORG_DDC_TRGT_AMT=#conbReliOrgDdcTrgtAmt#
				, CONB_RELI_ORG_DDC_AMT=#conbReliOrgDdcAmt#
				, CONB_DDC_TRGT_AMT_SUM=#conbDdcTrgtAmtSum#
				, CONB_DDC_AMT_SUM=#conbDdcAmtSum#
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
						WHERE DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
								AND SYSTEMKEY=#systemkey#
				]]>
	</update>
   
          <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_TgIn02_Update">
		<![CDATA[
			UPDATE YE169010
			SET  YETA_C145    = #yetaC145#              
				,YETA_C146    = #yetaC146#               
				,YETA_C147    = #yetaC147#        
				,YETA_C148    = #yetaC148#        
				,YETA_C149    = #yetaC149#      
				,YETA_C150    = #yetaC150#      
				,YETA_C150A   = #yetaC150a#    
				,YETA_C150B   = #yetaC150b#    
				,SPCI_FBSE16 = #spciFbse16#
				,SPCI_FBSE17 = #spciFbse17#
				,SPCI_FBSE18 = #spciFbse18#
				,SPCI_FBSE19 = #spciFbse19#
				,SPCI_FBSE20 = #spciFbse20#
				,SPCI_FBSE21 = #spciFbse21#
				,SPCI_FBSE22 = #spciFbse22#
				,SPCI_NASE16 = #spciNase16#
				,SPCI_NASE17 = #spciNase17#
				,SPCI_NASE18 = #spciNase18#
				,SPCI_NASE19 = #spciNase19#
				,SPCI_NASE20 = #spciNase20#
				,SPCI_NASE21 = #spciNase21#
				,SPCI_NASE22 = #spciNase22#
				,SPCI_YASE16 = #spciYase16#
				,SPCI_YASE17 = #spciYase17#
				,SPCI_YASE18 = #spciYase18#
				,SPCI_YASE19 = #spciYase19#
				,SPCI_YASE20 = #spciYase20#
				,SPCI_YASE21 = #spciYase21#
				,SPCI_YASE22 = #spciYase22#
			       , ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
						WHERE DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
								AND SYSTEMKEY=#systemkey#
				]]>
	</update>  
      
         
              <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_TgIn03_Update">
		<![CDATA[
			 	UPDATE YE161080
			SET  
			     CONB10TTSW_LT_DDC_TRGT_AMT=#conb10ttswLtDdcTrgtAmt#
				, CONB10TTSW_LT_DDC_AMT=#conb10ttswLtDdcAmt# 
				
				, CONB10EXCS_LT_DDC_TRGT_AMT=#conb10excsLtDdcTrgtAmt#
				, CONB10EXCS_LT_DDC_AMT=#conb10excsLtDdcAmt# 
			 
				,  CONB_LGL_DDC_TRGT_AMT=#conbLglDdcTrgtAmt#
				, CONB_LGL_DDC_AMT=#conbLglDdcAmt#
				, CONB_EMST_ASCT_DDC_TRGT_AMT=#conbEmstAsctDdcTrgtAmt#
				, CONB_EMST_ASCT_DDC_AMT=#conbEmstAsctDdcAmt#
				, CONB_RELI_ORG_OTH_DDC_TRGT_AMT=#conbReliOrgOthDdcTrgtAmt#
				, CONB_RELI_ORG_OTH_DDC_AMT=#conbReliOrgOthDdcAmt#
				, CONB_RELI_ORG_DDC_TRGT_AMT=#conbReliOrgDdcTrgtAmt#
				, CONB_RELI_ORG_DDC_AMT=#conbReliOrgDdcAmt#
				, CONB_DDC_TRGT_AMT_SUM=#conbDdcTrgtAmtSum#
				, CONB_DDC_AMT_SUM=#conbDdcAmtSum#
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
						WHERE DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
								AND SYSTEMKEY=#systemkey#
				]]>
	</update>
   
          <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_TgIn04_Update">
		<![CDATA[
			UPDATE YE169010
			SET  
			     YETA_C141=#yetaC141#
				, YETA_C142=#yetaC142#
				, YETA_C143=#yetaC143#
				, YETA_C144=#yetaC144# 
			     ,YETA_C145    = #yetaC145#              
				,YETA_C146    = #yetaC146#               
				,YETA_C147    = #yetaC147#        
				,YETA_C148    = #yetaC148#        
				,YETA_C149    = #yetaC149#      
				,YETA_C150    = #yetaC150#      
				,YETA_C150A   = #yetaC150a#    
				,YETA_C150B   = #yetaC150b#    
				
				,SPCI_FBTG16 = #spciFbtg16#
				,SPCI_FBTG17 = #spciFbtg17#
				,SPCI_FBTG18 = #spciFbtg18#
				,SPCI_NATG16 = #spciNatg16#
				,SPCI_NATG17 = #spciNatg17#
				,SPCI_NATG18 = #spciNatg18#
				,SPCI_YATG16 = #spciYatg16#
				,SPCI_YATG17 = #spciYatg17# 
				,SPCI_YATG18 = #spciYatg18#
				
				,SPCI_FBSE16 = #spciFbse16#
				,SPCI_FBSE17 = #spciFbse17#
				,SPCI_FBSE18 = #spciFbse18#
				,SPCI_NASE16 = #spciNase16#
				,SPCI_NASE17 = #spciNase17#
				,SPCI_NASE18 = #spciNase18#
				,SPCI_YASE16 = #spciYase16#
				,SPCI_YASE17 = #spciYase17#
				,SPCI_YASE18 = #spciYase18#
			       , ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
						WHERE DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
								AND SYSTEMKEY=#systemkey#
				]]>
	</update>  
	   
	   
	   <!--  기부금공제 3  들어간 데이타를 불러와 처리하는 루틴으로 변경함. 사용안함  --> 
	  <update id="infcPkgYeta17Tax_2022_DAO.fnPayr06430_PAYR425_ReTax_2016_CREATE_10_Update">
		<![CDATA[
			       UPDATE YE169010                                                                                                                                   
                   SET    
 /*  // 법정기부금.  세액공제   SPCI_FBTG15 SPCI_FBTG16 SPCI_FBTG17 SPCI_FBTG18 */   
                SPCI_FBAM =  (CASE WHEN (NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0) + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                             + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)) <= 20000000      
                                                               THEN (((NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0) + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                             + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)) * 0.15) * 
                                                                            ( CASE WHEN (NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0)
                                                                                                                                        + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                                                                                        + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)) <= 0
                                                                              THEN 0 
                                                                              ELSE                                                             
                                                                              ((NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0)) / (NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0)
                                                                                                                                        + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                                                                                        + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)))
                                                                              END))                                              
                                                               ELSE  (((20000000 * 0.15) + 
                                                                     (((NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0) + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                             + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0))  - 20000000) * 0.3)) * 
                                                                              ( CASE WHEN (NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0)
                                                                                                                                        + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                                                                                        + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)) <= 0
                                                                              THEN 0 
                                                                              ELSE  
                                                                              ((NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0)) / (NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0)
                                                                                                                                        + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                                                                                        + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)))
                                                                                                                                        END)) 
                                                               END  ) ,
  /*  // 우리사주조.  세액공제   */
                 SPCI_RFAM =  (SELECT (CASE WHEN (NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0) + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                             + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)) <= 20000000      
                                                               THEN (((NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0) + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                             + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)) * 0.15) *
                                                                              ( CASE WHEN (NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0)
                                                                                                                                        + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                                                                                        + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)) <= 0
                                                                              THEN 0 
                                                                              ELSE   
                                                                              ((NVL(YE161020.SPCI_HFTG,0)) / (NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0)
                                                                                                                                        + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                                                                                        + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)))
                                                                                                                                        END))                                              
                                                               ELSE  (((20000000 * 0.15) + 
                                                                     (((NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0) + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                             + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0))  - 20000000) * 0.3)) * 
                                                                              ( CASE WHEN (NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0)
                                                                                                                                        + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                                                                                        + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)) <= 0
                                                                              THEN 0 
                                                                              ELSE  
                                                                              ((NVL(YE161020.SPCI_HFTG,0)) / (NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0)
                                                                                                                                        + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                                                                                        + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)))
                                                                                                                                        END)) 
                                                               END)                                                                                               
                                                         FROM YE161020                                                                                         
                                                          WHERE YE161020.SYSTEMKEY = YE169010.SYSTEMKEY                                                        
                                                            AND YE161020.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                       
                                                            AND YE161020.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD  
                                                              AND YE161020.DPOB_CD  = YE169010.DPOB_CD                                                         
                                                       ) ,                                                                                                                                                                                                                                                                   
 /*  // 종교단체 기부금.  세액공제   */
                 SPCI_YAMT = (SELECT (CASE WHEN (NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0) + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                             + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)) <= 20000000      
                                                               THEN (((NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0) + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                             + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)) * 0.15) * 
                                                                              ( CASE WHEN (NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0)
                                                                                                                                        + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                                                                                        + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)) <= 0
                                                                              THEN 0 
                                                                              ELSE  
                                                                              ((NVL(YE161020.SPCI_YATG,0) + NVL(YE161020.SPCI_YA15,0)) / (NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0)
                                                                                                                                        + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                                                                                        + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)))
                                                                                                                                        END))                                              
                                                               ELSE  (((20000000 * 0.15) + 
                                                                     (((NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0) + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                             + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0))  - 20000000) * 0.3)) * 
                                                                              ( CASE WHEN (NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0)
                                                                                                                                        + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                                                                                        + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)) <= 0
                                                                              THEN 0 
                                                                              ELSE  
                                                                              ((NVL(YE161020.SPCI_YATG,0) + NVL(YE161020.SPCI_YA15,0)) / (NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0)
                                                                                                                                        + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                                                                                        + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)))
                                                                                                                                        END)) 
                                                               END)                                         
                                                         FROM YE161020                                                                                         
                                                          WHERE YE161020.SYSTEMKEY = YE169010.SYSTEMKEY                                                        
                                                            AND YE161020.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                       
                                                            AND YE161020.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD  
                                                              AND YE161020.DPOB_CD  = YE169010.DPOB_CD                                                         
                                                       ) ,                                                     

 /*  // 종교단체외  기부금.  세액공제   */
                  SPCI_NAMT = (SELECT (CASE WHEN (NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0) + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                             + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)) <= 20000000      
                                                               THEN (((NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0) + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                             + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)) * 0.15) * 
                                                                              ( CASE WHEN (NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0)
                                                                                                                                        + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                                                                                        + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)) <= 0
                                                                              THEN 0 
                                                                              ELSE  
                                                                              ((NVL(YE161020.SPCI_NATG,0) + NVL(YE161020.SPCI_NA15,0)) / (NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0)
                                                                                                                                        + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                                                                                        + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)))
                                                                                                                                        END))                                              
                                                               ELSE  (((20000000 * 0.15) + 
                                                                     (((NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0) + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                             + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0))  - 20000000) * 0.3)) * 
                                                                              ( CASE WHEN (NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0)
                                                                                                                                        + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                                                                                        + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)) <= 0
                                                                              THEN 0 
                                                                              ELSE  
                                                                              ((NVL(YE161020.SPCI_NATG,0) + NVL(YE161020.SPCI_NA15,0)) / (NVL(YE161020.SPCI_FBTG,0) + NVL(YE161020.SPCI_FB15,0)
                                                                                                                                        + NVL(YE161020.SPCI_HFTG,0) + NVL(YE161020.SPCI_YATG,0)
                                                                                                                                        + NVL(YE161020.SPCI_NATG,0)+ NVL(YE161020.SPCI_YA15,0)+ NVL(YE161020.SPCI_NA15,0)))
                                                                                                                                        END)) 
                                                               END)                                                                            
                                                         FROM YE161020                                                                        
                                                          WHERE YE161020.SYSTEMKEY = YE169010.SYSTEMKEY                                       
                                                            AND YE161020.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                       
                                                            AND YE161020.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD    
                                                            AND YE161020.DPOB_CD  = YE169010.DPOB_CD                                     
                                                       )                                         
 						WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#	 
				]]>
	</update>    
	   
	   <!-- 기부금공제 에 따른 기부명세서 작성 -->
	 <delete id="infcPkgYeta17Tax_2022_DAO.fnPayr06430_PAYR425_ReTax_2016_CREATE_10_1_Delete">
		<![CDATA[
			  DELETE FROM YE165030 
			    WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#
				]]>
	</delete>
	
	<!-- 기부금공제 에 따른 이월기부금 작성 -->
	<insert id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_40_Update">
	  <![CDATA[
		  INSERT INTO YE165030                                                 
				   (   
				       DPOB_CD                    /* 사업장코드                 */      
					, YRTX_BLGG_YR		    /* 귀속연도                  */
					, CLUT_SEPT_CD		    /* 연말정산구분코드             */
					, SYSTEMKEY		    /* SYSTEMKEY               */
					, CONB_SEIL_NUM		    /* 기부금조정일련번호           */
					, CONB_CDDL		    /* 기부금유형구분코드           */
					, CTRB_TYCD
					, ATTR_YR		    /* 기부년도                  */
					, USE_AMT		    /* 기부금액                  */
					, PYR_DDC_AMT		    /* 전년도공제된금액             */
					, DDC_TRGT_AMT		    /* 기부금공제대상금액           */
					, THC_YR_DDC_AMT_ND_XPS	    /* 해당연도공제금액필요경비       */
					, THC_YR_DDC_AMT	    /* 해당연도공제금액세액공제금액    */
					, THC_YR_NDUC_EXTN_AMT	    /* 해당연도미공제금액_소멸금액     */
					, THC_YR_NDUC_CRFW_AMT	    /* 해당연도미공제금액_이월금액     */
					, KYBDR			    /* 입력자                   */
					, INPT_DT		    /* 입력일자                  */
					, INPT_ADDR		    /* 입력주소                  */
					, ISMT			    /* 수정자                   */
					, REVN_DT		    /* 수정일자                  */
					, REVN_ADDR		    /* 수정주소                  */                                                  
				   )                                                            
				   ( SELECT    
				      DPOB_CD                    /* 사업장코드                 */      
					, YRTX_BLGG_YR		    /* 귀속연도                  */
					, CLUT_SEPT_CD		    /* 연말정산구분코드             */
					, SYSTEMKEY		    /* SYSTEMKEY               */
					, CONB_SEIL_NUM		    /* 기부금조정일련번호           */
					, CONB_CDDL		    /* 기부금유형구분코드           */
					, CTRB_TYCD
					, ATTR_YR		    /* 기부년도                  */
					, USE_AMT		    /* 기부금액                  */
					, PYR_DDC_AMT		    /* 전년도공제된금액             */
					, DDC_TRGT_AMT		    /* 기부금공제대상금액           */
					, THC_YR_DDC_AMT_ND_XPS	    /* 해당연도공제금액필요경비       */
					, THC_YR_DDC_AMT	    /* 해당연도공제금액세액공제금액    */
					, THC_YR_NDUC_EXTN_AMT	    /* 해당연도미공제금액_소멸금액     */
					, THC_YR_NDUC_CRFW_AMT	    /* 해당연도미공제금액_이월금액     */
					, KYBDR			    /* 입력자                   */
					, INPT_DT		    /* 입력일자                  */
					, INPT_ADDR		    /* 입력주소                  */
					, ISMT			    /* 수정자                   */
					, REVN_DT		    /* 수정일자                  */
					, REVN_ADDR		    /* 수정주소                  */                                                 
				   FROM YE165030_TEMP                                            
				   WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey# 
                     AND  NOT EXISTS (
                       SELECT * FROM   YE165030 KK01
                        WHERE DPOB_CD=#dpobCd#
                          AND KK01.YRTX_BLGG_YR = #yrtxBlggYr#
                          AND KK01.CLUT_SEPT_CD = #clutSeptCd#
                          AND KK01.SYSTEMKEY =  #systemkey#
                          AND KK01.DPOB_CD = YE165030_TEMP.DPOB_CD
                          AND KK01.YRTX_BLGG_YR = YE165030_TEMP.YRTX_BLGG_YR 
                          AND KK01.CLUT_SEPT_CD =  YE165030_TEMP.CLUT_SEPT_CD
                          AND KK01.SYSTEMKEY =  YE165030_TEMP.SYSTEMKEY 
                          AND KK01.CTRB_TYCD = YE165030_TEMP.CTRB_TYCD
                    ) 
		 )
		   
		]]>
	</insert>
	
	  <!--  기부금공제 에 따른 기부명세서 작성   자동처리로 제외 -->
	  <insert id="infcPkgYeta17Tax_2022_DAO.fnPayr06430_PAYR425_ReTax_2016_CREATE_10_1_Update">
		<![CDATA[
		  INSERT INTO YETA3170                                                 
		   (                                                            
		     DPOB_CD,
		     YRTX_BLGG_YR,                                                 
		     CLUT_SEPT_CD,                                                 
		     SYSTEMKEY,                                                 
		     CTRB_SEQN,                                                 
		     CTRB_DDCD,                                                 
		     CTRB_TYCD,                                                 
		     CTRB_AMNT,                                                 
		     CTRB_YRMN,                                                 
		     BFYR_DEAM,                                                 
		     DETR_AMNT,                                                 
		     DYYR_DEAM,                                                 
		     DYYR_OTAM,                                                 
		     AYYR_NTAM                                                  
		   )                                                            
		   (                                                              
		    SELECT    
            DPOB_CD,                               
             YRTX_BLGG_YR,                                                   
             CLUT_SEPT_CD,                                                   
             SYSTEMKEY,                                                  
             (ROWNUM + CTRB_SEQN) AS CTRB_SEQN,                          
             CTRB_DDCD,                                                  
             CTRB_TYCD,                                                  
             TOTAL01,                                                    
             CTRB_YRMN,                                                  
             TEMP01,                                                     
             TOTAL02,                                                    
             SPCI,                                                       
             TEMP02,                                                     
             (CASE WHEN SPCI_D  > 0 THEN  SPCI_D ELSE 0 END)                                                  
          FROM                                                           
           (SELECT 
           BB.DPOB_CD,                                 
           BB.YRTX_BLGG_YR,                                                   
           BB.CLUT_SEPT_CD,                                                   
           BB.SYSTEMKEY,                                                   
                   (SELECT (NVL(MAX(AA.CTRB_SEQN),0) + 1) FROM YETA3170 AA      
                   WHERE AA.YRTX_BLGG_YR = BB.YRTX_BLGG_YR  AND AA.CLUT_SEPT_CD = BB.CLUT_SEPT_CD AND  AA.SYSTEMKEY = BB.SYSTEMKEY) AS CTRB_SEQN , 
           BB.CTRB_DDCD,                                                   
           BB.CTRB_TYCD,                                                   
           BB.TOTAL01,                                                     
           BB.CTRB_YRMN,                                                   
           BB.TEMP01,                                                      
           BB.TOTAL02,                                                     
           BB.SPCI,                                                        
           BB.TEMP02,                                                      
            ( BB.TOTAL02  - (CASE WHEN BB.CTRB_TYCD =  '10'  THEN  BB.SPCI  
                    WHEN BB.CTRB_TYCD =  '20'  THEN   BB.SPCI      
                    WHEN BB.CTRB_TYCD =  '30'  THEN   BB.SPCI                 
                    WHEN BB.CTRB_TYCD =  '31'  THEN   BB.SPCI                 
                    WHEN BB.CTRB_TYCD =  '40'  THEN   BB.SPCI                 
                    WHEN BB.CTRB_TYCD =  '41'  THEN   BB.SPCI  
                    WHEN BB.CTRB_TYCD =  '42'  THEN   BB.SPCI                 
                    ELSE     0 END)) AS SPCI_D                          
           FROM                                                         
           (SELECT  
             YETA3180.DPOB_CD ,                                                
            YETA3180.YRTX_BLGG_YR,                                          
            YETA3180.CLUT_SEPT_CD,                                                
            YETA3180.SYSTEMKEY,                                                
            YETA3180.CTRB_DDCD,                                                
            YETA3180.CTRB_TYCD,                                                
            SUM(NVL(CTRB_TGAM,0))  AS TOTAL01  ,             
            YETA3180.CTRB_YRMN,                                                
            (0) AS TEMP01,                                                    
             SUM(NVL(CTRB_TGAM,0))  AS TOTAL02 ,              
           (CASE WHEN CTRB_TYCD =  '10'  THEN      (NVL (YE161020.SPCI_FBTG, 0)  + NVL (YE161020.SPCI_FB15, 0))              
                    WHEN CTRB_TYCD =  '20'  THEN   (NVL(YE161020.TAXD_10TG,0) + NVL(YETA_C143,0))             
                    WHEN CTRB_TYCD =  '40'  THEN   (NVL (YE161020.SPCI_NATG, 0) +   NVL (YE161020.SPCI_NA15, 0))          
                    WHEN CTRB_TYCD =  '41'  THEN   (NVL (YE161020.SPCI_YATG, 0)+  NVL (YE161020.SPCI_YA15, 0))        
                    WHEN CTRB_TYCD =  '42'  THEN   NVL (YE161020.SPCI_HFTG, 0)           
                    ELSE     0 END)  AS  SPCI,                                
            (0) AS TEMP02                                                     
           FROM YETA3180 ,YE169010 , YE161020                                            
             WHERE YETA3180.SYSTEMKEY = YE169010.SYSTEMKEY                      
                 AND YETA3180.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                    
                 AND YETA3180.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD 
                  AND YETA3180.DPOB_CD  = YE169010.DPOB_CD                    
                 AND YE161020.SYSTEMKEY = YE169010.SYSTEMKEY                      
                 AND YE161020.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                    
                 AND YE161020.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
              AND YE161020.DPOB_CD  = YE169010.DPOB_CD 
              AND  YETA3180.DPOB_CD=#dpobCd#                 
              AND YETA3180.SYSTEMKEY = #systemkey#       
              AND YETA3180.CLUT_SEPT_CD = #clutSeptCd#    
              AND YETA3180.YRTX_BLGG_YR = #yrtxBlggYr#    
           GROUP BY  YETA3180.DPOB_CD ,YETA3180.YRTX_BLGG_YR,                                       
            YETA3180.CLUT_SEPT_CD,                                                
            YETA3180.SYSTEMKEY,                                                
            YETA3180.CTRB_DDCD,                                                
            YETA3180.CTRB_TYCD,                                                
            YETA3180.CTRB_YRMN,                                                
            YE161020.SPCI_FBTG, 
            YE161020.SPCI_FB15,                                  
            YETA_C143,   
            YE161020.TAXD_10TG,  
            YE161020.SPCI_NATG,                                                
            YE161020.SPCI_YATG,                                                
            YE161020.SPCI_HFTG,
            YE161020.SPCI_NA15,
            YE161020.SPCI_YA15) BB                                               
            WHERE BB.TOTAL02 <> 0                                                
           ))   
		]]>
	</insert> 

   <select id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_1001_Select" parameterClass="yeta17TaxYe169010_2022" resultClass="egovMap">
      SELECT    
          YE169010.DPOB_CD                               
       , YE169010.YRTX_BLGG_YR                     
       , YE169010.CLUT_SEPT_CD                     
       , YE169010.SYSTEMKEY   
		,(YE169010.SPCI_FB16   ) AS SPCI_FB16_10     /* 법정기부금 */  
		,(YE169010.SPCI_FB17   ) AS SPCI_FB17_10  
		,(YE169010.SPCI_FB18   ) AS SPCI_FB18_10  
		,(YE169010.SPCI_FB19   ) AS SPCI_FB19_10
		,(YE169010.SPCI_FB20   ) AS SPCI_FB20_10
		,(YE169010.SPCI_FB21   ) AS SPCI_FB21_10
		,(YE169010.SPCI_FB22   ) AS SPCI_FB22_10
		,(YE169010.SPCI_FBTG16 ) AS SPCI_FBTG16_10
		,(YE169010.SPCI_FBTG17 ) AS SPCI_FBTG17_10
		,(YE169010.SPCI_FBTG18 ) AS SPCI_FBTG18_10
		,(YE169010.SPCI_FBTG19 ) AS SPCI_FBTG19_10
		,(YE169010.SPCI_FBTG20 ) AS SPCI_FBTG20_10
		,(YE169010.SPCI_FBTG21 ) AS SPCI_FBTG21_10
		,(YE169010.SPCI_FBTG22 ) AS SPCI_FBTG22_10
		,(YE169010.SPCI_FBSE16 ) AS SPCI_FBSE16_10
		,(YE169010.SPCI_FBSE17 ) AS SPCI_FBSE17_10
		,(YE169010.SPCI_FBSE18 ) AS SPCI_FBSE18_10
		,(YE169010.SPCI_FBSE19 ) AS SPCI_FBSE19_10
		,(YE169010.SPCI_FBSE20 ) AS SPCI_FBSE20_10
		,(YE169010.SPCI_FBSE21 ) AS SPCI_FBSE21_10
		,(YE169010.SPCI_FBSE22 ) AS SPCI_FBSE22_10
		,(YE169010.SPCI_NA16   ) AS SPCI_NA16_40    /* 종교단체외기부금 */  
		,(YE169010.SPCI_NA17   ) AS SPCI_NA17_40 
		,(YE169010.SPCI_NA18   ) AS SPCI_NA18_40
		,(YE169010.SPCI_NA19   ) AS SPCI_NA19_40
		,(YE169010.SPCI_NA20   ) AS SPCI_NA20_40
		,(YE169010.SPCI_NA21   ) AS SPCI_NA21_40  
		,(YE169010.SPCI_NA22   ) AS SPCI_NA22_40 
		,(YE169010.SPCI_NATG16 ) AS SPCI_NATG16_40
		,(YE169010.SPCI_NATG17 ) AS SPCI_NATG17_40
		,(YE169010.SPCI_NATG18 ) AS SPCI_NATG18_40
		,(YE169010.SPCI_NATG19 ) AS SPCI_NATG19_40
		,(YE169010.SPCI_NATG20 ) AS SPCI_NATG20_40
		,(YE169010.SPCI_NATG21 ) AS SPCI_NATG21_40
		,(YE169010.SPCI_NATG22 ) AS SPCI_NATG22_40
		,(YE169010.SPCI_NASE16 ) AS SPCI_NASE16_40
		,(YE169010.SPCI_NASE17 ) AS SPCI_NASE17_40
		,(YE169010.SPCI_NASE18 ) AS SPCI_NASE18_40
		,(YE169010.SPCI_NASE19 ) AS SPCI_NASE19_40
		,(YE169010.SPCI_NASE20 ) AS SPCI_NASE20_40
		,(YE169010.SPCI_NASE21 ) AS SPCI_NASE21_40
		,(YE169010.SPCI_NASE22 ) AS SPCI_NASE22_40
		,(YE169010.SPCI_YA16   ) AS SPCI_YA16_41    /* 종교단체기부금 */  
		,(YE169010.SPCI_YA17   ) AS SPCI_YA17_41  
		,(YE169010.SPCI_YA18   ) AS SPCI_YA18_41
		,(YE169010.SPCI_YA19   ) AS SPCI_YA19_41
		,(YE169010.SPCI_YA20   ) AS SPCI_YA20_41
		,(YE169010.SPCI_YA21   ) AS SPCI_YA21_41  
		,(YE169010.SPCI_YA22   ) AS SPCI_YA22_41 
		,(YE169010.SPCI_YATG16 ) AS SPCI_YATG16_41
		,(YE169010.SPCI_YATG17 ) AS SPCI_YATG17_41
		,(YE169010.SPCI_YATG18 ) AS SPCI_YATG18_41
		,(YE169010.SPCI_YATG19 ) AS SPCI_YATG19_41
		,(YE169010.SPCI_YATG20 ) AS SPCI_YATG20_41
		,(YE169010.SPCI_YATG21 ) AS SPCI_YATG21_41
		,(YE169010.SPCI_YATG22 ) AS SPCI_YATG22_41
		,(YE169010.SPCI_YASE16 ) AS SPCI_YASE16_41
		,(YE169010.SPCI_YASE17 ) AS SPCI_YASE17_41
		,(YE169010.SPCI_YASE18 ) AS SPCI_YASE18_41
		,(YE169010.SPCI_YASE19 ) AS SPCI_YASE19_41
		,(YE169010.SPCI_YASE20 ) AS SPCI_YASE20_41
		,(YE169010.SPCI_YASE21 ) AS SPCI_YASE21_41
		,(YE169010.SPCI_YASE22 ) AS SPCI_YASE22_41
		
		,(YE161060.CONB_LGL_USE_AMT) AS	CONB_LGL_USE_AMT 		/* 기부금이월분_법정기부금기부금납입액  */
		,(YE161060.CONB_LGL_DDC_AMT) AS	CONB_LGL_DDC_AMT 		/* 기부금이월분_법정기부금기부금공제액 */
		,(YE161060.CONB_RELI_ORG_OTH_USE_AMT) AS CONB_RELI_ORG_OTH_USE_AMT	/* 기부금이월분_지정기부금_종교단체외납입액 */
		,(YE161060.CONB_RELI_ORG_OTH_DDC_AMT) AS CONB_RELI_ORG_OTH_DDC_AMT	/* 기부금이월분_지정기부금_종교단체외공제액 */
		,(YE161060.CONB_RELI_ORG_USE_AMT) AS CONB_RELI_ORG_USE_AMT		/* 기부금이월분_지정기부금_종교단체납입액 */
		,(YE161060.CONB_RELI_ORG_DDC_AMT) AS CONB_RELI_ORG_DDC_AMT		/* 기부금이월분_지정기부금_종교단체공제액 */ 
        
        
        
        ,(YE169010.YETA_C141 ) AS YETA_C141
		,(YE169010.YETA_C143 ) AS YETA_C143
		,(YE169010.YETA_C147 ) AS YETA_C147 
		
		,(YE169010.YETA_C142 ) AS YETA_C142
		,(YE169010.YETA_C144 ) AS YETA_C144 
		 
      
       FROM YE169010 ,YE161020 ,YE161060 
          WHERE YE161020.SYSTEMKEY = YE169010.SYSTEMKEY  
            AND YE161020.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR 
            AND YE161020.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD 
            AND YE161020.DPOB_CD   = YE169010.DPOB_CD  
            AND YE161020.SYSTEMKEY = YE161060.SYSTEMKEY  
            AND YE161020.YRTX_BLGG_YR = YE161060.YRTX_BLGG_YR 
            AND YE161020.CLUT_SEPT_CD = YE161060.CLUT_SEPT_CD 
            AND YE161020.DPOB_CD   = YE161060.DPOB_CD  
            AND YE161020.DPOB_CD   = #dpobCd#                 
		    AND YE161020.SYSTEMKEY  = #systemkey#       
		    AND YE161020.CLUT_SEPT_CD = #clutSeptCd#    
		    AND YE161020.YRTX_BLGG_YR = #yrtxBlggYr#
	</select>	
	 	
<!-- 세액계산 기부금  -->
	<select id="infcPkgYeta17Tax_2022_DAO.fnPayr06430_PAYR442_ReTax_2022_SelectFind" parameterClass="yeta17TaxYe165030Srh_2022_Vo" resultClass="egovMap"> 
		<![CDATA[
			SELECT
					  DPOB_CD			/* 사업장코드              */
					,YRTX_BLGG_YR			/* 귀속연도		*/
					,CLUT_SEPT_CD			/* 연말정산구분코드		*/
					,SYSTEMKEY			/* SYSTEMKEY		*/
					,CONB_SEIL_NUM			/* 기부금조정일련번호		*/
					,CONB_CDDL			/* 기부금유형구분코드		*/
					,CTRB_TYCD			/* 기부금유형신고코드		*/
					,ATTR_YR			/* 기부년도		*/
					,USE_AMT			/* 기부금액		*/
					,PYR_DDC_AMT			/* 전년도공제된금액		*/
					,DDC_TRGT_AMT			/* 기부금공제대상금액		*/
					,THC_YR_DDC_AMT_ND_XPS		/* 해당연도공제금액필요경비	*/
					,THC_YR_DDC_AMT			/* 해당연도공제금액세액공제금액	*/
					,THC_YR_NDUC_EXTN_AMT		/* 해당연도미공제금액_소멸금액	*/
					,THC_YR_NDUC_CRFW_AMT		/* 해당연도미공제금액_이월금액	*/
					,KYBDR				/* 입력자			*/
					,INPT_DT			/* 입력일자		*/
					,INPT_ADDR			/* 입력주소		*/
					,ISMT				/* 수정자			*/
					,REVN_DT			/* 수정일자		*/
					,REVN_ADDR			/* 수정주소		*/
						FROM YE165030
						 WHERE  DPOB_CD=#dpobCd#                 
						    AND SYSTEMKEY = #systemkey#       
						    AND CLUT_SEPT_CD = #clutSeptCd#    
						    AND YRTX_BLGG_YR = #yrtxBlggYr# 
						ORDER BY YRTX_BLGG_YR DESC, CTRB_TYCD ASC 						
				]]>
	</select>
		<!--  AND ATTR_YR = #attrYr# -->
	<!-- yeta0300 화면 세액계산 결과  , DYYR_OTAM=#dyyrOtam# -->
	<update id="infcPkgYeta17Tax_2022_DAO.fnPayr06430_PAYR442_ReTax_2022_Update">
		<![CDATA[
		 UPDATE YE165030	
		SET       DDC_TRGT_AMT  = DECODE(#tgtCheck#,'UP',#ddcTrgtAmt#,DDC_TRGT_AMT) 
		        , THC_YR_DDC_AMT=#thcYrDdcAmt#    			/* 해당연도공제금액세액공제금액	*/
				, THC_YR_NDUC_EXTN_AMT=#thcYrNducExtnAmt#   /* 해당연도미공제금액_소멸금액	*/
				, THC_YR_NDUC_CRFW_AMT=#thcYrNducCrfwAmt#   /* 해당연도미공제금액_이월금액	*/
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
						WHERE DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
								AND SYSTEMKEY=#systemkey#
								AND CONB_SEIL_NUM=#conbSeilNum#
		 
				]]>
	</update>	
	
  <!--  공제대상 계 구하는 부분  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnPayr06430_PAYR415_ReTax_2016_CREATE_12_1_Update">
		<![CDATA[
		    	 UPDATE YE169010                                                                                                                                                                         
                            SET                                                                                                                                                                  
                            /* JRTR_TOTR IS '연금계좌 공제대상 계    */                                                                                                                                  
      						JRTR_TOTR = NVL(YETA_C127, 0) + NVL(YETA_C129, 0) + NVL(YETA_C131, 0) ,          
                            /* SPCI_DETG IS '특별공제_보장성보험료대상 계    */                                                                                                                             
                                 SPCI_DETG = NVL(SPCI_RTTG, 0) + NVL(SPCI_HDTG, 0) ,                              

  
                            /* SPED_ETAR IS '특별공제_교육비 대상금액 계  */                                                                                                                                   
                                   SPED_ETAR = NVL(SPED_SFTR, 0) + NVL(SPED_EDTR, 0) + NVL(SPED_GDTR, 0) + NVL(SPED_CVTR, 0) + NVL(SPCI_SCTR, 0),                                                

                           /*   SPCI_DGTG IS '특별공제)기부금공제대상 금액 계   */                                                                                                                             
                            SPCI_DGTG = (NVL(TAXD_10TG, 0)  + NVL(SPCI_PLTG, 0)  + NVL(SPCI_FBTG, 0) + NVL(SPCI_FB15, 0) 
                                        + NVL(SPCI_HFTG, 0) + NVL(SPCI_EXTG, 0)   + NVL(SPCI_UNTG, 0)  
      						                      + NVL(SPCI_YA15, 0)  + NVL(SPCI_NA15, 0)  + NVL(SPCI_NATG, 0)  + NVL(SPCI_YATG, 0)) 
                  WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#	 
		 ]]>
	  </update>
	  
	   	
	  <!-- 공제계  합산 부분 구하는 부분 - 여기부터 다시적용 하는 부분 이전에 0처리 할 부분 처리 하고 이곳호출  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnPayr06430_PAYR425_ReTax_2016_CREATE_12_Update">
		<![CDATA[
			           UPDATE YE169010                                                                                                                                                                         
                            SET                                                                                                                                                                  
                           /* RRPT_YNAM IS '연금보험료공제계  */                                                                                                                                    
                              RRPT_YNAM = NVL(BNAT_DDCT, 0) + NVL(JNAT_DDCT, 0) + NVL(BPSS_HPUL, 0)  + NVL(BPSS_HSOL, 0)  + NVL(BPSS_HTEC, 0)    
                             + NVL(BPSS_DDCT, 0) +  NVL(JPSS_HPUL, 0)  + NVL(JPSS_HSOL, 0)  + NVL(JPSS_HTEC, 0)   + NVL(JPSS_DDCT, 0) ,                            

                           /*  SPCI_HRTO IS '특별공제_보험료공제계  */                                                                                                                               
                                 SPCI_HRTO = NVL(SPCI_BHTH, 0) + NVL(SPCI_JHTH, 0) + NVL(SPCI_BEPF, 0) + NVL(SPCI_JEPF, 0),                              

                           /*   SPCH_RETO 주택자금공제액계 */                                                                                                                                        
                            SPCH_RETO = NVL(YETA_0C85, 0) + NVL(YETA_0C86, 0) + NVL(YETA_0C87, 0) + NVL(YETA_0C83, 0) 
                            +  NVL(YETA_0C84,0)  + NVL(YETA_0C88, 0)+ NVL(YETA_0C89, 0) + NVL(SPCI_15FX, 0)+ NVL(SPCI_15FB, 0)+ NVL(SPCI_15EC, 0) + NVL(SPCI_10FB, 0)
                            + NVL(SPCI_10EC, 0), 
                            
                            /*  SPCI_SSUM IS '특별공제)이전 년도 기부금세액 공제계 */                                                                                                                            
                            SPCI_SSUM =  NVL(SPCI_OBAM, 0)  + NVL(SPCI_ONON, 0)  + NVL(SPCI_OYAM, 0)  + NVL(SPCI_ONAM, 0)     
 							  WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#	  
				]]>
	</update>
	  
   <!-- 차감소득에 의한 값계산 차감소득금액   -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_50_Update">
		<![CDATA[
		 UPDATE YE169010                                                                                                                                                                         
                            SET
                            /*  C96_특별소득공제_특별소득공제합계   */  
                            YETA_0C96  =  (NVL(YETA_0C81,0) + NVL(YETA_0C82,0)  + NVL(YETA_0C83,0)
											+ NVL(YETA_0C84,0) + NVL(YETA_0C85,0) + NVL(YETA_0C86,0) + NVL(YETA_0C87,0) 
											+ NVL(YETA_0C88,0) + NVL(YETA_0C89,0) + NVL(YETA_0C90,0) + NVL(YETA_0C91,0)
											+ NVL(YETA_0C92,0) + NVL(YETA_0C93,0) + NVL(YETA_0C94,0)) ,
	      
            /*  SUBT_ERAM IS '차감소득금액   C97_차감소득금액  */                                                                                                                       
        YETA_0C97 =  (CASE WHEN (YETA_0C65 - (( NVL(YETA_0C66,0) + NVL(YETA_0C67,0) + NVL(YETA_0C69,0)
							+ NVL(YETA_0C71,0) + NVL(YETA_0C73,0) + NVL(YETA_0C74,0) + NVL(YETA_0C75,0)
							+ NVL(YETA_0C76,0) + NVL(YETA_0C77,0) + NVL(YETA_0C78,0) + NVL(YETA_0C79,0)
							+ NVL(YETA_0C80,0))  + (NVL(YETA_0C81,0) + NVL(YETA_0C82,0)  + NVL(YETA_0C83,0)
											+ NVL(YETA_0C84,0) + NVL(YETA_0C85,0) + NVL(YETA_0C86,0) + NVL(YETA_0C87,0) 
											+ NVL(YETA_0C88,0) + NVL(YETA_0C89,0) + NVL(YETA_0C90,0) + NVL(YETA_0C91,0)
											+ NVL(YETA_0C92,0) + NVL(YETA_0C93,0) + NVL(YETA_0C94,0))))  < 0 THEN
											 0                                                                                       
                                           ELSE (YETA_0C65 - (( NVL(YETA_0C66,0) + NVL(YETA_0C67,0) + NVL(YETA_0C69,0)
							+ NVL(YETA_0C71,0) + NVL(YETA_0C73,0) + NVL(YETA_0C74,0) + NVL(YETA_0C75,0)
							+ NVL(YETA_0C76,0) + NVL(YETA_0C77,0) + NVL(YETA_0C78,0) + NVL(YETA_0C79,0)
							+ NVL(YETA_0C80,0))  + (NVL(YETA_0C81,0) + NVL(YETA_0C82,0)  + NVL(YETA_0C83,0)
											+ NVL(YETA_0C84,0) + NVL(YETA_0C85,0) + NVL(YETA_0C86,0) + NVL(YETA_0C87,0) 
											+ NVL(YETA_0C88,0) + NVL(YETA_0C89,0) + NVL(YETA_0C90,0) + NVL(YETA_0C91,0)
											+ NVL(YETA_0C92,0) + NVL(YETA_0C93,0) + NVL(YETA_0C94,0)))) END) 
		
         WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#	                       
				]]>
	</update>
	
	   
	     <!-- 차감소득에 의한 값계산 차감소득금액   -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010a_Tax_2022_50_Update">
		<![CDATA[
		 UPDATE YE169010a                                                                                                                                                                         
                            SET
                            /*  C96_특별소득공제_특별소득공제합계   */  
                            YETA_STD_0C96  =  (NVL(YETA_STD_0C81,0) + NVL(YETA_STD_0C82,0)  + NVL(YETA_STD_0C83,0)
											+ NVL(YETA_STD_0C84,0) + NVL(YETA_STD_0C85,0) + NVL(YETA_STD_0C86,0) + NVL(YETA_STD_0C87,0) 
											+ NVL(YETA_STD_0C88,0) + NVL(YETA_STD_0C89,0) + NVL(YETA_STD_0C90,0) + NVL(YETA_STD_0C91,0)
											+ NVL(YETA_STD_0C92,0) + NVL(YETA_STD_0C93,0) + NVL(YETA_STD_0C94,0)) ,
	      
            /*  SUBT_ERAM IS '차감소득금액   C97_차감소득금액  */                                                                                                                       
        YETA_STD_0C97 =  (CASE WHEN (YETA_STD_0C65 - (( NVL(YETA_STD_0C66,0) + NVL(YETA_STD_0C67,0) + NVL(YETA_STD_0C69,0)
							+ NVL(YETA_STD_0C71,0) + NVL(YETA_STD_0C73,0) + NVL(YETA_STD_0C74,0) + NVL(YETA_STD_0C75,0)
							+ NVL(YETA_STD_0C76,0) + NVL(YETA_STD_0C77,0) + NVL(YETA_STD_0C78,0) + NVL(YETA_STD_0C79,0)
							+ NVL(YETA_STD_0C80,0))  + (NVL(YETA_STD_0C81,0) + NVL(YETA_STD_0C82,0)  + NVL(YETA_STD_0C83,0)
											+ NVL(YETA_STD_0C84,0) + NVL(YETA_STD_0C85,0) + NVL(YETA_STD_0C86,0) + NVL(YETA_STD_0C87,0) 
											+ NVL(YETA_STD_0C88,0) + NVL(YETA_STD_0C89,0) + NVL(YETA_STD_0C90,0) + NVL(YETA_STD_0C91,0)
											+ NVL(YETA_STD_0C92,0) + NVL(YETA_STD_0C93,0) + NVL(YETA_STD_0C94,0))))  < 0 THEN
											 0                                                                                       
                                           ELSE (YETA_STD_0C65 - (( NVL(YETA_STD_0C66,0) + NVL(YETA_STD_0C67,0) + NVL(YETA_STD_0C69,0)
							+ NVL(YETA_STD_0C71,0) + NVL(YETA_STD_0C73,0) + NVL(YETA_STD_0C74,0) + NVL(YETA_STD_0C75,0)
							+ NVL(YETA_STD_0C76,0) + NVL(YETA_STD_0C77,0) + NVL(YETA_STD_0C78,0) + NVL(YETA_STD_0C79,0)
							+ NVL(YETA_STD_0C80,0))  + (NVL(YETA_STD_0C81,0) + NVL(YETA_STD_0C82,0)  + NVL(YETA_STD_0C83,0)
											+ NVL(YETA_STD_0C84,0) + NVL(YETA_STD_0C85,0) + NVL(YETA_STD_0C86,0) + NVL(YETA_STD_0C87,0) 
											+ NVL(YETA_STD_0C88,0) + NVL(YETA_STD_0C89,0) + NVL(YETA_STD_0C90,0) + NVL(YETA_STD_0C91,0)
											+ NVL(YETA_STD_0C92,0) + NVL(YETA_STD_0C93,0) + NVL(YETA_STD_0C94,0)))) END) 
		
         WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#	                       
				]]>
	</update>	 	  
	  	
	
	   <!--  그밖의 소득공제 계   -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_50_01_Update">
		<![CDATA[
			  UPDATE YE169010                                                                                                                                                         
                          SET                                            
                           /*   C110_기타소득공제합계금액  */									  
		            YETA_C110  =   (NVL(YETA_0C98,0) + NVL(YETA_0C99,0) + NVL(YETA_C100,0) + NVL(YETA_C101,0)
							+ NVL(YETA_C102,0) + NVL(YETA_C103,0) + NVL(YETA_C104,0) + NVL(YETA_C105,0)
							+ NVL(YETA_C107,0) + NVL(YETA_C108,0) + NVL(YETA_C109,0) + NVL(YETA_C109Y,0))  
			       WHERE DPOB_CD=#dpobCd#
                     AND YRTX_BLGG_YR=#yrtxBlggYr#
                     AND CLUT_SEPT_CD=#clutSeptCd#
                     AND SYSTEMKEY=#systemkey#	
				]]>
	</update>
	
	   	   <!--  그밖의 소득공제 계   -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010a_Tax_2022_50_01_Update">
		<![CDATA[
			  UPDATE YE169010A                                                                                                                                                         
                          SET                                            
                           /*   C110_기타소득공제합계금액  */									  
		            YETA_STD_C110  =   (NVL(YETA_STD_0C98,0) + NVL(YETA_STD_0C99,0) + NVL(YETA_STD_C100,0) + NVL(YETA_STD_C101,0)
							+ NVL(YETA_STD_C102,0) + NVL(YETA_STD_C103,0) + NVL(YETA_STD_C104,0) + NVL(YETA_STD_C105,0)
							+ NVL(YETA_STD_C107,0) + NVL(YETA_STD_C108,0) + NVL(YETA_STD_C109,0)+ NVL(YETA_STD_C109Y,0))  
			       WHERE DPOB_CD=#dpobCd#
                     AND YRTX_BLGG_YR=#yrtxBlggYr#
                     AND CLUT_SEPT_CD=#clutSeptCd#
                     AND SYSTEMKEY=#systemkey#	
				]]>
	</update>
	
	
 
     <resultMap id="yetaDscnPrc3000_2022" class="com.app.smrmf.infc.yearendtax.server.vo.yeta2022.InfcPkgYe169010_2022_VO"> 
		<result property="tyetaC159" column="TYETA_C159" columnIndex="1"/>
	    <result property="yetaC159" column="YETA_C159" columnIndex="2"/>
	    <result property="yetaC162" column="YETA_C162" columnIndex="3"/>
	    <result property="rsdtClCd" column="RSDT_CL_CD" columnIndex="4"/> 
	    <result property="yetaC152Check" column="YETA_C152_CHECK" columnIndex="5"/> 
	    
	</resultMap>
      
	<select id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_51_Select" parameterClass="yeta17TaxYe169010Srh_2022"  resultMap="yetaDscnPrc3000_2022">
		<![CDATA[
	   SELECT
        (AA.PRDD_TAXN - ( (BB.YETA_C119 + BB.YETA_C158)
        - BB.YETA_C157 - BB.YETA_C120
        - (BB.YETA_C151 - BB.YETA_C142 - BB.YETA_C144 - BB.YETA_C148)
        + 130000 + (CASE WHEN BB.YETA_C116 > 0 THEN  (CASE WHEN  YETA_0C63 <= 33000000 THEN                                                                                        
                                              TRUNC((CASE WHEN NVL(AA.PRDD_TAXN,0) <= 1300000                                                                                          
                                                      THEN CASE WHEN (NVL(AA.PRDD_TAXN,0) * 0.55) > 740000 THEN 740000 ELSE  (NVL(AA.PRDD_TAXN,0) * 0.55) END                        
                                                      ELSE                                                                                                                     
                                                       CASE WHEN (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000) > 740000                                                      
                                                       THEN 740000                                                                                                              
                                                       ELSE (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000)                                                                     
                                                       END  END)  ) * ( 1- (NVL(YETA_0C63,0) / NVL(AA.PRDD_TAXN,0)))                                                                                                               
                                          WHEN  YETA_0C63 <= 70000000 THEN                                                                                                                     
                                               TRUNC((CASE WHEN NVL(AA.PRDD_TAXN,0) <= 1300000                                                                                           
                                                      THEN CASE WHEN (NVL(AA.PRDD_TAXN,0) * 0.55) > (CASE WHEN (740000 - ((YETA_0C63 - 33000000) * 0.008))  < 660000 THEN 660000     
                                                                                                       ELSE (740000 - ((YETA_0C63 - 33000000) * 0.008))  END)                     
                                                                THEN  (CASE WHEN (740000 - ((YETA_0C63 - 33000000) * 0.008))  < 660000 THEN 660000                                
                                                                            ELSE (740000 - ((YETA_0C63 - 33000000) * 0.008))  END)                                                
                                                                ELSE  (NVL(AA.PRDD_TAXN,0) * 0.55) END                                                                                             
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000) > (CASE WHEN (740000 - ((YETA_0C63 - 33000000) * 0.008))  < 660000 THEN 660000   
                                                                                                                         ELSE (740000 - ((YETA_0C63 - 33000000) * 0.008))  END)                   
                                                       THEN (CASE WHEN (740000 - ((YETA_0C63 - 33000000) * 0.008))  < 660000 THEN 660000                                                          
                                                                            ELSE (740000 - ((YETA_0C63 - 33000000) * 0.008))  END)                                                                
                                                       ELSE (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  ) * ( 1- (NVL(YETA_0C63,0) / NVL(AA.PRDD_TAXN,0)))                                                                                                                                
                                         ELSE                                                                                                                                                                  
                                          TRUNC((CASE WHEN NVL(AA.PRDD_TAXN,0) <= 1300000                                                                                                           
                                                      THEN CASE WHEN (NVL(AA.PRDD_TAXN,0) * 0.55) > (CASE WHEN (660000 - ((YETA_0C63 - 70000000) * 0.5))  < 500000 THEN 500000                     
                                                                                                       ELSE (660000 - ((YETA_0C63 - 70000000) * 0.5))  END)                                     
                                                                THEN (CASE WHEN (660000 - ((YETA_0C63 - 70000000) * 0.5))  < 500000 THEN 500000                                                 
                                                                                                       ELSE (660000 - ((YETA_0C63 - 70000000) * 0.5))  END)                                     
                                                                ELSE  (NVL(AA.PRDD_TAXN,0) * 0.55)  END                                                                                            
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000) > (CASE WHEN (660000 - ((YETA_0C63 - 70000000) * 0.5))  < 500000 THEN 500000   
                                                                                                                        ELSE (660000 - ((YETA_0C63 - 70000000) * 0.5))  END)                    
                                                       THEN (CASE WHEN (660000 - ((YETA_0C63 - 70000000) * 0.5))  < 500000 THEN 500000                                                          
                                                                                                       ELSE (660000 - ((YETA_0C63 - 70000000) * 0.5))  END)                                     
                                                       ELSE (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  ) * ( 1- (NVL(YETA_0C63,0) / NVL(AA.PRDD_TAXN,0)))                                                                                     
                                           END  )                                                                                                                                                                
                               ELSE  (CASE WHEN  YETA_0C63 <= 33000000 THEN                                                                                                    
                                          TRUNC((CASE WHEN NVL(AA.PRDD_TAXN,0) <= 1300000                                                                                                           
                                                      THEN CASE WHEN (NVL(AA.PRDD_TAXN,0) * 0.55) > 740000 THEN 740000 ELSE  (NVL(AA.PRDD_TAXN,0) * 0.55) END                                         
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000) > 740000                                                                       
                                                       THEN 740000                                                                                                                              
                                                       ELSE (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  )                                                                                                                             
                                       WHEN  YETA_0C63 <= 70000000 THEN                                                                                                                                     
                                          TRUNC((CASE WHEN NVL(AA.PRDD_TAXN,0) <= 1300000                                                                                                           
                                                      THEN CASE WHEN (NVL(AA.PRDD_TAXN,0) * 0.55) > (CASE WHEN (740000 - ((YETA_0C63 - 33000000) * 0.008))  < 660000 THEN 660000                     
                                                                                                       ELSE (740000 - ((YETA_0C63 - 33000000) * 0.008))  END)                                     
                                                                THEN  (CASE WHEN (740000 - ((YETA_0C63 - 33000000) * 0.008))  < 660000 THEN 660000                                                
                                                                            ELSE (740000 - ((YETA_0C63 - 33000000) * 0.008))  END)                                                                
                                                                ELSE  (NVL(AA.PRDD_TAXN,0) * 0.55) END                                                                                             
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000) > (CASE WHEN (740000 - ((YETA_0C63 - 33000000) * 0.008))  < 660000 THEN 660000   
                                                                                                                         ELSE (740000 - ((YETA_0C63 - 33000000) * 0.008))  END)                   
                                                       THEN (CASE WHEN (740000 - ((YETA_0C63 - 33000000) * 0.008))  < 660000 THEN 660000                                                          
                                                                            ELSE (740000 - ((YETA_0C63 - 33000000) * 0.008))  END)                                                                
                                                       ELSE (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  )                                                                                                                             
                                      ELSE                                                                                                                                                                  
                                          TRUNC((CASE WHEN NVL(AA.PRDD_TAXN,0) <= 1300000                                                                                                           
                                                      THEN CASE WHEN (NVL(AA.PRDD_TAXN,0) * 0.55) > (CASE WHEN (660000 - ((YETA_0C63 - 70000000) * 0.5))  < 500000 THEN 500000                     
                                                                                                       ELSE (660000 - ((YETA_0C63 - 70000000) * 0.5))  END)                                     
                                                                THEN (CASE WHEN (660000 - ((YETA_0C63 - 70000000) * 0.5))  < 500000 THEN 500000                                                 
                                                                                                       ELSE (660000 - ((YETA_0C63 - 70000000) * 0.5))  END)                                     
                                                                ELSE  (NVL(AA.PRDD_TAXN,0) * 0.55)  END                                                                                            
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000) > (CASE WHEN (660000 - ((YETA_0C63 - 70000000) * 0.5))  < 500000 THEN 500000   
                                                                                                                        ELSE (660000 - ((YETA_0C63 - 70000000) * 0.5))  END)                    
                                                       THEN (CASE WHEN (660000 - ((YETA_0C63 - 70000000) * 0.5))  < 500000 THEN 500000                                                          
                                                                                                       ELSE (660000 - ((YETA_0C63 - 70000000) * 0.5))  END)                                     
                                                       ELSE (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  )                                                                                                                             
                         END  ) END)
                         )) 
          AS TYETA_C159, nvl(BB.YETA_C159,0) as YETA_C159,0,(NVL(BB.YETA_C162,0) + NVL(BB.DCSN_ITAX,0)) AS YETA_C162,(
           CASE WHEN (
                        NVL(BB.YETA_0C96,0) - (YETA_0C81 + YETA_0C82) + NVL(BB.YETA_C157,0) + (NVL(BB.YETA_C151,0) - NVL(BB.YETA_C142,0) - NVL(BB.YETA_C144,0) - NVL(BB.YETA_C148,0))
                       ) > 0 THEN (CASE WHEN  YETA_C151 < 130000 THEN 'Y' ELSE 'N' END) ELSE 'Y' END
          ) AS YETA_C152_CHECK , CC.RSDT_CL_CD
FROM
(SELECT  YE169010.DPOB_CD,
         YE169010.YRTX_BLGG_YR,
         YE169010.CLUT_SEPT_CD,
         YE169010.SYSTEMKEY,
          (CASE
           WHEN TRUNC (
                   CASE
                      WHEN (CASE
                               WHEN (YETA_0C97 + YETA_0C96 - YETA_C110) < 0
                               THEN
                                  0
                               ELSE
                                    (  YETA_0C97 + YETA_0C96 - YETA_C110)
                                  + (CASE
                                        WHEN ((  (  NVL (YETA_0C99, 0)
                                                 +  (  (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                    + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                                 + NVL (YETA_C104, 0)
                                                 + NVL (YETA_C105, 0)
                                                 + NVL (YETA_C109, 0)
                                                 + NVL (YETA_C109Y, 0))
                                              - 25000000) < 0
                                        THEN
                                           0
                                        ELSE
                                           ((  (  NVL (YETA_0C99, 0)
                                               + ( (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                  + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                               + NVL (YETA_C104, 0)
                                               + NVL (YETA_C105, 0)
                                               + NVL (YETA_C109, 0)
                                               + NVL (YETA_C109Y, 0))
                                            - 25000000)
                                     END)
                            END) <= 12000000
                      THEN
                         (  (CASE
                                WHEN  (  YETA_0C97 + YETA_0C96 - YETA_C110) < 0
                                THEN
                                   0
                                ELSE
                                      (  YETA_0C97 + YETA_0C96 - YETA_C110)
                                   + (CASE
                                         WHEN ((  (  NVL (YETA_0C99, 0)
                                                  + ( (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                      + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                                  + NVL (YETA_C104, 0)
                                                  + NVL (YETA_C105, 0)
                                                  + NVL (YETA_C109, 0)
                                                  + NVL (YETA_C109Y, 0))
                                               - 25000000) < 0
                                         THEN
                                            0
                                         ELSE
                                            ( ( (  NVL (YETA_0C99, 0)
                                                + ( (YETA_C100 +  YETA_C101 +  YETA_C102 )  
                                                   + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                                + NVL (YETA_C104, 0)
                                                + NVL (YETA_C105, 0)
                                                + NVL (YETA_C109, 0)
                                                + NVL (YETA_C109Y, 0))
                                             - 25000000)
                                      END)
                             END)
                          * 0.06)
                      WHEN (CASE
                               WHEN  (  YETA_0C97 + YETA_0C96 - YETA_C110) < 0
                               THEN
                                  0
                               ELSE
                                     (  YETA_0C97 + YETA_0C96 - YETA_C110)
                                  + (CASE
                                        WHEN ( ( (  NVL (YETA_0C99, 0)
                                                 + (  ( YETA_C100 +  YETA_C101 + YE169010.YETA_C102 ) 
                                                   + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                                 + NVL (YETA_C104, 0)
                                                 + NVL (YETA_C105, 0)
                                                 + NVL (YETA_C109, 0)
                                                 + NVL (YETA_C109Y, 0))
                                              - 25000000) < 0
                                        THEN
                                           0
                                        ELSE
                                           (  ((  NVL (YETA_0C99, 0)
                                               + ( (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                  + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                               + NVL (YETA_C104, 0)
                                               + NVL (YETA_C105, 0)
                                               + NVL (YETA_C109, 0)
                                               + NVL (YETA_C109Y, 0))
                                            - 25000000)
                                     END)
                            END) <= 46000000
                      THEN
                         (  (  (CASE
                                   WHEN  (  YETA_0C97 + YETA_0C96 - YETA_C110) < 0
                                   THEN
                                      0
                                   ELSE
                                        (  YETA_0C97 + YETA_0C96 - YETA_C110)
                                      + (CASE
                                            WHEN ( ( (  NVL (YETA_0C99, 0)
                                                     + (  (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                        + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                                     + NVL (YETA_C104, 0)
                                                     + NVL (YETA_C105, 0)
                                                     + NVL (YETA_C109, 0)
                                                     + NVL (YETA_C109Y, 0))
                                                  - 25000000) < 0
                                            THEN
                                               0
                                            ELSE
                                               ( ( (  NVL (YETA_0C99, 0)
                                                   + (  (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                      + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                                   + NVL (YETA_C104, 0)
                                                   + NVL (YETA_C105, 0)
                                                   + NVL (YETA_C109, 0)
                                                   + NVL (YETA_C109Y, 0))
                                                - 25000000)
                                         END)
                                END)
                             * 0.15)
                          - 1080000)
                      WHEN (CASE
                               WHEN  (  YETA_0C97 + YETA_0C96 - YETA_C110) < 0
                               THEN
                                  0
                               ELSE
                                     (  YETA_0C97 + YETA_0C96 - YETA_C110)
                                  + (CASE
                                        WHEN ((  (  NVL (YETA_0C99, 0)
                                                 + ( (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                    + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                                 + NVL (YETA_C104, 0)
                                                 + NVL (YETA_C105, 0)
                                                 + NVL (YETA_C109, 0)
                                                 + NVL (YETA_C109Y, 0))
                                              - 25000000) < 0
                                        THEN
                                           0
                                        ELSE
                                           (  ((  NVL (YETA_0C99, 0)
                                               + (  (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                  + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                               + NVL (YETA_C104, 0)
                                               + NVL (YETA_C105, 0)
                                               + NVL (YETA_C109, 0)
                                               + NVL (YETA_C109Y, 0))
                                            - 25000000)
                                     END)
                            END) <= 88000000
                      THEN
                         (  (  (CASE
                                   WHEN  (  YETA_0C97 + YETA_0C96 - YETA_C110) < 0
                                   THEN
                                      0
                                   ELSE
                                         (  YETA_0C97 + YETA_0C96 - YETA_C110)
                                      + (CASE
                                            WHEN ((  (  NVL (YETA_0C99, 0)
                                                     + (  (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                        + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                                     + NVL (YETA_C104, 0)
                                                     + NVL (YETA_C105, 0)
                                                     + NVL (YETA_C109, 0)
                                                     + NVL (YETA_C109Y, 0))
                                                  - 25000000) < 0
                                            THEN
                                               0
                                            ELSE
                                               ( ( (  NVL (YETA_0C99, 0)
                                                   + ( (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                      + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                                   + NVL (YETA_C104, 0)
                                                   + NVL (YETA_C105, 0)
                                                   + NVL (YETA_C109, 0)
                                                   + NVL (YETA_C109Y, 0))
                                                - 25000000)
                                         END)
                                END)
                             * 0.24)
                          - 5220000)
                      WHEN (CASE
                               WHEN  (  YETA_0C97 + YETA_0C96 - YETA_C110) < 0
                               THEN
                                  0
                               ELSE
                                   (  YETA_0C97 + YETA_0C96 - YETA_C110)
                                  + (CASE
                                        WHEN ( ( (  NVL (YETA_0C99, 0)
                                                 + ( (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                   + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                                 + NVL (YETA_C104, 0)
                                                 + NVL (YETA_C105, 0)
                                                 + NVL (YETA_C109, 0)
                                                 + NVL (YETA_C109Y, 0))
                                              - 25000000) < 0
                                        THEN
                                           0
                                        ELSE
                                           (  ((  NVL (YETA_0C99, 0)
                                               + (  (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                   + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                               + NVL (YETA_C104, 0)
                                               + NVL (YETA_C105, 0)
                                               + NVL (YETA_C109, 0)
                                               + NVL (YETA_C109Y, 0))
                                            - 25000000)
                                     END)
                            END) <= 150000000
                      THEN
                         (  (  (CASE
                                   WHEN  (  YETA_0C97 + YETA_0C96 - YETA_C110) < 0
                                   THEN
                                      0
                                   ELSE
                                         (  YETA_0C97 + YETA_0C96 - YETA_C110)
                                      + (CASE
                                            WHEN ((  (  NVL (YETA_0C99, 0)
                                                     + (  (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                        + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                                     + NVL (YETA_C104, 0)
                                                     + NVL (YETA_C105, 0)
                                                     + NVL (YETA_C109, 0)
                                                     + NVL (YETA_C109Y, 0))
                                                  - 25000000) < 0
                                            THEN
                                               0
                                            ELSE
                                               ((  (  NVL (YETA_0C99, 0)
                                                   + (  (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                       + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                                   + NVL (YETA_C104, 0)
                                                   + NVL (YETA_C105, 0)
                                                   + NVL (YETA_C109, 0)
                                                   + NVL (YETA_C109Y, 0))
                                                - 25000000)
                                         END)
                                END)
                             * 0.35)
                          - 14900000)
                      ELSE
                         (  (  (CASE
                                   WHEN  (  YETA_0C97 + YETA_0C96 - YETA_C110) < 0
                                   THEN
                                      0
                                   ELSE
                                         (  YETA_0C97 + YETA_0C96 - YETA_C110)
                                      + (CASE
                                            WHEN ( ( (  NVL (YETA_0C99, 0)
                                                     + (  (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                        + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                                     + NVL (YETA_C104, 0)
                                                     + NVL (YETA_C105, 0)
                                                     + NVL (YETA_C109, 0)
                                                     + NVL (YETA_C109Y, 0))
                                                  - 25000000) < 0
                                            THEN
                                               0
                                            ELSE
                                               ((  (  NVL (YETA_0C99, 0)
                                                   + (  (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                      + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                                   + NVL (YETA_C104, 0)
                                                   + NVL (YETA_C105, 0)
                                                   + NVL (YETA_C109, 0)
                                                   + NVL (YETA_C109Y, 0))
                                                - 25000000)
                                         END)
                                END)
                             * 0.38)
                          - 19400000)
                   END) < 0
           THEN
              0
           ELSE
              TRUNC (
                 CASE
                    WHEN (CASE
                             WHEN  (  YETA_0C97 + YETA_0C96 - YETA_C110) < 0
                             THEN
                                0
                             ELSE
                                   (  YETA_0C97 + YETA_0C96 - YETA_C110)
                                + (CASE
                                      WHEN ( ( (  NVL (YETA_0C99, 0)
                                               + ( (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                  + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                               + NVL (YETA_C104, 0)
                                               + NVL (YETA_C105, 0)
                                               + NVL (YETA_C109, 0)
                                               + NVL (YETA_C109Y, 0))
                                            - 25000000) < 0
                                      THEN
                                         0
                                      ELSE
                                         (  ((  NVL (YETA_0C99, 0)
                                             + ( (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                 + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                             + NVL (YETA_C104, 0)
                                             + NVL (YETA_C105, 0)
                                             + NVL (YETA_C109, 0)
                                             + NVL (YETA_C109Y, 0))
                                          - 25000000)
                                   END)
                          END) <= 12000000
                    THEN
                       (  (CASE
                              WHEN  (  YETA_0C97 + YETA_0C96 - YETA_C110) < 0
                              THEN
                                 0
                              ELSE
                                    (  YETA_0C97 + YETA_0C96 - YETA_C110)
                                 + (CASE
                                       WHEN ( ( (  NVL (YETA_0C99, 0)
                                                + ( (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                    + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                                + NVL (YETA_C104, 0)
                                                + NVL (YETA_C105, 0)
                                                + NVL (YETA_C109, 0)
                                                + NVL (YETA_C109Y, 0))
                                             - 25000000) < 0
                                       THEN
                                          0
                                       ELSE
                                          ((  (  NVL (YETA_0C99, 0)
                                              + ( (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                  + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                              + NVL (YETA_C104, 0)
                                              + NVL (YETA_C105, 0)
                                              + NVL (YETA_C109, 0)
                                              + NVL (YETA_C109Y, 0))
                                           - 25000000)
                                    END)
                           END)
                        * 0.06)
                    WHEN (CASE
                             WHEN  (  YETA_0C97 + YETA_0C96 - YETA_C110) < 0
                             THEN
                                0
                             ELSE
                                   (  YETA_0C97 + YETA_0C96 - YETA_C110)
                                + (CASE
                                      WHEN ( ( (  NVL (YETA_0C99, 0)
                                               + ( (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                  + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                               + NVL (YETA_C104, 0)
                                               + NVL (YETA_C105, 0)
                                               + NVL (YETA_C109, 0)
                                               + NVL (YETA_C109Y, 0))
                                            - 25000000) < 0
                                      THEN
                                         0
                                      ELSE
                                         ((  (  NVL (YETA_0C99, 0)
                                             + ( (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                 + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                             + NVL (YETA_C104, 0)
                                             + NVL (YETA_C105, 0)
                                             + NVL (YETA_C109, 0)
                                             + NVL (YETA_C109Y, 0))
                                          - 25000000)
                                   END)
                          END) <= 46000000
                    THEN
                       (  (  (CASE
                                 WHEN (  YETA_0C97 + YETA_0C96 - YETA_C110) < 0
                                 THEN
                                    0
                                 ELSE
                                      (  YETA_0C97 + YETA_0C96 - YETA_C110)
                                    + (CASE
                                          WHEN (  ((  NVL (YETA_0C99, 0)
                                                   + ( (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                       + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                                   + NVL (YETA_C104, 0)
                                                   + NVL (YETA_C105, 0)
                                                   + NVL (YETA_C109, 0)
                                                   + NVL (YETA_C109Y, 0))
                                                - 25000000) < 0
                                          THEN
                                             0
                                          ELSE
                                             ( ( (  NVL (YETA_0C99, 0)
                                                 + ( (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                     + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                                 + NVL (YETA_C104, 0)
                                                 + NVL (YETA_C105, 0)
                                                 + NVL (YETA_C109, 0)
                                                 + NVL (YETA_C109Y, 0))
                                              - 25000000)
                                       END)
                              END)
                           * 0.15)
                        - 1080000)
                    WHEN (CASE
                             WHEN (  YETA_0C97 + YETA_0C96 - YETA_C110) < 0
                             THEN
                                0
                             ELSE
                                 (  YETA_0C97 + YETA_0C96 - YETA_C110)
                                + (CASE
                                      WHEN ( ( (  NVL (YETA_0C99, 0)
                                               + (  (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                  + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                               + NVL (YETA_C104, 0)
                                               + NVL (YETA_C105, 0)
                                               + NVL (YETA_C109, 0)
                                               + NVL (YETA_C109Y, 0))
                                            - 25000000) < 0
                                      THEN
                                         0
                                      ELSE
                                         ((  (  NVL (YETA_0C99, 0)
                                             + ( (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                             + NVL (YETA_C104, 0)
                                             + NVL (YETA_C105, 0)
                                             + NVL (YETA_C109, 0)
                                             + NVL (YETA_C109Y, 0))
                                          - 25000000)
                                   END)
                          END) <= 88000000
                    THEN
                       (  (  (CASE
                                 WHEN (  YETA_0C97 + YETA_0C96 - YETA_C110) < 0
                                 THEN
                                    0
                                 ELSE
                                      (  YETA_0C97 + YETA_0C96 - YETA_C110)
                                    + (CASE
                                          WHEN ( ( (  NVL (YETA_0C99, 0)
                                                   + ( (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                       + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                                   + NVL (YETA_C104, 0)
                                                   + NVL (YETA_C105, 0)
                                                   + NVL (YETA_C109, 0)
                                                   + NVL (YETA_C109Y, 0))
                                                - 25000000) < 0
                                          THEN
                                             0
                                          ELSE
                                             ((  (  NVL (YETA_0C99, 0)
                                                 + ( (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                     + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                                 + NVL (YETA_C104, 0)
                                                 + NVL (YETA_C105, 0)
                                                 + NVL (YETA_C109, 0)
                                                 + NVL (YETA_C109Y, 0))
                                              - 25000000)
                                       END)
                              END)
                           * 0.24)
                        - 5220000)
                    WHEN (CASE
                             WHEN (  YETA_0C97 + YETA_0C96 - YETA_C110) < 0
                             THEN
                                0
                             ELSE
                                  (  YETA_0C97 + YETA_0C96 - YETA_C110)
                                + (CASE
                                      WHEN ( ( (  NVL (YETA_0C99, 0)
                                               + ( (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                  + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                               + NVL (YETA_C104, 0)
                                               + NVL (YETA_C105, 0)
                                               + NVL (YETA_C109, 0)
                                               + NVL (YETA_C109Y, 0))
                                            - 25000000) < 0
                                      THEN
                                         0
                                      ELSE
                                         ( ( (  NVL (YETA_0C99, 0)
                                             + ( (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                 + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                             + NVL (YETA_C104, 0)
                                             + NVL (YETA_C105, 0)
                                             + NVL (YETA_C109, 0)
                                             + NVL (YETA_C109Y, 0))
                                          - 25000000)
                                   END)
                          END) <= 150000000
                    THEN
                       (  (  (CASE
                                 WHEN (  YETA_0C97 + YETA_0C96 - YETA_C110) < 0
                                 THEN
                                    0
                                 ELSE
                                      (  YETA_0C97 + YETA_0C96 - YETA_C110)
                                    + (CASE
                                          WHEN ((  (  NVL (YETA_0C99, 0)
                                                   + ( (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                       + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                                   + NVL (YETA_C104, 0)
                                                   + NVL (YETA_C105, 0)
                                                   + NVL (YETA_C109, 0)
                                                   + NVL (YETA_C109Y, 0))
                                                - 25000000) < 0
                                          THEN
                                             0
                                          ELSE
                                             ((  (  NVL (YETA_0C99, 0)
                                                 + (  (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                     + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                                 + NVL (YETA_C104, 0)
                                                 + NVL (YETA_C105, 0)
                                                 + NVL (YETA_C109, 0)
                                                 + NVL (YETA_C109Y, 0))
                                              - 25000000)
                                       END)
                              END)
                           * 0.35)
                        - 14900000)
                    ELSE
                       (  (  (CASE
                                 WHEN (  YETA_0C97 + YETA_0C96 - YETA_C110) < 0
                                 THEN
                                    0
                                 ELSE
                                      (  YETA_0C97 + YETA_0C96 - YETA_C110)
                                    + (CASE
                                          WHEN ((  (  NVL (YETA_0C99, 0)
                                                   + ( (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                       + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                                   + NVL (YETA_C104, 0)
                                                   + NVL (YETA_C105, 0)
                                                   + NVL (YETA_C109, 0)
                                                   + NVL (YETA_C109Y, 0))
                                                - 25000000) < 0
                                          THEN
                                             0
                                          ELSE
                                             ( ( (  NVL (YETA_0C99, 0)
                                                 + ( (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                    + (  NVL (YETA_C103, 0) - NVL( AC01.VENTU,0))  ))
                                                 + NVL (YETA_C104, 0)
                                                 + NVL (YETA_C105, 0)
                                                 + NVL (YETA_C109, 0)
                                                 + NVL (YETA_C109Y, 0))
                                              - 25000000)
                                       END)
                              END)
                           * 0.38)
                        - 19400000)
                 END)
        END) AS  PRDD_TAXN 
  FROM YE169010 , (SELECT DPOB_CD
                        ,YRTX_BLGG_YR
                        ,CLUT_SEPT_CD
                        ,SYSTEMKEY
                        ,(NVL(CPIV20_VNT_DDC_AMT,0) +  NVL(CPIV21_VNT_DDC_AMT,0) + NVL(CPIV22_VNT_DDC_AMT,0)) AS VENTU
                    FROM  YE161070 
                         WHERE DPOB_CD=#dpobCd#
                         AND YRTX_BLGG_YR=#yrtxBlggYr#
                          AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey# ) AC01
   WHERE YE169010.DPOB_CD = AC01.DPOB_CD(+)
     AND YE169010.YRTX_BLGG_YR = AC01.YRTX_BLGG_YR(+) 
     AND YE169010.CLUT_SEPT_CD = AC01.CLUT_SEPT_CD(+) 
     AND YE169010.SYSTEMKEY = AC01.SYSTEMKEY(+)
  ) AA, YE169010 BB,YE161020 CC
   WHERE AA.DPOB_CD = BB.DPOB_CD 
     AND AA.YRTX_BLGG_YR = BB.YRTX_BLGG_YR 
     AND AA.CLUT_SEPT_CD = BB.CLUT_SEPT_CD 
     AND AA.SYSTEMKEY = BB.SYSTEMKEY
     AND AA.DPOB_CD = CC.DPOB_CD 
     AND AA.YRTX_BLGG_YR = CC.YRTX_BLGG_YR 
     AND AA.CLUT_SEPT_CD = CC.CLUT_SEPT_CD 
     AND AA.SYSTEMKEY = CC.SYSTEMKEY
     AND AA.DPOB_CD=#dpobCd#
	 AND AA.YRTX_BLGG_YR=#yrtxBlggYr#
 	 AND AA.CLUT_SEPT_CD=#clutSeptCd#
	 AND AA.SYSTEMKEY=#systemkey# 
      ]]>
	</select>		
	
	<resultMap id="tpInfcPkgYe169010_2022" class="com.app.smrmf.infc.yearendtax.server.vo.yeta2022.InfcPkgYe169010_2022_VO">
		<result property="dpobCd" column="DPOB_CD" columnIndex="1"/>
		<result property="yrtxBlggYr" column="YRTX_BLGG_YR" columnIndex="2"/>
		<result property="clutSeptCd" column="CLUT_SEPT_CD" columnIndex="3"/>
		<result property="systemkey" column="SYSTEMKEY" columnIndex="4"/> 
		<result property="yeta0c63" column="YETA_0C63" columnIndex="52"/>
		<result property="yeta0c64" column="YETA_0C64" columnIndex="53"/>
		<result property="yeta0c65" column="YETA_0C65" columnIndex="54"/>
		<result property="yeta0c66" column="YETA_0C66" columnIndex="55"/>
		<result property="yeta0c67" column="YETA_0C67" columnIndex="56"/>
		<result property="yeta0c68" column="YETA_0C68" columnIndex="57"/>
		<result property="yeta0c69" column="YETA_0C69" columnIndex="58"/>
		<result property="yeta0c70" column="YETA_0C70" columnIndex="59"/>
		<result property="yeta0c71" column="YETA_0C71" columnIndex="60"/>
		<result property="yeta0c72" column="YETA_0C72" columnIndex="61"/>
		<result property="yeta0c73" column="YETA_0C73" columnIndex="62"/>
		<result property="yeta0c74" column="YETA_0C74" columnIndex="63"/>
		<result property="yeta0c75" column="YETA_0C75" columnIndex="64"/>
		<result property="yeta0c76" column="YETA_0C76" columnIndex="65"/>
		<result property="yeta0c77" column="YETA_0C77" columnIndex="66"/>
		<result property="yeta0c78" column="YETA_0C78" columnIndex="67"/>
		<result property="yeta0c79" column="YETA_0C79" columnIndex="68"/>
		<result property="yeta0c80" column="YETA_0C80" columnIndex="69"/>
		<result property="yeta0c81" column="YETA_0C81" columnIndex="70"/>
		<result property="yeta0c82" column="YETA_0C82" columnIndex="71"/>
		<result property="yeta0c83" column="YETA_0C83" columnIndex="72"/>
		<result property="yeta0c84" column="YETA_0C84" columnIndex="73"/>
		<result property="yeta0c85" column="YETA_0C85" columnIndex="74"/>
		<result property="yeta0c86" column="YETA_0C86" columnIndex="75"/>
		<result property="yeta0c87" column="YETA_0C87" columnIndex="76"/>
		<result property="yeta0c88" column="YETA_0C88" columnIndex="77"/>
		<result property="yeta0c89" column="YETA_0C89" columnIndex="78"/>
		<result property="yeta0c90" column="YETA_0C90" columnIndex="79"/>
		<result property="yeta0c91" column="YETA_0C91" columnIndex="80"/>
		<result property="yeta0c92" column="YETA_0C92" columnIndex="81"/>
		<result property="yeta0c93" column="YETA_0C93" columnIndex="82"/>
		<result property="yeta0c94" column="YETA_0C94" columnIndex="83"/>
		<result property="yeta0c96" column="YETA_0C96" columnIndex="84"/>
		<result property="yeta0c97" column="YETA_0C97" columnIndex="85"/>
		<result property="yeta0c98" column="YETA_0C98" columnIndex="86"/>
		<result property="yeta0c99" column="YETA_0C99" columnIndex="87"/>
		<result property="yetaC100" column="YETA_C100" columnIndex="88"/>
		<result property="yetaC101" column="YETA_C101" columnIndex="89"/>
		<result property="yetaC102" column="YETA_C102" columnIndex="90"/>
		<result property="yetaC103" column="YETA_C103" columnIndex="91"/>
		<result property="yetaC104" column="YETA_C104" columnIndex="92"/>
		<result property="yetaC105" column="YETA_C105" columnIndex="93"/>
		<result property="yetaC107" column="YETA_C107" columnIndex="94"/>
		<result property="yetaC108" column="YETA_C108" columnIndex="95"/>
		<result property="yetaC109" column="YETA_C109" columnIndex="96"/>
		<result property="yetaC109y" column="YETA_C109Y" columnIndex="97"/>
		<result property="yetaC110" column="YETA_C110" columnIndex="98"/>
		<result property="yetaC111" column="YETA_C111" columnIndex="99"/>
		<result property="yetaC112" column="YETA_C112" columnIndex="100"/>
		<result property="yetaC113" column="YETA_C113" columnIndex="101"/>
		<result property="yetaC114" column="YETA_C114" columnIndex="102"/>
		<result property="yetaC115" column="YETA_C115" columnIndex="103"/>
		<result property="yetaC116" column="YETA_C116" columnIndex="104"/>
		<result property="yetaC117" column="YETA_C117" columnIndex="105"/>
		<result property="yetaC119" column="YETA_C119" columnIndex="106"/>
		<result property="yetaC120" column="YETA_C120" columnIndex="107"/>
		<result property="yetaC121" column="YETA_C121" columnIndex="108"/>
		<result property="yetaC122" column="YETA_C122" columnIndex="109"/>
		<result property="yetaC123" column="YETA_C123" columnIndex="110"/>
		<result property="yetaC124" column="YETA_C124" columnIndex="111"/>
		<result property="yetaC125" column="YETA_C125" columnIndex="112"/>
		<result property="yetaC126" column="YETA_C126" columnIndex="113"/>
		<result property="yetaC127" column="YETA_C127" columnIndex="114"/>
		<result property="yetaC128" column="YETA_C128" columnIndex="115"/>
		<result property="yetaC129" column="YETA_C129" columnIndex="116"/>
		<result property="yetaC130" column="YETA_C130" columnIndex="117"/>
		<result property="yetaC131" column="YETA_C131" columnIndex="118"/>
		<result property="yetaC132" column="YETA_C132" columnIndex="119"/>
		<result property="yetaC133" column="YETA_C133" columnIndex="120"/>
		<result property="yetaC134" column="YETA_C134" columnIndex="121"/>
		<result property="yetaC135" column="YETA_C135" columnIndex="122"/>
		<result property="yetaC136" column="YETA_C136" columnIndex="123"/>
		<result property="yetaC137" column="YETA_C137" columnIndex="124"/>
		<result property="yetaC138" column="YETA_C138" columnIndex="125"/>
		<result property="yetaC139" column="YETA_C139" columnIndex="126"/>
		<result property="yetaC140" column="YETA_C140" columnIndex="127"/>
		<result property="yetaC141" column="YETA_C141" columnIndex="128"/>
		<result property="yetaC142" column="YETA_C142" columnIndex="129"/>
		<result property="yetaC143" column="YETA_C143" columnIndex="130"/>
		<result property="yetaC144" column="YETA_C144" columnIndex="131"/>
		<result property="yetaC145" column="YETA_C145" columnIndex="132"/>
		<result property="yetaC146" column="YETA_C146" columnIndex="133"/>
		<result property="yetaC147" column="YETA_C147" columnIndex="134"/>
		<result property="yetaC148" column="YETA_C148" columnIndex="135"/>
		<result property="yetaC149" column="YETA_C149" columnIndex="136"/>
		<result property="yetaC150" column="YETA_C150" columnIndex="137"/>
		<result property="yetaC150a" column="YETA_C150A" columnIndex="138"/>
		<result property="yetaC150b" column="YETA_C150B" columnIndex="139"/>
		<result property="yetaC151" column="YETA_C151" columnIndex="140"/>
		<result property="yetaC152" column="YETA_C152" columnIndex="141"/>
		<result property="yetaC153" column="YETA_C153" columnIndex="142"/>
		<result property="yetaC154" column="YETA_C154" columnIndex="143"/>
		<result property="yetaC155" column="YETA_C155" columnIndex="144"/>
		<result property="yetaC156" column="YETA_C156" columnIndex="145"/>
		<result property="yetaC157" column="YETA_C157" columnIndex="146"/>
		<result property="yetaC158" column="YETA_C158" columnIndex="147"/>
		<result property="yetaC159" column="YETA_C159" columnIndex="148"/>
		<result property="yetaC160" column="YETA_C160" columnIndex="149"/>
		<result property="yetaC161" column="YETA_C161" columnIndex="150"/>
		<result property="yetaC162" column="YETA_C162" columnIndex="151"/>
		<result property="yetaC163" column="YETA_C163" columnIndex="152"/>
		<result property="yetaC164" column="YETA_C164" columnIndex="153"/>
		<result property="yetaC165" column="YETA_C165" columnIndex="154"/>
		<result property="yetaC166" column="YETA_C166" columnIndex="155"/>
		<result property="yetaC167" column="YETA_C167" columnIndex="156"/>
		<result property="yetaC168" column="YETA_C168" columnIndex="157"/>
		<result property="yetaC169" column="YETA_C169" columnIndex="158"/>
		<result property="yetaC170" column="YETA_C170" columnIndex="159"/>
		<result property="yetaC13a" column="YETA_C13A" columnIndex="160"/>
		<result property="yetaC13b" column="YETA_C13B" columnIndex="161"/>
		<result property="kybdr" column="KYBDR" columnIndex="162"/>
		<result property="inptDt" column="INPT_DT" columnIndex="163"/>
		<result property="inptAddr" column="INPT_ADDR" columnIndex="164"/>
		<result property="ismt" column="ISMT" columnIndex="165"/>
		<result property="revnDt" column="REVN_DT" columnIndex="166"/>
		<result property="revnAddr" column="REVN_ADDR" columnIndex="167"/>
	</resultMap>
<!-- 세액계산 처리를 위한 부분으로 yeta0300 화면  -->
		<select id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_2001_Select" resultMap="tpInfcPkgYe169010_2022">
		<![CDATA[
			SELECT DPOB_CD
				  , YRTX_BLGG_YR
				  , CLUT_SEPT_CD
				  , SYSTEMKEY
				 , NVL(YETA_0C63  ,0) AS YETA_0C63 
				, NVL(YETA_0C64	 ,0) AS YETA_0C64 
				, NVL(YETA_0C65	 ,0) AS YETA_0C65 
				, NVL(YETA_0C66	 ,0) AS YETA_0C66 
				, NVL(YETA_0C67	 ,0) AS YETA_0C67 
				, NVL(YETA_0C68	 ,0) AS YETA_0C68 
				, NVL(YETA_0C69	 ,0) AS YETA_0C69 
				, NVL(YETA_0C70	 ,0) AS YETA_0C70 
				, NVL(YETA_0C71	 ,0) AS YETA_0C71 
				, NVL(YETA_0C72	 ,0) AS YETA_0C72 
				, NVL(YETA_0C73	 ,0) AS YETA_0C73 
				, NVL(YETA_0C74	 ,0) AS YETA_0C74 
				, NVL(YETA_0C75	 ,0) AS YETA_0C75 
				, NVL(YETA_0C76	 ,0) AS YETA_0C76 
				, NVL(YETA_0C77	 ,0) AS YETA_0C77 
				, NVL(YETA_0C78	 ,0) AS YETA_0C78 
				, NVL(YETA_0C79	 ,0) AS YETA_0C79 
				, NVL(YETA_0C80	 ,0) AS YETA_0C80 
				, NVL(YETA_0C81	 ,0) AS YETA_0C81 
				, NVL(YETA_0C82	 ,0) AS YETA_0C82 
				, NVL(YETA_0C83	 ,0) AS YETA_0C83 
				, NVL(YETA_0C84	 ,0) AS YETA_0C84 
				, NVL(YETA_0C85	 ,0) AS YETA_0C85 
				, NVL(YETA_0C86	 ,0) AS YETA_0C86 
				, NVL(YETA_0C87	 ,0) AS YETA_0C87 
				, NVL(YETA_0C88	 ,0) AS YETA_0C88 
				, NVL(YETA_0C89	 ,0) AS YETA_0C89 
				, NVL(YETA_0C90	 ,0) AS YETA_0C90 
				, NVL(YETA_0C91	 ,0) AS YETA_0C91 
				, NVL(YETA_0C92	 ,0) AS YETA_0C92 
				, NVL(YETA_0C93	 ,0) AS YETA_0C93 
				, NVL(YETA_0C94	 ,0) AS YETA_0C94 
				, NVL(YETA_0C96	 ,0) AS YETA_0C96 
				, NVL(YETA_0C97	 ,0) AS YETA_0C97 
				, NVL(YETA_0C98	 ,0) AS YETA_0C98 
				, NVL(YETA_0C99	 ,0) AS YETA_0C99 
				, NVL(YETA_C100	 ,0) AS YETA_C100 
				, NVL(YETA_C101	 ,0) AS YETA_C101 
				, NVL(YETA_C102	 ,0) AS YETA_C102 
				, NVL(YETA_C103	 ,0) AS YETA_C103 
				, NVL(YETA_C104	 ,0) AS YETA_C104 
				, NVL(YETA_C105	 ,0) AS YETA_C105 
				, NVL(YETA_C107	 ,0) AS YETA_C107 
				, NVL(YETA_C108	 ,0) AS YETA_C108 
				, NVL(YETA_C109	 ,0) AS YETA_C109 
				, NVL(YETA_C109Y ,0) AS YETA_C109Y 
				, NVL(YETA_C110	 ,0) AS YETA_C110 
				, NVL(YETA_C111	 ,0) AS YETA_C111 
				, NVL(YETA_C112	 ,0) AS YETA_C112 
				, NVL(YETA_C113	 ,0) AS YETA_C113 
				, NVL(YETA_C114	 ,0) AS YETA_C114 
				, NVL(YETA_C115	 ,0) AS YETA_C115 
				, NVL(YETA_C116	 ,0) AS YETA_C116 
				, NVL(YETA_C117	 ,0) AS YETA_C117 
				, NVL(YETA_C119	 ,0) AS YETA_C119 
				, NVL(YETA_C120	 ,0) AS YETA_C120 
				, NVL(YETA_C121	 ,0) AS YETA_C121 
				, NVL(YETA_C122	 ,0) AS YETA_C122 
				, NVL(YETA_C123	 ,0) AS YETA_C123 
				, NVL(YETA_C124	 ,0) AS YETA_C124 
				, NVL(YETA_C125	 ,0) AS YETA_C125 
				, NVL(YETA_C126	 ,0) AS YETA_C126 
				, NVL(YETA_C127	 ,0) AS YETA_C127 
				, NVL(YETA_C128	 ,0) AS YETA_C128 
				, NVL(YETA_C129	 ,0) AS YETA_C129 
				, NVL(YETA_C130	 ,0) AS YETA_C130 
				, NVL(YETA_C131	 ,0) AS YETA_C131 
				, NVL(YETA_C132	 ,0) AS YETA_C132
				, NVL(YETA_C13A	 ,0) AS YETA_C13A
				, NVL(YETA_C13B	 ,0) AS YETA_C13B 
				, NVL(YETA_C133	 ,0) AS YETA_C133 
				, NVL(YETA_C134	 ,0) AS YETA_C134 
				, NVL(YETA_C135	 ,0) AS YETA_C135 
				, NVL(YETA_C136	 ,0) AS YETA_C136 
				, NVL(YETA_C137	 ,0) AS YETA_C137 
				, NVL(YETA_C138	 ,0) AS YETA_C138 
				, NVL(YETA_C139	 ,0) AS YETA_C139 
				, NVL(YETA_C140	 ,0) AS YETA_C140 
				, NVL(YETA_C141	 ,0) AS YETA_C141 
				, NVL(YETA_C142	 ,0) AS YETA_C142 
				, NVL(YETA_C143	 ,0) AS YETA_C143 
				, NVL(YETA_C144	 ,0) AS YETA_C144 
				, NVL(YETA_C145	 ,0) AS YETA_C145 
				, NVL(YETA_C146	 ,0) AS YETA_C146 
				, NVL(YETA_C147	 ,0) AS YETA_C147 
				, NVL(YETA_C148	 ,0) AS YETA_C148 
				, NVL(YETA_C149	 ,0) AS YETA_C149 
				, NVL(YETA_C150	 ,0) AS YETA_C150 
				, NVL(YETA_C150A ,0) AS YETA_C150A
				, NVL(YETA_C150B ,0) AS YETA_C150B
				, NVL(YETA_C151	 ,0) AS YETA_C151 
				, NVL(YETA_C152	 ,0) AS YETA_C152 
				, NVL(YETA_C153	 ,0) AS YETA_C153 
				, NVL(YETA_C154	 ,0) AS YETA_C154 
				, NVL(YETA_C155	 ,0) AS YETA_C155 
				, NVL(YETA_C156	 ,0) AS YETA_C156 
				, NVL(YETA_C157	 ,0) AS YETA_C157 
				, NVL(YETA_C158	 ,0) AS YETA_C158 
				, NVL(YETA_C159	 ,0) AS YETA_C159 
				, NVL(YETA_C160	 ,0) AS YETA_C160 
				, NVL(YETA_C161	 ,0) AS YETA_C161 
				, NVL(YETA_C162	 ,0) AS YETA_C162 
				, NVL(YETA_C163	 ,0) AS YETA_C163 
				, NVL(YETA_C164	 ,0) AS YETA_C164 
				, NVL(YETA_C165	 ,0) AS YETA_C165 
				, NVL(YETA_C166	 ,0) AS YETA_C166 
				, NVL(YETA_C167	 ,0) AS YETA_C167 
				, NVL(YETA_C168	 ,0) AS YETA_C168 
				, NVL(YETA_C169	 ,0) AS YETA_C169 
				, NVL(YETA_C170	 ,0) AS YETA_C170 
				, KYBDR
				, INPT_DT
				, INPT_ADDR
				, ISMT
				, REVN_DT
				, REVN_ADDR
			FROM YE169010
			  WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</select>	
	
		
		<resultMap id="tpInfcPkgYe169010a_2022" class="com.app.smrmf.infc.yearendtax.server.vo.yeta2022.InfcPkgYe169010a_2022_VO">
		<result property="dpobCd" column="DPOB_CD" columnIndex="1"/>
		<result property="yrtxBlggYr" column="YRTX_BLGG_YR" columnIndex="2"/>
		<result property="clutSeptCd" column="CLUT_SEPT_CD" columnIndex="3"/>
		<result property="systemkey" column="SYSTEMKEY" columnIndex="4"/> 
		<result property="yetaStd0c63" column="YETA_STD_0C63" columnIndex="52"/>
		<result property="yetaStd0c64" column="YETA_STD_0C64" columnIndex="53"/>
		<result property="yetaStd0c65" column="YETA_STD_0C65" columnIndex="54"/>
		<result property="yetaStd0c66" column="YETA_STD_0C66" columnIndex="55"/>
		<result property="yetaStd0c67" column="YETA_STD_0C67" columnIndex="56"/>
		<result property="yetaStd0c68" column="YETA_STD_0C68" columnIndex="57"/>
		<result property="yetaStd0c69" column="YETA_STD_0C69" columnIndex="58"/>
		<result property="yetaStd0c70" column="YETA_STD_0C70" columnIndex="59"/>
		<result property="yetaStd0c71" column="YETA_STD_0C71" columnIndex="60"/>
		<result property="yetaStd0c72" column="YETA_STD_0C72" columnIndex="61"/>
		<result property="yetaStd0c73" column="YETA_STD_0C73" columnIndex="62"/>
		<result property="yetaStd0c74" column="YETA_STD_0C74" columnIndex="63"/>
		<result property="yetaStd0c75" column="YETA_STD_0C75" columnIndex="64"/>
		<result property="yetaStd0c76" column="YETA_STD_0C76" columnIndex="65"/>
		<result property="yetaStd0c77" column="YETA_STD_0C77" columnIndex="66"/>
		<result property="yetaStd0c78" column="YETA_STD_0C78" columnIndex="67"/>
		<result property="yetaStd0c79" column="YETA_STD_0C79" columnIndex="68"/>
		<result property="yetaStd0c80" column="YETA_STD_0C80" columnIndex="69"/>
		<result property="yetaStd0c81" column="YETA_STD_0C81" columnIndex="70"/>
		<result property="yetaStd0c82" column="YETA_STD_0C82" columnIndex="71"/>
		<result property="yetaStd0c83" column="YETA_STD_0C83" columnIndex="72"/>
		<result property="yetaStd0c84" column="YETA_STD_0C84" columnIndex="73"/>
		<result property="yetaStd0c85" column="YETA_STD_0C85" columnIndex="74"/>
		<result property="yetaStd0c86" column="YETA_STD_0C86" columnIndex="75"/>
		<result property="yetaStd0c87" column="YETA_STD_0C87" columnIndex="76"/>
		<result property="yetaStd0c88" column="YETA_STD_0C88" columnIndex="77"/>
		<result property="yetaStd0c89" column="YETA_STD_0C89" columnIndex="78"/>
		<result property="yetaStd0c90" column="YETA_STD_0C90" columnIndex="79"/>
		<result property="yetaStd0c91" column="YETA_STD_0C91" columnIndex="80"/>
		<result property="yetaStd0c92" column="YETA_STD_0C92" columnIndex="81"/>
		<result property="yetaStd0c93" column="YETA_STD_0C93" columnIndex="82"/>
		<result property="yetaStd0c94" column="YETA_STD_0C94" columnIndex="83"/>
		<result property="yetaStd0c96" column="YETA_STD_0C96" columnIndex="84"/>
		<result property="yetaStd0c97" column="YETA_STD_0C97" columnIndex="85"/>
		<result property="yetaStd0c98" column="YETA_STD_0C98" columnIndex="86"/>
		<result property="yetaStd0c99" column="YETA_STD_0C99" columnIndex="87"/>
		<result property="yetaStdC100" column="YETA_STD_C100" columnIndex="88"/>
		<result property="yetaStdC101" column="YETA_STD_C101" columnIndex="89"/>
		<result property="yetaStdC102" column="YETA_STD_C102" columnIndex="90"/>
		<result property="yetaStdC103" column="YETA_STD_C103" columnIndex="91"/>
		<result property="yetaStdC104" column="YETA_STD_C104" columnIndex="92"/>
		<result property="yetaStdC105" column="YETA_STD_C105" columnIndex="93"/>
		<result property="yetaStdC107" column="YETA_STD_C107" columnIndex="94"/>
		<result property="yetaStdC108" column="YETA_STD_C108" columnIndex="95"/>
		<result property="yetaStdC109" column="YETA_STD_C109" columnIndex="96"/>
		<result property="yetaStdC109y" column="YETA_STD_C109Y" columnIndex="97"/>
		<result property="yetaStdC110" column="YETA_STD_C110" columnIndex="98"/>
		<result property="yetaStdC111" column="YETA_STD_C111" columnIndex="99"/>
		<result property="yetaStdC112" column="YETA_STD_C112" columnIndex="100"/>
		<result property="yetaStdC113" column="YETA_STD_C113" columnIndex="101"/>
		<result property="yetaStdC114" column="YETA_STD_C114" columnIndex="102"/>
		<result property="yetaStdC115" column="YETA_STD_C115" columnIndex="103"/>
		<result property="yetaStdC116" column="YETA_STD_C116" columnIndex="104"/>
		<result property="yetaStdC117" column="YETA_STD_C117" columnIndex="105"/>
		<result property="yetaStdC119" column="YETA_STD_C119" columnIndex="106"/>
		<result property="yetaStdC120" column="YETA_STD_C120" columnIndex="107"/>
		<result property="yetaStdC121" column="YETA_STD_C121" columnIndex="108"/>
		<result property="yetaStdC122" column="YETA_STD_C122" columnIndex="109"/>
		<result property="yetaStdC123" column="YETA_STD_C123" columnIndex="110"/>
		<result property="yetaStdC124" column="YETA_STD_C124" columnIndex="111"/>
		<result property="yetaStdC125" column="YETA_STD_C125" columnIndex="112"/>
		<result property="yetaStdC126" column="YETA_STD_C126" columnIndex="113"/>
		<result property="yetaStdC127" column="YETA_STD_C127" columnIndex="114"/>
		<result property="yetaStdC128" column="YETA_STD_C128" columnIndex="115"/>
		<result property="yetaStdC129" column="YETA_STD_C129" columnIndex="116"/>
		<result property="yetaStdC130" column="YETA_STD_C130" columnIndex="117"/>
		<result property="yetaStdC131" column="YETA_STD_C131" columnIndex="118"/>
		<result property="yetaStdC132" column="YETA_STD_C132" columnIndex="119"/>
		<result property="yetaStdC133" column="YETA_STD_C133" columnIndex="120"/>
		<result property="yetaStdC134" column="YETA_STD_C134" columnIndex="121"/>
		<result property="yetaStdC135" column="YETA_STD_C135" columnIndex="122"/>
		<result property="yetaStdC136" column="YETA_STD_C136" columnIndex="123"/>
		<result property="yetaStdC137" column="YETA_STD_C137" columnIndex="124"/>
		<result property="yetaStdC138" column="YETA_STD_C138" columnIndex="125"/>
		<result property="yetaStdC139" column="YETA_STD_C139" columnIndex="126"/>
		<result property="yetaStdC140" column="YETA_STD_C140" columnIndex="127"/>
		<result property="yetaStdC141" column="YETA_STD_C141" columnIndex="128"/>
		<result property="yetaStdC142" column="YETA_STD_C142" columnIndex="129"/>
		<result property="yetaStdC143" column="YETA_STD_C143" columnIndex="130"/>
		<result property="yetaStdC144" column="YETA_STD_C144" columnIndex="131"/>
		<result property="yetaStdC145" column="YETA_STD_C145" columnIndex="132"/>
		<result property="yetaStdC146" column="YETA_STD_C146" columnIndex="133"/>
		<result property="yetaStdC147" column="YETA_STD_C147" columnIndex="134"/>
		<result property="yetaStdC148" column="YETA_STD_C148" columnIndex="135"/>
		<result property="yetaStdC149" column="YETA_STD_C149" columnIndex="136"/>
		<result property="yetaStdC150" column="YETA_STD_C150" columnIndex="137"/>
		<result property="yetaStdC150a" column="YETA_STD_C150A" columnIndex="138"/>
		<result property="yetaStdC150b" column="YETA_STD_C150B" columnIndex="139"/>
		<result property="yetaStdC151" column="YETA_STD_C151" columnIndex="140"/>
		<result property="yetaStdC152" column="YETA_STD_C152" columnIndex="141"/>
		<result property="yetaStdC153" column="YETA_STD_C153" columnIndex="142"/>
		<result property="yetaStdC154" column="YETA_STD_C154" columnIndex="143"/>
		<result property="yetaStdC155" column="YETA_STD_C155" columnIndex="144"/>
		<result property="yetaStdC156" column="YETA_STD_C156" columnIndex="145"/>
		<result property="yetaStdC157" column="YETA_STD_C157" columnIndex="146"/>
		<result property="yetaStdC158" column="YETA_STD_C158" columnIndex="147"/>
		<result property="yetaStdC159" column="YETA_STD_C159" columnIndex="148"/>
		<result property="yetaStdC160" column="YETA_STD_C160" columnIndex="149"/>
		<result property="yetaStdC161" column="YETA_STD_C161" columnIndex="150"/>
		<result property="yetaStdC162" column="YETA_STD_C162" columnIndex="151"/>
		<result property="yetaStdC163" column="YETA_STD_C163" columnIndex="152"/>
		<result property="yetaStdC164" column="YETA_STD_C164" columnIndex="153"/>
		<result property="yetaStdC165" column="YETA_STD_C165" columnIndex="154"/>
		<result property="yetaStdC166" column="YETA_STD_C166" columnIndex="155"/>
		<result property="yetaStdC167" column="YETA_STD_C167" columnIndex="156"/>
		<result property="yetaStdC168" column="YETA_STD_C168" columnIndex="157"/>
		<result property="yetaStdC169" column="YETA_STD_C169" columnIndex="158"/>
		<result property="yetaStdC170" column="YETA_STD_C170" columnIndex="159"/>
		<result property="yetaStdC13a" column="YETA_STD_C13A" columnIndex="160"/>
		<result property="yetaStdC13b" column="YETA_STD_C13B" columnIndex="161"/>
		<result property="kybdr" column="KYBDR" columnIndex="162"/>
		<result property="inptDt" column="INPT_DT" columnIndex="163"/>
		<result property="inptAddr" column="INPT_ADDR" columnIndex="164"/>
		<result property="ismt" column="ISMT" columnIndex="165"/>
		<result property="revnDt" column="REVN_DT" columnIndex="166"/>
		<result property="revnAddr" column="REVN_ADDR" columnIndex="167"/>
	</resultMap>
<!-- 세액계산 처리를 위한 부분으로 yeta0300 화면  -->
		<select id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010a_Tax_2022_2001_Select" resultMap="tpInfcPkgYe169010a_2022">
		<![CDATA[
			SELECT DPOB_CD
				  , YRTX_BLGG_YR
				  , CLUT_SEPT_CD
				  , SYSTEMKEY
								, NVL(YETA_STD_0C63  ,0)     AS YETA_STD_0C63 
				, NVL(YETA_STD_0C64	 ,0) AS YETA_STD_0C64 
				, NVL(YETA_STD_0C65	 ,0) AS YETA_STD_0C65 
				, NVL(YETA_STD_0C66	 ,0) AS YETA_STD_0C66 
				, NVL(YETA_STD_0C67	 ,0) AS YETA_STD_0C67 
				, NVL(YETA_STD_0C68	 ,0) AS YETA_STD_0C68 
				, NVL(YETA_STD_0C69	 ,0) AS YETA_STD_0C69 
				, NVL(YETA_STD_0C70	 ,0) AS YETA_STD_0C70 
				, NVL(YETA_STD_0C71	 ,0) AS YETA_STD_0C71 
				, NVL(YETA_STD_0C72	 ,0) AS YETA_STD_0C72 
				, NVL(YETA_STD_0C73	 ,0) AS YETA_STD_0C73 
				, NVL(YETA_STD_0C74	 ,0) AS YETA_STD_0C74 
				, NVL(YETA_STD_0C75	 ,0) AS YETA_STD_0C75 
				, NVL(YETA_STD_0C76	 ,0) AS YETA_STD_0C76 
				, NVL(YETA_STD_0C77	 ,0) AS YETA_STD_0C77 
				, NVL(YETA_STD_0C78	 ,0) AS YETA_STD_0C78 
				, NVL(YETA_STD_0C79	 ,0) AS YETA_STD_0C79 
				, NVL(YETA_STD_0C80	 ,0) AS YETA_STD_0C80 
				, NVL(YETA_STD_0C81	 ,0) AS YETA_STD_0C81 
				, NVL(YETA_STD_0C82	 ,0) AS YETA_STD_0C82 
				, NVL(YETA_STD_0C83	 ,0) AS YETA_STD_0C83 
				, NVL(YETA_STD_0C84	 ,0) AS YETA_STD_0C84 
				, NVL(YETA_STD_0C85	 ,0) AS YETA_STD_0C85 
				, NVL(YETA_STD_0C86	 ,0) AS YETA_STD_0C86 
				, NVL(YETA_STD_0C87	 ,0) AS YETA_STD_0C87 
				, NVL(YETA_STD_0C88	 ,0) AS YETA_STD_0C88 
				, NVL(YETA_STD_0C89	 ,0) AS YETA_STD_0C89 
				, NVL(YETA_STD_0C90	 ,0) AS YETA_STD_0C90 
				, NVL(YETA_STD_0C91	 ,0) AS YETA_STD_0C91 
				, NVL(YETA_STD_0C92	 ,0) AS YETA_STD_0C92 
				, NVL(YETA_STD_0C93	 ,0) AS YETA_STD_0C93 
				, NVL(YETA_STD_0C94	 ,0) AS YETA_STD_0C94 
				, NVL(YETA_STD_0C96	 ,0) AS YETA_STD_0C96 
				, NVL(YETA_STD_0C97	 ,0) AS YETA_STD_0C97 
				, NVL(YETA_STD_0C98	 ,0) AS YETA_STD_0C98 
				, NVL(YETA_STD_0C99	 ,0) AS YETA_STD_0C99 
				, NVL(YETA_STD_C100	 ,0) AS YETA_STD_C100 
				, NVL(YETA_STD_C101	 ,0) AS YETA_STD_C101 
				, NVL(YETA_STD_C102	 ,0) AS YETA_STD_C102 
				, NVL(YETA_STD_C103	 ,0) AS YETA_STD_C103 
				, NVL(YETA_STD_C104	 ,0) AS YETA_STD_C104 
				, NVL(YETA_STD_C105	 ,0) AS YETA_STD_C105 
				, NVL(YETA_STD_C107	 ,0) AS YETA_STD_C107 
				, NVL(YETA_STD_C108	 ,0) AS YETA_STD_C108 
				, NVL(YETA_STD_C109	 ,0) AS YETA_STD_C109 
				, NVL(YETA_STD_C109Y ,0) AS YETA_STD_C109Y 
				, NVL(YETA_STD_C110	 ,0) AS YETA_STD_C110 
				, NVL(YETA_STD_C111	 ,0) AS YETA_STD_C111 
				, NVL(YETA_STD_C112	 ,0) AS YETA_STD_C112 
				, NVL(YETA_STD_C113	 ,0) AS YETA_STD_C113 
				, NVL(YETA_STD_C114	 ,0) AS YETA_STD_C114 
				, NVL(YETA_STD_C115	 ,0) AS YETA_STD_C115 
				, NVL(YETA_STD_C116	 ,0) AS YETA_STD_C116 
				, NVL(YETA_STD_C117	 ,0) AS YETA_STD_C117 
				, NVL(YETA_STD_C119	 ,0) AS YETA_STD_C119 
				, NVL(YETA_STD_C120	 ,0) AS YETA_STD_C120 
				, NVL(YETA_STD_C121	 ,0) AS YETA_STD_C121 
				, NVL(YETA_STD_C122	 ,0) AS YETA_STD_C122 
				, NVL(YETA_STD_C123	 ,0) AS YETA_STD_C123 
				, NVL(YETA_STD_C124	 ,0) AS YETA_STD_C124 
				, NVL(YETA_STD_C125	 ,0) AS YETA_STD_C125 
				, NVL(YETA_STD_C126	 ,0) AS YETA_STD_C126 
				, NVL(YETA_STD_C127	 ,0) AS YETA_STD_C127 
				, NVL(YETA_STD_C128	 ,0) AS YETA_STD_C128 
				, NVL(YETA_STD_C129	 ,0) AS YETA_STD_C129 
				, NVL(YETA_STD_C130	 ,0) AS YETA_STD_C130 
				, NVL(YETA_STD_C131	 ,0) AS YETA_STD_C131 
				, NVL(YETA_STD_C132	 ,0) AS YETA_STD_C132
				, NVL(YETA_STD_C13A	 ,0) AS YETA_STD_C13A
				, NVL(YETA_STD_C13B	 ,0) AS YETA_STD_C13B 
				, NVL(YETA_STD_C133	 ,0) AS YETA_STD_C133 
				, NVL(YETA_STD_C134	 ,0) AS YETA_STD_C134 
				, NVL(YETA_STD_C135	 ,0) AS YETA_STD_C135 
				, NVL(YETA_STD_C136	 ,0) AS YETA_STD_C136 
				, NVL(YETA_STD_C137	 ,0) AS YETA_STD_C137 
				, NVL(YETA_STD_C138	 ,0) AS YETA_STD_C138 
				, NVL(YETA_STD_C139	 ,0) AS YETA_STD_C139 
				, NVL(YETA_STD_C140	 ,0) AS YETA_STD_C140 
				, NVL(YETA_STD_C141	 ,0) AS YETA_STD_C141 
				, NVL(YETA_STD_C142	 ,0) AS YETA_STD_C142 
				, NVL(YETA_STD_C143	 ,0) AS YETA_STD_C143 
				, NVL(YETA_STD_C144	 ,0) AS YETA_STD_C144 
				, NVL(YETA_STD_C145	 ,0) AS YETA_STD_C145 
				, NVL(YETA_STD_C146	 ,0) AS YETA_STD_C146 
				, NVL(YETA_STD_C147	 ,0) AS YETA_STD_C147 
				, NVL(YETA_STD_C148	 ,0) AS YETA_STD_C148 
				, NVL(YETA_STD_C149	 ,0) AS YETA_STD_C149 
				, NVL(YETA_STD_C150	 ,0) AS YETA_STD_C150 
				, NVL(YETA_STD_C150A ,0) AS YETA_STD_C150A
				, NVL(YETA_STD_C150B ,0) AS YETA_STD_C150B
				, NVL(YETA_STD_C151	 ,0) AS YETA_STD_C151 
				, NVL(YETA_STD_C152	 ,0) AS YETA_STD_C152 
				, NVL(YETA_STD_C153	 ,0) AS YETA_STD_C153 
				, NVL(YETA_STD_C154	 ,0) AS YETA_STD_C154 
				, NVL(YETA_STD_C155	 ,0) AS YETA_STD_C155 
				, NVL(YETA_STD_C156	 ,0) AS YETA_STD_C156 
				, NVL(YETA_STD_C157	 ,0) AS YETA_STD_C157 
				, NVL(YETA_STD_C158	 ,0) AS YETA_STD_C158 
				, NVL(YETA_STD_C159	 ,0) AS YETA_STD_C159 
				, NVL(YETA_STD_C160	 ,0) AS YETA_STD_C160 
				, NVL(YETA_STD_C161	 ,0) AS YETA_STD_C161 
				, NVL(YETA_STD_C162	 ,0) AS YETA_STD_C162 
				, NVL(YETA_STD_C163	 ,0) AS YETA_STD_C163 
				, NVL(YETA_STD_C164	 ,0) AS YETA_STD_C164 
				, NVL(YETA_STD_C165	 ,0) AS YETA_STD_C165 
				, NVL(YETA_STD_C166	 ,0) AS YETA_STD_C166 
				, NVL(YETA_STD_C167	 ,0) AS YETA_STD_C167 
				, NVL(YETA_STD_C168	 ,0) AS YETA_STD_C168 
				, NVL(YETA_STD_C169	 ,0) AS YETA_STD_C169 
				, NVL(YETA_STD_C170	 ,0) AS YETA_STD_C170  
				, KYBDR
				, INPT_DT
				, INPT_ADDR
				, ISMT
				, REVN_DT
				, REVN_ADDR
			FROM YE169010A
		  WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</select>	
	
	  <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_2002_Update">
		<![CDATA[
			         
				UPDATE  YE169010                    
				SET   
				  YETA_0C98=#yeta0c98#   
				, YETA_0C99=#yeta0c99#
				, YETA_C100=#yetaC100#
				, YETA_C101=#yetaC101#
				, YETA_C102=#yetaC102# 
				, YETA_C103=#yetaC103#
				, YETA_C104=#yetaC104#
				, YETA_C105=#yetaC105# 
				, YETA_C107=#yetaC107#
				, YETA_C108=#yetaC108#
				, YETA_C109=#yetaC109# 
				, YETA_C109Y=#yetaC109y# 
                 WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</update>
	
	  
	  	  <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010a_Tax_2022_2002_Update">
		<![CDATA[
			         
				UPDATE  YE169010A                    
				SET   
				  YETA_STD_0C98=#yetaStd0c98#   
				, YETA_STD_0C99=#yetaStd0c99#
				, YETA_STD_C100=#yetaStdC100#
				, YETA_STD_C101=#yetaStdC101#
				, YETA_STD_C102=#yetaStdC102# 
				, YETA_STD_C103=#yetaStdC103#
				, YETA_STD_C104=#yetaStdC104#
				, YETA_STD_C105=#yetaStdC105# 
				, YETA_STD_C107=#yetaStdC107#
				, YETA_STD_C108=#yetaStdC108#
				, YETA_STD_C109=#yetaStdC109# 
				, YETA_STD_C109Y=#yetaStdC109y# 
                 WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</update>
	
		  	  <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE161020_Tax_2022_C152_STD_TX_DDC_YN_Update">
		<![CDATA[
			         
				UPDATE  YE161020                
				SET   
				  C152_STD_TX_DDC_YN=#c152StdTxDdcYn#
			 
                 WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</update>
	  	  
	  
 
	  <!-- 표준공제로 데이타 복제  -->
	  
	  	<delete id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010a_Tax_2022_52_Delete">
		<![CDATA[
			DELETE FROM YE169010A 
						WHERE DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
								AND SYSTEMKEY=#systemkey#
				]]>
	</delete>
	  
	    <insert id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010a_Tax_2022_52_Insert">
		<![CDATA[
		INSERT INTO  YE169010A (
   DPOB_CD, YRTX_BLGG_YR, CLUT_SEPT_CD, 
   SYSTEMKEY, YETA_STD_0C63, YETA_STD_0C64, 
   YETA_STD_0C65, YETA_STD_0C66, YETA_STD_0C67, 
   YETA_STD_0C68, YETA_STD_0C69, YETA_STD_0C70, 
   YETA_STD_0C71, YETA_STD_0C72, YETA_STD_0C73, 
   YETA_STD_0C74, YETA_STD_0C75, YETA_STD_0C76, 
   YETA_STD_0C77, YETA_STD_0C78, YETA_STD_0C79, 
   YETA_STD_0C80, YETA_STD_0C81, YETA_STD_0C82, 
   YETA_STD_0C83, YETA_STD_0C84, YETA_STD_0C85, 
   YETA_STD_0C86, YETA_STD_0C87, YETA_STD_0C88, 
   YETA_STD_0C89, YETA_STD_0C90, YETA_STD_0C91, 
   YETA_STD_0C92, YETA_STD_0C93, YETA_STD_0C94, 
   YETA_STD_0C96, YETA_STD_0C97, YETA_STD_0C98, 
   YETA_STD_0C99, YETA_STD_C100, YETA_STD_C101, 
   YETA_STD_C102, YETA_STD_C103, YETA_STD_C104, 
   YETA_STD_C105, YETA_STD_C107, YETA_STD_C108, 
   YETA_STD_C109, YETA_STD_C109Y, YETA_STD_C110, YETA_STD_C111, 
   YETA_STD_C112, YETA_STD_C113, YETA_STD_C114, 
   YETA_STD_C115, YETA_STD_C116, YETA_STD_C117, 
   YETA_STD_C119, YETA_STD_C120, YETA_STD_C121, 
   YETA_STD_C122, YETA_STD_C123, YETA_STD_C124, 
   YETA_STD_C125, YETA_STD_C126, YETA_STD_C127, 
   YETA_STD_C128, YETA_STD_C129, YETA_STD_C130, 
   YETA_STD_C131, YETA_STD_C132, YETA_STD_C13A, YETA_STD_C13B, YETA_STD_C133, 
   YETA_STD_C134, YETA_STD_C135, YETA_STD_C136, 
   YETA_STD_C137, YETA_STD_C138, YETA_STD_C139, 
   YETA_STD_C140, YETA_STD_C141, YETA_STD_C142, 
   YETA_STD_C143, YETA_STD_C144, YETA_STD_C145, 
   YETA_STD_C146, YETA_STD_C147, YETA_STD_C148, 
   YETA_STD_C149, YETA_STD_C150, YETA_STD_C150A, 
   YETA_STD_C150B, YETA_STD_C151, YETA_STD_C152, 
   YETA_STD_C153, YETA_STD_C154, YETA_STD_C155, 
   YETA_STD_C156, YETA_STD_C157, YETA_STD_C158, 
   YETA_STD_C159, YETA_STD_C160, YETA_STD_C161, 
   YETA_STD_C162, YETA_STD_C163, YETA_STD_C164, 
   YETA_STD_C165, YETA_STD_C166, YETA_STD_C167, 
   YETA_STD_C168, YETA_STD_C169, YETA_STD_C170, 
  DCSN_ITAX, DCSN_BTAX, FAFV_TAXI,
   KYBDR, INPT_DT, INPT_ADDR, 
   ISMT, REVN_DT, REVN_ADDR
   ) 
( SELECT 
				DPOB_CD, YRTX_BLGG_YR, CLUT_SEPT_CD, 
				   SYSTEMKEY,  
				   YETA_0C63, YETA_0C64, YETA_0C65, 
				   YETA_0C66, YETA_0C67, YETA_0C68, 
				   YETA_0C69, YETA_0C70, YETA_0C71, 
				   YETA_0C72, YETA_0C73, YETA_0C74, 
				   YETA_0C75, YETA_0C76, YETA_0C77, 
				   YETA_0C78, YETA_0C79, YETA_0C80, 
				   YETA_0C81, YETA_0C82, YETA_0C83, 
				   YETA_0C84, YETA_0C85, YETA_0C86, 
				   YETA_0C87, YETA_0C88, YETA_0C89, 
				   YETA_0C90, YETA_0C91, YETA_0C92, 
				   YETA_0C93, YETA_0C94, YETA_0C96, 
				   YETA_0C97, YETA_0C98, YETA_0C99, 
				   YETA_C100, YETA_C101, YETA_C102, 
				   YETA_C103, YETA_C104, YETA_C105, 
				   YETA_C107, YETA_C108, YETA_C109, YETA_C109Y, 
				   YETA_C110, YETA_C111, YETA_C112, 
				   YETA_C113, YETA_C114, YETA_C115, 
				   YETA_C116, YETA_C117, YETA_C119, 
				   YETA_C120, YETA_C121, YETA_C122, 
				   YETA_C123, YETA_C124, YETA_C125, 
				   YETA_C126, YETA_C127, YETA_C128, 
				   YETA_C129, YETA_C130, YETA_C131, 
				   YETA_C132, YETA_C13A, YETA_C13B, YETA_C133, YETA_C134, 
				   YETA_C135, YETA_C136, YETA_C137, 
				   YETA_C138, YETA_C139, YETA_C140, 
				   YETA_C141, YETA_C142, YETA_C143, 
				   YETA_C144, YETA_C145, YETA_C146, 
				   YETA_C147, YETA_C148, YETA_C149, 
				   YETA_C150, YETA_C150A, YETA_C150B, 
				   YETA_C151, YETA_C152, YETA_C153, 
				   YETA_C154, YETA_C155, YETA_C156, 
				   YETA_C157, YETA_C158, YETA_C159, 
				   YETA_C160, YETA_C161, YETA_C162, 
				   YETA_C163, YETA_C164, YETA_C165, 
				   YETA_C166, YETA_C167, YETA_C168, 
				   YETA_C169, YETA_C170, DCSN_ITAX, 
				   DCSN_BTAX, FAFV_TAXI, KYBDR, 
				   INPT_DT, INPT_ADDR, ISMT, 
				   REVN_DT, REVN_ADDR 
				FROM  YE169010                                           
			  WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#	
				     ) 
		]]>
	</insert>
	  
	 <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010a_Tax_2022_52_Update">
		<![CDATA[
			         
			         
				UPDATE  YE169010a                    
				SET  YETA_STD_0C81=#yetaStd0c81#
				, YETA_STD_0C82=#yetaStd0c82#
				, YETA_STD_C133=#yetaStdC133#
				, YETA_STD_C134=#yetaStdC134#
				, YETA_STD_C135=#yetaStdC135#
				, YETA_STD_C136=#yetaStdC136#
				, YETA_STD_C137=#yetaStdC137#
				, YETA_STD_C138=#yetaStdC138#
				, YETA_STD_C139=#yetaStdC139#
				, YETA_STD_C140=#yetaStdC140#
				, YETA_STD_0C83=#yetaStd0c83#
				, YETA_STD_0C84=#yetaStd0c84#
				, YETA_STD_C156=#yetaStdC156#
				, YETA_STD_C157=#yetaStdC157#
				, YETA_STD_0C85=#yetaStd0c85#
				, YETA_STD_0C86=#yetaStd0c86#
				, YETA_STD_0C87=#yetaStd0c87#
				, YETA_STD_0C88=#yetaStd0c88#
				, YETA_STD_0C89=#yetaStd0c89#
				, YETA_STD_0C90=#yetaStd0c90#
				, YETA_STD_0C91=#yetaStd0c91#
				, YETA_STD_0C92=#yetaStd0c92#
				, YETA_STD_0C93=#yetaStd0c93#
				, YETA_STD_0C94=#yetaStd0c94#
				, YETA_STD_0C96=#yetaStd0c96#
				, YETA_STD_C145=#yetaStdC145#
				, YETA_STD_C146=#yetaStdC146#
			    , YETA_STD_C149=#yetaStdC149#
				, YETA_STD_C150=#yetaStdC150#
				, YETA_STD_C150A=#yetaStdC150a#
				, YETA_STD_C150B=#yetaStdC150b#  
                 WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</update>	
	
 <!-- 업데이트 작업 추가   -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_2003_Select">
		<![CDATA[
			            UPDATE YE169010                                                                                                                                                                         
                            SET 
                          		 YETA_0C66=#yeta0c66#
								, YETA_0C67=#yeta0c67# 
								, YETA_0C69=#yeta0c69# 
								, YETA_0C71=#yeta0c71# 
								, YETA_0C73=#yeta0c73#
								, YETA_0C74=#yeta0c74#
								, YETA_0C75=#yeta0c75# 
                          		  , YETA_0C76=#yeta0c76#
								, YETA_0C77=#yeta0c77#
								, YETA_0C78=#yeta0c78#
								, YETA_0C79=#yeta0c79#
								, YETA_0C80=#yeta0c80#
				                 , YETA_0C81=#yeta0c81#
								, YETA_0C82=#yeta0c82#
								, YETA_0C83=#yeta0c83#
								, YETA_0C84=#yeta0c84#      
				   				, YETA_0C85=#yeta0c85#
								, YETA_0C86=#yeta0c86#
								, YETA_0C87=#yeta0c87#
								, YETA_0C88=#yeta0c88#
								, YETA_0C89=#yeta0c89#
								, YETA_0C90=#yeta0c90#
								, YETA_0C91=#yeta0c91#
								, YETA_0C92=#yeta0c92#
								, YETA_0C93=#yeta0c93#
								, YETA_0C94=#yeta0c94# 
 						 WHERE DPOB_CD=#dpobCd#
                                AND YRTX_BLGG_YR=#yrtxBlggYr#
                                AND CLUT_SEPT_CD=#clutSeptCd#
                                 AND SYSTEMKEY=#systemkey#	  
				]]>
	</update>	
	

	<!--  통합으로 인해 사용안함. -->
	  <update id="infcPkgYeta17Tax_2022_DAO.yeta2000_ReTax_2016_DCSN_INCM_Update">
		<![CDATA[
			         
				UPDATE  YE161020                    
				SET                              
			      SPCI_RTTG=#spciRttg#
			      , SPCI_HDTG=#spciHdtg#
			      , SPCI_DETG=#spciDetg#
			      , YETA_C137=#spciDtar#
			      , SPED_ETAR=#spedEtar#
			      , SPCI_FBTG=#spciFbtg#
			      , SPCI_NATG=#spciNatg#
				  , SPCI_YATG=#spciYatg#  
			      , SPCI_FB15=#spciFb14#
			      , SPCI_NA15=#spciNa14#
				  , SPCI_YA15=#spciYa14#  
				  
				   ,SPCI_DGTG = #spciDgtg#  
					 ,SPED_SFTR = #spedSftr#  
					 ,SPED_EDTR = #spedEdtr#  
					 ,SPED_GDTR = #spedGdtr#  
					 ,SPED_CVTR = #spedCvtr#  
				  
				   
                 WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</update>	
	
  <!-- 특별공제 종합한도초과액   기타공제계  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_3001_Update">
		<![CDATA[
			  UPDATE YE169010                                                                                                                                                         
                          SET                                            
                              /* SPCH_EXLI IS 특별공제한도초과액  */                                                                                                             
                             YETA_C111 = CASE WHEN ((   NVL(YETA_0C83,0) + NVL (YETA_0C84,0)
										+ NVL(YETA_0C85,0) + NVL(YETA_0C86,0)
										+ NVL(YETA_0C87,0) + NVL(YETA_0C88,0)
										+ NVL(YETA_0C89,0) + NVL(YETA_0C90,0)
										+ NVL(YETA_0C91,0) + NVL(YETA_0C92,0) + NVL(YETA_0C93,0) + NVL (YETA_0C99, 0)
                                                 + (  (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                    + (  NVL (YETA_C103, 0) - (SELECT (NVL(CPIV20_VNT_DDC_AMT,0) +  NVL(CPIV21_VNT_DDC_AMT,0) + NVL(CPIV22_VNT_DDC_AMT,0))
																				 FROM YE161070 WHERE DPOB_CD=#dpobCd#
																							   AND YRTX_BLGG_YR=#yrtxBlggYr#
																							   AND CLUT_SEPT_CD=#clutSeptCd#
																							   AND SYSTEMKEY=#systemkey#)))
                                                 + NVL (YETA_C104, 0)
                                                 + NVL (YETA_C105, 0)
                                                 + NVL (YETA_C109, 0)
                                                 + NVL (YETA_C109Y, 0))
                                              - 25000000)   <= 0     
                     THEN  0 ELSE ((   NVL(YETA_0C83,0) + NVL (YETA_0C84,0)
										+ NVL(YETA_0C85,0) + NVL(YETA_0C86,0)
										+ NVL(YETA_0C87,0) + NVL(YETA_0C88,0)
										+ NVL(YETA_0C89,0) + NVL(YETA_0C90,0)
										+ NVL(YETA_0C91,0) + NVL(YETA_0C92,0) + NVL(YETA_0C93,0) + NVL (YETA_0C99, 0)
                                                 + (  (YETA_C100 +  YETA_C101 +  YETA_C102 ) 
                                                     + (  NVL (YETA_C103, 0) - (SELECT (NVL(CPIV20_VNT_DDC_AMT,0) +  NVL(CPIV21_VNT_DDC_AMT,0) + NVL(CPIV22_VNT_DDC_AMT,0))
																				 FROM YE161070 WHERE DPOB_CD=#dpobCd#
																							   AND YRTX_BLGG_YR=#yrtxBlggYr#
																							   AND CLUT_SEPT_CD=#clutSeptCd#
																							   AND SYSTEMKEY=#systemkey#)))
                                                 + NVL (YETA_C104, 0)
                                                 + NVL (YETA_C105, 0)
                                                 + NVL (YETA_C109, 0)
                                                 + NVL (YETA_C109Y, 0))  - 25000000)  END 
                     WHERE DPOB_CD=#dpobCd#
                       AND YRTX_BLGG_YR=#yrtxBlggYr#
                       AND CLUT_SEPT_CD=#clutSeptCd#
                       AND SYSTEMKEY=#systemkey#	                      
				]]>
	</update>	
	
	   
	    <!-- 특별공제 종합한도초과액   기타공제계  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010a_Tax_2022_3001_Update">
		<![CDATA[
			  UPDATE YE169010A                                                                                                                                                         
                          SET                                            
                              /* SPCH_EXLI IS 특별공제한도초과액  */                                                                                                             
                             YETA_STD_C111 = CASE WHEN ((   NVL(YETA_STD_0C83,0) + NVL (YETA_STD_0C84,0)
										+ NVL(YETA_STD_0C85,0) + NVL(YETA_STD_0C86,0)
										+ NVL(YETA_STD_0C87,0) + NVL(YETA_STD_0C88,0)
										+ NVL(YETA_STD_0C89,0) + NVL(YETA_STD_0C90,0)
										+ NVL(YETA_STD_0C91,0) + NVL(YETA_STD_0C92,0) + NVL(YETA_STD_0C93,0) + NVL (YETA_STD_0C99, 0)
                                                 + (  (YETA_STD_C100 +  YETA_STD_C101 +  YETA_STD_C102 ) 
                                                     + (  NVL (YETA_STD_C103, 0) - (SELECT (NVL(CPIV20_VNT_DDC_AMT,0) +  NVL(CPIV21_VNT_DDC_AMT,0) + NVL(CPIV22_VNT_DDC_AMT,0))
																				 FROM YE161070 WHERE DPOB_CD=#dpobCd#
																							   AND YRTX_BLGG_YR=#yrtxBlggYr#
																							   AND CLUT_SEPT_CD=#clutSeptCd#
																							   AND SYSTEMKEY=#systemkey#)))
                                                 + NVL (YETA_STD_C104, 0)
                                                 + NVL (YETA_STD_C105, 0)
                                                 + NVL (YETA_STD_C109, 0)
                                                 + NVL (YETA_STD_C109Y, 0))
                                              - 25000000)   <= 0     
                     THEN  0 ELSE ((   NVL(YETA_STD_0C83,0) + NVL (YETA_STD_0C84,0)
										+ NVL(YETA_STD_0C85,0) + NVL(YETA_STD_0C86,0)
										+ NVL(YETA_STD_0C87,0) + NVL(YETA_STD_0C88,0)
										+ NVL(YETA_STD_0C89,0) + NVL(YETA_STD_0C90,0)
										+ NVL(YETA_STD_0C91,0) + NVL(YETA_STD_0C92,0) + NVL(YETA_STD_0C93,0) + NVL (YETA_STD_0C99, 0)
                                                 + (  (YETA_STD_C100 +  YETA_STD_C101 +  YETA_STD_C102 ) 
                                                     + (  NVL (YETA_STD_C103, 0) - (SELECT (NVL(CPIV20_VNT_DDC_AMT,0) +  NVL(CPIV21_VNT_DDC_AMT,0) + NVL(CPIV22_VNT_DDC_AMT,0))
																				 FROM YE161070 WHERE DPOB_CD=#dpobCd#
																							   AND YRTX_BLGG_YR=#yrtxBlggYr#
																							   AND CLUT_SEPT_CD=#clutSeptCd#
																							   AND SYSTEMKEY=#systemkey#)))
                                                 + NVL (YETA_STD_C104, 0)
                                                 + NVL (YETA_STD_C105, 0)
                                                 + NVL (YETA_STD_C109, 0)
                                                 + NVL (YETA_STD_C109Y, 0))  - 25000000)  END 
                     WHERE DPOB_CD=#dpobCd#
                       AND YRTX_BLGG_YR=#yrtxBlggYr#
                       AND CLUT_SEPT_CD=#clutSeptCd#
                       AND SYSTEMKEY=#systemkey#	                      
				]]>
	</update>
	 
	   <!--  종합소득과세표준  기타공제계  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_3002_Update">
		<![CDATA[
			  UPDATE YE169010                                                                                                                                                         
                          SET                                            
                          /* STND_INCM IS '종합소득과세표준      */                                                                                                              
                           YETA_C112 =  (CASE WHEN    (YETA_0C97 - YETA_C110 + NVL(YETA_C111,0))  < 0 THEN 0                      
                                              ELSE    (YETA_0C97 - YETA_C110 + NVL(YETA_C111,0))  END)  
                   WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#	                           
				]]>
	</update>
	
	   
	      <!--  종합소득과세표준  기타공제계  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010a_Tax_2022_3002_Update">
		<![CDATA[
			  UPDATE YE169010A                                                                                                                                                        
                          SET                                            
                          /* STND_INCM IS '종합소득과세표준      */                                                                                                              
                           YETA_STD_C112 =  (CASE WHEN    (YETA_STD_0C97 - YETA_STD_C110 + NVL(YETA_STD_C111,0))  < 0 THEN 0                      
                                              ELSE    (YETA_STD_0C97 - YETA_STD_C110 + NVL(YETA_STD_C111,0))  END)  
                   WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#	                           
				]]>
	</update>
	
	
	   <!--  산출세액- 기타공제계  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_3003_Update">
		<![CDATA[
			   UPDATE YE169010                                                                                                                                                         
                          SET                                            
                         /* YETA_C113 PRDD_TAXN IS '산출세액 */                                                                                                                           
				         YETA_C113 =  (CASE WHEN YETA_00C9 = '1' AND (SELECT  NNF_CL_CD 
				                                                    FROM  YE161020
				                                                    WHERE    YE161020.DPOB_CD = YE169010.DPOB_CD 
																	     AND YE161020.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR 
																	     AND YE161020.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD 
																	     AND YE161020.SYSTEMKEY = YE169010.SYSTEMKEY ) = '9' THEN
				                         (
				                             TRUNC(YETA_0C63 * 0.19)
				                         )                           
				                       ELSE 
						                       (CASE WHEN    
						                             TRUNC(                                                                                                                           
						                                      CASE WHEN  YETA_C112 <= 12000000  THEN  (YETA_C112 * 0.06 )                              
						                                           WHEN  YETA_C112 <= 46000000  THEN  ((YETA_C112 * 0.15) - 1080000)    
						                                           WHEN  YETA_C112 <= 88000000  THEN  (( YETA_C112  * 0.24) - 5220000 )      
						                                           WHEN  YETA_C112 <= 150000000 THEN  (( YETA_C112 * 0.35) - 14900000 ) 
						                                           WHEN  YETA_C112 <= 500000000 THEN  (( YETA_C112 * 0.38) - 19400000 )       
						                                      ELSE   (( YETA_C112 * 0.40) - 29400000 )  END)  < 0    
						                      THEN 0                                                                                          
						                      ELSE                                                                              
						                              TRUNC(                                                                                                                                  
						                                        CASE WHEN  YETA_C112 <= 12000000  THEN  (YETA_C112 * 0.06 )                              
						                                           WHEN  YETA_C112 <= 46000000  THEN  ((YETA_C112 * 0.15) - 1080000)    
						                                           WHEN  YETA_C112 <= 88000000  THEN  (( YETA_C112  * 0.24) - 5220000 )      
						                                           WHEN  YETA_C112 <= 150000000 THEN  (( YETA_C112 * 0.35) - 14900000 )    
						                                          WHEN  YETA_C112 <= 500000000 THEN  (( YETA_C112 * 0.38) - 19400000 )       
						                                      ELSE   (( YETA_C112 * 0.40) - 29400000 )  END)   
						                     END)
				                   END 
                                ) 
				                      WHERE DPOB_CD=#dpobCd#
				                        AND YRTX_BLGG_YR=#yrtxBlggYr#
				                        AND CLUT_SEPT_CD=#clutSeptCd#
				                         AND SYSTEMKEY=#systemkey#	 
				]]>
	</update>   
	   
	   
	    <!--  산출세액- 기타공제계  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010a_Tax_2022_3003_Update">
		<![CDATA[
			   UPDATE YE169010A                                                                                                                                                         
                          SET                                            
                         /* YETA_C113 PRDD_TAXN IS '산출세액 */                                                                                                                           
				         YETA_STD_C113 =  (CASE WHEN  (SELECT  YE169010.YETA_00C9 
				                                                    FROM  YE169010
				                                                    WHERE    YE169010.DPOB_CD = YE169010A.DPOB_CD 
																	     AND YE169010.YRTX_BLGG_YR = YE169010A.YRTX_BLGG_YR 
																	     AND YE169010.CLUT_SEPT_CD = YE169010A.CLUT_SEPT_CD 
																	     AND YE169010.SYSTEMKEY = YE169010A.SYSTEMKEY )  = '1' AND (SELECT  NNF_CL_CD 
				                                                    FROM  YE161020
				                                                    WHERE    YE161020.DPOB_CD = YE169010A.DPOB_CD 
																	     AND YE161020.YRTX_BLGG_YR = YE169010A.YRTX_BLGG_YR 
																	     AND YE161020.CLUT_SEPT_CD = YE169010A.CLUT_SEPT_CD 
																	     AND YE161020.SYSTEMKEY = YE169010A.SYSTEMKEY ) = '9' THEN
				                         (
				                             TRUNC(YETA_STD_0C63 * 0.19)
				                         )                           
				                       ELSE 
						                       (CASE WHEN    
						                             TRUNC(                                                                                                                           
						                                      CASE WHEN  YETA_STD_C112 <= 12000000  THEN  (YETA_STD_C112 * 0.06 )                              
						                                           WHEN  YETA_STD_C112 <= 46000000  THEN  ((YETA_STD_C112 * 0.15) - 1080000)    
						                                           WHEN  YETA_STD_C112 <= 88000000  THEN  (( YETA_STD_C112  * 0.24) - 5220000 )      
						                                           WHEN  YETA_STD_C112 <= 150000000 THEN  (( YETA_STD_C112 * 0.35) - 14900000 ) 
						                                           WHEN  YETA_STD_C112 <= 500000000 THEN  (( YETA_STD_C112 * 0.38) - 19400000 )       
						                                      ELSE   (( YETA_STD_C112 * 0.40) - 29400000 )  END)  < 0    
						                      THEN 0                                                                                          
						                      ELSE                                                                              
						                              TRUNC(                                                                                                                                  
						                                        CASE WHEN  YETA_STD_C112 <= 12000000  THEN  (YETA_STD_C112 * 0.06 )                              
						                                           WHEN  YETA_STD_C112 <= 46000000  THEN  ((YETA_STD_C112 * 0.15) - 1080000)    
						                                           WHEN  YETA_STD_C112 <= 88000000  THEN  (( YETA_STD_C112  * 0.24) - 5220000 )      
						                                           WHEN  YETA_STD_C112 <= 150000000 THEN  (( YETA_STD_C112 * 0.35) - 14900000 )    
						                                          WHEN  YETA_STD_C112 <= 500000000 THEN  (( YETA_STD_C112 * 0.38) - 19400000 )       
						                                      ELSE   (( YETA_STD_C112 * 0.40) - 29400000 )  END)   
						                     END)
				                   END 
                                ) 
				                      WHERE DPOB_CD=#dpobCd#
				                        AND YRTX_BLGG_YR=#yrtxBlggYr#
				                        AND CLUT_SEPT_CD=#clutSeptCd#
				                         AND SYSTEMKEY=#systemkey#	 
				]]>
	</update>  
	

	   <!--  산출세액-세액감면  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_3004_Update">
		<![CDATA[
		   UPDATE YE169010                                                                                                                                                         
                   SET                                        
                         /* TXLG_ITCT_AMNT   TAXD_ICAX IS '소득세법  */                                                                                                                          
         YETA_C114 = (SELECT (CASE WHEN (AD01.TXLG_ITCT_AMNT > 0) AND (YE169010.YETA_C113 < AD01.TXLG_ITCT_AMNT)  
                      THEN YE169010.YETA_C113                                                                                          
                      ELSE AD01.TXLG_ITCT_AMNT                                                                           
                        END)   
                FROM YE161080 AD01                                                         
          WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                 
            AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                  
            AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
             AND AD01.DPOB_CD  = YE169010.DPOB_CD   ) ,            
                                
         /* TAXD_SPCT IS '외국인조세조약 -이건나중에 다시 적용   */                                                                                                                         
         YETA_C115 =  ( SELECT (CASE WHEN YE161020.NNF_CL_CD = '1' THEN 0
                                    ELSE (CASE WHEN (nvl(YE169010.YETA_C54_T01,0) + nvl(YE160405.TAXM_ST01_JONG,0)) <= 0 THEN 0 ELSE 
                                               (CASE WHEN YE169010.YETA_C113 < (YE169010.YETA_C113 * (((nvl(YE169010.YETA_C54_T01,0) + nvl(YE160405.TAXM_ST01_JONG,0))/YE169010.YETA_0C63) *0.5)) THEN 0
                                                     ELSE (YE169010.YETA_C113 * (((nvl(YE169010.YETA_C54_T01,0) + nvl(YE160405.TAXM_ST01_JONG,0))/YE169010.YETA_0C63) *0.5)) 
                                                     END) 
                                              END)  
                                    END)              
                        FROM YE161020 ,(SELECT SYSTEMKEY,YRTX_BLGG_YR,CLUT_SEPT_CD,DPOB_CD, SUM(NVL(TAXM_ST01_JONG,0)) AS TAXM_ST01_JONG 
                                 FROM YE160405  
                                 GROUP BY SYSTEMKEY,YRTX_BLGG_YR,CLUT_SEPT_CD,DPOB_CD )   YE160405                                                       
          WHERE YE161020.SYSTEMKEY = YE169010.SYSTEMKEY                                 
            AND YE161020.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                  
            AND YE161020.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
             AND YE161020.DPOB_CD  = YE169010.DPOB_CD 
             AND  YE160405.SYSTEMKEY(+) = YE169010.SYSTEMKEY                                 
            AND YE160405.YRTX_BLGG_YR(+) = YE169010.YRTX_BLGG_YR                                  
            AND YE160405.CLUT_SEPT_CD(+) = YE169010.CLUT_SEPT_CD
             AND YE160405.DPOB_CD(+)  = YE169010.DPOB_CD   ) ,   
                                         
                       /* TXLG_CL30 IS '조세특례법제30조 */                                                                                                                           
         YETA_C116 = (SELECT ( CASE WHEN ((NVL(AD01.YETA_C58_T10,0) + NVL(YETA3300.TAXM_ST10,0))
                                               + ((NVL(AD01.YETA_C58A_T11,0) + NVL(YETA3300.TAXM_ST11,0))) + ((NVL(AD01.YETA_C58B_T12,0) + NVL(YETA3300.TAXM_ST12,0)))) <= 0 THEN 0 ELSE 
                                               (CASE WHEN YE169010.YETA_C113 < 
                                                          ((YE169010.YETA_C113 * (((NVL(AD01.YETA_C58_T10,0) + NVL(YETA3300.TAXM_ST10,0))/YE169010.YETA_0C63) * 1))
                                                           + (YE169010.YETA_C113 * (((NVL(AD01.YETA_C58A_T11,0) + NVL(YETA3300.TAXM_ST11,0))/YE169010.YETA_0C63) * 0.5))
                                                            + (CASE WHEN (YE169010.YETA_C113 * (((NVL(AD01.YETA_C58B_T12,0) + NVL(YETA3300.TAXM_ST12,0))/YE169010.YETA_0C63) * 0.7)) >= 1500000 
                                                                    THEN 1500000
                                                                    ELSE (YE169010.YETA_C113 * (((NVL(AD01.YETA_C58B_T12,0) + NVL(YETA3300.TAXM_ST12,0))/YE169010.YETA_0C63) * 0.7)) END)) 
                                                             THEN 0
                                                     ELSE ((YE169010.YETA_C113 * (((NVL(AD01.YETA_C58_T10,0) + NVL(YETA3300.TAXM_ST10,0))/YE169010.YETA_0C63) * 1))
                                                           + (YE169010.YETA_C113 * (((NVL(AD01.YETA_C58A_T11,0) + NVL(YETA3300.TAXM_ST11,0))/YE169010.YETA_0C63) * 0.5))
                                                            + (CASE WHEN (YE169010.YETA_C113 * (((NVL(AD01.YETA_C58B_T12,0) + NVL(YETA3300.TAXM_ST12,0))/YE169010.YETA_0C63) * 0.7)) >= 1500000 
                                                                    THEN 1500000
                                                                    ELSE (YE169010.YETA_C113 * (((NVL(AD01.YETA_C58B_T12,0) + NVL(YETA3300.TAXM_ST12,0))/YE169010.YETA_0C63) * 0.7)) END))
                                                     END) 
                                              END)  
                FROM YE169010 AD01  ,(SELECT SYSTEMKEY,YRTX_BLGG_YR,CLUT_SEPT_CD,DPOB_CD, SUM(NVL(TAXM_ST10_JONG,0)) AS TAXM_ST10 , SUM(NVL(TAXM_ST11_JONG,0)) AS TAXM_ST11, SUM(NVL(TAXM_ST12_JONG,0)) AS TAXM_ST12
                                 FROM YE160405  
                                 GROUP BY SYSTEMKEY,YRTX_BLGG_YR,CLUT_SEPT_CD,DPOB_CD )   YETA3300                                                       
          WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                 
            AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                  
            AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
             AND AD01.DPOB_CD  = YE169010.DPOB_CD 
             AND  YETA3300.SYSTEMKEY(+) = YE169010.SYSTEMKEY                                 
            AND YETA3300.YRTX_BLGG_YR(+) = YE169010.YRTX_BLGG_YR                                  
            AND YETA3300.CLUT_SEPT_CD(+) = YE169010.CLUT_SEPT_CD
             AND YETA3300.DPOB_CD(+)  = YE169010.DPOB_CD   ) ,                               

          /* TXLG_HXTT IS '조세조약  */                                                                                                                          
         YETA_C117 = (SELECT (CASE WHEN YE161020.NNF_CL_CD = '1' THEN 0
                                    ELSE (CASE WHEN (nvl(YE169010.YETA_C59_T20,0) + nvl(YE160405.TAXM_ST20,0)) <= 0 THEN 0 ELSE 
                                               (CASE WHEN YE169010.YETA_C113 < (YE169010.YETA_C113 * (((nvl(YE169010.YETA_C59_T20,0) + nvl(YE160405.TAXM_ST20,0))/YE169010.YETA_0C63) * 1)) THEN 0
                                                     ELSE (YE169010.YETA_C113 * (((nvl(YE169010.YETA_C59_T20,0) + nvl(YE160405.TAXM_ST20,0))/YE169010.YETA_0C63) * 1)) 
                                                     END) 
                                              END)  
                                    END)  
                FROM YE161020 ,(SELECT SYSTEMKEY,YRTX_BLGG_YR,CLUT_SEPT_CD,DPOB_CD, SUM(NVL(TAXM_ST20_JONG,0)) AS TAXM_ST20 
                                 FROM YE160405  
                                 GROUP BY SYSTEMKEY,YRTX_BLGG_YR,CLUT_SEPT_CD,DPOB_CD )   YE160405                                                       
          WHERE YE161020.SYSTEMKEY = YE169010.SYSTEMKEY                                 
            AND YE161020.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                  
            AND YE161020.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD
             AND YE161020.DPOB_CD  = YE169010.DPOB_CD 
             AND  YE160405.SYSTEMKEY(+) = YE169010.SYSTEMKEY                                 
            AND YE160405.YRTX_BLGG_YR(+) = YE169010.YRTX_BLGG_YR                                  
            AND YE160405.CLUT_SEPT_CD(+) = YE169010.CLUT_SEPT_CD
             AND YE160405.DPOB_CD(+)  = YE169010.DPOB_CD   )                               
			   WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#	 
				]]>
	</update>	   
	   
	  <!--  산출세액-세액감면  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010a_Tax_2022_3004_Update">
		<![CDATA[
		   UPDATE YE169010A                                                                                                                                                         
                   SET                                        
                         /* TXLG_ITCT_AMNT   TAXD_ICAX IS '소득세법  */                                                                                                                          
         YETA_STD_C114 = (SELECT (CASE WHEN (AD01.TXLG_ITCT_AMNT > 0) AND (YE169010A.YETA_STD_C113 < AD01.TXLG_ITCT_AMNT)  
                      THEN YE169010A.YETA_STD_C113                                                                                          
                      ELSE AD01.TXLG_ITCT_AMNT                                                                           
                        END)   
                FROM YE161080 AD01                                                         
          WHERE AD01.SYSTEMKEY = YE169010A.SYSTEMKEY                                 
            AND AD01.YRTX_BLGG_YR = YE169010A.YRTX_BLGG_YR                                  
            AND AD01.CLUT_SEPT_CD = YE169010A.CLUT_SEPT_CD
             AND AD01.DPOB_CD  = YE169010A.DPOB_CD   ) ,            
                                
         /* TAXD_SPCT IS '외국인조세조약 -이건나중에 다시 적용   */                                                                                                                         
         YETA_STD_C115 =  ( SELECT (CASE WHEN YE161020.NNF_CL_CD = '1' THEN 0
                                    ELSE (CASE WHEN (nvl(YE169010.YETA_C54_T01,0) + nvl(YE160405.TAXM_ST01_JONG,0)) <= 0 THEN 0 ELSE 
                                               (CASE WHEN YE169010A.YETA_STD_C113 < (YE169010A.YETA_STD_C113 * (((nvl(YE169010.YETA_C54_T01,0) + nvl(YE160405.TAXM_ST01_JONG,0))/YE169010A.YETA_STD_0C63) *0.5)) THEN 0
                                                     ELSE (YE169010A.YETA_STD_C113 * (((nvl(YE169010.YETA_C54_T01,0) + nvl(YE160405.TAXM_ST01_JONG,0))/YE169010A.YETA_STD_0C63) *0.5)) 
                                                     END) 
                                              END)  
                                    END)              
                        FROM YE161020 ,(SELECT SYSTEMKEY,YRTX_BLGG_YR,CLUT_SEPT_CD,DPOB_CD, SUM(NVL(TAXM_ST01_JONG,0)) AS TAXM_ST01_JONG 
                                 FROM YE160405  
                                 GROUP BY SYSTEMKEY,YRTX_BLGG_YR,CLUT_SEPT_CD,DPOB_CD )   YE160405, YE169010                                                       
          WHERE YE161020.SYSTEMKEY = YE169010A.SYSTEMKEY                                 
            AND YE161020.YRTX_BLGG_YR = YE169010A.YRTX_BLGG_YR                                  
            AND YE161020.CLUT_SEPT_CD = YE169010A.CLUT_SEPT_CD
             AND YE161020.DPOB_CD  = YE169010A.DPOB_CD 
             AND  YE160405.SYSTEMKEY(+) = YE169010A.SYSTEMKEY                                 
            AND YE160405.YRTX_BLGG_YR(+) = YE169010A.YRTX_BLGG_YR                                  
            AND YE160405.CLUT_SEPT_CD(+) = YE169010A.CLUT_SEPT_CD
             AND YE160405.DPOB_CD(+)  = YE169010A.DPOB_CD 
              AND  YE169010.SYSTEMKEY(+) = YE169010A.SYSTEMKEY                                 
            AND YE169010.YRTX_BLGG_YR(+) = YE169010A.YRTX_BLGG_YR                                  
            AND YE169010.CLUT_SEPT_CD(+) = YE169010A.CLUT_SEPT_CD
             AND YE169010.DPOB_CD(+)  = YE169010A.DPOB_CD   ) ,   
                                         
                       /* TXLG_CL30 IS '조세특례법제30조 */                                                                                                                           
         YETA_STD_C116 = (SELECT ( CASE WHEN ((NVL(AD01.YETA_C58_T10,0) + NVL(YETA3300.TAXM_ST10,0))
                                               + ((NVL(AD01.YETA_C58A_T11,0) + NVL(YETA3300.TAXM_ST11,0))) + ((NVL(AD01.YETA_C58B_T12,0) + NVL(YETA3300.TAXM_ST12,0)))) <= 0 THEN 0 ELSE 
                                               (CASE WHEN YE169010A.YETA_STD_C113 < 
                                                          ((YE169010A.YETA_STD_C113 * (((NVL(AD01.YETA_C58_T10,0) + NVL(YETA3300.TAXM_ST10,0))/YE169010A.YETA_STD_0C63) * 1))
                                                           + (YE169010A.YETA_STD_C113 * (((NVL(AD01.YETA_C58A_T11,0) + NVL(YETA3300.TAXM_ST11,0))/YE169010A.YETA_STD_0C63) * 0.5))
                                                            + (CASE WHEN (YE169010A.YETA_STD_C113 * (((NVL(AD01.YETA_C58B_T12,0) + NVL(YETA3300.TAXM_ST12,0))/YE169010A.YETA_STD_0C63) * 0.7)) >= 1500000 
                                                                    THEN 1500000
                                                                    ELSE (YE169010A.YETA_STD_C113 * (((NVL(AD01.YETA_C58B_T12,0) + NVL(YETA3300.TAXM_ST12,0))/YE169010A.YETA_STD_0C63) * 0.7)) END)) 
                                                             THEN 0
                                                     ELSE ((YE169010A.YETA_STD_C113 * (((NVL(AD01.YETA_C58_T10,0) + NVL(YETA3300.TAXM_ST10,0))/YE169010A.YETA_STD_0C63) * 1))
                                                           + (YE169010A.YETA_STD_C113 * (((NVL(AD01.YETA_C58A_T11,0) + NVL(YETA3300.TAXM_ST11,0))/YE169010A.YETA_STD_0C63) * 0.5))
                                                            + (CASE WHEN (YE169010A.YETA_STD_C113 * (((NVL(AD01.YETA_C58B_T12,0) + NVL(YETA3300.TAXM_ST12,0))/YE169010A.YETA_STD_0C63) * 0.7)) >= 1500000 
                                                                    THEN 1500000
                                                                    ELSE (YE169010A.YETA_STD_C113 * (((NVL(AD01.YETA_C58B_T12,0) + NVL(YETA3300.TAXM_ST12,0))/YE169010A.YETA_STD_0C63) * 0.7)) END))
                                                     END) 
                                              END)  
                FROM YE169010 AD01  ,(SELECT SYSTEMKEY,YRTX_BLGG_YR,CLUT_SEPT_CD,DPOB_CD, SUM(NVL(TAXM_ST10_JONG,0)) AS TAXM_ST10 , SUM(NVL(TAXM_ST11_JONG,0)) AS TAXM_ST11, SUM(NVL(TAXM_ST12_JONG,0)) AS TAXM_ST12
                                 FROM YE160405  
                                 GROUP BY SYSTEMKEY,YRTX_BLGG_YR,CLUT_SEPT_CD,DPOB_CD )   YETA3300                                                       
          WHERE AD01.SYSTEMKEY = YE169010A.SYSTEMKEY                                 
            AND AD01.YRTX_BLGG_YR = YE169010A.YRTX_BLGG_YR                                  
            AND AD01.CLUT_SEPT_CD = YE169010A.CLUT_SEPT_CD
             AND AD01.DPOB_CD  = YE169010A.DPOB_CD 
             AND  YETA3300.SYSTEMKEY(+) = YE169010A.SYSTEMKEY                                 
            AND YETA3300.YRTX_BLGG_YR(+) = YE169010A.YRTX_BLGG_YR                                  
            AND YETA3300.CLUT_SEPT_CD(+) = YE169010A.CLUT_SEPT_CD
             AND YETA3300.DPOB_CD(+)  = YE169010A.DPOB_CD        ) ,                               

          /* TXLG_HXTT IS '조세조약  */                                                                                                                          
         YETA_STD_C117 = (SELECT (CASE WHEN YE161020.NNF_CL_CD = '1' THEN 0
                                    ELSE (CASE WHEN (nvl(YE169010.YETA_C59_T20,0) + nvl(YE160405.TAXM_ST20,0)) <= 0 THEN 0 ELSE 
                                               (CASE WHEN YE169010A.YETA_STD_C113 < (YE169010A.YETA_STD_C113 * (((nvl(YE169010.YETA_C59_T20,0) + nvl(YE160405.TAXM_ST20,0))/YE169010A.YETA_STD_0C63) * 1)) THEN 0
                                                     ELSE (YE169010A.YETA_STD_C113 * (((nvl(YE169010.YETA_C59_T20,0) + nvl(YE160405.TAXM_ST20,0))/YE169010A.YETA_STD_0C63) * 1)) 
                                                     END) 
                                              END)  
                                    END)  
                FROM YE161020 ,(SELECT SYSTEMKEY,YRTX_BLGG_YR,CLUT_SEPT_CD,DPOB_CD, SUM(NVL(TAXM_ST20_JONG,0)) AS TAXM_ST20 
                                 FROM YE160405  
                                 GROUP BY SYSTEMKEY,YRTX_BLGG_YR,CLUT_SEPT_CD,DPOB_CD )   YE160405  , YE169010                                                    
          WHERE YE161020.SYSTEMKEY = YE169010A.SYSTEMKEY                                 
            AND YE161020.YRTX_BLGG_YR = YE169010A.YRTX_BLGG_YR                                  
            AND YE161020.CLUT_SEPT_CD = YE169010A.CLUT_SEPT_CD
             AND YE161020.DPOB_CD  = YE169010A.DPOB_CD 
             AND  YE160405.SYSTEMKEY(+) = YE169010A.SYSTEMKEY                                 
            AND YE160405.YRTX_BLGG_YR(+) = YE169010A.YRTX_BLGG_YR                                  
            AND YE160405.CLUT_SEPT_CD(+) = YE169010A.CLUT_SEPT_CD
             AND YE160405.DPOB_CD(+)  = YE169010A.DPOB_CD 
               AND  YE169010.SYSTEMKEY(+) = YE169010A.SYSTEMKEY                                 
            AND YE169010.YRTX_BLGG_YR(+) = YE169010A.YRTX_BLGG_YR                                  
            AND YE169010.CLUT_SEPT_CD(+) = YE169010A.CLUT_SEPT_CD
             AND YE169010.DPOB_CD(+)  = YE169010A.DPOB_CD   )                               
			   WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#	 
				]]>
	</update>	   
	     
  <!--  세액공제 -근로소득공제 감면세액계 -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_3005_Update">
		<![CDATA[
			   UPDATE YE169010                                                                                                                                  
   SET                                 
   
    /*  TAXD_WKEN IS '세액공제)근로소득  */                                                                                            
      YETA_C120  = CASE WHEN YETA_C116 > 0 THEN  (CASE WHEN  YETA_0C63 <= 33000000 THEN                                                                                        
                                              TRUNC((CASE WHEN NVL(YETA_C113,0) <= 1300000                                                                                          
                                                      THEN CASE WHEN (NVL(YETA_C113,0) * 0.55) > 740000 THEN 740000 ELSE  (NVL(YETA_C113,0) * 0.55) END                        
                                                      ELSE                                                                                                                     
                                                       CASE WHEN (((NVL(YETA_C113,0)  - 1300000) * 0.30) +715000) > 740000                                                      
                                                       THEN 740000                                                                                                              
                                                       ELSE (((NVL(YETA_C113,0)  - 1300000) * 0.30) +715000)                                                                     
                                                       END  END)  ) * ( 1- (NVL(YETA_C116,0) / NVL(YETA_C113,0)))                                                                                                               
                                          WHEN  YETA_0C63 <= 70000000 THEN                                                                                                                     
                                               TRUNC((CASE WHEN NVL(YETA_C113,0) <= 1300000                                                                                           
                                                      THEN CASE WHEN (NVL(YETA_C113,0) * 0.55) > (CASE WHEN (740000 - ((YETA_0C63 - 33000000) * 0.008))  < 660000 THEN 660000     
                                                                                                       ELSE (740000 - ((YETA_0C63 - 33000000) * 0.008))  END)                     
                                                                THEN  (CASE WHEN (740000 - ((YETA_0C63 - 33000000) * 0.008))  < 660000 THEN 660000                                
                                                                            ELSE (740000 - ((YETA_0C63 - 33000000) * 0.008))  END)                                                
                                                                ELSE  (NVL(YETA_C113,0) * 0.55) END                                                                                             
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(YETA_C113,0)  - 1300000) * 0.30) +715000) > (CASE WHEN (740000 - ((YETA_0C63 - 33000000) * 0.008))  < 660000 THEN 660000   
                                                                                                                         ELSE (740000 - ((YETA_0C63 - 33000000) * 0.008))  END)                   
                                                       THEN (CASE WHEN (740000 - ((YETA_0C63 - 33000000) * 0.008))  < 660000 THEN 660000                                                          
                                                                            ELSE (740000 - ((YETA_0C63 - 33000000) * 0.008))  END)                                                                
                                                       ELSE (((NVL(YETA_C113,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  ) * ( 1- (NVL(YETA_C116,0) / NVL(YETA_C113,0)))                                                                                                                                
                                         ELSE                                                                                                                                                                  
                                          TRUNC((CASE WHEN NVL(YETA_C113,0) <= 1300000                                                                                                           
                                                      THEN CASE WHEN (NVL(YETA_C113,0) * 0.55) > (CASE WHEN (660000 - ((YETA_0C63 - 70000000) * 0.5))  < 500000 THEN 500000                     
                                                                                                       ELSE (660000 - ((YETA_0C63 - 70000000) * 0.5))  END)                                     
                                                                THEN (CASE WHEN (660000 - ((YETA_0C63 - 70000000) * 0.5))  < 500000 THEN 500000                                                 
                                                                                                       ELSE (660000 - ((YETA_0C63 - 70000000) * 0.5))  END)                                     
                                                                ELSE  (NVL(YETA_C113,0) * 0.55)  END                                                                                            
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(YETA_C113,0)  - 1300000) * 0.30) +715000) > (CASE WHEN (660000 - ((YETA_0C63 - 70000000) * 0.5))  < 500000 THEN 500000   
                                                                                                                        ELSE (660000 - ((YETA_0C63 - 70000000) * 0.5))  END)                    
                                                       THEN (CASE WHEN (660000 - ((YETA_0C63 - 70000000) * 0.5))  < 500000 THEN 500000                                                          
                                                                                                       ELSE (660000 - ((YETA_0C63 - 70000000) * 0.5))  END)                                     
                                                       ELSE (((NVL(YETA_C113,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  ) * ( 1- (NVL(YETA_C116,0) / NVL(YETA_C113,0)))                                                                                     
                                           END  )                                                                                                                                                                
                               ELSE  (CASE WHEN  YETA_0C63 <= 33000000 THEN                                                                                                    
                                          TRUNC((CASE WHEN NVL(YETA_C113,0) <= 1300000                                                                                                           
                                                      THEN CASE WHEN (NVL(YETA_C113,0) * 0.55) > 740000 THEN 740000 ELSE  (NVL(YETA_C113,0) * 0.55) END                                         
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(YETA_C113,0)  - 1300000) * 0.30) +715000) > 740000                                                                       
                                                       THEN 740000                                                                                                                              
                                                       ELSE (((NVL(YETA_C113,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  )                                                                                                                             
                                       WHEN  YETA_0C63 <= 70000000 THEN                                                                                                                                     
                                          TRUNC((CASE WHEN NVL(YETA_C113,0) <= 1300000                                                                                                           
                                                      THEN CASE WHEN (NVL(YETA_C113,0) * 0.55) > (CASE WHEN (740000 - ((YETA_0C63 - 33000000) * 0.008))  < 660000 THEN 660000                     
                                                                                                       ELSE (740000 - ((YETA_0C63 - 33000000) * 0.008))  END)                                     
                                                                THEN  (CASE WHEN (740000 - ((YETA_0C63 - 33000000) * 0.008))  < 660000 THEN 660000                                                
                                                                            ELSE (740000 - ((YETA_0C63 - 33000000) * 0.008))  END)                                                                
                                                                ELSE  (NVL(YETA_C113,0) * 0.55) END                                                                                             
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(YETA_C113,0)  - 1300000) * 0.30) +715000) > (CASE WHEN (740000 - ((YETA_0C63 - 33000000) * 0.008))  < 660000 THEN 660000   
                                                                                                                         ELSE (740000 - ((YETA_0C63 - 33000000) * 0.008))  END)                   
                                                       THEN (CASE WHEN (740000 - ((YETA_0C63 - 33000000) * 0.008))  < 660000 THEN 660000                                                          
                                                                            ELSE (740000 - ((YETA_0C63 - 33000000) * 0.008))  END)                                                                
                                                       ELSE (((NVL(YETA_C113,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  )                                                                                                                             
                                      ELSE                                                                                                                                                                  
                                          TRUNC((CASE WHEN NVL(YETA_C113,0) <= 1300000                                                                                                           
                                                      THEN CASE WHEN (NVL(YETA_C113,0) * 0.55) > (CASE WHEN (660000 - ((YETA_0C63 - 70000000) * 0.5))  < 500000 THEN 500000                     
                                                                                                       ELSE (660000 - ((YETA_0C63 - 70000000) * 0.5))  END)                                     
                                                                THEN (CASE WHEN (660000 - ((YETA_0C63 - 70000000) * 0.5))  < 500000 THEN 500000                                                 
                                                                                                       ELSE (660000 - ((YETA_0C63 - 70000000) * 0.5))  END)                                     
                                                                ELSE  (NVL(YETA_C113,0) * 0.55)  END                                                                                            
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(YETA_C113,0)  - 1300000) * 0.30) +715000) > (CASE WHEN (660000 - ((YETA_0C63 - 70000000) * 0.5))  < 500000 THEN 500000   
                                                                                                                        ELSE (660000 - ((YETA_0C63 - 70000000) * 0.5))  END)                    
                                                       THEN (CASE WHEN (660000 - ((YETA_0C63 - 70000000) * 0.5))  < 500000 THEN 500000                                                          
                                                                                                       ELSE (660000 - ((YETA_0C63 - 70000000) * 0.5))  END)                                     
                                                       ELSE (((NVL(YETA_C113,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  )                                                                                                                             
                         END  ) END,                                                                                                                                                            
                                                       
  /*  납세조합공제   TO-DO 다시 함 나중에  */                                                                                                                                                                                                   
         YETA_C153 = (SELECT CASE WHEN  (SUM(NVL(YE169010.YETA_C113,0)) * 0.1)  >=  YE169010.YETA_C113                                                                                                                             
                                 THEN YE169010.YETA_C113                                                                                                                                                                    
                                 ELSE (SUM(NVL(YE169010.YETA_C113,0)) * 0.1)                                                                                                                                                         
                                 END                                                                                                                                                                       
                       FROM YE161020 AD01 ,YE160404 AD02                                                                                                                                                                       
                       WHERE AD01.SYSTEMKEY(+) = YE169010.SYSTEMKEY                                                                                                                                         
                         AND AD01.YRTX_BLGG_YR(+) = YE169010.YRTX_BLGG_YR                                                                                                                                         
                         AND AD01.CLUT_SEPT_CD(+) = YE169010.CLUT_SEPT_CD
                         AND AD01.DPOB_CD(+)  = YE169010.DPOB_CD  
                         AND AD01.TAX_ASSO_YN(+) = '1'
                         AND YE169010.SYSTEMKEY = AD02.SYSTEMKEY(+)                                                                                                                                         
                         AND YE169010.YRTX_BLGG_YR = AD02.YRTX_BLGG_YR(+)                                                                                                                                         
                         AND YE169010.CLUT_SEPT_CD = AD02.CLUT_SEPT_CD(+)
                         AND YE169010.DPOB_CD  = AD02.DPOB_CD(+) 
                         AND AD02.TAX_ASSO_YN(+) = '1'                                                                                                                                        
                   )                                                                                                                                                                                     
			  WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#	 
				]]>
	</update>	   
	
 <!--  세액공제 -근로소득공제 감면세액계 -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010a_Tax_2022_3005_Update">
		<![CDATA[
			   UPDATE YE169010A                                                                                                                                  
   SET                                 
   
    /*  TAXD_WKEN IS '세액공제)근로소득  */                                                                                            
      YETA_STD_C120  = CASE WHEN YETA_STD_C116 > 0 THEN  (CASE WHEN  YETA_STD_0C63 <= 33000000 THEN                                                                                        
                                              TRUNC((CASE WHEN NVL(YETA_STD_C113,0) <= 1300000                                                                                          
                                                      THEN CASE WHEN (NVL(YETA_STD_C113,0) * 0.55) > 740000 THEN 740000 ELSE  (NVL(YETA_STD_C113,0) * 0.55) END                        
                                                      ELSE                                                                                                                     
                                                       CASE WHEN (((NVL(YETA_STD_C113,0)  - 1300000) * 0.30) +715000) > 740000                                                      
                                                       THEN 740000                                                                                                              
                                                       ELSE (((NVL(YETA_STD_C113,0)  - 1300000) * 0.30) +715000)                                                                     
                                                       END  END)  ) * ( 1- (NVL(YETA_STD_C116,0) / NVL(YETA_STD_C113,0)))                                                                                                               
                                          WHEN  YETA_STD_0C63 <= 70000000 THEN                                                                                                                     
                                               TRUNC((CASE WHEN NVL(YETA_STD_C113,0) <= 1300000                                                                                           
                                                      THEN CASE WHEN (NVL(YETA_STD_C113,0) * 0.55) > (CASE WHEN (740000 - ((YETA_STD_0C63 - 33000000) * 0.008))  < 660000 THEN 660000     
                                                                                                       ELSE (740000 - ((YETA_STD_0C63 - 33000000) * 0.008))  END)                     
                                                                THEN  (CASE WHEN (740000 - ((YETA_STD_0C63 - 33000000) * 0.008))  < 660000 THEN 660000                                
                                                                            ELSE (740000 - ((YETA_STD_0C63 - 33000000) * 0.008))  END)                                                
                                                                ELSE  (NVL(YETA_STD_C113,0) * 0.55) END                                                                                             
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(YETA_STD_C113,0)  - 1300000) * 0.30) +715000) > (CASE WHEN (740000 - ((YETA_STD_0C63 - 33000000) * 0.008))  < 660000 THEN 660000   
                                                                                                                         ELSE (740000 - ((YETA_STD_0C63 - 33000000) * 0.008))  END)                   
                                                       THEN (CASE WHEN (740000 - ((YETA_STD_0C63 - 33000000) * 0.008))  < 660000 THEN 660000                                                          
                                                                            ELSE (740000 - ((YETA_STD_0C63 - 33000000) * 0.008))  END)                                                                
                                                       ELSE (((NVL(YETA_STD_C113,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  ) * ( 1- (NVL(YETA_STD_C116,0) / NVL(YETA_STD_C113,0)))                                                                                                                                
                                         ELSE                                                                                                                                                                  
                                          TRUNC((CASE WHEN NVL(YETA_STD_C113,0) <= 1300000                                                                                                           
                                                      THEN CASE WHEN (NVL(YETA_STD_C113,0) * 0.55) > (CASE WHEN (660000 - ((YETA_STD_0C63 - 70000000) * 0.5))  < 500000 THEN 500000                     
                                                                                                       ELSE (660000 - ((YETA_STD_0C63 - 70000000) * 0.5))  END)                                     
                                                                THEN (CASE WHEN (660000 - ((YETA_STD_0C63 - 70000000) * 0.5))  < 500000 THEN 500000                                                 
                                                                                                       ELSE (660000 - ((YETA_STD_0C63 - 70000000) * 0.5))  END)                                     
                                                                ELSE  (NVL(YETA_STD_C113,0) * 0.55)  END                                                                                            
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(YETA_STD_C113,0)  - 1300000) * 0.30) +715000) > (CASE WHEN (660000 - ((YETA_STD_0C63 - 70000000) * 0.5))  < 500000 THEN 500000   
                                                                                                                        ELSE (660000 - ((YETA_STD_0C63 - 70000000) * 0.5))  END)                    
                                                       THEN (CASE WHEN (660000 - ((YETA_STD_0C63 - 70000000) * 0.5))  < 500000 THEN 500000                                                          
                                                                                                       ELSE (660000 - ((YETA_STD_0C63 - 70000000) * 0.5))  END)                                     
                                                       ELSE (((NVL(YETA_STD_C113,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  ) * ( 1- (NVL(YETA_STD_C116,0) / NVL(YETA_STD_C113,0)))                                                                                     
                                           END  )                                                                                                                                                                
                               ELSE  (CASE WHEN  YETA_STD_0C63 <= 33000000 THEN                                                                                                    
                                          TRUNC((CASE WHEN NVL(YETA_STD_C113,0) <= 1300000                                                                                                           
                                                      THEN CASE WHEN (NVL(YETA_STD_C113,0) * 0.55) > 740000 THEN 740000 ELSE  (NVL(YETA_STD_C113,0) * 0.55) END                                         
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(YETA_STD_C113,0)  - 1300000) * 0.30) +715000) > 740000                                                                       
                                                       THEN 740000                                                                                                                              
                                                       ELSE (((NVL(YETA_STD_C113,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  )                                                                                                                             
                                       WHEN  YETA_STD_0C63 <= 70000000 THEN                                                                                                                                     
                                          TRUNC((CASE WHEN NVL(YETA_STD_C113,0) <= 1300000                                                                                                           
                                                      THEN CASE WHEN (NVL(YETA_STD_C113,0) * 0.55) > (CASE WHEN (740000 - ((YETA_STD_0C63 - 33000000) * 0.008))  < 660000 THEN 660000                     
                                                                                                       ELSE (740000 - ((YETA_STD_0C63 - 33000000) * 0.008))  END)                                     
                                                                THEN  (CASE WHEN (740000 - ((YETA_STD_0C63 - 33000000) * 0.008))  < 660000 THEN 660000                                                
                                                                            ELSE (740000 - ((YETA_STD_0C63 - 33000000) * 0.008))  END)                                                                
                                                                ELSE  (NVL(YETA_STD_C113,0) * 0.55) END                                                                                             
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(YETA_STD_C113,0)  - 1300000) * 0.30) +715000) > (CASE WHEN (740000 - ((YETA_STD_0C63 - 33000000) * 0.008))  < 660000 THEN 660000   
                                                                                                                         ELSE (740000 - ((YETA_STD_0C63 - 33000000) * 0.008))  END)                   
                                                       THEN (CASE WHEN (740000 - ((YETA_STD_0C63 - 33000000) * 0.008))  < 660000 THEN 660000                                                          
                                                                            ELSE (740000 - ((YETA_STD_0C63 - 33000000) * 0.008))  END)                                                                
                                                       ELSE (((NVL(YETA_STD_C113,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  )                                                                                                                             
                                      ELSE                                                                                                                                                                  
                                          TRUNC((CASE WHEN NVL(YETA_STD_C113,0) <= 1300000                                                                                                           
                                                      THEN CASE WHEN (NVL(YETA_STD_C113,0) * 0.55) > (CASE WHEN (660000 - ((YETA_STD_0C63 - 70000000) * 0.5))  < 500000 THEN 500000                     
                                                                                                       ELSE (660000 - ((YETA_STD_0C63 - 70000000) * 0.5))  END)                                     
                                                                THEN (CASE WHEN (660000 - ((YETA_STD_0C63 - 70000000) * 0.5))  < 500000 THEN 500000                                                 
                                                                                                       ELSE (660000 - ((YETA_STD_0C63 - 70000000) * 0.5))  END)                                     
                                                                ELSE  (NVL(YETA_STD_C113,0) * 0.55)  END                                                                                            
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(YETA_STD_C113,0)  - 1300000) * 0.30) +715000) > (CASE WHEN (660000 - ((YETA_STD_0C63 - 70000000) * 0.5))  < 500000 THEN 500000   
                                                                                                                        ELSE (660000 - ((YETA_STD_0C63 - 70000000) * 0.5))  END)                    
                                                       THEN (CASE WHEN (660000 - ((YETA_STD_0C63 - 70000000) * 0.5))  < 500000 THEN 500000                                                          
                                                                                                       ELSE (660000 - ((YETA_STD_0C63 - 70000000) * 0.5))  END)                                     
                                                       ELSE (((NVL(YETA_STD_C113,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  )                                                                                                                             
                         END  ) END,                                                                                                                                                            
                                                       
  /*  납세조합공제   TO-DO 다시 함 나중에  */                                                                                                                                                                                                   
         YETA_STD_C153 = (SELECT CASE WHEN  (SUM(NVL(YE169010A.YETA_STD_C113,0)) * 0.1)  >=  YE169010A.YETA_STD_C113                                                                                                                             
                                 THEN YE169010A.YETA_STD_C113                                                                                                                                                                    
                                 ELSE (SUM(NVL(YE169010A.YETA_STD_C113,0)) * 0.1)                                                                                                                                                         
                                 END                                                                                                                                                                       
                       FROM YE161020 AD01 ,YE160404 AD02                                                                                                                                                                       
                       WHERE AD01.SYSTEMKEY(+) = YE169010A.SYSTEMKEY                                                                                                                                         
                         AND AD01.YRTX_BLGG_YR(+) = YE169010A.YRTX_BLGG_YR                                                                                                                                         
                         AND AD01.CLUT_SEPT_CD(+) = YE169010A.CLUT_SEPT_CD
                         AND AD01.DPOB_CD(+)  = YE169010A.DPOB_CD  
                         AND AD01.TAX_ASSO_YN(+) = '1'
                         AND YE169010A.SYSTEMKEY = AD02.SYSTEMKEY(+)                                                                                                                                         
                         AND YE169010A.YRTX_BLGG_YR = AD02.YRTX_BLGG_YR(+)                                                                                                                                         
                         AND YE169010A.CLUT_SEPT_CD = AD02.CLUT_SEPT_CD(+)
                         AND YE169010A.DPOB_CD  = AD02.DPOB_CD(+) 
                         AND AD02.TAX_ASSO_YN(+) = '1'                                                                                                                                        
                   )                                                                                                                                                                                     
			  WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#	 
				]]>
	</update>	
	
	   <!--  세액공제 주택차입금  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_3006_Update">
		<![CDATA[
			   UPDATE YE169010                                 
          SET    
                YETA_C154 = (SELECT TRUNC(NVL(AD01.HSNG_TENN_LNPB_USE_AMT,0) * (0.3))                                                 
                              FROM YE161080 AD01                                                                                                                     
                              WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                                                                                        
                                AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                                                                                        
                                AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD   
                                 AND AD01.DPOB_CD  = YE169010.DPOB_CD                                                                                      
                          ),                                                                                                                                       
   /* 세액감면 및 세액공제 - 외국납부 TODO  YETA_C113  Txlg_Inam    YETA_0C65 */
              YETA_C155 = (SELECT CASE WHEN AD01.FRGN_PMT_WC_TXAMT  <= 0           
              THEN 0                                                                                                                                                                                                   
              ELSE   CASE WHEN (YE169010.YETA_C113 * (AD01.OVRS_SURC_INC_FMT /YE169010.YETA_0C63)) > AD01.FRGN_PMT_WC_TXAMT                                                                                                  
                                          THEN  AD01.FRGN_PMT_WC_TXAMT                                                                                                                                                         
                                          ELSE  TRUNC((YE169010.YETA_C113 * (AD01.OVRS_SURC_INC_FMT / YE169010.YETA_0C63))) END                                                                                            
              END                                                  
                               FROM YE161080 AD01                                                  
                             WHERE AD01.SYSTEMKEY = YE169010.SYSTEMKEY                      
                                AND AD01.YRTX_BLGG_YR = YE169010.YRTX_BLGG_YR                     
                                AND AD01.CLUT_SEPT_CD = YE169010.CLUT_SEPT_CD    
                                 AND AD01.DPOB_CD  = YE169010.DPOB_CD                
                          )                                                                  
                      WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</update>
	
	     <!--  세액공제 주택차입금  -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010a_Tax_2022_3006_Update">
		<![CDATA[
			   UPDATE YE169010A                                 
          SET    
                YETA_STD_C154 = (SELECT TRUNC(NVL(AD01.HSNG_TENN_LNPB_USE_AMT,0) * (0.3))                                                 
                              FROM YE161080 AD01                                                                                                                     
                              WHERE AD01.SYSTEMKEY = YE169010A.SYSTEMKEY                                                                                        
                                AND AD01.YRTX_BLGG_YR = YE169010A.YRTX_BLGG_YR                                                                                        
                                AND AD01.CLUT_SEPT_CD = YE169010A.CLUT_SEPT_CD   
                                 AND AD01.DPOB_CD  = YE169010A.DPOB_CD                                                                                      
                          ),                                                                                                                                       
   /* 세액감면 및 세액공제 - 외국납부 TODO  YETA_C113  Txlg_Inam    YETA_0C65 */
              YETA_STD_C155 = (SELECT CASE WHEN AD01.FRGN_PMT_WC_TXAMT  <= 0           
              THEN 0                                                                                                                                                                                                   
              ELSE   CASE WHEN (YE169010A.YETA_STD_C113 * (AD01.OVRS_SURC_INC_FMT /YE169010A.YETA_STD_0C63)) > AD01.FRGN_PMT_WC_TXAMT                                                                                                  
                                          THEN  AD01.FRGN_PMT_WC_TXAMT                                                                                                                                                         
                                          ELSE  TRUNC((YE169010A.YETA_STD_C113 * (AD01.OVRS_SURC_INC_FMT / YE169010A.YETA_STD_0C63))) END                                                                                            
              END                                                  
                               FROM YE161080 AD01                                                  
                             WHERE AD01.SYSTEMKEY = YE169010A.SYSTEMKEY                      
                                AND AD01.YRTX_BLGG_YR = YE169010A.YRTX_BLGG_YR                     
                                AND AD01.CLUT_SEPT_CD = YE169010A.CLUT_SEPT_CD    
                                 AND AD01.DPOB_CD  = YE169010A.DPOB_CD                
                          ),       
                 YETA_STD_C152 =  #yetaStdC152#                                                                     
                      WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</update>
	   
	    <!-- 특별공제)특별세액공제 계 표준세액 공제  사용안함   -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnPayr06430_PAYR425_ReTax_2016_CREATE_BEF_12_1_Update">
		<![CDATA[
			     UPDATE YE169010                   
                  SET    
                            /* SPCI_RTDE IS '특별공제_보장성 보험료공제계 */                                                                                                                                
                             SPCI_RTDE = NVL(YETA_C134, 0) + NVL(YETA_C136, 0)  ,                              

                            /* SPCI_METO IS '특별공제_교육비계  */                                                                                                                                   
                               SPED_TXCR = NVL(SPED_SELF, 0) + NVL(SPED_GRDE, 0) + NVL(SPED_GDTO, 0) + NVL(SPED_CLDV, 0) + NVL(SPCI_SPEC, 0)                                                
			        WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</update>
	
	   
	   
	   <!--  특별공제)특별세액공제 계 표준세액 공제  플래그 처리로 변경    -->
	  <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_3007_Update">
		<![CDATA[
			  UPDATE YE161020                                                                                                                                                                        
           SET     
                 /* SPCI_DDCT IS '특별공제)표준세액공제 - 유리한쪽으로 계산하려면 수정필요  */                                                                                                                                    
            C152_STD_TX_DDC_YN =  #c152StdTxDdcYn#
            WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</update>	   
	
	  	   
	   <!--  특별공제)특별세액공제 계 표준세액 공제  플래그 처리로 변경    -->
	  <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010a_Tax_2022_3007_Update">
		<![CDATA[
			  UPDATE YE161020                                                                                                                                                                        
           SET     
                 /* SPCI_DDCT IS '특별공제)표준세액공제 - 유리한쪽으로 계산하려면 수정필요  */                                                                                                                                    
            C152_STD_TX_DDC_YN =  #c152StdTxDdcYn#
            WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</update>	   
	
	  
	
	 <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_3008_Update">
		<![CDATA[
			         
				UPDATE  YE169010                    
				SET      YETA_C122=#yetaC122#   
						, YETA_C124=#yetaC124#        
						, YETA_C126=#yetaC126#  
				        , YETA_C128=#yetaC128#
				, YETA_C130=#yetaC130#
				, YETA_C132=#yetaC132# 
				, YETA_C13B=#yetaC13b#                    
				 , YETA_C134=#yetaC134#
				, YETA_C136=#yetaC136#
				, YETA_C138=#yetaC138#	 
	            , YETA_C140=#yetaC140#
				, YETA_C142=#yetaC142#
				, YETA_C144=#yetaC144# 
				, YETA_C157=#yetaC157#
				, YETA_C146=#yetaC146#
				, YETA_C148=#yetaC148#
				, YETA_C150=#yetaC150#
				, YETA_C150B=#yetaC150b#
				, YETA_C152=#yetaC152#					   
 				, YETA_C114=#yetaC114#
				, YETA_C115=#yetaC115#
				, YETA_C116=#yetaC116#
				, YETA_C117=#yetaC117#
				, YETA_C119=#yetaC119#
				, YETA_C120=#yetaC120#
				, YETA_C151=#yetaC151#
				, YETA_C153=#yetaC153#
				, YETA_C154=#yetaC154#
				, YETA_C155=#yetaC155#
					, YETA_C158=#yetaC158#		 
				, ISMT=#ismt#
				, REVN_DT=#revnDt#
				, REVN_ADDR=#revnAddr#   
                 WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</update>  
	
	 
	 
	
	 <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010a_Tax_2022_3008_Update">
		<![CDATA[
			         
				UPDATE  YE169010A                    
				SET   
				  YETA_STD_C122=#yetaStdC122#   
				, YETA_STD_C124=#yetaStdC124#        
				, YETA_STD_C126=#yetaStdC126#  
				, YETA_STD_C128=#yetaStdC128#
				, YETA_STD_C130=#yetaStdC130#
				, YETA_STD_C132=#yetaStdC132#
				, YETA_STD_C13B=#yetaStdC13b#                     
				, YETA_STD_C134=#yetaStdC134#
				, YETA_STD_C136=#yetaStdC136#
				, YETA_STD_C138=#yetaStdC138#	 
				, YETA_STD_C140=#yetaStdC140#
				, YETA_STD_C142=#yetaStdC142#
				, YETA_STD_C144=#yetaStdC144# 
				, YETA_STD_C157=#yetaStdC157#
				, YETA_STD_C146=#yetaStdC146#
				, YETA_STD_C148=#yetaStdC148#
				, YETA_STD_C150=#yetaStdC150#
				, YETA_STD_C150B=#yetaStdC150b#
				, YETA_STD_C152=#yetaStdC152#					   
				, YETA_STD_C114=#yetaStdC114#
				, YETA_STD_C115=#yetaStdC115#
				, YETA_STD_C116=#yetaStdC116#
				, YETA_STD_C117=#yetaStdC117#
				, YETA_STD_C119=#yetaStdC119#
				, YETA_STD_C120=#yetaStdC120#
				, YETA_STD_C151=#yetaStdC151#
				, YETA_STD_C153=#yetaStdC153#
				, YETA_STD_C154=#yetaStdC154#
				, YETA_STD_C155=#yetaStdC155#
				, YETA_STD_C158=#yetaStdC158#	 	 
				, ISMT=#ismt#
				, REVN_DT=#revnDt#
				, REVN_ADDR=#revnAddr#   
                 WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</update> 
	 
	 <!-- -특별공제)특별세액공제 계 표준세액 공제  -->
	   	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_3009_Update">
		<![CDATA[
			 UPDATE YE169010                                                                                                                                                                         
                            SET                                                                                                                                                                  
                         /*  YETA_C119  TAXD_TSUM IS '세액감면)감면세액계   */                                                                          
                            YETA_C119 = (NVL(YETA_C114,0) + NVL(YETA_C115,0)+ NVL(YETA_C116,0)+ NVL(YETA_C117,0)) ,
                             /* --YETA_C151 SPCI_DCTO IS '특별세액공제 계 */                                                                                                                                 
                     YETA_C151 = ( NVL(YETA_C134, 0) + NVL(YETA_C136, 0) + NVL(YETA_C138, 0)+ NVL(YETA_C140, 0) +
                                  NVL(YETA_C142, 0) + NVL(YETA_C144, 0) + NVL(YETA_C146, 0)+ NVL(YETA_C148, 0) +
                                   NVL(YETA_C150, 0) + NVL(YETA_C150B, 0) )  
			 WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</update>
	
	   <!-- -특별공제)특별세액공제 계 표준세액 공제  -->
	   	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010a_Tax_2022_3009_Update">
		<![CDATA[
			 UPDATE YE169010A                                                                                                                                                                         
                            SET                                                                                                                                                                  
                         /*  YETA_STD_C119  TAXD_TSUM IS '세액감면)감면세액계   */                                                                          
                            YETA_STD_C119 = (NVL(YETA_STD_C114,0) + NVL(YETA_STD_C115,0)+ NVL(YETA_STD_C116,0)+ NVL(YETA_STD_C117,0)) ,
                             /* --YETA_STD_C151 SPCI_DCTO IS '특별세액공제 계 */                                                                                                                                 
                     YETA_STD_C151 = ( NVL(YETA_STD_C134, 0) + NVL(YETA_STD_C136, 0) + NVL(YETA_STD_C138, 0)+ NVL(YETA_STD_C140, 0) +
                                  NVL(YETA_STD_C142, 0) + NVL(YETA_STD_C144, 0) + NVL(YETA_STD_C146, 0)+ NVL(YETA_STD_C148, 0) +
                                   NVL(YETA_STD_C150, 0) + NVL(YETA_STD_C150B, 0) )  
			 WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</update>
	
	   	   	   
         <!-- 세액감면 세액공제- -->
	   	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_3010_Update">
		<![CDATA[
			  UPDATE YE169010                                                                                                         
                   SET   
                    /* --YETA_C158 TAXD_CSUM IS '세액공제)공제계    */                                                                            
                    YETA_C158 = (NVL(YETA_C120,0) + NVL(YETA_C122,0)   + NVL(YETA_C124,0) + NVL(YETA_C126,0) + NVL(YETA_C128,0) 
                     + NVL(YETA_C130, 0) + NVL(YETA_C132, 0) + NVL(YETA_C13B, 0) + NVL(YETA_C151, 0)  + NVL(YETA_C152, 0)  +  NVL( YETA_C153,0)   
    				       + NVL(YETA_C154,0)  + NVL(YETA_C155,0)  + NVL(YETA_C157,0) )  
               WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#
				]]>
	</update>
	
	   	       <!-- 세액감면 세액공제- -->
	   	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010a_Tax_2022_3010_Update">
		<![CDATA[
			  UPDATE YE169010A                                                                                                         
                   SET   
                    /* --YETA_STD_C158 TAXD_CSUM IS '세액공제)공제계    */                                                                            
                    YETA_STD_C158 = (NVL(YETA_STD_C120,0) + NVL(YETA_STD_C122,0)   + NVL(YETA_STD_C124,0) + NVL(YETA_STD_C126,0) + NVL(YETA_STD_C128,0) 
                     + NVL(YETA_STD_C130, 0) + NVL(YETA_STD_C132, 0) + NVL(YETA_STD_C13B, 0) + NVL(YETA_STD_C151, 0)  + NVL(YETA_STD_C152, 0)  +  NVL( YETA_STD_C153,0)   
    				       + NVL(YETA_STD_C154,0)  + NVL(YETA_STD_C155,0)  + NVL(YETA_STD_C157,0) )  
               WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#
				]]>
	</update>
	   	   
	   	      	   <!-- 농어촌특별세 계산   SUBT_ERAM -  ETGD_DDAM - ETGD_HTRA - ETEP_SECR
           농어촌특별세 계산    ETGD_DDAM TODO 개인직접투자인경우 과세대상제외 구분자 필요   TAXD_LOAN
         -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_3011_Update">
		<![CDATA[
			    
            UPDATE YE169010                                                                                                                                               
       SET                                                                                                                                
           /* YETA_C161 ALRY_YVTX IS '농특세   */                                                                                                                         
           YETA_C161 =     (CASE WHEN                        
                             ((TRUNC(                                                                                           
                                      CASE WHEN   (YETA_0C97 - (nvl(YETA_0C98,0)  + nvl(YETA_0C99,0) + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + nvl(YETA_C104,0)   + nvl(YETA_C105,0)  + nvl(YETA_C107,0)+ nvl(YETA_C109,0)+ nvl(YETA_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_C111 -  NVL(YETA_C103, 0)) > 0                                                              
                                                        THEN (YETA_C111 - NVL(YETA_C103, 0))                                                                    
                                                        ELSE 0 END)) <= 12000000                                                                                                                        
                                           THEN  ( (YETA_0C97 - (nvl(YETA_0C98,0)  + nvl(YETA_0C99,0) + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + nvl(YETA_C104,0)   + nvl(YETA_C105,0)   + nvl(YETA_C107,0) + nvl(YETA_C109,0)+ nvl(YETA_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_C111 - NVL(YETA_C103, 0)) > 0                                                              
                                                        THEN (YETA_C111 - NVL(YETA_C103, 0))                                                                    
                                                        ELSE 0 END)) * 0.06 )                              
                                           WHEN   (YETA_0C97 - (nvl(YETA_0C98,0)  + nvl(YETA_0C99,0) + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + nvl(YETA_C104,0)   + nvl(YETA_C105,0) + nvl(YETA_C107,0)+ nvl(YETA_C109,0)+ nvl(YETA_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_C111 - NVL(YETA_C103, 0)) > 0                                                              
                                                        THEN (YETA_C111 - NVL(YETA_C103, 0))                                                                    
                                                        ELSE 0 END)) <= 46000000                                                                                                                        
                                                                   THEN  (( (YETA_0C97 - (nvl(YETA_0C98,0)  + nvl(YETA_0C99,0) + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + nvl(YETA_C104,0)   + nvl(YETA_C105,0) + nvl(YETA_C107,0) + nvl(YETA_C109,0)+ nvl(YETA_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_C111 - NVL(YETA_C103, 0)) > 0                                                              
                                                        THEN (YETA_C111 - NVL(YETA_C103, 0))                                                                    
                                                        ELSE 0 END)) * 0.15) - 1080000)    
                                           WHEN   (YETA_0C97 - (nvl(YETA_0C98,0)  + nvl(YETA_0C99,0) + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + nvl(YETA_C104,0)   + nvl(YETA_C105,0)   + nvl(YETA_C107,0) + nvl(YETA_C109,0)+ nvl(YETA_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_C111 - NVL(YETA_C103, 0)) > 0                                                              
                                                        THEN (YETA_C111 - NVL(YETA_C103, 0))                                                                    
                                                        ELSE 0 END)) <= 88000000                                                                                                                        
                                                                   THEN  ((  (YETA_0C97 - (nvl(YETA_0C98,0)  + nvl(YETA_0C99,0) + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + nvl(YETA_C104,0)   + nvl(YETA_C105,0)   + nvl(YETA_C107,0) + nvl(YETA_C109,0)+ nvl(YETA_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_C111 - NVL(YETA_C103, 0)) > 0                                                              
                                                        THEN (YETA_C111 - NVL(YETA_C103, 0))                                                                    
                                                        ELSE 0 END))  * 0.24) - 5220000 )      
                                           WHEN   (YETA_0C97 - (nvl(YETA_0C98,0)  + nvl(YETA_0C99,0) + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + nvl(YETA_C104,0)   + nvl(YETA_C105,0)   + nvl(YETA_C107,0) + nvl(YETA_C109,0)+ nvl(YETA_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_C111 - NVL(YETA_C103, 0)) > 0                                                              
                                                        THEN (YETA_C111 - NVL(YETA_C103, 0))                                                                    
                                                        ELSE 0 END)) <= 150000000                                                                                                                       
                                                                   THEN  ((  (YETA_0C97 - (nvl(YETA_0C98,0)  + nvl(YETA_0C99,0) + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + nvl(YETA_C104,0)   + nvl(YETA_C105,0)   + nvl(YETA_C107,0) + nvl(YETA_C109,0)+ nvl(YETA_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_C111 - NVL(YETA_C103, 0)) > 0                                                              
                                                        THEN (YETA_C111 - NVL(YETA_C103, 0))                                                                    
                                                        ELSE 0 END)) * 0.35) - 14900000 )    
                                      ELSE   ((  (YETA_0C97 - (nvl(YETA_0C98,0)  + nvl(YETA_0C99,0) + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + nvl(YETA_C104,0)   + nvl(YETA_C105,0)  + nvl(YETA_C107,0)+ nvl(YETA_C109,0)+ nvl(YETA_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_C111 - NVL(YETA_C103, 0)) > 0                                                              
                                                        THEN (YETA_C111 - NVL(YETA_C103, 0))                                                                    
                                                        ELSE 0 END)) * 0.38) - 19400000 )  END)) - YETA_C113)  < 0    
                      THEN 0                                                                                          
                      ELSE                                                                              
                             TRUNC(((((                                                                                           
                                      CASE WHEN   (YETA_0C97 - (nvl(YETA_0C98,0)  + nvl(YETA_0C99,0) + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + nvl(YETA_C104,0)   + nvl(YETA_C105,0)   + nvl(YETA_C107,0)+ nvl(YETA_C109,0)+ nvl(YETA_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_C111 - NVL(YETA_C103, 0)) > 0                                                              
                                                        THEN (YETA_C111 - NVL(YETA_C103, 0))                                                                    
                                                        ELSE 0 END)) <= 12000000                                                                                                                        
                                                                   THEN  ( (YETA_0C97 - (nvl(YETA_0C98,0)  + nvl(YETA_0C99,0) + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + nvl(YETA_C104,0)   + nvl(YETA_C105,0)  + nvl(YETA_C107,0)+ nvl(YETA_C109,0)+ nvl(YETA_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_C111 - NVL(YETA_C103, 0)) > 0                                                              
                                                        THEN (YETA_C111 - NVL(YETA_C103, 0))                                                                    
                                                        ELSE 0 END)) * 0.06 )                              
                                           WHEN   (YETA_0C97 - (nvl(YETA_0C98,0)  + nvl(YETA_0C99,0) + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + nvl(YETA_C104,0)   + nvl(YETA_C105,0)   + nvl(YETA_C107,0)+ nvl(YETA_C109,0)+ nvl(YETA_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_C111 - NVL(YETA_C103, 0)) > 0                                                              
                                                        THEN (YETA_C111 - NVL(YETA_C103, 0))                                                                    
                                                        ELSE 0 END)) <= 46000000                                                                                                                        
                                                                   THEN  (( (YETA_0C97 - (nvl(YETA_0C98,0)  + nvl(YETA_0C99,0) + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + nvl(YETA_C104,0)   + nvl(YETA_C105,0)   + nvl(YETA_C107,0)+ nvl(YETA_C109,0)+ nvl(YETA_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_C111 - NVL(YETA_C103, 0)) > 0                                                              
                                                        THEN (YETA_C111 - NVL(YETA_C103, 0))                                                                    
                                                        ELSE 0 END)) * 0.15) - 1080000)    
                                           WHEN   (YETA_0C97 - (nvl(YETA_0C98,0)  + nvl(YETA_0C99,0) + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + nvl(YETA_C104,0)   + nvl(YETA_C105,0)  + nvl(YETA_C107,0)+ nvl(YETA_C109,0)+ nvl(YETA_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_C111 - NVL(YETA_C103, 0)) > 0                                                              
                                                        THEN (YETA_C111 - NVL(YETA_C103, 0))                                                                    
                                                        ELSE 0 END)) <= 88000000                                                                                                                        
                                                                   THEN  ((  (YETA_0C97 - (nvl(YETA_0C98,0)  + nvl(YETA_0C99,0) + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + nvl(YETA_C104,0)   + nvl(YETA_C105,0) + nvl(YETA_C107,0)+ nvl(YETA_C109,0)+ nvl(YETA_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_C111 - NVL(YETA_C103, 0)) > 0                                                              
                                                        THEN (YETA_C111 - NVL(YETA_C103, 0))                                                                    
                                                        ELSE 0 END))  * 0.24) - 5220000 )      
                                           WHEN   (YETA_0C97 - (nvl(YETA_0C98,0)  + nvl(YETA_0C99,0) + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + nvl(YETA_C104,0)   + nvl(YETA_C105,0)   + nvl(YETA_C107,0)+ nvl(YETA_C109,0)+ nvl(YETA_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_C111 - NVL(YETA_C103, 0)) > 0                                                              
                                                        THEN (YETA_C111 - NVL(YETA_C103, 0))                                                                    
                                                        ELSE 0 END)) <= 150000000                                                                                                                       
                                                                   THEN  ((  (YETA_0C97 - (nvl(YETA_0C98,0)  + nvl(YETA_0C99,0) + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + nvl(YETA_C104,0)   + nvl(YETA_C105,0) + nvl(YETA_C107,0)+ nvl(YETA_C109,0)+ nvl(YETA_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_C111 - NVL(YETA_C103, 0)) > 0                                                              
                                                        THEN (YETA_C111 - NVL(YETA_C103, 0))                                                                    
                                                        ELSE 0 END)) * 0.35) - 14900000 )    
                                      ELSE   ((  (YETA_0C97 - (nvl(YETA_0C98,0)  + nvl(YETA_0C99,0) + (YE169010.YETA_C100 + YE169010.YETA_C101 + YE169010.YETA_C102 )  + nvl(YETA_C104,0)   + nvl(YETA_C105,0)   + nvl(YETA_C107,0)+ nvl(YETA_C109,0)+ nvl(YETA_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_C111 - NVL(YETA_C103, 0)) > 0                                                              
                                                        THEN (YETA_C111 - NVL(YETA_C103, 0))                                                                    
                                                        ELSE 0 END)) * 0.38) - 19400000 )  END)) - YETA_C113) + YETA_C154) * 0.2) END)                                                               
			WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#
  
				]]>
	</update>
	
	   
	      	      	   <!-- 농어촌특별세 계산   SUBT_ERAM -  ETGD_DDAM - ETGD_HTRA - ETEP_SECR
           농어촌특별세 계산    ETGD_DDAM TODO 개인직접투자인경우 과세대상제외 구분자 필요   TAXD_LOAN
         -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010a_Tax_2022_3011_Update">
		<![CDATA[
			    
     UPDATE YE169010A                                                                                                                                               
       SET       /* YETA_C161 ALRY_YVTX IS '농특세   */                                                                                                                         
              YETA_STD_C161 =     (CASE WHEN                        
                             ((TRUNC(                                                                                           
                                      CASE WHEN   (YETA_STD_0C97 - (nvl(YETA_STD_0C98,0)  + nvl(YETA_STD_0C99,0) + (YE169010A.YETA_STD_C100 + YE169010A.YETA_STD_C101 + YE169010A.YETA_STD_C102 )  + nvl(YETA_STD_C104,0)   + nvl(YETA_STD_C105,0)  + nvl(YETA_STD_C107,0)+ nvl(YETA_STD_C109,0)+ nvl(YETA_STD_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_STD_C111 -  NVL(YETA_STD_C103, 0)) > 0                                                              
                                                        THEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0))                                                                    
                                                        ELSE 0 END)) <= 12000000                                                                                                                        
                                           THEN  ( (YETA_STD_0C97 - (nvl(YETA_STD_0C98,0)  + nvl(YETA_STD_0C99,0) + (YE169010A.YETA_STD_C100 + YE169010A.YETA_STD_C101 + YE169010A.YETA_STD_C102 )  + nvl(YETA_STD_C104,0)   + nvl(YETA_STD_C105,0)   + nvl(YETA_STD_C107,0) + nvl(YETA_STD_C109,0) + nvl(YETA_STD_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0)) > 0                                                              
                                                        THEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0))                                                                    
                                                        ELSE 0 END)) * 0.06 )                              
                                           WHEN   (YETA_STD_0C97 - (nvl(YETA_STD_0C98,0)  + nvl(YETA_STD_0C99,0) + (YE169010A.YETA_STD_C100 + YE169010A.YETA_STD_C101 + YE169010A.YETA_STD_C102 )  + nvl(YETA_STD_C104,0)   + nvl(YETA_STD_C105,0) + nvl(YETA_STD_C107,0)+ nvl(YETA_STD_C109,0)+ nvl(YETA_STD_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0)) > 0                                                              
                                                        THEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0))                                                                    
                                                        ELSE 0 END)) <= 46000000                                                                                                                        
                                                                   THEN  (( (YETA_STD_0C97 - (nvl(YETA_STD_0C98,0)  + nvl(YETA_STD_0C99,0) + (YE169010A.YETA_STD_C100 + YE169010A.YETA_STD_C101 + YE169010A.YETA_STD_C102 )  + nvl(YETA_STD_C104,0)   + nvl(YETA_STD_C105,0) + nvl(YETA_STD_C107,0) + nvl(YETA_STD_C109,0) + nvl(YETA_STD_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0)) > 0                                                              
                                                        THEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0))                                                                    
                                                        ELSE 0 END)) * 0.15) - 1080000)    
                                           WHEN   (YETA_STD_0C97 - (nvl(YETA_STD_0C98,0)  + nvl(YETA_STD_0C99,0) + (YE169010A.YETA_STD_C100 + YE169010A.YETA_STD_C101 + YE169010A.YETA_STD_C102 )  + nvl(YETA_STD_C104,0)   + nvl(YETA_STD_C105,0)   + nvl(YETA_STD_C107,0) + nvl(YETA_STD_C109,0) + nvl(YETA_STD_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0)) > 0                                                              
                                                        THEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0))                                                                    
                                                        ELSE 0 END)) <= 88000000                                                                                                                        
                                                                   THEN  ((  (YETA_STD_0C97 - (nvl(YETA_STD_0C98,0)  + nvl(YETA_STD_0C99,0) + (YE169010A.YETA_STD_C100 + YE169010A.YETA_STD_C101 + YE169010A.YETA_STD_C102 )  + nvl(YETA_STD_C104,0)   + nvl(YETA_STD_C105,0)   + nvl(YETA_STD_C107,0) + nvl(YETA_STD_C109,0)+ nvl(YETA_STD_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0)) > 0                                                              
                                                        THEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0))                                                                    
                                                        ELSE 0 END))  * 0.24) - 5220000 )      
                                           WHEN   (YETA_STD_0C97 - (nvl(YETA_STD_0C98,0)  + nvl(YETA_STD_0C99,0) + (YE169010A.YETA_STD_C100 + YE169010A.YETA_STD_C101 + YE169010A.YETA_STD_C102 )  + nvl(YETA_STD_C104,0)   + nvl(YETA_STD_C105,0)   + nvl(YETA_STD_C107,0) + nvl(YETA_STD_C109,0)+ nvl(YETA_STD_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0)) > 0                                                              
                                                        THEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0))                                                                    
                                                        ELSE 0 END)) <= 150000000                                                                                                                       
                                                                   THEN  ((  (YETA_STD_0C97 - (nvl(YETA_STD_0C98,0)  + nvl(YETA_STD_0C99,0) + (YE169010A.YETA_STD_C100 + YE169010A.YETA_STD_C101 + YE169010A.YETA_STD_C102 )  + nvl(YETA_STD_C104,0)   + nvl(YETA_STD_C105,0)   + nvl(YETA_STD_C107,0) + nvl(YETA_STD_C109,0)+ nvl(YETA_STD_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0)) > 0                                                              
                                                        THEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0))                                                                    
                                                        ELSE 0 END)) * 0.35) - 14900000 )    
                                      ELSE   ((  (YETA_STD_0C97 - (nvl(YETA_STD_0C98,0)  + nvl(YETA_STD_0C99,0) + (YE169010A.YETA_STD_C100 + YE169010A.YETA_STD_C101 + YE169010A.YETA_STD_C102 )  + nvl(YETA_STD_C104,0)   + nvl(YETA_STD_C105,0)  + nvl(YETA_STD_C107,0)+ nvl(YETA_STD_C109,0)+ nvl(YETA_STD_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0)) > 0                                                              
                                                        THEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0))                                                                    
                                                        ELSE 0 END)) * 0.38) - 19400000 )  END)) - YETA_STD_C113)  < 0    
                      THEN 0                                                                                          
                      ELSE                                                                              
                             TRUNC(((((                                                                                           
                                      CASE WHEN   (YETA_STD_0C97 - (nvl(YETA_STD_0C98,0)  + nvl(YETA_STD_0C99,0) + (YE169010A.YETA_STD_C100 + YE169010A.YETA_STD_C101 + YE169010A.YETA_STD_C102 )  + nvl(YETA_STD_C104,0)   + nvl(YETA_STD_C105,0)   + nvl(YETA_STD_C107,0)+ nvl(YETA_STD_C109,0)+ nvl(YETA_STD_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0)) > 0                                                              
                                                        THEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0))                                                                    
                                                        ELSE 0 END)) <= 12000000                                                                                                                        
                                                                   THEN  ( (YETA_STD_0C97 - (nvl(YETA_STD_0C98,0)  + nvl(YETA_STD_0C99,0) + (YE169010A.YETA_STD_C100 + YE169010A.YETA_STD_C101 + YE169010A.YETA_STD_C102 )  + nvl(YETA_STD_C104,0)   + nvl(YETA_STD_C105,0)  + nvl(YETA_STD_C107,0)+ nvl(YETA_STD_C109,0)+ nvl(YETA_STD_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0)) > 0                                                              
                                                        THEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0))                                                                    
                                                        ELSE 0 END)) * 0.06 )                              
                                           WHEN   (YETA_STD_0C97 - (nvl(YETA_STD_0C98,0)  + nvl(YETA_STD_0C99,0) + (YE169010A.YETA_STD_C100 + YE169010A.YETA_STD_C101 + YE169010A.YETA_STD_C102 )  + nvl(YETA_STD_C104,0)   + nvl(YETA_STD_C105,0)   + nvl(YETA_STD_C107,0)+ nvl(YETA_STD_C109,0)+ nvl(YETA_STD_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0)) > 0                                                              
                                                        THEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0))                                                                    
                                                        ELSE 0 END)) <= 46000000                                                                                                                        
                                                                   THEN  (( (YETA_STD_0C97 - (nvl(YETA_STD_0C98,0)  + nvl(YETA_STD_0C99,0) + (YE169010A.YETA_STD_C100 + YE169010A.YETA_STD_C101 + YE169010A.YETA_STD_C102 )  + nvl(YETA_STD_C104,0)   + nvl(YETA_STD_C105,0)   + nvl(YETA_STD_C107,0)+ nvl(YETA_STD_C109,0)+ nvl(YETA_STD_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0)) > 0                                                              
                                                        THEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0))                                                                    
                                                        ELSE 0 END)) * 0.15) - 1080000)    
                                           WHEN   (YETA_STD_0C97 - (nvl(YETA_STD_0C98,0)  + nvl(YETA_STD_0C99,0) + (YE169010A.YETA_STD_C100 + YE169010A.YETA_STD_C101 + YE169010A.YETA_STD_C102 )  + nvl(YETA_STD_C104,0)   + nvl(YETA_STD_C105,0)  + nvl(YETA_STD_C107,0)+ nvl(YETA_STD_C109,0)+ nvl(YETA_STD_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0)) > 0                                                              
                                                        THEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0))                                                                    
                                                        ELSE 0 END)) <= 88000000                                                                                                                        
                                                                   THEN  ((  (YETA_STD_0C97 - (nvl(YETA_STD_0C98,0)  + nvl(YETA_STD_0C99,0) + (YE169010A.YETA_STD_C100 + YE169010A.YETA_STD_C101 + YE169010A.YETA_STD_C102 )  + nvl(YETA_STD_C104,0)   + nvl(YETA_STD_C105,0) + nvl(YETA_STD_C107,0)+ nvl(YETA_STD_C109,0)+ nvl(YETA_STD_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0)) > 0                                                              
                                                        THEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0))                                                                    
                                                        ELSE 0 END))  * 0.24) - 5220000 )      
                                           WHEN   (YETA_STD_0C97 - (nvl(YETA_STD_0C98,0)  + nvl(YETA_STD_0C99,0) + (YE169010A.YETA_STD_C100 + YE169010A.YETA_STD_C101 + YE169010A.YETA_STD_C102 )  + nvl(YETA_STD_C104,0)   + nvl(YETA_STD_C105,0)   + nvl(YETA_STD_C107,0)+ nvl(YETA_STD_C109,0)+ nvl(YETA_STD_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0)) > 0                                                              
                                                        THEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0))                                                                    
                                                        ELSE 0 END)) <= 150000000                                                                                                                       
                                                                   THEN  ((  (YETA_STD_0C97 - (nvl(YETA_STD_0C98,0)  + nvl(YETA_STD_0C99,0) + (YE169010A.YETA_STD_C100 + YE169010A.YETA_STD_C101 + YE169010A.YETA_STD_C102 )  + nvl(YETA_STD_C104,0)   + nvl(YETA_STD_C105,0) + nvl(YETA_STD_C107,0)+ nvl(YETA_STD_C109,0)+ nvl(YETA_STD_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0)) > 0                                                              
                                                        THEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0))                                                                    
                                                        ELSE 0 END)) * 0.35) - 14900000 )    
                                      ELSE   ((  (YETA_STD_0C97 - (nvl(YETA_STD_0C98,0)  + nvl(YETA_STD_0C99,0) + (YE169010A.YETA_STD_C100 + YE169010A.YETA_STD_C101 + YE169010A.YETA_STD_C102 )  + nvl(YETA_STD_C104,0)   + nvl(YETA_STD_C105,0)   + nvl(YETA_STD_C107,0)+ nvl(YETA_STD_C109,0)+ nvl(YETA_STD_C109Y,0))                                                                                             
                                                + (CASE WHEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0)) > 0                                                              
                                                        THEN (YETA_STD_C111 - NVL(YETA_STD_C103, 0))                                                                    
                                                        ELSE 0 END)) * 0.38) - 19400000 )  END)) - YETA_STD_C113) + YETA_STD_C154) * 0.2) END)             
                                                                                                                                     
                                                             
			WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#
  
				]]>
	</update>
	
	   
	   <!-- 결정세액 -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_3012_Update">
		<![CDATA[
			       UPDATE YE169010                                                                        
                          SET                                                                          
                          YETA_C159 = CASE WHEN (YETA_C113 - YETA_C119 - YETA_C158) < 0                
                                      THEN 0                                                           
                                      ELSE (YETA_C113 - YETA_C119 - YETA_C158)                         
                                      END,                                                             
                          YETA_C160 = TRUNC((CASE WHEN (YETA_C113 - YETA_C119 - YETA_C158) < 0         
                                      THEN 0                                                           
                                      ELSE (YETA_C113 - YETA_C119 - YETA_C158)                         
                                      END) * 0.1)   
                                  , REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')           
            WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#
				]]>
	</update>
	
	   
	   <!-- 결정세액 -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010a_Tax_2022_3012_Update">
		<![CDATA[
			       UPDATE YE169010A                                                                        
                          SET                                                                          
                          YETA_STD_C159 = CASE WHEN (YETA_STD_C113 - YETA_STD_C119 - YETA_STD_C158) < 0                
                                      THEN 0                                                           
                                      ELSE (YETA_STD_C113 - YETA_STD_C119 - YETA_STD_C158)                         
                                      END,                                                             
                          YETA_STD_C160 = TRUNC((CASE WHEN (YETA_STD_C113 - YETA_STD_C119 - YETA_STD_C158) < 0         
                                      THEN 0                                                           
                                      ELSE (YETA_STD_C113 - YETA_STD_C119 - YETA_STD_C158)                         
                                      END) * 0.1)   
                                  , REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')           
            WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#
				]]>
	</update>
	   
	   
	
	
	 <!-- 납부또는 환급세액 -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_51_Update">
		<![CDATA[
			 UPDATE YE169010                                                                                                     
			   SET                                                                                      
			   YETA_C168 = (TRUNC((NVL(YETA_C159, 0) - NVL(YETA_C162, 0) - NVL(DCSN_ITAX, 0))/10) * 10),        
			   YETA_C169 = (TRUNC((NVL(YETA_C160, 0) - NVL(YETA_C163, 0) - NVL(DCSN_BTAX, 0))/10) * 10),        
			   YETA_C170 = (TRUNC((NVL(YETA_C161, 0) - NVL(YETA_C164, 0) - NVL(FAFV_TAXI, 0))/10) * 10) 
			      , REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')    
			   WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#
				]]>
	</update>
	   
	    <!-- 납부또는 환급세액 -->
	   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010a_Tax_2022_51_Update">
		<![CDATA[
			 UPDATE YE169010A                                                                                                     
			   SET                                                                                      
			   YETA_STD_C168 = (TRUNC((NVL(YETA_STD_C159, 0) - NVL(YETA_STD_C162, 0) - NVL(DCSN_ITAX, 0))/10) * 10),        
			   YETA_STD_C169 = (TRUNC((NVL(YETA_STD_C160, 0) - NVL(YETA_STD_C163, 0) - NVL(DCSN_BTAX, 0))/10) * 10),        
			   YETA_STD_C170 = (TRUNC((NVL(YETA_STD_C161, 0) - NVL(YETA_STD_C164, 0) - NVL(FAFV_TAXI, 0))/10) * 10) 
			      , REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')    
			   WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#
				]]>
	</update>
	 
	
	   <!-- 차감징수세액 총계 -->
	  <update id="infcPkgYeta17Tax_2022_DAO.fnPayr06430_PAYR425_ReTax_2016_CREATE_19_Update">
		<![CDATA[
	  UPDATE YE169010                                                                  
           SET                                                          
           SUBT_AMSU = ((TRUNC((NVL(DCSN_INCM, 0) - NVL(ALRY_PINX, 0) - NVL(DCSN_ITAX, 0))/10) * 10) +           
                                  (TRUNC((NVL(DCSN_INHB, 0) - NVL(ALRY_PHBX, 0) - NVL(DCSN_BTAX, 0))/10) * 10) + (TRUNC((NVL(DCSN_FAFV, 0) - NVL(ALRY_YVTX, 0) - NVL(FAFV_TAXI, 0))/10) * 10))  
                                  , REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')       
          WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#
                         AND SYSTEMKEY=#systemkey#
				]]>
	</update>
	  
	 <!-- 기부금공제 에 따른 기부명세서 작성 이월기부금삭제 해당년도에 해당 없는 자  사용안함 . -->
	 <delete id="infcPkgYeta17Tax_2022_DAO.fnPayr06430_PAYR443_ReTax_2014_CREATE_10_1_Delete">
		<![CDATA[
			 DELETE FROM   YETA3170                                                                        
                       WHERE DPOB_CD=#dpobCd#
                        AND YRTX_BLGG_YR=#yrtxBlggYr#
                        AND CLUT_SEPT_CD=#clutSeptCd#                                                        
                           AND  CTRB_YRMN IN ('2010','2011','2012','2013','2014')                                                  
                           AND  NOT EXISTS ( SELECT SYSTEMKEY                                                   
                                                         FROM   YE161020                                         
                                                         WHERE  YE161020.DPOB_CD=#dpobCd#
                       										 AND YE161020.CLUT_SEPT_CD = #clutSeptCd#                   
                                                              AND  YE161020.YRTX_BLGG_YR =  #yrtxBlggYr#           
                                                              AND   YE161020.SYSTEMKEY = YETA3170.SYSTEMKEY  
                           )   
				]]>
    	</delete>
    	
	 
	  <!-- 테이블 데이타 각 항목에 업데이트 하기  --> 
	 
<select id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_YE169010_Tax_2022_A01_Select" parameterClass="yeta17TaxYe169010Srh_2022" resultClass="egovMap">
      	<![CDATA[
		 SELECT 
			     AC01.DPOB_CD, AC01.YRTX_BLGG_YR, AC01.CLUT_SEPT_CD, 
			     AC01.SYSTEMKEY, AC01.PAYR_MANG_DEPT_CD, AC01.UT_DPOB_CD, 
			     AC01.EMYMT_DIV_CD, AC01.DEPT_CD, AC01.TYP_OCCU_CD, 
			     AC01.DTIL_OCCU_INTTN_CD, AC01.BUSIN_CD, AC01.PERN_CHRG_EMP_IDEN_NUM, 
			     AC01.CLOS_FLAG, AC01.CLOS_CONT, AC01.CLOS_DATE, 
			     AC01.EDAC_PRDT, AC01.ODTY_CD, AC01.PYSP_CD, 
			     AC01.LOG_SVC_YR_NUM_CD, AC01.LOG_SVC_MNTH_ICM_CD, AC01.FRST_EMYMT_DT, 
			     AC01.EMYMT_BGNN_DT, AC01.EMYMT_END_DT, AC01.HDOFC_DIV_CD, 
			     AC01.RETRY_DT, AC01.YRTX_APPTN_YR_MNTH, AC01.YRTX_PRCS_DT
			    ,AC01.YRTX_PRCS_YN
			    ,AC02.FNM                /* 소득자성명                 */ 
			    ,AC02.RESNO_ENC_CNTN            /* 주민등록번호              */ 
			    ,AC02.NNF_CL_CD                /* 내외국인구분          */
			    ,AC02.TNM                /* 근무처명          */
			    ,AC02.BSNO_ENC_CNTN            /* 사업자등록번호          */
			    ,AC02.HSHR_CL_CD            /* 세대주여부         */
			    ,AC02.RSPL_NTN_INFR_NM            /* 국적              */ 
			    , fcBass0300ITEMNM(AC01.DPOB_CD,AC02.RSPL_NTN_INFR_CD,'12') AS RSPL_NTN_INFR_CD           /* 국적코드          */
			    ,AC02.DTY_STRT_DT            /* 근무기간시작일자         */
			    ,AC02.DTY_END_DT            /* 근무기간종료일자         */
			    ,DECODE(NVL(AC02.RE_STRT_DT,'TT'),'TT','00000000',AC02.RE_STRT_DT) AS  RE_STRT_DT            /* 감면기간시작일자         */
			    ,DECODE(NVL(AC02.RE_STRT_DT,'TT'),'TT','00000000',AC02.RE_END_DT) AS  RE_END_DT   /* 감면기간종료일자         */
			    , fcBass0300ITEMNM(AC01.DPOB_CD,AC02.RSDT_CL_CD,'12') AS RSDT_CL_CD             /* 거주구분          */
			    ,AC02.RSPL_NTN_NM            /* 거주지국명         */
			    ,AC02.RSPL_NTN_CD            /* 거주지코드         */
			    ,AC03.YETA_00C6           /*  C6_근로자_종전근무처수                                             */
				,AC03.YETA_00C9           /*  C9_근로자_외국인단일세율적용여부                      */
				,AC03.YETA_0C9A           /*  C9A_근로자_외국법인소속파견근로자여부                         */
				,AC03.YETA_0C15           /*  C15_근로자_연말정산구분코드                      */
				,AC03.YETA_0C22           /*  C22_주현근무처_급여금액                          */
				,AC03.YETA_0C23           /*  C23_주현근무처_상여금액                          */
				,AC03.YETA_0C24           /*  C24_주현근무처_인정상여금액                      */
				,AC03.YETA_0C25           /*  C25_주현근무처_주식매수선택권행사이익금                  */
				,AC03.YETA_0C26           /*  C26_주현근무처_우리사주조합인출금액                      */
				,AC03.YETA_0C27           /*  C27_주현근무처_임원퇴직소득금액한도초과금액                  */
				,AC03.YETA_0C29           /*  C29_주현근무처_소득합계금액                      */
				,AC03.YETA_C30_G01       /*  C30_G01_비과세학자금금액                             */
				,AC03.YETA_C31_H01       /*  C31_H01_무보수위원수당금액                      */
				,AC03.YETA_C32_H05       /*  C32_H05_경호숭선수당금액                             */
				,AC03.YETA_C33_H06       /*  C33_H06_유아초중등소득금액                      */
				,AC03.YETA_C34_H07       /*  C34_H07_고등교육법소득금액                      */
				,AC03.YETA_C35_H08       /*  C35_H08_특별법소득금액                          */
				,AC03.YETA_C36_H09       /*  C36_H09_연구기관등소득금액                      */
				,AC03.YETA_C37_H10       /*  C37_H10_기업부설연구소소득금액                      */
				,AC03.YETA_C38_H14       /*  C38_H14_보육교사근무환경개선금액                      */
				,AC03.YETA_C39_H15       /*  C39_H15_사립유치원교사의인건비금액                      */
				,AC03.YETA_C40_H11       /*  C40_H11_취재수당금액                          */
				,AC03.YETA_C41_H12       /*  C41_H12_벽지수당금액                          */
				,AC03.YETA_C42_H13       /*  C42_H13_재해관련급여소득금액                      */
				,AC03.YETA_C43_H16       /*  C43_H16_정부공공지방이전기관이주수당소득금액                  */
				,AC03.YETA_C44_I01       /*  C44_I01_외국정부등근무자소득금액                      */
				,AC03.YETA_C45_K01       /*  C45_K01_외국주둔군인등소득금액                      */
				,AC03.YETA_C46_M01       /*  C46_M01_국외근로자소득금액_100                      */
				,AC03.YETA_C47_M02       /*  C47_M02_국외근로자소득금액_300                      */
				,AC03.YETA_C48_M03       /*  C48_M03_국외근로자소득금액                      */
				,AC03.YETA_C49_O01       /*  C49_O01_야간근로수당금액                             */
				,AC03.YETA_C50_Q01       /*  C50_Q01_출산보육수당금액                             */
				,AC03.YETA_C51_R10       /*  C51_R10_근로장학금소득금액                      */
				,AC03.YETA_C52_R11       /*  C52_R11_직무발명보상금액                             */
				,AC03.YETA_C53_S01       /*  C53_S01_주식매수선택권소득금액                      */
				,AC03.YETA_C54_T01       /*  C54_T01_외국인기술자소득금액                      */
				,AC03.YETA_C55_Y02       /*  C55_Y02_우리사주조합인출금50_소득금액                  */
				,AC03.YETA_C56_Y03       /*  C56_Y03_우리사주조합인출금75_소득금액                  */
				,AC03.YETA_C56A_Y04       /*  C56A_Y04_우리사주조합인출금100_소득금액                  */
				,AC03.YETA_C56_Y21       /*  C56_Y21_장기미취업자중소기업취업소득금액_삭제                  */
				,AC03.YETA_C57_Y22       /*  C57_Y22_전공의수련보조수당금액                      */
				,AC03.YETA_C58_T10       /*  C58_T10_중소기업취업청년소득세100감면금액                  */
				,AC03.YETA_C58A_T11       /*  C58A_T11_중소기업취업청년소득세50감면금액                  */
				,AC03.YETA_C58B_T12       /*  C58B_T12_중소기업취업청년소득세70감면금액                  */
				,AC03.YETA_C59_T20       /*  C59_T20_조세조약상교직자감면금액                      */
				,AC03.YETA_0C60           /*  C60_비과세합계금액                          */
				,AC03.YETA_0C61           /*  C61_감면소득합계금액                             */
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C63  ,AC03.YETA_0C63    ) AS YETA_0C63                                 
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C64  ,AC03.YETA_0C64    ) AS YETA_0C64         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C65  ,AC03.YETA_0C65    ) AS YETA_0C65         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C66  ,AC03.YETA_0C66    ) AS YETA_0C66         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C67  ,AC03.YETA_0C67    ) AS YETA_0C67         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C68  ,AC03.YETA_0C68    ) AS YETA_0C68         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C69  ,AC03.YETA_0C69    ) AS YETA_0C69         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C70  ,AC03.YETA_0C70    ) AS YETA_0C70         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C71  ,AC03.YETA_0C71    ) AS YETA_0C71         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C72  ,AC03.YETA_0C72    ) AS YETA_0C72         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C73  ,AC03.YETA_0C73    ) AS YETA_0C73         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C74  ,AC03.YETA_0C74    ) AS YETA_0C74         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C75  ,AC03.YETA_0C75    ) AS YETA_0C75         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C76  ,AC03.YETA_0C76    ) AS YETA_0C76         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C77  ,AC03.YETA_0C77    ) AS YETA_0C77         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C78  ,AC03.YETA_0C78    ) AS YETA_0C78         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C79  ,AC03.YETA_0C79    ) AS YETA_0C79         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C80  ,AC03.YETA_0C80    ) AS YETA_0C80         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C81  ,AC03.YETA_0C81    ) AS YETA_0C81         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C82  ,AC03.YETA_0C82    ) AS YETA_0C82         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C83  ,AC03.YETA_0C83    ) AS YETA_0C83         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C84  ,AC03.YETA_0C84    ) AS YETA_0C84         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C85  ,AC03.YETA_0C85    ) AS YETA_0C85         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C86  ,AC03.YETA_0C86    ) AS YETA_0C86         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C87  ,AC03.YETA_0C87    ) AS YETA_0C87         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C88  ,AC03.YETA_0C88    ) AS YETA_0C88         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C89  ,AC03.YETA_0C89    ) AS YETA_0C89         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C90  ,AC03.YETA_0C90    ) AS YETA_0C90         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C91  ,AC03.YETA_0C91    ) AS YETA_0C91         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C92  ,AC03.YETA_0C92    ) AS YETA_0C92         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C93  ,AC03.YETA_0C93    ) AS YETA_0C93         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C94  ,AC03.YETA_0C94    ) AS YETA_0C94         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C96  ,AC03.YETA_0C96    ) AS YETA_0C96         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C97  ,AC03.YETA_0C97    ) AS YETA_0C97         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C98  ,AC03.YETA_0C98    ) AS YETA_0C98         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C99  ,AC03.YETA_0C99    ) AS YETA_0C99         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C100  ,AC03.YETA_C100    ) AS YETA_C100         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C101  ,AC03.YETA_C101    ) AS YETA_C101         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C102  ,AC03.YETA_C102    ) AS YETA_C102         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C103  ,AC03.YETA_C103    ) AS YETA_C103         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C104  ,AC03.YETA_C104    ) AS YETA_C104         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C105  ,AC03.YETA_C105    ) AS YETA_C105         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C107  ,AC03.YETA_C107    ) AS YETA_C107         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C108  ,AC03.YETA_C108    ) AS YETA_C108         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C109  ,AC03.YETA_C109    ) AS YETA_C109
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C109Y ,AC03.YETA_C109Y   ) AS YETA_C109Y         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C110  ,AC03.YETA_C110    ) AS YETA_C110         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C111  ,AC03.YETA_C111    ) AS YETA_C111         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C112  ,AC03.YETA_C112    ) AS YETA_C112         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C113  ,AC03.YETA_C113    ) AS YETA_C113         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C114  ,AC03.YETA_C114    ) AS YETA_C114         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C115  ,AC03.YETA_C115    ) AS YETA_C115         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C116  ,AC03.YETA_C116    ) AS YETA_C116         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C117  ,AC03.YETA_C117    ) AS YETA_C117         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C119  ,AC03.YETA_C119    ) AS YETA_C119         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C120  ,AC03.YETA_C120    ) AS YETA_C120         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C121  ,AC03.YETA_C121    ) AS YETA_C121         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C122  ,AC03.YETA_C122    ) AS YETA_C122         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C123  ,AC03.YETA_C123    ) AS YETA_C123         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C124  ,AC03.YETA_C124    ) AS YETA_C124         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C125  ,AC03.YETA_C125    ) AS YETA_C125         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C126  ,AC03.YETA_C126    ) AS YETA_C126         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C127  ,AC03.YETA_C127    ) AS YETA_C127         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C128  ,AC03.YETA_C128    ) AS YETA_C128         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C129  ,AC03.YETA_C129    ) AS YETA_C129         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C130  ,AC03.YETA_C130    ) AS YETA_C130         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C131  ,AC03.YETA_C131    ) AS YETA_C131         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C132  ,AC03.YETA_C132    ) AS YETA_C132
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C13A  ,AC03.YETA_C13A    ) AS YETA_C13A
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C13B  ,AC03.YETA_C13B    ) AS YETA_C13B         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C133  ,AC03.YETA_C133    ) AS YETA_C133         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C134  ,AC03.YETA_C134    ) AS YETA_C134         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C135  ,AC03.YETA_C135    ) AS YETA_C135         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C136  ,AC03.YETA_C136    ) AS YETA_C136         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C137  ,AC03.YETA_C137    ) AS YETA_C137         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C138  ,AC03.YETA_C138    ) AS YETA_C138         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C139  ,AC03.YETA_C139    ) AS YETA_C139         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C140  ,AC03.YETA_C140    ) AS YETA_C140         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C141  ,AC03.YETA_C141    ) AS YETA_C141         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C142  ,AC03.YETA_C142    ) AS YETA_C142         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C143  ,AC03.YETA_C143    ) AS YETA_C143         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C144  ,AC03.YETA_C144    ) AS YETA_C144         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C145  ,AC03.YETA_C145    ) AS YETA_C145         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C146  ,AC03.YETA_C146    ) AS YETA_C146         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C147  ,AC03.YETA_C147    ) AS YETA_C147         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C148  ,AC03.YETA_C148    ) AS YETA_C148         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C149  ,AC03.YETA_C149    ) AS YETA_C149         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C150  ,AC03.YETA_C150    ) AS YETA_C150         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C150A ,AC03.YETA_C150A    ) AS YETA_C150A       
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C150B ,AC03.YETA_C150B    ) AS YETA_C150B       
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C151  ,AC03.YETA_C151    ) AS YETA_C151         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C152  ,AC03.YETA_C152    ) AS YETA_C152         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C153  ,AC03.YETA_C153    ) AS YETA_C153         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C154  ,AC03.YETA_C154    ) AS YETA_C154         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C155  ,AC03.YETA_C155    ) AS YETA_C155         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C156  ,AC03.YETA_C156    ) AS YETA_C156         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C157  ,AC03.YETA_C157    ) AS YETA_C157         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C158  ,AC03.YETA_C158    ) AS YETA_C158         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C159  ,AC03.YETA_C159    ) AS YETA_C159         
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C160  ,AC03.YETA_C160    ) AS YETA_C160           
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C161  ,AC03.YETA_C161    ) AS YETA_C161           
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C162  ,AC03.YETA_C162    ) AS YETA_C162           
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C163  ,AC03.YETA_C163    ) AS YETA_C163           
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C164  ,AC03.YETA_C164    ) AS YETA_C164           
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C165  ,AC03.YETA_C165    ) AS YETA_C165           
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C166  ,AC03.YETA_C166    ) AS YETA_C166           
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C167  ,AC03.YETA_C167    ) AS YETA_C167           
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C168  ,AC03.YETA_C168    ) AS YETA_C168           
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C169  ,AC03.YETA_C169    ) AS YETA_C169           
			,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C170  ,AC03.YETA_C170    ) AS YETA_C170     
			
			,(DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C127  ,AC03.YETA_C127    )         
			 + DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C129  ,AC03.YETA_C129    )        
			 + DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C131  ,AC03.YETA_C131    )) AS PNSN_ACC_DDC_TRGT_AMT_SUM        
            
           ,  (DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C128  ,AC03.YETA_C128    )     
            + DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C130  ,AC03.YETA_C130    )  
            + DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C132  ,AC03.YETA_C132    )) AS PNSN_ACC_DDC_AMT_SUM    
		
			,(DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C84  ,AC03.YETA_0C84    )        
			 + DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C85  ,AC03.YETA_0C85    )        
			 + DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C86  ,AC03.YETA_0C86    )          
			 + DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C87  ,AC03.YETA_0C87    )           
			 + DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C88  ,AC03.YETA_0C88    )         
			 + DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C89  ,AC03.YETA_0C89    )         
			 + DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C90  ,AC03.YETA_0C90    )      
			 + DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C91  ,AC03.YETA_0C91    )          
			 + DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C92  ,AC03.YETA_0C92    )       
			 + DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C93  ,AC03.YETA_0C93    ) 
             ) AS HSNG_FNDS_DDC_AMT_SUM
        
            , (DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C100  ,AC03.YETA_C100    )        
		  	 + DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C101  ,AC03.YETA_C101    )        
			 + DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C102  ,AC03.YETA_C102    ) ) AS HSNG_INC_DDC_AMT_SUM 
		
			, (DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C133  ,AC03.YETA_C133    ) 
			 + DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C135  ,AC03.YETA_C135    )  ) AS INFEE_PYM_DDC_TRGT_AMT_SUM 
			,( DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C134  ,AC03.YETA_C134)          
			+ DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C136  ,AC03.YETA_C136  )) AS INFEE_PYM_DDC_AMT_SUM
			
			,(DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C142  ,AC03.YETA_C142    )        
			 + DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C144  ,AC03.YETA_C144    )            
			 + DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C146  ,AC03.YETA_C146    )       
			 + DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C148  ,AC03.YETA_C148    )       
			 + DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C150  ,AC03.YETA_C150    )          
			 + DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C150B ,AC03.YETA_C150B    )        ) AS CONB_DDC_AMT_SUM
			,AC05.UT_DPOB_NM        /* 단위사업장명           */
			,AC05.DEGTR_RESN_REGN_NUM    /* 대표자주민번호         */
			,AC05.DEGTR_NM            /* 대표자명           */
			,AC05.FRGNR_DIV_CD        /* 내외국인구분코드          */
			,AC05.BUSOPR_RGSTN_NUM        /* 사업자등록번호          */
			,AC05.CORP_RGSTN_NUM        /* 법인등록번호            */
			,AC05.UNT_DPOB_ZPCD        /* 단위사업장우편번호           */
			,AC05.UNT_DPOB_FNDTN_ADDR    /* 단위사업장기본주소           */
			,AC05.UNT_DPOB_DTL_PATR_ADDR    /* 단위사업장상세주소       */
			,AC05.UP_DPOB_UTYN_C171        /* C171_사업자단위과세자여부     */
			,AC05.MTST_DPOB_SEIL_NUM_C172    /* C172_종사업장일련번호   */
			FROM YE161010  AC01
			    ,YE161020  AC02
			    ,YE169010  AC03
			    ,YE169010A AC04 
			    ,BASS0120  AC05 
			     WHERE AC01.DPOB_CD=#dpobCd#
                AND AC01.YRTX_BLGG_YR=#yrtxBlggYr#
                AND AC01.CLUT_SEPT_CD=#clutSeptCd#
                 AND AC01.SYSTEMKEY=#systemkey# 
			 
			  AND AC01.DPOB_CD      = AC02.DPOB_CD
			  AND AC01.YRTX_BLGG_YR = AC02.YRTX_BLGG_YR
			  AND AC01.CLUT_SEPT_CD = AC02.CLUT_SEPT_CD
			  AND AC01.SYSTEMKEY    = AC02.SYSTEMKEY  
			  AND AC01.DPOB_CD      = AC03.DPOB_CD
			  AND AC01.YRTX_BLGG_YR = AC03.YRTX_BLGG_YR
			  AND AC01.CLUT_SEPT_CD = AC03.CLUT_SEPT_CD
			  AND AC01.SYSTEMKEY    = AC03.SYSTEMKEY     
			  AND AC01.DPOB_CD      = AC04.DPOB_CD(+)
			  AND AC01.YRTX_BLGG_YR = AC04.YRTX_BLGG_YR(+)
			  AND AC01.CLUT_SEPT_CD = AC04.CLUT_SEPT_CD(+)
			  AND AC01.SYSTEMKEY    = AC04.SYSTEMKEY(+) 
			  AND AC01.DPOB_CD      = AC05.DPOB_CD(+) 
			  AND AC01.UT_DPOB_CD   = AC05.UT_DPOB_CD(+)  
                          
		]]>
	</select>		 
	 

    <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_Ye161060_Tax_2022_I1_Update">
		<![CDATA[
			 	UPDATE YE161060
			SET    
				  BRW_LNPB_SRM_DDC_AMT=#brwLnpbSrmDdcAmt#
				, RSDT_LNPB_SRM_DDC_AMT=#rsdtLnpbSrmDdcAmt#
				, LTH_YR15_BLW_DDC_AMT=#lthYr15BlwDdcAmt#
				, LTH_YR29_DDC_AMT=#lthYr29DdcAmt#
				, LTH_Y30_OVER_DDC_AMT=#lthY30OverDdcAmt#
				, LTH_YR2012_AFTH_Y15_DDC_AMT=#lthYr2012AfthY15DdcAmt#
				, LTH_YR2012_ETC_BRW_DDC_AMT=#lthYr2012EtcBrwDdcAmt#
				, LTH_YR2015_AFTH_FXN_IR_DDC_AMT=#lthYr2015AfthFxnIrDdcAmt#
				, LTH_YR2015_AFTH_Y15_DDC_AMT=#lthYr2015AfthY15DdcAmt#
				, LTH_YR2015_AFTH_ETC_DDC_AMT=#lthYr2015AfthEtcDdcAmt#
				, LTH_YR2015_AFTH_YR15_DDC_AMT=#lthYr2015AfthYr15DdcAmt# 
				, HSNG_FNDS_DDC_AMT_SUM = #hsngFndsDdcAmtSum#
				, CONB_DDC_AMT_SUM=#conbDdcAmtSum# 
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
						WHERE DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
								AND SYSTEMKEY=#systemkey#
				]]>
	</update>

   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_Ye161070_Tax_2022_I2_Update">
		<![CDATA[
			 	UPDATE YE161070
			SET    YR2000_PNSN_SVNG_DDC_AMT=#yr2000PnsnSvngDdcAmt#
				, SMCE_SBIZ_DDC_AMT=#smceSbizDdcAmt#
				, SBC_SVNG_DDC_AMT=#sbcSvngDdcAmt#
				, LBRR_PRPT_SVNG_DDC_AMT=#lbrrPrptSvngDdcAmt#
				, HSNG_SVNG_DDC_AMT=#hsngSvngDdcAmt#
				, HSNG_INC_DDC_AMT_SUM=#hsngIncDdcAmtSum#  
				, IVCP_INVM_DDC_AMT_SUM=#ivcpInvmDdcAmtSum# 
				, RDC_SUM_DDC_AMT=#rdcSumDdcAmt# 
				, EMST_ASCT_CNTR_DDC_AMT=#emstAsctCntrDdcAmt#
				, EMP_MNTN_SNMC_DDC_AMT=#empMntnSnmcDdcAmt#
				, LTRM_CNI_SS_DDC_AMT=#ltrmCniSsDdcAmt#	 
				, LTRM_CNI_YY_DDC_AMT=#ltrmCniYyDdcAmt# 
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
						WHERE DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
								AND SYSTEMKEY=#systemkey#
				]]>
	</update>

    	 
														 
   
   <update id="infcPkgYeta17Tax_2022_DAO.fnYeta7300_Ye161080_Tax_2022_I3_Update">
		<![CDATA[
			 	UPDATE YE161080
			SET   											 
				  SCTC_HP_DDC_TRGT_AMT=#sctcHpDdcTrgtAmt#
				, SCTC_HP_DDC_AMT=#sctcHpDdcAmt#
				, RTPN_DDC_TRGT_AMT=#rtpnDdcTrgtAmt#
				, RTPN_DDC_AMT=#rtpnDdcAmt#
				, PNSN_SVNG_DDC_TRGT_AMT=#pnsnSvngDdcTrgtAmt#
				, PNSN_SVNG_DDC_AMT=#pnsnSvngDdcAmt# 
				, CVRG_INSC_DDC_TRGT_AMT2=#cvrgInscDdcTrgtAmt2#
				, CVRG_INSC_DDC_AMT=#cvrgInscDdcAmt#
				, DSBR_EU_CVRG_DDC_TRGT_AMT=#dsbrEuCvrgDdcTrgtAmt#
				, DSBR_EU_CVRG_DDC_AMT=#dsbrEuCvrgDdcAmt# 
				, SCXPS_DDC_TRGT_AMT_SUM=#scxpsDdcTrgtAmtSum#
				, SCXPS_DDC_AMT_SUM=#scxpsDdcAmtSum#
				
				 ,INFEE_PYM_DDC_TRGT_AMT_SUM = #infeePymDdcTrgtAmtSum#
           		 ,INFEE_PYM_DDC_AMT_SUM  = #infeePymDdcAmtSum# 		
																
				, CONB10TTSW_LT_DDC_TRGT_AMT=#conb10ttswLtDdcTrgtAmt#
				, CONB10TTSW_LT_DDC_AMT=#conb10ttswLtDdcAmt#
				, CONB10EXCS_LT_DDC_TRGT_AMT=#conb10excsLtDdcTrgtAmt#
				, CONB10EXCS_LT_DDC_AMT=#conb10excsLtDdcAmt# 
				, CONB_EMST_ASCT_DDC_TRGT_AMT=#conbEmstAsctDdcTrgtAmt#
	 
				, HSNG_TENN_LNPB_DDC_AMT=#hsngTennLnpbDdcAmt#  
				, CONB_DDC_AMT_SUM=#conbDdcAmtSum#
				, MMR_DDC_AMT=#mmrDdcAmt#
				,PNSN_ACC_DDC_TRGT_AMT_SUM = #pnsnAccDdcTrgtAmtSum#
                ,PNSN_ACC_DDC_AMT_SUM = #pnsnAccDdcAmtSum#
                ,ISA_DDC_TRGT_AMT_SUM = #isaDdcTrgtAmtSum#
                ,ISA_DDC_AMT_SUM = #isaDdcAmtSum#
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
						WHERE DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
								AND SYSTEMKEY=#systemkey#
				]]>
	</update>

</sqlMap>
