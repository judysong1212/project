<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="PkgInfcYe17TaFile_2023">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/> 
	
	<typeAlias  alias="infcFile17Ye161010_2023" type="com.app.smrmf.infc.yearendtax.server.vo.yeta2023.InfcPkgYe161010_2023_VO"/>
	<typeAlias  alias="infcFile17Ye161020_2023" type="com.app.smrmf.infc.yearendtax.server.vo.yeta2023.InfcPkgYe161020_2023_VO"/>
	<typeAlias  alias="infcFile17Ye161055_2023" type="com.app.smrmf.infc.yearendtax.server.vo.yeta2023.InfcPkgYe161055_2023_VO"/>
	<typeAlias  alias="infcFile17Ye161050_2023" type="com.app.smrmf.infc.yearendtax.server.vo.yeta2023.InfcPkgYe161050_2023_VO"/>
	<typeAlias  alias="infcFile17Ye169010_2023" type="com.app.smrmf.infc.yearendtax.server.vo.yeta2023.InfcPkgYe169010_2023_VO"/>
	<typeAlias  alias="infcFile17Ye165030Srh_2023_Vo" type="com.app.smrmf.infc.yearendtax.server.vo.yeta2023.InfcPkgYe165030Srh_2023_VO"/> 
	<typeAlias  alias="infcFile17Ye169010Srh_2023" type="com.app.smrmf.infc.yearendtax.server.vo.yeta2023.InfcPkgYe169010Srh_2023_VO"/>
	  
	<resultMap id="infcFile17Ye161005_2023" class="com.app.smrmf.infc.yearendtax.server.vo.yeta2023.InfcPkgYe161005_2023_VO">
		<result property="dpobCd" 					column="DPOB_CD" 					columnIndex="1"/>		
		<result property="yrtxBlggYr" 				column="YRTX_BLGG_YR" 				columnIndex="2"/>
		<result property="clutSeptCd" 				column="CLUT_SEPT_CD" 				columnIndex="3"/>
		<result property="whdgTxRegrstDeptCd"		column="WHDG_TX_REGRST_DEPT_CD" 	columnIndex="4"/>	
		<result property="hhrkWhdgRegrstDeptCd" 	column="HHRK_WHDG_REGRST_DEPT_CD" 	columnIndex="5"/>
		<result property="txOffcCd" 				column="TX_OFFC_CD" 				columnIndex="6"/>
		<result property="pentrSeptCd" 				column="PENTR_SEPT_CD" 				columnIndex="7"/>
		<result property="txDeptyMangeNum" 			column="TX_DEPTY_MANGE_NUM" 		columnIndex="8"/>
		<result property="hmtxId" 					column="HMTX_ID" 					columnIndex="9"/>
		<result property="txPgmCd" 					column="TX_PGM_CD" 					columnIndex="10"/>
		<result property="busoprRgstnum" 			column="BUSOPR_RGSTNUM" 			columnIndex="11"/>
		<result property="corpFmnmNm"				column="CORP_FMNM_NM" 				columnIndex="12"/>
		<result property="pernChrgDeptNm" 			column="PERN_CHRG_DEPT_NM" 			columnIndex="13"/>
		<result property="pernChrgNm" 				column="PERN_CHRG_NM" 				columnIndex="14"/>
		<result property="pernChrgPhnNum" 			column="PERN_CHRG_PHN_NUM" 			columnIndex="15"/>
		<result property="useHanCd" 				column="USE_HAN_CD" 				columnIndex="16"/>
		<result property="sumtTgtPridCd" 			column="SUMT_TGT_PRID_CD" 			columnIndex="17"/>
		<result property="corpNum" 					column="CORP_NUM" 					columnIndex="18"/>
		<result property="incmPost" 				column="INCM_POST" 					columnIndex="19"/>
		<result property="incmAddr" 				column="INCM_ADDR" 					columnIndex="20"/>
		<result property="incmAdtl" 				column="INCM_ADTL" 					columnIndex="21"/>
		<result property="kybdr" 					column="KYBDR" 						columnIndex="22"/>
		<result property="inptDt" 					column="INPT_DT" 					columnIndex="23"/>
		<result property="inptAddr" 				column="INPT_ADDR" 					columnIndex="24"/>
		<result property="ismt" 					column="ISMT" 						columnIndex="25"/>
		<result property="revnDt" 					column="REVN_DT" 					columnIndex="26"/>
		<result property="revnAddr" 				column="REVN_ADDR" 					columnIndex="27"/>
		<result property="reprName" 				column="REPR_NAME" 					columnIndex="28"/>
		<result property="resuNumb" 				column="RESU_NUMB" 					columnIndex="29"/>
		<result property="yetaC171" 				column="YETA_C171" 					columnIndex="30"/>
		<result property="yetaC172" 				column="YETA_C172" 					columnIndex="31"/> 
	</resultMap>
	
	<select id="infcPkgYeta17File_2023_DAO.selectYe161005_S" resultMap="infcFile17Ye161005_2023">
		<![CDATA[
			SELECT 
				DPOB_CD
				, WHDG_TX_REGRST_DEPT_CD
				, HHRK_WHDG_REGRST_DEPT_CD
				, TX_OFFC_CD
				, PENTR_SEPT_CD
				, TX_DEPTY_MANGE_NUM
				, HMTX_ID
				, TX_PGM_CD				
				, BUSOPR_RGSTNUM
				, CORP_FMNM_NM
				, PERN_CHRG_DEPT_NM
				, PERN_CHRG_NM
				, PERN_CHRG_PHN_NUM
				, USE_HAN_CD
				, SUMT_TGT_PRID_CD
				, CORP_NUM
				, INCM_POST
				, INCM_ADDR
				, INCM_ADTL
				, KYBDR
				, INPT_DT
				, INPT_ADDR
				, ISMT
				, REVN_DT
				, REVN_ADDR
				, REPR_NAME	 
				, RESU_NUMB	 
				, YETA_C171	 
				, YETA_C172	 
				, YRTX_BLGG_YR	
				, CLUT_SEPT_CD	
			FROM YE161005 	
		   WHERE DPOB_CD=#dpobCd# 
			 AND YRTX_BLGG_YR=#yrtxBlggYr#
			 AND CLUT_SEPT_CD=#clutSeptCd#
			 AND WHDG_TX_REGRST_DEPT_CD=#utDpobCd#
				]]>
	</select>
	
	
 
   <!-- 근로소득지급명세서  B레코드 -->
   <select id="infcPkgYeta17File_2023_DAO.fnPayrB_ReTax_Total_Select" parameterClass="infcFile17Ye161020_2023" resultClass="egovMap">
          <![CDATA[
          
          SELECT
                  ANGG.DPOB_CD
			     , ANGG.YRTX_BLGG_YR
			     , ANGG.CLUT_SEPT_CD 
			    ,   SUM(ANGG.PSNL_JU_CNT) AS PSNL_JU_CNT 
			    , SUM(ANGG.PSNL_JUNG_CNT) AS  PSNL_JUNG_CNT   
			    ,ANGG.TNM                /* 근무처명          */
			    ,ANGG.BSNO_ENC_CNTN      /* 사업자등록번호          */
			 
			,SUM(NVL(ANGG.YETA_0C63,0)) AS  YETA_0C63          /*  C63_정산명세_총급여금액   */ 
			,SUM(NVL(ANGG.YETA_C159,0)) AS  YETA_C159          /*  C159_결정세액_소득세금액   */
			,SUM(NVL(ANGG.YETA_C160,0)) AS  YETA_C160          /*  C160_결정세액_지방소득세금액   */
			,SUM(NVL(ANGG.YETA_C161,0)) AS  YETA_C161            /*  C161_결정세액_농특세금액    */
			,SUM(NVL(ANGG.YETA_SUM_ALL,0)) AS YETA_SUM_ALL
			,ANGG.UT_DPOB_NM        /* 단위사업장명           */
			,ANGG.DEGTR_RESN_REGN_NUM    /* 대표자주민번호         */
			,ANGG.DEGTR_NM            /* 대표자명           */
			,ANGG.FRGNR_DIV_CD        /* 내외국인구분코드          */
			,ANGG.BUSOPR_RGSTN_NUM        /* 사업자등록번호          */
			,ANGG.CORP_RGSTN_NUM        /* 법인등록번호            */
			,ANGG.UNT_DPOB_ZPCD        /* 단위사업장우편번호           */
			,ANGG.UNT_DPOB_FNDTN_ADDR    /* 단위사업장기본주소           */
			,ANGG.UNT_DPOB_DTL_PATR_ADDR    /* 단위사업장상세주소       */
			,ANGG.UP_DPOB_UTYN_C171   
			,ANGG.MTST_DPOB_SEIL_NUM_C172    /* C172_종사업장일련번호   */
          FROM  
          (SELECT 
			       AC01.DPOB_CD
			     , AC01.YRTX_BLGG_YR
			     , AC01.CLUT_SEPT_CD 
			    ,   (SELECT COUNT (AIN01.SYSTEMKEY) AS PSNL_JU_CNT FROM YE161020 AIN01
			         WHERE AIN01.DPOB_CD = AC01.DPOB_CD
			           AND AIN01.YRTX_BLGG_YR = AC01.YRTX_BLGG_YR
			           AND AIN01.CLUT_SEPT_CD = AC01.CLUT_SEPT_CD 
			           AND AIN01.SYSTEMKEY = AC01.SYSTEMKEY) AS PSNL_JU_CNT 
			        , (SELECT COUNT (PRCSP_BUSOPR_RGSTNUM) AS PSNL_JUNG_CNT 
			            FROM YE160404 AIN02
			            WHERE AIN02.DPOB_CD = AC01.DPOB_CD
			           AND AIN02.YRTX_BLGG_YR = AC01.YRTX_BLGG_YR
			           AND AIN02.CLUT_SEPT_CD = AC01.CLUT_SEPT_CD 
			           AND AIN02.SYSTEMKEY = AC01.SYSTEMKEY)
			         AS   PSNL_JUNG_CNT   
			    ,AC02.TNM                /* 근무처명          */
			    ,AC02.BSNO_ENC_CNTN      /* 사업자등록번호          */
			 
			,(NVL(DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C63  ,AC03.YETA_0C63),0)) AS YETA_0C63           /*  C63_정산명세_총급여금액   */ 
			,(NVL(DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C159  ,AC03.YETA_C159),0)) AS YETA_C159           /*  C159_결정세액_소득세금액   */
			,(NVL(DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C160  ,AC03.YETA_C160),0)) AS YETA_C160           /*  C160_결정세액_지방소득세금액   */
			,(NVL(DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C161  ,AC03.YETA_C161),0)) AS YETA_C161           /*  C161_결정세액_농특세금액    */
			,(NVL(DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C159  ,AC03.YETA_C159),0)
			     + NVL(DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C160  ,AC03.YETA_C160),0) 
			     + NVL(DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C161  ,AC03.YETA_C161),0)) AS YETA_SUM_ALL
			,AC05.UT_DPOB_NM        /* 단위사업장명           */
			,AC05.DEGTR_RESN_REGN_NUM    /* 대표자주민번호         */
			,AC05.DEGTR_NM            /* 대표자명           */
			,AC05.FRGNR_DIV_CD        /* 내외국인구분코드          */
			,AC05.BUSOPR_RGSTN_NUM        /* 사업자등록번호          */
			,AC05.CORP_RGSTN_NUM        /* 법인등록번호            */
			,AC05.UNT_DPOB_ZPCD        /* 단위사업장우편번호           */
			,AC05.UNT_DPOB_FNDTN_ADDR    /* 단위사업장기본주소           */
			,AC05.UNT_DPOB_DTL_PATR_ADDR    /* 단위사업장상세주소       */
			,DECODE(AC05.UP_DPOB_UTYN_C171,'Y','1','2')  AS  UP_DPOB_UTYN_C171   
			,AC05.MTST_DPOB_SEIL_NUM_C172    /* C172_종사업장일련번호   */
			FROM YE161010  AC01
			    ,YE161020  AC02
			    ,YE169010  AC03
			    ,YE169010A AC04 
			    ,BASS0120  AC05 
			    , (   SELECT      DISTINCT      AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,(SELECT ( PSNL0111.HUS_ROAD_NM_FNDTN_ADDR || ' ' || PSNL0111.HUS_ROAD_NM_DTL_PATR_ADDR )
                                                 FROM PSNL0111  
                                                WHERE PSNL0111.DPOB_CD  = AD02.DPOB_CD
                                                  AND PSNL0111.SYSTEMKEY = AD02.SYSTEMKEY)  AS ADDR_POST   /* 소득자주소 */ 
                                              ,(SELECT  PSNL0111.HUS_PHN_NUM 
                                                 FROM PSNL0111  
                                                WHERE PSNL0111.DPOB_CD  = AD02.DPOB_CD
                                                  AND PSNL0111.SYSTEMKEY = AD02.SYSTEMKEY)  AS HUS_PHN_NUM             /* 집전화번호 */         
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT 
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01, (SELECT
											DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
											   PAY_CD,  PAYR_MANG_DEPT_CD, 
											   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
											   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
											     ODTY_CD, PYSP_CD, 
											     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
											   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
											   HDOFC_DIV_CD, RETRY_DT 
											FROM
											(SELECT 
											   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
											   PAY_CD,  PAYR_MANG_DEPT_CD, 
											   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
											   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
											     ODTY_CD, PYSP_CD, 
											     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
											   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
											   HDOFC_DIV_CD, RETRY_DT 
											FROM  PAYR0304 
											UNION ALL
											SELECT 
											   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY, (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
											   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
											   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
											   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
											   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
											   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
											   HDOFC_DIV_CD, RETRY_DT 
											FROM  PYYT0304)) AD02,
                                                (                                                        SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY 
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                    SELECT   MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                             ) 
									                                          GROUP BY  DPOB_CD,    SYSTEMKEY     
									                                            ) MM  
									                                          
									                                             ) GG
									                            WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                                 /*     AND NN.PAYR_SEIL_NUM = GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%' 
          ) TA01 
			WHERE  AC01.DPOB_CD     = AC02.DPOB_CD
			  AND AC01.YRTX_BLGG_YR = AC02.YRTX_BLGG_YR
			  AND AC01.CLUT_SEPT_CD = AC02.CLUT_SEPT_CD
			  AND AC01.SYSTEMKEY    = AC02.SYSTEMKEY
			  AND AC01.DPOB_CD     = TA01.DPOB_CD
			  AND AC01.SYSTEMKEY    = TA01.SYSTEMKEY  
			  AND AC01.DPOB_CD      = AC03.DPOB_CD
			  AND AC01.YRTX_BLGG_YR = AC03.YRTX_BLGG_YR
			  AND AC01.CLUT_SEPT_CD = AC03.CLUT_SEPT_CD
			  AND AC01.SYSTEMKEY    = AC03.SYSTEMKEY     
			  AND AC01.DPOB_CD      = AC04.DPOB_CD(+)
			  AND AC01.YRTX_BLGG_YR = AC04.YRTX_BLGG_YR(+)
			  AND AC01.CLUT_SEPT_CD = AC04.CLUT_SEPT_CD(+)
			  AND AC01.SYSTEMKEY    = AC04.SYSTEMKEY(+)  
			  AND  AC01.DPOB_CD         = #dpobCd# 
			  AND AC01.YRTX_BLGG_YR = #yrtxBlggYr#
			  AND AC01.CLUT_SEPT_CD = #clutSeptCd# 
			    AND AC01.DPOB_CD      = AC05.DPOB_CD(+) 
			  AND AC01.UT_DPOB_CD   = AC05.UT_DPOB_CD(+) 
			  	]]>
             			 <isNotEmpty prepend="AND" property="busoprRgstnum" >
							AC05.BUSOPR_RGSTN_NUM(+) = #busoprRgstnum#
				    	</isNotEmpty> 
                       <isNotEmpty prepend="AND"  property="utDpobCd" >  
							AC01.UT_DPOB_CD=#utDpobCd# 
	          			</isNotEmpty>  
	        			 <isNotEmpty prepend="AND" property="systemkey" >
         						AC01.SYSTEMKEY=#systemkey#
    					 </isNotEmpty> 
    					   AND EXISTS  (  SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (  SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#, #yrtxBlggYr#)) ) C 
                                    WHERE     C.DPOB_CD = TA01.DPOB_CD
                                        AND C.DEPT_CD = TA01.DEPT_CD
                                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(TA01.TYP_OCCU_CD,'TT') 
                                        AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(TA01.DTIL_OCCU_INTTN_CD,'TT')
                                         <isNotEmpty property="deptCd" prepend="AND">
                                        <![CDATA[
                                         C.DEPT_CD
                                        ]]>
                                        <iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
                                         #deptCdArr[]#
                                        </iterate>
                                        </isNotEmpty>  
                                  ) 
                       <isNotEmpty property="businCd" prepend="AND">
            <![CDATA[
              TA01.BUSIN_CD
            ]]>
            <iterate prepend="IN" property="businCdArr" open="(" close=")" conjunction=",">
             #businCdArr[]#
            </iterate>
            </isNotEmpty> 
               <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                 TA01.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
               </isNotEmpty> 
               <isNotEmpty prepend="AND" property="emymtDivCd" >
                 TA01.EMYMT_DIV_CD=#emymtDivCd#
                 </isNotEmpty>  
             <isNotEmpty property="typOccuCd" prepend="AND">
            <![CDATA[
             TA01.TYP_OCCU_CD
            ]]>
            <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
             #typOccuCdArr[]#
            </iterate>
            </isNotEmpty>  
                  
            <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
                <![CDATA[
                     TA01.DTIL_OCCU_INTTN_CD
                ]]>
                <iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
                     #dtilOccuInttnCdArr[]#
                </iterate> 
          </isNotEmpty> 
          ) ANGG
           GROUP BY   ANGG.DPOB_CD
			        , ANGG.YRTX_BLGG_YR
			        , ANGG.CLUT_SEPT_CD   
			    ,ANGG.TNM                
			    ,ANGG.BSNO_ENC_CNTN       
			,ANGG.UT_DPOB_NM        
			,ANGG.DEGTR_RESN_REGN_NUM    
			,ANGG.DEGTR_NM            
			,ANGG.FRGNR_DIV_CD        
			,ANGG.BUSOPR_RGSTN_NUM       
			,ANGG.CORP_RGSTN_NUM        
			,ANGG.UNT_DPOB_ZPCD        
			,ANGG.UNT_DPOB_FNDTN_ADDR    
			,ANGG.UNT_DPOB_DTL_PATR_ADDR     
			,ANGG.UP_DPOB_UTYN_C171        
			,ANGG.MTST_DPOB_SEIL_NUM_C172             
          
    </select>
     
	<!--  //c레코드 주현근무처 레코드 fnPayrC_ReTax_Total_Select -->
   <select id="infcPkgYeta17File_2023_DAO.fnPayrC_ReTax_Total_Select" parameterClass="infcFile17Ye161020_2023" resultClass="egovMap">       
        <![CDATA[  
	  SELECT 
	       AC01.DPOB_CD
	     , AC01.YRTX_BLGG_YR
	     , AC01.CLUT_SEPT_CD
	     , AC01.SYSTEMKEY  
	     , AC01.PAYR_MANG_DEPT_CD
	     , AC01.UT_DPOB_CD
	     , TA01.EMYMT_DIV_CD
	     , TA01.DEPT_CD
	     , TA01.TYP_OCCU_CD
	     , TA01.DTIL_OCCU_INTTN_CD
	     , TA01.BUSIN_CD
	     , AC01.PERN_CHRG_EMP_IDEN_NUM
	     , AC01.CLOS_FLAG
	     , AC01.CLOS_CONT
	     , AC01.CLOS_DATE, 
	     AC01.EDAC_PRDT, TA01.ODTY_CD, TA01.PYSP_CD, 
	     TA01.LOG_SVC_YR_NUM_CD, TA01.LOG_SVC_MNTH_ICM_CD, TA01.FRST_EMYMT_DT, 
	     TA01.EMYMT_BGNN_DT, TA01.EMYMT_END_DT, TA01.HDOFC_CODTN_CD, 
	     TA01.RETRY_DT, AC01.YRTX_APPTN_YR_MNTH, AC01.YRTX_PRCS_DT
	    ,AC01.YRTX_PRCS_YN
	    ,AC02.FNM                /* 소득자성명                 */ 
	    ,AC02.RESNO_ENC_CNTN            /* 주민등록번호              */ 
	    ,AC02.NNF_CL_CD                /* 내외국인구분          */
	    ,AC02.TNM                /* 근무처명          */
	    ,AC02.BSNO_ENC_CNTN            /* 사업자등록번호          */
	    ,AC02.HSHR_CL_CD            /* 세대주여부         */
	    ,AC02.RSPL_NTN_INFR_NM            /* 국적              */ 
	    ,fcBass0300ITEMNM(AC01.DPOB_CD,AC02.RSPL_NTN_INFR_CD,'12') AS RSPL_NTN_INFR_CD           /* 국적코드          */
	    
	    , ( CASE WHEN DECODE((SELECT HDOFC_CODTN_CD  FROM  PSNL0100 
	                              WHERE  PSNL0100.SYSTEMKEY =  AC02.SYSTEMKEY
	                                AND  PSNL0100.DPOB_CD = AC02.DPOB_CD),'A0030020','2','1')  = '1' THEN 
	           ( CASE WHEN (DECODE(NVL(AC02.DTY_END_DT,''),'','20221231',AC02.DTY_END_DT)) < '20221231' THEN '2' ELSE '1' END) ELSE '2' END) AS HOOF_STCD  /*연말정산구분코드 */
	           
	    ,DECODE(NVL(AC02.DTY_STRT_DT,''),'','20220101',AC02.DTY_STRT_DT)AS DTY_STRT_DT    /* 근무기간시작일자 */
	    ,DECODE(NVL(AC02.DTY_END_DT,''),'','20221231',AC02.DTY_END_DT)AS DTY_END_DT    /* 근무기간종료일자 */   
	    ,DECODE(NVL(AC02.RE_STRT_DT,'TT'),'TT','00000000',AC02.RE_STRT_DT) AS  RE_STRT_DT            /* 감면기간시작일자         */
	    ,DECODE(NVL(AC02.RE_STRT_DT,'TT'),'TT','00000000',AC02.RE_END_DT) AS  RE_END_DT   /* 감면기간종료일자         */
	    , fcBass0300ITEMNM(AC01.DPOB_CD,AC02.RSDT_CL_CD,'12') AS RSDT_CL_CD             /* 거주구분          */
	    ,AC02.RSPL_NTN_NM            /* 거주지국명         */
	    ,AC02.RSPL_NTN_CD            /* 거주지코드         */
	    ,AC03.YETA_00C6           /*  C6_근로자_종전근무처수                                             */
		,DECODE(AC03.YETA_00C9,'Y','1','2') AS YETA_00C9            /*  C9_근로자_외국인단일세율적용여부                      */
		,AC03.YETA_0C9A           /*  C9A_근로자_외국법인소속파견근로자여부                         */
		,AC03.YETA_0C15           /*  C15_근로자_연말정산구분코드                      */
		,AC03.YETA_0C22           /*  C22_주현근무처_급여금액                          */
		,AC03.YETA_0C23           /*  C23_주현근무처_상여금액                          */
		,AC03.YETA_0C24           /*  C24_주현근무처_인정상여금액                      */
		,AC03.YETA_0C25           /*  C25_주현근무처_주식매수선택권행사이익금                  */
		,AC03.YETA_0C26           /*  C26_주현근무처_우리사주조합인출금액                      */
		,AC03.YETA_0C27           /*  C27_주현근무처_임원퇴직소득금액한도초과금액                  */
		,AC03.YETA_0C29           /*  C29_주현근무처_소득합계금액                      */
		,AC03.YETA_C30_G01       /*  C30_G01_비과세학자금금액                             */
		,AC03.YETA_C31_H01       /*  C31_H01_무보수위원수당금액                      */
		,AC03.YETA_C32_H05       /*  C32_H05_경호숭선수당금액                             */
		,AC03.YETA_C33_H06       /*  C33_H06_유아초중등소득금액                      */
		,AC03.YETA_C34_H07       /*  C34_H07_고등교육법소득금액                      */
		,AC03.YETA_C35_H08       /*  C35_H08_특별법소득금액                          */
		,AC03.YETA_C36_H09       /*  C36_H09_연구기관등소득금액                      */
		,AC03.YETA_C37_H10       /*  C37_H10_기업부설연구소소득금액                      */
		,AC03.YETA_C38_H14       /*  C38_H14_보육교사근무환경개선금액                      */
		,AC03.YETA_C39_H15       /*  C39_H15_사립유치원교사의인건비금액                      */
		,AC03.YETA_C40_H11       /*  C40_H11_취재수당금액                          */
		,AC03.YETA_C41_H12       /*  C41_H12_벽지수당금액                          */
		,AC03.YETA_C42_H13       /*  C42_H13_재해관련급여소득금액                      */
		,AC03.YETA_C43_H16       /*  C43_H16_정부공공지방이전기관이주수당소득금액                  */
		,AC03.YETA_C44_I01       /*  C44_I01_외국정부등근무자소득금액                      */
		,AC03.YETA_C45_K01       /*  C45_K01_외국주둔군인등소득금액                      */
		,AC03.YETA_C46_M01       /*  C46_M01_국외근로자소득금액_100                      */
		,AC03.YETA_C47_M02       /*  C47_M02_국외근로자소득금액_300                      */
		,AC03.YETA_C48_M03       /*  C48_M03_국외근로자소득금액                      */
		,AC03.YETA_C49_O01       /*  C49_O01_야간근로수당금액                             */
		,AC03.YETA_C50_Q01       /*  C50_Q01_출산보육수당금액                             */
		,AC03.YETA_C51_R10       /*  C51_R10_근로장학금소득금액                      */
		,AC03.YETA_C52_R11       /*  C52_R11_직무발명보상금액                             */
		,AC03.YETA_C53_S01       /*  C53_S01_주식매수선택권소득금액                      */
		,AC03.YETA_C54_T01       /*  C54_T01_외국인기술자소득금액                      */
		,AC03.YETA_C55_Y02       /*  C55_Y02_우리사주조합인출금50_소득금액                  */
		,AC03.YETA_C56_Y03       /*  C56_Y03_우리사주조합인출금75_소득금액                  */
		,AC03.YETA_C56A_Y04       /*  C56A_Y04_우리사주조합인출금100_소득금액                  */
		,AC03.YETA_C56_Y21       /*  C56_Y21_장기미취업자중소기업취업소득금액_삭제                  */
		,AC03.YETA_C57_Y22       /*  C57_Y22_전공의수련보조수당금액                      */
		,AC03.YETA_C58_T10       /*  C58_T10_중소기업취업청년소득세100감면금액                  */
		,AC03.YETA_C58A_T11       /*  C58A_T11_중소기업취업청년소득세50감면금액                  */
		,AC03.YETA_C58B_T12       /*  C58B_T12_중소기업취업청년소득세70감면금액                  */
		,AC03.YETA_C59_T20       /*  C59_T20_조세조약상교직자감면금액                      */
		,(
		AC03.YETA_C30_G01      
		+ AC03.YETA_C31_H01      
		+ AC03.YETA_C32_H05      
		+ AC03.YETA_C33_H06      
		+ AC03.YETA_C34_H07      
		+ AC03.YETA_C35_H08      
		+ AC03.YETA_C36_H09      
		+ AC03.YETA_C37_H10      
		+ AC03.YETA_C38_H14      
		+ AC03.YETA_C39_H15      
		+ AC03.YETA_C40_H11      
		+ AC03.YETA_C41_H12      
		+ AC03.YETA_C42_H13      
		+ AC03.YETA_C43_H16      
		+ AC03.YETA_C44_I01      
		+ AC03.YETA_C45_K01      
		+ AC03.YETA_C46_M01      
		+ AC03.YETA_C47_M02      
		+ AC03.YETA_C48_M03      
		+ AC03.YETA_C49_O01      
		+ AC03.YETA_C50_Q01      
		+ AC03.YETA_C51_R10      
		+ AC03.YETA_C52_R11      
		+ AC03.YETA_C53_S01 
		+ AC03.YETA_C55_Y02      
		+ AC03.YETA_C56_Y03      
		+ AC03.YETA_C56A_Y04     
		+ AC03.YETA_C56_Y21      
		+ AC03.YETA_C57_Y22  
		) AS YETA_0C60           /*  C60_비과세합계금액                          */
		, (
		 AC03.YETA_C54_T01
		+ AC03.YETA_C58_T10      
		+ AC03.YETA_C58A_T11     
		+ AC03.YETA_C58B_T12     
		+ AC03.YETA_C59_T20 
		) AS YETA_0C61           /*  C61_감면소득합계금액                             */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C63  ,AC03.YETA_0C63    ) AS YETA_0C63           /*  C63_정산명세_총급여금액                          */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C64  ,AC03.YETA_0C64    ) AS YETA_0C64           /*  C64_정산명세_근로소득공제금액                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C65  ,AC03.YETA_0C65    ) AS YETA_0C65           /*  C65_정산명세_근로소득금액                          */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C66  ,AC03.YETA_0C66    ) AS YETA_0C66           /*  C66_기본공제_본인공제금액                          */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C67  ,AC03.YETA_0C67    ) AS YETA_0C67           /*  C67_기본공제_배우자공제금액                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C68  ,AC03.YETA_0C68    ) AS YETA_0C68           /*  C68_기본공제_부양공제인원수                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C69  ,AC03.YETA_0C69    ) AS YETA_0C69           /*  C69_기본공제_부양공제금액                          */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C70  ,AC03.YETA_0C70    ) AS YETA_0C70           /*  C70_추가공제_경로우대공제인원수                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C71  ,AC03.YETA_0C71    ) AS YETA_0C71           /*  C71_추가공제_경로우대공제금액                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C72  ,AC03.YETA_0C72    ) AS YETA_0C72           /*  C72_추가공제_장애인공제인원수                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C73  ,AC03.YETA_0C73    ) AS YETA_0C73           /*  C73_추가공제_장애인공제금액                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C74  ,AC03.YETA_0C74    ) AS YETA_0C74           /*  C74_추가공제_부녀자공제금액                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C75  ,AC03.YETA_0C75    ) AS YETA_0C75           /*  C75_추가공제_한부모가족공제금액                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C76  ,AC06.PNSN_INFEE_USE_AMT_SUM) AS YETA_0C76Y      /* C76Y_연금보험료_국민연금보험료납입금액 */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C76  ,AC03.YETA_0C76    ) AS YETA_0C76           /*  C76_연금보험료_국민연금보험료공제금액                         */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C77  ,AC03.YETA_0C77    ) AS YETA_0C77           /*  C77_연금보험료_공적연금보험료공제_공무원연금                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C78  ,AC03.YETA_0C78    ) AS YETA_0C78           /*  C78_연금보험료_공적연금보험료공제_군인연금                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C79  ,AC03.YETA_0C79    ) AS YETA_0C79           /*  C79_연금보험료_공적연금보험료공제_사립학교교직원연금              */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C80  ,AC03.YETA_0C80    ) AS YETA_0C80           /*  C80_연금보험료_공적연금보험료공제_별정우체국연금                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C81  ,AC03.YETA_0C81    ) AS YETA_0C81           /*  C81_특별소득공제_보험료_건강보험료                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C82  ,AC03.YETA_0C82    ) AS YETA_0C82           /*  C82_특별소득공제_보험료_고용보험료                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C83  ,AC03.YETA_0C83    ) AS YETA_0C83           /*  C83_특별소득공제_주택자금_추택임차차입금_대출기관                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C84  ,AC03.YETA_0C84    ) AS YETA_0C84           /*  C84_특별소득공제_주택자금_주택임차차입금_거주자                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C85  ,AC03.YETA_0C85    ) AS YETA_0C85           /*  C85_특별소득공제_주택자금_장기주택저당차입금2011전_15미만              */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C86  ,AC03.YETA_0C86    ) AS YETA_0C86           /*  C86_특별소득공제_주택자금_장기주택저당차입금2011전_15_29              */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C87  ,AC03.YETA_0C87    ) AS YETA_0C87           /*  C87_특별소득공제_주택자금_장기주택저당차입금2011전_30이상              */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C88  ,AC03.YETA_0C88    ) AS YETA_0C88           /*  C88_특별소득공제_차입분2012후_15이상_고정금리비거치식상환대출금액          */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C89  ,AC03.YETA_0C89    ) AS YETA_0C89           /*  C89_특별소득공제_차입분2012후_15이상_기타대출금액              */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C90  ,AC03.YETA_0C90    ) AS YETA_0C90           /*  C90_특별소득공제_차입분2015후_상환15이상_고정금리이고비거치상환대출금액      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C91  ,AC03.YETA_0C91    ) AS YETA_0C91           /*  C91_특별소득공제_차입분2015후_상환15이상_고정금리이거나비거치상환대출금액      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C92  ,AC03.YETA_0C92    ) AS YETA_0C92           /*  C92_특별소득공제_차입분2015후_상환15이상_그밖의대출금액              */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C93  ,AC03.YETA_0C93    ) AS YETA_0C93           /*  C93_특별소득공제_차입분2015후_상환10이상_고정금리이거나비거치상환대출금액      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C94  ,AC03.YETA_0C94    ) AS YETA_0C94           /*  C94_특별소득공제_기부금_이월분금액                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C96  ,AC03.YETA_0C96    ) AS YETA_0C96           /*  C96_특별소득공제_특별소득공제합계                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C97  ,AC03.YETA_0C97    ) AS YETA_0C97           /*  C97_차감소득금액                          */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C98  ,AC03.YETA_0C98    ) AS YETA_0C98           /*  C98_기타소득공제_개인연금저축소득공제금액                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_0C99  ,AC03.YETA_0C99    ) AS YETA_0C99           /*  C99_기타소득공제_소기업소상공인공제부금금액                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C100  ,AC03.YETA_C100    ) AS YETA_C100           /*  C100_기타소득공제_주택마련저축소득공제_청약저축금액              */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C101  ,AC03.YETA_C101    ) AS YETA_C101           /*  C101_기타소득공제_주택마련저축소득공제_주택청약종합저축금액              */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C102  ,AC03.YETA_C102    ) AS YETA_C102           /*  C102_기타소득공제_주택마련저축소득공제_근로자주택마련저축금액          */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C103  ,AC03.YETA_C103    ) AS YETA_C103           /*  C103_기타소득공제_투자조합출자등소득공제금액                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C104  ,AC03.YETA_C104    ) AS YETA_C104           /*  C104_기타소득공제_신용카드등소득공제금액                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C105  ,AC03.YETA_C105    ) AS YETA_C105           /*  C105_기타소득공제_우리사주조합출연금액                     */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C107  ,AC03.YETA_C107    ) AS YETA_C107           /*  C107_기타소득공제_고용유지중소기업근로자소득공제금액              */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C108  ,AC03.YETA_C108    ) AS YETA_C108           /*  C108_기타소득공제_목돈안이자상환공제금액                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C109  ,AC03.YETA_C109    ) AS YETA_C109           /*  C109_기타소득공제_장기집합투자증권저축금액                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C109Y ,AC03.YETA_C109Y   ) AS YETA_C109Y          /*  C109_기타소득공제_청년형장기집합투자증권저축금액                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C110  ,AC03.YETA_C110    ) AS YETA_C110           /*  C110_기타소득공제합계금액                          */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C111  ,AC03.YETA_C111    ) AS YETA_C111           /*  C111_소득공제종합한도초과금액                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C112  ,AC03.YETA_C112    ) AS YETA_C112           /*  C112_종합소득과세표준금액                          */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C113  ,AC03.YETA_C113    ) AS YETA_C113           /*  C113_산출세액                              */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C114  ,AC03.YETA_C114    ) AS YETA_C114           /*  C114_세액감면_소득세법감면금액                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C115  ,AC03.YETA_C115    ) AS YETA_C115           /*  C115_세액감면_조특법_조세조약제외_감면금액                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C116  ,AC03.YETA_C116    ) AS YETA_C116           /*  C116_세액감면_조특범30조_감면금액                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C117  ,AC03.YETA_C117    ) AS YETA_C117           /*  C117_세액감면_조세조약감면금액                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C119  ,AC03.YETA_C119    ) AS YETA_C119           /*  C119_세액감면합계금액                             */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C120  ,AC03.YETA_C120    ) AS YETA_C120           /*  C120_세액공제_근로소득세액공제금액                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C121  ,AC03.YETA_C121    ) AS YETA_C121           /*  C121_세액공제_자녀세액공제인원수                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C122  ,AC03.YETA_C122    ) AS YETA_C122           /*  C122_세액공제_자녀세액공제금액                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C123  ,AC03.YETA_C123    ) AS YETA_C123           /*  C123_세액공제_6세이하자녀세액공제인원수                     */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C124  ,AC03.YETA_C124    ) AS YETA_C124           /*  C124_세액공제_6세이하자녀세액공제금액                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C125  ,AC03.YETA_C125    ) AS YETA_C125           /*  C125_세액공제_출산입양세액공제인원수                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C126  ,AC03.YETA_C126    ) AS YETA_C126           /*  C126_세액공제_출산입양세액공제금액                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C127  ,AC03.YETA_C127    ) AS YETA_C127           /*  C127_세액공제_연금계좌_과학기술인공제공제대상금액                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C128  ,AC03.YETA_C128    ) AS YETA_C128           /*  C128_세액공제_연금계좌_과학기술인공제세액공제금액                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C129  ,AC03.YETA_C129    ) AS YETA_C129           /*  C129_세액공제_연금계좌_퇴직급여세액공제대상금액                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C130  ,AC03.YETA_C130    ) AS YETA_C130           /*  C130_세액공제_연금계좌_퇴직급여세액공제금액                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C131  ,AC03.YETA_C131    ) AS YETA_C131           /*  C131_세액공제_연금계좌_연금저축공제대상금액                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C132  ,AC03.YETA_C132    ) AS YETA_C132           /*  C132_세액공제_연금계좌_연금저축세액공제금액                  */
		
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C13A  ,AC03.YETA_C13A    ) AS YETA_C13A           /*  C13A_세액공제_ISA공제대상금액                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C13B  ,AC03.YETA_C13B    ) AS YETA_C13B           /*  C13B_세액공제_ISA세액공제금액                  */
		
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C133  ,AC03.YETA_C133    ) AS YETA_C133           /*  C133_세액공제_특별세액공제_보장성보험공제대상금액                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C134  ,AC03.YETA_C134    ) AS YETA_C134           /*  C134_세액공제_특별세액공제_보장성보럼세액공제금액                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C135  ,AC03.YETA_C135    ) AS YETA_C135           /*  C135_세액공제_특별세액공제_장애인전용공제대상금액                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C136  ,AC03.YETA_C136    ) AS YETA_C136           /*  C136_세액공제_특별세액공제_장애인전용세액공제금액                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C137  ,AC03.YETA_C137    ) AS YETA_C137           /*  C137_세액공제_특별세액공제_의료비공제대상금액                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C138  ,AC03.YETA_C138    ) AS YETA_C138           /*  C138_세액공제_특별세액공제_의료비세액공제금액                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C139  ,AC03.YETA_C139    ) AS YETA_C139           /*  C139_세액공제_특별세액공제_교육비공제대상금액                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C140  ,AC03.YETA_C140    ) AS YETA_C140           /*  C140_세액공제_특별세액공제_교육비세액공제금액                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C142  ,AC03.YETA_C142    ) AS YETA_C142           /*  C142_세액공제_특별세액공제_기부금정치자금10만이하세액공제금액          */
		,CASE WHEN YETA_C142 = 0 
			  THEN 0 
			  ELSE
			  (DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C141  ,AC03.YETA_C141)) END AS YETA_C141	/*  C141_세액공제_특별세액공제_기부금정치자금10만이하공제대상금액          */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C144  ,AC03.YETA_C144    ) AS YETA_C144           /*  C144_세액공제_특별세액공제_기부금정치자금10만초과세액공제금액          */
		,CASE WHEN YETA_C144 = 0 
			  THEN 0 
			  ELSE 
			  (DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C143  ,AC03.YETA_C143)) END AS YETA_C143	/*  C143_세액공제_특별세액공제_기부금정치자금10만초과공제대상금액          */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C146  ,AC03.YETA_C146    ) AS YETA_C146           /*  C146_세액공제_특별세액공제_법정기부금세액공제금액                  */
		,CASE WHEN YETA_C146 = 0 
			  THEN 0 
			  ELSE
			  (DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C145  ,AC03.YETA_C145)) END AS YETA_C145   	/*  C145_세액공제_특별세액공제_법정기부금공제대상금액                  */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C148  ,AC03.YETA_C148    ) AS YETA_C148           /*  C148_세액공제_특별세액공제_우리사주조합기부금세액공제금액              */
		,CASE WHEN YETA_C148 = 0 
			  THEN 0 
			  ELSE
			  (DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C147  ,AC03.YETA_C147)) END AS YETA_C147    /*  C147_세액공제_특별세액공제_우리사주조합기부금공제대상금액              */
		
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C150  ,AC03.YETA_C150    ) AS YETA_C150           /*  C150_세액공제_특별세액공제_지정기부금_종교단체외세액공제금액              */
		,CASE WHEN YETA_C150 = 0 
			  THEN 0 
			  ELSE
			  (DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C149  ,AC03.YETA_C149)) END AS YETA_C149    /*  C149_세액공제_특별세액공제_지정기부금_종교단체외공제대상금액              */
		
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C150B ,AC03.YETA_C150B    ) AS YETA_C150B       	/*  C150B_세액공제_특별세액공제_지정기부금_종교단체세액공제금액              */
		,CASE WHEN YETA_C150B = 0 
			  THEN 0 
			  ELSE
			  (DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C150A ,AC03.YETA_C150A)) END AS YETA_C150A  /*  C150A_세액공제_특별세액공제_지정기부금_종교단체공제대상금액              */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C151  ,AC03.YETA_C151    ) AS YETA_C151           /*  C151_세액공제_특별세액공제합계금액                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C152  ,AC03.YETA_C152    ) AS YETA_C152           /*  C152_세액공제_표준세액공제금액                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C153  ,AC03.YETA_C153    ) AS YETA_C153           /*  C153_세액공제_납세조합공제금액                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C154  ,AC03.YETA_C154    ) AS YETA_C154           /*  C154_세액공제_주택차입금금액                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C155  ,AC03.YETA_C155    ) AS YETA_C155           /*  C155_세액공제_외국납부금액                          */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C156  ,AC03.YETA_C156    ) AS YETA_C156           /*  C156_세액공제_월세세액공제대상금액                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C157  ,AC03.YETA_C157    ) AS YETA_C157           /*  C157_세액공제_월세세액공제금액                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C158  ,AC03.YETA_C158    ) AS YETA_C158           /*  C158_세액공제합계금액                             */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C159  ,AC03.YETA_C159    ) AS YETA_C159           /*  C159_결정세액_소득세금액                          */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C160  ,AC03.YETA_C160    ) AS YETA_C160           /*  C160_결정세액_지방소득세금액                     */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C161  ,AC03.YETA_C161    ) AS YETA_C161           /*  C161_결정세액_농특세금액                       */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C162  ,AC03.YETA_C162    ) AS YETA_C162           /*  C162_주현근무지_기납부세액_소득세금액                */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C163  ,AC03.YETA_C163    ) AS YETA_C163           /*  C163_주현근무지_기납부세액_지방소득세금액              */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C164  ,AC03.YETA_C164    ) AS YETA_C164           /*  C164_주현근무지_기납부세액_농특세금액                */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C165  ,AC03.YETA_C165    ) AS YETA_C165           /*  C165_납부특례세액_소득세금액                      */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C166  ,AC03.YETA_C166    ) AS YETA_C166           /*  C166_납부특례세액_지방소득세금액                    */
		,DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C167  ,AC03.YETA_C167    ) AS YETA_C167           /*  C167_납부특례세액_농특세금액                      */
		,(CASE WHEN DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C168  ,AC03.YETA_C168) < 0 THEN   1  ELSE 0 END) AS SUBT_ETAXB   
		,(CASE WHEN DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C168  ,AC03.YETA_C168) < 0 
		       THEN (DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C168  ,AC03.YETA_C168) * -1)  
		       ELSE DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C168  ,AC03.YETA_C168 )  END) AS YETA_C168       /* column 차감징수_소득세 : SUBT_ETAX */                                                                                                                                
		,(CASE WHEN DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C169  ,AC03.YETA_C169 ) < 0 THEN   1  ELSE 0 END) AS SUBT_INHBB 
		,(CASE WHEN DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C169  ,AC03.YETA_C169 ) < 0 
		       THEN (DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C169  ,AC03.YETA_C169 ) * -1)  
		       ELSE DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C169  ,AC03.YETA_C169 ) END) AS YETA_C169    /* column 차감징수_주민세_지방소득세 : SUBT_INHB */
		
		,(CASE WHEN DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C170  ,AC03.YETA_C170 ) < 0 THEN   1  ELSE 0 END) AS SUBT_FAFVB                                           
		,(CASE WHEN DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C170  ,AC03.YETA_C170 ) < 0 
		       THEN   (DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C170  ,AC03.YETA_C170 ) * -1)   
		       ELSE DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C170  ,AC03.YETA_C170 ) END) AS YETA_C170  /* column 차감징수_농특세 : SUBT_FAFV */    
		 
		
		,(CASE WHEN (NVL( DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C168  ,AC03.YETA_C168 ),0)
     				+ NVL(DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C169  ,AC03.YETA_C169 ),0) 
     				+ NVL(DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C170  ,AC03.YETA_C170 ),0)) < 0 THEN   1  ELSE 0 END) AS SUBT_AMSUB                                              
		,(CASE WHEN (NVL( DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C168  ,AC03.YETA_C168 ),0)
     				+ NVL(DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C169  ,AC03.YETA_C169 ),0) 
     				+ NVL(DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C170  ,AC03.YETA_C170 ),0)) < 0 
		       THEN   ((NVL( DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C168  ,AC03.YETA_C168 ),0)
     				+ NVL(DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C169  ,AC03.YETA_C169 ),0) 
     				+ NVL(DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C170  ,AC03.YETA_C170 ),0))  * -1) 
		     ELSE (NVL( DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C168  ,AC03.YETA_C168 ),0)
     				+ NVL(DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C169  ,AC03.YETA_C169 ),0) 
     				+ NVL(DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC04.YETA_STD_C170  ,AC03.YETA_C170 ),0)) END) AS  SUBT_AMSU  /* column 차감징수_세액계 : SUBT_AMSU */    
		        
		,AC05.UT_DPOB_NM        /* 단위사업장명           */
		,AC05.DEGTR_RESN_REGN_NUM    /* 대표자주민번호         */
		,AC05.DEGTR_NM            /* 대표자명           */
		,AC05.FRGNR_DIV_CD        /* 내외국인구분코드          */
		,AC05.BUSOPR_RGSTN_NUM        /* 사업자등록번호          */
		,AC05.CORP_RGSTN_NUM        /* 법인등록번호            */
		,AC05.UNT_DPOB_ZPCD        /* 단위사업장우편번호           */
		,AC05.UNT_DPOB_FNDTN_ADDR    /* 단위사업장기본주소           */
		,AC05.UNT_DPOB_DTL_PATR_ADDR    /* 단위사업장상세주소       */
		,DECODE(AC05.UP_DPOB_UTYN_C171,'Y','1','2')  AS  UP_DPOB_UTYN_C171         /* C171_사업자단위과세자여부     */
		,AC05.MTST_DPOB_SEIL_NUM_C172    /* C172_종사업장일련번호   */
		FROM YE161010  AC01
		    ,YE161020  AC02
		    ,YE169010  AC03
		    ,YE169010A AC04 
		    ,BASS0120  AC05 
		    ,YE161050  AC06
		    , (   SELECT      DISTINCT      AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,(SELECT ( PSNL0111.HUS_ROAD_NM_FNDTN_ADDR || ' ' || PSNL0111.HUS_ROAD_NM_DTL_PATR_ADDR )
                                                 FROM PSNL0111  
                                                WHERE PSNL0111.DPOB_CD  = AD02.DPOB_CD
                                                  AND PSNL0111.SYSTEMKEY = AD02.SYSTEMKEY)  AS ADDR_POST   /* 소득자주소 */ 
                                              ,(SELECT  PSNL0111.HUS_PHN_NUM 
                                                 FROM PSNL0111  
                                                WHERE PSNL0111.DPOB_CD  = AD02.DPOB_CD
                                                  AND PSNL0111.SYSTEMKEY = AD02.SYSTEMKEY)  AS HUS_PHN_NUM             /* 집전화번호 */         
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT 
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01, (SELECT
											DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
											   PAY_CD,  PAYR_MANG_DEPT_CD, 
											   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
											   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
											     ODTY_CD, PYSP_CD, 
											     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
											   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
											   HDOFC_DIV_CD, RETRY_DT 
											FROM
											(SELECT 
											   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
											   PAY_CD,  PAYR_MANG_DEPT_CD, 
											   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
											   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
											     ODTY_CD, PYSP_CD, 
											     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
											   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
											   HDOFC_DIV_CD, RETRY_DT 
											FROM  PAYR0304 
											UNION ALL
											SELECT 
											   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY, (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
											   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
											   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
											   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
											   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
											   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
											   HDOFC_DIV_CD, RETRY_DT 
											FROM  PYYT0304)) AD02,
                                                (                                                        SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY 
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                    SELECT   MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                             ) 
									                                          GROUP BY  DPOB_CD,    SYSTEMKEY     
									                                            ) MM  
									                                          
									                                             ) GG
									                            WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                                 /*     AND NN.PAYR_SEIL_NUM = GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%' 
          ) TA01 
		WHERE  AC01.DPOB_CD      = AC02.DPOB_CD
		  AND AC01.YRTX_BLGG_YR = AC02.YRTX_BLGG_YR
		  AND AC01.CLUT_SEPT_CD = AC02.CLUT_SEPT_CD
		  AND AC01.SYSTEMKEY    = AC02.SYSTEMKEY 
		  AND AC01.DPOB_CD      = TA01.DPOB_CD
		  AND AC01.SYSTEMKEY    = TA01.SYSTEMKEY 
		  AND AC01.DPOB_CD      = AC03.DPOB_CD
		  AND AC01.YRTX_BLGG_YR = AC03.YRTX_BLGG_YR
		  AND AC01.CLUT_SEPT_CD = AC03.CLUT_SEPT_CD
		  AND AC01.SYSTEMKEY    = AC03.SYSTEMKEY  
		  AND AC01.DPOB_CD      = AC06.DPOB_CD
		  AND AC01.YRTX_BLGG_YR = AC06.YRTX_BLGG_YR
		  AND AC01.CLUT_SEPT_CD = AC06.CLUT_SEPT_CD
		  AND AC01.SYSTEMKEY    = AC06.SYSTEMKEY   
		  AND AC01.DPOB_CD      = AC04.DPOB_CD(+)
		  AND AC01.YRTX_BLGG_YR = AC04.YRTX_BLGG_YR(+)
		  AND AC01.CLUT_SEPT_CD = AC04.CLUT_SEPT_CD(+)
		  AND AC01.SYSTEMKEY    = AC04.SYSTEMKEY(+) 
		  AND AC01.DPOB_CD      = AC05.DPOB_CD(+) 
		  AND AC01.UT_DPOB_CD   = AC05.UT_DPOB_CD(+) 
		  AND AC01.DPOB_CD        = #dpobCd# 
		  AND AC01.YRTX_BLGG_YR = #yrtxBlggYr#
		  AND AC01.CLUT_SEPT_CD = #clutSeptCd#     
		     ]]>                  
		       <isNotEmpty prepend="AND" property="busoprRgstnum" >
		                            AC05.BUSOPR_RGSTN_NUM(+) = #busoprRgstnum#
		                        </isNotEmpty> 
		            <isNotEmpty prepend="AND"  property="utDpobCd" >  
							AC01.UT_DPOB_CD=#utDpobCd# 
	          			</isNotEmpty>           
       <isNotEmpty prepend="AND" property="systemkey" >
         AC01.SYSTEMKEY=#systemkey#
     </isNotEmpty> 
         AND EXISTS  (
                   SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (  SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#, #yrtxBlggYr#)) ) C
                                    WHERE     C.DPOB_CD = TA01.DPOB_CD
                                        AND C.DEPT_CD = TA01.DEPT_CD
                                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(TA01.TYP_OCCU_CD,'TT') 
                                        AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(TA01.DTIL_OCCU_INTTN_CD,'TT')
                                         <isNotEmpty property="deptCd" prepend="AND">
                                        <![CDATA[
                                         C.DEPT_CD
                                        ]]>
                                        <iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
                                         #deptCdArr[]#
                                        </iterate>
                                        </isNotEmpty>  
                                  ) 
                    <isNotEmpty property="businCd" prepend="AND">
            <![CDATA[
              TA01.BUSIN_CD
            ]]>
            <iterate prepend="IN" property="businCdArr" open="(" close=")" conjunction=",">
             #businCdArr[]#
            </iterate>
            </isNotEmpty> 
               <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                 TA01.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
               </isNotEmpty> 
               <isNotEmpty prepend="AND" property="emymtDivCd" >
                 TA01.EMYMT_DIV_CD=#emymtDivCd#
                 </isNotEmpty>  
             <isNotEmpty property="typOccuCd" prepend="AND">
            <![CDATA[
             TA01.TYP_OCCU_CD
            ]]>
            <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
             #typOccuCdArr[]#
            </iterate>
            </isNotEmpty>  
                  
            <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
                <![CDATA[
                     TA01.DTIL_OCCU_INTTN_CD
                ]]>
                <iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
                     #dtilOccuInttnCdArr[]#
                </iterate> 
          </isNotEmpty>   
           ORDER BY AC02.FNM ASC
	</select>	 
	 
    
	
   <select id="infcPkgYeta17File_2023_DAO.fnPayrD_ReTax_Total_Select" parameterClass="infcFile17Ye161020_2023" resultClass="egovMap">       
   <![CDATA[
   SELECT 
       AC01.DPOB_CD
     , AC01.YRTX_BLGG_YR
     , AC01.CLUT_SEPT_CD
     , AC01.SYSTEMKEY  
     ,AC02.FNM                /* 소득자성명                 */ 
     ,AC02.RESNO_ENC_CNTN     /* 주민등록번호              */  
     ,AC02.TNM                /* 근무처명          */
     ,AC02.BSNO_ENC_CNTN      /* 사업자등록번호          */
     ,AC03.PRCSP_SEIL_NUM            /* D4_종전근무처일련번호                */
     ,AC03.RESN_REGN_NUM            /* D7_소득자주민등록번호           */
     ,AC03.PRCSP_TXPYR_ASOC_YN        /* D8_종전근무처납세조합여부           */
     ,AC03.PRCSP_FMNM_NM            /* D9_종전근무처법인_상호명           */
     ,AC03.PRCSP_BUSOPR_RGSTNUM        /* D10_종전근무처사업자등록번호           */
    , DECODE(NVL(AC03.PRCSP_DUTY_BGNN_DT,''),'','00000000',AC03.PRCSP_DUTY_BGNN_DT) AS PRCSP_DUTY_BGNN_DT        /* D11_종전근무처근무시간시작일자      */
    , DECODE(NVL(AC03.PRCSP_DUTY_END_DT,''),'','00000000',AC03.PRCSP_DUTY_END_DT) AS PRCSP_DUTY_END_DT        /* D12_종전근무처근무시간종료일자      */
    , DECODE(NVL(AC03.PRCSP_REDU_BGNN_DT,''),'','00000000',AC03.PRCSP_REDU_BGNN_DT) AS PRCSP_REDU_BGNN_DT        /* D13_종전근무처감면기간시작일자      */
    , DECODE(NVL(AC03.PRCSP_REDU_END_DT,''),'','00000000',AC03.PRCSP_REDU_END_DT) AS PRCSP_REDU_END_DT        /* D14_종전근무처감면기간종료일자      */
    , NVL(AC03.PRCSP_PAY_SUM ,0) AS PRCSP_PAY_SUM           /* D15_종전근무처급여금액           */
    , NVL(AC03.PRCSP_ALLW_BNUS_SUM ,0) AS PRCSP_ALLW_BNUS_SUM        /* D16_종전근무처상여금액           */
    , NVL(AC03.PRCSP_RCGTN_BNUS_SUM ,0) AS PRCSP_RCGTN_BNUS_SUM        /* D17_종전근무처인정상여금액           */
    , NVL(AC03.PRCSP_STCK_EVNT_PRFT_SUM  ,0) AS PRCSP_STCK_EVNT_PRFT_SUM   /* D18_종전근무처주식매수선택권행사이익금액       */
    , NVL(AC03.PRCSP_EMP_STKSC_WDRW_SUM ,0) AS PRCSP_EMP_STKSC_WDRW_SUM    /* D19_종전근무처우리사주조합인출금액       */
    , NVL(AC03.PRCSP_ECTE_RSGTN_EXCE_SUM ,0) AS PRCSP_ECTE_RSGTN_EXCE_SUM    /* D20_종전근무처임원퇴직소득한도초과금액       */
    , NVL(AC03.PRCSP_AGGR_SUM ,0) AS PRCSP_AGGR_SUM           /* D22_종전근무처합계금액           */
    , NVL(AC03.FREE_DTY_AGGR_SUM ,0) AS FREE_DTY_AGGR_SUM        /* D53_비과세합계금액           */
    , NVL(AC03.REDU_INCM_AGGR_SUM ,0) AS REDU_INCM_AGGR_SUM        /* D54_감면소득합계금액          */
    , NVL(AC03.PRCSP_INCM_TX_SUM ,0) AS  PRCSP_INCM_TX_SUM       /* D56_종전근무지기납부세액_소득세금액       */
    , NVL(AC03.PRCSP_RGON_INCM_TX_SUM ,0) AS PRCSP_RGON_INCM_TX_SUM        /* D57_종전근무지기납부세액_지방소득세금액       */
    , NVL(AC03.PRCSP_NNKS_SUM ,0) AS PRCSP_NNKS_SUM            /* D58_종전근무지기납부세액_농특세금액       */
    ,( NVL(AC03.PRCSP_INCM_TX_SUM,0)  + NVL(AC03.PRCSP_RGON_INCM_TX_SUM,0)  + NVL(AC03.PRCSP_NNKS_SUM,0))  AS FARM_BTOT
    , NVL(AC03.PRCSP_HLTH_PRMM_SUM,0) AS PRCSP_HLTH_PRMM_SUM        /* 종전근무지건강보험료금액           */
    ,NVL(AC03.PRCSP_LGTM_RCPTN_SUM,0) AS  PRCSP_LGTM_RCPTN_SUM       /* 종전근무지장기요양보험료금액           */
    ,NVL(AC03.PRCSP_HLTH_LGCPTN_AGGR,0) AS PRCSP_HLTH_LGCPTN_AGGR        /* 종전근무지건강장기요양보험료합계금액       */
    ,NVL(AC03.PRCSP_HLTH_PRMM_DDUC_SUM,0) AS PRCSP_HLTH_PRMM_DDUC_SUM    /* 종전근무지건강보험료공제금액           */
    ,NVL(AC03.PRCSP_EMYMT_PRMM_SUM,0) AS  PRCSP_EMYMT_PRMM_SUM       /* 종전근무지고용보험료금액           */
    ,NVL(AC03.PRCSP_EMYT_PRMM_DDUC_SUM,0) AS PRCSP_EMYT_PRMM_DDUC_SUM    /* 종전근무지고용보험료공제금액           */ 
    ,NVL(AC04.TAXM_SA01_JONG,0) AS  TAXM_SA01_JONG  /* 비과세소득_A01_종전  */
    ,NVL(AC04.TAXM_SB01_JONG,0) AS  TAXM_SB01_JONG  /* 비과세소득_B01_종전  */
    ,NVL(AC04.TAXM_SC01_JONG,0) AS  TAXM_SC01_JONG  /* 비과세소득_C01_종전  */
    ,NVL(AC04.TAXM_SD01_JONG,0) AS  TAXM_SD01_JONG  /* 비과세소득_D01_종전  */
    ,NVL(AC04.TAXM_SE01_JONG,0) AS  TAXM_SE01_JONG  /* 비과세소득_E01_종전  */
    ,NVL(AC04.TAXM_SE02_JONG,0) AS  TAXM_SE02_JONG  /* 비과세소득_E02_종전  */
    ,NVL(AC04.TAXM_SE10_JONG,0) AS  TAXM_SE10_JONG  /* 비과세소득_E10_종전  */
    ,NVL(AC04.TAXM_SF01_JONG,0) AS  TAXM_SF01_JONG  /* 비과세소득_F01_종전  */
    ,NVL(AC04.TAXM_SG01_JONG,0) AS  TAXM_SG01_JONG  /* 비과세소득_G01_종전  */
    ,NVL(AC04.TAXM_SH01_JONG,0) AS  TAXM_SH01_JONG  /* 비과세소득_H01_종전  */
    ,NVL(AC04.TAXM_SH02_JONG,0) AS  TAXM_SH02_JONG  /* 비과세소득_H02_종전  */
    ,NVL(AC04.TAXM_SH03_JONG,0) AS  TAXM_SH03_JONG  /* 비과세소득_H03_종전  */
    ,NVL(AC04.TAXM_SH04_JONG,0) AS  TAXM_SH04_JONG  /* 비과세소득_H04_종전  */
    ,NVL(AC04.TAXM_SH05_JONG,0) AS  TAXM_SH05_JONG  /* 비과세소득_H05_종전  */
    ,NVL(AC04.TAXM_SH06_JONG,0) AS  TAXM_SH06_JONG  /* 비과세소득_H06_종전  */
    ,NVL(AC04.TAXM_SH07_JONG,0) AS  TAXM_SH07_JONG  /* 비과세소득_H07_종전  */
    ,NVL(AC04.TAXM_SH08_JONG,0) AS  TAXM_SH08_JONG  /* 비과세소득_H08_종전  */
    ,NVL(AC04.TAXM_SH09_JONG,0) AS  TAXM_SH09_JONG  /* 비과세소득_H09_종전  */
    ,NVL(AC04.TAXM_SH10_JONG,0) AS  TAXM_SH10_JONG  /* 비과세소득_H10_종전  */
    ,NVL(AC04.TAXM_SH14_JONG,0) AS  TAXM_SH14_JONG  /* 비과세소득_H14_종전  */
    ,NVL(AC04.TAXM_SH15_JONG,0) AS  TAXM_SH15_JONG  /* 비과세소득_H15_종전  */
    ,NVL(AC04.TAXM_SH11_JONG,0) AS  TAXM_SH11_JONG  /* 비과세소득_H11_종전  */
    ,NVL(AC04.TAXM_SH12_JONG,0) AS  TAXM_SH12_JONG  /* 비과세소득_H12_종전  */
    ,NVL(AC04.TAXM_SH13_JONG,0) AS  TAXM_SH13_JONG  /* 비과세소득_H13_종전  */
    ,NVL(AC04.TAXM_SH16_JONG,0) AS  TAXM_SH16_JONG  /* 비과세소득_H16_종전  */
    ,NVL(AC04.TAXM_SI01_JONG,0) AS  TAXM_SI01_JONG  /* 비과세소득_I01_종전  */
    ,NVL(AC04.TAXM_SJ01_JONG,0) AS  TAXM_SJ01_JONG  /* 비과세소득_J01_종전  */
    ,NVL(AC04.TAXM_SJ10_JONG,0) AS  TAXM_SJ10_JONG  /* 비과세소득_J10_종전  */
    ,NVL(AC04.TAXM_SK01_JONG,0) AS  TAXM_SK01_JONG  /* 비과세소득_K01_종전  */
    ,NVL(AC04.TAXM_SL01_JONG,0) AS  TAXM_SL01_JONG  /* 비과세소득_L01_종전  */
    ,NVL(AC04.TAXM_SM01_JONG,0) AS  TAXM_SM01_JONG  /* 비과세소득_M01_종전  */
    ,NVL(AC04.TAXM_SM02_JONG,0) AS  TAXM_SM02_JONG  /* 비과세소득_M02_종전  */
    ,NVL(AC04.TAXM_SM03_JONG,0) AS  TAXM_SM03_JONG  /* 비과세소득_M03_종전  */
    ,NVL(AC04.TAXM_SN01_JONG,0) AS  TAXM_SN01_JONG  /* 비과세소득_N01_종전  */
    ,NVL(AC04.TAXM_SO01_JONG,0) AS  TAXM_SO01_JONG  /* 비과세소득_O01_종전  */
    ,NVL(AC04.TAXM_SP01_JONG,0) AS  TAXM_SP01_JONG  /* 비과세소득_P01_종전  */
    ,NVL(AC04.TAXM_SP02_JONG,0) AS  TAXM_SP02_JONG  /* 비과세소득_P02_종전  */
    ,NVL(AC04.TAXM_SQ01_JONG,0) AS  TAXM_SQ01_JONG  /* 비과세소득_Q01_종전  */
    ,NVL(AC04.TAXM_SR01_JONG,0) AS  TAXM_SR01_JONG  /* 비과세소득_R01_종전  */
    ,NVL(AC04.TAXM_SR10_JONG,0) AS  TAXM_SR10_JONG  /* 비과세소득_R10_종전  */
    ,NVL(AC04.TAXM_SS01_JONG,0) AS  TAXM_SS01_JONG  /* 비과세소득_S01_종전  */
    ,NVL(AC04.TAXM_SY02_JONG,0) AS  TAXM_SY02_JONG  /* 비과세소득_Y02_종전  */
    ,NVL(AC04.TAXM_SY03_JONG,0) AS  TAXM_SY03_JONG  /* 비과세소득_Y03_종전  */
    ,NVL(AC04.TAXM_SY04_JONG,0) AS  TAXM_SY04_JONG  /* 비과세소득_Y04_종전  */
    ,NVL(AC04.TAXM_SY21_JONG,0) AS  TAXM_SY21_JONG  /* 비과세소득_Y21_종전  */
    ,NVL(AC04.TAXM_SY22_JONG,0) AS  TAXM_SY22_JONG  /* 비과세소득_Y22_종전  */
    ,NVL(AC04.TAXM_ST01_JONG,0) AS  TAXM_ST01_JONG  /* 감면소득_T01_종전   */
    ,NVL(AC04.TAXM_ST10_JONG,0) AS  TAXM_ST10_JONG  /* 감면소득_T10_종전   */
    ,NVL(AC04.TAXM_ST11_JONG,0) AS  TAXM_ST11_JONG  /* 감면소득_T11_종전   */
    ,NVL(AC04.TAXM_ST12_JONG,0) AS  TAXM_ST12_JONG  /* 감면소득_T12_종전   */
    ,NVL(AC04.TAXM_ST20_JONG,0) AS  TAXM_ST20_JONG  /* 감면소득_T20_종전   */
    ,NVL(AC04.TAXM_SR11_JONG,0) AS  TAXM_SR11_JONG  /* 비과세소득_R11_종전  */  
    ,NVL(AC06.NAT_PENN_PRMM_SUM,0) AS  NAT_PENN_PRMM_SUM       /* 국민연금보험료금액                 */
    ,NVL(AC06.NAT_PENN_ARA_PRMM_SUM,0) AS NAT_PENN_ARA_PRMM_SUM    /*     국민연금지역보험료금액         */
    ,NVL(AC06.NAT_PENN_DDUC_SUM,0) AS  NAT_PENN_DDUC_SUM       /* 국민연금공제금액            */
    ,NVL(AC06.PUOFER_ANTY,0) AS   PUOFER_ANTY      /*     공적연금_공무원연금금액     */
    ,NVL(AC06.PUOFER_ANTY_DDUC_SUM,0) AS  PUOFER_ANTY_DDUC_SUM   /*     공적연금_공무원연금공제금액     */
    ,NVL(AC06.MLTYM_ANTY,0) AS MLTYM_ANTY        /*     공적연금_군인연금금액         */
    ,NVL(AC06.MLTYM_ANTY_DDUC_SUM,0) AS MLTYM_ANTY_DDUC_SUM    /*     공적연금_군인연금공제금액     */
    ,NVL(AC06.PRTAFIR_SCHL_FALYMM_ANTY,0) AS PRTAFIR_SCHL_FALYMM_ANTY    /* 공적연금_사립학교교직원연금금액     */
    ,NVL(AC06.PRTAFIR_SCHL_DDUC_SUM,0) AS  PRTAFIR_SCHL_DDUC_SUM   /*     공적연금_사립학교직원연금공제금액    */
    ,NVL(AC06.SPILDTN_PSTOFIC_ANTY,0) AS SPILDTN_PSTOFIC_ANTY    /*     공적연금_별정우체국연금금액     */
    ,NVL(AC06.SPILDTN_PSTOFIC_DDUC_SUM,0) AS SPILDTN_PSTOFIC_DDUC_SUM    /* 공적연금_별정우체국연금공제금액     */   
                                 
    ,AC05.UT_DPOB_NM        /* 단위사업장명           */
    ,AC05.DEGTR_RESN_REGN_NUM    /* 대표자주민번호         */
    ,AC05.DEGTR_NM            /* 대표자명           */
    ,AC05.FRGNR_DIV_CD        /* 내외국인구분코드          */
    ,AC05.BUSOPR_RGSTN_NUM        /* 사업자등록번호          */
    ,AC05.CORP_RGSTN_NUM        /* 법인등록번호            */
    ,AC05.UNT_DPOB_ZPCD        /* 단위사업장우편번호           */
    ,AC05.UNT_DPOB_FNDTN_ADDR    /* 단위사업장기본주소           */
    ,AC05.UNT_DPOB_DTL_PATR_ADDR    /* 단위사업장상세주소       */
    ,DECODE(AC05.UP_DPOB_UTYN_C171,'Y','1','2')  AS  UP_DPOB_UTYN_C171     /* C171_사업자단위과세자여부     */
    ,AC05.MTST_DPOB_SEIL_NUM_C172    /* C172_종사업장일련번호   */
FROM YE161010  AC01
    ,YE161020  AC02 
    ,YE160404  AC03
    ,YE160405  AC04
    ,BASS0120  AC05 
    ,YE160406  AC06
WHERE AC03.PRCSP_PRCS_YN = '1'                                                                         
  AND AC03.PRCSP_WHDG_REIP_SUMT_YN = '1' 
  AND AC01.DPOB_CD      = AC02.DPOB_CD
  AND AC01.YRTX_BLGG_YR = AC02.YRTX_BLGG_YR
  AND AC01.CLUT_SEPT_CD = AC02.CLUT_SEPT_CD
  AND AC01.SYSTEMKEY    = AC02.SYSTEMKEY  
  AND AC01.DPOB_CD      = AC03.DPOB_CD
  AND AC01.YRTX_BLGG_YR = AC03.YRTX_BLGG_YR
  AND AC01.CLUT_SEPT_CD = AC03.CLUT_SEPT_CD
  AND AC01.SYSTEMKEY    = AC03.SYSTEMKEY     
  AND AC03.DPOB_CD      = AC04.DPOB_CD(+)
  AND AC03.YRTX_BLGG_YR = AC04.YRTX_BLGG_YR(+)
  AND AC03.CLUT_SEPT_CD = AC04.CLUT_SEPT_CD(+)
  AND AC03.SYSTEMKEY    = AC04.SYSTEMKEY(+) 
  AND AC03.WHDG_DEBR_BUSOPR_RGSTNUM =  AC04.WHDG_DEBR_BUSOPR_RGSTNUM(+)
  AND AC03.DPOB_CD      = AC06.DPOB_CD(+)
  AND AC03.YRTX_BLGG_YR = AC06.YRTX_BLGG_YR(+)
  AND AC03.CLUT_SEPT_CD = AC06.CLUT_SEPT_CD(+)
  AND AC03.SYSTEMKEY    = AC06.SYSTEMKEY(+) 
  AND AC03.WHDG_DEBR_BUSOPR_RGSTNUM =  AC06.WHDG_DEBR_BUSOPR_RGSTNUM(+)
  AND AC01.DPOB_CD      = AC05.DPOB_CD(+) 
  AND AC01.UT_DPOB_CD   = AC05.UT_DPOB_CD(+) 
     AND AC01.DPOB_CD=#dpobCd#
             AND AC01.YRTX_BLGG_YR=#yrtxBlggYr#
             AND AC01.CLUT_SEPT_CD=#clutSeptCd#
              AND AC01.SYSTEMKEY=#systemkey#    
     ]]>  
	</select>	
	 
 <!-- E 레코드 소득공제명세 레코드  -->
 <select id="infcPkgYeta17File_2023_DAO.fnPayrE_ReTax_Total_Select" parameterClass="infcFile17Ye161020_2023" resultClass="egovMap">       
  <![CDATA[     
	SELECT AC01.dpob_cd 
	       ,AC01.yrtx_blgg_yr 
	       ,AC01.clut_sept_cd 
	       ,AC01.systemkey 
	       ,AC02.fnm								/* 소득자성명  주소,사업장소재지     */ 
	       ,AC02.resno_enc_cntn						/* 주민등록번호         */ 
	       ,AC02.nnf_cl_cd AS ORG_NNF_CL_CD			/* 내외국인구분          */ 
	       ,AC02.tnm								/* 근무처명          */ 
	       ,AC02.bsno_enc_cntn						/* 사업자등록번호          */ 
	       ,AC03.txpr_dscm_no_cntn					/* 주민등록번호       */ 
	       ,Fcbass0300itemnm(AC01.dpob_cd, AC03.supt_fmly_rlt_cl_cd, '11')
		   AS SUPT_FMLY_RLT_CL_CD					/* 연말정산부양관계코드 */ 
	       ,AC03.nnf_cl_cd							/* 내외국인구분       */ 
	       ,AC03.txpr_nm							/* 성명          */ 
	       ,Decode(AC03.bsc_ddc_cl_cd, '1', AC03.bsc_ddc_cl_cd, '') 
	       AS BSC_DDC_CL_CD							/* 기본공제여부       */ 
	       ,( CASE 
	           WHEN AC03.dsbr_ddc_cl_cd IN ( '1', '2', '3' )
			   THEN AC03.dsbr_ddc_cl_cd 
	           ELSE '' END ) AS DSBR_DDC_CL_CD		/* 장애인여부      */ 
	       ,Decode(AC03.wmn_ddc_cl_cd, '1', AC03.wmn_ddc_cl_cd, '')
		   AS WMN_DDC_CL_CD							/* 부녀자여부      */ 
	       ,Decode(AC03.scc_ddc_cl_cd, '1', AC03.scc_ddc_cl_cd, '')
		   AS SCC_DDC_CL_CD							/* 경로우대여부       */ 
	       ,Decode(AC03.snprnt_fmly_ddc_cl_cd, '1', AC03.snprnt_fmly_ddc_cl_cd, '') 
		   AS SNPRNT_FMLY_DDC_CL_CD					/* 한부모여부      */ 
	       ,( CASE 
	           WHEN AC03.chbt_atpr_ddc_cl_cd IN ( '1', '2', '3' )
			   THEN '1' ELSE '' END ) 
	       AS CHBT_ATPR_DDC_CL_CD					/* 출산입양여부       */ 
	       ,( CASE WHEN EXISTS(SELECT * 
								 FROM YE161030 CH 
								WHERE CH.dpob_cd = AC04.dpob_cd 
	                              AND CH.yrtx_blgg_yr = AC04.yrtx_blgg_yr 
	                              AND CH.clut_sept_cd = AC04.clut_sept_cd 
	                              AND CH.systemkey = AC04.systemkey 
	                              AND CH.txpr_dscm_no_cntn = AC04.txpr_dscm_no_cntn 
	                              AND bsc_ddc_cl_cd = '1' 
	                              AND supt_fmly_rlt_cl_cd IN ('Y0120004', 'Y0120008' ) 
	                              AND ((((CASE WHEN (Substr(CH.txpr_dscm_no_cntn, 7, 1)) IN ('3', '4')
											   THEN '20'||Substr(CH.txpr_dscm_no_cntn, 1, 6) 
	                                           ELSE '19'||Substr(CH.txpr_dscm_no_cntn, 1, 6) END) <= 20151231)
								  AND ((CASE WHEN (Substr(CH.txpr_dscm_no_cntn, 7, 1)) IN ('3', '4')
											 THEN '20'||Substr(CH.txpr_dscm_no_cntn, 1, 6)
											 ELSE '19'||Substr(CH.txpr_dscm_no_cntn, 1, 6) END) >= 20020101))
									   )) THEN '1' ELSE NULL END) AS CHILD_LT
		   , ( CASE WHEN (AC04.scxps_ddc_trgt01 + AC04.scxps_ddc_trgt02) > 0
					THEN (SELECT DISTINCT Min(Fcbass0300itemnm (AN01.dpob_cd, AN01.scxps_std, '12'))
							FROM ye161090 AN01 
							WHERE AN01.dpob_cd = AC04.dpob_cd 
							AND AN01.yrtx_blgg_yr = AC04.yrtx_blgg_yr 
							AND AN01.clut_sept_cd = AC04.clut_sept_cd 
							AND AN01.systemkey = AC04.systemkey 
							AND AN01.fam_resno_enc_cntn = AC04.txpr_dscm_no_cntn
							AND AN01.SCXPS_STD NOT IN ('Y0030040')) 
					ELSE '' END ) AS EDU_DDC_DVCD		/*  교육비공제 추가 */ 
		   , ( AC04.hife_ddc_trgt01) AS HIFE_DDC_TRGT01	/* 건강보험료             */ 
		   , AC04.mcur_ui_trgt01						/* 고용보험료         */ 
		   , AC04.cvrg_insc_ddc_trgt01					/* 보장성보험료         */ 
		   , AC04.dsbr_ddc_trgt01						/* 장애인전용보장성보험료     */ 
		   , CASE WHEN (SELECT Nvl(SUM(use_amt), 0) 
						 FROM ye164010 MD01, YE161030 MD02 
						WHERE MD01.dpob_cd = ac04.dpob_cd 
						  AND MD01.yrtx_blgg_yr = ac04.yrtx_blgg_yr 
						  AND MD01.clut_sept_cd = ac04.clut_sept_cd 
						  AND MD01.systemkey = ac04.systemkey 
						  AND MD01.resno_enc_cntn = ac04.txpr_dscm_no_cntn
						  AND MD01.RESNO_ENC_CNTN = MD02.TXPR_DSCM_NO_CNTN
						  AND MD01.systemkey = MD02.systemkey
						  and MD01.dpob_cd = MD02.dpob_cd 
						  AND MD01.yrtx_blgg_yr = MD02.yrtx_blgg_yr 
						  AND MD01.clut_sept_cd = MD02.clut_sept_cd
						  AND MD01.mdxps_vval_krn_cd = 'Y0140000') > 0 
			THEN GREATEST((SELECT Nvl(SUM(use_amt), 0) 
							 FROM ye164010 MD01, YE161030 MD02 
							WHERE MD01.dpob_cd = ac04.dpob_cd 
							  AND MD01.yrtx_blgg_yr = ac04.yrtx_blgg_yr 
							  AND MD01.clut_sept_cd = ac04.clut_sept_cd 
							  AND MD01.systemkey = ac04.systemkey 
							  AND MD01.resno_enc_cntn = ac04.txpr_dscm_no_cntn
							  AND MD01.RESNO_ENC_CNTN = MD02.TXPR_DSCM_NO_CNTN
							  AND MD01.systemkey = MD02.systemkey
							  and MD01.dpob_cd = MD02.dpob_cd 
							  AND MD01.yrtx_blgg_yr = MD02.yrtx_blgg_yr 
							  AND MD01.clut_sept_cd = MD02.clut_sept_cd
							  AND MD01.mdxps_vval_krn_cd = 'Y0140000') - (SELECT Nvl(SUM(use_amt), 0) 
																			 FROM ye164010 MD01, YE161030 MD02 
																			WHERE MD01.dpob_cd = ac04.dpob_cd 
																			  AND MD01.yrtx_blgg_yr = ac04.yrtx_blgg_yr 
																			  AND MD01.clut_sept_cd = ac04.clut_sept_cd 
																			  AND MD01.systemkey = ac04.systemkey 
																			  AND MD01.resno_enc_cntn = ac04.txpr_dscm_no_cntn
																			  AND MD01.RESNO_ENC_CNTN = MD02.TXPR_DSCM_NO_CNTN
																			  AND MD01.systemkey = MD02.systemkey
																			  and MD01.dpob_cd = MD02.dpob_cd 
																			  AND MD01.yrtx_blgg_yr = MD02.yrtx_blgg_yr 
																			  AND MD01.clut_sept_cd = MD02.clut_sept_cd
																			  AND MD01.mdxps_vval_krn_cd = 'Y0140000' 
																			  AND (( CASE WHEN (Substr(MD01.resno_enc_cntn, 7, 1) ) IN ( '3', '4' ) 
																						   THEN '20' || Substr(MD01.resno_enc_cntn, 1, 6) 
																						   ELSE '19' || Substr(MD01.resno_enc_cntn, 1, 6) END ) <= 19571231 OR MD02.dsbr_ddc_cl_cd = '1')), 0) 
			ELSE 0 END AS MDXPS_DDC_TRGT01 /* 의료비금액 일반 */
		   , '0' AS MDXPS_SFT_XPNS_DDC_TRGT01 /*난임여부*/
		   , (SELECT Nvl(SUM(use_amt), 0) 
		         FROM ye164010 MD01, YE161030 MD02 
				WHERE MD01.dpob_cd = ac04.dpob_cd 
				  AND MD01.yrtx_blgg_yr = ac04.yrtx_blgg_yr 
				  AND MD01.clut_sept_cd = ac04.clut_sept_cd 
				  AND MD01.systemkey = ac04.systemkey 
				  AND MD01.resno_enc_cntn = ac04.txpr_dscm_no_cntn
				  AND MD01.RESNO_ENC_CNTN = MD02.TXPR_DSCM_NO_CNTN
				  AND MD01.systemkey = MD02.systemkey
				  and MD01.dpob_cd = MD02.dpob_cd 
				  AND MD01.yrtx_blgg_yr = MD02.yrtx_blgg_yr 
				  AND MD01.clut_sept_cd = MD02.clut_sept_cd
				  AND MD01.mdxps_vval_krn_cd = 'Y0140000' 
				  AND (( CASE WHEN (Substr(MD01.resno_enc_cntn, 7, 1) ) IN ( '3', '4' ) 
							   THEN '20' || Substr(MD01.resno_enc_cntn, 1, 6) 
							   ELSE '19' || Substr(MD01.resno_enc_cntn, 1, 6) END ) <= 19571231 OR MD02.dsbr_ddc_cl_cd = '1')) AS MDXPS_65_DSBR_DDC_TRGT01
		   , (SELECT NVL(SUM(MEDXPS_DDC_TRGT_AMT),0) FROM YE161040 md01 WHERE  md01.dpob_cd = ac04.dpob_cd 
			   AND    md01.yrtx_blgg_yr = ac04.yrtx_blgg_yr 
			   AND    md01.clut_sept_cd = ac04.clut_sept_cd 
			   AND    md01.systemkey = ac04.systemkey 
			   AND    md01.txpr_dscm_no_cntn = ac04.txpr_dscm_no_cntn ) AS MDXPS_LS_INSR_DDC_TRGT01 /*실손의료*/
		   , CASE WHEN EXISTS ( SELECT * 
								FROM   ye161090 SC 
								WHERE  SC.dpob_cd = ac04.dpob_cd 
								AND    SC.yrtx_blgg_yr = ac04.yrtx_blgg_yr 
								AND    SC.clut_sept_cd = ac04.clut_sept_cd 
								AND    SC.systemkey = ac04.systemkey 
								AND    SC.fam_resno_enc_cntn = ac04.txpr_dscm_no_cntn 
								AND    SC.scxps_std = 'Y0030040' 
								AND    SC.cd_vval_krn_cd = 'Y0140000')
				  THEN ac04.scxps_ddc_trgt01 - ( SELECT nvl(scxps_use_amt,0) 
												 FROM   ye161090 SC 
												 WHERE  SC.dpob_cd = ac04.dpob_cd 
												 AND    SC.yrtx_blgg_yr = ac04.yrtx_blgg_yr 
												 AND    SC.clut_sept_cd = ac04.clut_sept_cd 
												 AND    SC.systemkey = ac04.systemkey 
												 AND    SC.fam_resno_enc_cntn = ac04.txpr_dscm_no_cntn 
												 AND    SC.scxps_std = 'Y0030040' 
												 AND    SC.cd_vval_krn_cd = 'Y0140000') 
				  ELSE ac04.scxps_ddc_trgt01 END AS scxps_ddc_trgt01
		   ,  ( SELECT nvl(scxps_use_amt,0) 
				FROM   ye161090 SC 
				WHERE  SC.dpob_cd = ac04.dpob_cd 
				AND    SC.yrtx_blgg_yr = ac04.yrtx_blgg_yr 
				AND    SC.clut_sept_cd = ac04.clut_sept_cd 
				AND    SC.systemkey = ac04.systemkey 
				AND    SC.fam_resno_enc_cntn = ac04.txpr_dscm_no_cntn 
				AND    SC.scxps_std = 'Y0030040' 
				AND    SC.cd_vval_krn_cd = 'Y0140000') as scxps_DSBR_ddc_trgt01
		   , AC04.crdc_ddc_trgt01									/* 신용카드_전통대중제외금액     */ 		   
		   , AC04.drtp_card_ddc_trgt01								/* 직불카드등_전통대중제외금액  */ 		   
		   , AC04.cshpt_ddc_trgt01									/* 현금영수증_전통대중제외금액  */ 		   
		   , AC04.tdmr_ddc_trgt01									/* 전통시작사용금액            */ 		   
		   , AC04.tfhy_pbt_amt01									/* 대중교통이용금액상반기            */ 	
		   , AC04.shfy_pbt_amt01									/* 대중교통이용금액하반기            */ 		   
		   , AC04.book_ddc_trgt01									/* 도서이용금액            */ 
		   , AC04.tot_crdc_pre_sum01      /*2021년 전체사용분 */
		   , AC04.tot_tdmr_pre_sum01	  /*2021년 전통시장사용분 */
		   , AC04.tot_crdc_curr_sum01      /*2023년 전체사용분 */
		   , AC04.tot_tdmr_curr_sum01	  /*2023년 전통시장사용분 */		   
		   , AC04.conb_ddc_trgt01									/* 기부금액         */ 
		   , ( AC04.hife_ddc_trgt02 ) AS HIFE_DDC_TRGT02	/* 건강보험료             */ 
		   , AC04.mcur_ui_trgt02									/* 고용보험료         */ 
		   , AC04.cvrg_insc_ddc_trgt02								/* 보장성보험료         */ 
		   , AC04.dsbr_ddc_trgt02									/* 장애인전용보장성보험료     */ 
		   , CASE WHEN (SELECT Nvl(SUM(use_amt), 0) 
						 FROM ye164010 MD01, YE161030 MD02 
						WHERE MD01.dpob_cd = ac04.dpob_cd 
						  AND MD01.yrtx_blgg_yr = ac04.yrtx_blgg_yr 
						  AND MD01.clut_sept_cd = ac04.clut_sept_cd 
						  AND MD01.systemkey = ac04.systemkey 
						  AND MD01.resno_enc_cntn = ac04.txpr_dscm_no_cntn
						  AND MD01.RESNO_ENC_CNTN = MD02.TXPR_DSCM_NO_CNTN
						  AND MD01.systemkey = MD02.systemkey
						  and MD01.dpob_cd = MD02.dpob_cd 
						  AND MD01.yrtx_blgg_yr = MD02.yrtx_blgg_yr 
						  AND MD01.clut_sept_cd = MD02.clut_sept_cd
						  AND MD01.mdxps_vval_krn_cd = 'Y0140001'
						  AND MD01.yn2 = '0'
						  AND MD01.yn4 = '0') > 0 
			 THEN GREATEST((SELECT Nvl(SUM(use_amt), 0) 
							 FROM ye164010 MD01, YE161030 MD02 
							WHERE MD01.dpob_cd = ac04.dpob_cd 
							  AND MD01.yrtx_blgg_yr = ac04.yrtx_blgg_yr 
							  AND MD01.clut_sept_cd = ac04.clut_sept_cd 
							  AND MD01.systemkey = ac04.systemkey 
							  AND MD01.resno_enc_cntn = ac04.txpr_dscm_no_cntn
							  AND MD01.RESNO_ENC_CNTN = MD02.TXPR_DSCM_NO_CNTN
							  AND MD01.systemkey = MD02.systemkey
							  and MD01.dpob_cd = MD02.dpob_cd 
							  AND MD01.yrtx_blgg_yr = MD02.yrtx_blgg_yr 
							  AND MD01.clut_sept_cd = MD02.clut_sept_cd
							  AND MD01.mdxps_vval_krn_cd = 'Y0140001'
							  AND MD01.yn2 = '0'
							  AND MD01.yn4 = '0') - 						(SELECT Nvl(SUM(use_amt), 0) 
																			  FROM ye164010 MD01, YE161030 MD02 
																			WHERE MD01.dpob_cd = ac04.dpob_cd 
																			  AND MD01.yrtx_blgg_yr = ac04.yrtx_blgg_yr 
																			  AND MD01.clut_sept_cd = ac04.clut_sept_cd 
																			  AND MD01.systemkey = ac04.systemkey 
																			  AND MD01.resno_enc_cntn = ac04.txpr_dscm_no_cntn
																			  AND MD01.RESNO_ENC_CNTN = MD02.TXPR_DSCM_NO_CNTN
																			  AND MD01.systemkey = MD02.systemkey
																			  and MD01.dpob_cd = MD02.dpob_cd 
																			  AND MD01.yrtx_blgg_yr = MD02.yrtx_blgg_yr 
																			  AND MD01.clut_sept_cd = MD02.clut_sept_cd
																			  AND MD01.mdxps_vval_krn_cd = 'Y0140001'
																			  AND MD01.yn2 = '0'
																			  AND MD01.yn4 = '0'
																			  AND (( CASE WHEN (Substr(MD01.resno_enc_cntn, 7, 1) ) IN ( '3', '4' ) 
																						   THEN '20' || Substr(MD01.resno_enc_cntn, 1, 6) 
																						   ELSE '19' || Substr(MD01.resno_enc_cntn, 1, 6) END ) <= 19571231 OR MD02.dsbr_ddc_cl_cd = '1'))
																						   , 0) ELSE 0 END AS MDXPS_DDC_TRGT02
		   , '0' AS MDXPS_SFT_XPNS_DDC_TRGT02
		   , (SELECT Nvl(SUM(use_amt), 0) 
		        FROM ye164010 MD01, YE161030 MD02 
				WHERE MD01.dpob_cd = ac04.dpob_cd 
				AND MD01.yrtx_blgg_yr = ac04.yrtx_blgg_yr 
				AND MD01.clut_sept_cd = ac04.clut_sept_cd 
				AND MD01.systemkey = ac04.systemkey 
				AND MD01.resno_enc_cntn = ac04.txpr_dscm_no_cntn
				AND MD01.RESNO_ENC_CNTN = MD02.TXPR_DSCM_NO_CNTN
				AND MD01.systemkey = MD02.systemkey
			  and MD01.dpob_cd = MD02.dpob_cd 
			  AND MD01.yrtx_blgg_yr = MD02.yrtx_blgg_yr 
			  AND MD01.clut_sept_cd = MD02.clut_sept_cd
				AND MD01.mdxps_vval_krn_cd = 'Y0140001'
				AND MD01.yn2 = '0'
				AND MD01.yn4 = '0'
				AND (( CASE WHEN (Substr(MD01.resno_enc_cntn, 7, 1) ) IN ( '3', '4' ) 
						   THEN '20' || Substr(MD01.resno_enc_cntn, 1, 6) 
						   ELSE '19' || Substr(MD01.resno_enc_cntn, 1, 6) END ) <= 19571231 OR MD02.dsbr_ddc_cl_cd = '1')) AS MDXPS_65_DSBR_DDC_TRGT02
		   , ( SELECT nvl(SUM(use_amt),0)
			   FROM   ye164010 md01 
			   WHERE  md01.dpob_cd = ac04.dpob_cd 
			   AND    md01.yrtx_blgg_yr = ac04.yrtx_blgg_yr 
			   AND    md01.clut_sept_cd = ac04.clut_sept_cd 
			   AND    md01.systemkey = ac04.systemkey 
			   AND    md01.resno_enc_cntn = ac04.txpr_dscm_no_cntn 
			   AND    md01.yn4 = '1') AS MDXPS_LS_INSR_DDC_TRGT02
		   , CASE WHEN EXISTS ( SELECT * 
								FROM   ye161090 SC 
								WHERE  SC.dpob_cd = ac04.dpob_cd 
								AND    SC.yrtx_blgg_yr = ac04.yrtx_blgg_yr 
								AND    SC.clut_sept_cd = ac04.clut_sept_cd 
								AND    SC.systemkey = ac04.systemkey 
								AND    SC.fam_resno_enc_cntn = ac04.txpr_dscm_no_cntn 
								AND    SC.scxps_std = 'Y0030040' 
								AND    SC.cd_vval_krn_cd = 'Y0140001')
				  THEN ac04.scxps_ddc_trgt02 - ( SELECT nvl(scxps_use_amt,0) 
												 FROM   ye161090 SC 
												 WHERE  SC.dpob_cd = ac04.dpob_cd 
												 AND    SC.yrtx_blgg_yr = ac04.yrtx_blgg_yr 
												 AND    SC.clut_sept_cd = ac04.clut_sept_cd 
												 AND    SC.systemkey = ac04.systemkey 
												 AND    SC.fam_resno_enc_cntn = ac04.txpr_dscm_no_cntn 
												 AND    SC.scxps_std = 'Y0030040' 
												 AND    SC.cd_vval_krn_cd = 'Y0140001') 
				  ELSE ac04.scxps_ddc_trgt02 END AS scxps_ddc_trgt02
		   ,  ( SELECT nvl(scxps_use_amt,0) 
				FROM   ye161090 SC 
				WHERE  SC.dpob_cd = ac04.dpob_cd 
				AND    SC.yrtx_blgg_yr = ac04.yrtx_blgg_yr 
				AND    SC.clut_sept_cd = ac04.clut_sept_cd 
				AND    SC.systemkey = ac04.systemkey 
				AND    SC.fam_resno_enc_cntn = ac04.txpr_dscm_no_cntn 
				AND    SC.scxps_std = 'Y0030040' 
				AND    SC.cd_vval_krn_cd = 'Y0140001') as scxps_DSBR_ddc_trgt02	   
		   , AC04.crdc_ddc_trgt02					/* 신용카드_전통대중제외금액     */ 
		   , AC04.drtp_card_ddc_trgt02				/* 직불카드등_전통대중제외금액  */ 
		   , AC04.cshpt_ddc_trgt02					/* 현금영수증_전통대중제외금액  */ 
		   , AC04.tdmr_ddc_trgt02					/* 전통시작사용금액            */ 
		   , AC04.tfhy_pbt_amt02					/* 대중교통이용금액상반기            */ 
		   , AC04.shfy_pbt_amt02					/* 대중교통이용금액하반기            */
		   , AC04.book_ddc_trgt02					/* 도서이용금액            */ 
		   , AC04.tot_crdc_pre_sum02      /*2021년 전체사용분 */
		   , AC04.tot_tdmr_pre_sum02      /*2021년 전통시장사용분 */
		   , AC04.tot_crdc_curr_sum02      /*2023년 전체사용분 */
		   , AC04.tot_tdmr_curr_sum02      /*2023년 전통시장사용분 */
		   
		   , AC04.conb_ddc_trgt02					/* 기부금액         */ 
	FROM	ye161010 AC01, 
			ye161020 AC02, 
			ye161030 AC03, 
			(SELECT   ab0101.dpob_cd, 
					  ab0101.yrtx_blgg_yr, 
					  ab0101.clut_sept_cd, 
					  ab0101.systemkey, 
					  ab0101.txpr_dscm_no_cntn , 
					  Max(Decode(ab0101.cd_vval_krn_cd, 'Y0140000', ab0101.hife_ddc_trgt_amt, 0)) AS hife_ddc_trgt01
					  /* 건강등보험료             */ 
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140000', ab0101.mcur_ui_trgt_amt, 0)) AS mcur_ui_trgt01
					  /* 고용보험료            */ 
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140000', ab0101.cvrg_insc_ddc_trgt_amt, 0)) AS cvrg_insc_ddc_trgt01
					  /* 보장성보험료         */ 
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140000', ab0101.dsbr_ddc_trgt_amt, 0)) AS dsbr_ddc_trgt01
					  /* 장애인전용보장성보험료     */ 
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140000', ab0101.mdxps_ddc_trgt_amt, 0)) AS mdxps_ddc_trgt01
					  /* 의료비금액            */ 
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140000', ab0101.scxps_ddc_trgt_amt, 0)) AS scxps_ddc_trgt01
					  /* 교육비금액            */ 
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140000', ab0101.crdc_ddc_trgt_amt, 0)) AS crdc_ddc_trgt01
					  /* 신용카드_전통대중제외금액     */ 					  
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140000', ab0101.drtp_card_ddc_trgt_amt, 0)) AS drtp_card_ddc_trgt01
					  /* 직불카드등_전통대중제외금액  */ 					  
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140000', ab0101.cshpt_ddc_trgt_amt, 0)) AS cshpt_ddc_trgt01
					  /* 현금영수증_전통대중제외금액  */ 					  
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140000', ab0101.tdmr_ddc_trgt_amt, 0)) AS tdmr_ddc_trgt01
					  /* 전통시작사용금액            */ 					            
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140000', ab0101.tfhy_pbt_amt, 0)) AS tfhy_pbt_amt01 
					  /* 대중교통이용금액상반기           */	
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140000', ab0101.shfy_pbt_amt, 0)) AS shfy_pbt_amt01 
					  /* 대중교통이용금액하반기           */					  
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140000', ab0101.book_show_amt, 0)) AS book_ddc_trgt01 
					  /* 도서이용금액            */ 
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140000', ab0101.tot_crdc_pre_sum, 0)) AS tot_crdc_pre_sum01
					  /* 전년 전체사용분 */
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140000', ab0101.tot_tdmr_pre_sum, 0)) AS tot_tdmr_pre_sum01
					  /* 전년 전통시장사용분 */
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140000', ab0101.tot_crdc_curr_sum, 0)) AS tot_crdc_curr_sum01
					  /* 당해년 전체사용분 */ 
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140000', ab0101.tot_tdmr_curr_sum, 0)) AS tot_tdmr_curr_sum01
					  /* 당해년 전통시장사용분 */  					  
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140000', ab0101.conb_ddc_trgt_amt, 0)) AS conb_ddc_trgt01 
					  /* 기부금액         */ 
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140001', ab0101.hife_ddc_trgt_amt, 0)) AS hife_ddc_trgt02 
					  /* 건강등보험료             */ 
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140001', ab0101.mcur_ui_trgt_amt, 0)) AS mcur_ui_trgt02 
					  /* 고용보험료            */ 
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140001', ab0101.cvrg_insc_ddc_trgt_amt, 0)) AS cvrg_insc_ddc_trgt02 
					  /* 보장성보험료         */ 
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140001', ab0101.dsbr_ddc_trgt_amt, 0)) AS dsbr_ddc_trgt02 
					  /* 장애인전용보장성보험료     */ 
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140001', ab0101.mdxps_ddc_trgt_amt, 0)) AS mdxps_ddc_trgt02 
					  /* 의료비금액            */ 
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140001', ab0101.scxps_ddc_trgt_amt, 0)) AS scxps_ddc_trgt02 
					  /* 교육비금액            */ 
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140001', ab0101.crdc_ddc_trgt_amt, 0)) AS crdc_ddc_trgt02 
					  /* 신용카드_전통대중제외금액     */ 
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140001', ab0101.drtp_card_ddc_trgt_amt, 0)) AS drtp_card_ddc_trgt02 
					  /* 직불카드등_전통대중제외금액  */ 
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140001', ab0101.cshpt_ddc_trgt_amt, 0)) AS cshpt_ddc_trgt02 
					  /* 현금영수증_전통대중제외금액  */ 
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140001', ab0101.tdmr_ddc_trgt_amt, 0)) AS tdmr_ddc_trgt02 
					  /* 전통시작사용금액            */ 
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140001', ab0101.tfhy_pbt_amt, 0)) AS tfhy_pbt_amt02 
					  /* 대중교통이용금액상반기           */	
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140001', ab0101.shfy_pbt_amt, 0)) AS shfy_pbt_amt02 
					  /* 대중교통이용금액하반기           */	 
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140001', ab0101.book_show_amt, 0)) AS book_ddc_trgt02 
					  /* 도서이용금액            */
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140001', ab0101.tot_crdc_pre_sum, 0)) AS tot_crdc_pre_sum02
					  /* 전년 전체사용분 */
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140001', ab0101.tot_tdmr_pre_sum, 0)) AS tot_tdmr_pre_sum02
					  /* 전년 전통시장사용분 */
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140001', ab0101.tot_crdc_curr_sum, 0)) AS tot_crdc_curr_sum02
					  /* 당해년 전체사용분 */ 
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140001', ab0101.tot_tdmr_curr_sum, 0)) AS tot_tdmr_curr_sum02
					  /* 당해년 전통시장사용분 */ 
					  , Max( Decode(ab0101.cd_vval_krn_cd, 'Y0140001', ab0101.conb_ddc_trgt_amt, 0)) AS conb_ddc_trgt02 
					  /* 기부금액         */ 
			 FROM     ( SELECT ab01.dpob_cd, 
								ab01.yrtx_blgg_yr, 
								ab01.clut_sept_cd, 
								ab01.systemkey, 
								ab01.txpr_dscm_no_cntn 
								/* 주민등록번호          */ 
								, ab01.cd_vval_krn_cd 
								/* 소득공제명세자료구분코드 */ 
								, ab01.hife_ddc_trgt_amt 
								/* 건강등보험료             */ 
								, ab01.mcur_ui_trgt_amt 
								/* 고용보험료            */ 
								, ab01.cvrg_insc_ddc_trgt_amt 
								/* 보장성보험료         */ 
								, ab01.dsbr_ddc_trgt_amt 
								/* 장애인전용보장성보험료     */ 
								, ab01.mdxps_ddc_trgt_amt 
								/* 의료비금액            */ 
								, ab01.scxps_ddc_trgt_amt 
								/* 교육비금액            */ 
								, ab01.crdc_ddc_trgt_amt 
								/* 신용카드_전통대중제외금액     */ 		
								, ab01.drtp_card_ddc_trgt_amt + nvl(ab01.zrtd_ddc_trgt_amt,0) as drtp_card_ddc_trgt_amt 
								/* 직불카드등_전통대중제외금액  */ 				
								, ab01.cshpt_ddc_trgt_amt 
								/* 현금영수증_전통대중제외금액  */ 					
								, ab01.tdmr_ddc_trgt_amt 
								/* 전통시작사용금액            */ 		
								, ab01.tfhy_pbt_amt 
								/* 대중교통이용금액상반기            */ 		
								, ab01.shfy_pbt_amt 
								/* 대중교통이용금액하반기            */ 
								, ab01.book_show_amt 
								/* 도서이용금액            */ 
								, ab01.tot_crdc_pre_sum
								/* 2021년 전체사용분 */
								, ab01.tot_tdmr_pre_sum
								/* 2021년 전통시장사용분 */
								, ab01.tot_crdc_curr_sum
								/* 2023년 전체사용분 */	
								, ab01.tot_tdmr_curr_sum
								/* 2023년 전통시장사용분 */
								, ab01.conb_ddc_trgt_amt 
								/* 기부금액         */ 
						FROM   ye161040 ab01 
						WHERE  AB01.DPOB_CD=#dpobCd#
						AND AB01.YRTX_BLGG_YR=#yrtxBlggYr#
						AND AB01.CLUT_SEPT_CD=#clutSeptCd#
						AND AB01.SYSTEMKEY=#systemkey#) ab0101 
			 GROUP BY ab0101.dpob_cd, 
					  ab0101.yrtx_blgg_yr, 
					  ab0101.clut_sept_cd, 
					  ab0101.systemkey, 
					  ab0101.txpr_dscm_no_cntn) AC04 
	WHERE  AC01.dpob_cd = AC02.dpob_cd 
	AND AC01.yrtx_blgg_yr = AC02.yrtx_blgg_yr 
	AND AC01.clut_sept_cd = AC02.clut_sept_cd 
	AND AC01.systemkey = AC02.systemkey 
	AND AC01.dpob_cd = AC03.dpob_cd 
	AND AC01.yrtx_blgg_yr = AC03.yrtx_blgg_yr 
	AND AC01.clut_sept_cd = AC03.clut_sept_cd 
	AND AC01.systemkey = AC03.systemkey 
	AND AC03.dpob_cd = AC04.dpob_cd 
	AND AC03.yrtx_blgg_yr = AC04.yrtx_blgg_yr 
	AND AC03.clut_sept_cd = AC04.clut_sept_cd 
	AND AC03.systemkey = AC04.systemkey 
	AND AC03.txpr_dscm_no_cntn = AC04.txpr_dscm_no_cntn 
	AND AC01.DPOB_CD=#dpobCd#
	AND AC01.YRTX_BLGG_YR=#yrtxBlggYr#
	AND AC01.CLUT_SEPT_CD=#clutSeptCd#
	AND AC01.SYSTEMKEY=#systemkey#
	ORDER  BY AC03.supt_fmly_rlt_cl_cd, Substr(AC03.txpr_dscm_no_cntn, 1, 6) 
 ]]>
	</select>	 
    
  
   <!--   F레코드  - 연금저축등 소득세액공제명세 레코드  -->
   <select id="infcPkgYeta17File_2023_DAO.fnPayrF_ReTax_Total_Select" parameterClass="infcFile17Ye161020_2023" resultClass="egovMap">       
     <![CDATA[
			  SELECT AC01.DPOB_CD,
         AC01.YRTX_BLGG_YR,
         AC01.CLUT_SEPT_CD,
         AC01.SYSTEMKEY,
         AC02.FNM                                   /* 소득자성명  주소,사업장소재지     */
                 ,
         AC02.RESNO_ENC_CNTN                              /* 주민등록번호         */
                            ,
         AC02.NNF_CL_CD                                  /* 내외국인구분          */
                       ,
         AC02.TNM                                          /* 근무처명          */
                 ,
         AC02.BSNO_ENC_CNTN,                            /* 사업자등록번호          */
         AC04.RTPN_ACC_RTPN_CL,
         AC04.RTPN_FNN_ORGN_CD,
         AC04.RTPN_ACC_FNN_CMP,
         AC04.RTPN_ACC_ACCNO,
         AC04.RTPN_ACC_PYM_AMT,
         AC04.RTPN_ACC_TXAMT_DDC_AMT,
         AC04.VNT_ASCT_CL_CD,
         AC04.REG_DT,
		 AC04.CTR_TERM_MM_CNT
    FROM YE161010 AC01,
         YE161020 AC02,
         (SELECT DPOB_CD,
                 YRTX_BLGG_YR,
                 CLUT_SEPT_CD,
                 SYSTEMKEY,
                 fcBass0300ITEMNM (DPOB_CD, RTPN_ACC_RTPN_CL, '11')
                    AS RTPN_ACC_RTPN_CL,
                 RTPN_FNN_ORGN_CD,
                 RTPN_ACC_FNN_CMP,
                 RTPN_ACC_ACCNO,
                 (RTPN_ACC_PYM_AMT - NVL(RTPN_ACC_ISA_AMT,0)) AS RTPN_ACC_PYM_AMT,
                 RTPN_ACC_TXAMT_DDC_AMT,
                 NULL AS VNT_ASCT_CL_CD,
                 NULL AS REG_DT,
				 NULL AS CTR_TERM_MM_CNT
            FROM YE162020
          UNION ALL
		  SELECT DPOB_CD,
                 YRTX_BLGG_YR,
                 CLUT_SEPT_CD,
                 SYSTEMKEY,
                 '72' AS RTPN_ACC_RTPN_CL,
                 RTPN_FNN_ORGN_CD,
                 RTPN_ACC_FNN_CMP,
                 RTPN_ACC_ACCNO,
                 RTPN_ACC_ISA_AMT,
                 RTPN_ACC_TXAMT_DDC_ISA_AMT,
                 NULL AS VNT_ASCT_CL_CD,
                 NULL AS REG_DT,
				 NULL AS CTR_TERM_MM_CNT
            FROM YE162020 WHERE RTPN_ACC_ISA_AMT != 0
          UNION ALL
          SELECT DPOB_CD,
                 YRTX_BLGG_YR,
                 CLUT_SEPT_CD,
                 SYSTEMKEY,
                 fcBass0300ITEMNM (DPOB_CD, PNSN_SVNG_ACC_PNSN_SVNG_CL, '11')
                    AS RTPN_ACC_RTPN_CL,
                 PNSN_SVNG_FNN_ORGN_CD AS RTPN_FNN_ORGN_CD,
                 PNSN_SVNG_ACC_FNN_CMP AS RTPN_ACC_FNN_CMP,
                 PNSN_SVNG_ACC_ACCNO AS RTPN_ACC_ACCNO,
                 (PNSN_SVNG_ACC_PYM_AMT - NVL(PNSN_SVNG_ACC_ISA_AMT,0)) AS RTPN_ACC_PYM_AMT,
                 IPNSN_SVNG_ACCDDC_AMT AS RTPN_ACC_TXAMT_DDC_AMT,
                 NULL AS VNT_ASCT_CL_CD,
                 NULL AS REG_DT,
				 NULL AS CTR_TERM_MM_CNT
            FROM YE162010
          UNION ALL
		  SELECT DPOB_CD,
                 YRTX_BLGG_YR,
                 CLUT_SEPT_CD,
                 SYSTEMKEY,
                 '71'
                    AS RTPN_ACC_RTPN_CL,
                 PNSN_SVNG_FNN_ORGN_CD AS RTPN_FNN_ORGN_CD,
				   PNSN_SVNG_ACC_FNN_CMP AS RTPN_ACC_FNN_CMP,
                 PNSN_SVNG_ACC_ACCNO AS RTPN_ACC_ACCNO,
                 PNSN_SVNG_ACC_ISA_AMT AS RTPN_ACC_PYM_AMT,
                 IPNSN_SVNG_ACCDDC_ISA_AMT AS RTPN_ACC_TXAMT_DDC_AMT,
                 NULL AS VNT_ASCT_CL_CD,
                 NULL AS REG_DT,
				 NULL AS CTR_TERM_MM_CNT
            FROM YE162010 WHERE PNSN_SVNG_ACC_ISA_AMT != 0
          UNION ALL
          SELECT DPOB_CD,
                 YRTX_BLGG_YR,
                 CLUT_SEPT_CD,
                 SYSTEMKEY,
                 fcBass0300ITEMNM (DPOB_CD, HSNG_PRPT_SVNG_SVNG_CL, '11')
                    AS RTPN_ACC_RTPN_CL,
                 HSNG_PRPT_SVNG_FNN_ORGN_CD AS RTPN_FNN_ORGN_CD,
                 HSNG_PRPT_SVNG_FNN_CMP AS RTPN_ACC_FNN_CMP,
                 HSNG_PRPT_SVNG_ACC_NO AS RTPN_ACC_ACCNO,
                 HSNG_PRPT_SVNG_PYM_AMT AS RTPN_ACC_PYM_AMT,
                 HSNG_PRPT_SVNG_INC_DDC_AMT AS RTPN_ACC_TXAMT_DDC_AMT,
                 NULL AS VNT_ASCT_CL_CD,
                 NULL AS REG_DT,
				 NULL AS CTR_TERM_MM_CNT
            FROM YE162030
          UNION ALL
          SELECT DPOB_CD,
                 YRTX_BLGG_YR,
                 CLUT_SEPT_CD,
                 SYSTEMKEY,
                 fcBass0300ITEMNM (DPOB_CD, LTRM_CNI_SSFNN_CL, '11')
                    AS RTPN_ACC_RTPN_CL,
                 LTRM_CNI_SSFNN_ORGN_CD AS RTPN_FNN_ORGN_CD,
                 LTRM_CNI_SS_FNN_CMP AS RTPN_ACC_FNN_CMP,
                 LTRM_CNI_SS_ACCNO AS RTPN_ACC_ACCNO,
                 LTRM_CNI_SS_PYM_AMT AS RTPN_ACC_PYM_AMT,
                 LTRM_CNI_SS_INC_DDC_AMT AS RTPN_ACC_TXAMT_DDC_AMT,
                 NULL AS VNT_ASCT_CL_CD,
                 NULL AS REG_DT,
				 NULL AS CTR_TERM_MM_CNT
            FROM YE162040 WHERE DAT_CD = 'G0029'
          UNION ALL
          SELECT DPOB_CD,
                 YRTX_BLGG_YR,
                 CLUT_SEPT_CD,
                 SYSTEMKEY,
                 '81' RTPN_ACC_RTPN_CL,
                 LTRM_CNI_SSFNN_ORGN_CD AS RTPN_FNN_ORGN_CD,
                 LTRM_CNI_SS_FNN_CMP AS RTPN_ACC_FNN_CMP,
                 LTRM_CNI_SS_ACCNO AS RTPN_ACC_ACCNO,
                 LTRM_CNI_SS_PYM_AMT AS RTPN_ACC_PYM_AMT,
                 LTRM_CNI_SS_INC_DDC_AMT AS RTPN_ACC_TXAMT_DDC_AMT,
                 NULL AS VNT_ASCT_CL_CD,
                 (SELECT REG_DT FROM PDF_N101Y 
                 				WHERE DPOB_CD = YE162040.DPOB_CD 
                 				AND YRTX_BLGG_YR = YE162040.YRTX_BLGG_YR 
                 				AND CLUT_SEPT_CD = YE162040.CLUT_SEPT_CD 
                 				AND SYSTEMKEY = YE162040.SYSTEMKEY 
                 				AND SECU_NO = YE162040.LTRM_CNI_SS_ACCNO 
                 				AND DAT_CD = 'G0043') AS REG_DT,
				 CTR_TERM_MM_CNT
            FROM YE162040 WHERE DAT_CD = 'G0043'
          UNION ALL
          SELECT DPOB_CD,
                 YRTX_BLGG_YR,
                 CLUT_SEPT_CD,
                 SYSTEMKEY,
                 '61' AS RTPN_ACC_RTPN_CL,
                 COM_CD AS RTPN_FNN_ORGN_CD,
                 FUND_NM AS RTPN_ACC_FNN_CMP,
                 SECU_NO AS RTPN_ACC_ACCNO,
                 VNT_SUM AS RTPN_ACC_PYM_AMT,
                 VNT_DDC_AMT AS RTPN_ACC_TXAMT_DDC_AMT,
                 VNT_ASCT_CL_CD,
                 REG_DT,
				 NULL AS CTR_TERM_MM_CNT
            FROM YE166040) AC04
   WHERE     AC01.DPOB_CD = AC02.DPOB_CD
         AND AC01.YRTX_BLGG_YR = AC02.YRTX_BLGG_YR
         AND AC01.CLUT_SEPT_CD = AC02.CLUT_SEPT_CD
         AND AC01.SYSTEMKEY = AC02.SYSTEMKEY
         AND AC01.DPOB_CD = AC04.DPOB_CD
         AND AC01.YRTX_BLGG_YR = AC04.YRTX_BLGG_YR
         AND AC01.CLUT_SEPT_CD = AC04.CLUT_SEPT_CD
         AND AC01.SYSTEMKEY = AC04.SYSTEMKEY
         /* AND AC04.RTPN_ACC_TXAMT_DDC_AMT > 0 */
         AND AC01.DPOB_CD = #dpobCd#
         AND AC01.YRTX_BLGG_YR = #yrtxBlggYr#
         AND AC01.CLUT_SEPT_CD = #clutSeptCd#
         AND AC01.SYSTEMKEY = #systemkey#
ORDER BY AC01.SYSTEMKEY ASC, AC04.RTPN_ACC_RTPN_CL ASC
       ]]>
	</select>	  
	
   
	<!-- G레코드 - 월세 거주간 주택임차 차입금 원리금 상환액 소득공제명세 레코드  -->
   <select id="infcPkgYeta17File_2023_DAO.fnPayrG_ReTax_Total_Select" parameterClass="infcFile17Ye161020_2023" resultClass="egovMap">       
       <![CDATA[  
          
			SELECT 
			    AC01.DPOB_CD, AC01.YRTX_BLGG_YR, AC01.CLUT_SEPT_CD, 
			    AC01.SYSTEMKEY 
			   ,AC02.FNM                /* 소득자성명  주소,사업장소재지     */ 
			   ,AC02.RESNO_ENC_CNTN     /* 주민등록번호         */ 
			   ,AC02.NNF_CL_CD          /* 내외국인구분          */
			   ,AC02.TNM                /* 근무처명          */
			   ,AC02.BSNO_ENC_CNTN ,     /* 사업자등록번호          */                 
			    AC04.MNTH_RNTTY_LEHDR_NM, 
			       AC04.MNTH_RNTTY_BUR_RGSUM, 
			       AC04.MNTH_RNTTY_HUS_FRM_CD, 
			       AC04.MNTH_RNTTY_HUS_CNTT_AREA, 
			       AC04.MNTH_RNTTY_RNTL_ADDR, 
			        DECODE(NVL(AC04.MNTH_RNTTY_RNTL_BGNN_DT,''),'','00000000',AC04.MNTH_RNTTY_RNTL_BGNN_DT) AS MNTH_RNTTY_RNTL_BGNN_DT, 
			        DECODE(NVL(AC04.MNTH_RNTTY_RNTL_END_DT,''),'','00000000',AC04.MNTH_RNTTY_RNTL_END_DT) AS MNTH_RNTTY_RNTL_END_DT, 
			       AC04.MNTH_RNTTY_YRLY_MNTH_SUM, 
			       AC04.MNTH_RNTTY_TX_DDUC_SUM,
			       AC04.COMR_CDTR_NM, 
			       AC04.COMR_CDTR_RESN_REGN_NUM, 
			        DECODE(NVL(AC04.COMR_CNTT_PRID_BGNN_DT,''),'','00000000',AC04.COMR_CNTT_PRID_BGNN_DT) AS COMR_CNTT_PRID_BGNN_DT, 
			    DECODE(NVL(AC04.COMR_CNTT_PRID_END_DT,''),'','00000000',AC04.COMR_CNTT_PRID_END_DT) AS COMR_CNTT_PRID_END_DT, 
			   AC04.COMR_LOAN_ITRT_RATE, 
			   AC04.COMR_PCLTT_AMTFT_AGGR, 
			   AC04.COMR_PRNIL_SUM, 
			   AC04.COMR_ITRT_SUM, 
			   AC04.COMR_DDUC_SUM , 
			   AC04.RNTL_CTT_LEHDR_NM, 
			   AC04.RNTL_CTT_BUSOPR_RGSTNUM, 
			   AC04.RNTL_CTT_HUS_FRM_CD, 
			   AC04.RNTL_CTT_HUS_CNTT_AREA, 
			   AC04.RNTL_CTT_ADDR, 
			    DECODE(NVL(AC04.RNTL_CTT_PRID_BGNN_DT,''),'','00000000',AC04.RNTL_CTT_PRID_BGNN_DT) AS RNTL_CTT_PRID_BGNN_DT, 
			    DECODE(NVL(AC04.RNTL_CTT_PRID_END_DT,''),'','00000000',AC04.RNTL_CTT_PRID_END_DT) AS RNTL_CTT_PRID_END_DT, 
			   AC04.RNTL_CTT_CHRTR_GRNTE_SUM    
			FROM YE161010 AC01 
			    ,YE161020 AC02 
			    ,(SELECT
			       AN01.DPOB_CD, AN01.YRTX_BLGG_YR, AN01.CLUT_SEPT_CD, 
			       AN01.SYSTEMKEY,
			       AN01.CNT, 
			       AN02.MNTH_RNTTY_LEHDR_NM, 
			       AN02.MNTH_RNTTY_BUR_RGSUM, 
			        fcBass0300ITEMNM(AN02.DPOB_CD,AN02.MNTH_RNTTY_HUS_FRM_CD,'12') AS  MNTH_RNTTY_HUS_FRM_CD, 
			       AN02.MNTH_RNTTY_HUS_CNTT_AREA, 
			       AN02.MNTH_RNTTY_RNTL_ADDR, 
			       AN02.MNTH_RNTTY_RNTL_BGNN_DT, 
			       AN02.MNTH_RNTTY_RNTL_END_DT, 
			       AN02.MNTH_RNTTY_YRLY_MNTH_SUM, 
			       AN02.MNTH_RNTTY_TX_DDUC_SUM,
			       AN03.COMR_CDTR_NM, 
			       AN03.COMR_CDTR_RESN_REGN_NUM, 
			       AN03.COMR_CNTT_PRID_BGNN_DT, 
			   AN03.COMR_CNTT_PRID_END_DT, 
			   AN03.COMR_LOAN_ITRT_RATE, 
			   AN03.COMR_PCLTT_AMTFT_AGGR, 
			   AN03.COMR_PRNIL_SUM, 
			   AN03.COMR_ITRT_SUM, 
			   AN03.COMR_DDUC_SUM , 
			   AN04.RNTL_CTT_LEHDR_NM, 
			   AN04.RNTL_CTT_BUSOPR_RGSTNUM, 
			   fcBass0300ITEMNM(AN04.DPOB_CD,AN04.RNTL_CTT_HUS_FRM_CD,'12') AS RNTL_CTT_HUS_FRM_CD, 
			   AN04.RNTL_CTT_HUS_CNTT_AREA, 
			   AN04.RNTL_CTT_ADDR, 
			   AN04.RNTL_CTT_PRID_BGNN_DT, 
			   AN04.RNTL_CTT_PRID_END_DT, 
			   AN04.RNTL_CTT_CHRTR_GRNTE_SUM 
			FROM 
			(SELECT  #dpobCd# AS DPOB_CD, 
			         #yrtxBlggYr# AS YRTX_BLGG_YR,
			         #clutSeptCd#  AS CLUT_SEPT_CD, 
			          #systemkey#  AS SYSTEMKEY,
			          LEVEL AS CNT 
			          FROM DUAL 
			          CONNECT BY LEVEL <= 3) AN01,
			          (SELECT  DPOB_CD, YRTX_BLGG_YR, CLUT_SEPT_CD, 
			               SYSTEMKEY, ROWNUM AS CNT ,MNTH_RNT_QNTY_SEIL_NUM, TAX_VVAL_KRN_CD, 
			               MNTH_RNTTY_LEHDR_NM, MNTH_RNTTY_BUR_RGSUM, MNTH_RNTTY_HUS_FRM_CD, 
			               MNTH_RNTTY_HUS_CNTT_AREA, MNTH_RNTTY_RNTL_ADDR, MNTH_RNTTY_RNTL_BGNN_DT, 
			               MNTH_RNTTY_RNTL_END_DT, MNTH_RNTTY_YRLY_MNTH_SUM, MNTH_RNTTY_TX_DDUC_SUM, 
			               ECTN_FL_TRNR_CTL_YN, MNTH_RNTTY_YRLY_TGT_SUM 
			          FROM YE162510
			          WHERE DPOB_CD=#dpobCd#
			              AND  YRTX_BLGG_YR=#yrtxBlggYr#
			               AND CLUT_SEPT_CD=#clutSeptCd#
			              AND  SYSTEMKEY=#systemkey#   ) AN02,
			          (SELECT DPOB_CD, YRTX_BLGG_YR, CLUT_SEPT_CD, 
			               SYSTEMKEY,ROWNUM AS CNT , COMR_CALN_SEIL_NUM, TAX_VVAL_KRN_CD, 
			               COMR_CDTR_NM, COMR_CDTR_RESN_REGN_NUM, COMR_CNTT_PRID_BGNN_DT, 
			               COMR_CNTT_PRID_END_DT, COMR_LOAN_ITRT_RATE, COMR_PCLTT_AMTFT_AGGR, 
			               COMR_PRNIL_SUM, COMR_ITRT_SUM, COMR_DDUC_SUM, 
			               ECTN_FL_TRNR_CTL_YN 
			          FROM YE162520
			          WHERE  DPOB_CD=#dpobCd#
			              AND  YRTX_BLGG_YR=#yrtxBlggYr#
			               AND CLUT_SEPT_CD=#clutSeptCd#
			              AND  SYSTEMKEY=#systemkey#   )  AN03,
			           (SELECT DPOB_CD, YRTX_BLGG_YR, CLUT_SEPT_CD, 
			                   SYSTEMKEY, ROWNUM AS CNT ,RNTL_CTT_SEIL_NUM, TAX_VVAL_KRN_CD, 
			                   RNTL_CTT_LEHDR_NM, RNTL_CTT_BUSOPR_RGSTNUM, RNTL_CTT_HUS_FRM_CD, 
			                   RNTL_CTT_HUS_CNTT_AREA, RNTL_CTT_ADDR, RNTL_CTT_PRID_BGNN_DT, 
			                   RNTL_CTT_PRID_END_DT, RNTL_CTT_CHRTR_GRNTE_SUM 
			          FROM YE162530
			          WHERE DPOB_CD=#dpobCd#
			              AND  YRTX_BLGG_YR=#yrtxBlggYr#
			               AND CLUT_SEPT_CD=#clutSeptCd#
			              AND  SYSTEMKEY=#systemkey#   )  AN04 
			WHERE AN01.DPOB_CD = AN02.DPOB_CD(+)
			  AND AN01.YRTX_BLGG_YR = AN02.YRTX_BLGG_YR(+)
			  AND AN01.CLUT_SEPT_CD = AN02.CLUT_SEPT_CD(+)
			  AND AN01.SYSTEMKEY = AN02.SYSTEMKEY(+)
			   AND AN01.CNT = AN02.CNT(+)
			  AND AN01.DPOB_CD = AN03.DPOB_CD(+)
			  AND AN01.YRTX_BLGG_YR = AN03.YRTX_BLGG_YR(+)
			  AND AN01.CLUT_SEPT_CD = AN03.CLUT_SEPT_CD(+)
			  AND AN01.SYSTEMKEY = AN03.SYSTEMKEY(+)
			   AND AN01.CNT = AN03.CNT(+)
			  AND AN01.DPOB_CD = AN04.DPOB_CD(+)
			  AND AN01.YRTX_BLGG_YR = AN04.YRTX_BLGG_YR(+)
			  AND AN01.CLUT_SEPT_CD = AN04.CLUT_SEPT_CD(+)
			  AND AN01.SYSTEMKEY = AN04.SYSTEMKEY(+) 
			   AND AN01.CNT = AN04.CNT(+)    
			   ORDER BY  AN01.CNT ASC  
			 )  AC04  
			WHERE AC01.DPOB_CD = AC02.DPOB_CD
			  AND AC01.YRTX_BLGG_YR = AC02.YRTX_BLGG_YR
			  AND AC01.CLUT_SEPT_CD = AC02.CLUT_SEPT_CD
			  AND AC01.SYSTEMKEY = AC02.SYSTEMKEY 
			   AND AC01.DPOB_CD = AC04.DPOB_CD
			  AND AC01.YRTX_BLGG_YR = AC04.YRTX_BLGG_YR
			  AND AC01.CLUT_SEPT_CD = AC04.CLUT_SEPT_CD
			  AND AC01.SYSTEMKEY = AC04.SYSTEMKEY 
			  AND AC01.DPOB_CD=#dpobCd#
              AND AC01.YRTX_BLGG_YR=#yrtxBlggYr#
               AND AC01.CLUT_SEPT_CD=#clutSeptCd#
              AND AC01.SYSTEMKEY=#systemkey#   
                ORDER  BY AC01.SYSTEMKEY
    ]]>
	</select>	
	 
   
   
	<!--  H 레코드 - 기부금 조정명세 레코드   -->
   <select id="infcPkgYeta17File_2023_DAO.fnPayrHC_ReTax_Total_Select" parameterClass="infcFile17Ye161020_2023" resultClass="egovMap">       
         <![CDATA[  
          SELECT 
			    AC01.DPOB_CD, AC01.YRTX_BLGG_YR, AC01.CLUT_SEPT_CD, 
			    AC01.SYSTEMKEY 
			   ,AC02.FNM                /* 소득자성명  주소,사업장소재지     */ 
			   ,AC02.RESNO_ENC_CNTN     /* 주민등록번호         */ 
			   ,AC02.NNF_CL_CD          /* 내외국인구분          */
			   ,AC02.TNM                /* 근무처명          */
			   ,AC02.BSNO_ENC_CNTN      /* 사업자등록번호          */                 
			  ,AC04.CTRB_TYCD               /* 기부금유형신고코드         */
			    ,AC04.ATTR_YR            /* 기부년도        */
			    ,AC04.USE_AMT            /* 기부금액        */
			    ,AC04.PYR_DDC_AMT        /* 전년도공제된금액           */
			    ,AC04.DDC_TRGT_AMT        /* 기부금공제대상금액        */
			    ,AC04.THC_YR_DDC_AMT_ND_XPS    /* 해당연도공제금액필요경비    */
			    ,DECODE(AC04.CTRB_TYCD, '20', (CASE WHEN DECODE(AC02.C152_STD_TX_DDC_YN, 'Y', AC06.YETA_STD_C142, AC05.YETA_C142) = '0' 
												 THEN 0 
												 ELSE
												 (DECODE(AC02.C152_STD_TX_DDC_YN, 'Y', AC06.YETA_STD_C141, AC05.YETA_C141)) END
											+
											CASE WHEN DECODE(AC02.C152_STD_TX_DDC_YN, 'Y', AC06.YETA_STD_C144, AC05.YETA_C144) = '0' 
												 THEN 0 
												 ELSE 
												 (DECODE(AC02.C152_STD_TX_DDC_YN, 'Y',AC06.YETA_STD_C143, AC05.YETA_C143)) END),
									   '10', CASE WHEN DECODE(AC02.C152_STD_TX_DDC_YN, 'Y', AC06.YETA_STD_C146, AC05.YETA_C146) = '0' 
											  	THEN 0 
											  	ELSE
											  	(DECODE(AC02.C152_STD_TX_DDC_YN, 'Y', AC06.YETA_STD_C145, AC05.YETA_C145)) END,
									   '42', CASE WHEN DECODE(AC02.C152_STD_TX_DDC_YN, 'Y', AC06.YETA_STD_C148, AC05.YETA_C148) = '0' 
											  	THEN 0 
											  	ELSE
											  	(DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC06.YETA_STD_C147, AC05.YETA_C147)) END,
									   '40', CASE WHEN DECODE(AC02.C152_STD_TX_DDC_YN, 'Y', AC06.YETA_STD_C150, AC05.YETA_C150) = '0'
											    THEN 0 
											    ELSE
											    (DECODE(AC02.C152_STD_TX_DDC_YN,'Y', AC06.YETA_STD_C149, AC05.YETA_C149)) END,
									   '41', CASE WHEN DECODE(AC02.C152_STD_TX_DDC_YN, 'Y', AC06.YETA_STD_C150B, AC05.YETA_C150B) = '0' 
											    THEN 0 
											    ELSE
											    (DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC06.YETA_STD_C150A ,AC05.YETA_C150A)) END)
				 AS THC_YR_DDC_AMT        /* 해당연도공제금액세액공제금액    */
			    ,CASE WHEN (AC04.CTRB_TYCD IN ('10', '41', '40') AND AC04.ATTR_YR = '2022' AND AC02.C152_STD_TX_DDC_YN = 'Y') OR
							(DECODE(AC04.CTRB_TYCD, '20', DECODE(AC02.C152_STD_TX_DDC_YN, 'Y', AC06.YETA_STD_C142, AC05.YETA_C142), '42', DECODE(AC02.C152_STD_TX_DDC_YN, 'Y', AC06.YETA_STD_C148, AC05.YETA_C148)) = 0)
				 THEN AC04.DDC_TRGT_AMT ELSE AC04.THC_YR_NDUC_EXTN_AMT END
				 AS THC_YR_NDUC_EXTN_AMT    /* 해당연도미공제금액_소멸금액    */
			    ,CASE WHEN (AC04.CTRB_TYCD IN ('10', '41', '40') AND AC04.ATTR_YR = '2022' AND AC02.C152_STD_TX_DDC_YN = 'Y') OR AC04.CTRB_TYCD IN ('20', '42') THEN 0
				 ELSE 
				 (AC04.USE_AMT - (DECODE(AC04.CTRB_TYCD, 
									   '10', CASE WHEN DECODE(AC02.C152_STD_TX_DDC_YN, 'Y', AC06.YETA_STD_C146, AC05.YETA_C146) = '0' 
											  	THEN 0 
											  	ELSE
											  	(DECODE(AC02.C152_STD_TX_DDC_YN, 'Y', AC06.YETA_STD_C145, AC05.YETA_C145)) END,
									   '40', CASE WHEN DECODE(AC02.C152_STD_TX_DDC_YN, 'Y', AC06.YETA_STD_C150, AC05.YETA_C150) = '0'
											    THEN 0 
											    ELSE
											    (DECODE(AC02.C152_STD_TX_DDC_YN,'Y', AC06.YETA_STD_C149, AC05.YETA_C149)) END,
									   '41', CASE WHEN DECODE(AC02.C152_STD_TX_DDC_YN, 'Y', AC06.YETA_STD_C150B, AC05.YETA_C150B) = '0' 
											    THEN 0 
											    ELSE
											    (DECODE(AC02.C152_STD_TX_DDC_YN,'Y',AC06.YETA_STD_C150A ,AC05.YETA_C150A)) END))) END
				as THC_YR_NDUC_CRFW_AMT
			FROM YE161010 AC01 
			    ,YE161020 AC02
			    ,YE165030  AC04
				,YE169010  AC05
				,YE169010A AC06 
			WHERE AC01.DPOB_CD = AC02.DPOB_CD
			  AND AC01.YRTX_BLGG_YR = AC02.YRTX_BLGG_YR
			  AND AC01.CLUT_SEPT_CD = AC02.CLUT_SEPT_CD
			  AND AC01.SYSTEMKEY = AC02.SYSTEMKEY 
			   AND AC01.DPOB_CD = AC04.DPOB_CD
			  AND AC01.YRTX_BLGG_YR = AC04.YRTX_BLGG_YR
			  AND AC01.CLUT_SEPT_CD = AC04.CLUT_SEPT_CD
			  AND AC01.SYSTEMKEY = AC04.SYSTEMKEY 
			  AND AC04.CTRB_TYCD  NOT IN  ('31','50') 
			  AND AC04.USE_AMT > 0
			  AND AC01.DPOB_CD = AC05.DPOB_CD
			  AND AC01.YRTX_BLGG_YR = AC05.YRTX_BLGG_YR
			  AND AC01.CLUT_SEPT_CD = AC05.CLUT_SEPT_CD
			  AND AC01.SYSTEMKEY = AC05.SYSTEMKEY 
			  AND AC01.DPOB_CD = AC06.DPOB_CD
			  AND AC01.YRTX_BLGG_YR = AC06.YRTX_BLGG_YR
			  AND AC01.CLUT_SEPT_CD = AC06.CLUT_SEPT_CD
			  AND AC01.SYSTEMKEY = AC06.SYSTEMKEY 
			  AND AC01.DPOB_CD=#dpobCd#
              AND AC01.YRTX_BLGG_YR=#yrtxBlggYr#
               AND AC01.CLUT_SEPT_CD=#clutSeptCd#
              AND AC01.SYSTEMKEY=#systemkey#    
			 ORDER BY   AC01.DPOB_CD, AC01.YRTX_BLGG_YR, AC01.CLUT_SEPT_CD, 
			    AC01.SYSTEMKEY, to_number(AC04.CTRB_TYCD) ASC     
			 ]]>
	</select>	
	
	 
   <select id="infcPkgYeta17File_2023_DAO.fnPayrHD_ReTax_Total_Select" parameterClass="infcFile17Ye161020_2023" resultClass="egovMap">       
         <![CDATA[   
			SELECT 
			     AC01.DPOB_CD, AC01.YRTX_BLGG_YR, AC01.CLUT_SEPT_CD, 
			     AC01.SYSTEMKEY 
			    ,AC02.FNM                /* 소득자성명  주소,사업장소재지     */ 
			    ,AC02.RESNO_ENC_CNTN  AS ORG_RESNO_ENC_CNTN    /* 주민등록번호         */ 
			    ,AC02.NNF_CL_CD  AS ORG_NNF_CL_CD         /* 내외국인구분          */
			    ,AC02.TNM                /* 근무처명          */
			    ,AC02.BSNO_ENC_CNTN  AS ORG_BSNO_ENC_CNTN    /* 사업자등록번호          */                 
			    ,AC04.CONB_CHG_CD    /*  기부유형전환코드      */
			    ,AC04.YRS_MATE_CL_CD    /*  기부국세자료구분코드   */
			    ,AC04.DNTCNTN        /*  기부내용         */
			   , (CASE WHEN AC04.CONB_CHG_CD = '20' THEN ''
                   WHEN TRIM(REPLACE(AC04.COPL_NM,' ','')) = '회사일괄기부금' THEN ''     
                   ELSE REPLACE(AC04.BSNO_ENC_CNTN ,'-','') END) AS BSNO_ENC_CNTN      /*  기부처_사업자등록번호  */                                                                                                                             
               , (CASE WHEN AC04.CONB_CHG_CD = '20' THEN '' 
                   WHEN TRIM(REPLACE(AC04.COPL_NM,' ','')) = '회사일괄기부금' THEN '' 
                   ELSE SUBSTR(AC04.COPL_NM,1,30) END) AS COPL_NM   /*  기부처_상호명          */ 
			    ,AC04.CNBT_RLT_CHG_CD    /*  기부자관계전환코드     */
			    ,AC04.CNBT_FNM        /*  기부자성명         */
			    ,AC04.RESNO_ENC_CNTN    /*  기부자_주민등록번호    */
			    ,AC03.NNF_CL_CD
			    ,AC04.DNT_SCNT        /*  기부명세건수          */
			    ,AC04.USE_SUM_AMT    /*  기부명세합계금액         */
			    ,AC04.DDC_TRGT_CONB_AMT /*  공제대상기부금액         */
			    ,AC04.CONB_SUM_AMT    /*  기부장려금신청금         */
			    ,AC04.CNBT_ETC        /*  기부금기타         */
			FROM YE161010 AC01 
			    ,YE161020 AC02
			    ,YE161030 AC03 
			    ,YE165010 AC04  
			WHERE AC01.DPOB_CD = AC02.DPOB_CD
			  AND AC01.YRTX_BLGG_YR = AC02.YRTX_BLGG_YR
			  AND AC01.CLUT_SEPT_CD = AC02.CLUT_SEPT_CD
			  AND AC01.SYSTEMKEY = AC02.SYSTEMKEY
			  AND AC01.DPOB_CD = AC03.DPOB_CD
			  AND AC01.YRTX_BLGG_YR = AC03.YRTX_BLGG_YR
			  AND AC01.CLUT_SEPT_CD = AC03.CLUT_SEPT_CD
			  AND AC01.SYSTEMKEY = AC03.SYSTEMKEY
			  AND AC03.DPOB_CD = AC04.DPOB_CD
			  AND AC03.YRTX_BLGG_YR = AC04.YRTX_BLGG_YR
			  AND AC03.CLUT_SEPT_CD = AC04.CLUT_SEPT_CD
			  AND AC03.SYSTEMKEY = AC04.SYSTEMKEY
			  AND AC03.TXPR_DSCM_NO_CNTN  = AC04.RESNO_ENC_CNTN
			  AND AC04.CONB_CHG_CD  NOT IN  ('31','50') 
			  AND AC04.USE_SUM_AMT > 0
			  AND AC01.DPOB_CD=#dpobCd#
	          AND AC01.YRTX_BLGG_YR=#yrtxBlggYr#
	          AND AC01.CLUT_SEPT_CD=#clutSeptCd#
	          AND AC01.SYSTEMKEY=#systemkey# 
         ORDER BY  AC01.SYSTEMKEY,TO_NUMBER(AC04.CONB_CHG_CD)  ASC 
			 ]]>
	</select>	
	
    
	 <!-- B레코드 - 원천징수의무자별 집계레코드  -->
	<select id="infcPkgYeta17File_2023_DAO.fnPayrHB_ReTax_Total_Select" parameterClass="infcFile17Ye161020_2023" resultClass="egovMap">
		<![CDATA[
	 SELECT COUNT (YETA3170.CTRB_TYCD) AS CTRB_CNT,
       SUM (YETA3180_CNT) AS YETA3180_CNT,
       SUM (CTRB_AMNT) AS CTRB_AMNT,
       SUM (DETR_AMNT) AS DETR_AMNT
  FROM YETA3170,
  (  SELECT           DPOB_CD,
                 SYSTEMKEY,
                 CLUT_SEPT_CD,
                 YRTX_BLGG_YR,
                 CTRB_TYCD, 
                 COUNT (CTRB_TYCD) AS YETA3180_CNT
   FROM                
  (              
 SELECT          DPOB_CD,
                 SYSTEMKEY,
                 CLUT_SEPT_CD,
                 YRTX_BLGG_YR,
                 CTRB_TYCD,
                 REPLACE(CTRB_BSNU,'-','') AS CTRB_BSNU,
                 RSNO_NUMB  
            FROM YETA3180
           WHERE CTRB_TYCD NOT IN ('31', '50') 
   GROUP BY DPOB_CD,
                 SYSTEMKEY,
                 CLUT_SEPT_CD,
                 YRTX_BLGG_YR,
                 CTRB_TYCD, 
                 RSNO_NUMB,
                 REPLACE(CTRB_BSNU,'-','')
                 )
    GROUP BY  DPOB_CD,
                 SYSTEMKEY,
                 CLUT_SEPT_CD,
                 YRTX_BLGG_YR,
                 CTRB_TYCD 
                 ) YETA3180,  ]]>
    (
                             SELECT    DISTINCT  AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,(SELECT ( PSNL0111.HUS_ROAD_NM_FNDTN_ADDR || ' ' || PSNL0111.HUS_ROAD_NM_DTL_PATR_ADDR )
                                                 FROM PSNL0111  
                                                WHERE PSNL0111.DPOB_CD  = AD02.DPOB_CD
                                                  AND PSNL0111.SYSTEMKEY = AD02.SYSTEMKEY)  AS ADDR_POST   /* 소득자주소 */ 
                                              ,(SELECT  PSNL0111.HUS_PHN_NUM 
                                                 FROM PSNL0111  
                                                WHERE PSNL0111.DPOB_CD  = AD02.DPOB_CD
                                                  AND PSNL0111.SYSTEMKEY = AD02.SYSTEMKEY)  AS HUS_PHN_NUM             /* 집전화번호 */         
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                 , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
											, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
											, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
											, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
											, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
											, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
											, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT 
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01, (SELECT
											DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
											   PAY_CD,  PAYR_MANG_DEPT_CD, 
											   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
											   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
											     ODTY_CD, PYSP_CD, 
											     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
											   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
											   HDOFC_DIV_CD, RETRY_DT 
											FROM
											(SELECT 
											   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
											   PAY_CD,  PAYR_MANG_DEPT_CD, 
											   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
											   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
											     ODTY_CD, PYSP_CD, 
											     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
											   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
											   HDOFC_DIV_CD, RETRY_DT 
											FROM  PAYR0304 
											UNION ALL
											SELECT 
											   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY, (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
											   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
											   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
											   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
											   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
											   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
											   HDOFC_DIV_CD, RETRY_DT 
											FROM  PYYT0304)) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                    SELECT   MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                             ) 
									                                          GROUP BY  DPOB_CD,    SYSTEMKEY     
									                                            ) MM  
									                                          
									                                             ) GG
									                            WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                                 /*     AND NN.PAYR_SEIL_NUM =  GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%' 
          ) TA01   , YETA2000, YE161005 DD                                                                                                                                   
    WHERE YETA3170.DPOB_CD   = TA01.DPOB_CD
      AND YETA3170.SYSTEMKEY = TA01.SYSTEMKEY  
       AND YETA3180.DPOB_CD(+) = YETA3170.DPOB_CD
       AND YETA3180.YRTX_BLGG_YR(+) = YETA3170.YRTX_BLGG_YR
       AND YETA3180.CLUT_SEPT_CD(+) = YETA3170.CLUT_SEPT_CD
       AND YETA3180.SYSTEMKEY(+) = YETA3170.SYSTEMKEY
       AND YETA3180.CTRB_TYCD(+) = YETA3170.CTRB_TYCD
       AND YETA3180.YRTX_BLGG_YR(+) = YETA3170.CTRB_YRMN
      AND YETA3170.CTRB_TYCD  NOT IN  ('31','50') 
      AND YETA2000.YRTX_BLGG_YR   = YETA3170.YRTX_BLGG_YR
       AND YETA2000.CLUT_SEPT_CD  = YETA3170.CLUT_SEPT_CD
       AND YETA2000.DPOB_CD = YETA3170.DPOB_CD
        AND YETA2000.SYSTEMKEY = YETA3170.SYSTEMKEY
        AND YETA2000.DPOB_CD = DD.DPOB_CD(+)
        AND YETA2000.YETA_DPCD = DD.WHDG_TX_REGRST_DEPT_CD(+)
        <isNotEmpty prepend="AND" property="yrtxBlggYr" >
                 YETA3170.YRTX_BLGG_YR = #yrtxBlggYr#
            </isNotEmpty>  
            <isNotEmpty prepend="AND" property="clutSeptCd" >
                 YETA3170.CLUT_SEPT_CD=#clutSeptCd#
            </isNotEmpty>
                  <isNotEmpty prepend="AND" property="busoprRgstnum" >
							DD.BUSOPR_RGSTNUM(+) = #busoprRgstnum#
				    	</isNotEmpty> 
            			<isNotEmpty property="yetaDpcd" >
		         			<isEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
								YETA2000.YETA_DPCD IS NULL
							</isEqual>
							<isNotEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
							YETA2000.YETA_DPCD=#yetaDpcd#
							</isNotEqual>
	          			</isNotEmpty>  
   <isNotEmpty prepend="AND" property="systemkey" >
         YETA3170.SYSTEMKEY=#systemkey#
     </isNotEmpty> 
         AND EXISTS  (
                  SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             ( 
                                              SELECT  AA02.DPOB_CD,
                                                     AA02.DEPT_CD,
                                                     AA02.TYP_OCCU_CD,
                                                     AA02.DTIL_OCCU_INTTN_CD 
                                                FROM  BASS0360 AA02  
                                                WHERE AA02.PAYR_MANG_DEPT_CD LIKE (DECODE(#payrMangDeptYn#,'Y',#payrMangDeptCd#,DECODE(#deptCd#,'',#payrMangDeptCd#,''))) || '%'  
                                                AND   NOT EXISTS (SELECT DPOB_CD 
                                                                      , TYP_OCCU_CD
                                                                      , DEPT_CD
                                                                      , DTIL_OCCU_INTTN_CD
                                                                FROM SYSM0700 AA01
                                                                WHERE AA01.DPOB_CD = AA02.DPOB_CD
                                                                  AND AA01.TYP_OCCU_CD = AA02.TYP_OCCU_CD
                                                                  AND AA01.DEPT_CD = AA02.DEPT_CD
                                                                 AND AA01.DTIL_OCCU_INTTN_CD = AA02.DTIL_OCCU_INTTN_CD ) 
                                                AND (AA02.DPOB_CD,AA02.PAYR_MANG_DEPT_CD) IN (SELECT DPOB_CD, PAYR_MANG_DEPT_CD  
                                                                                FROM BASS0150 
                                                                                 WHERE PAY_MANGE_DEPT_WHLE_PERN_CHRG
                                                                                     LIKE (DECODE(#payrMangDeptYn#,'Y',#usrId#, DECODE(#payrMangDeptYn#,'N',#usrId#,
                                                                                      DECODE(#payrMangDeptCd#,#deptCdAuth#,#usrId#,
                                                                                                  (SELECT NVL(USR_ID,'') FROM SYSM0700
                                                                                                                      WHERE USR_ID = #usrId#))))) || '%'  
                                                                               UNION ALL
                                                                               SELECT DPOB_CD,
                                                                                      PAYR_MANG_DEPT_CD
                                                                                 FROM BASS0150
                                                                                WHERE PAYR_MANG_DEPT_CD LIKE (DECODE (#deptCd#, '', #payrMangDeptCd#, ''))   || '%') 
                                                UNION ALL                 
                                                SELECT  AA03.DPOB_CD
                                                       , AA03.DEPT_CD 
                                                       , AA03.TYP_OCCU_CD
                                                       , AA03.DTIL_OCCU_INTTN_CD 
                                                FROM SYSM0700 AA03
                                                WHERE AA03.USR_ID LIKE (DECODE(#payrMangDeptYn#,'Y',#usrId#, DECODE(#payrMangDeptYn#,'N',#usrId#,  
                                                                         DECODE(#payrMangDeptCd#,#deptCdAuth#,#usrId#,''))  
                                                                        )) || '%'  
                                                UNION ALL
                                                 SELECT   
                                                                               BB01.DPOB_CD, BB01.DEPT_CD
                                                                               ,('') AS TYP_OCCU_CD ,('') AS DTIL_OCCU_INTTN_CD
                                                                             FROM (SELECT AA.DPOB_CD  , AA.DEPT_CD  
                                                                                          , AA.TPLVL_DEPT_CD  , AA.HHRK_DEPT_CD  
                                                                                         FROM BASS0400 AA 
                                                                                        WHERE AA.DEPT_USE_YN   = 'Y'  
                                                                                         AND  AA.DEPT_CD = #payrMangDeptCd#    
                                                                                UNION ALL
                                                                                SELECT AA02.*
                                                                                FROM (
                                                                                    SELECT  CC.DPOB_CD   , CC.DEPT_CD  
                                                                                          , CC.TPLVL_DEPT_CD , CC.HHRK_DEPT_CD  
                                                                                         FROM BASS0400 CC 
                                                                                        WHERE CC.DEPT_USE_YN   = 'Y'   
                                                                                     ) AA02
                                                                              START WITH AA02.HHRK_DEPT_CD =  #payrMangDeptCd#   
                                                                             CONNECT BY PRIOR AA02.DEPT_CD = AA02.HHRK_DEPT_CD ) BB01 
                                                                           WHERE  BB01.DPOB_CD= #dpobCd# 
                                            UNION ALL
                                             SELECT
                                                 DD01.DPOB_CD,
                                                 DD01.DEPT_CD,
                                                 DD00.TYP_OCCU_CD,
                                                 DD00.DTIL_OCCU_INTTN_CD 
                                                 FROM    BASS0350 DD00,
                                                              (SELECT  AA02.DPOB_CD,
                                                                                         AA02.DEPT_CD,
                                                                                         AA02.TYP_OCCU_CD,
                                                                                         AA02.DTIL_OCCU_INTTN_CD 
                                                                                    FROM  BASS0360 AA02  
                                                                                    WHERE AA02.PAYR_MANG_DEPT_CD LIKE (DECODE(#payrMangDeptYn#,'Y',#payrMangDeptCd#,DECODE(#deptCd#,'',#payrMangDeptCd#,''))) || '%'  
                                                                                    AND   NOT EXISTS (SELECT DPOB_CD 
                                                                                                          , TYP_OCCU_CD
                                                                                                          , DEPT_CD
                                                                                                          , DTIL_OCCU_INTTN_CD
                                                                                                    FROM SYSM0700 AA01
                                                                                                    WHERE AA01.DPOB_CD = AA02.DPOB_CD
                                                                                                      AND AA01.TYP_OCCU_CD = AA02.TYP_OCCU_CD
                                                                                                      AND AA01.DEPT_CD = AA02.DEPT_CD
                                                                                                     AND AA01.DTIL_OCCU_INTTN_CD = AA02.DTIL_OCCU_INTTN_CD ) 
                                                                                    AND (AA02.DPOB_CD,AA02.PAYR_MANG_DEPT_CD) IN (SELECT DPOB_CD, PAYR_MANG_DEPT_CD  
                                                                                                                    FROM BASS0150 
                                                                                                                     WHERE PAY_MANGE_DEPT_WHLE_PERN_CHRG
                                                                                                                         LIKE (DECODE(#payrMangDeptYn#,'Y',#usrId#, DECODE(#payrMangDeptYn#,'N',#usrId#,
                                                                                                                          DECODE(#payrMangDeptCd#,#deptCdAuth#,#usrId#,
                                                                                                                                      (SELECT NVL(USR_ID,'') FROM SYSM0700
                                                                                                                                                          WHERE USR_ID = #usrId#))))) || '%'  
                                                                                                                   UNION ALL
                                                                                                                   SELECT DPOB_CD,
                                                                                                                          PAYR_MANG_DEPT_CD
                                                                                                                     FROM BASS0150
                                                                                                                    WHERE PAYR_MANG_DEPT_CD LIKE (DECODE (#deptCd#, '', #payrMangDeptCd#, ''))   || '%') 
                                                                                    UNION ALL                 
                                                                                    SELECT  AA03.DPOB_CD
                                                                                           , AA03.DEPT_CD 
                                                                                           , AA03.TYP_OCCU_CD
                                                                                           , AA03.DTIL_OCCU_INTTN_CD 
                                                                                    FROM SYSM0700 AA03
                                                                                    WHERE AA03.USR_ID LIKE (DECODE(#payrMangDeptYn#,'Y',#usrId#, DECODE(#payrMangDeptYn#,'N',#usrId#,  
                                                                                                             DECODE(#payrMangDeptCd#,#deptCdAuth#,#usrId#,''))  
                                                                                                            )) || '%'  
                                                                                    UNION ALL
                                                                                     SELECT   
                                                                                                                   BB01.DPOB_CD, BB01.DEPT_CD
                                                                                                                   ,('') AS TYP_OCCU_CD ,('') AS DTIL_OCCU_INTTN_CD
                                                                                                                 FROM (SELECT AA.DPOB_CD  , AA.DEPT_CD  
                                                                                                                              , AA.TPLVL_DEPT_CD  , AA.HHRK_DEPT_CD  
                                                                                                                             FROM BASS0400 AA 
                                                                                                                            WHERE AA.DEPT_USE_YN   = 'Y'  
                                                                                                                             AND  AA.DEPT_CD = #payrMangDeptCd#    
                                                                                                                    UNION ALL
                                                                                                                    SELECT AA02.*
                                                                                                                    FROM (
                                                                                                                        SELECT  CC.DPOB_CD   , CC.DEPT_CD  
                                                                                                                              , CC.TPLVL_DEPT_CD , CC.HHRK_DEPT_CD  
                                                                                                                             FROM BASS0400 CC 
                                                                                                                            WHERE CC.DEPT_USE_YN   = 'Y'   
                                                                                                                         ) AA02
                                                                                                                  START WITH AA02.HHRK_DEPT_CD =  #payrMangDeptCd#   
                                                                                                                 CONNECT BY PRIOR AA02.DEPT_CD = AA02.HHRK_DEPT_CD ) BB01 
                                                                                                               WHERE  BB01.DPOB_CD= #dpobCd# ) DD01
                                             WHERE DD00.CHNG_TYP_OCCU_CD = DD01.TYP_OCCU_CD
                                               AND DD00.CHNG_DTIL_OCCU_INTTN_CD = DD01.DTIL_OCCU_INTTN_CD
                                               AND   SUBSTR((NVL(#yrtxBlggYr#,TO_CHAR(SYSDATE,'YYYYMMDD'))) ,1,4)    
                                                               BETWEEN SUBSTR(NVL(DD00.DTIL_OCCU_INTTN_STDT,(TO_CHAR(SYSDATE,'YYYYMMDD'))),1,4)  
                                                                AND SUBSTR(NVL(DD00.DTIL_OCCU_INTTN_EDDT, (TO_CHAR(SYSDATE,'YYYYMMDD'))),1,4)          
                                           ) C
                                    WHERE     C.DPOB_CD = TA01.DPOB_CD
                                        AND C.DEPT_CD = TA01.DEPT_CD
                                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(TA01.TYP_OCCU_CD,'TT') 
                                        AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(TA01.DTIL_OCCU_INTTN_CD,'TT')
                                         <isNotEmpty property="deptCd" prepend="AND">
                                        <![CDATA[
                                         C.DEPT_CD
                                        ]]>
                                        <iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
                                         #deptCdArr[]#
                                        </iterate>
                                        </isNotEmpty>  
                                  )
           <isNotEmpty property="businCd" prepend="AND">
            <![CDATA[
              TA01.BUSIN_CD
            ]]>
            <iterate prepend="IN" property="businCdArr" open="(" close=")" conjunction=",">
             #businCdArr[]#
            </iterate>
            </isNotEmpty>       
               
               <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                 TA01.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
               </isNotEmpty> 
               <isNotEmpty prepend="AND" property="emymtDivCd" >
                 TA01.EMYMT_DIV_CD=#emymtDivCd#
                 </isNotEmpty>  
             <isNotEmpty property="typOccuCd" prepend="AND">
            <![CDATA[
             TA01.TYP_OCCU_CD
            ]]>
            <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
             #typOccuCdArr[]#
            </iterate>
            </isNotEmpty>  
                  
            <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
                <![CDATA[
                     TA01.DTIL_OCCU_INTTN_CD
                ]]>
                <iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
                     #dtilOccuInttnCdArr[]#
                </iterate> 
          </isNotEmpty>   
		  
	</select>
	
	
   
	
	<!-- C 레코드 - 기부금 조정명세 레코드   -->
	<select id="infcPkgYeta17File_2023_DAO.fnPayrPSNL_ReTax_Total_Select" parameterClass="infcFile17Ye161020_2023" resultClass="egovMap">
	     <![CDATA[ 
   SELECT    YETA3000.DPOB_CD,
           YETA3000.SYSTEMKEY,YETA3000.CLUT_SEPT_CD,YETA3000.YRTX_BLGG_YR,                                                                                                                                                      
          YETA3000.BEFO_SCNT,                                                                                                                                 
          DECODE(YETA2000.RESD_FLAG,'1','1','2') AS RESD_FLAG,                                                                                          
          NVL(YETA2000.REDT_GBCD,' ') AS REDT_GBCD,                                                                                                                                 
          DECODE(YETA2000.FRNR_SGYN,'1','1','2') AS FRNR_SGYN,                                                                                          
          YETA2000.HAN_NM AS KORN_NAME,                                                                                                                                 
          YETA2000.FRNR_YENO,                                                                                                                                 
          YETA2000.RESN_REGN_NUM,                                                                                                                                 
          NVL(YETA2000.NATN_GBCD,' ') AS NATN_GBCD,                                                                                                                                 
          YETA2000.GNAN_SGTF,              
          (CASE WHEN TA01.HDOFC_CODTN_CD <> 'A0030020' THEN '1' ELSE '2' END) AS HDOFC_CODTN_YN, /** 계속근로 여부 재직상태코드로 처리함. */    
          DECODE(NVL(YETA2000.REYM_STDT,''),'','20160101',YETA2000.REYM_STDT)AS REYM_STDT,                                                               
          DECODE(NVL(YETA2000.REYM_EDDT,''),'','20161231',YETA2000.REYM_EDDT)AS REYM_EDDT,                                                               
          DECODE(NVL(YETA2000.RUTR_STDT,''),'','00000000',YETA2000.RUTR_STDT)AS RUTR_STDT,                                                               
          DECODE(NVL(YETA2000.RUTR_EDDT,''),'','00000000',YETA2000.RUTR_EDDT)AS RUTR_EDDT   ]]>                       
  FROM  YETA2000, YETA3000, (
                             SELECT     DISTINCT       AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,(SELECT ( PSNL0111.HUS_ROAD_NM_FNDTN_ADDR || ' ' || PSNL0111.HUS_ROAD_NM_DTL_PATR_ADDR )
                                                 FROM PSNL0111  
                                                WHERE PSNL0111.DPOB_CD  = AD02.DPOB_CD
                                                  AND PSNL0111.SYSTEMKEY = AD02.SYSTEMKEY)  AS ADDR_POST   /* 소득자주소 */ 
                                              ,(SELECT  PSNL0111.HUS_PHN_NUM 
                                                 FROM PSNL0111  
                                                WHERE PSNL0111.DPOB_CD  = AD02.DPOB_CD
                                                  AND PSNL0111.SYSTEMKEY = AD02.SYSTEMKEY)  AS HUS_PHN_NUM             /* 집전화번호 */         
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT 
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01, (SELECT
											DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
											   PAY_CD,  PAYR_MANG_DEPT_CD, 
											   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
											   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
											     ODTY_CD, PYSP_CD, 
											     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
											   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
											   HDOFC_DIV_CD, RETRY_DT 
											FROM
											(SELECT 
											   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
											   PAY_CD,  PAYR_MANG_DEPT_CD, 
											   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
											   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
											     ODTY_CD, PYSP_CD, 
											     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
											   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
											   HDOFC_DIV_CD, RETRY_DT 
											FROM  PAYR0304 
											UNION ALL
											SELECT 
											   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY, (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
											   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
											   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
											   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
											   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
											   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
											   HDOFC_DIV_CD, RETRY_DT 
											FROM  PYYT0304)) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                    SELECT   MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                             ) 
									                                          GROUP BY  DPOB_CD,    SYSTEMKEY     
									                                            ) MM  
									                                          
									                                             ) GG
									                            WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                                 /*     AND NN.PAYR_SEIL_NUM =  GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%' 
          ) TA01 ,   YE161005 DD                                                                                                                                         
    WHERE YETA2000.DPOB_CD   = TA01.DPOB_CD
      AND YETA2000.SYSTEMKEY = TA01.SYSTEMKEY  
      AND YETA2000.DPOB_CD   = YETA3000.DPOB_CD
      AND YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                               
      AND YETA2000.YRTX_BLGG_YR = YETA3000.YRTX_BLGG_YR                                                                                                               
      AND YETA2000.CLUT_SEPT_CD = YETA3000.CLUT_SEPT_CD  
        AND YETA2000.DPOB_CD = DD.DPOB_CD(+)
        AND YETA2000.YETA_DPCD = DD.WHDG_TX_REGRST_DEPT_CD(+)
        <isNotEmpty prepend="AND" property="yrtxBlggYr" >
                 YETA2000.YRTX_BLGG_YR = #yrtxBlggYr#
            </isNotEmpty> 
                  <isNotEmpty prepend="AND" property="busoprRgstnum" >
							DD.BUSOPR_RGSTNUM(+) = #busoprRgstnum#
				    	</isNotEmpty>  
            			<isNotEmpty property="yetaDpcd" >
		         			<isEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
								YETA2000.YETA_DPCD IS NULL
							</isEqual>
							<isNotEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
							YETA2000.YETA_DPCD=#yetaDpcd#
							</isNotEqual>
	          			</isNotEmpty>  
            <isNotEmpty prepend="AND" property="clutSeptCd" >
                 YETA2000.CLUT_SEPT_CD=#clutSeptCd#
            </isNotEmpty>
   <isNotEmpty prepend="AND" property="systemkey" >
         YETA2000.SYSTEMKEY=#systemkey#
     </isNotEmpty> 
         AND EXISTS  (
                   SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             ( 
                                              SELECT  AA02.DPOB_CD,
                                                     AA02.DEPT_CD,
                                                     AA02.TYP_OCCU_CD,
                                                     AA02.DTIL_OCCU_INTTN_CD 
                                                FROM  BASS0360 AA02  
                                                WHERE AA02.PAYR_MANG_DEPT_CD LIKE (DECODE(#payrMangDeptYn#,'Y',#payrMangDeptCd#,DECODE(#deptCd#,'',#payrMangDeptCd#,''))) || '%'  
                                                AND   NOT EXISTS (SELECT DPOB_CD 
                                                                      , TYP_OCCU_CD
                                                                      , DEPT_CD
                                                                      , DTIL_OCCU_INTTN_CD
                                                                FROM SYSM0700 AA01
                                                                WHERE AA01.DPOB_CD = AA02.DPOB_CD
                                                                  AND AA01.TYP_OCCU_CD = AA02.TYP_OCCU_CD
                                                                  AND AA01.DEPT_CD = AA02.DEPT_CD
                                                                 AND AA01.DTIL_OCCU_INTTN_CD = AA02.DTIL_OCCU_INTTN_CD ) 
                                                AND (AA02.DPOB_CD,AA02.PAYR_MANG_DEPT_CD) IN (SELECT DPOB_CD, PAYR_MANG_DEPT_CD  
                                                                                FROM BASS0150 
                                                                                 WHERE PAY_MANGE_DEPT_WHLE_PERN_CHRG
                                                                                     LIKE (DECODE(#payrMangDeptYn#,'Y',#usrId#, DECODE(#payrMangDeptYn#,'N',#usrId#,
                                                                                      DECODE(#payrMangDeptCd#,#deptCdAuth#,#usrId#,
                                                                                                  (SELECT NVL(USR_ID,'') FROM SYSM0700
                                                                                                                      WHERE USR_ID = #usrId#))))) || '%'  
                                                                               UNION ALL
                                                                               SELECT DPOB_CD,
                                                                                      PAYR_MANG_DEPT_CD
                                                                                 FROM BASS0150
                                                                                WHERE PAYR_MANG_DEPT_CD LIKE (DECODE (#deptCd#, '', #payrMangDeptCd#, ''))   || '%') 
                                                UNION ALL                 
                                                SELECT  AA03.DPOB_CD
                                                       , AA03.DEPT_CD 
                                                       , AA03.TYP_OCCU_CD
                                                       , AA03.DTIL_OCCU_INTTN_CD 
                                                FROM SYSM0700 AA03
                                                WHERE AA03.USR_ID LIKE (DECODE(#payrMangDeptYn#,'Y',#usrId#, DECODE(#payrMangDeptYn#,'N',#usrId#,  
                                                                         DECODE(#payrMangDeptCd#,#deptCdAuth#,#usrId#,''))  
                                                                        )) || '%'  
                                                UNION ALL
                                                 SELECT   
                                                                               BB01.DPOB_CD, BB01.DEPT_CD
                                                                               ,('') AS TYP_OCCU_CD ,('') AS DTIL_OCCU_INTTN_CD
                                                                             FROM (SELECT AA.DPOB_CD  , AA.DEPT_CD  
                                                                                          , AA.TPLVL_DEPT_CD  , AA.HHRK_DEPT_CD  
                                                                                         FROM BASS0400 AA 
                                                                                        WHERE AA.DEPT_USE_YN   = 'Y'  
                                                                                         AND  AA.DEPT_CD = #payrMangDeptCd#    
                                                                                UNION ALL
                                                                                SELECT AA02.*
                                                                                FROM (
                                                                                    SELECT  CC.DPOB_CD   , CC.DEPT_CD  
                                                                                          , CC.TPLVL_DEPT_CD , CC.HHRK_DEPT_CD  
                                                                                         FROM BASS0400 CC 
                                                                                        WHERE CC.DEPT_USE_YN   = 'Y'   
                                                                                     ) AA02
                                                                              START WITH AA02.HHRK_DEPT_CD =  #payrMangDeptCd#   
                                                                             CONNECT BY PRIOR AA02.DEPT_CD = AA02.HHRK_DEPT_CD ) BB01 
                                                                           WHERE  BB01.DPOB_CD= #dpobCd# 
                                            UNION ALL
                                             SELECT
                                                 DD01.DPOB_CD,
                                                 DD01.DEPT_CD,
                                                 DD00.TYP_OCCU_CD,
                                                 DD00.DTIL_OCCU_INTTN_CD 
                                                 FROM    BASS0350 DD00,
                                                              (SELECT  AA02.DPOB_CD,
                                                                                         AA02.DEPT_CD,
                                                                                         AA02.TYP_OCCU_CD,
                                                                                         AA02.DTIL_OCCU_INTTN_CD 
                                                                                    FROM  BASS0360 AA02  
                                                                                    WHERE AA02.PAYR_MANG_DEPT_CD LIKE (DECODE(#payrMangDeptYn#,'Y',#payrMangDeptCd#,DECODE(#deptCd#,'',#payrMangDeptCd#,''))) || '%'  
                                                                                    AND   NOT EXISTS (SELECT DPOB_CD 
                                                                                                          , TYP_OCCU_CD
                                                                                                          , DEPT_CD
                                                                                                          , DTIL_OCCU_INTTN_CD
                                                                                                    FROM SYSM0700 AA01
                                                                                                    WHERE AA01.DPOB_CD = AA02.DPOB_CD
                                                                                                      AND AA01.TYP_OCCU_CD = AA02.TYP_OCCU_CD
                                                                                                      AND AA01.DEPT_CD = AA02.DEPT_CD
                                                                                                     AND AA01.DTIL_OCCU_INTTN_CD = AA02.DTIL_OCCU_INTTN_CD ) 
                                                                                    AND (AA02.DPOB_CD,AA02.PAYR_MANG_DEPT_CD) IN (SELECT DPOB_CD, PAYR_MANG_DEPT_CD  
                                                                                                                    FROM BASS0150 
                                                                                                                     WHERE PAY_MANGE_DEPT_WHLE_PERN_CHRG
                                                                                                                         LIKE (DECODE(#payrMangDeptYn#,'Y',#usrId#, DECODE(#payrMangDeptYn#,'N',#usrId#,
                                                                                                                          DECODE(#payrMangDeptCd#,#deptCdAuth#,#usrId#,
                                                                                                                                      (SELECT NVL(USR_ID,'') FROM SYSM0700
                                                                                                                                                          WHERE USR_ID = #usrId#))))) || '%'  
                                                                                                                   UNION ALL
                                                                                                                   SELECT DPOB_CD,
                                                                                                                          PAYR_MANG_DEPT_CD
                                                                                                                     FROM BASS0150
                                                                                                                    WHERE PAYR_MANG_DEPT_CD LIKE (DECODE (#deptCd#, '', #payrMangDeptCd#, ''))   || '%') 
                                                                                    UNION ALL                 
                                                                                    SELECT  AA03.DPOB_CD
                                                                                           , AA03.DEPT_CD 
                                                                                           , AA03.TYP_OCCU_CD
                                                                                           , AA03.DTIL_OCCU_INTTN_CD 
                                                                                    FROM SYSM0700 AA03
                                                                                    WHERE AA03.USR_ID LIKE (DECODE(#payrMangDeptYn#,'Y',#usrId#, DECODE(#payrMangDeptYn#,'N',#usrId#,  
                                                                                                             DECODE(#payrMangDeptCd#,#deptCdAuth#,#usrId#,''))  
                                                                                                            )) || '%'  
                                                                                    UNION ALL
                                                                                     SELECT   
                                                                                                                   BB01.DPOB_CD, BB01.DEPT_CD
                                                                                                                   ,('') AS TYP_OCCU_CD ,('') AS DTIL_OCCU_INTTN_CD
                                                                                                                 FROM (SELECT AA.DPOB_CD  , AA.DEPT_CD  
                                                                                                                              , AA.TPLVL_DEPT_CD  , AA.HHRK_DEPT_CD  
                                                                                                                             FROM BASS0400 AA 
                                                                                                                            WHERE AA.DEPT_USE_YN   = 'Y'  
                                                                                                                             AND  AA.DEPT_CD = #payrMangDeptCd#    
                                                                                                                    UNION ALL
                                                                                                                    SELECT AA02.*
                                                                                                                    FROM (
                                                                                                                        SELECT  CC.DPOB_CD   , CC.DEPT_CD  
                                                                                                                              , CC.TPLVL_DEPT_CD , CC.HHRK_DEPT_CD  
                                                                                                                             FROM BASS0400 CC 
                                                                                                                            WHERE CC.DEPT_USE_YN   = 'Y'   
                                                                                                                         ) AA02
                                                                                                                  START WITH AA02.HHRK_DEPT_CD =  #payrMangDeptCd#   
                                                                                                                 CONNECT BY PRIOR AA02.DEPT_CD = AA02.HHRK_DEPT_CD ) BB01 
                                                                                                               WHERE  BB01.DPOB_CD= #dpobCd# ) DD01
                                             WHERE DD00.CHNG_TYP_OCCU_CD = DD01.TYP_OCCU_CD
                                               AND DD00.CHNG_DTIL_OCCU_INTTN_CD = DD01.DTIL_OCCU_INTTN_CD
                                               AND   SUBSTR((NVL(#yrtxBlggYr#,TO_CHAR(SYSDATE,'YYYYMMDD'))) ,1,4)    
                                                               BETWEEN SUBSTR(NVL(DD00.DTIL_OCCU_INTTN_STDT,(TO_CHAR(SYSDATE,'YYYYMMDD'))),1,4)  
                                                                AND SUBSTR(NVL(DD00.DTIL_OCCU_INTTN_EDDT, (TO_CHAR(SYSDATE,'YYYYMMDD'))),1,4)          
                                           ) C
                                    WHERE     C.DPOB_CD = TA01.DPOB_CD
                                        AND C.DEPT_CD = TA01.DEPT_CD
                                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(TA01.TYP_OCCU_CD,'TT') 
                                        AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(TA01.DTIL_OCCU_INTTN_CD,'TT')
                                         <isNotEmpty property="deptCd" prepend="AND">
                                        <![CDATA[
                                         C.DEPT_CD
                                        ]]>
                                        <iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
                                         #deptCdArr[]#
                                        </iterate>
                                        </isNotEmpty>  
                                  ) 
            <isNotEmpty property="businCd" prepend="AND">
            <![CDATA[
              TA01.BUSIN_CD
            ]]>
            <iterate prepend="IN" property="businCdArr" open="(" close=")" conjunction=",">
             #businCdArr[]#
            </iterate>
            </isNotEmpty> 
               <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                 TA01.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
               </isNotEmpty> 
               <isNotEmpty prepend="AND" property="emymtDivCd" >
                 TA01.EMYMT_DIV_CD=#emymtDivCd#
                 </isNotEmpty>  
             <isNotEmpty property="typOccuCd" prepend="AND">
            <![CDATA[
             TA01.TYP_OCCU_CD
            ]]>
            <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
             #typOccuCdArr[]#
            </iterate>
            </isNotEmpty>  
                  
            <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
                <![CDATA[
                     TA01.DTIL_OCCU_INTTN_CD
                ]]>
                <iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
                     #dtilOccuInttnCdArr[]#
                </iterate> 
          </isNotEmpty>  
 
	</select>	
	
   
   
    <!-- A레코드 - 의료비지급명세서 레코드    -->   
   <select id="infcPkgYeta17File_2023_DAO.fnPayrPSNL_ReTax_CA_Total_Select" parameterClass="infcFile17Ye161020_2023" resultClass="egovMap">       
      <![CDATA[      	
    SELECT 
       AC01.DPOB_CD
     , AC01.YRTX_BLGG_YR
     , AC01.CLUT_SEPT_CD
     , AC01.SYSTEMKEY  
     , AC01.PAYR_MANG_DEPT_CD
     , AC01.UT_DPOB_CD
     , TA01.EMYMT_DIV_CD
     , TA01.DEPT_CD
     , TA01.TYP_OCCU_CD
     , TA01.DTIL_OCCU_INTTN_CD
     , TA01.BUSIN_CD
     , AC01.PERN_CHRG_EMP_IDEN_NUM
     , AC01.CLOS_FLAG
     , AC01.CLOS_CONT
     , AC01.CLOS_DATE, 
     AC01.EDAC_PRDT, TA01.ODTY_CD, TA01.PYSP_CD, 
     TA01.LOG_SVC_YR_NUM_CD, TA01.LOG_SVC_MNTH_ICM_CD, TA01.FRST_EMYMT_DT, 
     TA01.EMYMT_BGNN_DT, TA01.EMYMT_END_DT, TA01.HDOFC_CODTN_CD, 
     TA01.RETRY_DT, AC01.YRTX_APPTN_YR_MNTH, AC01.YRTX_PRCS_DT
    ,AC01.YRTX_PRCS_YN
    ,AC02.FNM                /* 소득자성명                 */ 
    ,AC02.RESNO_ENC_CNTN            /* 주민등록번호              */ 
    ,AC02.NNF_CL_CD                /* 내외국인구분          */
    ,AC02.TNM                /* 근무처명          */
    ,AC02.BSNO_ENC_CNTN            /* 사업자등록번호          */
    ,AC02.HSHR_CL_CD            /* 세대주여부         */
    ,AC02.RSPL_NTN_INFR_NM            /* 국적              */ 
    ,fcBass0300ITEMNM(AC01.DPOB_CD,AC02.RSPL_NTN_INFR_CD,'12') AS RSPL_NTN_INFR_CD           /* 국적코드          */
    
    , ( CASE WHEN DECODE((SELECT HDOFC_CODTN_CD  FROM  PSNL0100 
                              WHERE  PSNL0100.SYSTEMKEY =  AC02.SYSTEMKEY
                                AND  PSNL0100.DPOB_CD = AC02.DPOB_CD),'A0030020','2','1')  = '1' THEN 
           ( CASE WHEN (DECODE(NVL(AC02.DTY_END_DT,''),'','20221231',AC02.DTY_END_DT)) < '2022231' THEN '2' ELSE '1' END) ELSE '2' END) AS HOOF_STCD  /*연말정산구분코드 */
           
    ,DECODE(NVL(AC02.DTY_STRT_DT,''),'','20220101',AC02.DTY_STRT_DT)AS DTY_STRT_DT    /* 근무기간시작일자 */
    ,DECODE(NVL(AC02.DTY_END_DT,''),'','20221231',AC02.DTY_END_DT)AS DTY_END_DT    /* 근무기간종료일자 */   
    ,DECODE(NVL(AC02.RE_STRT_DT,'TT'),'TT','00000000',AC02.RE_STRT_DT) AS  RE_STRT_DT            /* 감면기간시작일자         */
    ,DECODE(NVL(AC02.RE_STRT_DT,'TT'),'TT','00000000',AC02.RE_END_DT) AS  RE_END_DT   /* 감면기간종료일자         */
    , fcBass0300ITEMNM(AC01.DPOB_CD,AC02.RSDT_CL_CD,'12') AS RSDT_CL_CD             /* 거주구분          */
    ,AC02.RSPL_NTN_NM            /* 거주지국명         */
    ,AC02.RSPL_NTN_CD            /* 거주지코드         */
    ,AC03.YETA_00C6           /*  C6_근로자_종전근무처수                                             */
,AC03.YETA_00C9           /*  C9_근로자_외국인단일세율적용여부                      */
,AC03.YETA_0C9A           /*  C9A_근로자_외국법인소속파견근로자여부                         */
,AC03.YETA_0C15           /*  C15_근로자_연말정산구분코드                      */ 
,AC05.UT_DPOB_NM        /* 단위사업장명           */
,AC05.DEGTR_RESN_REGN_NUM    /* 대표자주민번호         */
,AC05.DEGTR_NM            /* 대표자명           */
,AC05.FRGNR_DIV_CD        /* 내외국인구분코드          */
,AC05.BUSOPR_RGSTN_NUM        /* 사업자등록번호          */
,AC05.CORP_RGSTN_NUM        /* 법인등록번호            */
,AC05.UNT_DPOB_ZPCD        /* 단위사업장우편번호           */
,AC05.UNT_DPOB_FNDTN_ADDR    /* 단위사업장기본주소           */
,AC05.UNT_DPOB_DTL_PATR_ADDR    /* 단위사업장상세주소       */
,AC05.UP_DPOB_UTYN_C171        /* C171_사업자단위과세자여부     */
,AC05.MTST_DPOB_SEIL_NUM_C172    /* C172_종사업장일련번호   */
FROM YE161010  AC01
    ,YE161020  AC02
    ,YE169010  AC03 
    ,BASS0120  AC05 
    , (
                             SELECT  DISTINCT          AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,(SELECT ( PSNL0111.HUS_ROAD_NM_FNDTN_ADDR || ' ' || PSNL0111.HUS_ROAD_NM_DTL_PATR_ADDR )
                                                 FROM PSNL0111  
                                                WHERE PSNL0111.DPOB_CD  = AD02.DPOB_CD
                                                  AND PSNL0111.SYSTEMKEY = AD02.SYSTEMKEY)  AS ADDR_POST   /* 소득자주소 */ 
                                              ,(SELECT  PSNL0111.HUS_PHN_NUM 
                                                 FROM PSNL0111  
                                                WHERE PSNL0111.DPOB_CD  = AD02.DPOB_CD
                                                  AND PSNL0111.SYSTEMKEY = AD02.SYSTEMKEY)  AS HUS_PHN_NUM             /* 집전화번호 */         
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD  
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
                                              , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
                                            , DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
                                            , DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
                                            , DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
                                            , DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
                                            , DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
                                            , DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT 
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01, (SELECT
                                            DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
                                               PAY_CD,  PAYR_MANG_DEPT_CD, 
                                               EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
                                               DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
                                                 ODTY_CD, PYSP_CD, 
                                                 LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
                                               FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
                                               HDOFC_DIV_CD, RETRY_DT 
                                            FROM
                                            (SELECT 
                                               DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
                                               PAY_CD,  PAYR_MANG_DEPT_CD, 
                                               EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
                                               DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
                                                 ODTY_CD, PYSP_CD, 
                                                 LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
                                               FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
                                               HDOFC_DIV_CD, RETRY_DT 
                                            FROM  PAYR0304 
                                            UNION ALL
                                            SELECT 
                                               DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY, (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                               PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
                                               RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
                                               TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
                                               PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
                                               FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
                                               HDOFC_DIV_CD, RETRY_DT 
                                            FROM  PYYT0304)) AD02,
                                                (    SELECT NN.DPOB_CD,
                                                                   NN.PYMT_YR_MNTH,
                                                                   NN.PAY_CD,
                                                                   NN.SYSTEMKEY,
                                                                   NN.PAYR_SEIL_NUM
                                                         FROM    
                                                         (SELECT           DPOB_CD,
                                                                               PYMT_YR_MNTH,
                                                                               PAY_CD,
                                                                               SYSTEMKEY,
                                                                               MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
                                                                          FROM (SELECT 
                                                                               DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
                                                                               PAY_CD,  PAYR_MANG_DEPT_CD, 
                                                                               EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
                                                                               DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
                                                                                 ODTY_CD, PYSP_CD, 
                                                                                 LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
                                                                               FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
                                                                               HDOFC_DIV_CD, RETRY_DT 
                                                                            FROM  PAYR0304 
                                                                            UNION ALL
                                                                            SELECT 
                                                                               DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                               PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
                                                                               RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
                                                                               TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
                                                                               PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
                                                                               FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
                                                                               HDOFC_DIV_CD, RETRY_DT 
                                                                            FROM  PYYT0304) PAYR0304
                                                                         WHERE     PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'  
                                                                             GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
                                                                     ) NN,
                                                                      (  
                                                                       SELECT        MM.DPOB_CD,
                                                                                     MM.PYMT_YR_MNTH ,
                                                                                     MM.PAY_CD , 
                                                                                     MM.SYSTEMKEY ,
                                                                                     MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
                                                                         FROM    
                                                                         (  
                                                                        SELECT   MAX(SEL_NUM)   AS SEL_NUM,
                                                                                         DPOB_CD,
                                                                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
                                                                                         MAX(PAY_CD) AS PAY_CD,
                                                                                         SYSTEMKEY,
                                                                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
                                                                         FROM 
                                                                          (SELECT  ROW_NUMBER ()
                                                                                     OVER (ORDER BY
                                                                                              DPOB_CD,
                                                                                              SYSTEMKEY,
                                                                                              PYMT_YR_MNTH ASC,
                                                                                              PAY_CD ASC,
                                                                                              PAYR_SEIL_NUM DESC) AS SEL_NUM,
                                                                                     DPOB_CD,
                                                                                     PYMT_YR_MNTH ,
                                                                                     PAY_CD , 
                                                                                     SYSTEMKEY ,
                                                                                     PAYR_SEIL_NUM
                                                                                FROM (SELECT 
                                                                           DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
                                                                           PAY_CD,  PAYR_MANG_DEPT_CD, 
                                                                           EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
                                                                           DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
                                                                             ODTY_CD, PYSP_CD, 
                                                                             LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
                                                                           FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
                                                                           HDOFC_DIV_CD, RETRY_DT 
                                                                        FROM  PAYR0304 
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                           PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
                                                                           RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
                                                                           TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
                                                                           PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
                                                                           FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
                                                                           HDOFC_DIV_CD, RETRY_DT 
                                                                        FROM  PYYT0304) PAYR0304   
                                                                         WHERE   PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
                                                                                       AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
                                                                                          SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
                                                                                            FROM 
                                                                                             (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
                                                                                             FROM PAYR0304
                                                                                             UNION ALL
                                                                                             SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
                                                                                             FROM PYYT0304) NNAA 
                                                                                            WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
                                                                                              AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
                                                                                              AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
                                                                                              AND NNAA.PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
                                                                                              GROUP BY SYSTEMKEY
                                                                      )
                                                                                 ) 
                                                                              GROUP BY  DPOB_CD,    SYSTEMKEY     
                                                                                ) MM  
                                                                              
                                                                                 ) GG
                                                                WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                                 /*     AND NN.PAYR_SEIL_NUM = GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%' 
          ) TA01
WHERE  AC01.DPOB_CD      = AC02.DPOB_CD
  AND AC01.YRTX_BLGG_YR = AC02.YRTX_BLGG_YR
  AND AC01.CLUT_SEPT_CD = AC02.CLUT_SEPT_CD
  AND AC01.SYSTEMKEY    = AC02.SYSTEMKEY  
  AND  AC01.DPOB_CD      = TA01.DPOB_CD
  AND AC01.SYSTEMKEY    = TA01.SYSTEMKEY  
  AND AC01.DPOB_CD      = AC03.DPOB_CD
  AND AC01.YRTX_BLGG_YR = AC03.YRTX_BLGG_YR
  AND AC01.CLUT_SEPT_CD = AC03.CLUT_SEPT_CD
  AND AC01.SYSTEMKEY    = AC03.SYSTEMKEY  
  AND AC01.DPOB_CD      = AC05.DPOB_CD(+) 
  AND AC01.UT_DPOB_CD   = AC05.UT_DPOB_CD(+) 
  AND AC01.DPOB_CD        = #dpobCd# 
  AND AC01.YRTX_BLGG_YR = #yrtxBlggYr#
  AND AC01.CLUT_SEPT_CD = #clutSeptCd#  
    ]]>  
        <isNotEmpty prepend="AND" property="busoprRgstnum" >
                          AC05.BUSOPR_RGSTN_NUM(+) = #busoprRgstnum# 
				    	</isNotEmpty> 
                       <isNotEmpty prepend="AND"  property="utDpobCd" >  
							AC01.UT_DPOB_CD=#utDpobCd# 
	          			</isNotEmpty>  
	        			 <isNotEmpty prepend="AND" property="systemkey" >
         						AC01.SYSTEMKEY=#systemkey#
    					 </isNotEmpty> 
    					     <![CDATA[  
    					      AND EXISTS  (
                                SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#, #yrtxBlggYr#))  ) C
                                    WHERE     C.DPOB_CD = TA01.DPOB_CD
                                        AND C.DEPT_CD = TA01.DEPT_CD
                                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(TA01.TYP_OCCU_CD,'TT') 
                                        AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(TA01.DTIL_OCCU_INTTN_CD,'TT')
                                         ]]>
                                         <isNotEmpty property="deptCd" prepend="AND">
                                        <![CDATA[
                                         C.DEPT_CD
                                        ]]>
                                        <iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
                                         #deptCdArr[]#
                                        </iterate>
                                        </isNotEmpty>  
                                  ) 
                      <isNotEmpty property="businCd" prepend="AND">
            <![CDATA[
              TA01.BUSIN_CD
            ]]>
            <iterate prepend="IN" property="businCdArr" open="(" close=")" conjunction=",">
             #businCdArr[]#
            </iterate>
            </isNotEmpty> 
               <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                 TA01.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
               </isNotEmpty> 
               <isNotEmpty prepend="AND" property="emymtDivCd" >
                 TA01.EMYMT_DIV_CD=#emymtDivCd#
                 </isNotEmpty>  
             <isNotEmpty property="typOccuCd" prepend="AND">
            <![CDATA[
             TA01.TYP_OCCU_CD
            ]]>
            <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
             #typOccuCdArr[]#
            </iterate>
            </isNotEmpty>  
                  
            <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
                <![CDATA[
                     TA01.DTIL_OCCU_INTTN_CD
                ]]>
                <iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
                     #dtilOccuInttnCdArr[]#
                </iterate> 
          </isNotEmpty>       
	</select>	
	  
	<!-- 의료비 공제 내역   A레코드 - 의료비지급명세서 레코드  내역  -->
   <select id="infcPkgYeta17File_2023_DAO.fnPayrCA_ReTax_Total_Select" parameterClass="infcFile17Ye161020_2023" resultClass="egovMap">       
         <![CDATA[   
         
         SELECT 
		    AC01.DPOB_CD, AC01.YRTX_BLGG_YR, AC01.CLUT_SEPT_CD, 
		    AC01.SYSTEMKEY 
		   ,AC02.FNM                /* 소득자성명  주소,사업장소재지     */ 
		   ,AC02.RESNO_ENC_CNTN AS ORG_RESNO_ENC_CNTN     /* 주민등록번호         */ 
		   ,AC02.NNF_CL_CD AS ORG_NNF_CL_CD         /* 내외국인구분          */
		   ,AC02.TNM                /* 근무처명          */
		   ,AC02.BSNO_ENC_CNTN AS ORG_BSNO_ENC_CNTN     /* 사업자등록번호          */                 
		    ,AC04.BSNO_ENC_CNTN        /* 지급처사업자등록번호       */
		    ,AC04.PLYM_NM            /* 의료비_상호명        */
		    , fcBass0300ITEMNM(AC04.DPOB_CD,AC04.MDXPS_PRF_CL_CD,'11') AS  MDXPS_PRF_CL_CD /* 의료비_의료증빙코드    */
		    ,AC04.SCNT            /* 의료비_건수        */
		    ,AC04.USE_AMT            /* 의료비_금액        */
		    ,DECODE(AC04.YN2,'1','1',' ') AS YN2            /* 의료비_난임시술비해당여부     */
		    ,DECODE(AC04.YN3,'1','1',' ') AS YN3            /* 의료비_산후조리비용여부     */
		    ,DECODE(AC04.YN4,'1','1',' ') AS YN4            /* 의료비_실손보험금보전금액여부     */
		    ,AC04.RESNO_ENC_CNTN        /* 의료비공제대상자주민등록번호    */
		    ,AC03.NNF_CL_CD  
		    ,AC04.YN            /* 본인등해당여부        */
		FROM YE161010 AC01 
		    ,YE161020 AC02
		    ,YE161030 AC03  
		    ,YE164010  AC04  
		WHERE AC01.DPOB_CD = AC02.DPOB_CD
		  AND AC01.YRTX_BLGG_YR = AC02.YRTX_BLGG_YR
		  AND AC01.CLUT_SEPT_CD = AC02.CLUT_SEPT_CD
		  AND AC01.SYSTEMKEY = AC02.SYSTEMKEY
		      AND AC01.DPOB_CD = AC03.DPOB_CD
		  AND AC01.YRTX_BLGG_YR = AC03.YRTX_BLGG_YR
		  AND AC01.CLUT_SEPT_CD = AC03.CLUT_SEPT_CD
		  AND AC01.SYSTEMKEY = AC03.SYSTEMKEY
		   AND AC03.DPOB_CD = AC04.DPOB_CD
		  AND AC03.YRTX_BLGG_YR = AC04.YRTX_BLGG_YR
		  AND AC03.CLUT_SEPT_CD = AC04.CLUT_SEPT_CD
		  AND AC03.SYSTEMKEY = AC04.SYSTEMKEY
		  AND AC03.TXPR_DSCM_NO_CNTN  = AC04.RESNO_ENC_CNTN
		  AND AC04.YN4 = '0'
		  AND AC01.DPOB_CD        = #dpobCd# 
		  AND AC01.YRTX_BLGG_YR = #yrtxBlggYr#
		  AND AC01.CLUT_SEPT_CD = #clutSeptCd# 
		  AND AC01.SYSTEMKEY =#systemkey#  
		  ORDER BY AC04.MDXPS_SEIL_NUM ASC
    ]]>
	</select>	 
 
   
   	<update id="infcPkgYeta17File_2023_DAO.updateYeta8400ToYe161010_S">
		<![CDATA[
			UPDATE YE161010
			SET   EDAC_PRDT=#edacPrdt# 
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
						WHERE DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
								AND SYSTEMKEY=#systemkey#
				]]>
	</update>
	
<!-- 
	<insert id="infcPkgYeta17File_2023_DAO.insertYetaPrc3900_S">
		<![CDATA[
		 
		]]>
	</insert>
	
	<update id="infcPkgYeta17File_2023_DAO.updateYetaPrc3900_S">
		<![CDATA[
			 
				]]>
	</update>
	
	<delete id="infcPkgYeta17File_2023_DAO.deleteYetaPrc3900_S">
		<![CDATA[
			 
				]]>
	</delete>
	
	<select id="infcPkgYeta17File_2023_DAO.selectYetaPrc3900_S" resultMap="infcPkgYeta3900">
		<![CDATA[
			 
				]]>
	</select>
	
	<select id="infcPkgYeta17File_2023_DAO.selectYetaPrc3900List_D" parameterClass="infcPkgYeta3900Serarch_2023_VO" resultClass="egovMap">
  
	</select>	
	<select id="infcPkgYeta17File_2023_DAO.selectYetaPrc3900ListTotCnt_S" parameterClass="infcPkgYeta3900Serarch_2023_VO" resultClass="int">
		 
	</select>
 -->
</sqlMap>
