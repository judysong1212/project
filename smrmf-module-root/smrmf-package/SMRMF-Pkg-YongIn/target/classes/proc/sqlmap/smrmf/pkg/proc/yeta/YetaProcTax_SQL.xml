<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="YetaPrcTax">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/> 
	<typeAlias  alias="yetaPrcTax2000SrhVo" type="com.app.smrmf.infc.yearendtax.server.vo.InfcPkgYeta2000SrhVO"/>
	<typeAlias  alias="yetaPrcTax2000" type="com.app.smrmf.infc.yearendtax.server.vo.InfcPkgYeta2000VO"/>
	<typeAlias  alias="yetaPrcTax3000" type="com.app.smrmf.infc.yearendtax.server.vo.InfcPkgYeta3000VO"/>
	
	<!-- 
		<resultMap id="" class="com.app.smrmf.infc.yearendtax.server.vo.InfcPkgYeta2000VO">
		<result property="dpobCd" column="DPOB_CD" columnIndex="1"/>
		<result property="edacRvyy" column="EDAC_RVYY" columnIndex="2"/>
		<result property="settGbcd" column="SETT_GBCD" columnIndex="3"/>
		<result property="systemkey" column="SYSTEMKEY" columnIndex="4"/>
		<result property="edacSeilNum" column="EDAC_SEIL_NUM" columnIndex="5"/>
		<result property="payrMangDeptCd" column="PAYR_MANG_DEPT_CD" columnIndex="6"/>
		<result property="emymtDivCd" column="EMYMT_DIV_CD" columnIndex="7"/>
		<result property="hanNm" column="HAN_NM" columnIndex="8"/>
		<result property="resnRegnNum" column="RESN_REGN_NUM" columnIndex="9"/>
		<result property="deptCd" column="DEPT_CD" columnIndex="10"/>
		<result property="businCd" column="BUSIN_CD" columnIndex="11"/>
		<result property="typOccuCd" column="TYP_OCCU_CD" columnIndex="12"/>
		<result property="dtilOccuInttnCd" column="DTIL_OCCU_INTTN_CD" columnIndex="13"/>
		<result property="dtilOccuClsDivCd" column="DTIL_OCCU_CLS_DIV_CD" columnIndex="14"/>
		<result property="odtyCd" column="ODTY_CD" columnIndex="15"/>
		<result property="pyspCd" column="PYSP_CD" columnIndex="16"/>
		<result property="pyspGrdeCd" column="PYSP_GRDE_CD" columnIndex="17"/>
		<result property="logSvcYrNumCd" column="LOG_SVC_YR_NUM_CD" columnIndex="18"/>
		<result property="logSvcMnthIcmCd" column="LOG_SVC_MNTH_ICM_CD" columnIndex="19"/>
		<result property="frstEmymtDt" column="FRST_EMYMT_DT" columnIndex="20"/>
		<result property="emymtBgnnDt" column="EMYMT_BGNN_DT" columnIndex="21"/>
		<result property="emymtEndDt" column="EMYMT_END_DT" columnIndex="22"/>
		<result property="hdofcDivCd" column="HDOFC_DIV_CD" columnIndex="23"/>
		<result property="retryDt" column="RETRY_DT" columnIndex="24"/>
		<result property="yrtxApptnYrMnth" column="YRTX_APPTN_YR_MNTH" columnIndex="25"/>
		<result property="yrtxPrcsDt" column="YRTX_PRCS_DT" columnIndex="26"/>
		<result property="yrtxPrcsYn" column="YRTX_PRCS_YN" columnIndex="27"/>
		<result property="divdPymtDivCd" column="DIVD_PYMT_DIV_CD" columnIndex="28"/>
		<result property="divdPymt" column="DIVD_PYMT" columnIndex="29"/>
		<result property="gnanSgtf" column="GNAN_SGTF" columnIndex="30"/>
		<result property="frnrYeno" column="FRNR_YENO" columnIndex="31"/>
		<result property="reymStdt" column="REYM_STDT" columnIndex="32"/>
		<result property="reymEddt" column="REYM_EDDT" columnIndex="33"/>
		<result property="rutrEddt" column="RUTR_EDDT" columnIndex="34"/>
		<result property="rutrStdt" column="RUTR_STDT" columnIndex="35"/>
		<result property="resdFlag" column="RESD_FLAG" columnIndex="36"/>
		<result property="natnGbcd" column="NATN_GBCD" columnIndex="37"/>
		<result property="natnName" column="NATN_NAME" columnIndex="38"/>
		<result property="redtGbcd" column="REDT_GBCD" columnIndex="39"/>
		<result property="redtName" column="REDT_NAME" columnIndex="40"/>
		<result property="humnCgue" column="HUMN_CGUE" columnIndex="41"/>
		<result property="frnrSgyn" column="FRNR_SGYN" columnIndex="42"/>
		<result property="baseWiyn" column="BASE_WIYN" columnIndex="43"/>
		<result property="baseFmly" column="BASE_FMLY" columnIndex="44"/>
		<result property="addrCt70" column="ADDR_CT70" columnIndex="45"/>
		<result property="addrHdrc" column="ADDR_HDRC" columnIndex="46"/>
		<result property="addrFdsu" column="ADDR_FDSU" columnIndex="47"/>
		<result property="addrClct" column="ADDR_CLCT" columnIndex="48"/>
		<result property="addrBhct" column="ADDR_BHCT" columnIndex="49"/>
		<result property="pantOnsu" column="PANT_ONSU" columnIndex="50"/>
		<result property="addrMrct" column="ADDR_MRCT" columnIndex="51"/>
		<result property="bnatPsnf" column="BNAT_PSNF" columnIndex="52"/>
		<result property="jnatPsnf" column="JNAT_PSNF" columnIndex="53"/>
		<result property="bpssTech" column="BPSS_TECH" columnIndex="54"/>
		<result property="bpssPulc" column="BPSS_PULC" columnIndex="55"/>
		<result property="bpssFect" column="BPSS_FECT" columnIndex="56"/>
		<result property="bpssSold" column="BPSS_SOLD" columnIndex="57"/>
		<result property="jpssPulc" column="JPSS_PULC" columnIndex="58"/>
		<result property="jpssSold" column="JPSS_SOLD" columnIndex="59"/>
		<result property="jpssTech" column="JPSS_TECH" columnIndex="60"/>
		<result property="jpssFect" column="JPSS_FECT" columnIndex="61"/>
		<result property="brtrPsct" column="BRTR_PSCT" columnIndex="62"/>
		<result property="brtrCict" column="BRTR_CICT" columnIndex="63"/>
		<result property="brtrAnsv" column="BRTR_ANSV" columnIndex="64"/>
		<result property="jrtrCict" column="JRTR_CICT" columnIndex="65"/>
		<result property="jrtrCtar" column="JRTR_CTAR" columnIndex="66"/>
		<result property="jrtrPsct" column="JRTR_PSCT" columnIndex="67"/>
		<result property="jrtrPtar" column="JRTR_PTAR" columnIndex="68"/>
		<result property="jrtrAnsv" column="JRTR_ANSV" columnIndex="69"/>
		<result property="jrtrAtar" column="JRTR_ATAR" columnIndex="70"/>
		<result property="rrptAmnt" column="RRPT_AMNT" columnIndex="71"/>
		<result property="spciBhlh" column="SPCI_BHLH" columnIndex="72"/>
		<result property="spciHhlh" column="SPCI_HHLH" columnIndex="73"/>
		<result property="spciBepf" column="SPCI_BEPF" columnIndex="74"/>
		<result property="spciJepf" column="SPCI_JEPF" columnIndex="75"/>
		<result property="spciGurt" column="SPCI_GURT" columnIndex="76"/>
		<result property="spciHdrc" column="SPCI_HDRC" columnIndex="77"/>
		<result property="spciRttg" column="SPCI_RTTG" columnIndex="78"/>
		<result property="spciIuam" column="SPCI_IUAM" columnIndex="79"/>
		<result property="spciSelf" column="SPCI_SELF" columnIndex="80"/>
		<result property="spciAe65" column="SPCI_AE65" columnIndex="81"/>
		<result property="spciDbps" column="SPCI_DBPS" columnIndex="82"/>
		<result property="spciDetc" column="SPCI_DETC" columnIndex="83"/>
		<result property="spciDtar" column="SPCI_DTAR" columnIndex="84"/>
		<result property="spciEtam" column="SPCI_ETAM" columnIndex="85"/>
		<result property="spedSelf" column="SPED_SELF" columnIndex="86"/>
		<result property="spedEdsu" column="SPED_EDSU" columnIndex="87"/>
		<result property="spedEdam" column="SPED_EDAM" columnIndex="88"/>
		<result property="spedGdsu" column="SPED_GDSU" columnIndex="89"/>
		<result property="spedGdam" column="SPED_GDAM" columnIndex="90"/>
		<result property="spedCvsu" column="SPED_CVSU" columnIndex="91"/>
		<result property="spedCvam" column="SPED_CVAM" columnIndex="92"/>
		<result property="spciScsu" column="SPCI_SCSU" columnIndex="93"/>
		<result property="spciScam" column="SPCI_SCAM" columnIndex="94"/>
		<result property="spedEtar" column="SPED_ETAR" columnIndex="95"/>
		<result property="siedToam" column="SIED_TOAM" columnIndex="96"/>
		<result property="spciRefn" column="SPCI_REFN" columnIndex="97"/>
		<result property="spciResf" column="SPCI_RESF" columnIndex="98"/>
		<result property="spciHtam" column="SPCI_HTAM" columnIndex="99"/>
		<result property="spchRefn" column="SPCH_REFN" columnIndex="100"/>
		<result property="spchRe06" column="SPCH_RE06" columnIndex="101"/>
		<result property="spchRe10" column="SPCH_RE10" columnIndex="102"/>
		<result property="spchRe20" column="SPCH_RE20" columnIndex="103"/>
		<result property="spchRefx" column="SPCH_REFX" columnIndex="104"/>
		<result property="spchReec" column="SPCH_REEC" columnIndex="105"/>
		<result property="spch15fx" column="SPCH_15FX" columnIndex="106"/>
		<result property="spch15fb" column="SPCH_15FB" columnIndex="107"/>
		<result property="spch15ec" column="SPCH_15EC" columnIndex="108"/>
		<result property="spch10fb" column="SPCH_10FB" columnIndex="109"/>
		<result property="spch10ec" column="SPCH_10EC" columnIndex="110"/>
		<result property="taxdPltc" column="TAXD_PLTC" columnIndex="111"/>
		<result property="taxd10tg" column="TAXD_10TG" columnIndex="112"/>
		<result property="spciPltc" column="SPCI_PLTC" columnIndex="113"/>
		<result property="spciPltg" column="SPCI_PLTG" columnIndex="114"/>
		<result property="spciFbam" column="SPCI_FBAM" columnIndex="115"/>
		<result property="spciFbtg" column="SPCI_FBTG" columnIndex="116"/>
		<result property="spciExam" column="SPCI_EXAM" columnIndex="117"/>
		<result property="spciUnon" column="SPCI_UNON" columnIndex="118"/>
		<result property="spciHfam" column="SPCI_HFAM" columnIndex="119"/>
		<result property="spciYamt" column="SPCI_YAMT" columnIndex="120"/>
		<result property="spciNamt" column="SPCI_NAMT" columnIndex="121"/>
		<result property="spciDgtg" column="SPCI_DGTG" columnIndex="122"/>
		<result property="spciFnrl" column="SPCI_FNRL" columnIndex="123"/>
		<result property="prvm20be" column="PRVM_20BE" columnIndex="124"/>
		<result property="prvm21af" column="PRVM_21AF" columnIndex="125"/>
		<result property="etchPrep" column="ETCH_PREP" columnIndex="126"/>
		<result property="etcsComp" column="ETCS_COMP" columnIndex="127"/>
		<result property="etwkHsvm" column="ETWK_HSVM" columnIndex="128"/>
		<result property="etwkHsbm" column="ETWK_HSBM" columnIndex="129"/>
		<result property="etwkHlgm" column="ETWK_HLGM" columnIndex="130"/>
		<result property="etwkHbdm" column="ETWK_HBDM" columnIndex="131"/>
		<result property="etctConc" column="ETCT_CONC" columnIndex="132"/>
		<result property="etgdH09f" column="ETGD_H09F" columnIndex="133"/>
		<result property="etgdH13f" column="ETGD_H13F" columnIndex="134"/>
		<result property="etgdH14f" column="ETGD_H14F" columnIndex="135"/>
		<result property="etclH15f" column="ETCL_H15F" columnIndex="136"/>
		<result property="etgdHdam" column="ETGD_HDAM" columnIndex="137"/>
		<result property="etctCard" column="ETCT_CARD" columnIndex="138"/>
		<result property="etchBcbs" column="ETCH_BCBS" columnIndex="139"/>
		<result property="etchUeam" column="ETCH_UEAM" columnIndex="140"/>
		<result property="etchMgvd" column="ETCH_MGVD" columnIndex="141"/>
		<result property="etchBced" column="ETCH_BCED" columnIndex="142"/>
		<result property="cardEt13" column="CARD_ET13" columnIndex="143"/>
		<result property="cardEt14" column="CARD_ET14" columnIndex="144"/>
		<result property="etadDd13" column="ETAD_DD13" columnIndex="145"/>
		<result property="etadD14l" column="ETAD_D14L" columnIndex="146"/>
		<result property="etchBcue" column="ETCH_BCUE" columnIndex="147"/>
		<result property="etckUnon" column="ETCK_UNON" columnIndex="148"/>
		<result property="etckUncb" column="ETCK_UNCB" columnIndex="149"/>
		<result property="etepHsam" column="ETEP_HSAM" columnIndex="150"/>
		<result property="etgdCtra" column="ETGD_CTRA" columnIndex="151"/>
		<result property="etepSest" column="ETEP_SEST" columnIndex="152"/>
		<result property="etclHm01" column="ETCL_HM01" columnIndex="153"/>
		<result property="etclHm02" column="ETCL_HM02" columnIndex="154"/>
		<result property="etclHm03" column="ETCL_HM03" columnIndex="155"/>
		<result property="etclHmta" column="ETCL_HMTA" columnIndex="156"/>
		<result property="etclEttl" column="ETCL_ETTL" columnIndex="157"/>
		<result property="etclEtam" column="ETCL_ETAM" columnIndex="158"/>
		<result property="taxdIncd" column="TAXD_INCD" columnIndex="159"/>
		<result property="taxdWkdt" column="TAXD_WKDT" columnIndex="160"/>
		<result property="tamaEddt" column="TAMA_EDDT" columnIndex="161"/>
		<result property="tamaIndt" column="TAMA_INDT" columnIndex="162"/>
		<result property="tamaOudt" column="TAMA_OUDT" columnIndex="163"/>
		<result property="txlgFrrd" column="TXLG_FRRD" columnIndex="164"/>
		<result property="txlgFrid" column="TXLG_FRID" columnIndex="165"/>
		<result property="txlgWkid" column="TXLG_WKID" columnIndex="166"/>
		<result property="txlgTxtd" column="TXLG_TXTD" columnIndex="167"/>
		<result property="txlgBscd" column="TXLG_BSCD" columnIndex="168"/>
		<result property="txlgBcde" column="TXLG_BCDE" columnIndex="169"/>
		<result property="txlgItct" column="TXLG_ITCT" columnIndex="170"/>
		<result property="txlgBsta" column="TXLG_BSTA" columnIndex="171"/>
		<result property="txlgWkta" column="TXLG_WKTA" columnIndex="172"/>
		<result property="txlgClta" column="TXLG_CLTA" columnIndex="173"/>
		<result property="txlgFrta" column="TXLG_FRTA" columnIndex="174"/>
		<result property="txlgTxty" column="TXLG_TXTY" columnIndex="175"/>
		<result property="txlgInam" column="TXLG_INAM" columnIndex="176"/>
		<result property="txlgDlam" column="TXLG_DLAM" columnIndex="177"/>
		<result property="txlgWnam" column="TXLG_WNAM" columnIndex="178"/>
		<result property="txlgOtcy" column="TXLG_OTCY" columnIndex="179"/>
		<result property="txlgOtdt" column="TXLG_OTDT" columnIndex="180"/>
		<result property="txlgApdt" column="TXLG_APDT" columnIndex="181"/>
		<result property="txlgOuwk" column="TXLG_OUWK" columnIndex="182"/>
		<result property="txapStdt" column="TXAP_STDT" columnIndex="183"/>
		<result property="txapEddt" column="TXAP_EDDT" columnIndex="184"/>
		<result property="txapWkdy" column="TXAP_WKDY" columnIndex="185"/>
		<result property="taxdUnin" column="TAXD_UNIN" columnIndex="186"/>
		<result property="taxdLoaa" column="TAXD_LOAA" columnIndex="187"/>
		<result property="addcNtyn" column="ADDC_NTYN" columnIndex="188"/>
		<result property="addcMdyn" column="ADDC_MDYN" columnIndex="189"/>
		<result property="addcCtyn" column="ADDC_CTYN" columnIndex="190"/>
		<result property="addcPfyn" column="ADDC_PFYN" columnIndex="191"/>
		<result property="addfPvyn" column="ADDF_PVYN" columnIndex="192"/>
		<result property="spciReyn" column="SPCI_REYN" columnIndex="193"/>
		<result property="txlgMxtm" column="TXLG_MXTM" columnIndex="194"/>
		<result property="incoOudt" column="INCO_OUDT" columnIndex="195"/>
		<result property="incoOufg" column="INCO_OUFG" columnIndex="196"/>
		<result property="jdocFile" column="JDOC_FILE" columnIndex="197"/>
		<result property="jrtrAtom" column="JRTR_ATOM" columnIndex="198"/>
		<result property="jrtrTotr" column="JRTR_TOTR" columnIndex="199"/>
		<result property="spciHdtg" column="SPCI_HDTG" columnIndex="200"/>
		<result property="spciDetg" column="SPCI_DETG" columnIndex="201"/>
		<result property="spciRtto" column="SPCI_RTTO" columnIndex="202"/>
		<result property="spciSftg" column="SPCI_SFTG" columnIndex="203"/>
		<result property="spci65tg" column="SPCI_65TG" columnIndex="204"/>
		<result property="spciPstg" column="SPCI_PSTG" columnIndex="205"/>
		<result property="spciEtcg" column="SPCI_ETCG" columnIndex="206"/>
		<result property="spedSftr" column="SPED_SFTR" columnIndex="207"/>
		<result property="spedEdtr" column="SPED_EDTR" columnIndex="208"/>
		<result property="spedGdtr" column="SPED_GDTR" columnIndex="209"/>
		<result property="spedCvtr" column="SPED_CVTR" columnIndex="210"/>
		<result property="spciSctr" column="SPCI_SCTR" columnIndex="211"/>
		<result property="spciExtg" column="SPCI_EXTG" columnIndex="212"/>
		<result property="spciUntg" column="SPCI_UNTG" columnIndex="213"/>
		<result property="spciHftg" column="SPCI_HFTG" columnIndex="214"/>
		<result property="spciNatg" column="SPCI_NATG" columnIndex="215"/>
		<result property="spciYatg" column="SPCI_YATG" columnIndex="216"/>
		<result property="spciDgam" column="SPCI_DGAM" columnIndex="217"/>
		<result property="spciOnon" column="SPCI_ONON" columnIndex="218"/>
		<result property="spciObam" column="SPCI_OBAM" columnIndex="219"/>
		<result property="spciOyam" column="SPCI_OYAM" columnIndex="220"/>
		<result property="spciOnam" column="SPCI_ONAM" columnIndex="221"/>
		<result property="kybdr" column="KYBDR" columnIndex="222"/>
		<result property="inptDt" column="INPT_DT" columnIndex="223"/>
		<result property="inptAddr" column="INPT_ADDR" columnIndex="224"/>
		<result property="ismt" column="ISMT" columnIndex="225"/>
		<result property="revnDt" column="REVN_DT" columnIndex="226"/>
		<result property="revnAddr" column="REVN_ADDR" columnIndex="227"/>
	</resultMap>
	 -->
 
 
 
 
 
	  <update id="yetaPrcTaxDAO.fnPayr06420_Yeta3140_ReTax_2015_CREATE_01_Update">
		<![CDATA[
		UPDATE  YETA3220
SET     
			/* 의료비국세청  */
			       MEDI_COST =    NVL((SELECT SUM(NVL(YETA3140.CASH_UEAM,0))                                     
			                                  FROM YETA3140                                                                               
			                               WHERE YETA3220.SYSTEMKEY = YETA3140.SYSTEMKEY                                                   
			                                 AND YETA3220.EDAC_RVYY = YETA3140.EDAC_RVYY                                                   
			                                 AND YETA3220.SETT_GBCD = YETA3140.SETT_GBCD  
			                                 AND YETA3220.DPOB_CD  = YETA3140.DPOB_CD   
			                                 AND YETA3220.RSNO_NUMB = YETA3140.RSNO_NUMB   
			                                 AND YETA3140.MEDI_CFCD = '1'                                                                  
			                                 GROUP BY YETA3140.SYSTEMKEY,YETA3140.RSNO_NUMB ), 0),
			/* 교육비국세청  
			       EDUC_COST = :EDUC_COST, */ 
			/* 기부금 국세청        
			       CTRB_AMNT = :CTRB_AMNT, */   
			 /* 의료비 외 */
			       MEDI_EXPS =  NVL((SELECT SUM(NVL(YETA3140.CASH_UEAM,0))                                     
			                                  FROM YETA3140                                                                               
			                               WHERE YETA3220.SYSTEMKEY = YETA3140.SYSTEMKEY                                                   
			                                 AND YETA3220.EDAC_RVYY = YETA3140.EDAC_RVYY                                                   
			                                 AND YETA3220.SETT_GBCD = YETA3140.SETT_GBCD  
			                                 AND YETA3220.DPOB_CD  = YETA3140.DPOB_CD   
			                                 AND YETA3220.RSNO_NUMB = YETA3140.RSNO_NUMB   
			                                 AND YETA3140.MEDI_CFCD <> '1'                                                                  
			                                 GROUP BY YETA3140.SYSTEMKEY,YETA3140.RSNO_NUMB ), 0)
			/* 교육비외       
			       EDUC_OTEC = :EDUC_OTEC, */  
			/* 기부금 외        
			       CTRB_AMEC = :CTRB_AMEC, */ 
          	       WHERE YETA3220.DPOB_CD=#dpobCd#
					AND YETA3220.EDAC_RVYY=#edacRvyy#
					AND YETA3220.SETT_GBCD=#settGbcd#
					AND YETA3220.SYSTEMKEY=#systemkey#
			 
				]]>
	</update> 
	  <update id="yetaPrcTaxDAO.fnPayr06420_PAYR415_ReTax_2014_CREATE_01_Update">
		<![CDATA[
			 
	  UPDATE YETA2000                                                                                                                
             /* 기본공제_배우자유무    */                                                                                       
          SET BASE_WIYN = NVL((SELECT DECODE(NVL(COUNT(YETA3220.RELH_CODE), 0), 0, 0, 1)                                      
                             FROM (SELECT * FROM YETA3220 WHERE YETA3220.BASE_DDYN = '1' AND YETA3220.RELH_CODE IN ('A0190002','A0190007')) YETA3220                       
                            WHERE YETA3220.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                                   
                              AND YETA3220.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                                   
                              AND YETA3220.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                              AND YETA3220.DPOB_CD(+) = YETA2000.DPOB_CD                                                 
                            GROUP BY YETA2000.SYSTEMKEY                                                                       
                          ),0),                                                                                              
          /*     기본공제_부양가족수  */                                                                                         
              BASE_FMLY = NVL((SELECT COUNT(YETA3220.RELH_CODE) - 1                                                           
                             FROM (SELECT * FROM YETA3220 WHERE YETA3220.BASE_DDYN = '1' AND  YETA3220.RELH_CODE NOT IN ('A0190002','A0190007')) YETA3220                              
                            WHERE YETA3220.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                                   
                              AND YETA3220.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                                   
                              AND YETA3220.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                               AND YETA3220.DPOB_CD(+) = YETA2000.DPOB_CD                                                   
                            GROUP BY YETA2000.SYSTEMKEY                                                                       
                          ),0),                                                                                              
          /*  --추가공제_장애인수    */                                                                                         
              ADDR_HDRC = NVL((SELECT COUNT(YETA3220.RELH_CODE)                                                               
                             FROM (SELECT * FROM YETA3220 WHERE YETA3220.PSCL_DDYN IN ('1','2','3')) YETA3220                              
                            WHERE YETA3220.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                                   
                              AND YETA3220.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                                   
                              AND YETA3220.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                               AND YETA3220.DPOB_CD(+) = YETA2000.DPOB_CD                                                   
                            GROUP BY YETA2000.SYSTEMKEY                                                                       
                          ),0),                                                                                              
                  /* --추가공제_경로우대_70세이상수  */                                                                                
              ADDR_CT70 = NVL((SELECT COUNT(YETA3220.RELH_CODE)                                                               
                             FROM (SELECT * FROM YETA3220 WHERE YETA3220.RPCT_DDYN = '1') YETA3220                              
                            WHERE YETA3220.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                                   
                              AND YETA3220.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                                   
                              AND YETA3220.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                               AND YETA3220.DPOB_CD(+) = YETA2000.DPOB_CD                                                   
                            GROUP BY YETA2000.SYSTEMKEY                                                                       
                          ),0),                                                                                              
          /*   --추가공제_부녀자수   */                                                                                          
              ADDR_FDSU = NVL((SELECT COUNT(YETA3220.RELH_CODE)                                                               
                             FROM (SELECT * FROM YETA3220 WHERE YETA3220.FADD_CTYN = '1') YETA3220                              
                            WHERE YETA3220.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                                   
                              AND YETA3220.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                                   
                              AND YETA3220.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                               AND YETA3220.DPOB_CD(+) = YETA2000.DPOB_CD                                                   
                            GROUP BY YETA2000.SYSTEMKEY                                                                       
                          ),0),                                                                                              
                 /*  --추가공제_자녀양육비양육수    */                                                                        
              ADDR_CLCT = NVL((SELECT COUNT(YETA3220.RELH_CODE)                                                               
                             FROM (SELECT * FROM YETA3220 WHERE YETA3220.BRDD_CTYN = '1') YETA3220                              
                            WHERE YETA3220.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                                   
                              AND YETA3220.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                                   
                              AND YETA3220.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                               AND YETA3220.DPOB_CD(+) = YETA2000.DPOB_CD                                                   
                            GROUP BY YETA2000.SYSTEMKEY                                                                       
                          ),0),                                                                                              
                 /* --추가공제_출산자녀양육수 */                                                                               
              ADDR_BHCT = NVL((SELECT COUNT(YETA3220.RELH_CODE)                                                               
                             FROM (SELECT * FROM YETA3220 WHERE YETA3220.BITH_DDYN = '1') YETA3220                              
                            WHERE YETA3220.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                                   
                              AND YETA3220.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                                   
                              AND YETA3220.SETT_GBCD(+) = YETA2000.SETT_GBCD   
                               AND YETA3220.DPOB_CD(+) = YETA2000.DPOB_CD                                                  
                            GROUP BY YETA2000.SYSTEMKEY                                                                       
                          ),0),                                                                                              

                /*  --추가공제_한부모수   */                                                                              
              PANT_ONSU = NVL((SELECT COUNT(YETA3220.RELH_CODE)                                                               
                             FROM (SELECT * FROM YETA3220 WHERE YETA3220.PANT_ONYN = '1') YETA3220                              
                            WHERE YETA3220.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                                   
                              AND YETA3220.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                                   
                              AND YETA3220.SETT_GBCD(+) = YETA2000.SETT_GBCD   
                               AND YETA3220.DPOB_CD(+) = YETA2000.DPOB_CD                                                  
                            GROUP BY YETA2000.SYSTEMKEY                                                                       
                          ),0),                                                                                              

          /*  --추가공제_자녀인원수  2014년 변경 로직    */                                                                                    
              ADDR_MRCT = NVL((SELECT   COUNT(YETA3220.RELH_CODE)                                                                  
                             FROM (SELECT * FROM YETA3220 WHERE  YETA3220.BASE_DDYN = '1' AND YETA3220.RELH_CODE IN ('A0190005')) YETA3220                    
                            WHERE YETA3220.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                                   
                              AND YETA3220.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                                   
                              AND YETA3220.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                               AND YETA3220.DPOB_CD(+) = YETA2000.DPOB_CD                                                   
                            GROUP BY YETA2000.SYSTEMKEY                                                                       
                          ),0),                                                                                              
         /*  --종근무지_국민연금보험료   */                                                                                   
              BNAT_PSNF = NVL((SELECT SUM(YETA3110.ANNU_MUAM)                                                                 
                             FROM (SELECT *                                                                                  
                                     FROM YETA3110                                                                            
                                    WHERE YETA3110.WTHD_SBYN = '1'                                                            
                                      AND YETA3110.MANG_GBYN = '1') YETA3110                                                   
                            WHERE YETA3110.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                                   
                              AND YETA3110.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                                   
                              AND YETA3110.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                               AND YETA3110.DPOB_CD(+) = YETA2000.DPOB_CD                                                   
                            GROUP BY YETA2000.SYSTEMKEY                                                                       
                          ),0),                                                                                              
         /* --종근무지_국민연금외공무원연금       */                                                                        
              BPSS_PULC = NVL((SELECT SUM(YETA3110.AUET_MUAM)                                                                 
                             FROM (SELECT *                                                                                  
                                     FROM YETA3110                                                                            
                                    WHERE YETA3110.WTHD_SBYN = '1'                                                            
                                      AND YETA3110.MANG_GBYN = '1') YETA3110                                                   
                            WHERE YETA3110.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                                   
                              AND YETA3110.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                                   
                              AND YETA3110.SETT_GBCD(+) = YETA2000.SETT_GBCD 
                               AND YETA3110.DPOB_CD(+) = YETA2000.DPOB_CD                                                    
                            GROUP BY YETA2000.SYSTEMKEY                                                                       
                          ),0),                                                                                              

          /*  --종근무지_국민연금외군인연금      */                                                                         
              BPSS_SOLD = NVL((SELECT SUM(YETA3110.AUET_SOLD)                                                                 
                             FROM (SELECT *                                                                                  
                                     FROM YETA3110                                                                            
                                    WHERE YETA3110.WTHD_SBYN = '1'                                                            
                                      AND YETA3110.MANG_GBYN = '1') YETA3110                                                   
                            WHERE YETA3110.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                                   
                              AND YETA3110.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                                   
                              AND YETA3110.SETT_GBCD(+) = YETA2000.SETT_GBCD 
                               AND YETA3110.DPOB_CD(+) = YETA2000.DPOB_CD                                                    
                            GROUP BY YETA2000.SYSTEMKEY                                                                       
                          ),0),                                                                                              

         /*   --종근무지_국민연금외교직원연금       */                                                                        
              BPSS_TECH = NVL((SELECT SUM(YETA3110.AUET_TECH)                                                                 
                             FROM (SELECT *                                                                                  
                                     FROM YETA3110                                                                            
                                    WHERE YETA3110.WTHD_SBYN = '1'                                                            
                                      AND YETA3110.MANG_GBYN = '1') YETA3110                                                   
                            WHERE YETA3110.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                                   
                              AND YETA3110.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                                   
                              AND YETA3110.SETT_GBCD(+) = YETA2000.SETT_GBCD   
                               AND YETA3110.DPOB_CD(+) = YETA2000.DPOB_CD                                                   
                            GROUP BY YETA2000.SYSTEMKEY                                                                       
                          ),0),                                                                                              

          /*  --종근무지_국민연금외별정우체국   */                                                                             
              BPSS_FECT = NVL((SELECT SUM(YETA3110.AUET_FECT)                                                                 
                             FROM (SELECT *                                                                                  
                                     FROM YETA3110                                                                            
                                    WHERE YETA3110.WTHD_SBYN = '1'                                                            
                                      AND YETA3110.MANG_GBYN = '1') YETA3110                                                   
                            WHERE YETA3110.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                                   
                              AND YETA3110.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                                   
                              AND YETA3110.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                               AND YETA3110.DPOB_CD(+) = YETA2000.DPOB_CD                                                    
                            GROUP BY YETA2000.SYSTEMKEY                                                                       
                          ),0),                                                                                              

          /*   --종근무지_과학기술인공제     */                                                                                 
              BRTR_CICT = NVL((SELECT SUM(YETA3110.RTRE_MUAM)                                                                 
                             FROM (SELECT *                                                                                  
                                     FROM YETA3110                                                                            
                                    WHERE YETA3110.WTHD_SBYN = '1'                                                            
                                      AND YETA3110.MANG_GBYN = '1') YETA3110                                                   
                            WHERE YETA3110.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                                   
                              AND YETA3110.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                                   
                              AND YETA3110.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                               AND YETA3110.DPOB_CD(+) = YETA2000.DPOB_CD                                                    
                            GROUP BY YETA2000.SYSTEMKEY                                                                       
                          ),0),                                                                                              


        /*  --종근무지_근로자퇴직급여보장법  */                                                                                    
              BRTR_PSCT = NVL((SELECT SUM(YETA3110.RTRE_PSCT)                                                                 
                             FROM (SELECT *                                                                                  
                                     FROM YETA3110                                                                            
                                    WHERE YETA3110.WTHD_SBYN = '1'                                                            
                                      AND YETA3110.MANG_GBYN = '1') YETA3110                                                   
                            WHERE YETA3110.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                                   
                              AND YETA3110.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                                   
                              AND YETA3110.SETT_GBCD(+) = YETA2000.SETT_GBCD 
                               AND YETA3110.DPOB_CD(+) = YETA2000.DPOB_CD                                                     
                            GROUP BY YETA2000.SYSTEMKEY                                                                       
                          ),0),                                                                                              


           /*   --종근무지_연금저축금액     */                                                                                 
              BRTR_ANSV = NVL((SELECT SUM(YETA3110.RTRE_ANSV)                                                                 
                             FROM (SELECT *                                                                                  
                                     FROM YETA3110                                                                            
                                    WHERE YETA3110.WTHD_SBYN = '1'                                                            
                                      AND YETA3110.MANG_GBYN = '1') YETA3110                                                   
                            WHERE YETA3110.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                                   
                              AND YETA3110.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                                   
                              AND YETA3110.SETT_GBCD(+) = YETA2000.SETT_GBCD 
                               AND YETA3110.DPOB_CD(+) = YETA2000.DPOB_CD                                                     
                            GROUP BY YETA2000.SYSTEMKEY                                                                       
                          ),0),                                                                                              


          /*   --특별공제_종건강보험료  */                                                                                      
              SPCI_BHLH = NVL((SELECT SUM(YETA3110.HLTH_DBAM)                                                                 
                             FROM (SELECT *                                                                                  
                                     FROM YETA3110                                                                            
                                    WHERE YETA3110.WTHD_SBYN = '1'                                                            
                                      AND YETA3110.MANG_GBYN = '1') YETA3110                                                   
                            WHERE YETA3110.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                                   
                              AND YETA3110.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                                   
                              AND YETA3110.SETT_GBCD(+) = YETA2000.SETT_GBCD 
                               AND YETA3110.DPOB_CD(+) = YETA2000.DPOB_CD                                                     
                            GROUP BY YETA2000.SYSTEMKEY                                                                       
                          ),0),                                                                                              

          /* --특별공제_의료비_본인    */                                                                          
                SPCI_SELF = NVL((SELECT SUM(NVL(YETA3220.MEDI_COST,0)) + SUM(NVL(YETA3220.MEDI_EXPS,0))                                      
                                  FROM YETA3220                                                                               
                               WHERE YETA3220.SYSTEMKEY = YETA2000.SYSTEMKEY                                                   
                                 AND YETA3220.EDAC_RVYY = YETA2000.EDAC_RVYY                                                   
                                 AND YETA3220.SETT_GBCD = YETA2000.SETT_GBCD  
                                  AND YETA3220.DPOB_CD = YETA2000.DPOB_CD                                                    
                                 AND  YETA3220.RELH_CODE = 'A0190001'                                                               
                                 GROUP BY YETA3220.SYSTEMKEY), 0),                                                                                                                      
                                                                                                                                                                                               


  /*      --특별공제_의료비_경로   */                                                                          
                SPCI_AE65 = NVL((SELECT SUM(NVL(YETA3220.MEDI_COST,0)) + SUM(NVL(YETA3220.MEDI_EXPS,0))                                      
                                  FROM YETA3220                                                                               
                               WHERE YETA3220.SYSTEMKEY = YETA2000.SYSTEMKEY                                                   
                                 AND YETA3220.EDAC_RVYY = YETA2000.EDAC_RVYY                                                   
                                 AND YETA3220.SETT_GBCD = YETA2000.SETT_GBCD  
                                   AND YETA3220.DPOB_CD = YETA2000.DPOB_CD   
                                  AND PSCL_DDYN NOT IN ('1','2','3')   
                                  AND  YETA3220.RELH_CODE <> 'A0190001'                                                  
                                  AND    #edacRvyy# -  (DECODE(SUBSTR(YETA3220.RSNO_NUMB, 7, 1), '1', '19',                                    
                                      DECODE(SUBSTR(YETA3220.RSNO_NUMB, 7, 1), '2', '19', DECODE(SUBSTR(YETA3220.RSNO_NUMB, 7, 1), '5', '19', DECODE(SUBSTR(YETA3220.RSNO_NUMB, 7, 1), '6', '19', '20')))) ||             
                                          SUBSTR(YETA3220.RSNO_NUMB, 1, 2)) >= 65                                                                                                                       
                                         GROUP BY YETA3220.SYSTEMKEY), 0),   

  /*     --특별공제_의료비_장애인     */                                                                        
                SPCI_DBPS = NVL((SELECT SUM(NVL(YETA3220.MEDI_COST,0)) + SUM(NVL(YETA3220.MEDI_EXPS,0))                                      
                                  FROM YETA3220                                                                               
                               WHERE YETA3220.SYSTEMKEY = YETA2000.SYSTEMKEY                                                   
                                 AND YETA3220.EDAC_RVYY = YETA2000.EDAC_RVYY                                                   
                                 AND YETA3220.SETT_GBCD = YETA2000.SETT_GBCD 
                                   AND YETA3220.DPOB_CD = YETA2000.DPOB_CD                                                     
                                 AND YETA3220.RELH_CODE != 'A0190001'  AND YETA3220.PSCL_DDYN IN ('1','2','3')                                                                  
                                 GROUP BY YETA3220.SYSTEMKEY), 0),                                                                                                                      
         /*     --특별공제_난임수술비                                                                                                                                                                                          
             CTIF_TRAM = NVL((SELECT SUM(NVL(YETA3220.MEDI_COST,0)) + SUM(NVL(YETA3220.MEDI_EXPS,0))                                      
                                  FROM YETA3220                                                                               
                               WHERE YETA3220.SYSTEMKEY = YETA2000.SYSTEMKEY                                                   
                                 AND YETA3220.EDAC_RVYY = YETA2000.EDAC_RVYY                                                   
                                 AND YETA3220.SETT_GBCD = YETA2000.SETT_GBCD 
                                 AND YETA3220.DPOB_CD = YETA2000.DPOB_CD             
                                 AND YETA3220.RELH_CODE != 'A0190001'  AND YETA3220.PSCL_DDYN IN ('1','2','3')                                                                  
                                 GROUP BY YETA3220.SYSTEMKEY), 0),       */         

 /*  --특별공제_의료비_기타공제대상자   */                                                                                                                                                
                SPCI_DETC = NVL((SELECT SUM(NVL(YETA3220.MEDI_COST,0)) + SUM(NVL(YETA3220.MEDI_EXPS,0))                                                                                                        
                                  FROM YETA3220                                                                                                                                                 
                               WHERE YETA3220.SYSTEMKEY = YETA2000.SYSTEMKEY                                                                                                                     
                                 AND YETA3220.EDAC_RVYY = YETA2000.EDAC_RVYY                                                                                                                     
                                 AND YETA3220.SETT_GBCD = YETA2000.SETT_GBCD  
                                 AND YETA3220.DPOB_CD = YETA2000.DPOB_CD                                                                                                                      
                                 AND RELH_CODE != 'A0190001'                                                                                                                                   
                                 AND PSCL_DDYN NOT IN ('1','2','3')                                                                                                                                          
                                 AND #edacRvyy# -  (DECODE(SUBSTR(RSNO_NUMB, 7, 1), '1', '19',                                                                                                     
                                      DECODE(SUBSTR(RSNO_NUMB, 7, 1), '2', '19', DECODE(SUBSTR(RSNO_NUMB, 7, 1), '5', '19', DECODE(SUBSTR(RSNO_NUMB, 7, 1), '6', '19', '20')))) ||             
                                          SUBSTR(RSNO_NUMB, 1, 2)) < 65                                                                                                                        
                                         GROUP BY YETA3220.SYSTEMKEY), 0),                                                                                                                      
   /*            --특별공제_종고용보험료    */                                                                             
              SPCI_BEPF = NVL((SELECT SUM(YETA3110.UPIS_JUAM)                                                         
                             FROM (SELECT *                                                                          
                                     FROM YETA3110                                                                    
                                    WHERE YETA3110.WTHD_SBYN = '1'                                                    
                                      AND YETA3110.MANG_GBYN = '1') YETA3110                                           
                            WHERE YETA3110.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                           
                              AND YETA3110.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                           
                              AND YETA3110.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                                AND YETA3110.DPOB_CD(+) = YETA2000.DPOB_CD                                            
                            GROUP BY YETA2000.SYSTEMKEY                                                               
                          ),0),                                                                                      
  /*            --특별공제_교육비_취학전아동수  */                                                                        
              SPED_EDSU = NVL((SELECT COUNT(YETA3150.EDAC_OTAM)                                                       
                             FROM (SELECT *                                                                          
                                     FROM YETA3150                                                                    
                                    WHERE YETA3150.FMAC_GBCD = 'Y0030010') YETA3150                                    
                            WHERE YETA3150.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                           
                              AND YETA3150.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                           
                              AND YETA3150.SETT_GBCD(+) = YETA2000.SETT_GBCD 
                               AND YETA3150.DPOB_CD(+) = YETA2000.DPOB_CD                                             
                            GROUP BY YETA2000.SYSTEMKEY                                                               
                          ),0),                                                                                      
        /*   --특별공제_교육비_취학전아동       */                                                                      
              SPED_EDAM = NVL((SELECT SUM(YETA3150.EDAC_OTAM)                                                         
                             FROM (SELECT *                                                                          
                                     FROM YETA3150                                                                    
                                    WHERE YETA3150.FMAC_GBCD = 'Y0030010') YETA3150                                    
                            WHERE YETA3150.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                           
                              AND YETA3150.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                           
                              AND YETA3150.SETT_GBCD(+) = YETA2000.SETT_GBCD 
                               AND YETA3150.DPOB_CD(+) = YETA2000.DPOB_CD                                           
                            GROUP BY YETA2000.SYSTEMKEY                                                               
                          ),0),                                                                                      
        /*   --특별공제_교육비_초중고자녀수   */                                                                       
              SPED_GDSU = NVL((SELECT COUNT(YETA3150.EDAC_OTAM)                                                       
                             FROM (SELECT *                                                                          
                                     FROM YETA3150                                                                    
                                    WHERE YETA3150.FMAC_GBCD = 'Y0030020') YETA3150                                    
                            WHERE YETA3150.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                           
                              AND YETA3150.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                           
                              AND YETA3150.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                               AND YETA3150.DPOB_CD(+) = YETA2000.DPOB_CD                                          
                            GROUP BY YETA2000.SYSTEMKEY                                                               
                          ),0),                                                                                      
          /*  --특별공제_교육비_초중고        */                                                                        
              SPED_GDAM = NVL((SELECT SUM(YETA3150.EDAC_OTAM)                                                         
                             FROM (SELECT *                                                                          
                                     FROM YETA3150                                                                    
                                    WHERE YETA3150.FMAC_GBCD = 'Y0030020') YETA3150                                    
                            WHERE YETA3150.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                           
                              AND YETA3150.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                           
                              AND YETA3150.SETT_GBCD(+) = YETA2000.SETT_GBCD   
                               AND YETA3150.DPOB_CD(+) = YETA2000.DPOB_CD                                         
                            GROUP BY YETA2000.SYSTEMKEY                                                               
                          ),0),                                                                                      
        /*   --특별공제_교육비_대학생수      */                                                                        
              SPED_CVSU = NVL((SELECT COUNT(YETA3150.EDAC_OTAM)                                                       
                             FROM (SELECT *                                                                          
                                     FROM YETA3150                                                                    
                                    WHERE YETA3150.FMAC_GBCD = 'Y0030030') YETA3150                                    
                            WHERE YETA3150.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                           
                              AND YETA3150.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                           
                              AND YETA3150.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                               AND YETA3150.DPOB_CD(+) = YETA2000.DPOB_CD                                          
                            GROUP BY YETA2000.SYSTEMKEY                                                               
                          ),0),                                                                                      
    /* --특별공제_교육비_대학교     */                                                                              
              SPED_CVAM = NVL((SELECT SUM(YETA3150.EDAC_OTAM)                                                         
                             FROM (SELECT *                                                                          
                                     FROM YETA3150                                                                    
                                    WHERE YETA3150.FMAC_GBCD = 'Y0030030') YETA3150                                    
                            WHERE YETA3150.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                           
                              AND YETA3150.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                           
                              AND YETA3150.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                               AND YETA3150.DPOB_CD(+) = YETA2000.DPOB_CD                                          
                            GROUP BY YETA2000.SYSTEMKEY                                                               
                          ),0),                                                                                      
  /*   --특별공제_장애인수   */                                                                                   
              SPCI_SCSU = NVL((SELECT COUNT(YETA3220.RELH_CODE)                                                       
                             FROM (SELECT * FROM YETA3220 WHERE YETA3220.PSCL_DDYN IN ('1','2','3')) YETA3220                      
                            WHERE YETA3220.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                           
                              AND YETA3220.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                           
                              AND YETA3220.SETT_GBCD(+) = YETA2000.SETT_GBCD    
                               AND YETA3220.DPOB_CD(+) = YETA2000.DPOB_CD                                        
                            GROUP BY YETA2000.SYSTEMKEY                                                               
                          ),0),                                                                                      
    /*  --특별공제_기부금_정치  */                                                                                
               SPCI_PLTC = NVL((SELECT CASE WHEN SUM(NVL(YETA3180.CTRB_AMNT,0)) > 100000                              
                                        THEN SUM(YETA3180.CTRB_AMNT) - 100000                                         
                                        ELSE 0                                                                       
                                        END                                                                          
                             FROM (SELECT * FROM YETA3180 WHERE YETA3180.CTRB_TYCD IN ('20')) YETA3180                  
                            WHERE YETA3180.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                           
                              AND YETA3180.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                           
                              AND YETA3180.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                                AND YETA3180.DPOB_CD(+) = YETA2000.DPOB_CD                                           
                            GROUP BY YETA2000.SYSTEMKEY                                                               
                          ),0),                                                                                      
                                                                                                                     
                                                                                    
         /*  --특별공제_기부금_정치 - 10만이하 대상금액     */                                                                           
               TAXD_PLTC = NVL((SELECT CASE WHEN SUM(NVL(YETA3180.CTRB_AMNT,0)) > 100000                              
                                        THEN  100000                                                                 
                                        ELSE SUM(NVL(YETA3180.CTRB_AMNT,0))                                           
                                        END                                                                          
                             FROM (SELECT * FROM YETA3180 WHERE YETA3180.CTRB_TYCD IN ('20')) YETA3180                  
                            WHERE YETA3180.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                           
                              AND YETA3180.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                           
                              AND YETA3180.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                               AND YETA3180.DPOB_CD(+) = YETA2000.DPOB_CD                                          
                            GROUP BY YETA2000.SYSTEMKEY                                                               
                          ),0),                                                                                      
                                                                                                                     
  /*     --특별공제_기부금_법정포함    */                                                                              
                SPCI_FBAM = NVL(( SELECT SUM(A)                                                                      
                                FROM                                                                                 
                              (                                                                                      
                             SELECT YETA3180.CTRB_AMNT AS A, YETA3180.SYSTEMKEY, YETA3180.EDAC_RVYY, YETA3180.SETT_GBCD ,YETA3180.DPOB_CD                              
                                  FROM (SELECT * FROM YETA3180 WHERE YETA3180.CTRB_TYCD IN ('10')) YETA3180  
                              ) YETA3180                                                                                    
                              WHERE YETA3180.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                             
                                AND YETA3180.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                             
                                AND YETA3180.SETT_GBCD(+) = YETA2000.SETT_GBCD 
                                 AND YETA3180.DPOB_CD(+) = YETA2000.DPOB_CD                                             
                              GROUP BY YETA2000.SYSTEMKEY                                                                 
                            ),0),                                                                                        
     /*  --이월법정_기부금_법정포함   */                                                                               
                SPCI_OBAM = NVL(( SELECT SUM(CTRB_AMNT)                                                                      
                                FROM                                                                                
                              (                                                                                      
                            SELECT YETA3190.DETR_AMNT AS CTRB_AMNT, YETA3190.SYSTEMKEY, YETA3190.EDAC_RVYY, YETA3190.SETT_GBCD ,YETA3190.DPOB_CD           
                                  FROM (SELECT * FROM YETA3190 WHERE YETA3190.CTRB_TYCD IN ('10') AND DETR_AMNT > 0  AND YETA3190.CTRB_YRMN <= '2013') YETA3190  
                              ) YETA3180                                                                                    
                              WHERE YETA3180.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                             
                                AND YETA3180.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                             
                                AND YETA3180.SETT_GBCD(+) = YETA2000.SETT_GBCD 
                                 AND YETA3180.DPOB_CD(+) = YETA2000.DPOB_CD                                             
                              GROUP BY YETA2000.SYSTEMKEY                                                                 
                            ),0),                                                                                        
     /*  --이월법정_기부금_법정포함 2014년도분리 2015귀속   */                                                                               
                SPCI_OB14 = NVL(( SELECT SUM(CTRB_AMNT)                                                                      
                                FROM                                                                                
                              (                                                                                      
                            SELECT YETA3190.DETR_AMNT AS CTRB_AMNT, YETA3190.SYSTEMKEY, YETA3190.EDAC_RVYY, YETA3190.SETT_GBCD ,YETA3190.DPOB_CD           
                                  FROM (SELECT * FROM YETA3190 WHERE YETA3190.CTRB_TYCD IN ('10') AND DETR_AMNT > 0  AND YETA3190.CTRB_YRMN = '2014') YETA3190  
                              ) YETA3180                                                                                    
                              WHERE YETA3180.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                             
                                AND YETA3180.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                             
                                AND YETA3180.SETT_GBCD(+) = YETA2000.SETT_GBCD 
                                 AND YETA3180.DPOB_CD(+) = YETA2000.DPOB_CD                                             
                              GROUP BY YETA2000.SYSTEMKEY                                                                 
                            ),0),    
    /*   --특별공제_기부금_50%도 사용안함.    */                                                                                 
              SPCI_EXAM = 0, 
  /*       -- 특별공제_기부금_30%도  _우리사주  */                                                                        
                    SPCI_HFAM = NVL((SELECT SUM(YETA3180.CTRB_AMNT)                                                       
                             FROM (SELECT * FROM YETA3180 WHERE YETA3180.CTRB_TYCD IN ('42')) YETA3180                      
                            WHERE YETA3180.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                               
                              AND YETA3180.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                               
                              AND YETA3180.SETT_GBCD(+) = YETA2000.SETT_GBCD   
                               AND YETA3180.DPOB_CD(+) = YETA2000.DPOB_CD                                             
                            GROUP BY YETA2000.SYSTEMKEY                                                                   
                          ),0),                                                                                          
  /*   --특별공제_기부금_공익법인신탁특례_50%  --해당없음.   */                                                                    
              SPCI_UNON =  0 ,
  /*        --이월 _기부금_공익법인신탁특례_50%    */                                                                     
              SPCI_ONON = NVL((SELECT SUM(YETA3180.CTRB_AMNT)                                                             
                             FROM (                                                                                       
                          SELECT YETA3190.DETR_AMNT AS CTRB_AMNT, YETA3190.SYSTEMKEY, YETA3190.EDAC_RVYY, YETA3190.SETT_GBCD,YETA3190.DPOB_CD      
                                FROM (SELECT * FROM YETA3190 WHERE YETA3190.CTRB_TYCD IN ('31') AND DETR_AMNT > 0  AND YETA3190.CTRB_YRMN <= '2012') YETA3190   
                      ) YETA3180                                                                                    
                            WHERE YETA3180.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                               
                              AND YETA3180.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                               
                              AND YETA3180.SETT_GBCD(+) = YETA2000.SETT_GBCD 
                               AND YETA3180.DPOB_CD(+) = YETA2000.DPOB_CD                                               
                            GROUP BY YETA2000.SYSTEMKEY                                                                   
                          ),0),                                                                                          

     /*       --특별공제_기부금_종교단체     */                                                                                 
              SPCI_YAMT = NVL((SELECT SUM(YETA3180.CTRB_AMNT)                                                                 
                             FROM (                                                                                          
                             SELECT YETA3180.CTRB_AMNT AS CTRB_AMNT, YETA3180.SYSTEMKEY, YETA3180.EDAC_RVYY, YETA3180.SETT_GBCD,YETA3180.DPOB_CD    
                                  FROM (SELECT * FROM YETA3180 WHERE YETA3180.CTRB_TYCD IN ('41')) YETA3180     
                                 ) YETA3180                                                                                   
                            WHERE YETA3180.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                               
                              AND YETA3180.EDAC_RVYY(+) = YETA2000.EDAC_RVYY  
                               AND YETA3180.DPOB_CD(+) = YETA2000.DPOB_CD                                              
                              AND YETA3180.SETT_GBCD(+) = YETA2000.SETT_GBCD                                               
                            GROUP BY YETA2000.SYSTEMKEY                                                                   
                          ),0),                                                                                          

         /*  --이월_기부금_종교단체  */                                                                                    
              SPCI_OYAM = NVL((SELECT SUM(YETA3180.CTRB_AMNT)                                                                 
                             FROM (                                                                                          
                             SELECT YETA3190.DETR_AMNT AS CTRB_AMNT, YETA3190.SYSTEMKEY, YETA3190.EDAC_RVYY, YETA3190.SETT_GBCD ,YETA3190.DPOB_CD   
                                  FROM (SELECT * FROM YETA3190 WHERE YETA3190.CTRB_TYCD IN ('41') AND DETR_AMNT > 0  AND YETA3190.CTRB_YRMN <= '2013') YETA3190 
                                 ) YETA3180                                                                                   
                            WHERE YETA3180.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                               
                              AND YETA3180.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                               
                              AND YETA3180.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                               AND YETA3180.DPOB_CD(+) = YETA2000.DPOB_CD                                              
                            GROUP BY YETA2000.SYSTEMKEY                                                                   
                          ),0),                                                                                          
        /*   이월_기부금_종교단체 2014년도  */                                                                                    
              SPCI_OY14 = NVL((SELECT SUM(YETA3180.CTRB_AMNT)                                                                 
                             FROM (                                                                                          
                             SELECT YETA3190.DETR_AMNT AS CTRB_AMNT, YETA3190.SYSTEMKEY, YETA3190.EDAC_RVYY, YETA3190.SETT_GBCD ,YETA3190.DPOB_CD   
                                  FROM (SELECT * FROM YETA3190 WHERE YETA3190.CTRB_TYCD IN ('41') AND DETR_AMNT > 0  AND YETA3190.CTRB_YRMN = '2014') YETA3190 
                                 ) YETA3180                                                                                   
                            WHERE YETA3180.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                               
                              AND YETA3180.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                               
                              AND YETA3180.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                               AND YETA3180.DPOB_CD(+) = YETA2000.DPOB_CD                                              
                            GROUP BY YETA2000.SYSTEMKEY                                                                   
                          ),0),              

      /*  특별공제_기부금_종교단체외   */                                                                             
                SPCI_NAMT = NVL(( SELECT SUM(CTRB_AMNT)                                                                          
                                FROM                                                                                     
                              (                                                                                          
                                   SELECT YETA3180.CTRB_AMNT AS CTRB_AMNT , YETA3180.SYSTEMKEY, YETA3180.EDAC_RVYY, YETA3180.SETT_GBCD ,YETA3180.DPOB_CD     
                                        FROM (SELECT * FROM YETA3180 WHERE YETA3180.CTRB_TYCD IN ('40')) YETA3180    
                              ) YETA3180                                                                                  
                              WHERE YETA3180.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                             
                                AND YETA3180.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                             
                                AND YETA3180.SETT_GBCD(+) = YETA2000.SETT_GBCD
                                 AND YETA3180.DPOB_CD(+) = YETA2000.DPOB_CD                                              
                              GROUP BY YETA2000.SYSTEMKEY                                                                 
                            ),0),                                                                                        
         /*   --이월_기부금_종교단체외     */                                                                           
                SPCI_ONAM = NVL(( SELECT SUM(CTRB_AMNT)                                                                          
                                FROM                                                                                     
                              (                                                                                          
                                  SELECT YETA3190.DETR_AMNT AS CTRB_AMNT , YETA3190.SYSTEMKEY, YETA3190.EDAC_RVYY, YETA3190.SETT_GBCD ,YETA3190.DPOB_CD     
                                        FROM (SELECT * FROM YETA3190 WHERE YETA3190.CTRB_TYCD IN ('40') AND DETR_AMNT > 0  AND YETA3190.CTRB_YRMN <= '2013') YETA3190   
                              ) YETA3180                                                                                  
                              WHERE YETA3180.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                             
                                AND YETA3180.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                             
                                AND YETA3180.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                                 AND YETA3180.DPOB_CD(+) = YETA2000.DPOB_CD                                            
                              GROUP BY YETA2000.SYSTEMKEY                                                                 
                            ),0) ,
            /*   --이월_기부금_종교단체외  2014년도    */                                                                           
                SPCI_ON14 = NVL(( SELECT SUM(CTRB_AMNT)                                                                          
                                FROM                                                                                     
                              (                                                                                          
                                  SELECT YETA3190.DETR_AMNT AS CTRB_AMNT , YETA3190.SYSTEMKEY, YETA3190.EDAC_RVYY, YETA3190.SETT_GBCD ,YETA3190.DPOB_CD     
                                        FROM (SELECT * FROM YETA3190 WHERE YETA3190.CTRB_TYCD IN ('40') AND DETR_AMNT > 0  AND YETA3190.CTRB_YRMN = '2014') YETA3190   
                              ) YETA3180                                                                                  
                              WHERE YETA3180.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                             
                                AND YETA3180.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                             
                                AND YETA3180.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                                 AND YETA3180.DPOB_CD(+) = YETA2000.DPOB_CD                                            
                              GROUP BY YETA2000.SYSTEMKEY                                                                 
                            ),0) ,
            /*   --특별공제_장애인전용보장성보험    */                                                                                   
              SPCI_HDRC = NVL((SELECT (SUM(NVL(YETA3220.PSCL_IURR,0))  + SUM(NVL(YETA3220.PSCL_IURT,0)))                                                       
                             FROM  YETA3220                      
                            WHERE YETA3220.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                           
                              AND YETA3220.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                           
                              AND YETA3220.SETT_GBCD(+) = YETA2000.SETT_GBCD    
                               AND YETA3220.DPOB_CD(+) = YETA2000.DPOB_CD                                        
                            GROUP BY YETA2000.SYSTEMKEY                                                               
                          ),0),   
            /*   --특별공제_일반보장성보험    */                                                                                   
              SPCI_GURT = NVL((SELECT (SUM(NVL(YETA3220.INSU_RTYR,0))  + SUM(NVL(YETA3220.INSU_RTET,0)))                                                      
                             FROM YETA3220                      
                            WHERE YETA3220.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                                           
                              AND YETA3220.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                                           
                              AND YETA3220.SETT_GBCD(+) = YETA2000.SETT_GBCD    
                               AND YETA3220.DPOB_CD(+) = YETA2000.DPOB_CD                                        
                            GROUP BY YETA2000.SYSTEMKEY                                                               
                          ),0)                                                                                                                                                                  
	            , ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#                                                                                    
             	WHERE DPOB_CD=#dpobCd#
								AND EDAC_RVYY=#edacRvyy#
								AND SETT_GBCD=#settGbcd#
								AND SYSTEMKEY=#systemkey#
			 
				]]>
	</update> 
	 
	  <!-- 연금/소득공제 추가 로직 -->
	   <update id="yetaPrcTaxDAO.fnPayr06420_PAYR415_ReTax_2014_CREATE_02_1_Update">
		<![CDATA[
    UPDATE YETA2000                                                                                   
  /*  --Y0040010    B011    0010    근로자퇴직연금보장법                    11  */        
        SET JRTR_PSCT = (SELECT   SUM(NVL(PAYT_AMNT,0)) AS  PAYT_AMNT                         
                           FROM   YETA3100                                                     
                          WHERE YETA3100.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                      
                            AND YETA3100.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                      
                            AND YETA3100.SETT_GBCD(+) = YETA2000.SETT_GBCD 
                            AND YETA3100.DPOB_CD(+) = YETA2000.DPOB_CD                       
                            AND YETA3100.IMDE_GBCD IN ('Y0040010')                             
                            AND YETA3100.IMDE_TXCD IN ('11')                                   
                          GROUP BY YETA2000.SYSTEMKEY                                          
                        ),                                                                    
 /* --Y0040020    B011    0020    과학기술인공제회                    12   */        
              JRTR_CICT = (SELECT   SUM(NVL(PAYT_AMNT,0)) AS  PAYT_AMNT                       
                           FROM   YETA3100                                                     
                          WHERE YETA3100.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                      
                            AND YETA3100.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                      
                            AND YETA3100.SETT_GBCD(+) = YETA2000.SETT_GBCD 
                            AND YETA3100.DPOB_CD(+) = YETA2000.DPOB_CD                     
                            AND YETA3100.IMDE_GBCD IN ('Y0040020')                             
                            AND YETA3100.IMDE_TXCD IN ('12')                                   
                          GROUP BY YETA2000.SYSTEMKEY                                          
                        ),                                                                    
 /* --   Y0040030    B011    0030    개인연금저축                    21    */        
       PRVM_20BE  =  (SELECT   SUM(NVL(PAYT_AMNT,0)) AS  PAYT_AMNT                            
                           FROM   YETA3100                                                     
                          WHERE YETA3100.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                      
                            AND YETA3100.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                      
                            AND YETA3100.SETT_GBCD(+) = YETA2000.SETT_GBCD 
                            AND YETA3100.DPOB_CD(+) = YETA2000.DPOB_CD                     
                            AND YETA3100.IMDE_GBCD IN ('Y0040030')                             
                            AND YETA3100.IMDE_TXCD IN ('21')                                   
                          GROUP BY YETA2000.SYSTEMKEY                                          
                        ),                                                                    
 /* -- Y0040040    B011    0040    연금저축                    22      */            
                                                                                              
      JRTR_ANSV  =  (SELECT   SUM(NVL(PAYT_AMNT,0)) AS  PAYT_AMNT                             
                           FROM   YETA3100                                                     
                          WHERE YETA3100.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                      
                            AND YETA3100.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                      
                            AND YETA3100.SETT_GBCD(+) = YETA2000.SETT_GBCD    
                            AND YETA3100.DPOB_CD(+) = YETA2000.DPOB_CD                  
                            AND YETA3100.IMDE_GBCD IN ('Y0040040')                             
                            AND YETA3100.IMDE_TXCD IN ('22')                                   
                          GROUP BY YETA2000.SYSTEMKEY                                          
                        ),                                                                    
 /* -- Y0040050    B011    0050    청약저축                    31   */               
     ETCS_COMP  = (SELECT   SUM(NVL(PAYT_AMNT,0)) AS  PAYT_AMNT                               
                           FROM   YETA3100                                                     
                          WHERE YETA3100.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                      
                            AND YETA3100.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                      
                            AND YETA3100.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                            AND YETA3100.DPOB_CD(+) = YETA2000.DPOB_CD                    
                            AND YETA3100.IMDE_GBCD IN ('Y0040050')                             
                            AND YETA3100.IMDE_TXCD IN ('31')                                   
                          GROUP BY YETA2000.SYSTEMKEY                                          
                        ),                                                                    
                                                                                              
 /* -- Y0040060    B011    0060    주택청약종합저축                           32    */
      ETWK_HSBM  =  (SELECT   SUM(NVL(PAYT_AMNT,0)) AS  PAYT_AMNT                             
                           FROM   YETA3100                                                     
                          WHERE YETA3100.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                      
                            AND YETA3100.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                      
                            AND YETA3100.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                            AND YETA3100.DPOB_CD(+) = YETA2000.DPOB_CD                    
                            AND YETA3100.IMDE_GBCD IN ('Y0040060')                             
                            AND YETA3100.IMDE_TXCD IN ('32')                                   
                          GROUP BY YETA2000.SYSTEMKEY                                          
                        ),                                                                    
  
  /* -- Y0040080    B011    0080    근로자주택마련저축             34   */
         ETWK_HSVM  =  (SELECT   SUM(NVL(PAYT_AMNT,0)) AS  PAYT_AMNT                          
                           FROM   YETA3100                                                     
                          WHERE YETA3100.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                      
                            AND YETA3100.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                      
                            AND YETA3100.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                            AND YETA3100.DPOB_CD(+) = YETA2000.DPOB_CD                    
                            AND YETA3100.IMDE_GBCD IN ('Y0040080')                             
                            AND YETA3100.IMDE_TXCD IN ('34')                                   
                          GROUP BY YETA2000.SYSTEMKEY                                          
                        )      
                          WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#                                             
			 
				]]>
	</update>
	 <!--   //주택자금원리금상환액_거주자 /월세액납부 --> 
	   <update id="yetaPrcTaxDAO.fnPayr06420_PAYR415_ReTax_2014_CREATE_02_2_Update">
		<![CDATA[
              UPDATE YETA2000                                                                                   
  /*   --주택자금원리금상환액_거주자  */         
        SET SPCI_RESF = (SELECT   SUM(NVL(YETA3160.LEAS_DPST,0) + NVL(YETA3120.CNCL_RDMT,0)) AS  SPCI_RESF                         
                           FROM   YETA3160 ,YETA3120                                                    
                          WHERE YETA3160.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                      
                            AND YETA3160.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                      
                            AND YETA3160.SETT_GBCD(+) = YETA2000.SETT_GBCD                      
                            AND YETA3120.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                      
                            AND YETA3120.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                      
                            AND YETA3120.SETT_GBCD(+) = YETA2000.SETT_GBCD   
                            AND YETA3120.DPOB_CD(+) = YETA2000.DPOB_CD                    
                          GROUP BY YETA2000.SYSTEMKEY                                          
                        ),                                                                    
  /*    --월세액납부                   12   */         
              SPCI_HTAM = (SELECT   SUM(NVL(MNRN_AMNT,0)) AS  MNRN_AMNT                       
                           FROM   YETA3130                                                     
                          WHERE YETA3130.SYSTEMKEY(+) = YETA2000.SYSTEMKEY                      
                            AND YETA3130.EDAC_RVYY(+) = YETA2000.EDAC_RVYY                      
                            AND YETA3130.SETT_GBCD(+) = YETA2000.SETT_GBCD  
                            AND YETA3130.DPOB_CD(+) = YETA2000.DPOB_CD                     
                          GROUP BY YETA2000.SYSTEMKEY                                          
                        ) 
             WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#                      
				]]>
	</update>
	  <!-- //금액합계 -단계별급액합계 -->
	   <update id="yetaPrcTaxDAO.fnPayr06420_PAYR415_ReTax_2014_CREATE_02_Update">
		<![CDATA[
     UPDATE YETA2000           
           /*    //특별소득공제연급보험료계 */                                                                                                                     
            SET                                                                                                                                       
          RRPT_AMNT = NVL(BNAT_PSNF, 0) + NVL(JNAT_PSNF, 0) + NVL(BPSS_PULC, 0)  + NVL(BPSS_SOLD, 0)  + NVL(BPSS_TECH, 0)   + NVL(BPSS_FECT, 0)      
              + NVL(JPSS_FECT, 0)  + NVL(JPSS_PULC, 0)  + NVL(JPSS_SOLD, 0)  + NVL(JPSS_TECH, 0) ,  
        /* // 연금계좌계 */
          JRTR_ATOM =  NVL(BRTR_CICT, 0)+ NVL(BRTR_PSCT, 0)+ NVL(BRTR_ANSV, 0) + NVL(JRTR_CICT, 0)+ NVL(JRTR_PSCT, 0) + NVL(JRTR_ANSV, 0),    
        /* // 고용건강보험료 계 */
           SPCI_IUAM = NVL(SPCI_BHLH, 0) + NVL(SPCI_HHLH, 0) + NVL(SPCI_BEPF, 0) + NVL(SPCI_JEPF, 0) ,        
        /* //보장성보험료계 */
           SPCI_RTTO =   NVL(SPCI_GURT, 0) + NVL(SPCI_HDRC, 0),        
        /* //특별공제_의료비계 */
           SPCI_ETAM = NVL(SPCI_SELF, 0) +NVL(SPCI_AE65, 0) + NVL(SPCI_DBPS, 0) + NVL(SPCI_DETC, 0),                                                                                        
        /* //기타공제_장기주식형저축_납입합계금액_삭제 */
           ETCL_HMTA = 0, 
        /* //기타공제_신용카드등사용공제계 */
           ETCH_BCUE = NVL(ETCT_CARD, 0) + NVL(ETCH_UEAM, 0) + NVL(ETCH_BCED, 0) + NVL(etch_Bcbs, 0)+ NVL(ETCH_MGVD, 0),                                                
        /* // 특별공제_교육비계 */
           SIED_TOAM = NVL(SPED_SELF, 0) + NVL(SPED_EDAM, 0) + NVL(SPED_GDAM, 0) + NVL(SPED_CVAM, 0) + NVL(SPCI_SCAM, 0),                              
        /*  //기타공제투자조합출자금액계 */
           ETGD_HDAM = NVL(ETCL_H15F, 0) + NVL(ETGD_H14F, 0) + NVL(ETGD_H09F, 0) + NVL(ETGD_H13F, 0),                                                                                         
        /* //기타공제_주택마련저축소득금액계 */
           ETWK_HBDM = NVL(ETCS_COMP,0) + NVL(ETWK_HSVM,0) + NVL(ETWK_HSBM,0)  
            WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey# 
				]]>
	</update>
	  <!-- {공제단계 시작 01} -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_01_Update">
		<![CDATA[
			   UPDATE YETA3000                                                                                                                          
            SET                     
            /* 현근무지 금액 수정 으로 인해처리 하는 로직 수정  */                                                                                                       
 /*   --BEFO_SCNT IS '종전근무지수     */                                                                                                 
               BEFO_SCNT=      NVL((SELECT COUNT(*)                                                                                         
                               FROM (SELECT *                                                                                               
                                       FROM YETA3110                                                                                         
                                      WHERE YETA3110.WTHD_SBYN = '1'                                                                         
                                        AND YETA3110.MANG_GBYN = '1') YETA3110                                                                
                              WHERE YETA3110.SYSTEMKEY(+) = YETA3000.SYSTEMKEY                                                                
                                AND YETA3110.EDAC_RVYY(+) = YETA3000.EDAC_RVYY                                                                
                                AND YETA3110.SETT_GBCD(+) = YETA3000.SETT_GBCD      
                                 AND YETA3110.DPOB_CD(+) = YETA3000.DPOB_CD                                                           
                              GROUP BY YETA3000.SYSTEMKEY                                                                                    
                            ),0) ,                                                                                                          
  /*   --DCSN_TOTS IS '종전근무지)총급여   */                                                                                              
            DCSN_TOTS =  NVL((SELECT SUM(PAYR_TOTL + (BONS_AMNT + DTMN_BTAM + STCK_PRFT) - (TAXE_TOTL))             
                              FROM (SELECT *                                                                                                
                                      FROM YETA3110                                                                                          
                                     WHERE YETA3110.WTHD_SBYN = '1'                                                                          
                                       AND YETA3110.MANG_GBYN = '1') YETA3110                                                                 
                             WHERE YETA3110.SYSTEMKEY(+) = YETA3000.SYSTEMKEY                                                                 
                               AND YETA3110.EDAC_RVYY(+) = YETA3000.EDAC_RVYY                                                                 
                               AND YETA3110.SETT_GBCD(+) = YETA3000.SETT_GBCD   
                                AND YETA3110.DPOB_CD(+) = YETA3000.DPOB_CD                                                               
                             GROUP BY YETA3000.SYSTEMKEY                                                                                     
                           ), 0)  ,                                                                                                         
  /*    --DCSN_ITAX IS '종전근무지기납부세액)소득세    */                                                                                  
             DCSN_ITAX = NVL((SELECT SUM(NVL(EARN_TAXN, 0))                                                                                 
                              FROM (SELECT *                                                                                                
                                      FROM YETA3110                                                                                          
                                     WHERE YETA3110.WTHD_SBYN = '1'                                                                          
                                       AND YETA3110.MANG_GBYN = '1') YETA3110                                                                 
                             WHERE YETA3110.SYSTEMKEY(+) = YETA3000.SYSTEMKEY                                                                 
                               AND YETA3110.EDAC_RVYY(+) = YETA3000.EDAC_RVYY                                                                 
                               AND YETA3110.SETT_GBCD(+) = YETA3000.SETT_GBCD   
                                AND YETA3110.DPOB_CD(+) = YETA3000.DPOB_CD                                                               
                             GROUP BY YETA3000.SYSTEMKEY                                                                                     
                           ),0)  ,                                                                                                          
 /*  --DCSN_BTAX IS '종전근무지기납부세액)주민세     */                                                                                  
            DCSN_BTAX =  (SELECT SUM(NVL(IHTX_TAXN,0))                                                                                      
                              FROM (SELECT *                                                                                                
                                      FROM YETA3110                                                                                          
                                     WHERE YETA3110.WTHD_SBYN = '1'                                                                          
                                       AND YETA3110.MANG_GBYN = '1') YETA3110                                                                 
                             WHERE YETA3110.SYSTEMKEY(+) = YETA3000.SYSTEMKEY                                                                 
                               AND YETA3110.EDAC_RVYY(+) = YETA3000.EDAC_RVYY                                                                 
                               AND YETA3110.SETT_GBCD(+) = YETA3000.SETT_GBCD 
                                AND YETA3110.DPOB_CD(+) = YETA3000.DPOB_CD                                                                 
                             GROUP BY YETA3000.SYSTEMKEY                                                                                     
                           )  ,                                                                                                             
          /*  --FAFV_TAXI IS '종전근무지기납부세액)농특세    */                                                                                  
            FAFV_TAXI = (SELECT SUM(NVL(FARM_TAXN, 0))                                                                                      
                              FROM (SELECT *                                                                                                
                                      FROM YETA3110                                                                                          
                                     WHERE YETA3110.WTHD_SBYN = '1'                                                                          
                                       AND YETA3110.MANG_GBYN = '1') YETA3110                                                                 
                             WHERE YETA3110.SYSTEMKEY(+) = YETA3000.SYSTEMKEY                                                                 
                               AND YETA3110.EDAC_RVYY(+) = YETA3000.EDAC_RVYY                                                                 
                               AND YETA3110.SETT_GBCD(+) = YETA3000.SETT_GBCD 
                                AND YETA3110.DPOB_CD(+) = YETA3000.DPOB_CD                                                                 
                             GROUP BY YETA3000.SYSTEMKEY                                                                                     
                           ) ,                                                                                                              
         /*   --BASE_SELF IS '기본공제)본인  */                                                                                                  
              BASE_SELF = (CASE WHEN WKER_AMNT > 1500000 THEN 1500000 ELSE WKER_AMNT END) ,                                                  
         /* --BASE_WIFE IS '기본공제)배우자   */                                                                                                
             BASE_WIFE = NVL((SELECT COUNT(*) * 1500000                                                                                     
                          FROM (SELECT *                                                                                                    
                                  FROM YETA3220                                                                                              
                                 WHERE YETA3220.BASE_DDYN = '1' AND YETA3220.RELH_CODE IN ('A0190002','A0190007')) YETA3220                                    
                         WHERE YETA3220.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                        
                           AND YETA3220.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                        
                           AND YETA3220.SETT_GBCD = YETA3000.SETT_GBCD 
                            AND YETA3220.DPOB_CD = YETA3000.DPOB_CD                                                                        
                         GROUP BY YETA3000.SYSTEMKEY ), 0)  ,                                                                                
 /*  -- BASE_FYAM IS '기본공제)부양가족'   */                                                                                       
             BASE_FYAM =   NVL((SELECT COUNT(*) * 1500000                                                                                   
                              FROM (SELECT *                                                                                                
                                      FROM YETA3220                                                                                          
                                     WHERE YETA3220.BASE_DDYN = '1' AND YETA3220.RELH_CODE NOT IN('A0190001','A0190002','A0190007')) YETA3220                
                             WHERE YETA3220.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                    
                               AND YETA3220.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                    
                               AND YETA3220.SETT_GBCD = YETA3000.SETT_GBCD  
                                AND YETA3220.DPOB_CD = YETA3000.DPOB_CD                                                                    
                             GROUP BY YETA3000.SYSTEMKEY ), 0)   ,                                                                           
 /* --ADDR_HDAM IS '추가공제)장애인    */                                                                                           
            ADDR_HDAM =    NVL((SELECT COUNT(*) * 2000000                                                                                   
                              FROM (SELECT *                                                                                                
                                      FROM YETA3220                                                                                          
                                     WHERE YETA3220.BASE_DDYN = '1' AND YETA3220.PSCL_DDYN IN ('1','2','3')) YETA3220                                     
                             WHERE YETA3220.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                    
                               AND YETA3220.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                    
                               AND YETA3220.SETT_GBCD = YETA3000.SETT_GBCD     
                                AND YETA3220.DPOB_CD = YETA3000.DPOB_CD                                                                 
                             GROUP BY YETA3000.SYSTEMKEY ), 0) ,                                                                             
  /*  --ADDR_RP70 IS '추가공제)경로우대70   */                                                                                           
              ADDR_RPT70 =  NVL((SELECT NVL(COUNT(*), 0) * 1000000                                                                          
                              FROM (SELECT *                                                                                                
                                      FROM YETA3220                                                                                          
                                     WHERE YETA3220.BASE_DDYN = '1' AND YETA3220.RPCT_DDYN = '1') YETA3220                                     
                            WHERE YETA3220.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                     
                               AND YETA3220.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                    
                               AND YETA3220.SETT_GBCD = YETA3000.SETT_GBCD   
                                AND YETA3220.DPOB_CD = YETA3000.DPOB_CD                                                                   
                             GROUP BY YETA3000.SYSTEMKEY                                                                                     
                               ), 0),                                                                                                       
 /* --ADDR_FAME IS '추가공제)부녀자     */                                                                                             
              ADDR_FAME  =  NVL((SELECT NVL(COUNT(*), 0) * 500000                                                                           
                               FROM (SELECT *                                                                                               
                                      FROM YETA3220                                                                                          
                                     WHERE YETA3220.BASE_DDYN = '1' AND YETA3220.FADD_CTYN = '1') YETA3220                                     
                            WHERE YETA3220.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                     
                               AND YETA3220.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                    
                               AND YETA3220.SETT_GBCD = YETA3000.SETT_GBCD 
                                AND YETA3220.DPOB_CD = YETA3000.DPOB_CD                                                                     
                            GROUP BY YETA3000.SYSTEMKEY                                                                                      
                               ), 0) ,                                                                                                      
 /*   --ADDR_CHLD IS '추가공제)6세이하공제 소득세법 소급제정  NVL(COUNT(*), 0) * 150000     */                                                                                     
              ADDR_CHLD =  NVL((SELECT  CASE WHEN NVL(COUNT(*), 0) > 1 THEN  ((NVL(COUNT(*), 0) - 1) * 150000)   
                                  ELSE  0 END         
 
                               FROM (SELECT *                                                                                               
                                      FROM YETA3220                                                                                          
                                     WHERE YETA3220.BRDD_CTYN = '1') YETA3220                                                                 
                            WHERE YETA3220.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                     
                               AND YETA3220.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                    
                               AND YETA3220.SETT_GBCD = YETA3000.SETT_GBCD 
                                AND YETA3220.DPOB_CD = YETA3000.DPOB_CD                                                                     
                             GROUP BY YETA3000.SYSTEMKEY                                                                                     
                               ), 0) ,                                                                                                      
 /*  --ADDR_BRTH IS '추가공제)출산자녀양육비 소득세법 소급제정    */                                                                                    
             ADDR_BRTH =    NVL((SELECT  NVL(COUNT(*), 0) * 300000                                                                          
                               FROM (SELECT *                                                                                               
                                      FROM YETA3220                                                                                          
                                     WHERE YETA3220.BASE_DDYN = '1' AND YETA3220.BITH_DDYN = '1') YETA3220                                     
                            WHERE YETA3220.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                     
                               AND YETA3220.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                    
                               AND YETA3220.SETT_GBCD = YETA3000.SETT_GBCD   
                                AND YETA3220.DPOB_CD = YETA3000.DPOB_CD                                                                   
                             GROUP BY YETA3000.SYSTEMKEY                                                                                     
                               ), 0) ,                                                                                                      

 /* -- PANT_ONAM IS '추가공제)한부모공제   */                                                                                      
             PANT_ONAM =    NVL((SELECT (CASE WHEN NVL(COUNT(*), 0) > 0 THEN  1000000 ELSE 0 END)                                                                         
                               FROM (SELECT *                                                                                               
                                      FROM YETA3220                                                                                          
                                     WHERE YETA3220.BASE_DDYN = '1' AND YETA3220.PANT_ONYN = '1') YETA3220                                     
                            WHERE YETA3220.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                     
                               AND YETA3220.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                    
                               AND YETA3220.SETT_GBCD = YETA3000.SETT_GBCD  
                                AND YETA3220.DPOB_CD = YETA3000.DPOB_CD                                                                    
                             GROUP BY YETA3000.SYSTEMKEY                                                                                     
                               ), 0) ,   
                               
  /* --ADDR_MCAM IS '추가공제)자녀수 세액공제로 교체 됨.    ADDR_MCAM -사용안함.    */                                                                                            
              ADDR_MCCR    =   NVL((SELECT CASE WHEN NVL(COUNT(*), 0) > 2 THEN 300000 + ((NVL(COUNT(*), 0) - 2) * 300000)   
                                  ELSE  NVL(COUNT(*), 0) * 150000 END      
                               FROM (SELECT *                                                                                               
                                      FROM YETA3220                                                                                          
                                     WHERE YETA3220.BASE_DDYN = '1' AND YETA3220.RELH_CODE IN('A0190005') ) YETA3220                           
                            WHERE YETA3220.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                     
                               AND YETA3220.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                    
                               AND YETA3220.SETT_GBCD = YETA3000.SETT_GBCD   
                                AND YETA3220.DPOB_CD = YETA3000.DPOB_CD                                                                   
                             GROUP BY YETA3000.SYSTEMKEY                                                                                     
                               ), 0)  
                               , REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')                                                                                                      
            WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#  
			 
				]]>
	</update>
	  <!-- {공제단계 시작 -소득공제 02} 
	   총급여액,근로소득금액,근로소득공제금액 
	  -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_02_Update">
		<![CDATA[
			   UPDATE YETA3000                                                                                   
           SET                                                                                              
         /*  --TOTL_SALA IS '총급여(현+전)     */                                                               
            TOTL_SALA =  NVL(CURR_TOTS, 0) + NVL(DCSN_TOTS, 0) ,                                            
          /*  --WKER_DDCT IS '근로소득공제    */                                                                   
           WKER_DDCT =  TRUNC((CASE WHEN (CURR_TOTS + DCSN_TOTS) <= 5000000                                 
                                 THEN                                                                       
                                 (CURR_TOTS + DCSN_TOTS) * 0.7                                              
                                 WHEN 15000000 >= (CURR_TOTS + DCSN_TOTS)                                     
                                 THEN                                                                       
                                 3500000 + ((CURR_TOTS + DCSN_TOTS - 5000000)   * 0.4)                      
                                                                                                            
                                 WHEN 45000000 >= (CURR_TOTS + DCSN_TOTS)                                     
                                 THEN                                                                       
                                 7500000 + ((CURR_TOTS + DCSN_TOTS - 15000000)   * 0.15)                    
                                                                                                            
                                 WHEN 100000000 >= (CURR_TOTS + DCSN_TOTS)                                      
                                 THEN                                                                       
                                 12000000 + ((CURR_TOTS + DCSN_TOTS - 45000000)   * 0.05)                   
                                                                                                            
                                 ELSE                                                                       
                                 14750000 + ((CURR_TOTS + DCSN_TOTS - 100000000)   * 0.02)                   
                                 END)) ,                                                                    
          /*  --WKER_AMNT IS '근로소득금액        */                                                               
           WKER_AMNT = (CURR_TOTS + DCSN_TOTS -                                                             
                                 (                                                                          
                                 CASE WHEN (CURR_TOTS + DCSN_TOTS) <= 5000000                               
                                 THEN                                                                       
                                 (CURR_TOTS + DCSN_TOTS) * 0.7                                              
                                 WHEN 15000000 >= (CURR_TOTS + DCSN_TOTS)                                     
                                 THEN                                                                       
                                 3500000 + ((CURR_TOTS + DCSN_TOTS - 5000000)   * 0.4)                      
                                                                                                            
                                 WHEN 45000000 >= (CURR_TOTS + DCSN_TOTS)                                     
                                 THEN                                                                       
                                 7500000 + ((CURR_TOTS + DCSN_TOTS - 15000000)   * 0.15)                    
                                                                                                            
                                 WHEN 100000000 >= (CURR_TOTS + DCSN_TOTS)                                      
                                 THEN                                                                       
                                 12000000 + ((CURR_TOTS + DCSN_TOTS - 45000000)   * 0.05)                   
                                                                                                            
                                 ELSE                                                                       
                                 14750000 + ((CURR_TOTS + DCSN_TOTS - 100000000)   * 0.02)                   
                                 END                                                                        
                                 )) 
                                 , REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')                                                                        
             WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#  
				]]>
	</update>
	 
	   <!-- {공제단계 시작 -연금보험료공제 03} 연금보험료공제 
	    -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_03_Update">
		<![CDATA[
		 UPDATE YETA3000                                                                      
               SET                                                                          
             /*  --BNAT_DDCT IS '종근무지_국민연금보험료공제              */                      
                 BNAT_DDCT =  NVL((SELECT SUM(NVL(ANNU_DDAM, 0))                                
                                 FROM (SELECT *                                             
                                         FROM YETA3110                                       
                                        WHERE YETA3110.WTHD_SBYN = '1'                       
                                          AND YETA3110.MANG_GBYN = '1') YETA3110              
                                WHERE YETA3110.SYSTEMKEY(+) = YETA3000.SYSTEMKEY              
                                  AND YETA3110.EDAC_RVYY(+) = YETA3000.EDAC_RVYY              
                                  AND YETA3110.SETT_GBCD(+) = YETA3000.SETT_GBCD  
                                   AND YETA3110.DPOB_CD(+)  = YETA3000.DPOB_CD              
                                GROUP BY YETA3000.SYSTEMKEY                                  
                              ),0)  ,   
                                                                         
                /* -- BPSS_DDCT IS 종근무지_국민연금외공무원연금공제  */                         
               BPSS_HPUL = NVL((SELECT SUM(NVL(AUET_DDAM, 0))                                  
                                 FROM (SELECT *                                             
                                         FROM YETA3110                                       
                                        WHERE YETA3110.WTHD_SBYN = '1'                       
                                          AND YETA3110.MANG_GBYN = '1') YETA3110              
                                WHERE YETA3110.SYSTEMKEY(+) = YETA3000.SYSTEMKEY              
                                  AND YETA3110.EDAC_RVYY(+) = YETA3000.EDAC_RVYY              
                                  AND YETA3110.SETT_GBCD(+) = YETA3000.SETT_GBCD 
                                  AND YETA3110.DPOB_CD(+)  = YETA3000.DPOB_CD               
                                GROUP BY YETA3000.SYSTEMKEY                                  
                              ),0) ,                                                           
  /*  --//종근무지_군인연금보험료공제 */
                BPSS_HSOL = NVL((SELECT SUM(NVL(AUET_DOLD, 0))                                  
                                 FROM (SELECT *                                             
                                         FROM YETA3110                                       
                                        WHERE YETA3110.WTHD_SBYN = '1'                       
                                          AND YETA3110.MANG_GBYN = '1') YETA3110              
                                WHERE YETA3110.SYSTEMKEY(+) = YETA3000.SYSTEMKEY              
                                  AND YETA3110.EDAC_RVYY(+) = YETA3000.EDAC_RVYY              
                                  AND YETA3110.SETT_GBCD(+) = YETA3000.SETT_GBCD 
                                  AND YETA3110.DPOB_CD(+)  = YETA3000.DPOB_CD               
                                GROUP BY YETA3000.SYSTEMKEY                                  
                              ),0) ,                                                           
  /* -- //종근무지_교직원연금보험료공제 */
                BPSS_HTEC = NVL((SELECT SUM(NVL(AUET_DECH, 0))                                  
                                 FROM (SELECT *                                             
                                         FROM YETA3110                                       
                                        WHERE YETA3110.WTHD_SBYN = '1'                       
                                          AND YETA3110.MANG_GBYN = '1') YETA3110              
                                WHERE YETA3110.SYSTEMKEY(+) = YETA3000.SYSTEMKEY              
                                  AND YETA3110.EDAC_RVYY(+) = YETA3000.EDAC_RVYY              
                                  AND YETA3110.SETT_GBCD(+) = YETA3000.SETT_GBCD    
                                  AND YETA3110.DPOB_CD(+)  = YETA3000.DPOB_CD            
                                GROUP BY YETA3000.SYSTEMKEY                                  
                              ),0) ,                                                           
 /* --//종근무지_국민연금외공무원연금공제 */
                BPSS_DDCT = NVL((SELECT SUM(NVL(AUET_DECT, 0))                                  
                                 FROM (SELECT *                                             
                                         FROM YETA3110                                       
                                        WHERE YETA3110.WTHD_SBYN = '1'                       
                                          AND YETA3110.MANG_GBYN = '1') YETA3110              
                                WHERE YETA3110.SYSTEMKEY(+) = YETA3000.SYSTEMKEY              
                                  AND YETA3110.EDAC_RVYY(+) = YETA3000.EDAC_RVYY              
                                  AND YETA3110.SETT_GBCD(+) = YETA3000.SETT_GBCD    
                                  AND YETA3110.DPOB_CD(+)  = YETA3000.DPOB_CD            
                                GROUP BY YETA3000.SYSTEMKEY                                  
                              ),0) ,      
                              /* 국민연금보험료 공제 */ 
               JNAT_DDCT  =  (SELECT NVL(YETA2000.JNAT_PSNF,0)                                                               
                                FROM YETA2000                                                       
                          WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                      
                            AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                       
                            AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD
                            AND YETA2000.DPOB_CD = YETA3000.DPOB_CD ) ,                                                                        
              /*  --JPSS_DDCT IS '주근무지_국민연금외연금보험료공제       */                      
                  JPSS_HPUL = ( SELECT YETA2000.JPSS_PULC                                                  
                                  FROM YETA2000                                                                              
                                WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                    
                                  AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                 
                                  AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD
                                  AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD   ),                                                     
 /* -- //주_국민연금외군인연금 */
                 JPSS_HSOL =   (SELECT YETA2000.JPSS_SOLD                        
                                  FROM YETA2000                                                                                                    
                                WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                       
                                  AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                       
                                  AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD
                                  AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD    ),                                                     
/*  --//주_국민연금외교직원연금 */
                 JPSS_HTEC =  (SELECT YETA2000.JPSS_TECH                           
                                  FROM YETA2000                                                                                                    
                                WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                       
                                  AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                       
                                  AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD
                                  AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD    ) ,                                                    
 /* --//주근무지_국민연금외공무원연금공제 */
                  JPSS_DDCT =   (SELECT YETA2000.JPSS_FECT                           
                                  FROM YETA2000                                                                                     
                                WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                         
                                  AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                       
                                  AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD
                                  AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD    ),                                                     
      /*             --JPSS_DDCT  전액공제     --BRTR_PSRN IS '종근무지_퇴직연금소득공제  //종근무지_종_과학기술인공제 2014년 귀속분 세액공제로 인해 사용안함. */
               BRTR_HICT =  NVL((SELECT SUM(NVL(RTRE_DDAM, 0))                                  
                                 FROM (SELECT *                                             
                                         FROM YETA3110                                       
                                        WHERE YETA3110.WTHD_SBYN = '1'                       
                                          AND YETA3110.MANG_GBYN = '1') YETA3110              
                                WHERE YETA3110.SYSTEMKEY(+) = YETA3000.SYSTEMKEY              
                                  AND YETA3110.EDAC_RVYY(+) = YETA3000.EDAC_RVYY              
                                  AND YETA3110.SETT_GBCD(+) = YETA3000.SETT_GBCD 
                                  AND YETA3110.DPOB_CD(+)  = YETA3000.DPOB_CD                
                                GROUP BY YETA3000.SYSTEMKEY                                  
                              ),0),                                                            
 /*  --//종근무지_퇴직연금과학기술인공제  2014년 귀속분 세액공제로 인해 사용안함. */
               BRTR_PSRN =  NVL((SELECT SUM(NVL(RTRE_DSCT, 0))                                  
                                 FROM (SELECT *                                             
                                         FROM YETA3110                                       
                                        WHERE YETA3110.WTHD_SBYN = '1'                       
                                          AND YETA3110.MANG_GBYN = '1') YETA3110              
                                WHERE YETA3110.SYSTEMKEY(+) = YETA3000.SYSTEMKEY              
                                  AND YETA3110.EDAC_RVYY(+) = YETA3000.EDAC_RVYY              
                                  AND YETA3110.SETT_GBCD(+) = YETA3000.SETT_GBCD 
                                   AND YETA3110.DPOB_CD(+)  = YETA3000.DPOB_CD                
                                GROUP BY YETA3000.SYSTEMKEY                                  
                              ),0),                                                            
  /*  --//종근무지_종_연금저축계좌     2014년 귀속 세액공제 귀속으로 사용안함. */
               BRTR_HNSV =  NVL((SELECT SUM(NVL(RTRE_DNSV, 0))                                  
                                 FROM (SELECT *                                             
                                         FROM YETA3110                                       
                                        WHERE YETA3110.WTHD_SBYN = '1'                       
                                          AND YETA3110.MANG_GBYN = '1') YETA3110              
                                WHERE YETA3110.SYSTEMKEY(+) = YETA3000.SYSTEMKEY              
                                  AND YETA3110.EDAC_RVYY(+) = YETA3000.EDAC_RVYY              
                                  AND YETA3110.SETT_GBCD(+) = YETA3000.SETT_GBCD 
                                   AND YETA3110.DPOB_CD(+)  = YETA3000.DPOB_CD                
                                GROUP BY YETA3000.SYSTEMKEY                                  
                              ),0) 
                   WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#                                                                       
				]]>
	</update>
	    <!-- //특별공제 - 보험료    특별공제 - 보험료  
	    -->
	    
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_04_02_Update">
		<![CDATA[
			  UPDATE YETA3000                                                                        
                 SET                                                                       
               /*  --SPCI_BHTH IS '특별공제_종건강보험료  */                                   
                   SPCI_BHTH = (SELECT SUM(NVL(HLTH_MUAM, 0))                              
                                   FROM (SELECT *                                          
                                           FROM YETA3110                                    
                                          WHERE YETA3110.WTHD_SBYN = '1'                    
                                            AND YETA3110.MANG_GBYN = '1') YETA3110           
                                  WHERE YETA3110.SYSTEMKEY(+) = YETA3000.SYSTEMKEY           
                                    AND YETA3110.EDAC_RVYY(+) = YETA3000.EDAC_RVYY           
                                    AND YETA3110.SETT_GBCD(+) = YETA3000.SETT_GBCD     
                                    AND YETA3110.DPOB_CD(+)  = YETA3000.DPOB_CD          
                                  GROUP BY YETA3000.SYSTEMKEY                               
                                )  ,                                                       
                /*  SPCI_JHTH IS '특별공제_주건강보험료    SPCI_JHTH 전액공제    SPCI_BEPF IS '특별공제_종고용보험료   */                                   
                  SPCI_BEPF =  (SELECT NVL(SUM(UPIS_MUAM), 0)                              
                                   FROM (SELECT *                                          
                                           FROM YETA3110                                    
                                          WHERE YETA3110.WTHD_SBYN = '1'                    
                                            AND YETA3110.MANG_GBYN = '1') YETA3110           
                                  WHERE YETA3110.SYSTEMKEY(+) = YETA3000.SYSTEMKEY           
                                    AND YETA3110.EDAC_RVYY(+) = YETA3000.EDAC_RVYY           
                                    AND YETA3110.SETT_GBCD(+) = YETA3000.SETT_GBCD  
                                    AND YETA3110.DPOB_CD(+)  = YETA3000.DPOB_CD             
                                  GROUP BY YETA3000.SYSTEMKEY                               
                                )  
                     WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#                                                                    
				]]>
	</update>
	   
	  <!--  {공제단계 시작 -특별공제 - 주택임차차임금 상환액  09 } 특별공제 - 주택임차차임금 상환액- 
	   -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_07_Update">
		<![CDATA[
			  UPDATE YETA3000                                                                                                                                                                                              
                         SET                                                                                                                                                                                          
                        /* --SPCI_REFN IS '특별공제)차입금원리금상환액_대출기관    */                                                                                                                                                
                          SPCI_REFN  =  (SELECT CASE WHEN (NVL(YETA2000.SPCI_REFN,0) * 0.4)  > (3000000)                                                                                                               
                                                    THEN 3000000                                                                                                                                                      
                                                    ELSE NVL(YETA2000.SPCI_REFN,0) * 0.4                                                                                                                               
                                                    END                                                                                                                                                               
                                            FROM YETA2000                                                                                                                                                              
                                          WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                                                 
                                            AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                                                 
                                            AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD   
                                            AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                                                               
                                            )  ,                                                                                                                                                                      
                                                                                                                                                                                                                                               
                        /*  --SPCI_RESF IS '특별공제)차입금원리금상환액_거주자  */                                                                                                                                       
                          SPCI_RESF  =  (SELECT CASE WHEN (NVL(YETA2000.SPCI_REFN,0) * 0.4)  > (3000000)                                                                                                               
                                                    THEN 0                                                                                                                                                           
                                                    ELSE                                                                                                                                                        
                                                           (CASE WHEN (NVL(YETA2000.SPCI_RESF,0) * 0.4)  >  (3000000  - (NVL(YETA2000.SPCI_REFN,0) * 0.4) )                                 
                                                             THEN                                                                                                                          
                                                                  3000000  - (NVL(YETA2000.SPCI_REFN,0) * 0.4)                                                                             
                                                             ELSE                                                                                                                          
                                                                  (NVL(YETA2000.SPCI_RESF,0) * 0.4)                                                                                       
                                                             END)                                                                                                                          
                                                    END                                                                                                                                                               
                                            FROM YETA2000                                                                                                                                                              
                                          WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                                                 
                                            AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                                                 
                                            AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD 
                                              AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                                                               
                                            )  ,                                                                                                                                                                      
                             /* --SPCI_TGRT IS '특별공제)_월세세액대상금액 액  */                                                                                                                                            
                               SPCI_TGRT  =  (SELECT (CASE WHEN  NVL(YETA2000.SPCI_HTAM,0) > 7500000 THEN  7500000       
                                                           ELSE  NVL(YETA2000.SPCI_HTAM,0)   END)               
                                            FROM YETA2000                                                 
                                          WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                                                 
                                            AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                                                 
                                            AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD  
                                            AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                                                                
                                            ) ,   
                                 /* --SPCI_RTAM IS '특별공제)_월세세액공제액  */                                                                                                                                            
                               SPCI_RTAM  =  (SELECT (CASE WHEN  ((CASE WHEN  NVL(YETA2000.SPCI_HTAM,0) > 7500000 THEN  7500000       
                                                                       ELSE  NVL(YETA2000.SPCI_HTAM,0)   END) * 0.10) > 750000 THEN  750000       
                                                           ELSE   (CASE WHEN  NVL(YETA2000.SPCI_HTAM,0) > 7500000 THEN  7500000       
                                                                        ELSE  NVL(YETA2000.SPCI_HTAM,0)   END) * 0.10      END)               
                                            FROM YETA2000                                                 
                                          WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                                                 
                                            AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                                                 
                                            AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD  
                                            AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                                                                
                                            )    
                                WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#               
				]]>
	</update>
	 
	   <!-- {공제단계 시작 -특별공제 - 택마련저축  10 } 	 기타공제)주택마련저축 
	   -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_07_1_Update">
		<![CDATA[
			                                                                                                                                   
                    UPDATE YETA3000                                                                                                                                              
                         SET                                                                                                                                       
                        /*  --ETCS_COMP IS '기타공제)청약저 -  */                                                                                                                 
      ETCS_COMP =           (SELECT (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0) ))  < (    
           (CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END)   * 0.4)                                                                                                                                                             
                                                                               THEN                                                                                         
                                        (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  ))               
                               ELSE  ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END)  * 0.4)                                
                              END)                                                                                                                                          
            FROM YETA2000                                                                                                                                                    
          WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                                       
            AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                                       
            AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD  
            AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                                                      
                                                        ) ,                                                                                                                 
                                                                                                                                                                            
    /*  --ETWK_SBAM IS '기타공제)주택청약종합저 축 ETWK_HSBM  */                                                                                                                  
                                                                                                                                                                            
      ETWK_SBAM =              (SELECT (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  )                             
                   -  (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  ))  < ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0)       
               > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END)  * 0.4)                                      
                                                    THEN                                                                                                                    
                                                             (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  ))                     
                                                    ELSE  ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END)  * 0.4)              
                                                   END)                                                                                                                     
         )  < ((CASE WHEN  NVL(YETA2000.ETWK_HSBM,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETWK_HSBM,0) END)  * 0.4)                                                         
                                                    THEN                                                                                                                    
                                   (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  )                                             
                                                     -  (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  ))         
              < ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)    
                                                                                                THEN                                                                        
                                                                                                         (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  ))  
                                                                                                ELSE  ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)  
                                                                                               END)                                                                         
                                                     )                                                                                                                      
                            ELSE  ((CASE WHEN  NVL(YETA2000.ETWK_HSBM,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETWK_HSBM,0) END) * 0.4)                                    
                           END)                                                                                                                                             
         FROM YETA2000                                                                                                                                                       
       WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                                          
         AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                                          
         AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD    
         AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                                                       
     ),                                                                                                                                                                     
                                                                                                                                                                            
    /* --ETWK_LGAM IS '기타공제)장기주택마련저축  ETWK_HLGM    */                                                                                                                      
         ETWK_LGAM =   0,
     /* --ETWK_SVAM IS '기타공제)근로자주택마련 ETWK_HSVM    */                                                                                                                           
                                                                                                                                                                                    
         ETWK_SVAM =    (SELECT (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  )                                                
                                                              -  (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  )) 
                < ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)   
                                                  THEN                                                                                                                              
                                                           (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  ))                              
                                                  ELSE  ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)                       
                                                 END)                                                                                                                               
       -   (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0) )                                                                     
       -  (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  ))  < ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4) 
                                                  THEN                                                                                                                              
                                                           (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  ))                             
                                                  ELSE  ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)                        
                                                 END)                                                                                                                               
            )  < ((CASE WHEN  NVL(YETA2000.ETWK_HSBM,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETWK_HSBM,0) END) * 0.4)                                                              
                                                  THEN                                                                                                                              
               (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  )                                                                          
                                 -  (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  ))   
              < ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)      
                                                                            THEN                                                                                                    
                                                                                     (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  ))   
                                                                            ELSE  ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)   
                                                                           END)                                                                                                     
                                 )                                                                                                                                                  
        ELSE  ((CASE WHEN  NVL(YETA2000.ETWK_HSBM,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETWK_HSBM,0) END) * 0.4)                                                                  
       END)                                                                                                                                                                         
      -  (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0) )                                                                      
       -  (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  ))  < ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)
                                                  THEN                                                                                                                              
                                                           (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  ))                             
                                                  ELSE  ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)                        
                                                 END)                                                                                                                               
       -   (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  )                                                                     
       -  (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0) ))  < ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)
                                                                                          THEN                                                                                      
                                                           (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0) ))                               
                                                  ELSE  ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)                       
                                                 END)                                                                                                                               
            )  < ((CASE WHEN  NVL(YETA2000.ETWK_HSBM,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETWK_HSBM,0) END) * 0.4)                                                             
                                                  THEN                                                                                                                              
                  (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0) )                                                                        
                                    -  (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0) ))  
               < ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)  
                                                                               THEN                                                                                                 
                                                                                        (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  ))  
                                                                               ELSE  ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4) 
                                                                              END)                                                                                                  
                                    )                                                                                                                                               
           ELSE  ((CASE WHEN  NVL(YETA2000.ETWK_HSBM,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETWK_HSBM,0) END) * 0.4)                                                             
                                                  END)                                                                                                                              
       )  < (NVL(YETA2000.ETWK_HLGM,0) * 0.4)                                                                                                                                        
                                                         THEN                                                                                                                       
     (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0) )                                                                                    
      -  (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0) ))  < ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4) 
                                                 THEN                                                                                                                               
                                                          (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0) ))                              
                                                 ELSE  ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)                      
                                                END)                                                                                                                                
      -   (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0) )                                                                     
      -  (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  ))  < ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)
                                                 THEN                                                                                                                               
                                                          (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0) ))                               
                                                 ELSE  ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)                       
                                                END)                                                                                                                                
           )  < ((CASE WHEN  NVL(YETA2000.ETWK_HSBM,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETWK_HSBM,0) END) * 0.4)                                                              
                                                 THEN                                                                                                                               
          (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0) )                                                                              
                            -  (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  ))   
              < ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)                                     
                                                                       THEN                                                                                                         
                                                                                (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  ))   
                                                                       ELSE  ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4) 
                                                                      END)                                                                                                          
                            )                                                                                                                                                       
                                                 ELSE  ((CASE WHEN  NVL(YETA2000.ETWK_HSBM,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETWK_HSBM,0) END) * 0.4)                
                                                END)                                                                                                                                
      )                                                                                                                                                                             
                                                         ELSE  (NVL(YETA2000.ETWK_HLGM,0) * 0.4)                                                                                     
                                                        END)                                                                                                                        
                      )   < ((CASE WHEN  NVL(YETA2000.ETWK_HSVM,0) > 1800000 THEN 1800000 ELSE NVL(YETA2000.ETWK_HSVM,0) END) * 0.4)                                                                                                                        
                                                                 THEN                                                                                                               
               (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  )                                                                                                     
      -  (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  ))  < ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4) 
                                                 THEN                                                                                                                               
                                                          (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  ))                               
                                                 ELSE  ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)                        
                                                END)                                                                                                                                
      -   (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  )                                                                     
      -  (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0) ))  < ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4) 
                                                 THEN                                                                                                                               
                                                          (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  ))                               
                                                 ELSE  ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)                        
                                                END)                                                                                                                                
           )  < ((CASE WHEN  NVL(YETA2000.ETWK_HSBM,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETWK_HSBM,0) END) * 0.4)                                                               
                                                 THEN                                                                                                                               
                                                        (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  )                                                            
                                                                          -  (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  ))  
                < ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)    
                                                                                                                     THEN                                                                        
                                                                                                                              (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  ))  
                                                                                                                     ELSE  ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4) 
                                                                                                                    END)                                                    
                                                                          )                                                                                                 
                                                 ELSE  ((CASE WHEN  NVL(YETA2000.ETWK_HSBM,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETWK_HSBM,0) END) * 0.4)               
                                                END)                                                                                                                        
     -  (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0) )                                                               
      -  (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0) ))  < ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4) 
                                                 THEN                                                                                                                       
                                                          (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0) ))                        
                                                 ELSE  ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)              
                                                END)                                                                                                                        
      -   (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) +  NVL(YETA3000.SPCI_RESF,0)  )                                                            
      -  (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) +  NVL(YETA3000.SPCI_RESF,0)  ))  < ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4) 
                                            THEN                                                                                                                            
                                                     (3000000 - (NVL(YETA3000.SPCI_REFN,0) +  NVL(YETA3000.SPCI_RESF,0) ))                           
                                            ELSE  ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)                     
                                           END)                                                                                                                             
      )  < ((CASE WHEN  NVL(YETA2000.ETWK_HSBM,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETWK_HSBM,0) END) * 0.4)                                                             
                                            THEN                                                                                                                            
                                                   (3000000 - (NVL(YETA3000.SPCI_REFN,0) +  NVL(YETA3000.SPCI_RESF,0)  )                              
                                                                     -  (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0) )) 
                < ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)      
                                                                                                                THEN                                                                          
                                                                                                                         (3000000 - (NVL(YETA3000.SPCI_REFN,0) +  NVL(YETA3000.SPCI_RESF,0)  ))    
                                                                                                                ELSE  ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4) 
                                                                                                               END)                                                          
                                                                     )                                                                                                       
                                            ELSE  ((CASE WHEN  NVL(YETA2000.ETWK_HSBM,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETWK_HSBM,0) END) * 0.4)                       
                                           END)                                                                                                                              
                 )  < (NVL(YETA2000.ETWK_HLGM,0) * 0.4)                                                                                                                       
            THEN                                                                                                                                                             
                    (3000000 - (NVL(YETA3000.SPCI_REFN,0) +  NVL(YETA3000.SPCI_RESF,0) )                                                                                         
                     -  (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) +  NVL(YETA3000.SPCI_RESF,0) ))  
               < ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)
                                                                THEN                                                                                                         
                                                                         (3000000 - (NVL(YETA3000.SPCI_REFN,0) +  NVL(YETA3000.SPCI_RESF,0)  ))                                   
                                                                ELSE  ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)                              
                                                               END)                                                                                                          
                     -   (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0) )                                                                         
                     -  (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) +  NVL(YETA3000.SPCI_RESF,0)  ))  
               < ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)                                     
                                                                THEN                                                                                                         
                                                                         (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0) ))                                   
                                                                ELSE  ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)     
                                                               END)                                                                                                          
                          )  < ((CASE WHEN  NVL(YETA2000.ETWK_HSBM,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETWK_HSBM,0) END) * 0.4)                                            
        THEN                                                                                                                                                                 
               (3000000 - (NVL(YETA3000.SPCI_REFN,0) +  NVL(YETA3000.SPCI_RESF,0) )                                                                     
                                 -  (CASE WHEN (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0)  )) 
                < ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)                         
                                                                            THEN                                                                                             
                                                                                     (3000000 - (NVL(YETA3000.SPCI_REFN,0) + NVL(YETA3000.SPCI_RESF,0) ))   
                                                                            ELSE  ((CASE WHEN  NVL(YETA2000.ETCS_COMP,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETCS_COMP,0) END) * 0.4)   
                                                                           END)                                                                                              
                                 )                                                                                                                                           
        ELSE  ((CASE WHEN  NVL(YETA2000.ETWK_HSBM,0) > 2400000 THEN 2400000 ELSE NVL(YETA2000.ETWK_HSBM,0) END) * 0.4)                                                          
       END)                                                                                                                                                                  
                     )                                                                                                                                                       
            ELSE  (NVL(YETA2000.ETWK_HLGM,0) * 0.4)                                                                                                                           
           END)                                                                                                                                                              
                      )                                                                                                                                                      
                                                                 ELSE  ((CASE WHEN  NVL(YETA2000.ETWK_HSVM,0) > 1800000 THEN 1800000 ELSE NVL(YETA2000.ETWK_HSVM,0) END) * 0.4)                                                                       
                                                                END)                                                                                                         
                                              FROM YETA2000                                                                                                                   
                                            WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                      
                                              AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                      
                                              AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD    
                                              AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                   
                                          )       
                  WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#                                                                                                                                                                                         
                           
				]]>
	</update>
	 
	   <!-- {공제단계 시작 -특별공제 - 택마련저축 합계  10-1 }  기타공제)주택마련저축 
	   -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_07_3_Update">
		<![CDATA[
			    UPDATE YETA3000                                                                                                                                              
                    SET                                                                                                                                       
       /*  --ETWK_BDAM IS '기타공제)주택마련저축 계-       */                                                                                                                      
    			 ETWK_BDAM =  (YETA3000.ETCS_COMP + YETA3000.ETWK_SBAM + YETA3000.ETWK_LGAM + YETA3000.ETWK_SVAM)                                                       
           WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#   
				]]>
	</update>
	   
	   <!-- {공제단계 시작 -특별공제 - 장기주택이자상환액  10-2 } 특별공제 -장기주택이자상환액  
	    -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_07_2_Update">
		<![CDATA[
			 UPDATE YETA3000                                                                                                                                                                                      
                  SET                                                                                                                                                                                  
                    /* --SPCH_RE15 IS '특별공제)장기주택이자상환액  - WKER_AMNT    */                                                                                                                      
                          SPCH_RE15 = (SELECT CASE WHEN NVL(YETA2000.SPCH_RE06, 0)  > 0 THEN  
                                               (CASE WHEN NVL(YETA2000.SPCH_RE06, 0)  > 0 AND NVL(YETA2000.SPCH_RE10, 0) = 0 AND  NVL(YETA2000.SPCH_RE20, 0) = 0                                                                        
                                              THEN                                                                                                                                                     
                                                     CASE WHEN NVL(YETA2000.SPCH_RE06, 0)  >                                                                                                                    
                                                                6000000 - (YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN +  NVL(YETA3000.SPCI_RESF,0)  )                                      
                                                          THEN                                                                                                                                         
                                                                6000000 - (YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN + NVL(YETA3000.SPCI_RESF,0)  )                                      
                                                            ELSE                                                                                                                                       
                                                                 NVL(YETA2000.SPCH_RE06, 0)                                                                                                                     
                                                           END                                                                                                                                         
                                             ELSE                                                                                                                                                      
                                                  CASE WHEN NVL(YETA2000.SPCH_RE20, 0) > 0                                                                                                                      
                                                         THEN                                                                                                                                          
                                                              CASE WHEN  NVL(YETA2000.SPCH_RE06, 0)  > 15000000 - (YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN +  NVL(YETA3000.SPCI_RESF,0)  )       
                                                                    THEN                                                                                                                               
                                                                          15000000 - (YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN +  NVL(YETA3000.SPCI_RESF,0) )                           
                                                                   ELSE                                                                                                                                
                                                                        NVL(YETA2000.SPCH_RE06, 0)                                                                                                              
                                                                  END                                                                                                                                  
                                                         ELSE                                                                                                                                          
                                                               CASE WHEN  NVL(YETA2000.SPCH_RE06, 0)  > 10000000 - (YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN +  NVL(YETA3000.SPCI_RESF,0)  )      
                                                                     THEN                                                                                                                              
                                                                           10000000 - (YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN +  NVL(YETA3000.SPCI_RESF,0)  )                          
                                                                    ELSE                                                                                                                               
                                                                        NVL(YETA2000.SPCH_RE06, 0)                                                                                                              
                                                                   END                                                                                                                                 
                                                          END                                                                                                                                          
                                              END )
                                              ELSE 0 END                                                                                                                                                      
                                               FROM YETA2000                                                                                                                                            
                                              WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                              
                                               AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                               
                                               AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD 
                                               AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD  )   ,                                                                                                          
                    SPCH_RE29 =  (SELECT    CASE WHEN NVL(YETA2000.SPCH_RE10, 0)  > 0 THEN  
                                               (CASE WHEN NVL(YETA2000.SPCH_RE10, 0) > 0 AND  NVL(YETA2000.SPCH_RE20, 0) = 0                                                                                                   
                                              THEN                                                                                                                                                     
                                                   CASE WHEN   NVL(YETA2000.SPCH_RE10, 0)  >                                                                                                                    
                                                         10000000   - (YETA3000.SPCH_RE15 + YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN +  NVL(YETA3000.SPCI_RESF,0)  )                      
                                                    THEN                                                                                                                                               
                                                        10000000   - (YETA3000.SPCH_RE15 + YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN + NVL(YETA3000.SPCI_RESF,0) )                       
                                                   ELSE                                                                                                                                                
                                                       NVL(SPCH_RE10, 0)                                                                                                                               
                                                 END                                                                                                                                                   
                                              ELSE                                                                                                                                                     
                                                    CASE WHEN   NVL(YETA2000.SPCH_RE10, 0)  >                                                                                                                   
                                                         15000000   - (YETA3000.SPCH_RE15 + YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN +  NVL(YETA3000.SPCI_RESF,0) )                      
                                                   THEN                                                                                                                                                
                                                        15000000   - (YETA3000.SPCH_RE15 + YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN + NVL(YETA3000.SPCI_RESF,0)  )                       
                                                  ELSE                                                                                                                                                 
                                                      NVL(YETA2000.SPCH_RE10, 0)                                                                                                                                
                                                   END                                                                                                                                                 
                                               END   )
                                              ELSE 0 END                                                                                                                                                       
                                             FROM YETA2000                                                                                                                                              
                                           WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                                 
                                             AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                                 
                                            AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD
                                            AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD   ) 
                              WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#                 
                                             
				]]>
	</update>
	  
	   
	
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_07_4_Update">
		<![CDATA[
			  UPDATE YETA3000                                                                                                                                                                                      
                  SET                                                                                                                                                                                  
                 SPCH_RE30 =  (SELECT  CASE WHEN NVL(YETA2000.SPCH_RE20, 0)  > 0 THEN  
                                               ( CASE WHEN NVL(YETA2000.SPCH_RE20, 0)  >                                                                                                                                  
                                                    15000000  - (YETA3000.SPCH_RE29 +  YETA3000.SPCH_RE15 + YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN +  NVL(YETA3000.SPCI_RESF,0) )       
                                                   THEN                                                                                                                                                
                                                      15000000  - (YETA3000.SPCH_RE29 +  YETA3000.SPCH_RE15 + YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN +  NVL(YETA3000.SPCI_RESF,0)  )     
                                                  ELSE                                                                                                                                                 
                                                    NVL(YETA2000.SPCH_RE20, 0)                                                                                                                                  
                                                 END  )
                                              ELSE 0 END                                                                                                                                                    
                                          FROM YETA2000                                                                                                                                                 
                                              WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                              
                                                 AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                             
                                                 AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD 
                                                 AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD )   
                  WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#    
				]]>
	</update>
	 
	      <!--  {공제단계 시작 -특별공제 - 장기주택이자상환액 고정금리 비거치  10-3 }
    //장기주택저장차입금. 추가사항 반영
  특별공제 -장기주택이자상환액 고정금리 비거치 
  -->
	  <!-- {공제단계 시작 -특별공제 - 장기주택이자상환액 기타 대출  10-4 }
 //장기주택저장차입금. 추가사항 반영 특별공제 -장기주택이자상환액 기타 대출  
  -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_07_5_Update">
		<![CDATA[
			  UPDATE YETA3000                                                                                                                                                                                      
                SET                                                                                                                                                                                  

                SPCI_REFX = (SELECT CASE WHEN NVL(YETA2000.SPCH_REFX, 0)  > 0 THEN  
                                               ( CASE WHEN   NVL(YETA2000.SPCH_REFX, 0)  >                                                                                                                                  
                                                   15000000  - (YETA3000.SPCH_RE30 + YETA3000.SPCH_RE29 +  YETA3000.SPCH_RE15 + YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN +  NVL(YETA3000.SPCI_RESF,0)  )       
                                                  THEN                                                                                                                                                
                                                    15000000  - (YETA3000.SPCH_RE30 + YETA3000.SPCH_RE29 + YETA3000.SPCH_RE15 +YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN + NVL(YETA3000.SPCI_RESF,0)  )        
                                                 ELSE                                                                                                                                                 
                                                   NVL(YETA2000.SPCH_REFX, 0)                                                                                                                                  
                                                END   )
                                              ELSE 0 END                                                                                                                                                   
                                         FROM YETA2000                                                                                                                                                 
                                             WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                              
                                                AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                             
                                                AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD 
                                                AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD)    ,                                                                                                      


                SPCI_REEC = (SELECT CASE WHEN NVL(YETA2000.SPCH_REEC, 0)  > 0 THEN  
                                               (CASE WHEN   NVL(YETA2000.SPCH_REEC, 0)  >                                                                                                                                  
                                                   5000000  - (YETA3000.SPCH_RE30 + YETA3000.SPCH_RE29 +  YETA3000.SPCH_RE15 + YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN +  NVL(YETA3000.SPCI_RESF,0) )       
                                                  THEN                                                                                                                                                
                                                     (CASE WHEN 5000000  - (YETA3000.SPCH_RE30 + YETA3000.SPCH_RE29 + YETA3000.SPCH_RE15 +YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN + NVL(YETA3000.SPCI_RESF,0) )   < 0 
               THEN 0 ELSE  5000000  - (YETA3000.SPCH_RE30 + YETA3000.SPCH_RE29 + YETA3000.SPCH_RE15 +YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN + NVL(YETA3000.SPCI_RESF,0)  )   END)        
                                                 ELSE                                                                                                                                                 
                                                   NVL(YETA2000.SPCH_REEC, 0)                                                                                                                                  
                                                END   )
                                              ELSE 0 END                                                                                                                                                  
                                         FROM YETA2000                                                                                                                                                 
                                             WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                              
                                                AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                             
                                                AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD
                                                AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD )                                                                                                         
			 WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#    
				]]>
	</update>
	 
	  <!-- {공제단계 시작 -특별공제 - 장기주택이자상환액 2015년이후 고정금리이면서 비거치상환 대출 15  10-4_1 }
 //장기주택저장차입금. 추가사항 반영 특별공제 -장기주택이자상환액  
          2015년이후 15년이상 고정금이거나비거치상환 대출 104-2
          2015년이상 기타대출 10-4-3
          2015년 이후 10년 ~ 15년 고정금리이거나 비거치 상환 대출 
  -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_07_5_1_Update">
		<![CDATA[
			  UPDATE YETA3000                                                                                                                                                                                      
                SET                                                                                                                                                                                  
                  SPCI_15FX = (SELECT CASE WHEN NVL(YETA2000.SPCH_15FX, 0)  > 0 THEN  
                                               (CASE WHEN   NVL(YETA2000.SPCH_15FX, 0)  >                                                                                                                                  
                                                   18000000  - (YETA3000.SPCI_REFX + YETA3000.SPCI_REEC + YETA3000.SPCH_RE30 + YETA3000.SPCH_RE29
                                                             +  YETA3000.SPCH_RE15 + YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN +  NVL(YETA3000.SPCI_RESF,0)  )       
                                                  THEN                                                                                                                                                
                                                    18000000  - (YETA3000.SPCI_REFX + YETA3000.SPCI_REEC + YETA3000.SPCH_RE30 + YETA3000.SPCH_RE29 
                                                              + YETA3000.SPCH_RE15 +YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN + NVL(YETA3000.SPCI_RESF,0)  )        
                                                 ELSE                                                                                                                                                 
                                                   NVL(YETA2000.SPCH_15FX, 0)                                                                                                                                  
                                                END    )
                                              ELSE 0 END                                                                                                                                                     
                                         FROM YETA2000                                                                                                                                                 
                                             WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                              
                                                AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                             
                                                AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD 
                                                AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD)     ,  
                 SPCI_15FB = (SELECT  CASE WHEN NVL(YETA2000.SPCH_15FB, 0)  > 0 THEN  
                                               (CASE WHEN   NVL(YETA2000.SPCH_15FB, 0)  >                                                                                                                                  
                                                   15000000  - (YETA3000.SPCI_REFX + YETA3000.SPCI_REEC + YETA3000.SPCH_RE30 + YETA3000.SPCH_RE29
                                                             +  YETA3000.SPCH_RE15 + YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN +  NVL(YETA3000.SPCI_RESF,0)  )       
                                                  THEN                                                                                                                                                
                                                    15000000  - (YETA3000.SPCI_REFX + YETA3000.SPCI_REEC + YETA3000.SPCH_RE30 + YETA3000.SPCH_RE29 
                                                              + YETA3000.SPCH_RE15 +YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN + NVL(YETA3000.SPCI_RESF,0)  )        
                                                 ELSE                                                                                                                                                 
                                                   NVL(YETA2000.SPCH_15FB, 0)                                                                                                                                  
                                                END    )
                                              ELSE 0 END                                                                                                                                                     
                                         FROM YETA2000                                                                                                                                                 
                                             WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                              
                                                AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                             
                                                AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD 
                                                AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD)     ,     
                SPCI_15EC = (SELECT CASE WHEN NVL(YETA2000.SPCH_15EC, 0)  > 0 THEN  
                                               (CASE WHEN   NVL(YETA2000.SPCH_15EC, 0)  >                                                                                                                                  
                                                    5000000  - (YETA3000.SPCI_REFX + YETA3000.SPCI_REEC + YETA3000.SPCH_RE30 + YETA3000.SPCH_RE29
                                                             +  YETA3000.SPCH_RE15 + YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN +  NVL(YETA3000.SPCI_RESF,0)  )       
                                                  THEN                                                                                                                                                
                                                     5000000  - (YETA3000.SPCI_REFX + YETA3000.SPCI_REEC + YETA3000.SPCH_RE30 + YETA3000.SPCH_RE29 
                                                              + YETA3000.SPCH_RE15 +YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN + NVL(YETA3000.SPCI_RESF,0)  )        
                                                 ELSE                                                                                                                                                 
                                                   NVL(YETA2000.SPCH_15EC, 0)                                                                                                                                  
                                                END     )
                                              ELSE 0 END                                                                                                                                                   
                                         FROM YETA2000                                                                                                                                                 
                                             WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                              
                                                AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                             
                                                AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD 
                                                AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD)     ,                                                                        
                SPCI_10FB = (SELECT CASE WHEN NVL(YETA2000.SPCH_10FB, 0)  > 0 THEN  
                                               (CASE WHEN   NVL(YETA2000.SPCH_10FB, 0)  >                                                                                                                                  
                                                    3000000  - (YETA3000.SPCI_REFX + YETA3000.SPCI_REEC + YETA3000.SPCH_RE30 + YETA3000.SPCH_RE29
                                                             +  YETA3000.SPCH_RE15 + YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN +  NVL(YETA3000.SPCI_RESF,0)  )       
                                                  THEN                                                                                                                                                
                                                     3000000  - (YETA3000.SPCI_REFX + YETA3000.SPCI_REEC + YETA3000.SPCH_RE30 + YETA3000.SPCH_RE29 
                                                              + YETA3000.SPCH_RE15 +YETA3000.ETWK_BDAM + YETA3000.SPCI_REFN + NVL(YETA3000.SPCI_RESF,0)  )        
                                                 ELSE                                                                                                                                                 
                                                   NVL(YETA2000.SPCH_10FB, 0)                                                                                                                                  
                                                END    )
                                              ELSE 0 END                                                                                                                                                    
                                         FROM YETA2000                                                                                                                                                 
                                             WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                              
                                                AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                             
                                                AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD 
                                                AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD)                                                                                                                                    
			 WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#    
				]]>
	</update>
	   <!-- 기타소득공제 - 전체 TODO 투자조합 출자 부분 수정 해야 할듯 	   -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_11_Update">
		<![CDATA[
			  UPDATE YETA3000                                                                                                           
                           SET                                                                                                       
                           /* --ETCP_PSNV IS '기타공제)개인연금저축불입액_2000년이전  */                                                   
                           ETCP_PSNV = (SELECT CASE WHEN (NVL(YETA2000.PRVM_20BE,0) * 0.4)  > (720000)                                
                                                      THEN 720000                                                                    
                                                      ELSE NVL(YETA2000.PRVM_20BE,0) * 0.4                                            
                                                      END                                                                            
                                              FROM YETA2000                                                                           
                                            WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                              
                                              AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                              
                                              AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD      
                                              AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                        
                                              ) ,                                                                                    
                          /*  --ETCP_NSAV IS '기타공제)연금저축_2000년이후  */                                                             
                          ETCP_NSAV = 0,
                          /*  --ETCH_PREP IS '기타공제)소기업공제부금   */                                                                                                  
                           ETCH_PREP = (SELECT CASE WHEN NVL(YETA2000.ETCH_PREP,0)  > (3000000)                                                                                
                                                      THEN 3000000                                                                                                    
                                                      ELSE YETA2000.ETCH_PREP                                                                                          
                                                      END                                                                                                             
                                              FROM YETA2000                                                                                                            
                                            WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                               
                                              AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                               
                                              AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD       
                                              AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                        
                                              ) ,                                                                                                                     
                             /*  --ETGD_09AF IS '기타공제_투자조합출자금액(2007년~2008년)  */                                                                               
                            ETGD_09AF = 0 ,
                            /* (SELECT CASE WHEN NVL(YETA2000.ETGD_H09F,0)  < (NVL(YETA3000.WKER_AMNT,0) * 0.4)                                         
                                                              THEN NVL(YETA2000.ETGD_H09F,0)                                                                   
                                                              ELSE CASE WHEN NVL(YETA2000.ETGD_H09F,0) <= 0 THEN 0 ELSE (NVL(YETA3000.WKER_AMNT,0) * 0.4)  END          
                                                              END                                                                                                     
                                                      FROM YETA2000                                                                                                    
                                                      WHERE YETA2000.SYSTEMKEY= YETA3000.SYSTEMKEY                                                                      
                                              AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                               
                                              AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD   
                                              AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                            
                                                    ) ,       */                                                                                                        
                          /* --ETGD_H13H IS '기타공제_투자조합출자금액(2013년 이전)  */   

                            ETGD_H13H =  (SELECT (CASE WHEN NVL(YETA2000.ETGD_H13F,0) < ((NVL(YETA3000.WKER_AMNT,0) * 0.4) -                                                                      
                                                                           (CASE WHEN NVL(YETA2000.ETGD_H09F,0) < (NVL(YETA3000.WKER_AMNT,0) * 0.4)                         
                                                                                 THEN NVL(YETA2000.ETGD_H09F,0)                                                             
                                                                                 ELSE CASE WHEN NVL(YETA2000.ETGD_H09F,0) <= 0 THEN 0 ELSE (NVL(YETA3000.WKER_AMNT,0) * 0.4)  END   
                                                                                 END))                                                                                            
                                          THEN NVL(YETA2000.ETGD_H13F,0)                                                                                                   
                                          ELSE CASE WHEN NVL(YETA2000.ETGD_H13F,0) <= 0                                                                                            
                                                    THEN 0                                                                                                                         
                                                    ELSE  ((NVL(YETA3000.WKER_AMNT,0) * 0.4) -                                                                                     
                                                                           (CASE WHEN NVL(YETA2000.ETGD_H09F,0) < (NVL(YETA3000.WKER_AMNT,0) * 0.4)                         
                                                                                 THEN NVL(YETA2000.ETGD_H09F,0)                                                            
                                                                                ELSE CASE WHEN NVL(YETA2000.ETGD_H09F,0) <= 0 THEN 0 ELSE (NVL(YETA3000.WKER_AMNT,0) * 0.4)  END    
                                                                                 END))                                                                                            
                                                   END                                                                                                                             
                                         END)                                                                                                                                       
                                                      FROM YETA2000                                                                                                    
                                                      WHERE YETA2000.SYSTEMKEY= YETA3000.SYSTEMKEY                                                                      
                                              AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                               
                                              AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD  
                                              AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                             

                                    ) ,                                                                                                               

                          /*  --ETGD_D14F IS '기타공제_투자조합출자금액(2014년 이후)  */                                                                                     


       ETGD_D14F =  (SELECT (CASE WHEN NVL(YETA2000.ETGD_H14F,0) <  (NVL(YETA3000.WKER_AMNT,0) * 0.5) - ((CASE WHEN NVL(YETA2000.ETGD_H13F,0) < ((NVL(YETA3000.WKER_AMNT,0) * 0.4) -   
                                                                           (CASE WHEN NVL(YETA2000.ETGD_H09F,0) < (NVL(YETA3000.WKER_AMNT,0) * 0.4)                         
                                                                                 THEN NVL(YETA2000.ETGD_H09F,0)                                                             
                                                                                 ELSE CASE WHEN NVL(YETA2000.ETGD_H09F,0) <= 0 THEN 0 ELSE (NVL(YETA3000.WKER_AMNT,0) * 0.4)  END   
                                                                                 END))                                                                                            
                                          THEN NVL(YETA2000.ETGD_H13F,0)                                                                                                   
                                          ELSE CASE WHEN NVL(YETA2000.ETGD_H13F,0) <= 0                                                                                            
                                                    THEN 0                                                                                                                         
                                                    ELSE  ((NVL(YETA3000.WKER_AMNT,0) * 0.4) -                                                                                     
                                                                           (CASE WHEN NVL(YETA2000.ETGD_H09F,0) < (NVL(YETA3000.WKER_AMNT,0) * 0.4)                         
                                                                                 THEN NVL(YETA2000.ETGD_H09F,0)                                                            
                                                                                ELSE CASE WHEN NVL(YETA2000.ETGD_H09F,0) <= 0 THEN 0 ELSE (NVL(YETA3000.WKER_AMNT,0) * 0.4)  END    
                                                                                 END))                                                                                            
                                                   END                                                                                                                             
                                         END) )                                                                                            
                              THEN NVL(YETA2000.ETGD_H14F,0)                                                                                                    
                              ELSE CASE WHEN NVL(YETA2000.ETGD_H14F,0) <= 0                                                                                            
                                                    THEN 0                                                                                                                         
                                                    ELSE  (NVL(YETA3000.WKER_AMNT,0) * 0.5) - ( (CASE WHEN NVL(YETA2000.ETGD_H13F,0) < ((NVL(YETA3000.WKER_AMNT,0) * 0.4) -            
                                                                           (CASE WHEN NVL(YETA2000.ETGD_H09F,0) < (NVL(YETA3000.WKER_AMNT,0) * 0.4)                         
                                                                                 THEN NVL(YETA2000.ETGD_H09F,0)                                                             
                                                                                 ELSE CASE WHEN NVL(YETA2000.ETGD_H09F,0) <= 0 THEN 0 ELSE (NVL(YETA3000.WKER_AMNT,0) * 0.4)  END   
                                                                                 END))                                                                                            
                                          THEN NVL(YETA2000.ETGD_H13F,0)                                                                                                   
                                          ELSE CASE WHEN NVL(YETA2000.ETGD_H13F,0) <= 0                                                                                            
                                                    THEN 0                                                                                                                         
                                                    ELSE  ((NVL(YETA3000.WKER_AMNT,0) * 0.4) -                                                                                     
                                                                           (CASE WHEN NVL(YETA2000.ETGD_H09F,0) < (NVL(YETA3000.WKER_AMNT,0) * 0.4)                         
                                                                                 THEN NVL(YETA2000.ETGD_H09F,0)                                                            
                                                                                ELSE CASE WHEN NVL(YETA2000.ETGD_H09F,0) <= 0 THEN 0 ELSE (NVL(YETA3000.WKER_AMNT,0) * 0.4)  END    
                                                                                 END))                                                                                            
                                                                                      END                                                                                          
                                                                                  END)   )                                                                                            
                                                   END                                                                                                                             
                              END)                                                                                                                                       
                                                      FROM YETA2000                                                                                                    
                                                      WHERE YETA2000.SYSTEMKEY= YETA3000.SYSTEMKEY                                                                      
                                              AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                               
                                              AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD    
                                              AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                           

                                   ) 
                      WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#                                       
				]]>
	</update>
	  
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_11_1_Update">
		<![CDATA[
		  UPDATE YETA3000                                                                                                           
               SET      
               
         /* 2015년도 이후 출자금액 기타공제_투자조합출자금액_2015년이후 */
         
         ETGD_D15F	 = (
                SELECT CASE WHEN NVL(YETA2000.ETCL_H15F,0)  < ((NVL(YETA3000.WKER_AMNT,0) * 0.5) - (ETGD_09AF + ETGD_H13H + ETGD_D14F))                                      
                                                              THEN NVL(YETA2000.ETCL_H15F,0)                                                                   
                                                              ELSE CASE WHEN ((NVL(YETA3000.WKER_AMNT,0) * 0.5) - (ETGD_09AF + ETGD_H13H + ETGD_D14F)) <= 0 
                                                                 THEN 0 ELSE ((NVL(YETA3000.WKER_AMNT,0) * 0.5) - (ETGD_09AF + ETGD_H13H + ETGD_D14F))  END          
                                                              END                                                                                                     
                                                      FROM YETA2000                                                                                                    
                                                      WHERE YETA2000.SYSTEMKEY= YETA3000.SYSTEMKEY                                                                      
                                              AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                               
                                              AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD   
                                              AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD 
                       ), 
                                                                                                                
      /*  --ETCC_CARD IS '기타공제)신용카드등  ETCT_CARD //카드  ETCH_UEAM  현금영수증   ETCH_BCED 대중교통   ETCH_BCBS 직불카드  ETCH_MGVD 전통시장  */                                                                                        
ETCC_CARD = (TRUNC((SELECT (CASE WHEN NVL(YETA2000.ETCH_BCUE,0) >= (YETA3000.TOTL_SALA * 0.25)                                                                      
             THEN                                                                                                                                                           
                 (CASE WHEN                                                                                                                                                 
                               (CASE WHEN                                                                                                                                   
                                          (YETA3000.TOTL_SALA * 0.20)  > 3000000                                                                                             
                                THEN                                                                                                                                        
                                              CASE WHEN  3000000                                                                                                                 
                                                          >=  (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )  
                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )                                                                                      
                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                 ))                                                                                                         
                                                    THEN                                                                                                                    
                                                         (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )  
                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )                                                                                      
                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                 ))                                                                                                          
                                                    ELSE                                                                                                                    
                                                               3000000                                                                                                      
                                                    END                                                                                                                     
                                ELSE                                                                                                                                        
                                              CASE WHEN  (YETA3000.TOTL_SALA * 0.20)                                                                                         
                                                           >=  (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )  
                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )                                                                                      
                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                 ))                                                                                                         
                                                     THEN                                                                                                                   
                                                           (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )  
                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )                                                                                      
                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                 ))                                                                                                          
                                                     ELSE                                                                                                                   
                                                          (YETA3000.TOTL_SALA * 0.20)                                                                                        
                                                     END                                                                                                                    
                                END) > 0                                                                                                                                    
                 THEN                                                                                                                                                       
                          (CASE WHEN                                                                                                                                   
                                          (YETA3000.TOTL_SALA * 0.20)  > 3000000                                                                                             
                                THEN                                                                                                                                        
                                              CASE WHEN  3000000                                                                                                                 
                                                          >=  (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )  
                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )                                                                                      
                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                 ))                                                                                                         
                                                    THEN                                                                                                                    
                                                         (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )  
                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )                                                                                      
                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                 ))                                                                                                          
                                                    ELSE                                                                                                                    
                                                               3000000                                                                                                      
                                                    END                                                                                                                     
                                ELSE                                                                                                                                        
                                              CASE WHEN  (YETA3000.TOTL_SALA * 0.20)                                                                                         
                                                           >=  (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )  
                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )                                                                                      
                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                 ))                                                                                                         
                                                     THEN                                                                                                                   
                                                           (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )  
                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )                                                                                      
                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                 ))                                                                                                          
                                                     ELSE                                                                                                                   
                                                          (YETA3000.TOTL_SALA * 0.20)                                                                                        
                                                     END                                                                                                                    
                                END)                                                                                                                                       
             ELSE   0                                                                                                                                                       
                                                                                                                                                                            
             END)                                                                                                                                                           
              + ((CASE WHEN  (    (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )  
                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )                                                                                      
                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                 ))                                                                                                                                   
                                  - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000                                                                                        
                                         THEN 3000000                                                                                                                       
                                         ELSE (YETA3000.TOTL_SALA * 0.20) END )) > 0                                                                                         
                       THEN                                                                                                                                                 
                            (CASE WHEN (NVL(ETCH_MGVD,0) * 0.3)                                                                                                             
                                        > ( (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )  
                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )                                                                                      
                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                 ))                                                                                                                       
                                              - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000                                                                            
                                                     THEN 3000000                                                                                                           
                                                     ELSE (YETA3000.TOTL_SALA * 0.20) END ))                                                                                 
                                 THEN                                                                                                                                       
                                     (CASE WHEN ( (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )  
                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )                                                                                      
                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                 ))                                                                                                                     
                                                      - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000                                                                    
                                                             THEN 3000000                                                                                                   
                                                             ELSE (YETA3000.TOTL_SALA * 0.20) END ))                                                                         
                                                 > 1000000                                                                                                                  
                                           THEN  1000000                                                                                                                    
                                           ELSE                                                                                                                             
                                             ( (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )  
                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )                                                                                      
                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                 ))                                                                                                                    
                                              - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000                                                                            
                                                     THEN 3000000                                                                                                           
                                                     ELSE (YETA3000.TOTL_SALA * 0.20) END ))                                                                                 
                                           END)                                                                                                                             
                                 ELSE                                                                                                                                       
                                     (CASE WHEN (NVL(ETCH_MGVD,0) * 0.3) > 1000000                                                                                          
                                           THEN  1000000                                                                                                                    
                                           ELSE  (NVL(ETCH_MGVD,0) * 0.3) END)                                                                                              
                                 END)                                                                                                                                       
                                                                                                                                                                            
                       ELSE 0                                                                                                                                               
                       END                                                                                                                                                  
                                                                                                                                                                            
                  )                                                                                                                                                 
              + (                                                                                                                                                                        
                 CASE WHEN  (    (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )  
                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )                                                                                      
                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                 ))                                                        
                                - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000  THEN 3000000   ELSE (YETA3000.TOTL_SALA * 0.20) END )                                      
                                - (CASE WHEN  (   (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0)   +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)   
                                                                       + (                                                                                                  
                                                                                             CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      ((NVL(ETAD_D14L,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)               
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )                                                                   
                                                 - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                                   
                                                         THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                                                           
                                                         ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                                      
                                                              + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END   ))                                           
                                            - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000  THEN 3000000  ELSE (YETA3000.TOTL_SALA * 0.20) END )) > 0                       
                                 THEN  (CASE WHEN (NVL(ETCH_MGVD,0) * 0.3)                                                                                                     
                                                  > ( (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )  
                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )                                                                                      
                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                 ))                                 
                                                        - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000    THEN 3000000                                                  
                                                               ELSE (YETA3000.TOTL_SALA * 0.20) END ))    THEN                                                               
                                               (CASE WHEN ( (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )  
                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )                                                                                      
                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                 ))                                                                                                                                  
                                                                - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000                                                                                
                                                                       THEN 3000000                                                                                                               
                                                                       ELSE (YETA3000.TOTL_SALA * 0.20) END ))                                                                                     
                                                           > 1000000    THEN  1000000    ELSE                                                                               
                                                       ( (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )  
                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                  THEN                                                                      
                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                  ELSE 0                                                                    
                                                                                                  END   )                                                                                      
                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                 ))                                                                                                                                    
                                                        - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000     THEN 3000000                                                 
                                                               ELSE (YETA3000.TOTL_SALA * 0.20) END ))                                                                       
                                                     END)  ELSE  (CASE WHEN (NVL(ETCH_MGVD,0) * 0.3) > 1000000  THEN  1000000                                               
                                                     ELSE  (NVL(ETCH_MGVD,0) * 0.3) END)                                                                                    
                                           END)   ELSE 0  END  )) > 0   
                                THEN                                                                                                 
                                          (CASE WHEN (NVL(ETCH_BCED,0) * 0.3)                                                                                                                          
                                                      > ( (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )  
                                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )                                                                                      
                                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                                 ))                                              
                                                            - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000    THEN 3000000                                                              
                                                                   ELSE (YETA3000.TOTL_SALA * 0.20) END )                                                                                    
                                                                    - (CASE WHEN  (    (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )  
                                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )                                                                                      
                                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                                 ))                                                                                                                                
                                                            - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000                                                                                                      
                                                                   THEN 3000000                                                                                                                                   
                                                                   ELSE (YETA3000.TOTL_SALA * 0.20) END )) > 0   THEN                                                                        
                                                      (CASE WHEN (NVL(ETCH_MGVD,0) * 0.3)                                                                                                                          
                                                                  > ( (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )  
                                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )                                                                                      
                                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                                 ))                                 
                                                                        - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000                                                                                         
                                                                               THEN 3000000                                                                                                                        
                                                                               ELSE (YETA3000.TOTL_SALA * 0.20) END ))  THEN                                                                 
                                                               (CASE WHEN ( (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )  
                                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )                                                                                      
                                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                                 ))                                                                                                                               
                                                                                - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000                                                                                
                                                                                       THEN 3000000                                                                                                               
                                                                                       ELSE (YETA3000.TOTL_SALA * 0.20) END ))                                                                                     
                                                                           > 1000000                                                                                                                               
                                                                     THEN  1000000                                                                                                                                
                                                                     ELSE                                                                                                                                          
                                                                       ( (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )  
                                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )                                                                                      
                                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                                 ))                                                                                                                                       
                                                                        - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000  THEN 3000000                                                    
                                                                               ELSE (YETA3000.TOTL_SALA * 0.20) END ))     END)   ELSE                                                       
                                                               (CASE WHEN (NVL(ETCH_MGVD,0) * 0.3) > 1000000   THEN  1000000                                                                
                                                                     ELSE  (NVL(ETCH_MGVD,0) * 0.3) END)  END)  ELSE 0   END   ))   
                                          THEN                                                    
                                                   (CASE WHEN ( (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )  
                                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )                                                                                      
                                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                                 ))                                                                                                                            
                                                                    - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000                                                                                
                                                                           THEN 3000000                                                                                                               
                                                                           ELSE (YETA3000.TOTL_SALA * 0.20) END )                                                                            
                                                                            - (CASE WHEN  (    (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )  
                                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )                                                                                      
                                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                                 ))                                         
                                                            - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000  THEN 3000000                                                                
                                                                   ELSE (YETA3000.TOTL_SALA * 0.20) END )) > 0    THEN                                                                       
                                                      (CASE WHEN (NVL(ETCH_MGVD,0) * 0.3)                                                                                                                          
                                                                  > ( (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )  
                                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )                                                                                      
                                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                                 ))                                                                                                                                      
                                                                        - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000                                                                                         
                                                                               THEN 3000000                                                                                                                        
                                                                               ELSE (YETA3000.TOTL_SALA * 0.20) END ))                                                                                               
                                                           THEN                                                                                                                                                    
                                                               (CASE WHEN ( (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )  
                                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )                                                                                      
                                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                                 ))                                                                                                                               
                                                                                - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000                                                                                
                                                                                       THEN 3000000                                                                                                              
                                                                                       ELSE (YETA3000.TOTL_SALA * 0.20) END ))                                                                                     
                                                                           > 1000000                                                                                                                              
                                                                     THEN  1000000                                                                                                                                
                                                                     ELSE                                                                                                                                           
                                                                       ( (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )  
                                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )                                                                                      
                                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                                 ))                                                                                                                                     
                                                                        - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000                                                                  
                                                                               THEN 3000000                                                                                                 
                                                                               ELSE (YETA3000.TOTL_SALA * 0.20) END ))   END)  ELSE                                                          
                                                               (CASE WHEN (NVL(ETCH_MGVD,0) * 0.3) > 1000000   THEN  1000000                                                                
                                                                     ELSE  (NVL(ETCH_MGVD,0) * 0.3) END)  END)  ELSE 0   END   ))    > 1000000                                              
                                                         THEN  
                                                         1000000    
                                                        ELSE                                                                                                             
                                                           ( (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )  
                                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )                                                                                      
                                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                                 ))                                                                                                                                      
                                                            - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000                                                                              
                                                                   THEN 3000000                                                                                                             
                                                                   ELSE (YETA3000.TOTL_SALA * 0.20) END )                                                                                    
                                                                    - (CASE WHEN  (   (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )  
                                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )                                                                                      
                                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                                 ))                                                                                                                                      
                                                            - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000                                                                                                      
                                                                   THEN 3000000                                                                                                                                    
                                                                   ELSE (YETA3000.TOTL_SALA * 0.20) END )) > 0                                                                                                     
                                                 THEN                                                                                                                                                              
                                                      (CASE WHEN (NVL(ETCH_MGVD,0) * 0.3)                                                                                                                          
                                                                  > ( (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )  
                                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )                                                                                      
                                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                                 ))                                                                                                                                        
                                                                        - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000                                                                                         
                                                                               THEN 3000000                                                                                                                        
                                                                               ELSE (YETA3000.TOTL_SALA * 0.20) END ))                                                                                              
                                                           THEN                                                                                                                                                    
                                                               (CASE WHEN ( (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )  
                                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )                                                                                      
                                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                                 ))                                                                                                                                 
                                                                                - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000                                                                                
                                                                                       THEN 3000000                                                                                                                
                                                                                       ELSE (YETA3000.TOTL_SALA * 0.20) END ))                                                                                     
                                                                           > 1000000                                                                                                                              
                                                                     THEN  1000000                                                                                                                                
                                                                     ELSE                                                                                                                                          
                                                                       ( (( (NVL(ETCT_CARD,0) * 0.15) + (NVL(ETCH_UEAM,0)   + NVL(ETCH_BCED,0) +  NVL(ETCH_BCBS,0)  + NVL(ETCH_MGVD,0)) * 0.3)
                                                                                               + ( CASE WHEN NVL(CARD_ET14,0) > NVL(CARD_ET13,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15H,0) - (NVL(ETAD_DD13,0) * 0.50)) * 0.10)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )  
                                                                                              + ( CASE WHEN NVL(CARD_ET15,0) > NVL(CARD_ET14,0)                                  
                                                                                                                  THEN                                                                      
                                                                                                                      (CASE WHEN (NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) < 0 THEN 0
                                                                                                                        ELSE  ((NVL(ETAD_D15L,0) - (NVL(ETAD_D14L,0) * 0.50)) * 0.20)  END)              
                                                                                                                  ELSE 0                                                                    
                                                                                                                  END   )                                                                                      
                                                                               - (CASE WHEN (YETA3000.TOTL_SALA * 0.25) <= NVL(ETCT_CARD,0)                                                  
                                                                                       THEN  ((YETA3000.TOTL_SALA * 0.25) * 0.15)                                                            
                                                                                       ELSE ((NVL(ETCT_CARD,0)  * 0.15)                                                                     
                                                                                            + ((((YETA3000.TOTL_SALA * 0.25)) - NVL(ETCT_CARD,0)) * 0.3)) END                                
                                                                                 ))                                                                                                         
                                                                        - (CASE WHEN (YETA3000.TOTL_SALA * 0.20)  > 3000000   THEN 3000000                                                   
                                                                               ELSE (YETA3000.TOTL_SALA * 0.20) END ))    END)     ELSE                                                      
                                                               (CASE WHEN (NVL(ETCH_MGVD,0) * 0.3) > 1000000  THEN  1000000                                                                 
                                                                     ELSE  (NVL(ETCH_MGVD,0) * 0.3) END)  END)   ELSE 0   END  ))  END)  
                                                  ELSE                                              
                                                   (CASE WHEN (NVL(ETCH_BCED,0) * 0.3) > 1000000  THEN  1000000   ELSE  (NVL(ETCH_BCED,0) * 0.3) END)  END) 
                              ELSE 0                         
                             END ))                                                                                                                                                 
             ELSE                                                                                                                                                           
              0                                                                                                                                                             
             END)   FROM YETA2000                                                                                                                                            
            WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                                     
                  AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                                 
                  AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD   
                  AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                                                
                                  ))) ,
                                                                                                                                       

                         /*  --ETCK_UNON IS '기타공제)우리사주조합    */                                                                              
                               ETCK_UNON = (SELECT CASE WHEN (NVL(YETA2000.ETCK_UNON,0) > 4000000 )                                              
                                                                 THEN 4000000                                                                   
                                                                 ELSE NVL(YETA2000.ETCK_UNON,0)                                                  
                                                                 END                                                                            
                                                         FROM YETA2000                                                                           
                                                         WHERE YETA2000.SYSTEMKEY= YETA3000.SYSTEMKEY                                             
                                              AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                         
                                              AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD       
                                              AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                    
                                                         )  ,                                                                                    

                         /*  --ETCK_UNCR IS '기타공제)우리사주조합 기부금 이전기부금은 없음. */                                                                               
                               ETCK_UNCR = 0/* (SELECT CASE WHEN (NVL(YETA2000.SPCI_HFAM,0) > (NVL(YETA3000.WKER_AMNT,0) * 0.30) )                                              
                                                                 THEN (NVL(YETA3000.WKER_AMNT,0) * 0.30)                                                                   
                                                                 ELSE NVL(YETA2000.SPCI_HFAM,0)                                                  
                                                                 END                                                                            
                                                         FROM YETA2000                                                                           
                                                         WHERE YETA2000.SYSTEMKEY= YETA3000.SYSTEMKEY                                             
                                              AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                         
                                              AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD  
                                              AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                         
                                                         )  */ ,                                                                                    



                        /*  --ETCL_TO01 IS '기타공제)장기주식형저축  */                                                                              
                            ETCL_TO01 =  0,                                                                                               
                         /*   --ETCL_TO02 IS '기타공제_장기주식형저축_2년차공제  */                                                                   
                             ETCL_TO02 = 0,                                                                                               
                           /* --ETCL_TO03 IS '기타공제_장기주식형저축_3년차공제    */                                                                 
                            ETCL_TO03 =  0 ,                                                                                               
                         /*  --ETCL_HMTO IS '기타공제)장기주식형저축        */                                                                        
                            ETCL_HMTO = 0  ,                                                 
 
                         /*     --ETEP_MSAM IS 기타공제_고용유지중소기업근로자임금삭감공제액  */                                                
                         ETEP_MSAM  =  (SELECT (CASE WHEN   10000000 > (NVL(ETEP_HSAM,0) * 0.5)                                                   
                                                                       THEN                                                                
                                                                             (NVL(ETEP_HSAM,0) * 0.5)                                           
                                                                       ELSE                                                               
                                                                               10000000                                                  
                                                                       END)           
                      FROM YETA2000                                                                  
                                               WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY          
                                                 AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY         
                                                 AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD
                                                 AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD   ) ,    
      /*  -- //목돈안드는 전세 이자상환액공제 */
                           ETGD_HTRA  =  (SELECT (CASE WHEN   3000000 > (NVL(ETGD_CTRA,0) * 0.4)                                                   
                                                                       THEN                                                                
                                                                             (NVL(ETGD_CTRA,0) * 0.4)                                           
                                                                       ELSE                                                               
                                                                               3000000                                                  
                                                                       END)           
                      FROM YETA2000                                                                  
                                               WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY          
                                                 AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY         
                                                 AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD 
                                                 AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD  ) ,    
           /*  -- //장기집합투자증권저축  */
                           ETEP_SECR  =  (SELECT (CASE WHEN   2400000 > (NVL(ETEP_SEST,0) * 0.4)                                                   
                                                                       THEN                                                                
                                                                             (NVL(ETEP_SEST,0) * 0.4)                                           
                                                                       ELSE                                                               
                                                                               2400000                                                  
                                                                       END)           
                      FROM YETA2000                                                                  
                                               WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY          
                                                 AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY         
                                                 AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD 
                                                 AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD  )                                          
			   WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey# 
				]]>
	</update>
	 
	   
	   <!-- {공제단계 시작 -연금보험료공제 연금보험료공제  대상금액 04} -연금보험료공제  대상금액 넣기  
	    -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_03_1_TG_Update">
		<![CDATA[          
               UPDATE YETA2000                                                                      
              SET                                                                          
             /*  --JRTR_CTAR IS '주근무지_과학기술인공제_퇴직연금소득공제 대상금액  */                                  
              JRTR_CTAR = (  CASE WHEN (NVL(YETA2000.JRTR_CICT,0) + NVL(YETA2000.JRTR_PSCT,0) +  (CASE WHEN NVL(YETA2000.JRTR_ANSV,0)  <= 4000000 
                                                                                     THEN 4000000 ELSE  NVL(YETA2000.JRTR_ANSV,0) END))  <= 7000000        
                                         THEN NVL(YETA2000.JRTR_CICT,0)                                                                                 
                                         ELSE                                                                                                    
                                            CASE WHEN (NVL(YETA2000.JRTR_CICT,0)  + (CASE WHEN NVL(YETA2000.JRTR_ANSV,0)  <= 4000000 
                                                                                     THEN 4000000 ELSE  NVL(YETA2000.JRTR_ANSV,0) END)) <= 7000000                          
                                            THEN                                                                                             
                                                  NVL(YETA2000.JRTR_CICT,0)                                           
                                            ELSE  (CASE WHEN  (7000000 - (CASE WHEN NVL(YETA2000.JRTR_ANSV,0)  <= 4000000 
                                                                    THEN 4000000 ELSE  NVL(YETA2000.JRTR_ANSV,0) END))    <=  NVL(YETA2000.JRTR_CICT,0)      
                                                      THEN   (7000000 - (CASE WHEN NVL(YETA2000.JRTR_ANSV,0)  <= 4000000 
                                                                    THEN 4000000 ELSE  NVL(YETA2000.JRTR_ANSV,0) END))                                     
                                                      ELSE    NVL(YETA2000.JRTR_CICT,0)    END)
                                            END                                                                                  
                                        END     ) ,                                                  

              /*  --JRTR_PTAR IS '주근무지_근로자퇴직연금소득공제 대상금액  */                                  
               JRTR_PTAR = ( CASE WHEN (NVL(YETA2000.JRTR_CICT,0) + NVL(YETA2000.JRTR_PSCT,0) +  (CASE WHEN NVL(YETA2000.JRTR_ANSV,0)  <= 4000000 
                                                                                     THEN 4000000 ELSE  NVL(YETA2000.JRTR_ANSV,0) END))  <= 7000000        
                                         THEN NVL(YETA2000.JRTR_PSCT,0)                                                                                 
                                         ELSE                                                                                                    
                                            CASE WHEN (7000000 - (CASE WHEN (NVL(YETA2000.JRTR_CICT,0) + NVL(YETA2000.JRTR_PSCT,0) +  (CASE WHEN NVL(YETA2000.JRTR_ANSV,0)  <= 4000000 
                                                                                     THEN 4000000 ELSE  NVL(YETA2000.JRTR_ANSV,0) END))  <= 7000000        
                                                                 THEN NVL(YETA2000.JRTR_CICT,0)                                                                                 
                                                                 ELSE                                                                                                    
                                                                    CASE WHEN (NVL(YETA2000.JRTR_CICT,0)  + (CASE WHEN NVL(YETA2000.JRTR_ANSV,0)  <= 4000000 
                                                                                                             THEN 4000000 ELSE  NVL(YETA2000.JRTR_ANSV,0) END)) <= 7000000                          
                                                                    THEN                                                                                             
                                                                          NVL(YETA2000.JRTR_CICT,0)                                           
                                                                    ELSE  (CASE WHEN  (7000000 - (CASE WHEN NVL(YETA2000.JRTR_ANSV,0)  <= 4000000 
                                                                                            THEN 4000000 ELSE  NVL(YETA2000.JRTR_ANSV,0) END))    <=  NVL(YETA2000.JRTR_CICT,0)      
                                                                              THEN   (7000000 - (CASE WHEN NVL(YETA2000.JRTR_ANSV,0)  <= 4000000 
                                                                                            THEN 4000000 ELSE  NVL(YETA2000.JRTR_ANSV,0) END))                                     
                                                                              ELSE   NVL(YETA2000.JRTR_CICT,0)    END)
                                                                    END                                                                                  
                                                                END ) - (CASE WHEN NVL(YETA2000.JRTR_ANSV,0)  <= 4000000 
                                                                                     THEN 4000000 ELSE  NVL(YETA2000.JRTR_ANSV,0) END))  <= 0 
                                               THEN 0                          
                                               ELSE                                                                                             
                                                 (CASE WHEN (7000000 - (CASE WHEN (NVL(YETA2000.JRTR_CICT,0) + NVL(YETA2000.JRTR_PSCT,0) +  (CASE WHEN NVL(YETA2000.JRTR_ANSV,0)  <= 4000000 
                                                                                     THEN 4000000 ELSE  NVL(YETA2000.JRTR_ANSV,0) END))  <= 7000000        
                                                                 THEN NVL(YETA2000.JRTR_CICT,0)                                                                                 
                                                                 ELSE                                                                                                    
                                                                    CASE WHEN (NVL(YETA2000.JRTR_CICT,0)  + (CASE WHEN NVL(YETA2000.JRTR_ANSV,0)  <= 4000000 
                                                                                                             THEN 4000000 ELSE  NVL(YETA2000.JRTR_ANSV,0) END)) <= 7000000                          
                                                                    THEN                                                                                             
                                                                           NVL(YETA2000.JRTR_CICT,0)                                           
                                                                    ELSE  (CASE WHEN  (7000000 - (CASE WHEN NVL(YETA2000.JRTR_ANSV,0)  <= 4000000 
                                                                                            THEN 4000000 ELSE  NVL(YETA2000.JRTR_ANSV,0) END))    <=  NVL(YETA2000.JRTR_CICT,0)      
                                                                              THEN   (7000000 - (CASE WHEN NVL(YETA2000.JRTR_ANSV,0)  <= 4000000 
                                                                                            THEN 4000000 ELSE  NVL(YETA2000.JRTR_ANSV,0) END))                                     
                                                                              ELSE   NVL(YETA2000.JRTR_CICT,0)    END)
                                                                    END                                                                                  
                                                                END ) - (CASE WHEN NVL(YETA2000.JRTR_ANSV,0)  <= 4000000 
                                                                                     THEN 4000000 ELSE  NVL(YETA2000.JRTR_ANSV,0) END)) <=  NVL(YETA2000.JRTR_PSCT,0)
                                                       THEN  (7000000 - (CASE WHEN (NVL(YETA2000.JRTR_CICT,0) + NVL(YETA2000.JRTR_PSCT,0) +  (CASE WHEN NVL(YETA2000.JRTR_ANSV,0)  <= 4000000 
                                                                                     THEN 4000000 ELSE  NVL(YETA2000.JRTR_ANSV,0) END))  <= 7000000        
                                                                 THEN NVL(YETA2000.JRTR_CICT,0)                                                                                 
                                                                 ELSE                                                                                                    
                                                                    CASE WHEN (NVL(YETA2000.JRTR_CICT,0)  + (CASE WHEN NVL(YETA2000.JRTR_ANSV,0)  <= 4000000 
                                                                                                             THEN 4000000 ELSE  NVL(YETA2000.JRTR_ANSV,0) END)) <= 7000000                          
                                                                    THEN                                                                                             
                                                                          NVL(YETA2000.JRTR_CICT,0)                                           
                                                                    ELSE  (CASE WHEN  (7000000 - (CASE WHEN NVL(YETA2000.JRTR_ANSV,0)  <= 4000000 
                                                                                            THEN 4000000 ELSE  NVL(YETA2000.JRTR_ANSV,0) END))    <=  NVL(YETA2000.JRTR_CICT,0)      
                                                                              THEN   (7000000 - (CASE WHEN NVL(YETA2000.JRTR_ANSV,0)  <= 4000000 
                                                                                            THEN 4000000 ELSE  NVL(YETA2000.JRTR_ANSV,0) END))                                     
                                                                              ELSE   NVL(YETA2000.JRTR_CICT,0)    END)
                                                                    END                                                                                  
                                                                        END ) - (CASE WHEN NVL(YETA2000.JRTR_ANSV,0)  <= 4000000 
                                                                                     THEN 4000000 ELSE  NVL(YETA2000.JRTR_ANSV,0) END)) 
                                                        ELSE  NVL(YETA2000.JRTR_CICT,0) END)
                                            END
                                                                                             
                                        END     )  ,                                                    

              /* -- S '주근무지_연금계좌 소득공제 대상금액   */                                 
              JRTR_ATAR = (CASE WHEN NVL(YETA2000.JRTR_ANSV,0)  <= 4000000 
                               THEN NVL(YETA2000.JRTR_ANSV,0) ELSE 4000000  END)
            WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#                                                                        
			 
				]]>
	</update>
	 
	   <!-- {공제단계 시작 -연금보험료공제 03_1 대상금액 구하는 로직 추가  05} 연금보험료공제 2014년 귀속 분 부터 세액공제 전환 
	    -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_03_1_Update">
		<![CDATA[
			  UPDATE YETA3000                                                                      
               SET                                                                          
               /* --JRTR_HICT IS '주근무지_과학기술인공제_퇴직연금소득공제  */                                   
               JRTR_HICT =(SELECT CASE WHEN YETA3000.TOTL_SALA <= 55000000 THEN  NVL(YETA2000.JRTR_CTAR,0) * 0.15  
                                       ELSE    NVL(YETA2000.JRTR_CTAR,0) * 0.12  END  
                                  FROM YETA2000                                                                                                    
                                WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                       
                                  AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                       
                                  AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD
                                  AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD  )   ,                                                  

              /*  --JRTR_PSRN IS '주근무지_근로자퇴직연금소득공제    */                                 
               JRTR_PSRN =(SELECT CASE WHEN YETA3000.TOTL_SALA <= 55000000 THEN NVL(YETA2000.JRTR_PTAR,0) * 0.15   
                                       ELSE   NVL(YETA2000.JRTR_PTAR,0) * 0.12   END  
                                  FROM YETA2000                                                                                                    
                                WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                       
                                  AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                       
                                  AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD
                                  AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD  ) ,                                                    

              /*  -- S '주근무지_연금계좌 소득공제   */                                  
               JRTR_HNSV =(SELECT  CASE WHEN YETA3000.TOTL_SALA <= 55000000 THEN  NVL(YETA2000.JRTR_ATAR,0) * 0.15   
                                       ELSE  NVL(YETA2000.JRTR_ATAR,0) * 0.12 END                             
                                  FROM YETA2000                                                                                                    
                                WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                       
                                  AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                       
                                  AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD
                                  AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD  )                                                     
			 WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey# 
				]]>
	</update>
	  
	   <!-- {공제단계 시작 -특별공제 - 보험료 - 2개로 분리하여 사용함. 06}
   //특별공제 - 보험료 특별공제 - 보험료  
   -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_04_1_Update">
		<![CDATA[
			   UPDATE YETA2000                                                                        
                  SET                                                                       
               /*  --SPCI_GURT IS '특별공제_보장성보험료  대상금액   */                                  
                     SPCI_RTTG =  ( CASE WHEN NVL(SPCI_GURT,0) > 1000000      
                                             THEN 1000000                                   
                                             ELSE SPCI_GURT                          
                                             END      )  ,                                                   
                /*  --SPCI_HDRC IS '특별공제_장애인보장성보험료 대상금액 */                               
                       SPCI_HDTG = (  CASE WHEN NVL(SPCI_HDRC,0) > 1000000      
                                             THEN 1000000                                   
                                             ELSE SPCI_HDRC                          
                                             END         )   
                WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#                                        
				]]>
	</update>
	  
	   <!-- //특별공제 - 보험료 특별공제 - 보험료 -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_04_Update">
		<![CDATA[
			   UPDATE YETA3000                                                                        
                  SET                                                                       
 
                  /* --SPCI_GURT IS '특별공제_보장성보험료  */                                     
                     SPCI_GURT =  TRUNC((SELECT CASE WHEN NVL(YETA2000.SPCI_GURT,0) > 1000000      
                                             THEN 1000000  * 0.12                                  
                                             ELSE YETA2000.SPCI_GURT * 0.12                         
                                             END                                            
                                     FROM YETA2000                                           
                                   WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY              
                                     AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY              
                                     AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD
                                      AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD              
                                     ),-1)  ,                                                   
                 /* --SPCI_HDRC IS '특별공제_장애인보장성보험료      */                           
                      SPCI_HDRC = TRUNC((SELECT CASE WHEN NVL(YETA2000.SPCI_HDRC,0) > 1000000      
                                             THEN 1000000  * 0.15                                 
                                             ELSE YETA2000.SPCI_HDRC  * 0.15                        
                                             END                                            
                                     FROM YETA2000                                           
                                   WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY              
                                     AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY              
                                     AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD
                                      AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD ),-1)              
                  WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#      
				]]>
	</update>
	  
	   <!--  {공제단계 시작 -특별공제 - 의료비  대상금액  07} -특별공제 - 의료비 대상금액구하는 루틴   
	    -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_05_01_Update"> 
		<![CDATA[
			   UPDATE YETA2000                                                                                                                                               
                        SET      SPCI_ETCG =   0, SPCI_SFTG =  0, SPCI_65TG = 0 ,SPCI_PSTG =  0,                                                                                                                                  
 
                        /*   --SPCI_DTAR IS '특별공제)의료비공제대상금액 */
                   SPCI_DTAR =  (SELECT ( CASE WHEN  (NVL(YETA2000.SPCI_DETC,0) - (NVL(YETA3000.TOTL_SALA,0) * 0.03)) >= 0         
                                                                THEN                                                                          
                                                                        (CASE WHEN  (YETA2000.SPCI_DETC - (NVL(YETA3000.TOTL_SALA,0) * 0.03))  > 7000000   
                                                                            THEN    7000000                                                           
                                                                            ELSE                                                                      
                                                                                  (YETA2000.SPCI_DETC - (NVL(YETA3000.TOTL_SALA,0) * 0.03))             
                                                                           END)                                                                        
                                                                ELSE                                                                                    
                                                                      0                                                                                 
                                                                END )                                                                                    
                   + ( CASE WHEN  (NVL(YETA2000.SPCI_DETC,0) - (NVL(YETA3000.TOTL_SALA,0) * 0.03)) >= 0                                                    
                        THEN                                                                                                                              
                              (NVL(YETA2000.SPCI_SELF ,0) + NVL(YETA2000.SPCI_AE65 ,0) + NVL(YETA2000.SPCI_DBPS ,0))                                         
                        ELSE                                                                                                                             
                            CASE WHEN ( (NVL(YETA2000.SPCI_SELF ,0) + NVL(YETA2000.SPCI_AE65 ,0) + NVL(YETA2000.SPCI_DBPS ,0)) +  (NVL(YETA2000.SPCI_DETC,0) - (NVL(YETA3000.TOTL_SALA,0) * 0.03))) < 0    
                                                     THEN                                                                                                                                  
                                                            0                                                                                                                               
                                                    ELSE                                                                                                                                      
                                                        ( (NVL(YETA2000.SPCI_SELF ,0) + NVL(YETA2000.SPCI_AE65 ,0) + NVL(YETA2000.SPCI_DBPS ,0)) +  (NVL(YETA2000.SPCI_DETC,0) - (NVL(YETA3000.TOTL_SALA,0) * 0.03)))   
                                                     END                                                                                                                        
                        END)                                                                                                                    
                                              FROM YETA3000                                                                                                            
                                            WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                               
                                              AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                               
                                              AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD     
                                              AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                           
                                              )  
			WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#  
				]]>
	</update>
	  
	   
	   <!--  특별공제 - 의료비  -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_05_Update">   
		<![CDATA[
			    UPDATE YETA3000                                                                                                                                               
                        SET   SPCI_DETC = 0, SPCI_SELF =  0, SPCI_HE65 = 0, SPCI_HBPS = 0,                                                                                                                                     
  
                      /*  --SPCI_TXCR IS '특별공제)의료비세액공제대상 금액   */                                                                                            
                             SPCI_TXCR =  TRUNC((SELECT   NVL(YETA2000.SPCI_DTAR ,0)  * 0.15                                                                                                            
                                              FROM YETA2000                                                                                                            
                                            WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                               
                                              AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                               
                                              AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD  
                                               AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                             
                                              ), 0)           
			 WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey# 
				]]>
	</update>
	   
	   
	   <!-- {공제단계 시작 -특별공제 - 교육비 대상금액 08 -1 }  특별공제 - 교육비  
	   -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_06_01_Update">
		<![CDATA[
			 UPDATE YETA2000                                                                                                                 
                        SET                                                                                                        
                      /*  --SPED_SFTR IS '특별공제)교육비_본인 - 전액  */                                                                
                         SPED_SFTR =        NVL(SPED_SELF,0)  ,                                                                                      
                      /*  --SPED_EDTR IS '특별공제)교육비_자녀등_미초중고 - 명당 300만원      */                                         
                         SPED_EDTR =       (  CASE WHEN NVL( SPED_EDAM,0) > (3000000 * (NVL(SPED_EDSU,0)))             
                                                   THEN 3000000 * NVL(SPED_EDSU,0)                                                      
                                                   ELSE SPED_EDAM                                                          
                                                   END   ) ,                                                                                     
                       /*  --SPED_GDTR IS '특별공제_교육비_초중고  명당 300만원  */                                                      
                        SPED_GDTR   = (  CASE WHEN NVL( SPED_GDAM,0) > (3000000 * NVL(SPED_GDSU,0))                    
                                                   THEN 3000000 * NVL(SPED_GDSU,0)                                                 
                                                   ELSE  SPED_GDAM                                                          
                                                   END  ) ,                                                                                     
                      /*  --SPED_CVTR IS '특별공제)교육비_자녀등_대학교     */                                                           
                         SPED_CVTR   =           (  CASE WHEN NVL( SPED_CVAM,0) > (9000000 * NVL(SPED_CVSU,0))         
                                                   THEN 9000000 * NVL(SPED_CVSU,0)                                                 
                                                   ELSE  SPED_CVAM                                                          
                                                   END   )  ,                                                                                    
                       /*  --SPCI_SCTR IS '특별공제)장애인특수교육비    */                                                               
                        SPCI_SCTR =   NVL(SPCI_SCAM,0)            
    					 WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#
				]]>
	</update>
	  
	   <!-- {공제단계 시작 -특별공제 - 교육비 공제  08 -2 } 특별공제 - 교육비 
	    -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_06_Update">
		<![CDATA[
			  UPDATE YETA3000                                                                                                                 
                        SET                                                                                                        
                       /* --SPED_SELF IS '특별공제)교육비_본인 - 전액   */                                                               
                         SPED_SELF =      TRUNC((SELECT NVL(YETA2000.SPED_SFTR,0)  * 0.15                                                                
                                           FROM YETA2000                                                                            
                                         WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                               
                                           AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                               
                                           AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD 
                                            AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                 
                                           ),-1),                                                                                      
                       /* --SPED_GRDE IS '특별공제)교육비_자녀등_미초중고 - 명당 300만원 */                                              
                         SPED_GRDE =       TRUNC((SELECT NVL(YETA2000.SPED_EDTR,0)  * 0.15                                                          
                                           FROM YETA2000                                                                            
                                         WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                               
                                           AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                               
                                           AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD   
                                            AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                               
                                           ),-1) ,                                                                                     
                       /*  --SPED_GDTO IS '특별공제_교육비_초중고  명당 300만원  */                                                      
                        SPED_GDTO   = TRUNC((SELECT  NVL(YETA2000.SPED_GDTR,0)  * 0.15                                                                              
                                           FROM YETA2000                                                                            
                                         WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                               
                                           AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                               
                                           AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD
                                            AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                  
                                           ),-1) ,                                                                                     
                      /*  --SPED_CLDV IS '특별공제)교육비_자녀등_대학교 */                                                               
                         SPED_CLDV   =           TRUNC((SELECT  NVL(YETA2000.SPED_CVTR,0)  * 0.15                                                 
                                           FROM YETA2000                                                                            
                                         WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                               
                                           AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                               
                                           AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD   
                                            AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                               
                                           ),-1)  ,                                                                                    
                       /*  --SPCI_SPEC IS '특별공제)장애인특수교육비   */                                                                
                        SPCI_SPEC = TRUNC((SELECT NVL(SPCI_SCTR,0)  * 0.15                                                                       
                                           FROM YETA2000                                                                            
                                         WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                               
                                           AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                               
                                           AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD 
                                            AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD   ),-1)             
                     WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey# 
				]]>
	</update>
	   
	   
	   <!--   -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_06_1_Update">
		<![CDATA[
			  UPDATE YETA3180  
                  SET  CRTB_CNCD =  (CASE WHEN  (SELECT FAMY_RELA_DIV_CD FROM PSNL0115
                                          WHERE PSNL0115.SYSTEMKEY = YETA3180.SYSTEMKEY 
                                             AND PSNL0115.DPOB_CD  = YETA3180.DPOB_CD  
                                             AND PSNL0115.FAMY_RESN_REGN_NUM = YETA3180.RSNO_NUMB 
                                             AND NVL(YETA3180.CRTB_CNCD,'T') = 'T' ) IS NULL 
                                             THEN   CRTB_CNCD
                                             ELSE 
                                             (SELECT FAMY_RELA_DIV_CD FROM PSNL0115
                                                  WHERE PSNL0115.SYSTEMKEY = YETA3180.SYSTEMKEY 
                                                     AND PSNL0115.DPOB_CD  = YETA3180.DPOB_CD  
                                                     AND PSNL0115.FAMY_RESN_REGN_NUM = YETA3180.RSNO_NUMB 
                                                     AND NVL(YETA3180.CRTB_CNCD,'T') = 'T' ) 
                                             END) ,
                    CTRB_CTNT   =  DECODE(NVL(CTRB_CTNT,'0'),'0','1',CTRB_CTNT)	
                      WHERE    DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey# 
				]]>
	</update>
	  
	   <!-- {공제단계 시작 -특별공제 - 기부금공제     12 } 기부금공제 1 
	    -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_08_Update">
		<![CDATA[
			    UPDATE YETA2000                                                                                                                                                                          
                               SET                                                                                                                                         
  /* --//기부금합계 */
                SPCI_DGAM =  NVL(YETA2000.TAXD_PLTC,0) +  NVL(YETA2000.SPCI_PLTC,0) + NVL(YETA2000.SPCI_FBAM,0)  + NVL(YETA2000.SPCI_HFAM,0) +  NVL(YETA2000.SPCI_NAMT,0) + NVL(YETA2000.SPCI_YAMT,0) ,   

 /*  --//정치 기부금 10만원처리 부분..... TAXD_10TG 이하대상금액 */
                TAXD_10TG = (SELECT NVL(YETA2000.TAXD_PLTC,0)                                                           
                               FROM YETA3000                                                                                                                                                                        
                              WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                                                          
                                AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                                                          
                                AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD
                                AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                                                                          
                          ),                                                                                                                                                                                       

 /*  --//특별공제 기부금 _정치   10만원초과 금액 대상금액 */
                               SPCI_PLTG = (SELECT (CASE WHEN NVL(YETA2000.SPCI_PLTC,0) > NVL(YETA3000.WKER_AMNT,0)                                                                                   
                                                             THEN  NVL(YETA3000.WKER_AMNT,0)  
                                                             ELSE   NVL(YETA2000.SPCI_PLTC,0)  
                                                            END)                                                                                                                                    
                                                       FROM YETA3000                                                                                                                                 
                                                        WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                 
                                                          AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                 
                                                          AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD    
                                                           AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                             
                                                     )                                                                                                                                              
                           WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey# 
				]]>
	</update>
	   
	   
	   <!--  기부금공제 1  -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_08_01_Update">
		<![CDATA[
			                UPDATE YETA3000                                                                                                                                                                          
                               SET                                                                                                                                         
/* --//정치 기부금 10만원처리 부분..... TAXD_10TG 이하금액 */
                TAXD_PLTC = (SELECT   CASE WHEN  90909 >= TRUNC(NVL(YETA2000.TAXD_10TG,0) * (100/110))     
                                                   THEN  TRUNC(NVL(YETA2000.TAXD_10TG,0) * (100/110))                                   
                                                   ELSE   90909  END                                                            
                               FROM YETA2000                                                                                                                                                                        
                              WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                                                          
                                AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                                                          
                                AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD 
                                AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                                                                          
                          ),                                                                                                                                                                                       

/*  -- //특별공제 기부금 _정치   10만원초과 금액 공제새액 SPCI_PLTC */
                               SPCI_PLTC = (SELECT (CASE WHEN NVL(YETA2000.SPCI_PLTG,0) > NVL(YETA3000.WKER_AMNT,0)                                                                                   
                                                             THEN CASE WHEN NVL(YETA3000.WKER_AMNT,0) <= 30000000  THEN   NVL(YETA3000.WKER_AMNT,0) * 0.15  
                                                                                       ELSE (30000000 * 0.15) +  ((NVL(YETA3000.WKER_AMNT,0)  - 30000000) * 0.25) END 
                                                             ELSE CASE WHEN NVL(YETA2000.SPCI_PLTG,0)  <= 30000000  THEN NVL(YETA2000.SPCI_PLTG,0)  * 0.15           
                                                                                       ELSE (30000000 * 0.15) +  ((NVL(YETA2000.SPCI_PLTG,0)  - 30000000) * 0.25) END  
                                                            END)                                                                                                                                    
                                                       FROM YETA2000                                                                                                                                 
                                                        WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                 
                                                          AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                 
                                                          AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD     
                                                          AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                             
                                                     ) ,                                                                                                                                            
 /* --// 법정기부금. 이월금액 처리 */
                               SPCI_OBAM = (SELECT (CASE WHEN NVL(YETA2000.SPCI_OBAM,0) > (NVL(YETA3000.WKER_AMNT,0) - (CASE WHEN NVL(YETA2000.SPCI_PLTG,0) > NVL(YETA3000.WKER_AMNT,0)                 
                                                                                             THEN NVL(YETA3000.WKER_AMNT,0)                                                                          
                                                                                             ELSE NVL(YETA2000.SPCI_PLTG,0)                                                                          
                                                                                            END))                                                                                                   
                                                             THEN CASE WHEN (NVL(YETA3000.WKER_AMNT,0) - (CASE WHEN NVL(YETA2000.SPCI_PLTG,0) > NVL(YETA3000.WKER_AMNT,0)                              
                                                                                             THEN NVL(YETA3000.WKER_AMNT,0)                                                                          
                                                                                             ELSE NVL(YETA2000.SPCI_PLTG,0)                                                                          
                                                                                            END)) < 0                                                                                               
                                                                       THEN 0                                                                                                                       
                                                                       ELSE (NVL(YETA3000.WKER_AMNT,0) - (CASE WHEN NVL(YETA2000.SPCI_PLTG,0) > NVL(YETA3000.WKER_AMNT,0)                              
                                                                                             THEN NVL(YETA3000.WKER_AMNT,0)                                                                          
                                                                                             ELSE NVL(YETA2000.SPCI_PLTG,0)                                                                          
                                                                                            END))                                                                                                   
                                                                       END                                                                                                                          
                                                             ELSE NVL(YETA2000.SPCI_OBAM,0)                                                                                                          
                                                             END)                                                                                                                                   
                                                       FROM YETA2000                                                                                                                                 
                                                        WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                 
                                                          AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                 
                                                          AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD   
                                                          AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                               
                                                     )  ,                                                                                                                                           
 
                          /*    -- 특례기부금-공익법인신탁제외  - 1- 2      */                                                                                                                            
                                SPCI_EXAM = 0                
 					 WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey# 
				]]>
	</update>
	   
	   
	   <!-- 기부금공제 1-법정기부금 대상금액 -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_08_02_Update">
		<![CDATA[
			    UPDATE YETA2000                                                                                                                                                                          
                               SET                                                                                                                                         
   /*  -- // 법정기부금.  대상금액 -당기   */                                                                                                                                                                                                                                                                                         
                               SPCI_FBTG = (SELECT (CASE WHEN NVL(YETA2000.SPCI_FBAM,0) > (NVL(YETA3000.WKER_AMNT,0) -  NVL(YETA2000.SPCI_PLTG,0) - NVL(YETA3000.SPCI_OBAM,0))    
                                                             THEN (NVL(YETA3000.WKER_AMNT,0) -  NVL(YETA2000.SPCI_PLTG,0) - NVL(YETA3000.SPCI_OBAM,0))                         
                                                             ELSE NVL(YETA2000.SPCI_FBAM,0)                                                                                                          
                                                             END)                                                                                                                                   
                                                       FROM YETA3000                                                                                                                                 
                                                        WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                 
                                                          AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                 
                                                          AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD      
                                                             AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                           
                                                     ) ,
           /*  법정기부금.  대상금액 2014월분 -- SPCI_OB14 - SPCI_FB14 */                                          
               SPCI_FB14 =  (SELECT (CASE WHEN NVL(YETA2000.SPCI_OB14,0) > (NVL(YETA3000.WKER_AMNT,0) -  NVL(YETA2000.SPCI_PLTG,0) - NVL(YETA3000.SPCI_OBAM,0) -(CASE WHEN NVL(YETA2000.SPCI_FBAM,0) > (NVL(YETA3000.WKER_AMNT,0) -  NVL(YETA2000.SPCI_PLTG,0) - NVL(YETA3000.SPCI_OBAM,0))    
                                                             THEN (NVL(YETA3000.WKER_AMNT,0) -  NVL(YETA2000.SPCI_PLTG,0) - NVL(YETA3000.SPCI_OBAM,0))                         
                                                             ELSE NVL(YETA2000.SPCI_FBAM,0)                                                                                                          
                                                             END)  )    
                                                             THEN (NVL(YETA3000.WKER_AMNT,0) -  NVL(YETA2000.SPCI_PLTG,0) - NVL(YETA3000.SPCI_OBAM,0) - (CASE WHEN NVL(YETA2000.SPCI_FBAM,0) > (NVL(YETA3000.WKER_AMNT,0) -  NVL(YETA2000.SPCI_PLTG,0) - NVL(YETA3000.SPCI_OBAM,0))    
                                                             THEN (NVL(YETA3000.WKER_AMNT,0) -  NVL(YETA2000.SPCI_PLTG,0) - NVL(YETA3000.SPCI_OBAM,0))                         
                                                             ELSE NVL(YETA2000.SPCI_FBAM,0)                                                                                                          
                                                             END) )                         
                                                             ELSE NVL(YETA2000.SPCI_OB14,0)                                                                                                          
                                                             END)                                                                                                                                   
                                                       FROM YETA3000                                                                                                                                 
                                                        WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                 
                                                          AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                 
                                                          AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD      
                                                             AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                           
                                                     )                                       
                             WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#                                                                                                                                           
 
				]]>
	</update>
	  
	   <!-- 기부금공제  특례기부금공제, 우리사주조합2  -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_09_01_Update">
		<![CDATA[
			         UPDATE YETA3000                                                                                                                                                                        
                             SET                                                                                                                                                                                

				/* -- //이월 기부금으로 계산 함. 공익신탁금액 사용안함. */
				  SPCI_ONON =  (SELECT CASE WHEN NVL(YETA2000.SPCI_ONON,0) > ((NVL(YETA3000.WKER_AMNT,0) - NVL(YETA2000.SPCI_PLTG,0) - NVL(YETA3000.SPCI_OBAM,0) - NVL(YETA2000.SPCI_FBTG,0) - NVL(YETA2000.SPCI_FB14,0) ) * 0.5)                                 
				                            THEN  ((NVL(YETA3000.WKER_AMNT,0) - NVL(YETA2000.SPCI_PLTG,0) - NVL(YETA3000.SPCI_OBAM,0) - NVL(YETA2000.SPCI_FBTG,0) - NVL(YETA2000.SPCI_FB14,0) ) * 0.5)                            
				                            ELSE NVL(YETA2000.SPCI_ONON,0)                                                                                                                       
				                                                            END                                                                                                                                                 
				                                                      FROM YETA2000                                                                                                                                              
				                                                      WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                               
				                                                         AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                              
				                                                         AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD     
				                                                        AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                                             
				                                                    ),                                                                                                                                                           
				/* -- // 우리사주조합 기부금. 소득공제 기부금으로 계산 함. 2014년 이전 0 ETCK_UNCR */
				      ETCK_UNCR = 0  
                  WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey# 
				]]>
	</update>
	 
	     <!-- 기부금공제 1-우리사주조합   대상금액  -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_08_03_Update">
		<![CDATA[
			    UPDATE YETA2000                                                                                                                                                                          
                               SET    
             /*  -- // 우리사주조합   대상금액   */     
                 SPCI_HFTG =   (SELECT CASE WHEN NVL(YETA2000.SPCI_HFAM,0) > ((NVL(YETA3000.WKER_AMNT,0) - NVL(YETA2000.SPCI_PLTG,0) - NVL(YETA3000.SPCI_OBAM,0) - NVL(YETA2000.SPCI_FBTG,0) - NVL(YETA2000.SPCI_FB14,0)    - NVL(YETA3000.SPCI_ONON,0) ) * 0.3)    
				                                                           THEN  ((NVL(YETA3000.WKER_AMNT,0) - NVL(YETA2000.SPCI_PLTG,0) - NVL(YETA3000.SPCI_OBAM,0) -   NVL(YETA2000.SPCI_FBTG,0) - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA3000.SPCI_ONON,0) ) * 0.3)   
				                                                           ELSE NVL(YETA2000.SPCI_HFAM,0)                                                                                                                          
				                                                           END                                                                                                                                                    
				                                                     FROM YETA3000                                                                                                                                                 
				                                                     WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                                  
				                                                        AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY  
				                                                         AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                                                 
				                                                        AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD                                                                                                                 
				                                                   )                                           
                             WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#                                                                                                                                           
 
				]]>
	</update>
	
	   <!--  이전년도 기부금공제 종교단체 및 종교단체외 기부금 이월기부금계산  -->
	<update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_09_Update">
		<![CDATA[
			/*  -- // 종교단체 기부금 */
    UPDATE YETA3000                                                                                                                                                                                                                   
            SET                                                                                                                                                                                                          
              SPCI_OYAM = (SELECT (CASE WHEN NVL(YETA2000.SPCI_OYAM,0) > 0                                                                                                                                                       
                                        THEN                                                                                                                                                                                    
                                        (CASE WHEN NVL(YETA2000.SPCI_ONAM,0) >                                                                                                                                                     
                                                   ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0) - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20)                                     
                                        THEN                                                                                                                                                                                      
                                              CASE WHEN NVL(YETA2000.SPCI_OYAM,0) > (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +   
                                                                           ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20))             
                                                                            AND (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +      
                                                                           ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20)) > 0         
                                              THEN  (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +                                  
                                                  ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20))                                      
                                              ELSE                                                                                                                                                                                
                                                  CASE WHEN (NVL(YETA2000.SPCI_OYAM,0) + NVL(YETA2000.SPCI_ONAM,0)) >                                                                                                               
                                                            (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG -NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +                          
                                                            ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20))                            
                                                             AND (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +                     
                                                             ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20)) > 0                       
                                                       THEN                                                                                                                                                                       
                                                            ((((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +                         
                                                            ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20)) - NVL(YETA2000.SPCI_ONAM,0))
                                                       ELSE                                                                                                                                                                       
                                                            NVL(YETA2000.SPCI_OYAM,0)                                                                                                                                             
                                                       END                                                                                                                                                                        
                                              END                                                                                                                                                                                 
                                        ELSE                                                                                                                                                                                      
                                              CASE WHEN NVL(YETA2000.SPCI_OYAM,0) > (NVL(YETA2000.SPCI_ONAM,0)  +                                                                                                                   
                                                                                   ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10))     
                                                                                    AND (NVL(YETA2000.SPCI_ONAM,0) +                                                                                                               
                                                                                  ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG  - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10)) > 0  
                                              THEN  (NVL(YETA2000.SPCI_ONAM,0)  +                                                                                                                                                  
                                                                           ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10))             
                                              ELSE                                                                                                                                                                                
                                                   CASE WHEN (NVL(YETA2000.SPCI_OYAM,0) + NVL(YETA2000.SPCI_ONAM,0)) >                                                                                                              
                                                             (NVL(YETA2000.SPCI_ONAM,0)  +                                                                                                                                         
                                                                                   ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG  - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10))     
                                                                                    AND (NVL(YETA2000.SPCI_ONAM,0) +                                                                                                               
                                                                                  ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10)) > 0  
                                                       THEN                                                                                                                                                                       
                                                            ((NVL(YETA2000.SPCI_ONAM,0)  +                                                                                                                                          
                                                             ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10)) - NVL(YETA2000.SPCI_ONAM,0))
                                                       ELSE                                                                                                                                                                        
                                                            NVL(YETA2000.SPCI_OYAM,0)                                                                                                                                              
                                                       END                                                                                                                                                                         
                                              END                                                                                                                                                                                  
                                                                                                                                                                                                                                   
                                        END)                                                                                                                                                                                       
                                   ELSE                                                                                                                                                                                          
                                       0                                                                                                                                                                                         
                                   END)                                                                                                                                                                                          
                            FROM YETA2000                                                                                                                                                                                         
                            WHERE YETA2000.SYSTEMKEY= YETA3000.SYSTEMKEY                                                                                                                                                           
                                  AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                                                                      
                                  AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD  
                                   AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                                                                                      
                          ),                                                                                                                                                                                                     
/* --//종교단체외 기부금. */
       SPCI_ONAM =   (SELECT  (CASE WHEN NVL(YETA2000.SPCI_ONAM,0) > 0                                                                                                                                                            
                            THEN                                                                                                                                                                                                 
                             (CASE WHEN NVL(YETA2000.SPCI_OYAM,0) > 0                                                                                                                                                             
                                        THEN                                                                                                                                                                                     
                                          (CASE WHEN NVL(YETA2000.SPCI_ONAM,0) >                                                                                                                                                  
                                                     ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG  - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0) - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20)                                  
                                          THEN                                                                                                                                                                                   
                                                                                                                                                                                                                                 
                                                CASE WHEN NVL(YETA2000.SPCI_OYAM,0) > (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +
                                                                             ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20))          
                                                                              AND (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +   
                                                                             ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20)) > 0      
                                                THEN                                                                                                                                                                             
                                                    0                                                                                                                                                                            
                                                ELSE                                                                                                                                                                             
                                                    CASE WHEN (NVL(YETA2000.SPCI_OYAM,0) + NVL(YETA2000.SPCI_ONAM,0)) >                                                                                                            
                                                              (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +                       
                                                              ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20))                         
                                                               AND (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +                  
                                                               ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20)) > 0                    
                                                         THEN                                                                                                                                                                    
                                                              ((((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +                      
                                                              ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20)) - NVL(YETA2000.SPCI_OYAM,0))
                                                         ELSE                                                                                                                                                                       
                                                              NVL(YETA2000.SPCI_ONAM,0)                                                                                                                                             
                                                         END                                                                                                                                                                        
                                                END                                                                                                                                                                                 
                                          ELSE                                                                                                                                                                                      
                                                CASE WHEN NVL(YETA2000.SPCI_OYAM,0) > (NVL(YETA2000.SPCI_ONAM,0)  +                                                                                                                   
                                                                                     ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10))     
                                                                                      AND (NVL(YETA2000.SPCI_ONAM,0) +                                                                                                               
                                                                                    ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10)) > 0  
                                                THEN                                                                                                                                                                                
                                                     0                                                                                                                                                                              
                                                ELSE                                                                                                                                                                                
                                                     CASE WHEN (NVL(YETA2000.SPCI_OYAM,0) + NVL(YETA2000.SPCI_ONAM,0)) >                                                                                                              
                                                               (NVL(YETA2000.SPCI_ONAM,0)  +                                                                                                                                         
                                                                                     ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10))     
                                                                                      AND (NVL(YETA2000.SPCI_ONAM,0) +                                                                                                               
                                                                                    ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG  - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10)) > 0  
                                                         THEN                                                                                                                                                                       
                                                              ((NVL(YETA2000.SPCI_ONAM,0)  +                                                                                                                                         
                                                               ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10)) - NVL(YETA2000.SPCI_OYAM,0))
                                                         ELSE                                                                                                                                                                        
                                                              NVL(YETA2000.SPCI_ONAM,0)                                                                                                                                              
                                                         END                                                                                                                                                                         
                                                END                                                                                                                                                                                  
                                                                                                                                                                                                                                     
                                          END)                                                                                                                                                                                       
                                    ELSE                                                                                                                                                                                             
                                         (CASE  WHEN NVL(YETA2000.SPCI_ONAM,0) < ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG  - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0) - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.30)           
                                                THEN  NVL(YETA2000.SPCI_ONAM,0)                                                                                                                                                       
                                                ELSE  ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG - NVL(YETA2000.SPCI_FB14,0)  - NVL(YETA2000.SPCI_HFTG,0)  - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.30)                                     
                                                END)                                                                                                                                                                                 
                                     END)                                                                                                                                                                                          
                                   ELSE                                                                                                                                                                                              
                                       0                                                                                                                                                                                             
                                   END)                                                                                                                                                                                              
                            FROM YETA2000                                                                                                                                                                                             
                            WHERE YETA2000.SYSTEMKEY= YETA3000.SYSTEMKEY                                                                                                                                                               
                                  AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                                                                          
                                  AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD 
                                   AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                                                                                           
                          )             
			  WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#
				]]>
	</update>   
	   
	<!--  기부금공제 종교단체 및 종교단체외 기부금대상금액  -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_09_02_Update">
		<![CDATA[
			 
   UPDATE YETA2000                                                                                                                                                                                                                   
            SET        
        /*    -- // 종교단체 기부금    */                                                                                                                                                                                               
              SPCI_YATG = (SELECT (CASE WHEN NVL(YETA2000.SPCI_YAMT,0) > 0                                                                                                                                                       
                                        THEN                                                                                                                                                                                    
                                        (CASE WHEN NVL(YETA2000.SPCI_NAMT,0) >                                                                                                                                                     
                                                   ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20)                                     
      THEN                                                                                                                                                                                      
       CASE WHEN NVL(YETA2000.SPCI_YAMT,0) > (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +   
      ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM)) 
           AND (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +      
         ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20)  - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM)) > 0         
          THEN  (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +                                  
           ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM))                                      
           ELSE                                                                                                                                                                                
          CASE WHEN (NVL(YETA2000.SPCI_YAMT,0) + NVL(YETA2000.SPCI_NAMT,0)) >                                                                                                               
                             (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +                          
                             ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM))                            
                              AND (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +                     
                              ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM)) > 0                       
                        THEN                                                                                                                                                                       
                             ((((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +                         
                             ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM)) - NVL(YETA2000.SPCI_NAMT,0))
                        ELSE                                                                                                                                                                       
                             NVL(YETA2000.SPCI_YAMT,0)                                                                                                                                             
                        END                                                                                                                                                                        
               END                                                                                                                                                                                 
         ELSE                                                                                                                                                                                      
               CASE WHEN NVL(YETA2000.SPCI_YAMT,0) > (NVL(YETA2000.SPCI_NAMT,0)  +                                                                                                                   
                                                    ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM))     
                                                     AND (NVL(YETA2000.SPCI_NAMT,0) +                                                                                                               
                                                   ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM)) > 0  
               THEN  (NVL(YETA2000.SPCI_NAMT,0)  +                                                                                                                                                  
                                            ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM))             
               ELSE                                                                                                                                                                                
                    CASE WHEN (NVL(YETA2000.SPCI_YAMT,0) + NVL(YETA2000.SPCI_NAMT,0)) >                                                                                                              
                              (NVL(YETA2000.SPCI_NAMT,0)  +                                                                                                                                         
                                                    ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM))     
                                                     AND (NVL(YETA2000.SPCI_NAMT,0) +                                                                                                               
                                                   ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM)) > 0  
                        THEN                                                                                                                                                                       
                             ((NVL(YETA2000.SPCI_NAMT,0)  +                                                                                                                                          
                              ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM)) - NVL(YETA2000.SPCI_NAMT,0))
                        ELSE                                                                                                                                                                        
            NVL(YETA2000.SPCI_YAMT,0)                                                                                                                                              
                                     END                                                                                                                                                                         
                            END                                                                                                                                                                                  
                                                                                                                                                                                                                 
                      END)                                                                                                                                                                                       
                 ELSE                                                                                                                                                                                          
                     0                                                                                                                                                                                         
                 END)                                                                                                                                                                                          
          FROM YETA3000                                                                                                                                                                                         
          WHERE YETA2000.SYSTEMKEY= YETA3000.SYSTEMKEY                                                                                                                                                           
                AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                                                                      
                 AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD   
                   AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                                                                                     
                          ),                                                                                                                                                                                                     
   /* -- //종교단체외 기부금. */
       SPCI_NATG =   (SELECT  (CASE WHEN NVL(YETA2000.SPCI_NAMT,0) > 0                                                                                                                                                            
                            THEN                                                                                                                                                                                                 
       (CASE WHEN NVL(YETA2000.SPCI_YAMT,0) > 0                                                                                                                                                             
                  THEN                                                                                                                                                                                     
                    (CASE WHEN NVL(YETA2000.SPCI_NAMT,0) >                                                                                                                                                  
                               ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20)                                  
                    THEN                                                                                                                                                                                   
                                                                                                                                                                                                           
                          CASE WHEN NVL(YETA2000.SPCI_YAMT,0) > (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +
                                                       ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM))          
                                                        AND (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +   
                                                       ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM)) > 0      
                          THEN                                                                                                                                                                             
                              0                                                                                                                                                                            
                          ELSE                                                                                                                                                                             
                              CASE WHEN (NVL(YETA2000.SPCI_YAMT,0) + NVL(YETA2000.SPCI_NAMT,0)) >                                                                                                            
                                        (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +                       
                                        ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM))                         
                                         AND (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +                  
                                         ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM)) > 0                    
                                   THEN                                                                                                                                                                    
                                        ((((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +                      
                                        ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM)) - NVL(YETA2000.SPCI_YAMT,0))
                                   ELSE                                                                                                                                                                       
                                        NVL(YETA2000.SPCI_NAMT,0)                                                                                                                                             
                                   END                                                                                                                                                                        
                          END                                                                                                                                                                                 
                    ELSE                                                                                                                                                                                      
                          CASE WHEN NVL(YETA2000.SPCI_YAMT,0) > (NVL(YETA2000.SPCI_NAMT,0)  +                                                                                                                   
                                                               ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM))     
                                                                AND (NVL(YETA2000.SPCI_NAMT,0) +                                                                                                               
                                                              ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM)) > 0  
                          THEN                                                                                                                                                                                
                               0                                                                                                                                                                              
                          ELSE                                                                                                                                                                                
                               CASE WHEN (NVL(YETA2000.SPCI_YAMT,0) + NVL(YETA2000.SPCI_NAMT,0)) >                                                                                                              
                                         (NVL(YETA2000.SPCI_NAMT,0)  +                                                                                                                                         
                                                               ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM))     
                                                                AND (NVL(YETA2000.SPCI_NAMT,0) +                                                                                                               
                                                              ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM)) > 0  
                                   THEN                                                                                                                                                                       
                                        ((NVL(YETA2000.SPCI_NAMT,0)  +                                                                                                                                         
                                         ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM)) - NVL(YETA2000.SPCI_YAMT,0))
                                   ELSE                                                                                                                                                                        
                                        NVL(YETA2000.SPCI_NAMT,0)                                                                                                                                              
                                   END                                                                                                                                                                         
                          END                                                                                                                                                                                  
                                                                                                                                                                                                               
                    END)                                                                                                                                                                                       
              ELSE                                                                                                                                                                                             
                   (CASE  WHEN NVL(YETA2000.SPCI_NAMT,0) < (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.30) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM))           
                          THEN  NVL(YETA2000.SPCI_NAMT,0)                                                                                                                                                       
                          ELSE  (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.30) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM))                                     
                          END)                                                                                                                                                                                 
               END)                                                                                                                                                                                          
             ELSE                                                                                                                                                                                              
                 0                                                                                                                                                                                             
             END)                                                                                                                                                                                              
      FROM YETA3000                                                                                                                                                                                             
      WHERE YETA2000.SYSTEMKEY= YETA3000.SYSTEMKEY                                                                                                                                                               
            AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                                                                          
            AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD
              AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                                                                                            
     )             
		WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#	 
				]]>
	</update>
	 <!--  기부금공제 종교단체 및 종교단체외 2014년도 기부금대상금액  -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_09_03_Update">
		<![CDATA[
			 
    UPDATE YETA2000                                                                                                                                                                                                                   
            SET        
        /*    -- // 종교단체 기부금   SPCI_YATG  , SPCI_NATG*/                                                                                                                                                                                               
              SPCI_YA14 = (SELECT (CASE WHEN NVL(YETA2000.SPCI_OY14,0) > 0                                                                                                                                                       
                                        THEN                                                                                                                                                                                    
                                        (CASE WHEN NVL(YETA2000.SPCI_ON14,0) >                                                                                                                                                     
                                                   ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20)                                     
      THEN                                                                                                                                                                                      
       CASE WHEN NVL(YETA2000.SPCI_OY14,0) > (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +   
      ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG)) 
           AND (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +      
         ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20)  - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG)) > 0         
          THEN  (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +                                  
           ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG))                                      
           ELSE                                                                                                                                                                                
          CASE WHEN (NVL(YETA2000.SPCI_OY14,0) + NVL(YETA2000.SPCI_ON14,0)) >                                                                                                               
                             (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +                          
                             ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG))                            
                              AND (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +                     
                              ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG)) > 0                       
                        THEN                                                                                                                                                                       
                             ((((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +                         
                             ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG)) - NVL(YETA2000.SPCI_ON14,0))
                        ELSE                                                                                                                                                                       
                             NVL(YETA2000.SPCI_OY14,0)                                                                                                                                             
                        END                                                                                                                                                                        
               END                                                                                                                                                                                 
         ELSE                                                                                                                                                                                      
               CASE WHEN NVL(YETA2000.SPCI_OY14,0) > (NVL(YETA2000.SPCI_ON14,0)  +                                                                                                                   
                                                    ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG))     
                                                     AND (NVL(YETA2000.SPCI_ON14,0) +                                                                                                               
                                                   ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG)) > 0  
               THEN  (NVL(YETA2000.SPCI_ON14,0)  +                                                                                                                                                  
                                            ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG))             
               ELSE                                                                                                                                                                                
                    CASE WHEN (NVL(YETA2000.SPCI_OY14,0) + NVL(YETA2000.SPCI_ON14,0)) >                                                                                                              
                              (NVL(YETA2000.SPCI_ON14,0)  +                                                                                                                                         
                                                    ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG))     
                                                     AND (NVL(YETA2000.SPCI_ON14,0) +                                                                                                               
                                                   ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG)) > 0  
                        THEN                                                                                                                                                                       
                             ((NVL(YETA2000.SPCI_ON14,0)  +                                                                                                                                          
                              ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG)) - NVL(YETA2000.SPCI_ON14,0))
                        ELSE                                                                                                                                                                        
            NVL(YETA2000.SPCI_OY14,0)                                                                                                                                              
                                     END                                                                                                                                                                         
                            END                                                                                                                                                                                  
                                                                                                                                                                                                                 
                      END)                                                                                                                                                                                       
                 ELSE                                                                                                                                                                                          
                     0                                                                                                                                                                                         
                 END)                                                                                                                                                                                          
          FROM YETA3000                                                                                                                                                                                         
          WHERE YETA2000.SYSTEMKEY= YETA3000.SYSTEMKEY                                                                                                                                                           
                AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                                                                      
                 AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD   
                   AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                                                                                     
                          ),                                                                                                                                                                                                     
   /* -- //종교단체외 기부금. */
       SPCI_NA14 =   (SELECT  (CASE WHEN NVL(YETA2000.SPCI_ON14,0) > 0                                                                                                                                                            
                            THEN                                                                                                                                                                                                 
       (CASE WHEN NVL(YETA2000.SPCI_OY14,0) > 0                                                                                                                                                             
                  THEN                                                                                                                                                                                     
                    (CASE WHEN NVL(YETA2000.SPCI_ON14,0) >                                                                                                                                                  
                               ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20)                                  
                    THEN                                                                                                                                                                                   
                                                                                                                                                                                                           
                          CASE WHEN NVL(YETA2000.SPCI_OY14,0) > (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +
                                                       ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG))          
                                                        AND (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +   
                                                       ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG)) > 0      
                          THEN                                                                                                                                                                             
                              0                                                                                                                                                                            
                          ELSE                                                                                                                                                                             
                              CASE WHEN (NVL(YETA2000.SPCI_OY14,0) + NVL(YETA2000.SPCI_ON14,0)) >                                                                                                            
                                        (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +                       
                                        ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG))                         
                                         AND (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +                  
                                         ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG)) > 0                    
                                   THEN                                                                                                                                                                    
                                        ((((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) +                      
                                        ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.20) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG)) - NVL(YETA2000.SPCI_OY14,0))
                                   ELSE                                                                                                                                                                       
                                        NVL(YETA2000.SPCI_ON14,0)                                                                                                                                             
                                   END                                                                                                                                                                        
                          END                                                                                                                                                                                 
                    ELSE                                                                                                                                                                                      
                          CASE WHEN NVL(YETA2000.SPCI_OY14,0) > (NVL(YETA2000.SPCI_ON14,0)  +                                                                                                                   
                                                               ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG))     
                                                                AND (NVL(YETA2000.SPCI_ON14,0) +                                                                                                               
                                                              ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG)) > 0  
                          THEN                                                                                                                                                                                
                               0                                                                                                                                                                              
                          ELSE                                                                                                                                                                                
                               CASE WHEN (NVL(YETA2000.SPCI_OY14,0) + NVL(YETA2000.SPCI_ON14,0)) >                                                                                                              
                                         (NVL(YETA2000.SPCI_ON14,0)  +                                                                                                                                         
                                                               ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG))     
                                                                AND (NVL(YETA2000.SPCI_ON14,0) +                                                                                                               
                                                              ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG)) > 0  
                                   THEN                                                                                                                                                                       
                                        ((NVL(YETA2000.SPCI_ON14,0)  +                                                                                                                                         
                                         ((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.10) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG)) - NVL(YETA2000.SPCI_OY14,0))
                                   ELSE                                                                                                                                                                        
                                        NVL(YETA2000.SPCI_ON14,0)                                                                                                                                              
                                   END                                                                                                                                                                         
                          END                                                                                                                                                                                  
                                                                                                                                                                                                               
                    END)                                                                                                                                                                                       
              ELSE                                                                                                                                                                                             
                   (CASE  WHEN NVL(YETA2000.SPCI_ON14,0) < (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.30) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG))           
                          THEN  NVL(YETA2000.SPCI_ON14,0)                                                                                                                                                       
                          ELSE  (((YETA3000.WKER_AMNT - YETA2000.SPCI_PLTG - YETA3000.SPCI_OBAM - YETA2000.SPCI_FBTG   - NVL(YETA3000.SPCI_ONON,0) - YETA3000.ETCK_UNCR ) * 0.30) - (YETA3000.SPCI_OYAM + YETA3000.SPCI_ONAM) - (YETA2000.SPCI_YATG + YETA2000.SPCI_NATG))                                     
                          END)                                                                                                                                                                                 
               END)                                                                                                                                                                                          
             ELSE                                                                                                                                                                                              
                 0                                                                                                                                                                                             
             END)                                                                                                                                                                                              
      FROM YETA3000                                                                                                                                                                                             
      WHERE YETA2000.SYSTEMKEY= YETA3000.SYSTEMKEY                                                                                                                                                               
            AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                                                                          
            AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD
              AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                                                                                            
     )                 
		WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#	 
				]]>
	</update> 
	
	   <!--  기부금공제 3 -->
	  <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_10_Update">
		<![CDATA[
			       UPDATE YETA3000                                                                                                                                   
                   SET    
 /*  // 법정기부금.  세액공제 */   
                SPCI_FBAM = (SELECT (CASE WHEN (NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0) + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                             + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)) <= 30000000      
                                                               THEN (((NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0) + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                             + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)) * 0.15) * 
                                                                            ( CASE WHEN (NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0)
                                                                                                                                        + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                                                                                        + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)) <= 0
                                                                              THEN 0 
                                                                              ELSE                                                             
                                                                              ((NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0)) / (NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0)
                                                                                                                                        + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                                                                                        + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)))
                                                                              END))                                              
                                                               ELSE  (((30000000 * 0.15) + 
                                                                     (((NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0) + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                             + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0))  - 30000000) * 0.25)) * 
                                                                              ( CASE WHEN (NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0)
                                                                                                                                        + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                                                                                        + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)) <= 0
                                                                              THEN 0 
                                                                              ELSE  
                                                                              ((NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0)) / (NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0)
                                                                                                                                        + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                                                                                        + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)))
                                                                                                                                        END)) 
                                                               END)                                                                                                 
                                                         FROM YETA2000                                                                                              
                                                          WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                               
                                                            AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                              
                                                            AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD       
                                                              AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                         
                                                        ) ,
  /*  // 우리사주조.  세액공제 */
                 SPCI_RFAM =  (SELECT (CASE WHEN (NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0) + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                             + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)) <= 30000000      
                                                               THEN (((NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0) + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                             + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)) * 0.15) *
                                                                              ( CASE WHEN (NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0)
                                                                                                                                        + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                                                                                        + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)) <= 0
                                                                              THEN 0 
                                                                              ELSE   
                                                                              ((NVL(YETA2000.SPCI_HFTG,0)) / (NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0)
                                                                                                                                        + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                                                                                        + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)))
                                                                                                                                        END))                                              
                                                               ELSE  (((30000000 * 0.15) + 
                                                                     (((NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0) + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                             + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0))  - 30000000) * 0.25)) * 
                                                                              ( CASE WHEN (NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0)
                                                                                                                                        + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                                                                                        + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)) <= 0
                                                                              THEN 0 
                                                                              ELSE  
                                                                              ((NVL(YETA2000.SPCI_HFTG,0)) / (NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0)
                                                                                                                                        + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                                                                                        + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)))
                                                                                                                                        END)) 
                                                               END)                                                                                               
                                                         FROM YETA2000                                                                                         
                                                          WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                        
                                                            AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                       
                                                            AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD  
                                                              AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                         
                                                       ) ,                                                                                                                                                                                                                                                                   
 /*  // 종교단체 기부금.  세액공제 */
                 SPCI_YAMT = (SELECT (CASE WHEN (NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0) + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                             + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)) <= 30000000      
                                                               THEN (((NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0) + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                             + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)) * 0.15) * 
                                                                              ( CASE WHEN (NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0)
                                                                                                                                        + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                                                                                        + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)) <= 0
                                                                              THEN 0 
                                                                              ELSE  
                                                                              ((NVL(YETA2000.SPCI_YATG,0) + NVL(YETA2000.SPCI_YA14,0)) / (NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0)
                                                                                                                                        + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                                                                                        + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)))
                                                                                                                                        END))                                              
                                                               ELSE  (((30000000 * 0.15) + 
                                                                     (((NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0) + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                             + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0))  - 30000000) * 0.25)) * 
                                                                              ( CASE WHEN (NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0)
                                                                                                                                        + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                                                                                        + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)) <= 0
                                                                              THEN 0 
                                                                              ELSE  
                                                                              ((NVL(YETA2000.SPCI_YATG,0) + NVL(YETA2000.SPCI_YA14,0)) / (NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0)
                                                                                                                                        + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                                                                                        + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)))
                                                                                                                                        END)) 
                                                               END)                                         
                                                         FROM YETA2000                                                                                         
                                                          WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                        
                                                            AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                       
                                                            AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD  
                                                              AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                         
                                                       ) ,                                                     

 /*  // 종교단체외  기부금.  세액공제 */
                  SPCI_NAMT = (SELECT (CASE WHEN (NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0) + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                             + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)) <= 30000000      
                                                               THEN (((NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0) + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                             + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)) * 0.15) * 
                                                                              ( CASE WHEN (NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0)
                                                                                                                                        + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                                                                                        + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)) <= 0
                                                                              THEN 0 
                                                                              ELSE  
                                                                              ((NVL(YETA2000.SPCI_NATG,0) + NVL(YETA2000.SPCI_NA14,0)) / (NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0)
                                                                                                                                        + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                                                                                        + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)))
                                                                                                                                        END))                                              
                                                               ELSE  (((30000000 * 0.15) + 
                                                                     (((NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0) + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                             + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0))  - 30000000) * 0.25)) * 
                                                                              ( CASE WHEN (NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0)
                                                                                                                                        + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                                                                                        + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)) <= 0
                                                                              THEN 0 
                                                                              ELSE  
                                                                              ((NVL(YETA2000.SPCI_NATG,0) + NVL(YETA2000.SPCI_NA14,0)) / (NVL(YETA2000.SPCI_FBTG,0) + NVL(YETA2000.SPCI_FB14,0)
                                                                                                                                        + NVL(YETA2000.SPCI_HFTG,0) + NVL(YETA2000.SPCI_YATG,0)
                                                                                                                                        + NVL(YETA2000.SPCI_NATG,0)+ NVL(YETA2000.SPCI_YA14,0)+ NVL(YETA2000.SPCI_NA14,0)))
                                                                                                                                        END)) 
                                                               END)                                                                            
                                                         FROM YETA2000                                                                        
                                                          WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                       
                                                            AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                       
                                                            AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD    
                                                            AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                     
                                                       )                                         
 						WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#	 
				]]>
	</update> 
	  
	   <!--  공제대상 계 구하는 부분  -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR415_ReTax_2014_CREATE_12_1_Update">
		<![CDATA[
		    	 UPDATE YETA2000                                                                                                                                                                         
                            SET                                                                                                                                                                  
                            /* --JRTR_TOTR IS '연금계좌 공제대상 계    */                                                                                                                                  
      						JRTR_TOTR = NVL(JRTR_CTAR, 0) + NVL(JRTR_PTAR, 0) + NVL(JRTR_ATAR, 0) ,          
                            /* --SPCI_DETG IS '특별공제_보장성보험료대상 계    */                                                                                                                             
                                 SPCI_DETG = NVL(SPCI_RTTG, 0) + NVL(SPCI_HDTG, 0) ,                              

  
                            /* --SPED_ETAR IS '특별공제_교육비 대상금액 계  */                                                                                                                                   
                                   SPED_ETAR = NVL(SPED_SFTR, 0) + NVL(SPED_EDTR, 0) + NVL(SPED_GDTR, 0) + NVL(SPED_CVTR, 0) + NVL(SPCI_SCTR, 0),                                                

                           /*   --SPCI_DGTG IS '특별공제)기부금공제대상 금액 계   */                                                                                                                             
                            SPCI_DGTG = (NVL(TAXD_10TG, 0)  + NVL(SPCI_PLTG, 0)  + NVL(SPCI_FBTG, 0) + NVL(SPCI_FB14, 0) 
                                        + NVL(SPCI_HFTG, 0) + NVL(SPCI_EXTG, 0)   + NVL(SPCI_UNTG, 0)  
      						                      + NVL(SPCI_YA14, 0)  + NVL(SPCI_NA14, 0)  + NVL(SPCI_NATG, 0)  + NVL(SPCI_YATG, 0)) 
                  WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#	 
		 ]]>
	  </update>
	   
	  <!-- 공제계  합산 부분 구하는 부분 - 여기부터 다시적용 하는 부분 이전에 0처리 할 부분 처리 하고 이곳호출  -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_12_Update">
		<![CDATA[
			           UPDATE YETA3000                                                                                                                                                                         
                            SET                                                                                                                                                                  
                           /* --RRPT_YNAM IS '연금보험료공제계  */                                                                                                                                    
                              RRPT_YNAM = NVL(BNAT_DDCT, 0) + NVL(JNAT_DDCT, 0) + NVL(BPSS_HPUL, 0)  + NVL(BPSS_HSOL, 0)  + NVL(BPSS_HTEC, 0)    
                             + NVL(BPSS_DDCT, 0) +  NVL(JPSS_HPUL, 0)  + NVL(JPSS_HSOL, 0)  + NVL(JPSS_HTEC, 0)   + NVL(JPSS_DDCT, 0) ,                            

                           /*  --SPCI_HRTO IS '특별공제_보험료공제계  */                                                                                                                               
                                 SPCI_HRTO = NVL(SPCI_BHTH, 0) + NVL(SPCI_JHTH, 0) + NVL(SPCI_BEPF, 0) + NVL(SPCI_JEPF, 0),                              

                           /*  -- SPCH_RETO 주택자금공제액계 */                                                                                                                                        
                            SPCH_RETO = NVL(SPCH_RE15, 0) + NVL(SPCH_RE29, 0) + NVL(SPCH_RE30, 0) + NVL(SPCI_REFN, 0) 
                            +  NVL(SPCI_RESF,0)  + NVL(SPCI_REFX, 0)+ NVL(SPCI_REEC, 0) + NVL(SPCI_15FX, 0)+ NVL(SPCI_15FB, 0)+ NVL(SPCI_15EC, 0)+ NVL(SPCI_10FB, 0), 
                            /*  --SPCI_SSUM IS '특별공제)이전 년도 기부금세액 공제계 */                                                                                                                            
                            SPCI_SSUM =  NVL(SPCI_OBAM, 0)  + NVL(SPCI_ONON, 0)  + NVL(SPCI_OYAM, 0)  + NVL(SPCI_ONAM, 0)     
 							  WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#	  
				]]>
	</update>
	  
	   
	   <!-- 차감소득에 의한 값계산 차감소득금액 
	   -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_10_3_Update">
		<![CDATA[
		 UPDATE YETA3000                                                                                                                                                                         
                            SET              
            /*  --SUBT_ERAM IS '차감소득금액 */                                                                                                                       
        SUBT_ERAM = (CASE WHEN (WKER_AMNT - (BASE_SELF + BASE_WIFE + BASE_FYAM + ADDR_HDAM + ADDR_RPT70 + ADDR_FAME + PANT_ONAM )              
                             - RRPT_YNAM -   ( SPCI_HRTO + SPCH_RETO + SPCI_SSUM))  < 0 THEN 0                                                                                       
                                           ELSE                                                                                                                      
                    (WKER_AMNT - (BASE_SELF + BASE_WIFE + BASE_FYAM + ADDR_HDAM + ADDR_RPT70 + ADDR_FAME + PANT_ONAM )              
                             - RRPT_YNAM -   ( SPCI_HRTO + SPCH_RETO + SPCI_SSUM)) END)  
         WHERE DPOB_CD=#dpobCd#
                                AND EDAC_RVYY=#edacRvyy#
                                AND SETT_GBCD=#settGbcd#
                                 AND SYSTEMKEY=#systemkey#	                       
				]]>
	</update>
	 
	   <!--  그밖의 소득공제 계  -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_13_Update">
		<![CDATA[
			  UPDATE YETA3000                                                                                                                                                         
                          SET                                            
                             /* --PRCM_TOAM IS '연금저축공제액계  NVL(ETCP_NSAV ,0) +  */                                                                                                                                   
                            PRCM_TOAM = 0 ,                                                                                                                 
                             /* --ETGD_DDAM IS '투자조합출자금액계  */                                                                                                                         
                            ETGD_DDAM =  NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0) ,                                                                                                                  
                            /* --ETCD_TSUM IS '기타공제)공제계   */                                                                                                                                    
                            ETCD_TSUM = ((nvl(ETCP_PSNV,0)  + nvl(ETCH_PREP,0) + nvl(ETWK_BDAM,0) + nvl(ETGD_D14F,0) + NVL(ETGD_D15F, 0) 
                              + nvl(ETGD_HTRA,0)+ nvl(ETEP_SECR,0)   
                              + nvl(ETGD_09AF,0)  + nvl(ETGD_H13H,0) + nvl(ETCC_CARD,0) + nvl(ETCK_UNON,0) + nvl(ETCK_UNCR,0) + nvl(ETEP_MSAM,0))) 
			       WHERE DPOB_CD=#dpobCd#
                     AND EDAC_RVYY=#edacRvyy#
                     AND SETT_GBCD=#settGbcd#
                     AND SYSTEMKEY=#systemkey#	
				]]>
	</update>
	<!--   ETCD_TSUM = (CASE WHEN SUBT_ERAM < ((nvl(ETCP_PSNV,0)  + nvl(ETCH_PREP,0) + nvl(ETWK_BDAM,0) + nvl(ETGD_D14F,0) + NVL(ETGD_D15F, 0) 
                              + nvl(ETGD_HTRA,0)+ nvl(ETEP_SECR,0)   
                              + nvl(ETGD_09AF,0)  + nvl(ETGD_H13H,0) + nvl(ETCC_CARD,0) + nvl(ETCK_UNON,0) + nvl(ETCK_UNCR,0) + nvl(ETEP_MSAM,0))) THEN SUBT_ERAM
                              ELSE ((nvl(ETCP_PSNV,0)  + nvl(ETCH_PREP,0) + nvl(ETWK_BDAM,0) + nvl(ETGD_D14F,0) + NVL(ETGD_D15F, 0) 
                              + nvl(ETGD_HTRA,0)+ nvl(ETEP_SECR,0)   
                              + nvl(ETGD_09AF,0)  + nvl(ETGD_H13H,0) + nvl(ETCC_CARD,0) + nvl(ETCK_UNON,0) + nvl(ETCK_UNCR,0) + nvl(ETEP_MSAM,0))) END)   -->
	  <!-- 특별공제 종합한도초과액   기타공제계 
	   -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_13_4_Update">
		<![CDATA[
			  UPDATE YETA3000                                                                                                                                                         
                          SET                                            
                              /* --SPCH_EXLI IS 특별공제한도초과액  */                                                                                                                                  
                             SPCH_EXLI = CASE WHEN ((NVL(SPCH_RETO,0) + NVL(ETCH_PREP ,0)  + (NVL(ETWK_BDAM,0) + (NVL(ETGD_DDAM,0)  ))      
                                        + NVL(ETCC_CARD,0) + NVL(ETCK_UNON,0) + NVL(ETEP_SECR,0)) - 25000000)   <= 0     
                     THEN  0 ELSE ((NVL(SPCH_RETO,0) + NVL(ETCH_PREP ,0)  + (NVL(ETWK_BDAM,0) + (NVL(ETGD_DDAM,0)  ))    
                                        + NVL(ETCC_CARD,0) + NVL(ETCK_UNON,0) + NVL(ETEP_SECR,0)) - 25000000)  END 
                     WHERE DPOB_CD=#dpobCd#
                       AND EDAC_RVYY=#edacRvyy#
                       AND SETT_GBCD=#settGbcd#
                       AND SYSTEMKEY=#systemkey#	                      
				]]>
	</update>
	  
	   <!--  종합소득과세표준  기타공제계  -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_13_1_Update">
		<![CDATA[
			  UPDATE YETA3000                                                                                                                                                         
                          SET                                            
                          /* --STND_INCM IS '종합소득과세표준      */                                                                                                              
                           STND_INCM =  (CASE WHEN   (NVL(SUBT_ERAM,0) -   NVL(ETCD_TSUM,0))   < 0 THEN 0                      
                                              ELSE                                                      
                                           (NVL(SUBT_ERAM,0) -  NVL(ETCD_TSUM,0)  + NVL(SPCH_EXLI,0)) END)  
                   WHERE DPOB_CD=#dpobCd#
                        AND EDAC_RVYY=#edacRvyy#
                        AND SETT_GBCD=#settGbcd#
                         AND SYSTEMKEY=#systemkey#	                           
				]]>
	</update>
	   <!--  산출세액- 기타공제계  -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_13_2_Update">
		<![CDATA[
			   UPDATE YETA3000                                                                                                                                                         
                          SET                                            
                         /* --PRDD_TAXN IS '산출세액 */                                                                                                                           
         PRDD_TAXN =  (CASE WHEN    
                             TRUNC(                                                                                                                           
                                      CASE WHEN  STND_INCM <= 12000000  THEN  (STND_INCM * 0.06 )                              
                                           WHEN  STND_INCM <= 46000000  THEN  ((STND_INCM * 0.15) - 1080000)    
                                           WHEN  STND_INCM <= 88000000  THEN  (( STND_INCM  * 0.24) - 5220000 )      
                                           WHEN  STND_INCM <= 150000000 THEN  (( STND_INCM * 0.35) - 14900000 )    
                                      ELSE   (( STND_INCM * 0.38) - 19400000 )  END)  < 0    
                      THEN 0                                                                                          
                      ELSE                                                                              
                              TRUNC(                                                                                                                                  
                                        CASE WHEN  STND_INCM <= 12000000  THEN  (STND_INCM * 0.06 )                              
                                           WHEN  STND_INCM <= 46000000  THEN  ((STND_INCM * 0.15) - 1080000)    
                                           WHEN  STND_INCM <= 88000000  THEN  (( STND_INCM  * 0.24) - 5220000 )      
                                           WHEN  STND_INCM <= 150000000 THEN  (( STND_INCM * 0.35) - 14900000 )    
                                      ELSE   (( STND_INCM * 0.38) - 19400000 )  END)   
                     END)   
                      WHERE DPOB_CD=#dpobCd#
                        AND EDAC_RVYY=#edacRvyy#
                        AND SETT_GBCD=#settGbcd#
                         AND SYSTEMKEY=#systemkey#	 
				]]>
	</update>
	  
	   <!--  산출세액-세액감면  -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_14_TX_Update">
		<![CDATA[
			    UPDATE YETA3000                                                                                                                                                         
                          SET    TEMP_PRDD_TAXN  =      PRDD_TAXN   ,                                        
                         /* --TAXD_ICAX IS '소득세법  */                                                                                                                          
         TAXD_ICAX = (SELECT (CASE WHEN (YETA2000.TXLG_ITCT > 0) AND (YETA3000.PRDD_TAXN < YETA2000.TXLG_ITCT)  
                      THEN YETA3000.PRDD_TAXN                                                                                          
                      ELSE YETA2000.TXLG_ITCT                                                                           
                        END)   
                FROM YETA2000                                                           
          WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                 
            AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                  
            AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD
             AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD   ) ,                               
                         /* --TAXD_SPCT IS '외국인조세조약 -이건나중에 다시 적용   */                                                                                                                         
         TAXD_SPCT =  ( SELECT YETA2000.TXLG_FRTA   
                FROM YETA2000                                                           
          WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                 
            AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                  
            AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD
             AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD   ) ,                               
                       /* --TXLG_CL30 IS '조세특례법제30조 */                                                                                                                           
         TXLG_CL30 = (SELECT (CASE WHEN YETA3000.PRDD_TAXN < DECODE(YETA2000.TXLG_WKTA,0,0,ROUND((YETA3000.PRDD_TAXN * ((YETA2000.TXLG_BSTA / YETA2000.TXLG_WKTA) * (
                             (CASE WHEN TXLG_BSCD IS NULL OR TXLG_BSCD = '' THEN 0 
                             ELSE (CASE WHEN TXLG_BSCD < '20140101' THEN 1 ELSE 0.5 END) END ) ))),0))   
                      THEN YETA3000.PRDD_TAXN                                                                                          
                      ELSE                                                                              
                          DECODE(YETA2000.TXLG_WKTA,0,0,ROUND((YETA3000.PRDD_TAXN * ((YETA2000.TXLG_BSTA / YETA2000.TXLG_WKTA) * (
                             (CASE WHEN TXLG_BSCD IS NULL OR TXLG_BSCD = '' THEN 0 
                             ELSE (CASE WHEN TXLG_BSCD < '20140101' THEN 1 ELSE 0.5 END) END ) ))),0))      
                     END)   
                FROM YETA2000                                                           
          WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                 
            AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                  
            AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD 
             AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD  ) ,                               

          /* --TXLG_HXTT IS '조세조약  */                                                                                                                          
         TXLG_HXTT = (SELECT (CASE WHEN YETA3000.PRDD_TAXN < YETA2000.TXLG_TXTY  
                      THEN YETA3000.PRDD_TAXN                                                                                          
                      ELSE   YETA2000.TXLG_TXTY                                                                           
                        END)   
                FROM YETA2000                                                           
          WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                 
            AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                  
            AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD
             AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD   )                               
			   WHERE DPOB_CD=#dpobCd#
                        AND EDAC_RVYY=#edacRvyy#
                        AND SETT_GBCD=#settGbcd#
                         AND SYSTEMKEY=#systemkey#	 
				]]>
	</update>
	  <!--  세액공제 -근로소득공제 감면세액계 -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_14_Update">
		<![CDATA[
			   UPDATE YETA3000                                                                                                                                  
   SET                                 
   
    /*  --TAXD_WKEN IS '세액공제)근로소득  */                                                                                            
      TAXD_WKEN  = CASE WHEN TXLG_CL30 > 0 THEN  (CASE WHEN  TOTL_SALA <= 33000000 THEN                                                                                        
                                              TRUNC((CASE WHEN NVL(PRDD_TAXN,0) <= 1300000                                                                                          
                                                      THEN CASE WHEN (NVL(PRDD_TAXN,0) * 0.55) > 740000 THEN 740000 ELSE  (NVL(PRDD_TAXN,0) * 0.55) END                        
                                                      ELSE                                                                                                                     
                                                       CASE WHEN (((NVL(PRDD_TAXN,0)  - 1300000) * 0.30) +715000) > 740000                                                      
                                                       THEN 740000                                                                                                              
                                                       ELSE (((NVL(PRDD_TAXN,0)  - 1300000) * 0.30) +715000)                                                                     
                                                       END  END)  ) * ( 1- (NVL(TXLG_CL30,0) / NVL(PRDD_TAXN,0)))                                                                                                               
                                          WHEN  TOTL_SALA <= 70000000 THEN                                                                                                                     
                                               TRUNC((CASE WHEN NVL(PRDD_TAXN,0) <= 1300000                                                                                           
                                                      THEN CASE WHEN (NVL(PRDD_TAXN,0) * 0.55) > (CASE WHEN (740000 - ((TOTL_SALA - 33000000) * 0.008))  < 660000 THEN 660000     
                                                                                                       ELSE (740000 - ((TOTL_SALA - 33000000) * 0.008))  END)                     
                                                                THEN  (CASE WHEN (740000 - ((TOTL_SALA - 33000000) * 0.008))  < 660000 THEN 660000                                
                                                                            ELSE (740000 - ((TOTL_SALA - 33000000) * 0.008))  END)                                                
                                                                ELSE  (NVL(PRDD_TAXN,0) * 0.55) END                                                                                             
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(PRDD_TAXN,0)  - 1300000) * 0.30) +715000) > (CASE WHEN (740000 - ((TOTL_SALA - 33000000) * 0.008))  < 660000 THEN 660000   
                                                                                                                         ELSE (740000 - ((TOTL_SALA - 33000000) * 0.008))  END)                   
                                                       THEN (CASE WHEN (740000 - ((TOTL_SALA - 33000000) * 0.008))  < 660000 THEN 660000                                                          
                                                                            ELSE (740000 - ((TOTL_SALA - 33000000) * 0.008))  END)                                                                
                                                       ELSE (((NVL(PRDD_TAXN,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  ) * ( 1- (NVL(TXLG_CL30,0) / NVL(PRDD_TAXN,0)))                                                                                                                                
                                         ELSE                                                                                                                                                                  
                                          TRUNC((CASE WHEN NVL(PRDD_TAXN,0) <= 1300000                                                                                                           
                                                      THEN CASE WHEN (NVL(PRDD_TAXN,0) * 0.55) > (CASE WHEN (660000 - ((TOTL_SALA - 70000000) * 0.5))  < 500000 THEN 500000                     
                                                                                                       ELSE (660000 - ((TOTL_SALA - 70000000) * 0.5))  END)                                     
                                                                THEN (CASE WHEN (660000 - ((TOTL_SALA - 70000000) * 0.5))  < 500000 THEN 500000                                                 
                                                                                                       ELSE (660000 - ((TOTL_SALA - 70000000) * 0.5))  END)                                     
                                                                ELSE  (NVL(PRDD_TAXN,0) * 0.55)  END                                                                                            
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(PRDD_TAXN,0)  - 1300000) * 0.30) +715000) > (CASE WHEN (660000 - ((TOTL_SALA - 70000000) * 0.5))  < 500000 THEN 500000   
                                                                                                                        ELSE (660000 - ((TOTL_SALA - 70000000) * 0.5))  END)                    
                                                       THEN (CASE WHEN (660000 - ((TOTL_SALA - 70000000) * 0.5))  < 500000 THEN 500000                                                          
                                                                                                       ELSE (660000 - ((TOTL_SALA - 70000000) * 0.5))  END)                                     
                                                       ELSE (((NVL(PRDD_TAXN,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  ) * ( 1- (NVL(TXLG_CL30,0) / NVL(PRDD_TAXN,0)))                                                                                     
                                           END  )                                                                                                                                                                
                               ELSE  (CASE WHEN  TOTL_SALA <= 33000000 THEN                                                                                                    
                                          TRUNC((CASE WHEN NVL(PRDD_TAXN,0) <= 1300000                                                                                                           
                                                      THEN CASE WHEN (NVL(PRDD_TAXN,0) * 0.55) > 740000 THEN 740000 ELSE  (NVL(PRDD_TAXN,0) * 0.55) END                                         
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(PRDD_TAXN,0)  - 1300000) * 0.30) +715000) > 740000                                                                       
                                                       THEN 740000                                                                                                                              
                                                       ELSE (((NVL(PRDD_TAXN,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  )                                                                                                                             
                                       WHEN  TOTL_SALA <= 70000000 THEN                                                                                                                                     
                                          TRUNC((CASE WHEN NVL(PRDD_TAXN,0) <= 1300000                                                                                                           
                                                      THEN CASE WHEN (NVL(PRDD_TAXN,0) * 0.55) > (CASE WHEN (740000 - ((TOTL_SALA - 33000000) * 0.008))  < 660000 THEN 660000                     
                                                                                                       ELSE (740000 - ((TOTL_SALA - 33000000) * 0.008))  END)                                     
                                                                THEN  (CASE WHEN (740000 - ((TOTL_SALA - 33000000) * 0.008))  < 660000 THEN 660000                                                
                                                                            ELSE (740000 - ((TOTL_SALA - 33000000) * 0.008))  END)                                                                
                                                                ELSE  (NVL(PRDD_TAXN,0) * 0.55) END                                                                                             
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(PRDD_TAXN,0)  - 1300000) * 0.30) +715000) > (CASE WHEN (740000 - ((TOTL_SALA - 33000000) * 0.008))  < 660000 THEN 660000   
                                                                                                                         ELSE (740000 - ((TOTL_SALA - 33000000) * 0.008))  END)                   
                                                       THEN (CASE WHEN (740000 - ((TOTL_SALA - 33000000) * 0.008))  < 660000 THEN 660000                                                          
                                                                            ELSE (740000 - ((TOTL_SALA - 33000000) * 0.008))  END)                                                                
                                                       ELSE (((NVL(PRDD_TAXN,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  )                                                                                                                             
                                      ELSE                                                                                                                                                                  
                                          TRUNC((CASE WHEN NVL(PRDD_TAXN,0) <= 1300000                                                                                                           
                                                      THEN CASE WHEN (NVL(PRDD_TAXN,0) * 0.55) > (CASE WHEN (660000 - ((TOTL_SALA - 70000000) * 0.5))  < 500000 THEN 500000                     
                                                                                                       ELSE (660000 - ((TOTL_SALA - 70000000) * 0.5))  END)                                     
                                                                THEN (CASE WHEN (660000 - ((TOTL_SALA - 70000000) * 0.5))  < 500000 THEN 500000                                                 
                                                                                                       ELSE (660000 - ((TOTL_SALA - 70000000) * 0.5))  END)                                     
                                                                ELSE  (NVL(PRDD_TAXN,0) * 0.55)  END                                                                                            
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(PRDD_TAXN,0)  - 1300000) * 0.30) +715000) > (CASE WHEN (660000 - ((TOTL_SALA - 70000000) * 0.5))  < 500000 THEN 500000   
                                                                                                                        ELSE (660000 - ((TOTL_SALA - 70000000) * 0.5))  END)                    
                                                       THEN (CASE WHEN (660000 - ((TOTL_SALA - 70000000) * 0.5))  < 500000 THEN 500000                                                          
                                                                                                       ELSE (660000 - ((TOTL_SALA - 70000000) * 0.5))  END)                                     
                                                       ELSE (((NVL(PRDD_TAXN,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  )                                                                                                                             
                         END  ) END,                                                                                                                                                            
                                                       
  /*  납세조합공제   */                                                                                                                                                                                                   
         TAXD_UNIN = (SELECT CASE WHEN  YETA2000.TAXD_UNIN  >=  YETA3000.PRDD_TAXN                                                                                                                             
                                 THEN YETA3000.PRDD_TAXN                                                                                                                                                                    
                                 ELSE YETA2000.TAXD_UNIN                                                                                                                                                         
                                 END                                                                                                                                                                       
                       FROM YETA2000                                                                                                                                                                        
                       WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                                                                         
                         AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                                                                         
                         AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD
                         AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                                                                          
                   )                                                                                                                                                                                     
			  WHERE DPOB_CD=#dpobCd#
                        AND EDAC_RVYY=#edacRvyy#
                        AND SETT_GBCD=#settGbcd#
                         AND SYSTEMKEY=#systemkey#	 
				]]>
	</update>
	   <!--  세액공제 주택차입금  -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_14_1_Update">
		<![CDATA[
			   UPDATE YETA3000                                 
          SET    
                TAXD_LOAN = (SELECT TRUNC(NVL(YETA2000.TAXD_LOAA,0) * (0.3))                                                 
                              FROM YETA2000                                                                                                                     
                              WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                                                                                        
                                AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                                                                                        
                                AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD   
                                 AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                                                                                      
                          ),                                                                                                                                       
   /* 세액감면 및 세액공제 - 외국납부 TODO  PRDD_TAXN  Txlg_Inam    WKER_AMNT */
              TAXD_PAID = (SELECT CASE WHEN YETA2000.TXLG_WNAM  <= 0           
              THEN 0                                                                                                                                                                                                   
              ELSE   CASE WHEN (YETA3000.PRDD_TAXN * (YETA2000.TXLG_INAM /YETA3000.TOTL_SALA)) > YETA2000.TXLG_WNAM                                                                                                  
                                          THEN  YETA2000.TXLG_WNAM                                                                                                                                                         
                                          ELSE  TRUNC((YETA3000.PRDD_TAXN * (YETA2000.TXLG_INAM / YETA3000.TOTL_SALA))) END                                                                                            
              END                                                  
                               FROM YETA2000                                                  
                             WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                      
                                AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                     
                                AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD    
                                 AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD                
                          )                                                                  
                      WHERE DPOB_CD=#dpobCd#
                        AND EDAC_RVYY=#edacRvyy#
                        AND SETT_GBCD=#settGbcd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</update>
	    <!-- 특별공제)특별세액공제 계 표준세액 공제   -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_BEF_12_1_Update">
		<![CDATA[
			     UPDATE YETA3000                   
                  SET    
                            /* --SPCI_RTDE IS '특별공제_보장성 보험료공제계 */                                                                                                                                
                             SPCI_RTDE = NVL(SPCI_GURT, 0) + NVL(SPCI_HDRC, 0)  ,                              

                            /* --SPCI_METO IS '특별공제_교육비계  */                                                                                                                                   
                               SPED_TXCR = NVL(SPED_SELF, 0) + NVL(SPED_GRDE, 0) + NVL(SPED_GDTO, 0) + NVL(SPED_CLDV, 0) + NVL(SPCI_SPEC, 0)                                                
			        WHERE DPOB_CD=#dpobCd#
                        AND EDAC_RVYY=#edacRvyy#
                        AND SETT_GBCD=#settGbcd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</update>

	   
	   <!--  특별공제)특별세액공제 계 표준세액 공제    -->
	  <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_BEF01_12_1_Update">
		<![CDATA[
			  UPDATE YETA3000                                                                                                                                                                         
           SET     
                 /* --SPCI_DDCT IS '특별공제)표준세액공제 - 유리한쪽으로 계산하려면 수정필요 */                                                                                                                                    
            SPCI_DDCT =  #spciDdct#
            WHERE DPOB_CD=#dpobCd#
                        AND EDAC_RVYY=#edacRvyy#
                        AND SETT_GBCD=#settGbcd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</update>
             <!--  ( CASE 
				           WHEN ((SPCI_HRTO + SPCH_RETO + SPCI_SSUM)  + SPCI_RTAM + ( SPCI_DCTO -  TAXD_PLTC -  SPCI_PLTC - SPCI_RFAM)) > 130000 
				           THEN 0 ELSE  130000   END )  -->
	 <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_SPCI_Update">
		<![CDATA[
			         
				UPDATE  YETA3000                    
				SET                              
				 TAXD_ICAX  =  #taxdIcax# ,   
				 TAXD_SPCT  =  #taxdSpct# ,   
				 TXLG_CL30  =  #txlgCl30# ,   
				 TXLG_HXTT  =  #txlgHxtt# ,  
				 TAXD_WKEN  =  #taxdWken# ,   
				 ADDR_MCCR  =  #addrMccr# ,  
				 ADDR_CHLD  =  #addrChld# ,   
				 ADDR_BRTH  =  #addrBrth# ,  
				 JRTR_HICT  =  #jrtrHict# ,   
				 JRTR_PSRN  =  #jrtrPsrn# ,   
				 JRTR_HNSV  =  #jrtrHnsv# ,    
				 SPCI_GURT  =  #spciGurt# ,       
				 SPCI_HDRC  =  #spciHdrc# ,  
				 SPCI_RTDE  =  #spciRtde# , 
				   
				 SPCI_TXCR  =  #spciTxcr# ,   
				 SPED_TXCR  =  #spedTxcr# ,   
				 TAXD_PLTC  =  #taxdPltc# ,   
				 SPCI_PLTC  =  #spciPltc# , 
				   
				 SPCI_FBAM  =  #spciFbam# ,   
				 SPCI_RFAM  =  #spciRfam# ,
				 SPCI_NAMT  =  #spciNamt# ,   
				 SPCI_YAMT  =  #spciYamt# ,  
				  
				 SPCI_DDCT  =  #spciDdct# ,   
				 TAXD_UNIN  =  #taxdUnin# ,   
				 TAXD_LOAN  =  #taxdLoan# ,   
				 TAXD_PAID  =  #taxdPaid# ,  
				 SPCI_RTAM  =  #spciRtam#    
                 WHERE DPOB_CD=#dpobCd#
                        AND EDAC_RVYY=#edacRvyy#
                        AND SETT_GBCD=#settGbcd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</update>
	
	 
	  <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2015_SUBT_Update">
		<![CDATA[
			         
				UPDATE  YETA3000                    
				SET   
				  ETCP_PSNV=#etcpPsnv#   
				, ETCH_PREP=#etchPrep#
				, ETCS_COMP=#etcsComp#
				, ETWK_SBAM=#etwkSbam#
				, ETWK_SVAM=#etwkSvam# 
				, ETGD_DDAM=#etgdDdam#
				, ETCC_CARD=#etccCard#
				, ETCK_UNON=#etckUnon#
				, ETCK_UNCR=#etckUncr#
				, ETEP_MSAM=#etepMsam#
				, ETGD_HTRA=#etgdHtra#
				, ETEP_SECR=#etepSecr# 
                 WHERE DPOB_CD=#dpobCd#
                        AND EDAC_RVYY=#edacRvyy#
                        AND SETT_GBCD=#settGbcd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</update>
	 
	 <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_DCSN_INCM_Update">
		<![CDATA[
			         
				UPDATE  YETA3000                    
				SET                              
				  SPCI_BHTH=#spciBhth#
				, SPCI_JHTH=#spciJhth#
				, SPCI_BEPF=#spciBepf#
				, SPCI_JEPF=#spciJepf#
				, SPCI_GURT=#spciGurt#
				, SPCI_HDRC=#spciHdrc#
				, SPCI_RTDE=#spciRtde# 
				, SPCI_TXCR=#spciTxcr#
				, SPED_TXCR=#spedTxcr#
				, SPCI_REFN=#spciRefn#
				, SPCI_RESF=#spciResf#
				, SPCI_RTAM=#spciRtam#
				, SPCH_RE15=#spchRe15#
				, SPCH_RE29=#spchRe29#
				, SPCH_RE30=#spchRe30#
				, SPCI_REFX=#spciRefx#
				, SPCI_REEC=#spciReec#
				, SPCI_15FX=#spci15fx#
				, SPCI_15FB=#spci15fb#
				, SPCI_15EC=#spci15ec#
				, SPCI_10FB=#spci10fb#
			 	, SPCI_10EC=#spci10ec#
				, SPCI_FBAM=#spciFbam#
				, SPCI_YAMT=#spciYamt#
				, SPCI_NAMT=#spciNamt#
				, SPCI_SSUM=#spciSsum# 
				, SPCI_TGRT=#spciTgrt# 
                 WHERE DPOB_CD=#dpobCd#
                        AND EDAC_RVYY=#edacRvyy#
                        AND SETT_GBCD=#settGbcd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</update>
	
	  <update id="yetaPrcTaxDAO.yeta2000_ReTax_2015_DCSN_INCM_Update">
		<![CDATA[
			         
				UPDATE  YETA2000                    
				SET                              
			      SPCI_RTTG=#spciRttg#
			      , SPCI_HDTG=#spciHdtg#
			      , SPCI_DETG=#spciDetg#
			      , SPCI_DTAR=#spciDtar#
			      , SPED_ETAR=#spedEtar#
			      , SPCI_FBTG=#spciFbtg#
			      , SPCI_NATG=#spciNatg#
				  , SPCI_YATG=#spciYatg#  
			      , SPCI_FB14=#spciFb14#
			      , SPCI_NA14=#spciNa14#
				  , SPCI_YA14=#spciYa14#   
                 WHERE DPOB_CD=#dpobCd#
                        AND EDAC_RVYY=#edacRvyy#
                        AND SETT_GBCD=#settGbcd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</update>

	 <!-- -특별공제)특별세액공제 계 표준세액 공제  -->
	   	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_12_1_Update">
		<![CDATA[
			 UPDATE YETA3000                                                                                                                                                                         
                            SET                                                                                                                                                                  
                         /*  --TAXD_TSUM IS '세액감면)감면세액계   */                                                                          
                            TAXD_TSUM = (NVL(TAXD_SPCT,0) + NVL(TAXD_ICAX,0)+ NVL(TXLG_CL30,0)+ NVL(TXLG_HXTT,0)),  
                          /* --JRTR_HNTO IS '특별공제_연금계좌 계    */                                                                                                                            
                                 JRTR_HNTO = NVL(BRTR_HICT, 0) + NVL(BRTR_HNSV, 0)  + NVL(BRTR_PSRN, 0) + NVL(JRTR_HICT, 0) + NVL(JRTR_PSRN, 0) + NVL(JRTR_HNSV, 0),           

       /* --//귀속년도 기부금세액공제 */
                            SPCI_DGCR =  NVL(TAXD_PLTC, 0)  + NVL(SPCI_PLTC, 0)  + NVL(SPCI_FBAM, 0)  + NVL(SPCI_RFAM, 0) + NVL(SPCI_YAMT, 0)  + NVL(SPCI_NAMT, 0)   
			 WHERE DPOB_CD=#dpobCd#
                        AND EDAC_RVYY=#edacRvyy#
                        AND SETT_GBCD=#settGbcd#
                         AND SYSTEMKEY=#systemkey#	
				]]>
	</update>
         <!-- 세액감면 세액공제- -->
	   	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_15_Update">
		<![CDATA[
			  UPDATE YETA3000                                                                                                         
                   SET                                                                                                            
                     /* --SPCI_DCTO IS '특별세액공제 계 */                                                                                                                                 
                     SPCI_DCTO = NVL(SPCI_RTDE, 0) + NVL(SPCI_TXCR, 0) + NVL(SPED_TXCR, 0)+ NVL(SPCI_DGCR, 0) ,                              

                    /* --TAXD_CSUM IS '세액공제)공제계    */                                                                            
                    TAXD_CSUM = (NVL(TAXD_WKEN,0) + NVL(ADDR_MCCR,0)   + NVL(ADDR_CHLD,0) + NVL(ADDR_BRTH,0) + NVL(JRTR_HNTO,0) 
                     + NVL(SPCI_RTDE, 0) + NVL(SPCI_TXCR, 0) + NVL(SPED_TXCR, 0)  + NVL(SPCI_DGCR, 0)  +  NVL( SPCI_DDCT,0)   
    				       + NVL(TAXD_UNIN,0)  + NVL(TAXD_LOAN,0)  + NVL(TAXD_PAID,0)  + NVL(SPCI_RTAM,0))  
               WHERE DPOB_CD=#dpobCd#
                        AND EDAC_RVYY=#edacRvyy#
                        AND SETT_GBCD=#settGbcd#
                         AND SYSTEMKEY=#systemkey#
				]]>
	</update>
	
	   	   <!-- 농어촌특별세 계산   SUBT_ERAM -  ETGD_DDAM - ETGD_HTRA - ETEP_SECR
           농어촌특별세 계산 
         -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_16_Update">
		<![CDATA[
			    
            UPDATE YETA3000                                                                                                                                               
                            SET                                                                                                                                
           /* --ALRY_YVTX IS '농특세   */                                                                                                                         
           DCSN_FAFV =     (CASE WHEN                        
                             ((TRUNC(                                                                                           
                                      CASE WHEN   (SUBT_ERAM - (nvl(ETCP_PSNV,0)  + nvl(ETCH_PREP,0) + nvl(ETWK_BDAM,0) + nvl(ETCC_CARD,0)   + nvl(ETCK_UNON,0) + nvl(ETCK_UNCR,0) + nvl(ETEP_MSAM,0)+ nvl(ETEP_SECR,0))                                                                                             
                                                + (CASE WHEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0))) > 0                                                              
                                                        THEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0)))                                                                    
                                                        ELSE 0 END)) <= 12000000                                                                                                                        
                                           THEN  ( (SUBT_ERAM - (nvl(ETCP_PSNV,0)  + nvl(ETCH_PREP,0) + nvl(ETWK_BDAM,0) + nvl(ETCC_CARD,0)   + nvl(ETCK_UNON,0) + nvl(ETCK_UNCR,0) + nvl(ETEP_MSAM,0) + nvl(ETEP_SECR,0))                                                                                             
                                                + (CASE WHEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0))) > 0                                                              
                                                        THEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0)))                                                                    
                                                        ELSE 0 END)) * 0.06 )                              
                                           WHEN   (SUBT_ERAM - (nvl(ETCP_PSNV,0)  + nvl(ETCH_PREP,0) + nvl(ETWK_BDAM,0) + nvl(ETCC_CARD,0)   + nvl(ETCK_UNON,0) + nvl(ETCK_UNCR,0) + nvl(ETEP_MSAM,0)+ nvl(ETEP_SECR,0))                                                                                             
                                                + (CASE WHEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0))) > 0                                                              
                                                        THEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0)))                                                                    
                                                        ELSE 0 END)) <= 46000000                                                                                                                        
                                                                   THEN  (( (SUBT_ERAM - (nvl(ETCP_PSNV,0)  + nvl(ETCH_PREP,0) + nvl(ETWK_BDAM,0) + nvl(ETCC_CARD,0)   + nvl(ETCK_UNON,0) + nvl(ETCK_UNCR,0) + nvl(ETEP_MSAM,0) + nvl(ETEP_SECR,0))                                                                                             
                                                + (CASE WHEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0))) > 0                                                              
                                                        THEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0)))                                                                    
                                                        ELSE 0 END)) * 0.15) - 1080000)    
                                           WHEN   (SUBT_ERAM - (nvl(ETCP_PSNV,0)  + nvl(ETCH_PREP,0) + nvl(ETWK_BDAM,0) + nvl(ETCC_CARD,0)   + nvl(ETCK_UNON,0) + nvl(ETCK_UNCR,0) + nvl(ETEP_MSAM,0) + nvl(ETEP_SECR,0))                                                                                             
                                                + (CASE WHEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0))) > 0                                                              
                                                        THEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0)))                                                                    
                                                        ELSE 0 END)) <= 88000000                                                                                                                        
                                                                   THEN  ((  (SUBT_ERAM - (nvl(ETCP_PSNV,0)  + nvl(ETCH_PREP,0) + nvl(ETWK_BDAM,0) + nvl(ETCC_CARD,0)   + nvl(ETCK_UNON,0) + nvl(ETCK_UNCR,0) + nvl(ETEP_MSAM,0) + nvl(ETEP_SECR,0))                                                                                             
                                                + (CASE WHEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0))) > 0                                                              
                                                        THEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0)))                                                                    
                                                        ELSE 0 END))  * 0.24) - 5220000 )      
                                           WHEN   (SUBT_ERAM - (nvl(ETCP_PSNV,0)  + nvl(ETCH_PREP,0) + nvl(ETWK_BDAM,0) + nvl(ETCC_CARD,0)   + nvl(ETCK_UNON,0) + nvl(ETCK_UNCR,0) + nvl(ETEP_MSAM,0) + nvl(ETEP_SECR,0))                                                                                             
                                                + (CASE WHEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0))) > 0                                                              
                                                        THEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0)))                                                                    
                                                        ELSE 0 END)) <= 150000000                                                                                                                       
                                                                   THEN  ((  (SUBT_ERAM - (nvl(ETCP_PSNV,0)  + nvl(ETCH_PREP,0) + nvl(ETWK_BDAM,0) + nvl(ETCC_CARD,0)   + nvl(ETCK_UNON,0) + nvl(ETCK_UNCR,0) + nvl(ETEP_MSAM,0) + nvl(ETEP_SECR,0))                                                                                             
                                                + (CASE WHEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0))) > 0                                                              
                                                        THEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0)))                                                                    
                                                        ELSE 0 END)) * 0.35) - 14900000 )    
                                      ELSE   ((  (SUBT_ERAM - (nvl(ETCP_PSNV,0)  + nvl(ETCH_PREP,0) + nvl(ETWK_BDAM,0) + nvl(ETCC_CARD,0)   + nvl(ETCK_UNON,0) + nvl(ETCK_UNCR,0) + nvl(ETEP_MSAM,0)+ nvl(ETEP_SECR,0))                                                                                             
                                                + (CASE WHEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0))) > 0                                                              
                                                        THEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0)))                                                                    
                                                        ELSE 0 END)) * 0.38) - 19400000 )  END)) - PRDD_TAXN)  < 0    
                      THEN 0                                                                                          
                      ELSE                                                                              
                             TRUNC(((((                                                                                           
                                      CASE WHEN   (SUBT_ERAM - (nvl(ETCP_PSNV,0)  + nvl(ETCH_PREP,0) + nvl(ETWK_BDAM,0) + nvl(ETCC_CARD,0)   + nvl(ETCK_UNON,0) + nvl(ETCK_UNCR,0) + nvl(ETEP_MSAM,0)+ nvl(ETEP_SECR,0))                                                                                             
                                                + (CASE WHEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0))) > 0                                                              
                                                        THEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0)))                                                                    
                                                        ELSE 0 END)) <= 12000000                                                                                                                        
                                                                   THEN  ( (SUBT_ERAM - (nvl(ETCP_PSNV,0)  + nvl(ETCH_PREP,0) + nvl(ETWK_BDAM,0) + nvl(ETCC_CARD,0)   + nvl(ETCK_UNON,0) + nvl(ETCK_UNCR,0) + nvl(ETEP_MSAM,0)+ nvl(ETEP_SECR,0))                                                                                             
                                                + (CASE WHEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0))) > 0                                                              
                                                        THEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0)))                                                                    
                                                        ELSE 0 END)) * 0.06 )                              
                                           WHEN   (SUBT_ERAM - (nvl(ETCP_PSNV,0)  + nvl(ETCH_PREP,0) + nvl(ETWK_BDAM,0) + nvl(ETCC_CARD,0)   + nvl(ETCK_UNON,0) + nvl(ETCK_UNCR,0) + nvl(ETEP_MSAM,0)+ nvl(ETEP_SECR,0))                                                                                             
                                                + (CASE WHEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0))) > 0                                                              
                                                        THEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0)))                                                                    
                                                        ELSE 0 END)) <= 46000000                                                                                                                        
                                                                   THEN  (( (SUBT_ERAM - (nvl(ETCP_PSNV,0)  + nvl(ETCH_PREP,0) + nvl(ETWK_BDAM,0) + nvl(ETCC_CARD,0)   + nvl(ETCK_UNON,0) + nvl(ETCK_UNCR,0) + nvl(ETEP_MSAM,0)+ nvl(ETEP_SECR,0))                                                                                             
                                                + (CASE WHEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0))) > 0                                                              
                                                        THEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0)))                                                                    
                                                        ELSE 0 END)) * 0.15) - 1080000)    
                                           WHEN   (SUBT_ERAM - (nvl(ETCP_PSNV,0)  + nvl(ETCH_PREP,0) + nvl(ETWK_BDAM,0) + nvl(ETCC_CARD,0)   + nvl(ETCK_UNON,0) + nvl(ETCK_UNCR,0) + nvl(ETEP_MSAM,0)+ nvl(ETEP_SECR,0))                                                                                             
                                                + (CASE WHEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0))) > 0                                                              
                                                        THEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0)))                                                                    
                                                        ELSE 0 END)) <= 88000000                                                                                                                        
                                                                   THEN  ((  (SUBT_ERAM - (nvl(ETCP_PSNV,0)  + nvl(ETCH_PREP,0) + nvl(ETWK_BDAM,0) + nvl(ETCC_CARD,0)   + nvl(ETCK_UNON,0) + nvl(ETCK_UNCR,0) + nvl(ETEP_MSAM,0)+ nvl(ETEP_SECR,0))                                                                                             
                                                + (CASE WHEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0))) > 0                                                              
                                                        THEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0)))                                                                    
                                                        ELSE 0 END))  * 0.24) - 5220000 )      
                                           WHEN   (SUBT_ERAM - (nvl(ETCP_PSNV,0)  + nvl(ETCH_PREP,0) + nvl(ETWK_BDAM,0) + nvl(ETCC_CARD,0)   + nvl(ETCK_UNON,0) + nvl(ETCK_UNCR,0) + nvl(ETEP_MSAM,0)+ nvl(ETEP_SECR,0))                                                                                             
                                                + (CASE WHEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0))) > 0                                                              
                                                        THEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0)))                                                                    
                                                        ELSE 0 END)) <= 150000000                                                                                                                       
                                                                   THEN  ((  (SUBT_ERAM - (nvl(ETCP_PSNV,0)  + nvl(ETCH_PREP,0) + nvl(ETWK_BDAM,0) + nvl(ETCC_CARD,0)   + nvl(ETCK_UNON,0) + nvl(ETCK_UNCR,0) + nvl(ETEP_MSAM,0)+ nvl(ETEP_SECR,0))                                                                                             
                                                + (CASE WHEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0))) > 0                                                              
                                                        THEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0)))                                                                    
                                                        ELSE 0 END)) * 0.35) - 14900000 )    
                                      ELSE   ((  (SUBT_ERAM - (nvl(ETCP_PSNV,0)  + nvl(ETCH_PREP,0) + nvl(ETWK_BDAM,0) + nvl(ETCC_CARD,0)   + nvl(ETCK_UNON,0) + nvl(ETCK_UNCR,0) + nvl(ETEP_MSAM,0)+ nvl(ETEP_SECR,0))                                                                                             
                                                + (CASE WHEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0))) > 0                                                              
                                                        THEN (SPCH_EXLI - (NVL(ETGD_D14F, 0) + NVL(ETGD_09AF, 0) + NVL(ETGD_H13H, 0) + NVL(ETGD_D15F, 0)))                                                                    
                                                        ELSE 0 END)) * 0.38) - 19400000 )  END)) - PRDD_TAXN) + TAXD_LOAN) * 0.2) END)                                                               
			WHERE DPOB_CD=#dpobCd#
                        AND EDAC_RVYY=#edacRvyy#
                        AND SETT_GBCD=#settGbcd#
                         AND SYSTEMKEY=#systemkey#
  
				]]>
	</update>
	
	   <!-- 결정세액 -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_17_Update">
		<![CDATA[
			       UPDATE YETA3000                                                                        
                          SET                                                                          
                          DCSN_INCM = CASE WHEN (PRDD_TAXN - TAXD_TSUM - TAXD_CSUM) < 0                
                                      THEN 0                                                           
                                      ELSE (PRDD_TAXN - TAXD_TSUM - TAXD_CSUM)                         
                                      END,                                                             
                          DCSN_INHB = TRUNC((CASE WHEN (PRDD_TAXN - TAXD_TSUM - TAXD_CSUM) < 0         
                                      THEN 0                                                           
                                      ELSE (PRDD_TAXN - TAXD_TSUM - TAXD_CSUM)                         
                                      END) * 0.1)   
                                         , REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')           
            WHERE DPOB_CD=#dpobCd#
                        AND EDAC_RVYY=#edacRvyy#
                        AND SETT_GBCD=#settGbcd#
                         AND SYSTEMKEY=#systemkey#
				]]>
	</update>
	 <!-- 납부또는 환급세액 -->
	   <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_18_Update">
		<![CDATA[
			 UPDATE YETA3000                                                                                                     
			   SET                                                                                      
			   SUBT_ETAX = (TRUNC((NVL(DCSN_INCM, 0) - NVL(ALRY_PINX, 0) - NVL(DCSN_ITAX, 0))/10) * 10),        
			   SUBT_INHB = (TRUNC((NVL(DCSN_INHB, 0) - NVL(ALRY_PHBX, 0) - NVL(DCSN_BTAX, 0))/10) * 10),        
			   SUBT_FAFV = (TRUNC((NVL(DCSN_FAFV, 0) - NVL(ALRY_YVTX, 0) - NVL(FAFV_TAXI, 0))/10) * 10) 
			      , REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')    
			   WHERE DPOB_CD=#dpobCd#
                        AND EDAC_RVYY=#edacRvyy#
                        AND SETT_GBCD=#settGbcd#
                         AND SYSTEMKEY=#systemkey#
				]]>
	</update>
	
	   <!-- 차감징수세액 총계 -->
	  <update id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_19_Update">
		<![CDATA[
	  UPDATE YETA3000                                                                  
           SET                                                          
           SUBT_AMSU = ((TRUNC((NVL(DCSN_INCM, 0) - NVL(ALRY_PINX, 0) - NVL(DCSN_ITAX, 0))/10) * 10) +           
                                  (TRUNC((NVL(DCSN_INHB, 0) - NVL(ALRY_PHBX, 0) - NVL(DCSN_BTAX, 0))/10) * 10) + (TRUNC((NVL(DCSN_FAFV, 0) - NVL(ALRY_YVTX, 0) - NVL(FAFV_TAXI, 0))/10) * 10))  
                                  , REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')       
          WHERE DPOB_CD=#dpobCd#
                        AND EDAC_RVYY=#edacRvyy#
                        AND SETT_GBCD=#settGbcd#
                         AND SYSTEMKEY=#systemkey#
				]]>
	</update>
	  
	 <!-- 기부금공제 에 따른 기부명세서 작성 이월기부금삭제 해당년도에 해당 없는 자  -->
	 <delete id="yetaPrcTaxDAO.fnPayr06430_PAYR443_ReTax_2014_CREATE_10_1_Delete">
		<![CDATA[
			 DELETE FROM   YETA3170                                                                        
                       WHERE DPOB_CD=#dpobCd#
                        AND EDAC_RVYY=#edacRvyy#
                        AND SETT_GBCD=#settGbcd#                                                        
                           AND  CTRB_YRMN IN ('2010','2011','2012','2013','2014')                                                  
                           AND  NOT EXISTS ( SELECT SYSTEMKEY                                                   
                                                         FROM   YETA2000                                         
                                                         WHERE  YETA2000.DPOB_CD=#dpobCd#
                       										 AND YETA2000.SETT_GBCD = #settGbcd#                   
                                                              AND  YETA2000.EDAC_RVYY =  #edacRvyy#           
                                                              AND   YETA2000.SYSTEMKEY = YETA3170.SYSTEMKEY  
                           )   
				]]>
    	</delete>
	 
	 <!-- 기부금공제 에 따른 기부명세서 작성 -->
	 <delete id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_10_1_Delete">
		<![CDATA[
			  DELETE FROM YETA3170 
			    WHERE DPOB_CD=#dpobCd#
                        AND EDAC_RVYY=#edacRvyy#
                        AND SETT_GBCD=#settGbcd#
                         AND SYSTEMKEY=#systemkey#
				]]>
	</delete>
	   
	  <!-- -기부금공제 에 따른 이월기부금 작성 -->
	  <insert id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_10_2_Update">
		<![CDATA[
		  INSERT INTO YETA3170                                                 
				   (                                                            
				     EDAC_RVYY,                                                 
				     SETT_GBCD,                                                 
				     SYSTEMKEY,                                                 
				     CTRB_SEQN,                                                 
				     CTRB_DDCD,                                                 
				     CTRB_TYCD,                                                 
				     CTRB_AMNT,                                                 
				     CTRB_YRMN,                                                 
				     BFYR_DEAM,                                                 
				     DETR_AMNT,                                                 
				     DYYR_DEAM,                                                 
				     DYYR_OTAM,                                                 
				     AYYR_NTAM                                                  
				   )                                                            
				   ( SELECT                                                      
				     EDAC_RVYY,                                                 
				     SETT_GBCD,                                                 
				     SYSTEMKEY,                                                 
				     CTRB_SEQN,                                                 
				     CTRB_DDCD,                                                 
				     CTRB_TYCD,                                                 
				     CTRB_AMNT,                                                 
				     CTRB_YRMN,                                                 
				     BFYR_DEAM,                                                 
				     DETR_AMNT,                                                 
				     DYYR_DEAM,                                                 
				     DYYR_OTAM,                                                 
				     AYYR_NTAM                                                  
				   FROM YETA3190                                             
				   WHERE DPOB_CD=#dpobCd#
                        AND EDAC_RVYY=#edacRvyy#
                        AND SETT_GBCD=#settGbcd#
                         AND SYSTEMKEY=#systemkey#
				     ) 
		]]>
	</insert>
	
	  <!--  기부금공제 에 따른 기부명세서 작성  -->
	  <insert id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2014_CREATE_10_1_Update">
		<![CDATA[
		  INSERT INTO YETA3170                                                 
		   (                                                            
		     DPOB_CD,
		     EDAC_RVYY,                                                 
		     SETT_GBCD,                                                 
		     SYSTEMKEY,                                                 
		     CTRB_SEQN,                                                 
		     CTRB_DDCD,                                                 
		     CTRB_TYCD,                                                 
		     CTRB_AMNT,                                                 
		     CTRB_YRMN,                                                 
		     BFYR_DEAM,                                                 
		     DETR_AMNT,                                                 
		     DYYR_DEAM,                                                 
		     DYYR_OTAM,                                                 
		     AYYR_NTAM                                                  
		   )                                                            
		   (                                                              
		    SELECT    
            DPOB_CD,                               
             EDAC_RVYY,                                                   
             SETT_GBCD,                                                   
             SYSTEMKEY,                                                  
             (ROWNUM + CTRB_SEQN) AS CTRB_SEQN,                          
             CTRB_DDCD,                                                  
             CTRB_TYCD,                                                  
             TOTAL01,                                                    
             CTRB_YRMN,                                                  
             TEMP01,                                                     
             TOTAL02,                                                    
             SPCI,                                                       
             TEMP02,                                                     
             (CASE WHEN SPCI_D  > 0 THEN  SPCI_D ELSE 0 END)                                                  
          FROM                                                           
           (SELECT 
           BB.DPOB_CD,                                 
           BB.EDAC_RVYY,                                                   
           BB.SETT_GBCD,                                                   
           BB.SYSTEMKEY,                                                   
                   (SELECT (NVL(MAX(AA.CTRB_SEQN),0) + 1) FROM YETA3170 AA      
                   WHERE AA.EDAC_RVYY = BB.EDAC_RVYY  AND AA.SETT_GBCD = BB.SETT_GBCD AND  AA.SYSTEMKEY = BB.SYSTEMKEY) AS CTRB_SEQN , 
           BB.CTRB_DDCD,                                                   
           BB.CTRB_TYCD,                                                   
           BB.TOTAL01,                                                     
           BB.CTRB_YRMN,                                                   
           BB.TEMP01,                                                      
           BB.TOTAL02,                                                     
           BB.SPCI,                                                        
           BB.TEMP02,                                                      
            ( BB.TOTAL02  - (CASE WHEN BB.CTRB_TYCD =  '10'  THEN  BB.SPCI       
                    WHEN BB.CTRB_TYCD =  '30'  THEN   BB.SPCI                 
                    WHEN BB.CTRB_TYCD =  '31'  THEN   BB.SPCI                 
                    WHEN BB.CTRB_TYCD =  '40'  THEN   BB.SPCI                 
                    WHEN BB.CTRB_TYCD =  '41'  THEN   BB.SPCI  
                    WHEN BB.CTRB_TYCD =  '42'  THEN   BB.SPCI                 
                    ELSE     0 END)) AS SPCI_D                          
           FROM                                                         
           (SELECT  
             YETA3180.DPOB_CD ,                                                
            YETA3180.EDAC_RVYY,                                          
            YETA3180.SETT_GBCD,                                                
            YETA3180.SYSTEMKEY,                                                
            YETA3180.CTRB_DDCD,                                                
            YETA3180.CTRB_TYCD,                                                
             (CASE WHEN CTRB_TYCD =   '20'   THEN                             
                     (CASE WHEN SUM(NVL(CTRB_AMNT,0))  > 100000  THEN         
                                         SUM(NVL(CTRB_AMNT,0)) - 100000       
                               ELSE 0 END)                                    
                    ELSE SUM(NVL(CTRB_AMNT,0)) END) AS TOTAL01  ,             
            YETA3180.CTRB_YRMN,                                                
            (0) AS TEMP01,                                                    
            (CASE WHEN CTRB_TYCD =   '20'   THEN                              
                     (CASE WHEN SUM(NVL(CTRB_AMNT,0))  > 100000  THEN         
                                         SUM(NVL(CTRB_AMNT,0)) - 100000       
                               ELSE 0 END)                                    
                    ELSE SUM(NVL(CTRB_AMNT,0)) END) AS TOTAL02 ,              
           (CASE WHEN CTRB_TYCD =  '10'  THEN   (NVL (YETA2000.SPCI_FBTG, 0)  + NVL (YETA2000.SPCI_FB14, 0))              
                    WHEN CTRB_TYCD =  '20'  THEN   YETA2000.SPCI_PLTG       
                    WHEN CTRB_TYCD =  '40'  THEN   (NVL (YETA2000.SPCI_NATG, 0) +   NVL (YETA2000.SPCI_NA14, 0))          
                    WHEN CTRB_TYCD =  '41'  THEN   (NVL (YETA2000.SPCI_YATG, 0)+  NVL (YETA2000.SPCI_YA14, 0))        
                    WHEN CTRB_TYCD =  '42'  THEN   NVL (YETA2000.SPCI_HFTG, 0)           
                    ELSE     0 END)  AS  SPCI,                                
            (0) AS TEMP02                                                     
           FROM YETA3180 ,YETA3000 , YETA2000                                            
             WHERE YETA3180.SYSTEMKEY = YETA3000.SYSTEMKEY                      
                 AND YETA3180.EDAC_RVYY = YETA3000.EDAC_RVYY                    
                 AND YETA3180.SETT_GBCD = YETA3000.SETT_GBCD 
                  AND YETA3180.DPOB_CD  = YETA3000.DPOB_CD                    
                 AND YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY                      
                 AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY                    
                 AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD   
              AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD 
              AND  YETA3180.DPOB_CD=#dpobCd#                 
              AND YETA3180.SYSTEMKEY = #systemkey#       
              AND YETA3180.SETT_GBCD = #settGbcd#    
              AND YETA3180.EDAC_RVYY = #edacRvyy#    
           GROUP BY  YETA3180.DPOB_CD ,YETA3180.EDAC_RVYY,                                       
            YETA3180.SETT_GBCD,                                                
            YETA3180.SYSTEMKEY,                                                
            YETA3180.CTRB_DDCD,                                                
            YETA3180.CTRB_TYCD,                                                
            YETA3180.CTRB_YRMN,                                                
            YETA2000.SPCI_FBTG, 
            YETA2000.SPCI_FB14,                                  
            YETA2000.SPCI_PLTG,   
            YETA2000.SPCI_NATG,                                                
            YETA2000.SPCI_YATG,                                                
            YETA2000.SPCI_HFTG,
            YETA2000.SPCI_NA14,
            YETA2000.SPCI_YA14) BB                                               
            WHERE BB.TOTAL02 <> 0                                                
           ))   
		]]>
	</insert>
	  
   <select id="yetaPrcTaxDAO.fnPayr06430_PAYR442_PAYR425_ReTax_2014_SelectFind" parameterClass="yetaPrcTax2000" resultClass="egovMap">
      SELECT    
        YETA3000.DPOB_CD ,                             
        YETA3000.EDAC_RVYY,                    
        YETA3000.SETT_GBCD,                    
        YETA3000.SYSTEMKEY,                    
        (YETA3000.SPCI_OBAM) AS SPCI_OBAM_10,  
        (YETA2000.SPCI_FBTG) AS SPCI_FBTG_10,  
        (YETA2000.SPCI_FB14) AS SPCI_FB14_10,
        (YETA3000.SPCI_EXAM) AS SPCI_EXAM_30,  
        (YETA3000.SPCI_UNON) AS SPCI_UNON_31,  
        (YETA3000.SPCI_ONAM) AS SPCI_ONAM_40,  
        (YETA2000.SPCI_NATG) AS SPCI_NATG_40,  
        (YETA2000.SPCI_NA14) AS SPCI_NA14_40,
        (YETA3000.SPCI_OYAM) AS SPCI_OYAM_41,  
        (YETA2000.SPCI_YA14) AS SPCI_YA14_41,   
        (YETA2000.SPCI_YATG) AS SPCI_YATG_41,
        (YETA2000.SPCI_HFTG) AS SPCI_HFTG_42   
       FROM YETA3000 ,YETA2000  
          WHERE YETA2000.SYSTEMKEY = YETA3000.SYSTEMKEY  
              AND YETA2000.EDAC_RVYY = YETA3000.EDAC_RVYY 
              AND YETA2000.SETT_GBCD = YETA3000.SETT_GBCD 
               AND YETA2000.DPOB_CD  = YETA3000.DPOB_CD  
                AND  YETA2000.DPOB_CD=#dpobCd#                 
		    AND YETA2000.SYSTEMKEY = #systemkey#       
		    AND YETA2000.SETT_GBCD = #settGbcd#    
		    AND YETA2000.EDAC_RVYY = #edacRvyy#
	</select>	
	 
   
   
   
    <insert id="yetaPrcTaxDAO.fnPayr06420_Yeta3300_ReTax_2015_CREATE_01_1_Insert">
		<![CDATA[
		 	INSERT INTO YETA3300 
				( DPOB_CD
				  , EDAC_RVYY
				  , SETT_GBCD
				  , SYSTEMKEY
				  , SITE_NUMB
				  , TAXM_SA01
				  , TAXM_SB01
				  , TAXM_SC01
				  , TAXM_SD01
				  , TAXM_SE01
				  , TAXM_SE02
				  , TAXM_SE10
				  , TAXM_SF01
				  , TAXM_SG01
				  , TAXM_SH01
				  , TAXM_SH02
				  , TAXM_SH03
				  , TAXM_SH04
				  , TAXM_SH05
				  , TAXM_SH06
				  , TAXM_SH07
				  , TAXM_SH08
				  , TAXM_SH09
				  , TAXM_SH10
				  , TAXM_SH14
				  , TAXM_SH15
				  , TAXM_SH11
				  , TAXM_SH12
				  , TAXM_SH13
				  , TAXM_SH16
				  , TAXM_SI01
				  , TAXM_SJ01
				  , TAXM_SJ10
				  , TAXM_SK01
				  , TAXM_SL01
				  , TAXM_SM01
				  , TAXM_SM02
				  , TAXM_SM03
				  , TAXM_SN01
				  , TAXM_SO01
				  , TAXM_SP01
				  , TAXM_SP02
				  , TAXM_SQ01
				  , TAXM_SR01
				  , TAXM_SR10
				  , TAXM_SS01
				  , TAXM_SY02
				  , TAXM_SY03
				  , TAXM_SY21
				  , TAXM_SY22
				  , TAXM_ST01
				  , TAXM_ST10
				  , TAXM_ST20
				  , KYBDR
				  , INPT_DT
				  , INPT_ADDR
				  , ISMT
				  , REVN_DT
				  , REVN_ADDR )
				  (
				  	SELECT
				     DPOB_CD
				, EDAC_RVYY
				, SETT_GBCD
				, SYSTEMKEY
				, SITE_NUMB
				, TAXM_EA01
				, TAXM_EB01
				, TAXM_EC01
				, TAXM_ED01
				, TAXM_EE01
				, TAXM_EE02
				, TAXM_EE10
				, TAXM_EF01
				, TAXM_EG01
				, TAXM_EH01
				, TAXM_EH02
				, TAXM_EH03
				, TAXM_EH04
				, TAXM_EH05
				, TAXM_EH06
				, TAXM_EH07
				, TAXM_EH08
				, TAXM_EH09
				, TAXM_EH10
				, TAXM_EH14
				, TAXM_EH15
				, TAXM_EH11
				, TAXM_EH12
				, TAXM_EH13
				, TAXM_EH16
				, TAXM_EI01
				, TAXM_EJ01
				, TAXM_EJ10
				, TAXM_EK01
				, TAXM_EL01
				, TAXM_EM01
				, TAXM_EM02
				, TAXM_EM03
				, TAXM_EN01
				, TAXM_EO01
				, TAXM_EP01
				, TAXM_EP02
				, TAXM_EQ01
				, TAXM_ER01
				, TAXM_ER10
				, TAXM_ES01
				, TAXM_EY02
				, TAXM_EY03
				, TAXM_EY21
				, TAXM_EY22
				, TAXM_ET01
				, TAXM_ET10
				, TAXM_ET20
				, KYBDR
				, INPT_DT
				, INPT_ADDR
				, ISMT
				, REVN_DT
				, REVN_ADDR
			FROM YETA3200
						WHERE DPOB_CD=#dpobCd#
								AND EDAC_RVYY=#edacRvyy#
								AND SETT_GBCD=#settGbcd#
								AND SYSTEMKEY=#systemkey# 
				  )
			
		]]>
	</insert>
	 
    
    <delete id="yetaPrcTaxDAO.fnPayr06420_Yeta3300_ReTax_2015_CREATE_01_1_Delete">
		<![CDATA[
			 DELETE FROM YETA3300 
						WHERE DPOB_CD=#dpobCd#
								AND EDAC_RVYY=#edacRvyy#
								AND SETT_GBCD=#settGbcd#
								AND SYSTEMKEY=#systemkey# 
				]]>
	</delete>
	
    
     <resultMap id="yetaDscnPrc3000" class="com.app.smrmf.infc.yearendtax.server.vo.InfcPkgYeta3000VO"> 
		<result property="dcsnIncm" column="DCSN_INCM" columnIndex="1"/>
	    <result property="tdcsnIncm" column="TDCSN_INCM" columnIndex="2"/>
	    <result property="alryPinx" column="ALRY_PINX" columnIndex="3"/>
	    <result property="resdFlag" column="RESD_FLAG" columnIndex="4"/> 
	</resultMap>
      
	<select id="yetaPrcTaxDAO.fnPayr06430_PAYR425_ReTax_2015_DCSN_INCM_Select" parameterClass="yetaPrcTax2000"  resultMap="yetaDscnPrc3000">
		<![CDATA[
	    SELECT
        (AA.PRDD_TAXN - ( (BB.TAXD_TSUM + BB.TAXD_CSUM)
        - BB.SPCI_RTAM - BB.TAXD_WKEN
        - (BB.SPCI_DCTO - BB.TAXD_PLTC - BB.SPCI_PLTC - BB.SPCI_RFAM)
        + 130000 + (CASE WHEN BB.TXLG_CL30 > 0 THEN  (CASE WHEN  TOTL_SALA <= 33000000 THEN                                                                                        
                                              TRUNC((CASE WHEN NVL(AA.PRDD_TAXN,0) <= 1300000                                                                                          
                                                      THEN CASE WHEN (NVL(AA.PRDD_TAXN,0) * 0.55) > 740000 THEN 740000 ELSE  (NVL(AA.PRDD_TAXN,0) * 0.55) END                        
                                                      ELSE                                                                                                                     
                                                       CASE WHEN (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000) > 740000                                                      
                                                       THEN 740000                                                                                                              
                                                       ELSE (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000)                                                                     
                                                       END  END)  ) * ( 1- (NVL(TXLG_CL30,0) / NVL(AA.PRDD_TAXN,0)))                                                                                                               
                                          WHEN  TOTL_SALA <= 70000000 THEN                                                                                                                     
                                               TRUNC((CASE WHEN NVL(AA.PRDD_TAXN,0) <= 1300000                                                                                           
                                                      THEN CASE WHEN (NVL(AA.PRDD_TAXN,0) * 0.55) > (CASE WHEN (740000 - ((TOTL_SALA - 33000000) * 0.008))  < 660000 THEN 660000     
                                                                                                       ELSE (740000 - ((TOTL_SALA - 33000000) * 0.008))  END)                     
                                                                THEN  (CASE WHEN (740000 - ((TOTL_SALA - 33000000) * 0.008))  < 660000 THEN 660000                                
                                                                            ELSE (740000 - ((TOTL_SALA - 33000000) * 0.008))  END)                                                
                                                                ELSE  (NVL(AA.PRDD_TAXN,0) * 0.55) END                                                                                             
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000) > (CASE WHEN (740000 - ((TOTL_SALA - 33000000) * 0.008))  < 660000 THEN 660000   
                                                                                                                         ELSE (740000 - ((TOTL_SALA - 33000000) * 0.008))  END)                   
                                                       THEN (CASE WHEN (740000 - ((TOTL_SALA - 33000000) * 0.008))  < 660000 THEN 660000                                                          
                                                                            ELSE (740000 - ((TOTL_SALA - 33000000) * 0.008))  END)                                                                
                                                       ELSE (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  ) * ( 1- (NVL(TXLG_CL30,0) / NVL(AA.PRDD_TAXN,0)))                                                                                                                                
                                         ELSE                                                                                                                                                                  
                                          TRUNC((CASE WHEN NVL(AA.PRDD_TAXN,0) <= 1300000                                                                                                           
                                                      THEN CASE WHEN (NVL(AA.PRDD_TAXN,0) * 0.55) > (CASE WHEN (660000 - ((TOTL_SALA - 70000000) * 0.5))  < 500000 THEN 500000                     
                                                                                                       ELSE (660000 - ((TOTL_SALA - 70000000) * 0.5))  END)                                     
                                                                THEN (CASE WHEN (660000 - ((TOTL_SALA - 70000000) * 0.5))  < 500000 THEN 500000                                                 
                                                                                                       ELSE (660000 - ((TOTL_SALA - 70000000) * 0.5))  END)                                     
                                                                ELSE  (NVL(AA.PRDD_TAXN,0) * 0.55)  END                                                                                            
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000) > (CASE WHEN (660000 - ((TOTL_SALA - 70000000) * 0.5))  < 500000 THEN 500000   
                                                                                                                        ELSE (660000 - ((TOTL_SALA - 70000000) * 0.5))  END)                    
                                                       THEN (CASE WHEN (660000 - ((TOTL_SALA - 70000000) * 0.5))  < 500000 THEN 500000                                                          
                                                                                                       ELSE (660000 - ((TOTL_SALA - 70000000) * 0.5))  END)                                     
                                                       ELSE (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  ) * ( 1- (NVL(TXLG_CL30,0) / NVL(AA.PRDD_TAXN,0)))                                                                                     
                                           END  )                                                                                                                                                                
                               ELSE  (CASE WHEN  TOTL_SALA <= 33000000 THEN                                                                                                    
                                          TRUNC((CASE WHEN NVL(AA.PRDD_TAXN,0) <= 1300000                                                                                                           
                                                      THEN CASE WHEN (NVL(AA.PRDD_TAXN,0) * 0.55) > 740000 THEN 740000 ELSE  (NVL(AA.PRDD_TAXN,0) * 0.55) END                                         
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000) > 740000                                                                       
                                                       THEN 740000                                                                                                                              
                                                       ELSE (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  )                                                                                                                             
                                       WHEN  TOTL_SALA <= 70000000 THEN                                                                                                                                     
                                          TRUNC((CASE WHEN NVL(AA.PRDD_TAXN,0) <= 1300000                                                                                                           
                                                      THEN CASE WHEN (NVL(AA.PRDD_TAXN,0) * 0.55) > (CASE WHEN (740000 - ((TOTL_SALA - 33000000) * 0.008))  < 660000 THEN 660000                     
                                                                                                       ELSE (740000 - ((TOTL_SALA - 33000000) * 0.008))  END)                                     
                                                                THEN  (CASE WHEN (740000 - ((TOTL_SALA - 33000000) * 0.008))  < 660000 THEN 660000                                                
                                                                            ELSE (740000 - ((TOTL_SALA - 33000000) * 0.008))  END)                                                                
                                                                ELSE  (NVL(AA.PRDD_TAXN,0) * 0.55) END                                                                                             
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000) > (CASE WHEN (740000 - ((TOTL_SALA - 33000000) * 0.008))  < 660000 THEN 660000   
                                                                                                                         ELSE (740000 - ((TOTL_SALA - 33000000) * 0.008))  END)                   
                                                       THEN (CASE WHEN (740000 - ((TOTL_SALA - 33000000) * 0.008))  < 660000 THEN 660000                                                          
                                                                            ELSE (740000 - ((TOTL_SALA - 33000000) * 0.008))  END)                                                                
                                                       ELSE (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  )                                                                                                                             
                                      ELSE                                                                                                                                                                  
                                          TRUNC((CASE WHEN NVL(AA.PRDD_TAXN,0) <= 1300000                                                                                                           
                                                      THEN CASE WHEN (NVL(AA.PRDD_TAXN,0) * 0.55) > (CASE WHEN (660000 - ((TOTL_SALA - 70000000) * 0.5))  < 500000 THEN 500000                     
                                                                                                       ELSE (660000 - ((TOTL_SALA - 70000000) * 0.5))  END)                                     
                                                                THEN (CASE WHEN (660000 - ((TOTL_SALA - 70000000) * 0.5))  < 500000 THEN 500000                                                 
                                                                                                       ELSE (660000 - ((TOTL_SALA - 70000000) * 0.5))  END)                                     
                                                                ELSE  (NVL(AA.PRDD_TAXN,0) * 0.55)  END                                                                                            
                                                      ELSE                                                                                                                                      
                                                       CASE WHEN (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000) > (CASE WHEN (660000 - ((TOTL_SALA - 70000000) * 0.5))  < 500000 THEN 500000   
                                                                                                                        ELSE (660000 - ((TOTL_SALA - 70000000) * 0.5))  END)                    
                                                       THEN (CASE WHEN (660000 - ((TOTL_SALA - 70000000) * 0.5))  < 500000 THEN 500000                                                          
                                                                                                       ELSE (660000 - ((TOTL_SALA - 70000000) * 0.5))  END)                                     
                                                       ELSE (((NVL(AA.PRDD_TAXN,0)  - 1300000) * 0.30) +715000)                                                                                     
                                                       END  END)  )                                                                                                                             
                         END  ) END))) 
          AS TDCSN_INCM, BB.DCSN_INCM,BB.ALRY_PINX,CC.RESD_FLAG
FROM
(SELECT  DPOB_CD,
         EDAC_RVYY,
         SETT_GBCD,
         SYSTEMKEY,
          (CASE
           WHEN TRUNC (
                   CASE
                      WHEN (CASE
                               WHEN (  SUBT_ERAM
                                      + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                     - ETCD_TSUM) < 0
                               THEN
                                  0
                               ELSE
                                    (  SUBT_ERAM
                                      + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                     - ETCD_TSUM)
                                  + (CASE
                                        WHEN (  (  NVL (ETCH_PREP, 0)
                                                 + (  NVL (ETWK_BDAM, 0)
                                                    + (  NVL (ETGD_DDAM, 0)
                                                       - NVL (ETGD_09AF, 0)))
                                                 + NVL (ETCC_CARD, 0)
                                                 + NVL (ETCK_UNON, 0)
                                                 + NVL (ETEP_SECR, 0))
                                              - 25000000) < 0
                                        THEN
                                           0
                                        ELSE
                                           (  (  NVL (ETCH_PREP, 0)
                                               + (  NVL (ETWK_BDAM, 0)
                                                  + (  NVL (ETGD_DDAM, 0)
                                                     - NVL (ETGD_09AF, 0)))
                                               + NVL (ETCC_CARD, 0)
                                               + NVL (ETCK_UNON, 0)
                                               + NVL (ETEP_SECR, 0))
                                            - 25000000)
                                     END)
                            END) <= 12000000
                      THEN
                         (  (CASE
                                WHEN (  SUBT_ERAM
                                      + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                      - ETCD_TSUM) < 0
                                THEN
                                   0
                                ELSE
                                     (  SUBT_ERAM
                                       + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                      - ETCD_TSUM)
                                   + (CASE
                                         WHEN (  (  NVL (ETCH_PREP, 0)
                                                  + (  NVL (ETWK_BDAM, 0)
                                                     + (  NVL (ETGD_DDAM, 0)
                                                        - NVL (ETGD_09AF, 0)))
                                                  + NVL (ETCC_CARD, 0)
                                                  + NVL (ETCK_UNON, 0)
                                                  + NVL (ETEP_SECR, 0))
                                               - 25000000) < 0
                                         THEN
                                            0
                                         ELSE
                                            (  (  NVL (ETCH_PREP, 0)
                                                + (  NVL (ETWK_BDAM, 0)
                                                   + (  NVL (ETGD_DDAM, 0)
                                                      - NVL (ETGD_09AF, 0)))
                                                + NVL (ETCC_CARD, 0)
                                                + NVL (ETCK_UNON, 0)
                                                + NVL (ETEP_SECR, 0))
                                             - 25000000)
                                      END)
                             END)
                          * 0.06)
                      WHEN (CASE
                               WHEN (  SUBT_ERAM
                                      + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                     - ETCD_TSUM) < 0
                               THEN
                                  0
                               ELSE
                                    (  SUBT_ERAM
                                      + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                     - ETCD_TSUM)
                                  + (CASE
                                        WHEN (  (  NVL (ETCH_PREP, 0)
                                                 + (  NVL (ETWK_BDAM, 0)
                                                    + (  NVL (ETGD_DDAM, 0)
                                                       - NVL (ETGD_09AF, 0)))
                                                 + NVL (ETCC_CARD, 0)
                                                 + NVL (ETCK_UNON, 0)
                                                 + NVL (ETEP_SECR, 0))
                                              - 25000000) < 0
                                        THEN
                                           0
                                        ELSE
                                           (  (  NVL (ETCH_PREP, 0)
                                               + (  NVL (ETWK_BDAM, 0)
                                                  + (  NVL (ETGD_DDAM, 0)
                                                     - NVL (ETGD_09AF, 0)))
                                               + NVL (ETCC_CARD, 0)
                                               + NVL (ETCK_UNON, 0)
                                               + NVL (ETEP_SECR, 0))
                                            - 25000000)
                                     END)
                            END) <= 46000000
                      THEN
                         (  (  (CASE
                                   WHEN (  SUBT_ERAM
                                         + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                         - ETCD_TSUM) < 0
                                   THEN
                                      0
                                   ELSE
                                        (  SUBT_ERAM
                                         + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                         - ETCD_TSUM)
                                      + (CASE
                                            WHEN (  (  NVL (ETCH_PREP, 0)
                                                     + (  NVL (ETWK_BDAM, 0)
                                                        + (  NVL (ETGD_DDAM,
                                                                  0)
                                                           - NVL (ETGD_09AF,
                                                                  0)))
                                                     + NVL (ETCC_CARD, 0)
                                                     + NVL (ETCK_UNON, 0)
                                                     + NVL (ETEP_SECR, 0))
                                                  - 25000000) < 0
                                            THEN
                                               0
                                            ELSE
                                               (  (  NVL (ETCH_PREP, 0)
                                                   + (  NVL (ETWK_BDAM, 0)
                                                      + (  NVL (ETGD_DDAM, 0)
                                                         - NVL (ETGD_09AF, 0)))
                                                   + NVL (ETCC_CARD, 0)
                                                   + NVL (ETCK_UNON, 0)
                                                   + NVL (ETEP_SECR, 0))
                                                - 25000000)
                                         END)
                                END)
                             * 0.15)
                          - 1080000)
                      WHEN (CASE
                               WHEN (  SUBT_ERAM
                                      + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                     - ETCD_TSUM) < 0
                               THEN
                                  0
                               ELSE
                                    (  SUBT_ERAM
                                      + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                     - ETCD_TSUM)
                                  + (CASE
                                        WHEN (  (  NVL (ETCH_PREP, 0)
                                                 + (  NVL (ETWK_BDAM, 0)
                                                    + (  NVL (ETGD_DDAM, 0)
                                                       - NVL (ETGD_09AF, 0)))
                                                 + NVL (ETCC_CARD, 0)
                                                 + NVL (ETCK_UNON, 0)
                                                 + NVL (ETEP_SECR, 0))
                                              - 25000000) < 0
                                        THEN
                                           0
                                        ELSE
                                           (  (  NVL (ETCH_PREP, 0)
                                               + (  NVL (ETWK_BDAM, 0)
                                                  + (  NVL (ETGD_DDAM, 0)
                                                     - NVL (ETGD_09AF, 0)))
                                               + NVL (ETCC_CARD, 0)
                                               + NVL (ETCK_UNON, 0)
                                               + NVL (ETEP_SECR, 0))
                                            - 25000000)
                                     END)
                            END) <= 88000000
                      THEN
                         (  (  (CASE
                                   WHEN (  SUBT_ERAM
                                          + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                         - ETCD_TSUM) < 0
                                   THEN
                                      0
                                   ELSE
                                        (  SUBT_ERAM
                                         + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                         - ETCD_TSUM)
                                      + (CASE
                                            WHEN (  (  NVL (ETCH_PREP, 0)
                                                     + (  NVL (ETWK_BDAM, 0)
                                                        + (  NVL (ETGD_DDAM,
                                                                  0)
                                                           - NVL (ETGD_09AF,
                                                                  0)))
                                                     + NVL (ETCC_CARD, 0)
                                                     + NVL (ETCK_UNON, 0)
                                                     + NVL (ETEP_SECR, 0))
                                                  - 25000000) < 0
                                            THEN
                                               0
                                            ELSE
                                               (  (  NVL (ETCH_PREP, 0)
                                                   + (  NVL (ETWK_BDAM, 0)
                                                      + (  NVL (ETGD_DDAM, 0)
                                                         - NVL (ETGD_09AF, 0)))
                                                   + NVL (ETCC_CARD, 0)
                                                   + NVL (ETCK_UNON, 0)
                                                   + NVL (ETEP_SECR, 0))
                                                - 25000000)
                                         END)
                                END)
                             * 0.24)
                          - 5220000)
                      WHEN (CASE
                               WHEN (  SUBT_ERAM
                                      + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                     - ETCD_TSUM) < 0
                               THEN
                                  0
                               ELSE
                                    (  SUBT_ERAM
                                      + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                     - ETCD_TSUM)
                                  + (CASE
                                        WHEN (  (  NVL (ETCH_PREP, 0)
                                                 + (  NVL (ETWK_BDAM, 0)
                                                    + (  NVL (ETGD_DDAM, 0)
                                                       - NVL (ETGD_09AF, 0)))
                                                 + NVL (ETCC_CARD, 0)
                                                 + NVL (ETCK_UNON, 0)
                                                 + NVL (ETEP_SECR, 0))
                                              - 25000000) < 0
                                        THEN
                                           0
                                        ELSE
                                           (  (  NVL (ETCH_PREP, 0)
                                               + (  NVL (ETWK_BDAM, 0)
                                                  + (  NVL (ETGD_DDAM, 0)
                                                     - NVL (ETGD_09AF, 0)))
                                               + NVL (ETCC_CARD, 0)
                                               + NVL (ETCK_UNON, 0)
                                               + NVL (ETEP_SECR, 0))
                                            - 25000000)
                                     END)
                            END) <= 150000000
                      THEN
                         (  (  (CASE
                                   WHEN (  SUBT_ERAM
                                          + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                         - ETCD_TSUM) < 0
                                   THEN
                                      0
                                   ELSE
                                        (  SUBT_ERAM
                                          + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                         - ETCD_TSUM)
                                      + (CASE
                                            WHEN (  (  NVL (ETCH_PREP, 0)
                                                     + (  NVL (ETWK_BDAM, 0)
                                                        + (  NVL (ETGD_DDAM,
                                                                  0)
                                                           - NVL (ETGD_09AF,
                                                                  0)))
                                                     + NVL (ETCC_CARD, 0)
                                                     + NVL (ETCK_UNON, 0)
                                                     + NVL (ETEP_SECR, 0))
                                                  - 25000000) < 0
                                            THEN
                                               0
                                            ELSE
                                               (  (  NVL (ETCH_PREP, 0)
                                                   + (  NVL (ETWK_BDAM, 0)
                                                      + (  NVL (ETGD_DDAM, 0)
                                                         - NVL (ETGD_09AF, 0)))
                                                   + NVL (ETCC_CARD, 0)
                                                   + NVL (ETCK_UNON, 0)
                                                   + NVL (ETEP_SECR, 0))
                                                - 25000000)
                                         END)
                                END)
                             * 0.35)
                          - 14900000)
                      ELSE
                         (  (  (CASE
                                   WHEN (  SUBT_ERAM
                                          + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                         - ETCD_TSUM) < 0
                                   THEN
                                      0
                                   ELSE
                                        (  SUBT_ERAM
                                          + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                         - ETCD_TSUM)
                                      + (CASE
                                            WHEN (  (  NVL (ETCH_PREP, 0)
                                                     + (  NVL (ETWK_BDAM, 0)
                                                        + (  NVL (ETGD_DDAM,
                                                                  0)
                                                           - NVL (ETGD_09AF,
                                                                  0)))
                                                     + NVL (ETCC_CARD, 0)
                                                     + NVL (ETCK_UNON, 0)
                                                     + NVL (ETEP_SECR, 0))
                                                  - 25000000) < 0
                                            THEN
                                               0
                                            ELSE
                                               (  (  NVL (ETCH_PREP, 0)
                                                   + (  NVL (ETWK_BDAM, 0)
                                                      + (  NVL (ETGD_DDAM, 0)
                                                         - NVL (ETGD_09AF, 0)))
                                                   + NVL (ETCC_CARD, 0)
                                                   + NVL (ETCK_UNON, 0)
                                                   + NVL (ETEP_SECR, 0))
                                                - 25000000)
                                         END)
                                END)
                             * 0.38)
                          - 19400000)
                   END) < 0
           THEN
              0
           ELSE
              TRUNC (
                 CASE
                    WHEN (CASE
                             WHEN (  SUBT_ERAM
                                    + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                   - ETCD_TSUM) < 0
                             THEN
                                0
                             ELSE
                                  (  SUBT_ERAM
                                    + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                   - ETCD_TSUM)
                                + (CASE
                                      WHEN (  (  NVL (ETCH_PREP, 0)
                                               + (  NVL (ETWK_BDAM, 0)
                                                  + (  NVL (ETGD_DDAM, 0)
                                                     - NVL (ETGD_09AF, 0)))
                                               + NVL (ETCC_CARD, 0)
                                               + NVL (ETCK_UNON, 0)
                                               + NVL (ETEP_SECR, 0))
                                            - 25000000) < 0
                                      THEN
                                         0
                                      ELSE
                                         (  (  NVL (ETCH_PREP, 0)
                                             + (  NVL (ETWK_BDAM, 0)
                                                + (  NVL (ETGD_DDAM, 0)
                                                   - NVL (ETGD_09AF, 0)))
                                             + NVL (ETCC_CARD, 0)
                                             + NVL (ETCK_UNON, 0)
                                             + NVL (ETEP_SECR, 0))
                                          - 25000000)
                                   END)
                          END) <= 12000000
                    THEN
                       (  (CASE
                              WHEN (  SUBT_ERAM
                                     + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                    - ETCD_TSUM) < 0
                              THEN
                                 0
                              ELSE
                                   (  SUBT_ERAM
                                     + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                    - ETCD_TSUM)
                                 + (CASE
                                       WHEN (  (  NVL (ETCH_PREP, 0)
                                                + (  NVL (ETWK_BDAM, 0)
                                                   + (  NVL (ETGD_DDAM, 0)
                                                      - NVL (ETGD_09AF, 0)))
                                                + NVL (ETCC_CARD, 0)
                                                + NVL (ETCK_UNON, 0)
                                                + NVL (ETEP_SECR, 0))
                                             - 25000000) < 0
                                       THEN
                                          0
                                       ELSE
                                          (  (  NVL (ETCH_PREP, 0)
                                              + (  NVL (ETWK_BDAM, 0)
                                                 + (  NVL (ETGD_DDAM, 0)
                                                    - NVL (ETGD_09AF, 0)))
                                              + NVL (ETCC_CARD, 0)
                                              + NVL (ETCK_UNON, 0)
                                              + NVL (ETEP_SECR, 0))
                                           - 25000000)
                                    END)
                           END)
                        * 0.06)
                    WHEN (CASE
                             WHEN (  SUBT_ERAM
                                    + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                   - ETCD_TSUM) < 0
                             THEN
                                0
                             ELSE
                                  (  SUBT_ERAM
                                    + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                   - ETCD_TSUM)
                                + (CASE
                                      WHEN (  (  NVL (ETCH_PREP, 0)
                                               + (  NVL (ETWK_BDAM, 0)
                                                  + (  NVL (ETGD_DDAM, 0)
                                                     - NVL (ETGD_09AF, 0)))
                                               + NVL (ETCC_CARD, 0)
                                               + NVL (ETCK_UNON, 0)
                                               + NVL (ETEP_SECR, 0))
                                            - 25000000) < 0
                                      THEN
                                         0
                                      ELSE
                                         (  (  NVL (ETCH_PREP, 0)
                                             + (  NVL (ETWK_BDAM, 0)
                                                + (  NVL (ETGD_DDAM, 0)
                                                   - NVL (ETGD_09AF, 0)))
                                             + NVL (ETCC_CARD, 0)
                                             + NVL (ETCK_UNON, 0)
                                             + NVL (ETEP_SECR, 0))
                                          - 25000000)
                                   END)
                          END) <= 46000000
                    THEN
                       (  (  (CASE
                                 WHEN (  SUBT_ERAM
                                        + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                       - ETCD_TSUM) < 0
                                 THEN
                                    0
                                 ELSE
                                      (  SUBT_ERAM
                                        + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                       - ETCD_TSUM)
                                    + (CASE
                                          WHEN (  (  NVL (ETCH_PREP, 0)
                                                   + (  NVL (ETWK_BDAM, 0)
                                                      + (  NVL (ETGD_DDAM, 0)
                                                         - NVL (ETGD_09AF, 0)))
                                                   + NVL (ETCC_CARD, 0)
                                                   + NVL (ETCK_UNON, 0)
                                                   + NVL (ETEP_SECR, 0))
                                                - 25000000) < 0
                                          THEN
                                             0
                                          ELSE
                                             (  (  NVL (ETCH_PREP, 0)
                                                 + (  NVL (ETWK_BDAM, 0)
                                                    + (  NVL (ETGD_DDAM, 0)
                                                       - NVL (ETGD_09AF, 0)))
                                                 + NVL (ETCC_CARD, 0)
                                                 + NVL (ETCK_UNON, 0)
                                                 + NVL (ETEP_SECR, 0))
                                              - 25000000)
                                       END)
                              END)
                           * 0.15)
                        - 1080000)
                    WHEN (CASE
                             WHEN (  SUBT_ERAM
                                    + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                   - ETCD_TSUM) < 0
                             THEN
                                0
                             ELSE
                                  (  SUBT_ERAM
                                    + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                   - ETCD_TSUM)
                                + (CASE
                                      WHEN (  (  NVL (ETCH_PREP, 0)
                                               + (  NVL (ETWK_BDAM, 0)
                                                  + (  NVL (ETGD_DDAM, 0)
                                                     - NVL (ETGD_09AF, 0)))
                                               + NVL (ETCC_CARD, 0)
                                               + NVL (ETCK_UNON, 0)
                                               + NVL (ETEP_SECR, 0))
                                            - 25000000) < 0
                                      THEN
                                         0
                                      ELSE
                                         (  (  NVL (ETCH_PREP, 0)
                                             + (  NVL (ETWK_BDAM, 0)
                                                + (  NVL (ETGD_DDAM, 0)
                                                   - NVL (ETGD_09AF, 0)))
                                             + NVL (ETCC_CARD, 0)
                                             + NVL (ETCK_UNON, 0)
                                             + NVL (ETEP_SECR, 0))
                                          - 25000000)
                                   END)
                          END) <= 88000000
                    THEN
                       (  (  (CASE
                                 WHEN (  SUBT_ERAM
                                        + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                       - ETCD_TSUM) < 0
                                 THEN
                                    0
                                 ELSE
                                      (  SUBT_ERAM
                                        + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                       - ETCD_TSUM)
                                    + (CASE
                                          WHEN (  (  NVL (ETCH_PREP, 0)
                                                   + (  NVL (ETWK_BDAM, 0)
                                                      + (  NVL (ETGD_DDAM, 0)
                                                         - NVL (ETGD_09AF, 0)))
                                                   + NVL (ETCC_CARD, 0)
                                                   + NVL (ETCK_UNON, 0)
                                                   + NVL (ETEP_SECR, 0))
                                                - 25000000) < 0
                                          THEN
                                             0
                                          ELSE
                                             (  (  NVL (ETCH_PREP, 0)
                                                 + (  NVL (ETWK_BDAM, 0)
                                                    + (  NVL (ETGD_DDAM, 0)
                                                       - NVL (ETGD_09AF, 0)))
                                                 + NVL (ETCC_CARD, 0)
                                                 + NVL (ETCK_UNON, 0)
                                                 + NVL (ETEP_SECR, 0))
                                              - 25000000)
                                       END)
                              END)
                           * 0.24)
                        - 5220000)
                    WHEN (CASE
                             WHEN (  SUBT_ERAM
                                    + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                   - ETCD_TSUM) < 0
                             THEN
                                0
                             ELSE
                                  (  SUBT_ERAM
                                    + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                   - ETCD_TSUM)
                                + (CASE
                                      WHEN (  (  NVL (ETCH_PREP, 0)
                                               + (  NVL (ETWK_BDAM, 0)
                                                  + (  NVL (ETGD_DDAM, 0)
                                                     - NVL (ETGD_09AF, 0)))
                                               + NVL (ETCC_CARD, 0)
                                               + NVL (ETCK_UNON, 0)
                                               + NVL (ETEP_SECR, 0))
                                            - 25000000) < 0
                                      THEN
                                         0
                                      ELSE
                                         (  (  NVL (ETCH_PREP, 0)
                                             + (  NVL (ETWK_BDAM, 0)
                                                + (  NVL (ETGD_DDAM, 0)
                                                   - NVL (ETGD_09AF, 0)))
                                             + NVL (ETCC_CARD, 0)
                                             + NVL (ETCK_UNON, 0)
                                             + NVL (ETEP_SECR, 0))
                                          - 25000000)
                                   END)
                          END) <= 150000000
                    THEN
                       (  (  (CASE
                                 WHEN (  SUBT_ERAM
                                       + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                       - ETCD_TSUM) < 0
                                 THEN
                                    0
                                 ELSE
                                      (  SUBT_ERAM
                                        + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                       - ETCD_TSUM)
                                    + (CASE
                                          WHEN (  (  NVL (ETCH_PREP, 0)
                                                   + (  NVL (ETWK_BDAM, 0)
                                                      + (  NVL (ETGD_DDAM, 0)
                                                         - NVL (ETGD_09AF, 0)))
                                                   + NVL (ETCC_CARD, 0)
                                                   + NVL (ETCK_UNON, 0)
                                                   + NVL (ETEP_SECR, 0))
                                                - 25000000) < 0
                                          THEN
                                             0
                                          ELSE
                                             (  (  NVL (ETCH_PREP, 0)
                                                 + (  NVL (ETWK_BDAM, 0)
                                                    + (  NVL (ETGD_DDAM, 0)
                                                       - NVL (ETGD_09AF, 0)))
                                                 + NVL (ETCC_CARD, 0)
                                                 + NVL (ETCK_UNON, 0)
                                                 + NVL (ETEP_SECR, 0))
                                              - 25000000)
                                       END)
                              END)
                           * 0.35)
                        - 14900000)
                    ELSE
                       (  (  (CASE
                                 WHEN (  SUBT_ERAM
                                        + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                       - ETCD_TSUM) < 0
                                 THEN
                                    0
                                 ELSE
                                      (  SUBT_ERAM
                                        + (SPCI_HRTO + SPCH_RETO + SPCI_SSUM)
                                       - ETCD_TSUM)
                                    + (CASE
                                          WHEN (  (  NVL (ETCH_PREP, 0)
                                                   + (  NVL (ETWK_BDAM, 0)
                                                      + (  NVL (ETGD_DDAM, 0)
                                                         - NVL (ETGD_09AF, 0)))
                                                   + NVL (ETCC_CARD, 0)
                                                   + NVL (ETCK_UNON, 0)
                                                   + NVL (ETEP_SECR, 0))
                                                - 25000000) < 0
                                          THEN
                                             0
                                          ELSE
                                             (  (  NVL (ETCH_PREP, 0)
                                                 + (  NVL (ETWK_BDAM, 0)
                                                    + (  NVL (ETGD_DDAM, 0)
                                                       - NVL (ETGD_09AF, 0)))
                                                 + NVL (ETCC_CARD, 0)
                                                 + NVL (ETCK_UNON, 0)
                                                 + NVL (ETEP_SECR, 0))
                                              - 25000000)
                                       END)
                              END)
                           * 0.38)
                        - 19400000)
                 END)
        END) as  PRDD_TAXN 
  FROM YETA3000) AA, YETA3000 BB,YETA2000 CC
   WHERE AA.DPOB_CD = BB.DPOB_CD 
     AND AA.EDAC_RVYY = BB.EDAC_RVYY 
     AND AA.SETT_GBCD = BB.SETT_GBCD 
     AND AA.SYSTEMKEY = BB.SYSTEMKEY
     AND AA.DPOB_CD = CC.DPOB_CD 
     AND AA.EDAC_RVYY = CC.EDAC_RVYY 
     AND AA.SETT_GBCD = CC.SETT_GBCD 
     AND AA.SYSTEMKEY = CC.SYSTEMKEY
     AND AA.DPOB_CD=#dpobCd#
	 AND AA.EDAC_RVYY=#edacRvyy#
 	 AND AA.SETT_GBCD=#settGbcd#
	 AND AA.SYSTEMKEY=#systemkey# 
      ]]>
	</select>	
	
	<!-- <insert id="yetaPrcTaxDAO.insertYetaPrc3900_S">
		<![CDATA[
		 
		]]>
	</insert>
	
	<update id="yetaPrcTaxDAO.updateYetaPrc3900_S">
		<![CDATA[
			 
				]]>
	</update>
	
	<delete id="yetaPrcTaxDAO.deleteYetaPrc3900_S">
		<![CDATA[
			 
				]]>
	</delete>
	
	<select id="yetaPrcTaxDAO.selectYetaPrc3900_S" resultMap="yetaPrc3900">
		 
	</select>	
	<select id="yetaPrcTaxDAO.selectYetaPrc3900ListTotCnt_S" parameterClass="yetaPrc3900SerarchVO" resultClass="int">
	 
	</select> -->
</sqlMap>
