<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="Insr5100">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="insr5100SerarchVO" type="com.app.exterms.insurance.server.vo.Insr5100SrhVO"/>
	
	<resultMap id="insr5100" class="com.app.exterms.insurance.server.vo.Insr5100VO">
		<result property="dpobCd" column="DPOB_CD" columnIndex="1"/>
		<result property="systemkey" column="SYSTEMKEY" columnIndex="2"/>
	<!-- 	<result property="umytInsrSeilNum" column="UMYT_INSR_SEIL_NUM" columnIndex="3"/> -->
		<result property="emymtSeilNum" column="EMYMT_SEIL_NUM" columnIndex="4"/>
		<result property="socInsrDducEthdCd" column="SOC_INSR_DDUC_ETHD_CD" columnIndex="5"/>
		<result property="umytInsrAqtnDt" column="UMYT_INSR_AQTN_DT" columnIndex="6"/>
		<result property="umytInsrLssDt" column="UMYT_INSR_LSS_DT" columnIndex="7"/>
		<result property="umytInsrEepnYn" column="UMYT_INSR_EEPN_YN" columnIndex="8"/>
		<result property="umytInsrEepnReasCtnt" column="UMYT_INSR_EEPN_REAS_CTNT" columnIndex="9"/>
		<result property="kybdr" column="KYBDR" columnIndex="10"/>
		<result property="inptDt" column="INPT_DT" columnIndex="11"/>
		<result property="inptAddr" column="INPT_ADDR" columnIndex="12"/>
		<result property="ismt" column="ISMT" columnIndex="13"/>
		<result property="revnDt" column="REVN_DT" columnIndex="14"/>
		<result property="revnAddr" column="REVN_ADDR" columnIndex="15"/>
	</resultMap>
	
	<insert id="insr5100DAO.insertInsr5100_S">
		<![CDATA[
			INSERT INTO INSR5100 
				( DPOB_CD
				  , SYSTEMKEY 
				  , EMYMT_SEIL_NUM
				  , SOC_INSR_DDUC_ETHD_CD
				  , UMYT_INSR_AQTN_DT
				  , UMYT_INSR_LSS_DT
				  , UMYT_INSR_EEPN_YN
				  , UMYT_INSR_EEPN_REAS_CTNT
				  , KYBDR
				  , INPT_DT
				  , INPT_ADDR
				  , ISMT
				  , REVN_DT
				  , REVN_ADDR )
			VALUES ( #dpobCd#
				  , #systemkey# 
				  , #emymtSeilNum#
				  , #socInsrDducEthdCd#
				  , #umytInsrAqtnDt#
				  , #umytInsrLssDt#
				  , #umytInsrEepnYn#
				  , #umytInsrEepnReasCtnt#
				  , #kybdr#
				  , #inptDt#
				  , #inptAddr#
				  , #ismt#
				  , #revnDt#
				  , #revnAddr# )
		]]>
	</insert>
	
	<update id="insr5100DAO.updateInsr5100_S">
		<![CDATA[
			UPDATE INSR5100
			SET DPOB_CD=#dpobCd#
				, SYSTEMKEY=#systemkey# 
				, EMYMT_SEIL_NUM=#emymtSeilNum#
				, SOC_INSR_DDUC_ETHD_CD=#socInsrDducEthdCd#
				, UMYT_INSR_AQTN_DT=#umytInsrAqtnDt#
				, UMYT_INSR_LSS_DT=#umytInsrLssDt#
				, UMYT_INSR_EEPN_YN=#umytInsrEepnYn#
				, UMYT_INSR_EEPN_REAS_CTNT=#umytInsrEepnReasCtnt#
				, KYBDR=#kybdr#
				, INPT_DT=#inptDt#
				, INPT_ADDR=#inptAddr#
				, ISMT=#ismt#
				, REVN_DT=#revnDt#
				, REVN_ADDR=#revnAddr#
						WHERE DPOB_CD=#dpobCd#
								AND SYSTEMKEY=#systemkey#
								AND EMYMT_SEIL_NUM=#emymtSeilNum#
				]]>
	</update>
	
		<update id="insr5100DAO.updateXlsInsr5100_S">
		<![CDATA[	
		UPDATE INSR5100 AA
			SET  AA.UMYT_INSR_AQTN_DT=#umytInsrAqtnDt#
				, AA.ISMT=#ismt#
				, AA.REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, AA.REVN_ADDR=#revnAddr#
		WHERE AA.DPOB_CD=#dpobCd#
	      AND AA.SYSTEMKEY= (SELECT SYSTEMKEY 
                    FROM PSNL0100
                    WHERE  DPOB_CD=#dpobCd#
                                     AND  RESN_REGN_NUM = Replace(#resnRegnNum#,'-','')  
                  )
		AND AA.EMYMT_SEIL_NUM = (SELECT MAX(EMYMT_SEIL_NUM) 
                              FROM PSNL0110 TP01, PSNL0100 TP02
                              WHERE  TP01.DPOB_CD = TP02.DPOB_CD
                              AND  TP01.SYSTEMKEY = TP02.SYSTEMKEY
                              AND  TP02.RESN_REGN_NUM = Replace(#resnRegnNum#,'-','')
                              AND  TP01.DPOB_CD  = AA.DPOB_CD
                              AND  TP01.SYSTEMKEY = AA.SYSTEMKEY
                              AND  TP01.EMYMT_TYP_CD = 'A0420010')
				]]>
	</update>
	
	<delete id="insr5100DAO.deleteInsr5100_S">
		<![CDATA[
			DELETE FROM INSR5100 
						WHERE DPOB_CD=#dpobCd#
								AND SYSTEMKEY=#systemkey#
								AND  EMYMT_SEIL_NUM=#emymtSeilNum#
				]]>
	</delete>
	
	<select id="insr5100DAO.selectInsr5100_S" resultMap="insr5100">
		<![CDATA[
			SELECT
				DPOB_CD
				, SYSTEMKEY 
				, EMYMT_SEIL_NUM
				, SOC_INSR_DDUC_ETHD_CD
				, UMYT_INSR_AQTN_DT
				, UMYT_INSR_LSS_DT
				, UMYT_INSR_EEPN_YN
				, UMYT_INSR_EEPN_REAS_CTNT
				, KYBDR
				, INPT_DT
				, INPT_ADDR
				, ISMT
				, REVN_DT
				, REVN_ADDR
			FROM INSR5100
						WHERE DPOB_CD=#dpobCd#
								AND SYSTEMKEY=#systemkey#
								AND  EMYMT_SEIL_NUM=#emymtSeilNum#
				]]>
	</select>
	
	<select id="insr5100DAO.selectXlsInsr5100_S" resultMap="insr5100">
		<![CDATA[
			SELECT
				AA.DPOB_CD
				, AA.SYSTEMKEY 
				, AA.EMYMT_SEIL_NUM
				, AA.SOC_INSR_DDUC_ETHD_CD
				, AA.UMYT_INSR_AQTN_DT
				, AA.UMYT_INSR_LSS_DT
				, AA.UMYT_INSR_EEPN_YN
				, AA.UMYT_INSR_EEPN_REAS_CTNT
				, AA.KYBDR
				, AA.INPT_DT
				, AA.INPT_ADDR
				, AA.ISMT
				, AA.REVN_DT
				, AA.REVN_ADDR
			FROM INSR5100 AA
		   WHERE AA.DPOB_CD=#dpobCd#
	         AND AA.SYSTEMKEY= (SELECT SYSTEMKEY 
                    FROM PSNL0100
                    WHERE  DPOB_CD=#dpobCd#
                                     AND  RESN_REGN_NUM = Replace(#resnRegnNum#,'-','')  
                  )
		     AND AA.EMYMT_SEIL_NUM = (SELECT MAX(EMYMT_SEIL_NUM) 
                              FROM PSNL0110 TP01, PSNL0100 TP02
                              WHERE  TP01.DPOB_CD = TP02.DPOB_CD
                              AND  TP01.SYSTEMKEY = TP02.SYSTEMKEY
                              AND  TP02.RESN_REGN_NUM = Replace(#resnRegnNum#,'-','')
                              AND  TP01.DPOB_CD  = AA.DPOB_CD
                              AND  TP01.SYSTEMKEY = AA.SYSTEMKEY
                              AND  TP01.EMYMT_TYP_CD = 'A0420010')
				]]>
	</select>
	
	<select id="insr5100DAO.selectInsr5100List_D" parameterClass="insr5100SerarchVO" resultClass="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (
				SELECT
								DPOB_CD
								, SYSTEMKEY 
								, EMYMT_SEIL_NUM
								, SOC_INSR_DDUC_ETHD_CD
								, UMYT_INSR_AQTN_DT
								, UMYT_INSR_LSS_DT
								, UMYT_INSR_EEPN_YN
								, UMYT_INSR_EEPN_REAS_CTNT
								, KYBDR
								, INPT_DT
								, INPT_ADDR
								, ISMT
								, REVN_DT
								, REVN_ADDR
						FROM INSR5100
				WHERE 1=1
				<isEqual prepend="AND" property="searchCondition" compareValue="0">
					DPOB_CD = #searchKeyword#
				</isEqual>
				<isEqual prepend="AND" property="searchCondition" compareValue="1">
					SYSTEMKEY LIKE '%' || #searchKeyword# || '%'
				</isEqual>
					ORDER BY 
						DPOB_CD DESC
							, SYSTEMKEY DESC
							,  EMYMT_SEIL_NUM DESC
		
		<![CDATA[					
	) A WHERE ROWNUM <= #lastIndex#
)WHERE RNUM > #firstIndex#
]]>
	</select>	
	<select id="insr5100DAO.selectInsr5100ListTotCnt_S" parameterClass="insr5100SerarchVO" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM INSR5100
			WHERE 1=1
			<isEqual prepend="AND" property="searchCondition" compareValue="0">
				DPOB_CD = #searchKeyword#
			</isEqual>
			<isEqual prepend="AND" property="searchCondition" compareValue="1">
				SYSTEMKEY LIKE '%' || #searchKeyword# || '%'
			</isEqual>
	</select>
	
	 
	<!-- 고용보험 기본사항관리 리스트  -->
	<select id="insr5100DAO.selectInsr5100ToInsr5100List_D" parameterClass="insr5100SerarchVO" resultClass="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (
			    SELECT
                         AA.DPOB_CD
                         , AA.SYSTEMKEY 
                         , AA.EMYMT_SEIL_NUM
                         , AA.SOC_INSR_DDUC_ETHD_CD
                          ,fcBass0300CDNM(AA.DPOB_CD,NVL(AA.SOC_INSR_DDUC_ETHD_CD,'I0230200')) AS SOC_INSR_DDUC_ETHD_NM
                         , AA.SOC_INSR_DDUC_ETHD_CD AS socInsrDDucEthdCdcommCd
                         ,fcBass0300CDNM(AA.DPOB_CD,NVL(AA.SOC_INSR_DDUC_ETHD_CD,'I0230200')) AS socInsrDDucEthdCdcommCdNm
                         , AA.UMYT_INSR_AQTN_DT
                         , AA.UMYT_INSR_LSS_DT
                         , NVL(AA.UMYT_INSR_EEPN_YN,'N') AS UMYT_INSR_EEPN_YN
                         , AA.UMYT_INSR_EEPN_REAS_CTNT
                        ,BB.EMYMT_DIV_CD
                        ,fcBass0300CDNM(BB.DPOB_CD,BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM
                        ,BB.HAN_NM
                        ,BB.RESN_REGN_NUM
                        ,BB.CURR_AFFN_DEPT_CD AS DEPT_CD
                        ,fcBass0400CDNM(BB.DPOB_CD,BB.CURR_AFFN_DEPT_CD,'2') AS DEPT_NM 
                        ,BB.TYP_OCCU_CD 
                        , fcBass0320CDNM(BB.DPOB_CD,BB.TYP_OCCU_CD)  AS TYP_OCCU_NM
                        ,BB.PYSP_GRDE_CD
                        ,	 BB.DTIL_OCCU_INTTN_CD 
		         , fcBassEx0350CDNM(BB.DPOB_CD,BB.TYP_OCCU_CD,BB.DTIL_OCCU_INTTN_CD,'1' ) AS DTIL_OCCU_CLS_DIV_NM 
                        ,BB.BUSIN_CD
                        ,fcBass0500CDNM(BB.DPOB_CD,SUBSTR(BB.BUSIN_CD,1,4),BB.CURR_AFFN_DEPT_CD,BB.BUSIN_CD) AS BUSIN_NM  
                        , CC.UMYT_INSR_FLUC_DT             
                        , CC.UMYT_INSR_PAY_TOT_AMNT             
                        , CC.UMYT_INSR_PAY_MNTH_AMNT 
                        ,(TRUNC(CC.UMYT_INSR_PAY_MNTH_AMNT * (UMYT_INSR_HMLF_BRDN_APMRT / 100),-1)) AS  UMYT_INSR_MNTH_AMNT   
                        , CC.UMYT_INSR_APPTN_YN  
                FROM INSR5100 AA, PSNL0100 BB, PSNL0127 CC,
                         (
                          SELECT  DPOB_CD,   UMYT_INSR_MINM_INCM_MNTH_AMNT
                                , UMYT_INSR_BST_INCM_MNTH_AMNT, UMYT_INSR_HMLF_BRDN_APMRT, 
                                  UMYT_INSR_USR_BRDN_APMRT, UMYT_INSR_USR_SFTY_EBIS_APMRT   
                            FROM  INSR0260 A01
                            WHERE  TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN A01.UMYT_INSR_BGNN_DT AND A01.UMYT_INSR_END_DT
                         ) DD  ,
                         BASS0400 EE
                WHERE AA.DPOB_CD = BB.DPOB_CD
                  AND AA.SYSTEMKEY = BB.SYSTEMKEY
                  AND AA.DPOB_CD = CC.DPOB_CD 
                  AND AA.SYSTEMKEY = CC.SYSTEMKEY
                  AND AA.DPOB_CD = DD.DPOB_CD
                   AND  AA.EMYMT_SEIL_NUM = 
                (
                  SELECT
                       TP04.EMYMT_SEIL_NUM
                  FROM 
                 (SELECT  TP02.DPOB_CD
                        ,TP02.SYSTEMKEY
                        ,TP02.EMYMT_SEIL_NUM
                   FROM PSNL0110 TP02, (SELECT DPOB_CD,SYSTEMKEY
                                                ,MAX(EMYMT_BGNN_DT) AS EMYMT_BGNN_DT
                                                       FROM PSNL0110 TP01
                                                      WHERE TP01.EMYMT_TYP_CD = 'A0420010'
                                                      GROUP BY DPOB_CD,SYSTEMKEY) TP03 
                   WHERE  TP02.DPOB_CD = TP03.DPOB_CD
                    AND TP02.SYSTEMKEY = TP03.SYSTEMKEY
                    AND TP02.EMYMT_BGNN_DT = TP03.EMYMT_BGNN_DT) TP04
                    WHERE TP04.DPOB_CD = AA.DPOB_CD
                    AND TP04.SYSTEMKEY = AA.SYSTEMKEY
                    AND TP04.EMYMT_SEIL_NUM = AA.EMYMT_SEIL_NUM
                    )
                                            
                  AND BB.DPOB_CD = EE.DPOB_CD
                  AND BB.CURR_AFFN_DEPT_CD = EE.DEPT_CD
			 <isNotEmpty prepend="AND" property="dpobCd" >
			 	AA.DPOB_CD=#dpobCd#
		       </isNotEmpty> 
		     AND EXISTS  (
                         SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' )) ) C
                                            WHERE     C.DPOB_CD = BB.DPOB_CD
						                        AND C.DEPT_CD = BB.CURR_AFFN_DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
                                               <isNotEmpty property="deptCd" prepend="AND">
												<![CDATA[
												 C.DEPT_CD
												]]>
												<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
												 #deptCdArr[]#
												</iterate>
												</isNotEmpty> 
                                          )       
		       <isNotEmpty prepend="AND" property="businCd" >
			 	BB.BUSIN_CD=#businCd#
		       </isNotEmpty> 
		        <isNotEmpty prepend="AND" property="mangeDeptCd" >
		         BB.DEPT_CD=#mangeDeptCd#
		        </isNotEmpty>      
		        <isNotEmpty prepend="AND" property="repbtyBusinDivCd" >
		         BB.REPBTY_BUSIN_DIV_CD=#repbtyBusinDivCd#
		        </isNotEmpty>
		       <isNotEmpty property="typOccuCd" prepend="AND">
				<![CDATA[
				 BB.TYP_OCCU_CD
				]]>
				<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
				 #typOccuCdArr[]#
				</iterate>
				</isNotEmpty>  
			      <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 BB.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate>
					</isNotEmpty>  
		        <!--  <isNotEmpty property="dtilOccuClsDivCd" prepend="AND">
				<![CDATA[
				 BB.DTIL_OCCU_CLS_DIV_CD
				]]>
				<iterate prepend="IN" property="dtilOccuClsDivCdArr" open="(" close=")" conjunction=",">
				 #dtilOccuClsDivCdArr[]#
				</iterate>
				</isNotEmpty>  -->
		       <isNotEmpty prepend="AND" property="systemkey" >
			 	AA.SYSTEMKEY=#systemkey#
		       </isNotEmpty> 
		       <isNotEmpty prepend="AND" property="hanNm" >
			 	BB.HAN_NM LIKE '%' || #hanNm# || '%'
		       </isNotEmpty> 
		        <isNotEmpty prepend="AND" property="payrMangeDeptCd" >
			    EE.PAYR_MANG_DEPT_CD=#payrMangeDeptCd#
		       </isNotEmpty> 
		        <isNotEmpty property="hdofcCodtnCd" prepend="AND">
				<![CDATA[
				 BB.HDOFC_CODTN_CD
				]]>
				<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
				 #hdofcCodtnCdArr[]#
				</iterate>
				</isNotEmpty> 
		          <isNotEmpty prepend="AND" property="emymtDivCd" >
			 	BB.EMYMT_DIV_CD=#emymtDivCd#
		       </isNotEmpty>  
		          <isNotEmpty prepend="AND" property="businApptnYr" >
			 	 SUBSTR(BB.EMYMT_BGNN_DT,1,4) =#businApptnYr#
		       </isNotEmpty>  
					ORDER BY 
						AA.DPOB_CD ASC
						  ,(SELECT LPAD(DEPT_RANK,5,'0')  
                                   FROM BASS0400 DD
                                   WHERE DD.DEPT_CD = BB.CURR_AFFN_DEPT_CD
                                     AND DD.DPOB_CD = BB.DPOB_CD) ASC 
						, BB.RESN_REGN_NUM ASC  
		                , BB.DTIL_OCCU_CLS_DIV_CD ASC 
		
		<![CDATA[					
	) A WHERE ROWNUM <= #lastIndex#
)WHERE RNUM >= #firstIndex#
]]>
	</select>	
	
	<!--  AND AA.EMYMT_SEIL_NUM = (SELECT MAX(EMYMT_SEIL_NUM) 
                                            FROM PSNL0110 TP01
                                            WHERE  TP01.DPOB_CD = AA.DPOB_CD
                                            AND  TP01.SYSTEMKEY = AA.SYSTEMKEY
                                            AND  TP01.EMYMT_TYP_CD = 'A0420010') -->
	<!-- 고용보험 기본사항관리 리스트  -->
	<select id="insr5100DAO.selectInsr5100ToInsr5100ListTotCnt_S" parameterClass="insr5100SerarchVO" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM  
			(
			    SELECT
                         AA.DPOB_CD
                         , AA.SYSTEMKEY 
                         , AA.EMYMT_SEIL_NUM
                         , AA.SOC_INSR_DDUC_ETHD_CD
                         ,fcBass0300CDNM(AA.DPOB_CD,AA.SOC_INSR_DDUC_ETHD_CD) AS SOC_INSR_DDUC_ETHD_NM
                         , AA.UMYT_INSR_AQTN_DT
                         , AA.UMYT_INSR_LSS_DT
                         , AA.UMYT_INSR_EEPN_YN
                         , AA.UMYT_INSR_EEPN_REAS_CTNT
                        ,BB.EMYMT_DIV_CD
                        ,fcBass0300CDNM(BB.DPOB_CD,BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM
                        ,BB.HAN_NM
                        ,BB.RESN_REGN_NUM
                        ,BB.CURR_AFFN_DEPT_CD AS DEPT_CD
                        ,fcBass0400CDNM(BB.DPOB_CD,BB.CURR_AFFN_DEPT_CD,'2') AS DEPT_NM 
                        ,BB.TYP_OCCU_CD 
                        , fcBass0320CDNM(BB.DPOB_CD,BB.TYP_OCCU_CD) AS TYP_OCCU_NM
                        ,BB.PYSP_GRDE_CD
                        ,BB.BUSIN_CD
                        ,fcBass0500CDNM(BB.DPOB_CD,SUBSTR(BB.BUSIN_CD,1,4),BB.CURR_AFFN_DEPT_CD,BB.BUSIN_CD) AS BUSIN_NM  
                        , CC.UMYT_INSR_FLUC_DT             
                        , CC.UMYT_INSR_PAY_TOT_AMNT             
                        , CC.UMYT_INSR_PAY_MNTH_AMNT 
                        ,(TRUNC(CC.UMYT_INSR_PAY_MNTH_AMNT * (UMYT_INSR_HMLF_BRDN_APMRT / 100),-1)) AS  UMYT_INSR_MNTH_AMNT   
                        , CC.UMYT_INSR_APPTN_YN  
                FROM INSR5100 AA, PSNL0100 BB, PSNL0127 CC,
                         (
                          SELECT  DPOB_CD,   UMYT_INSR_MINM_INCM_MNTH_AMNT
                                , UMYT_INSR_BST_INCM_MNTH_AMNT, UMYT_INSR_HMLF_BRDN_APMRT, 
                                  UMYT_INSR_USR_BRDN_APMRT, UMYT_INSR_USR_SFTY_EBIS_APMRT   
                            FROM  INSR0260 A01
                            WHERE  TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN A01.UMYT_INSR_BGNN_DT AND A01.UMYT_INSR_END_DT
                         ) DD  ,
                         BASS0400 EE
                WHERE AA.DPOB_CD = BB.DPOB_CD
                  AND AA.SYSTEMKEY = BB.SYSTEMKEY
                  AND AA.DPOB_CD = CC.DPOB_CD 
                  AND AA.SYSTEMKEY = CC.SYSTEMKEY
                  AND AA.DPOB_CD = DD.DPOB_CD
                   AND  AA.EMYMT_SEIL_NUM = 
                (
                  SELECT
                       TP04.EMYMT_SEIL_NUM
                  FROM 
                 (SELECT  TP02.DPOB_CD
                        ,TP02.SYSTEMKEY
                        ,TP02.EMYMT_SEIL_NUM
                   FROM PSNL0110 TP02, (SELECT DPOB_CD,SYSTEMKEY
                                                ,MAX(EMYMT_BGNN_DT) AS EMYMT_BGNN_DT
                                                       FROM PSNL0110 TP01
                                                      WHERE TP01.EMYMT_TYP_CD = 'A0420010'
                                                      GROUP BY DPOB_CD,SYSTEMKEY) TP03 
                   WHERE  TP02.DPOB_CD = TP03.DPOB_CD
                    AND TP02.SYSTEMKEY = TP03.SYSTEMKEY
                    AND TP02.EMYMT_BGNN_DT = TP03.EMYMT_BGNN_DT) TP04
                    WHERE TP04.DPOB_CD = AA.DPOB_CD
                    AND TP04.SYSTEMKEY = AA.SYSTEMKEY
                    AND TP04.EMYMT_SEIL_NUM = AA.EMYMT_SEIL_NUM
                    ) 
                                            
                  AND BB.DPOB_CD = EE.DPOB_CD
                  AND BB.CURR_AFFN_DEPT_CD = EE.DEPT_CD
			 <isNotEmpty prepend="AND" property="dpobCd" >
			 	AA.DPOB_CD=#dpobCd#
		       </isNotEmpty> 
		     AND EXISTS  (
                        SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (  SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' ))) C
                                            WHERE     C.DPOB_CD = BB.DPOB_CD
						                        AND C.DEPT_CD = BB.CURR_AFFN_DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
                                               <isNotEmpty property="deptCd" prepend="AND">
												<![CDATA[
												 C.DEPT_CD
												]]>
												<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
												 #deptCdArr[]#
												</iterate>
												</isNotEmpty> 
                                          )       
		       <isNotEmpty prepend="AND" property="businCd" >
			 	BB.BUSIN_CD=#businCd#
		       </isNotEmpty> 
		        <isNotEmpty prepend="AND" property="mangeDeptCd" >
		         BB.DEPT_CD=#mangeDeptCd#
		        </isNotEmpty>      
		        <isNotEmpty prepend="AND" property="repbtyBusinDivCd" >
		         BB.REPBTY_BUSIN_DIV_CD=#repbtyBusinDivCd#
		        </isNotEmpty> 
		       <isNotEmpty property="typOccuCd" prepend="AND">
				<![CDATA[
				 BB.TYP_OCCU_CD
				]]>
				<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
				 #typOccuCdArr[]#
				</iterate>
				</isNotEmpty>  
			     <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 BB.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate>
					</isNotEmpty>  
		        <!--  <isNotEmpty property="dtilOccuClsDivCd" prepend="AND">
				<![CDATA[
				 BB.DTIL_OCCU_CLS_DIV_CD
				]]>
				<iterate prepend="IN" property="dtilOccuClsDivCdArr" open="(" close=")" conjunction=",">
				 #dtilOccuClsDivCdArr[]#
				</iterate>
				</isNotEmpty>  -->
		       <isNotEmpty prepend="AND" property="systemkey" >
			 	AA.SYSTEMKEY=#systemkey#
		       </isNotEmpty> 
		       <isNotEmpty prepend="AND" property="hanNm" >
			 	BB.HAN_NM LIKE '%' || #hanNm# || '%'
		       </isNotEmpty> 
		        <isNotEmpty prepend="AND" property="payrMangeDeptCd" >
			    EE.PAYR_MANG_DEPT_CD=#payrMangeDeptCd#
		       </isNotEmpty> 
		        <isNotEmpty property="hdofcCodtnCd" prepend="AND">
				<![CDATA[
				 BB.HDOFC_CODTN_CD
				]]>
				<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
				 #hdofcCodtnCdArr[]#
				</iterate>
				</isNotEmpty> 
		          <isNotEmpty prepend="AND" property="emymtDivCd" >
			 	BB.EMYMT_DIV_CD=#emymtDivCd#
		       </isNotEmpty>  
		          <isNotEmpty prepend="AND" property="businApptnYr" >
			 	 SUBSTR(BB.EMYMT_BGNN_DT,1,4) =#businApptnYr#
		       </isNotEmpty>  
			)
	</select>
	
	
	<!-- 고용보험 기본관리 조회쿼리 엑셀저장   -->
	<select id="insr5100DAO.selectXlsInsr5100List_D" parameterClass="insr5100SerarchVO" resultClass="egovMap">

	SELECT A.*, ROWNUM RNUM FROM (
			    SELECT
                         AA.DPOB_CD
                         , AA.SYSTEMKEY 
                         , AA.EMYMT_SEIL_NUM
                         , AA.SOC_INSR_DDUC_ETHD_CD
                          ,fcBass0300CDNM(AA.DPOB_CD,NVL(AA.SOC_INSR_DDUC_ETHD_CD,'I0230200')) AS SOC_INSR_DDUC_ETHD_NM
                         , AA.SOC_INSR_DDUC_ETHD_CD AS socInsrDDucEthdCdcommCd
                         ,fcBass0300CDNM(AA.DPOB_CD,NVL(AA.SOC_INSR_DDUC_ETHD_CD,'I0230200')) AS socInsrDDucEthdCdcommCdNm
                         , AA.UMYT_INSR_AQTN_DT
                         , AA.UMYT_INSR_LSS_DT
                         , NVL(AA.UMYT_INSR_EEPN_YN,'N') AS UMYT_INSR_EEPN_YN
                         , AA.UMYT_INSR_EEPN_REAS_CTNT
                        ,BB.EMYMT_DIV_CD
                        ,fcBass0300CDNM(BB.DPOB_CD,BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM
                        ,BB.HAN_NM
                        ,BB.RESN_REGN_NUM
                        ,BB.CURR_AFFN_DEPT_CD AS DEPT_CD
                        ,fcBass0400CDNM(BB.DPOB_CD,BB.CURR_AFFN_DEPT_CD,'2') AS DEPT_NM 
                        ,BB.TYP_OCCU_CD 
                        , fcBass0320CDNM(BB.DPOB_CD,BB.TYP_OCCU_CD)  AS TYP_OCCU_NM
                        ,BB.PYSP_GRDE_CD
                        ,	 BB.DTIL_OCCU_INTTN_CD 
		         , fcBassEx0350CDNM(BB.DPOB_CD,BB.TYP_OCCU_CD,BB.DTIL_OCCU_INTTN_CD,'1' ) AS DTIL_OCCU_CLS_DIV_NM 
                        ,BB.BUSIN_CD
                        ,fcBass0500CDNM(BB.DPOB_CD,SUBSTR(BB.BUSIN_CD,1,4),BB.CURR_AFFN_DEPT_CD,BB.BUSIN_CD) AS BUSIN_NM  
                        , CC.UMYT_INSR_FLUC_DT             
                        , CC.UMYT_INSR_PAY_TOT_AMNT             
                        , CC.UMYT_INSR_PAY_MNTH_AMNT 
                        ,(TRUNC(CC.UMYT_INSR_PAY_MNTH_AMNT * (UMYT_INSR_HMLF_BRDN_APMRT / 100),-1)) AS  UMYT_INSR_MNTH_AMNT   
                        , CC.UMYT_INSR_APPTN_YN  
                FROM INSR5100 AA, PSNL0100 BB, PSNL0127 CC,
                         (
                          SELECT  DPOB_CD,   UMYT_INSR_MINM_INCM_MNTH_AMNT
                                , UMYT_INSR_BST_INCM_MNTH_AMNT, UMYT_INSR_HMLF_BRDN_APMRT, 
                                  UMYT_INSR_USR_BRDN_APMRT, UMYT_INSR_USR_SFTY_EBIS_APMRT   
                            FROM  INSR0260 A01
                            WHERE  TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN A01.UMYT_INSR_BGNN_DT AND A01.UMYT_INSR_END_DT
                         ) DD  ,
                         BASS0400 EE
                WHERE AA.DPOB_CD = BB.DPOB_CD
                  AND AA.SYSTEMKEY = BB.SYSTEMKEY
                  AND AA.DPOB_CD = CC.DPOB_CD 
                  AND AA.SYSTEMKEY = CC.SYSTEMKEY
                  AND AA.DPOB_CD = DD.DPOB_CD
                   AND  AA.EMYMT_SEIL_NUM = 
                (
                  SELECT
                       TP04.EMYMT_SEIL_NUM
                  FROM 
                 (SELECT  TP02.DPOB_CD
                        ,TP02.SYSTEMKEY
                        ,TP02.EMYMT_SEIL_NUM
                   FROM PSNL0110 TP02, (SELECT DPOB_CD,SYSTEMKEY
                                                ,MAX(EMYMT_BGNN_DT) AS EMYMT_BGNN_DT
                                                       FROM PSNL0110 TP01
                                                      WHERE TP01.EMYMT_TYP_CD = 'A0420010'
                                                      GROUP BY DPOB_CD,SYSTEMKEY) TP03 
                   WHERE  TP02.DPOB_CD = TP03.DPOB_CD
                    AND TP02.SYSTEMKEY = TP03.SYSTEMKEY
                    AND TP02.EMYMT_BGNN_DT = TP03.EMYMT_BGNN_DT) TP04
                    WHERE TP04.DPOB_CD = AA.DPOB_CD
                    AND TP04.SYSTEMKEY = AA.SYSTEMKEY
                    AND TP04.EMYMT_SEIL_NUM = AA.EMYMT_SEIL_NUM
                    )
                                            
                  AND BB.DPOB_CD = EE.DPOB_CD
                  AND BB.CURR_AFFN_DEPT_CD = EE.DEPT_CD
			 <isNotEmpty prepend="AND" property="dpobCd" >
			 	AA.DPOB_CD=#dpobCd#
		       </isNotEmpty> 
		     AND EXISTS  (
                         SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' )) ) C
                                            WHERE     C.DPOB_CD = BB.DPOB_CD
						                        AND C.DEPT_CD = BB.CURR_AFFN_DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
                                               <isNotEmpty property="deptCd" prepend="AND">
												<![CDATA[
												 C.DEPT_CD
												]]>
												<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
												 #deptCdArr[]#
												</iterate>
												</isNotEmpty> 
                                          )       
		       <isNotEmpty prepend="AND" property="businCd" >
			 	BB.BUSIN_CD=#businCd#
		       </isNotEmpty> 
		        <isNotEmpty prepend="AND" property="mangeDeptCd" >
		         BB.DEPT_CD=#mangeDeptCd#
		        </isNotEmpty>      
		        <isNotEmpty prepend="AND" property="repbtyBusinDivCd" >
		         BB.REPBTY_BUSIN_DIV_CD=#repbtyBusinDivCd#
		        </isNotEmpty>
		       <isNotEmpty property="typOccuCd" prepend="AND">
				<![CDATA[
				 BB.TYP_OCCU_CD
				]]>
				<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
				 #typOccuCdArr[]#
				</iterate>
				</isNotEmpty>  
			      <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 BB.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate>
					</isNotEmpty>  
		        <!--  <isNotEmpty property="dtilOccuClsDivCd" prepend="AND">
				<![CDATA[
				 BB.DTIL_OCCU_CLS_DIV_CD
				]]>
				<iterate prepend="IN" property="dtilOccuClsDivCdArr" open="(" close=")" conjunction=",">
				 #dtilOccuClsDivCdArr[]#
				</iterate>
				</isNotEmpty>  -->
		       <isNotEmpty prepend="AND" property="systemkey" >
		        <![CDATA[
				 AA.SYSTEMKEY
				]]>
			 		<iterate prepend="IN" property="systemKeyArr" open="(" close=")" conjunction=",">
							 #systemKeyArr[]#
					</iterate>			
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="hanNm" >
			 	BB.HAN_NM LIKE '%' || #hanNm# || '%'
		       </isNotEmpty> 
		        <isNotEmpty prepend="AND" property="payrMangeDeptCd" >
			    EE.PAYR_MANG_DEPT_CD=#payrMangeDeptCd#
		       </isNotEmpty> 
		        <isNotEmpty property="hdofcCodtnCd" prepend="AND">
				<![CDATA[
				 BB.HDOFC_CODTN_CD
				]]>
				<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
				 #hdofcCodtnCdArr[]#
				</iterate>
				</isNotEmpty> 
		          <isNotEmpty prepend="AND" property="emymtDivCd" >
			 	BB.EMYMT_DIV_CD=#emymtDivCd#
		       </isNotEmpty>  
		          <isNotEmpty prepend="AND" property="businApptnYr" >
			 	 SUBSTR(BB.EMYMT_BGNN_DT,1,4) =#businApptnYr#
		       </isNotEmpty>  
					ORDER BY 
						AA.DPOB_CD ASC
						  ,(SELECT LPAD(DEPT_RANK,5,'0')  
                                   FROM BASS0400 DD
                                   WHERE DD.DEPT_CD = BB.CURR_AFFN_DEPT_CD
                                     AND DD.DPOB_CD = BB.DPOB_CD) ASC 
						, BB.RESN_REGN_NUM ASC  
		                , BB.DTIL_OCCU_CLS_DIV_CD ASC 
		
							
	) A 

</select>		
	
	<!-- 고용보험 월별납부내역 리스트  -->
	<select id="insr5100DAO.selectInsrP510001ToInsr5100List_D" parameterClass="insr5100SerarchVO" resultClass="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (
			   SELECT
                         AA.DPOB_CD
                        , AA.PYMT_YR_MNTH
                        ,AA.SYSTEMKEY 
                        ,AA.EMYMT_DIV_CD
                        ,fcBass0300CDNM(AA.DPOB_CD,AA.EMYMT_DIV_CD) AS EMYMT_DIV_NM
                        ,AA.HAN_NM
                        ,AA.RESN_REGN_NUM
                        ,AA.DEPT_CD AS DEPT_CD
                        ,fcBass0400CDNM(AA.DPOB_CD,AA.DEPT_CD,'2') AS DEPT_NM 
                        ,AA.TYP_OCCU_CD 
                        , fcBass0320CDNM(AA.DPOB_CD,AA.TYP_OCCU_CD) AS TYP_OCCU_NM
                        ,AA.PYSP_GRDE_CD
                        ,	 AA.DTIL_OCCU_INTTN_CD 
		         , fcBassEx0350CDNM(AA.DPOB_CD,AA.TYP_OCCU_CD,AA.DTIL_OCCU_INTTN_CD,'1' ) AS DTIL_OCCU_CLS_DIV_NM 
                        ,AA.BUSIN_CD
                        ,fcBass0500CDNM(AA.DPOB_CD,SUBSTR(AA.PYMT_YR_MNTH,1,4),AA.DEPT_CD,AA.BUSIN_CD) AS BUSIN_NM  
                         , NVL(CC.PYMT_DDUC_D0160100,0) AS PYMT_DDUC_D0160100
                        , NVL(CC.PYMT_DDUC_D0160200,0) AS PYMT_DDUC_D0160200   
                        , NVL(CC.PYMT_DDUC_D0160300,0) AS PYMT_DDUC_D0160300
                        , (NVL(CC.PYMT_DDUC_D0160100,0) + NVL(CC.PYMT_DDUC_D0160200,0) + NVL(CC.PYMT_DDUC_D0160300,0)) AS PYMT_DDUC_SUM
                        , DD.NAT_PENN_STD_INCM_MNTH_AMNT
                        , DD.NAT_PENN_GRDE
                FROM PAYR0304 AA, PAYR0300 BB,  
                     (
                     SELECT
                              DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                              PAYR_SEIL_NUM, SYSTEMKEY,
                              DECODE(PYMT_DDUC_D0160100 ,-1000000000,0,PYMT_DDUC_D0160100 ) AS  PYMT_DDUC_D0160100, 
                              DECODE(PYMT_DDUC_D0160200 ,-1000000000,0,PYMT_DDUC_D0160200 ) AS  PYMT_DDUC_D0160200,
                              DECODE(PYMT_DDUC_D0160300 ,-1000000000,0,PYMT_DDUC_D0160300) AS  PYMT_DDUC_D0160300
                        FROM 
                        (SELECT
                              DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                              PAYR_SEIL_NUM, SYSTEMKEY,
                              MAX(DECODE(PAY_ITEM_CD ,'D0160100',PYMT_DDUC_SUM,-1000000000)) AS  PYMT_DDUC_D0160100, 
                              MAX(DECODE(PAY_ITEM_CD ,'D0160200',PYMT_DDUC_SUM,-1000000000)) AS  PYMT_DDUC_D0160200,
                              MAX(DECODE(PAY_ITEM_CD ,'D0160300',PYMT_DDUC_SUM,-1000000000)) AS  PYMT_DDUC_D0160300  
                        FROM 
                        (SELECT 
                           DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                           PAYR_SEIL_NUM, SYSTEMKEY, PAY_ITEM_CD ,  
                           SUM(PYMT_DDUC_SUM) AS PYMT_DDUC_SUM 
                        FROM PAYR0302 
                        WHERE PAY_ITEM_CD IN  ('D0160100','D0160200','D0160300') 
                        GROUP BY DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                                 PAYR_SEIL_NUM, SYSTEMKEY, PAY_ITEM_CD) 
                        GROUP BY DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                           PAYR_SEIL_NUM, SYSTEMKEY)
                     ) CC, 
                     PAYR0309 DD  
                WHERE AA.DPOB_CD=BB.DPOB_CD 
                  AND AA.PYMT_YR_MNTH  = BB.PYMT_YR_MNTH
                  AND AA.PAY_CD  = BB.PAY_CD
                  AND AA.PAYR_SEIL_NUM  = BB.PAYR_SEIL_NUM(+) 
                  AND AA.PYMT_YR_MNTH = CC.PYMT_YR_MNTH(+)
                  AND AA.SYSTEMKEY = CC.SYSTEMKEY(+)
                  AND AA.DPOB_CD=CC.DPOB_CD(+)
                  AND AA.PAY_CD = CC.PAY_CD(+) 
                  AND AA.PAYR_SEIL_NUM  = CC.PAYR_SEIL_NUM(+)   
                  AND AA.PYMT_YR_MNTH = DD.PYMT_YR_MNTH(+)
                  AND AA.SYSTEMKEY = DD.SYSTEMKEY(+)
                  AND AA.DPOB_CD=DD.DPOB_CD(+)
                  AND AA.PAY_CD = DD.PAY_CD(+) 
                  AND AA.PAYR_SEIL_NUM  = DD.PAYR_SEIL_NUM(+) 
                   <isNotEmpty prepend="AND" property="dpobCd" >
			 	     AA.DPOB_CD=#dpobCd#
		           </isNotEmpty> 
		                AND EXISTS  (
                         SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (  SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' )) ) C
                                            WHERE     C.DPOB_CD = AA.DPOB_CD
						                        AND C.DEPT_CD = AA.DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(AA.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(AA.DTIL_OCCU_INTTN_CD,'TT')
                                               <isNotEmpty property="deptCd" prepend="AND">
												<![CDATA[
												 C.DEPT_CD
												]]>
												<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
												 #deptCdArr[]#
												</iterate>
												</isNotEmpty> 
                                          ) 
				       <isNotEmpty prepend="AND" property="businCd" >
					 	AA.BUSIN_CD=#businCd#
				       </isNotEmpty> 
				       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
					 	AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
				       </isNotEmpty> 
				       <isNotEmpty prepend="AND" property="emymtDivCd" >
					 	AA.EMYMT_DIV_CD=#emymtDivCd#
					 	</isNotEmpty> 
				         <isNotEmpty prepend="AND" property="pymtYrMnth" >
					 	AA.PYMT_YR_MNTH = #pymtYrMnth#
				       </isNotEmpty>  
 					<isNotEmpty property="typOccuCd" prepend="AND">
					<![CDATA[
					 AA.TYP_OCCU_CD
					]]>
					<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
					 #typOccuCdArr[]#
					</iterate>
					</isNotEmpty>  
				   <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 AA.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate>
					</isNotEmpty>  
					<!--   <isNotEmpty property="dtilOccuClsDivCd" prepend="AND">
					<![CDATA[
					 AA.DTIL_OCCU_CLS_DIV_CD
					]]>
					<iterate prepend="IN" property="dtilOccuClsDivCdArr" open="(" close=")" conjunction=",">
					 #dtilOccuClsDivCdArr[]#
					</iterate>
					</isNotEmpty>   -->
					 <isNotEmpty property="hdofcCodtnCd" prepend="AND">
				<![CDATA[
				 AA.HDOFC_DIV_CD
				]]>
				<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
				 #hdofcCodtnCdArr[]#
				</iterate>
				</isNotEmpty> 
				          <isNotEmpty prepend="AND" property="systemkey" >
					 	AA.SYSTEMKEY=#systemkey#
				       </isNotEmpty>  
				       <isNotEmpty prepend="AND" property="hanNm" >
					 	AA.HAN_NM LIKE '%' || #hanNm# || '%'
				       </isNotEmpty>  
					ORDER BY   AA.PYMT_YR_MNTH DESC
						    , AA.PAYR_MANG_DEPT_CD DESC
						    , AA.PAY_CD DESC 
							, AA.PAYR_SEIL_NUM DESC
							 ,(SELECT LPAD(DEPT_RANK,5,'0')  
                                   FROM BASS0400 DD
                                   WHERE DD.DEPT_CD =  AA.DEPT_CD  
                                     AND DD.DPOB_CD = AA.DPOB_CD) ASC 
						    , AA.RESN_REGN_NUM ASC
							, AA.SYSTEMKEY DESC 
                  
		<![CDATA[					
	) A WHERE ROWNUM <= #lastIndex#
)WHERE RNUM >= #firstIndex#
]]>
	</select>	
	<!-- 고용보험 월별납부내역 리스트  -->
	<select id="insr5100DAO.selectInsrP510001ToInsr5100ListTotCnt_S" parameterClass="insr5100SerarchVO" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM  
			(
			  SELECT
                         AA.DPOB_CD
                        , AA.PYMT_YR_MNTH
                        ,AA.SYSTEMKEY 
                        ,AA.EMYMT_DIV_CD
                        ,fcBass0300CDNM(AA.DPOB_CD,AA.EMYMT_DIV_CD) AS EMYMT_DIV_NM
                        ,AA.HAN_NM
                        ,AA.RESN_REGN_NUM
                        ,AA.DEPT_CD AS DEPT_CD
                        ,fcBass0400CDNM(AA.DPOB_CD,AA.DEPT_CD,'2') AS DEPT_NM 
                        ,AA.TYP_OCCU_CD 
                        , fcBass0320CDNM(AA.DPOB_CD,AA.TYP_OCCU_CD)  AS TYP_OCCU_NM
                        ,AA.PYSP_GRDE_CD
                        ,AA.BUSIN_CD
                        ,fcBass0500CDNM(AA.DPOB_CD,SUBSTR(AA.PYMT_YR_MNTH,1,4),AA.DEPT_CD,AA.BUSIN_CD) AS BUSIN_NM  
                         , NVL(CC.PYMT_DDUC_D0160100,0) AS PYMT_DDUC_D0160100
                        , NVL(CC.PYMT_DDUC_D0160200,0) AS PYMT_DDUC_D0160200   
                        , NVL(CC.PYMT_DDUC_D0160300,0) AS PYMT_DDUC_D0160300
                        , (NVL(CC.PYMT_DDUC_D0160100,0) + NVL(CC.PYMT_DDUC_D0160200,0) + NVL(CC.PYMT_DDUC_D0160300,0)) AS PYMT_DDUC_SUM
                        , DD.NAT_PENN_STD_INCM_MNTH_AMNT
                        , DD.NAT_PENN_GRDE
                FROM PAYR0304 AA, PAYR0300 BB,  
                     (
                     SELECT
                              DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                              PAYR_SEIL_NUM, SYSTEMKEY,
                              DECODE(PYMT_DDUC_D0160100 ,-1000000000,0,PYMT_DDUC_D0160100 ) AS  PYMT_DDUC_D0160100, 
                              DECODE(PYMT_DDUC_D0160200 ,-1000000000,0,PYMT_DDUC_D0160200 ) AS  PYMT_DDUC_D0160200,
                              DECODE(PYMT_DDUC_D0160300 ,-1000000000,0,PYMT_DDUC_D0160300) AS  PYMT_DDUC_D0160300
                        FROM 
                        (SELECT
                              DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                              PAYR_SEIL_NUM, SYSTEMKEY,
                              MAX(DECODE(PAY_ITEM_CD ,'D0160100',PYMT_DDUC_SUM,-1000000000)) AS  PYMT_DDUC_D0160100, 
                              MAX(DECODE(PAY_ITEM_CD ,'D0160200',PYMT_DDUC_SUM,-1000000000)) AS  PYMT_DDUC_D0160200,
                              MAX(DECODE(PAY_ITEM_CD ,'D0160300',PYMT_DDUC_SUM,-1000000000)) AS  PYMT_DDUC_D0160300  
                        FROM 
                        (SELECT 
                           DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                           PAYR_SEIL_NUM, SYSTEMKEY, PAY_ITEM_CD ,  
                           SUM(PYMT_DDUC_SUM) AS PYMT_DDUC_SUM 
                        FROM PAYR0302 
                        WHERE PAY_ITEM_CD IN  ('D0160100','D0160200','D0160300') 
                        GROUP BY DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                                 PAYR_SEIL_NUM, SYSTEMKEY, PAY_ITEM_CD) 
                        GROUP BY DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                           PAYR_SEIL_NUM, SYSTEMKEY)
                     ) CC, 
                     PAYR0309 DD  
                WHERE AA.DPOB_CD=BB.DPOB_CD 
                  AND AA.PYMT_YR_MNTH  = BB.PYMT_YR_MNTH
                  AND AA.PAY_CD  = BB.PAY_CD
                  AND AA.PAYR_SEIL_NUM  = BB.PAYR_SEIL_NUM(+) 
                  AND AA.PYMT_YR_MNTH = CC.PYMT_YR_MNTH(+)
                  AND AA.SYSTEMKEY = CC.SYSTEMKEY(+)
                  AND AA.DPOB_CD=CC.DPOB_CD(+)
                  AND AA.PAY_CD = CC.PAY_CD(+) 
                  AND AA.PAYR_SEIL_NUM  = CC.PAYR_SEIL_NUM(+)   
                  AND AA.PYMT_YR_MNTH = DD.PYMT_YR_MNTH(+)
                  AND AA.SYSTEMKEY = DD.SYSTEMKEY(+)
                  AND AA.DPOB_CD=DD.DPOB_CD(+)
                  AND AA.PAY_CD = DD.PAY_CD(+) 
                  AND AA.PAYR_SEIL_NUM  = DD.PAYR_SEIL_NUM(+) 
                   <isNotEmpty prepend="AND" property="dpobCd" >
			 	     AA.DPOB_CD=#dpobCd#
		           </isNotEmpty> 
		                AND EXISTS  (
                        SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' ))) C
                                            WHERE     C.DPOB_CD = AA.DPOB_CD
						                        AND C.DEPT_CD = AA.DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(AA.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(AA.DTIL_OCCU_INTTN_CD,'TT')
                                               <isNotEmpty property="deptCd" prepend="AND">
												<![CDATA[
												 C.DEPT_CD
												]]>
												<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
												 #deptCdArr[]#
												</iterate>
												</isNotEmpty> 
                                          ) 
				       <isNotEmpty prepend="AND" property="businCd" >
					 	AA.BUSIN_CD=#businCd#
				       </isNotEmpty> 
				       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
					 	AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
				       </isNotEmpty> 
				       <isNotEmpty prepend="AND" property="emymtDivCd" >
					 	AA.EMYMT_DIV_CD=#emymtDivCd#
					 	</isNotEmpty> 
				         <isNotEmpty prepend="AND" property="pymtYrMnth" >
					 	AA.PYMT_YR_MNTH = #pymtYrMnth#
				       </isNotEmpty>  
 					<isNotEmpty property="typOccuCd" prepend="AND">
					<![CDATA[
					 AA.TYP_OCCU_CD
					]]>
					<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
					 #typOccuCdArr[]#
					</iterate>
					</isNotEmpty>  
				   <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 AA.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate>
					</isNotEmpty>  
					<!--   <isNotEmpty property="dtilOccuClsDivCd" prepend="AND">
					<![CDATA[
					 AA.DTIL_OCCU_CLS_DIV_CD
					]]>
					<iterate prepend="IN" property="dtilOccuClsDivCdArr" open="(" close=")" conjunction=",">
					 #dtilOccuClsDivCdArr[]#
					</iterate>
					</isNotEmpty>   -->
					 <isNotEmpty property="hdofcCodtnCd" prepend="AND">
				<![CDATA[
				 AA.HDOFC_DIV_CD
				]]>
				<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
				 #hdofcCodtnCdArr[]#
				</iterate>
				</isNotEmpty> 
				          <isNotEmpty prepend="AND" property="systemkey" >
					 	AA.SYSTEMKEY=#systemkey#
				       </isNotEmpty>  
				       <isNotEmpty prepend="AND" property="hanNm" >
					 	AA.HAN_NM LIKE '%' || #hanNm# || '%'
				       </isNotEmpty>  
			)
	</select> 

	<!-- 고용보험 월별납부 엑셀 개인별 리스트 -->
	<select id="insr5100DAO.selectXlsInsrP51000102ToInsr5100List_D" parameterClass="insr5100SerarchVO" resultClass="egovMap">

	SELECT A.*, ROWNUM FROM (
			   SELECT
                         AA.DPOB_CD
                        , AA.PYMT_YR_MNTH
                        ,AA.SYSTEMKEY 
                        ,AA.EMYMT_DIV_CD
                        ,fcBass0300CDNM(AA.DPOB_CD,AA.EMYMT_DIV_CD) AS EMYMT_DIV_NM
                        ,AA.HAN_NM
                        ,AA.RESN_REGN_NUM
                        ,AA.DEPT_CD AS DEPT_CD
                        ,fcBass0400CDNM(AA.DPOB_CD,AA.DEPT_CD,'2') AS DEPT_NM 
                        ,AA.TYP_OCCU_CD 
                        , fcBass0320CDNM(AA.DPOB_CD,AA.TYP_OCCU_CD) AS TYP_OCCU_NM
                        ,AA.PYSP_GRDE_CD
                        ,	 AA.DTIL_OCCU_INTTN_CD 
		                , fcBassEx0350CDNM(AA.DPOB_CD,AA.TYP_OCCU_CD,AA.DTIL_OCCU_INTTN_CD,'1' ) AS DTIL_OCCU_CLS_DIV_NM 
                        ,AA.BUSIN_CD
                        ,fcBass0500CDNM(AA.DPOB_CD,SUBSTR(AA.PYMT_YR_MNTH,1,4),AA.DEPT_CD,AA.BUSIN_CD) AS BUSIN_NM  
                         , NVL(CC.PYMT_DDUC_D0160100,0) AS PYMT_DDUC_D0160100
                        , NVL(CC.PYMT_DDUC_D0160200,0) AS PYMT_DDUC_D0160200   
                        , NVL(CC.PYMT_DDUC_D0160300,0) AS PYMT_DDUC_D0160300
                        , (NVL(CC.PYMT_DDUC_D0160100,0) + NVL(CC.PYMT_DDUC_D0160200,0) + NVL(CC.PYMT_DDUC_D0160300,0)) AS PYMT_DDUC_SUM
                        , DD.NAT_PENN_STD_INCM_MNTH_AMNT
                        , DD.NAT_PENN_GRDE
                        , EE.UMYT_INSR_PAY_TOT_AMNT
                        , EE.UMYT_INSR_PAY_MNTH_AMNT
                        
                        
                FROM PAYR0304 AA, PAYR0300 BB,  
                     (
                     SELECT
                              DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                              PAYR_SEIL_NUM, SYSTEMKEY,
                              DECODE(PYMT_DDUC_D0160100 ,-1000000000,0,PYMT_DDUC_D0160100 ) AS  PYMT_DDUC_D0160100, 
                              DECODE(PYMT_DDUC_D0160200 ,-1000000000,0,PYMT_DDUC_D0160200 ) AS  PYMT_DDUC_D0160200,
                              DECODE(PYMT_DDUC_D0160300 ,-1000000000,0,PYMT_DDUC_D0160300) AS  PYMT_DDUC_D0160300
                        FROM 
                        (SELECT
                              DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                              PAYR_SEIL_NUM, SYSTEMKEY,
                              MAX(DECODE(PAY_ITEM_CD ,'D0160100',PYMT_DDUC_SUM,-1000000000)) AS  PYMT_DDUC_D0160100, 
                              MAX(DECODE(PAY_ITEM_CD ,'D0160200',PYMT_DDUC_SUM,-1000000000)) AS  PYMT_DDUC_D0160200,
                              MAX(DECODE(PAY_ITEM_CD ,'D0160300',PYMT_DDUC_SUM,-1000000000)) AS  PYMT_DDUC_D0160300  
                        FROM 
                        (SELECT 
                           DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                           PAYR_SEIL_NUM, SYSTEMKEY, PAY_ITEM_CD ,  
                           SUM(PYMT_DDUC_SUM) AS PYMT_DDUC_SUM 
                        FROM PAYR0302 
                        WHERE PAY_ITEM_CD IN  ('D0160100','D0160200','D0160300') 
                        GROUP BY DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                                 PAYR_SEIL_NUM, SYSTEMKEY, PAY_ITEM_CD) 
                        GROUP BY DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                           PAYR_SEIL_NUM, SYSTEMKEY)
                     ) CC, 
                     PAYR0309 DD,  
                     PSNL0127 EE
                WHERE AA.DPOB_CD=BB.DPOB_CD 
                  AND AA.PYMT_YR_MNTH  = BB.PYMT_YR_MNTH
                  AND AA.PAY_CD  = BB.PAY_CD
                  
                   AND AA.DPOB_CD = EE.DPOB_CD
                   AND AA.SYSTEMKEY = EE.SYSTEMKEY
                   
                  
                  AND AA.PAYR_SEIL_NUM  = BB.PAYR_SEIL_NUM(+) 
                  AND AA.PYMT_YR_MNTH = CC.PYMT_YR_MNTH(+)
                  AND AA.SYSTEMKEY = CC.SYSTEMKEY(+)
                  AND AA.DPOB_CD=CC.DPOB_CD(+)
                  AND AA.PAY_CD = CC.PAY_CD(+) 
                  AND AA.PAYR_SEIL_NUM  = CC.PAYR_SEIL_NUM(+)   
                  AND AA.PYMT_YR_MNTH = DD.PYMT_YR_MNTH(+)
                  AND AA.SYSTEMKEY = DD.SYSTEMKEY(+)
                  AND AA.DPOB_CD=DD.DPOB_CD(+)
                  AND AA.PAY_CD = DD.PAY_CD(+) 
                  AND AA.PAYR_SEIL_NUM  = DD.PAYR_SEIL_NUM(+) 
                   <isNotEmpty prepend="AND" property="dpobCd" >
			 	     AA.DPOB_CD=#dpobCd#
		           </isNotEmpty> 
		                AND EXISTS  (
                         SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' )) ) C
                                            WHERE     C.DPOB_CD = AA.DPOB_CD
						                        AND C.DEPT_CD = AA.DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(AA.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(AA.DTIL_OCCU_INTTN_CD,'TT')
                                               <isNotEmpty property="deptCd" prepend="AND">
												<![CDATA[
												 C.DEPT_CD
												]]>
												<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
												 #deptCdArr[]#
												</iterate>
												</isNotEmpty> 
                                          ) 
				       <isNotEmpty prepend="AND" property="businCd" >
					 	AA.BUSIN_CD=#businCd#
				       </isNotEmpty> 
				       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
					 	AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
				       </isNotEmpty> 
				       <isNotEmpty prepend="AND" property="emymtDivCd" >
					 	AA.EMYMT_DIV_CD=#emymtDivCd#
					 	</isNotEmpty> 
				         <isNotEmpty prepend="AND" property="pymtYrMnth" >
					 	AA.PYMT_YR_MNTH = #pymtYrMnth#
				       </isNotEmpty>  
 					<isNotEmpty property="typOccuCd" prepend="AND">
					<![CDATA[
					 AA.TYP_OCCU_CD
					]]>
					<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
					 #typOccuCdArr[]#
					</iterate>
					</isNotEmpty>  
				   <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 AA.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate>
					</isNotEmpty>  
					<!--   <isNotEmpty property="dtilOccuClsDivCd" prepend="AND">
					<![CDATA[
					 AA.DTIL_OCCU_CLS_DIV_CD
					]]>
					<iterate prepend="IN" property="dtilOccuClsDivCdArr" open="(" close=")" conjunction=",">
					 #dtilOccuClsDivCdArr[]#
					</iterate>
					</isNotEmpty>   -->
					 <isNotEmpty property="hdofcCodtnCd" prepend="AND">
				<![CDATA[
				 AA.HDOFC_DIV_CD
				]]>
				<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
				 #hdofcCodtnCdArr[]#
				</iterate>
				</isNotEmpty> 
 				<isNotEmpty prepend="AND" property="systemkey" >
		        <![CDATA[
				 AA.SYSTEMKEY
				]]>
			 		<iterate prepend="IN" property="systemKeyArr" open="(" close=")" conjunction=",">
							 #systemKeyArr[]#
					</iterate>			
		       </isNotEmpty>  
				       <isNotEmpty prepend="AND" property="hanNm" >
					 	AA.HAN_NM LIKE '%' || #hanNm# || '%'
				       </isNotEmpty>  
					ORDER BY   AA.PYMT_YR_MNTH DESC
						    , AA.PAYR_MANG_DEPT_CD DESC
						    , AA.PAY_CD DESC 
							, AA.PAYR_SEIL_NUM DESC
							 ,(SELECT LPAD(DEPT_RANK,5,'0')  
                                   FROM BASS0400 DD
                                   WHERE DD.DEPT_CD =  AA.DEPT_CD  
                                     AND DD.DPOB_CD = AA.DPOB_CD) ASC 
						    , AA.RESN_REGN_NUM ASC
							, AA.SYSTEMKEY DESC 
                  
							
	) A 
</select>
	
	<!-- 고용보험 월별납부 엑셀 부서별 리스트 -->
	<select id="insr5100DAO.selectXlsInsrP51000101ToInsr5100List_D" parameterClass="insr5100SerarchVO" resultClass="egovMap">

	SELECT AX.*, ROWNUM FROM (
		SELECT MAX(A.DEPT_CD)AS DEPT_CD
	           , MAX(A.DEPT_NM) AS DEPT_NM
	           , MAX(A.TYP_OCCU_NM)AS TYP_OCCU_NM
	           , COUNT(A.PAYR_SEIL_NUM)AS CNT
	           , SUM(A.UMYT_INSR_PAY_TOT_AMNT)AS UMYT_INSR_PAY_TOT_AMNT
			   , SUM(A.PYMT_DDUC_D0160100)AS PYMT_DDUC_D0160100
		       , SUM(A.PYMT_DDUC_D0160200)AS PYMT_DDUC_D0160200
		       , SUM(A.PYMT_DDUC_D0160300)AS PYMT_DDUC_D0160300
		       , SUM(A.PYMT_DDUC_SUM)AS PYMT_DDUC_SUM
		 FROM(
			   SELECT
                         AA.DPOB_CD
                        , AA.PYMT_YR_MNTH
                        ,AA.SYSTEMKEY 
                        , AA.PAYR_SEIL_NUM
                        ,AA.EMYMT_DIV_CD
                        ,fcBass0300CDNM(AA.DPOB_CD,AA.EMYMT_DIV_CD) AS EMYMT_DIV_NM
                        ,AA.HAN_NM
                        ,AA.RESN_REGN_NUM
                        ,AA.DEPT_CD AS DEPT_CD
                        ,fcBass0400CDNM(AA.DPOB_CD,AA.DEPT_CD,'2') AS DEPT_NM 
                        ,AA.TYP_OCCU_CD 
                        , fcBass0320CDNM(AA.DPOB_CD,AA.TYP_OCCU_CD) AS TYP_OCCU_NM
                        ,AA.PYSP_GRDE_CD
                        ,	 AA.DTIL_OCCU_INTTN_CD 
		         , fcBassEx0350CDNM(AA.DPOB_CD,AA.TYP_OCCU_CD,AA.DTIL_OCCU_INTTN_CD,'1' ) AS DTIL_OCCU_CLS_DIV_NM 
                        ,AA.BUSIN_CD
                        ,fcBass0500CDNM(AA.DPOB_CD,SUBSTR(AA.PYMT_YR_MNTH,1,4),AA.DEPT_CD,AA.BUSIN_CD) AS BUSIN_NM  
                         , NVL(CC.PYMT_DDUC_D0160100,0) AS PYMT_DDUC_D0160100
                        , NVL(CC.PYMT_DDUC_D0160200,0) AS PYMT_DDUC_D0160200   
                        , NVL(CC.PYMT_DDUC_D0160300,0) AS PYMT_DDUC_D0160300
                        , (NVL(CC.PYMT_DDUC_D0160100,0) + NVL(CC.PYMT_DDUC_D0160200,0) + NVL(CC.PYMT_DDUC_D0160300,0)) AS PYMT_DDUC_SUM
                        , DD.NAT_PENN_STD_INCM_MNTH_AMNT
                        , DD.NAT_PENN_GRDE
                        , EE.UMYT_INSR_PAY_TOT_AMNT
                        , EE.UMYT_INSR_PAY_MNTH_AMNT
                FROM PAYR0304 AA, PAYR0300 BB,  
                     (
                     SELECT
                              DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                              PAYR_SEIL_NUM, SYSTEMKEY,
                              DECODE(PYMT_DDUC_D0160100 ,-1000000000,0,PYMT_DDUC_D0160100 ) AS  PYMT_DDUC_D0160100, 
                              DECODE(PYMT_DDUC_D0160200 ,-1000000000,0,PYMT_DDUC_D0160200 ) AS  PYMT_DDUC_D0160200,
                              DECODE(PYMT_DDUC_D0160300 ,-1000000000,0,PYMT_DDUC_D0160300) AS  PYMT_DDUC_D0160300
                        FROM 
                        (SELECT
                              DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                              PAYR_SEIL_NUM, SYSTEMKEY,
                              MAX(DECODE(PAY_ITEM_CD ,'D0160100',PYMT_DDUC_SUM,-1000000000)) AS  PYMT_DDUC_D0160100, 
                              MAX(DECODE(PAY_ITEM_CD ,'D0160200',PYMT_DDUC_SUM,-1000000000)) AS  PYMT_DDUC_D0160200,
                              MAX(DECODE(PAY_ITEM_CD ,'D0160300',PYMT_DDUC_SUM,-1000000000)) AS  PYMT_DDUC_D0160300  
                        FROM 
                        (SELECT 
                           DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                           PAYR_SEIL_NUM, SYSTEMKEY, PAY_ITEM_CD ,  
                           SUM(PYMT_DDUC_SUM) AS PYMT_DDUC_SUM 
                        FROM PAYR0302 
                        WHERE PAY_ITEM_CD IN  ('D0160100','D0160200','D0160300') 
                        GROUP BY DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                                 PAYR_SEIL_NUM, SYSTEMKEY, PAY_ITEM_CD) 
                        GROUP BY DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                           PAYR_SEIL_NUM, SYSTEMKEY)
                     ) CC, 
                     PAYR0309 DD,
                     PSNL0127 EE  
                WHERE AA.DPOB_CD=BB.DPOB_CD 
                  AND AA.PYMT_YR_MNTH  = BB.PYMT_YR_MNTH
                  AND AA.PAY_CD  = BB.PAY_CD
                  
                  AND AA.DPOB_CD = EE.DPOB_CD 
                  AND AA.SYSTEMKEY = EE.SYSTEMKEY
                
                  AND AA.PAYR_SEIL_NUM  = BB.PAYR_SEIL_NUM(+) 
                  AND AA.PYMT_YR_MNTH = CC.PYMT_YR_MNTH(+)
                  AND AA.SYSTEMKEY = CC.SYSTEMKEY(+)
                  AND AA.DPOB_CD=CC.DPOB_CD(+)
                  AND AA.PAY_CD = CC.PAY_CD(+) 
                  AND AA.PAYR_SEIL_NUM  = CC.PAYR_SEIL_NUM(+)   
                  AND AA.PYMT_YR_MNTH = DD.PYMT_YR_MNTH(+)
                  AND AA.SYSTEMKEY = DD.SYSTEMKEY(+)
                  AND AA.DPOB_CD=DD.DPOB_CD(+)
                  AND AA.PAY_CD = DD.PAY_CD(+) 
                  AND AA.PAYR_SEIL_NUM  = DD.PAYR_SEIL_NUM(+) 
                   <isNotEmpty prepend="AND" property="dpobCd" >
			 	     AA.DPOB_CD=#dpobCd#
		           </isNotEmpty> 
		                AND EXISTS  (
                         SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' ))) C
                                            WHERE     C.DPOB_CD = AA.DPOB_CD
						                        AND C.DEPT_CD = AA.DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(AA.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(AA.DTIL_OCCU_INTTN_CD,'TT')
                                               <isNotEmpty property="deptCd" prepend="AND">
												<![CDATA[
												 C.DEPT_CD
												]]>
												<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
												 #deptCdArr[]#
												</iterate>
												</isNotEmpty> 
                                          ) 
				       <isNotEmpty prepend="AND" property="businCd" >
					 	AA.BUSIN_CD=#businCd#
				       </isNotEmpty> 
				       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
					 	AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
				       </isNotEmpty> 
				       <isNotEmpty prepend="AND" property="emymtDivCd" >
					 	AA.EMYMT_DIV_CD=#emymtDivCd#
					 	</isNotEmpty> 
				         <isNotEmpty prepend="AND" property="pymtYrMnth" >
					 	AA.PYMT_YR_MNTH = #pymtYrMnth#
				       </isNotEmpty>  
 					<isNotEmpty property="typOccuCd" prepend="AND">
					<![CDATA[
					 AA.TYP_OCCU_CD
					]]>
					<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
					 #typOccuCdArr[]#
					</iterate>
					</isNotEmpty>  
				   <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 AA.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate>
					</isNotEmpty>  
					<!--   <isNotEmpty property="dtilOccuClsDivCd" prepend="AND">
					<![CDATA[
					 AA.DTIL_OCCU_CLS_DIV_CD
					]]>
					<iterate prepend="IN" property="dtilOccuClsDivCdArr" open="(" close=")" conjunction=",">
					 #dtilOccuClsDivCdArr[]#
					</iterate>
					</isNotEmpty>   -->
					 <isNotEmpty property="hdofcCodtnCd" prepend="AND">
				<![CDATA[
				 AA.HDOFC_DIV_CD
				]]>
				<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
				 #hdofcCodtnCdArr[]#
				</iterate>
				</isNotEmpty> 
 				<isNotEmpty prepend="AND" property="systemkey" >
		        <![CDATA[
				 AA.SYSTEMKEY
				]]>
			 		<iterate prepend="IN" property="systemKeyArr" open="(" close=")" conjunction=",">
							 #systemKeyArr[]#
					</iterate>			
		       </isNotEmpty>  
				       <isNotEmpty prepend="AND" property="hanNm" >
					 	AA.HAN_NM LIKE '%' || #hanNm# || '%'
				       </isNotEmpty>  
					ORDER BY   AA.PYMT_YR_MNTH DESC
						    , AA.PAYR_MANG_DEPT_CD DESC
						    , AA.PAY_CD DESC 
							, AA.PAYR_SEIL_NUM DESC
							 ,(SELECT LPAD(DEPT_RANK,5,'0')  
                                   FROM BASS0400 DD
                                   WHERE DD.DEPT_CD =  AA.DEPT_CD  
                                     AND DD.DPOB_CD = AA.DPOB_CD) ASC 
						    , AA.RESN_REGN_NUM ASC
							, AA.SYSTEMKEY DESC 
                  
							
	) A 
	GROUP BY DEPT_CD)AX
</select>
	
</sqlMap>
