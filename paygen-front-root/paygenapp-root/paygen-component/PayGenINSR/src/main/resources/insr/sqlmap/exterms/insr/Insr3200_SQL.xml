<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="Insr3200">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="insr3200SerarchVO" type="com.app.exterms.insurance.server.vo.Insr3200SrhVO"/>
	<typeAlias  alias="insr3200VO" type="com.app.exterms.insurance.server.vo.Insr3200VO"/>
	
	
	<resultMap id="insr3200" class="com.app.exterms.insurance.server.vo.Insr3200VO">
		<result property = "systemkey"				  column = "SYSTEMKEY"					   columnIndex = "1"/>
		<result property = "dpobCd"					  column = "DPOB_CD"					   columnIndex = "2"/>
		<result property = "nofctYrMnth"			  column = "NOFCT_YR_MNTH"				   columnIndex = "3"/>
		<result property = "nofctDspty"				  column = "NOFCT_DSPTY"				   columnIndex = "4"/>
		<result property = "emymtSeilNum"			  column = "EMYMT_SEIL_NUM"				   columnIndex = "5"/>
		<result property = "dpobMangeNum"			  column = "DPOB_MANGE_NUM"				   columnIndex = "6"/>
		<result property = "untIstutCd"				  column = "UNT_ISTUT_CD"				   columnIndex = "7"/>
		<result property = "accSgn"					  column = "ACC_SGN"					   columnIndex = "8"/>
		<result property = "hlthInsrCertNum"		  column = "HLTH_INSR_CERT_NUM"			   columnIndex = "9"/>
		<result property = "hanNm"					  column = "HAN_NM"						   columnIndex = "10"/>
		<result property = "resnRegnNum"			  column = "RESN_REGN_NUM"				   columnIndex = "11"/>
		<result property = "reduReasCd"				  column = "REDU_REAS_CD"				   columnIndex = "12"/>
		<result property = "hlthInsrTypOccuCd"		  column = "HLTH_INSR_TYP_OCCU_CD"		   columnIndex = "13"/>
		<result property = "payMnthAmntGrde"		  column = "PAY_MNTH_AMNT_GRDE"			   columnIndex = "14"/>
		<result property = "payMnthAmnt"			  column = "PAY_MNTH_AMNT"				   columnIndex = "15"/>
		<result property = "calcPrmm"				  column = "CALC_PRMM"					   columnIndex = "16"/>
		<result property = "clutReasCd"				  column = "CLUT_REAS_CD"				   columnIndex = "17"/>
		<result property = "clutApptnBgnnYrMnth"	  column = "CLUT_APPTN_BGNN_YR_MNTH"	   columnIndex = "18"/>
		<result property = "clutApptnEndYrMnth"		  column = "CLUT_APPTN_END_YR_MNTH"		   columnIndex = "19"/>
		<result property = "clutPrmm"				  column = "CLUT_PRMM"					   columnIndex = "20"/>
		<result property = "nofctPrmm"				  column = "NOFCT_PRMM"					   columnIndex = "21"/>
		<result property = "yrtxPrmm"				  column = "YRTX_PRMM"					   columnIndex = "22"/>
		<result property = "aqtnDt"					  column = "AQTN_DT"					   columnIndex = "23"/>
		<result property = "lssDt"					  column = "LSS_DT"						   columnIndex = "24"/>
		<result property = "lgtmRcptnCalcPrmm"		  column = "LGTM_RCPTN_CALC_PRMM"		   columnIndex = "25"/>
		<result property = "lgtmRcptnClutReasCd"	  column = "LGTM_RCPTN_CLUT_REAS_CD"	   columnIndex = "26"/>
		<result property = "lgtmRcptnApptnBgnnYrMnth" column = "LGTM_RCPTN_APPTN_BGNN_YR_MNTH" columnIndex = "27"/>
		<result property = "lgtmRcptnApptnEndYrMnth"  column = "LGTM_RCPTN_APPTN_END_YR_MNTH"  columnIndex = "28"/>
		<result property = "lgtmRcptnClutPrmm"		  column = "LGTM_RCPTN_CLUT_PRMM"		   columnIndex = "29"/>
		<result property = "lgtmRcptnNofctPrmm"		  column = "LGTM_RCPTN_NOFCT_PRMM"		   columnIndex = "30"/>
		<result property = "lgtmRcptnYrtxPrmm"		  column = "LGTM_RCPTN_YRTX_PRMM"		   columnIndex = "31"/>
		<result property = "hlthRcptnCalcPrmm"		  column = "HLTH_RCPTN_CALC_PRMM"		   columnIndex = "32"/>
		<result property = "hlthRcptnClutPrmm"		  column = "HLTH_RCPTN_CLUT_PRMM"		   columnIndex = "33"/>
		<result property = "hlthRcptnNofctPrmm"		  column = "HLTH_RCPTN_NOFCT_PRMM"		   columnIndex = "34"/>
		<result property = "hlthRcptnYrtxPrmm"		  column = "HLTH_RCPTN_YRTX_PRMM"		   columnIndex = "35"/>
		<result property = "hlthInsrRefdItrt"		  column = "HLTH_INSR_REFD_ITRT"		   columnIndex = "36"/>
		<result property = "lgtmRcptnRefdItrt"		  column = "LGTM_RCPTN_REFD_ITRT"		   columnIndex = "37"/>
		<result property = "totPymtPrmm"			  column = "TOT_PYMT_PRMM"				   columnIndex = "38"/>
		<result property = "dducYrMnth"				  column = "DDUC_YR_MNTH"				   columnIndex = "39"/>
		<result property = "kybdr"					  column = "KYBDR"						   columnIndex = "40"/>
		<result property = "inptDt"					  column = "INPT_DT"					   columnIndex = "41"/>
		<result property = "inptAddr"				  column = "INPT_ADDR"					   columnIndex = "42"/>
		<result property = "ismt"					  column = "ISMT"						   columnIndex = "43"/>
		<result property = "revnDt"					  column = "REVN_DT"					   columnIndex = "44"/>
		<result property = "revnAddr"				  column = "REVN_ADDR"					   columnIndex = "45"/>
	</resultMap>
	
	<insert id="insr3200DAO.insertInsr3200_S">
		<![CDATA[
			INSERT INTO INSR3200 
				( SYSTEMKEY
				  , DPOB_CD
				  , NOFCT_YR_MNTH
				  , NOFCT_DSPTY
				  , EMYMT_SEIL_NUM
				  , DPOB_MANGE_NUM
				  , UNT_ISTUT_CD
				  , ACC_SGN
				  , HLTH_INSR_CERT_NUM
				  , HAN_NM
				  , RESN_REGN_NUM
				  , REDU_REAS_CD
				  , HLTH_INSR_TYP_OCCU_CD
				  , PAY_MNTH_AMNT_GRDE
				  , PAY_MNTH_AMNT
				  , CALC_PRMM
				  , CLUT_REAS_CD
				  , CLUT_APPTN_BGNN_YR_MNTH
				  , CLUT_APPTN_END_YR_MNTH
				  , CLUT_PRMM
				  , NOFCT_PRMM
				  , YRTX_PRMM
				  , AQTN_DT
				  , LSS_DT
				  , LGTM_RCPTN_CALC_PRMM
				  , LGTM_RCPTN_CLUT_REAS_CD
				  , LGTM_RCPTN_APPTN_BGNN_YR_MNTH
				  , LGTM_RCPTN_APPTN_END_YR_MNTH
				  , LGTM_RCPTN_CLUT_PRMM
				  , LGTM_RCPTN_NOFCT_PRMM
				  , LGTM_RCPTN_YRTX_PRMM
				  , HLTH_RCPTN_CALC_PRMM
				  , HLTH_RCPTN_CLUT_PRMM
				  , HLTH_RCPTN_NOFCT_PRMM
				  , HLTH_RCPTN_YRTX_PRMM
				  , HLTH_INSR_REFD_ITRT
				  , LGTM_RCPTN_REFD_ITRT
				  , TOT_PYMT_PRMM
				  , DDUC_YR_MNTH
				  , KYBDR
				  , INPT_DT
				  , INPT_ADDR
				  , ISMT
				  , REVN_DT
				  , REVN_ADDR )
			VALUES ( #systemkey#
				  , #dpobCd#
				  , #nofctYrMnth#
				  , #nofctDspty#
				  , #emymtSeilNum#
				  , #dpobMangeNum#
				  , #untIstutCd#
				  , #accSgn#
				  , #hlthInsrCertNum#
				  , #hanNm#
				  , #resnRegnNum#
				  , #reduReasCd#
				  , #hlthInsrTypOccuCd#
				  , #payMnthAmntGrde#
				  , #payMnthAmnt#
				  , #calcPrmm#
				  , #clutReasCd#
				  , #clutApptnBgnnYrMnth#
				  , #clutApptnEndYrMnth#
				  , #clutPrmm#
				  , #nofctPrmm#
				  , #yrtxPrmm#
				  , #aqtnDt#
				  , #lssDt#
				  , #lgtmRcptnCalcPrmm#
				  , #lgtmRcptnClutReasCd#
				  , #lgtmRcptnApptnBgnnYrMnth#
				  , #lgtmRcptnApptnEndYrMnth#
				  , #lgtmRcptnClutPrmm#
				  , #lgtmRcptnNofctPrmm#
				  , #lgtmRcptnYrtxPrmm#
				  , #hlthRcptnCalcPrmm#
				  , #hlthRcptnClutPrmm#
				  , #hlthRcptnNofctPrmm#
				  , #hlthRcptnYrtxPrmm#
				  , #hlthInsrRefdItrt#
				  , #lgtmRcptnRefdItrt#
				  , #totPymtPrmm#
				  , #dducYrMnth#
				  , #kybdr#
				  , #inptDt#
				  , #inptAddr#
				  , #ismt#
				  , #revnDt#
				  , #revnAddr# )
		]]>
	</insert>
	
	<!-- inser4200화면 엑셀 업로드 삭제  -->
		<delete id="insr3200DAO.deleteXlsInsr3200_S">
		<![CDATA[
			DELETE
			FROM   INSR3200
			WHERE  DPOB_CD		 = #dpobCd#
			AND	   SYSTEMKEY	 = (SELECT SYSTEMKEY 
									FROM   PSNL0100 
									WHERE  DPOB_CD		 = #dpobCd#
									AND	   RESN_REGN_NUM = REPLACE(#resnRegnNum#, '-', '') 
								   )
			AND	   NOFCT_YR_MNTH = #nofctYrMnth#
			AND	   NOFCT_DSPTY	 = #nofctDspty# 
		]]>
	</delete>
	 
	<!-- inser4200화면 엑셀 업로드 인서트   -->
	<insert id="insr3200DAO.insertXlsInsr3200_S">
		<![CDATA[
			INSERT INTO    INSR3200
			            (  SYSTEMKEY
			             , DPOB_CD
			             , NOFCT_YR_MNTH
			             , NOFCT_DSPTY
			             , EMYMT_SEIL_NUM
			             , DPOB_MANGE_NUM
			             , UNT_ISTUT_CD
			             , ACC_SGN
			             , HLTH_INSR_CERT_NUM
			             , HAN_NM
			             , RESN_REGN_NUM
			             , REDU_REAS_CD
			             , HLTH_INSR_TYP_OCCU_CD
			             , PAY_MNTH_AMNT_GRDE
			             , PAY_MNTH_AMNT
			             , DDUC_YR_MNTH
			             , CALC_PRMM
			             , CLUT_REAS_CD
			             , CLUT_APPTN_BGNN_YR_MNTH
			             , CLUT_APPTN_END_YR_MNTH
			             , CLUT_PRMM
			             , NOFCT_PRMM
			             , YRTX_PRMM
			             , AQTN_DT
			             , LSS_DT
			             , LGTM_RCPTN_CALC_PRMM
			             , LGTM_RCPTN_CLUT_REAS_CD
			             , LGTM_RCPTN_APPTN_BGNN_YR_MNTH
			             , LGTM_RCPTN_APPTN_END_YR_MNTH
			             , LGTM_RCPTN_CLUT_PRMM
			             , LGTM_RCPTN_NOFCT_PRMM
			             , LGTM_RCPTN_YRTX_PRMM
			             , HLTH_RCPTN_CALC_PRMM
			             , HLTH_RCPTN_CLUT_PRMM
			             , HLTH_RCPTN_NOFCT_PRMM
			             , HLTH_RCPTN_YRTX_PRMM
			             , HLTH_INSR_REFD_ITRT
			             , LGTM_RCPTN_REFD_ITRT
			             , TOT_PYMT_PRMM
			             , KYBDR
			             , INPT_DT
			             , INPT_ADDR
			             , ISMT
			             , REVN_DT
			             , REVN_ADDR
			             , PAY_CALC_HLTH_INSR_SUM
			             , PAY_CALC_RCPTN_INSUR_SUM
			             )
			VALUES        ((SELECT SYSTEMKEY
			                 FROM   PSNL0100
			                 WHERE  DPOB_CD       = #dpobCd#
			                 AND    RESN_REGN_NUM = REPLACE(#resnRegnNum#, '-', '')
			               )
			             , #dpobCd#
			             , #nofctYrMnth#
			             , #nofctDspty#
			             , (SELECT MAX(EMYMT_SEIL_NUM) AS EMYMT_SEIL_NUM
			                FROM   INSR3000
			                WHERE  DPOB_CD   = #dpobCd#
			                AND    SYSTEMKEY = (SELECT SYSTEMKEY
			                                    FROM   PSNL0100
			                                    WHERE  DPOB_CD       = #dpobCd#
			                                    AND    RESN_REGN_NUM = REPLACE(#resnRegnNum#, '-', '')
			                                   )
			               )
			             , #dpobMangeNum#
			             , #untIstutCd#
			             , #accSgn#
			             , #hlthInsrCertNum#
			             , #hanNm#
			             , #resnRegnNum#
			             , (SELECT MANGE_ITEM11
							FROM   BASS0300 A03
							WHERE  A03.RPSTTV_CD  = 'I007'
							AND    A03.DPOB_CD	  = #dpobCd#
							AND    A03.COMM_CD_NM = #reduReasNm#
						   )
			             , #hlthInsrTypOccuCd#
			             , #payMnthAmntGrde#
			             , #payMnthAmnt#
			             , #nofctYrMnth#
			             , #calcPrmm#
			             , #clutReasCd#
			             , #clutApptnBgnnYrMnth#
			             , #clutApptnEndYrMnth#
			             , #clutPrmm#
			             , #nofctPrmm#
			             , #yrtxPrmm#
			             , #aqtnDt#
			             , #lssDt#
			             , #lgtmRcptnCalcPrmm#
			             , #lgtmRcptnClutReasCd#
			             , #lgtmRcptnApptnBgnnYrMnth#
			             , #lgtmRcptnApptnEndYrMnth#
			             , #lgtmRcptnClutPrmm#
			             , #lgtmRcptnNofctPrmm#
			             , #lgtmRcptnYrtxPrmm#
			             , #hlthRcptnCalcPrmm#
			             , #hlthRcptnClutPrmm#
			             , #hlthRcptnNofctPrmm#
			             , #hlthRcptnYrtxPrmm#
			             , #hlthInsrRefdItrt#
			             , #lgtmRcptnRefdItrt#
			             , #totPymtPrmm#
			             , #kybdr#
			             , TO_CHAR(SYSDATE, 'YYYYMMDDHHMISS')
			             , #inptAddr#
			             , #ismt#
			             , TO_CHAR(SYSDATE, 'YYYYMMDDHHMISS')
			             , #revnAddr#
			             , (
			             	SELECT NVL(SUM(PYMT_DDUC_SUM), 0)
			                FROM   PAYR0302 A01
			                WHERE  A01.DPOB_CD      = #dpobCd#
			                AND    A01.PYMT_YR_MNTH = #nofctYrMnth#
			                AND    A01.PAY_CD       = 'B0150000'
			                AND    A01.SYSTEMKEY    = (SELECT SYSTEMKEY
			                                           FROM   PSNL0100
			                                           WHERE  DPOB_CD       = #dpobCd#
			                                           AND    RESN_REGN_NUM = REPLACE(#resnRegnNum#, '-', '')
			                                          )
			                AND    A01.PAY_ITEM_CD  = 'D0010100'
			                AND  EXISTS(
				                  SELECT *
				                  FROM   PAYR0301  BBB
				                  WHERE  BBB.PAY_CD = A01.PAY_CD
				                  AND    BBB.PYMT_YR_MNTH = A01.PYMT_YR_MNTH
				                  AND    BBB.PAYR_SEIL_NUM = A01.PAYR_SEIL_NUM
				                  AND    BBB.SYSTEMKEY = A01.SYSTEMKEY
				                  AND    BBB.PAY_DDLNE_YN = 'Y'
				            	)  
			               )
			             , (
			            	SELECT NVL(SUM(PYMT_DDUC_SUM), 0)
			                FROM   PAYR0302 A01
			                WHERE  A01.DPOB_CD      = #dpobCd#
			                AND    A01.PYMT_YR_MNTH = #nofctYrMnth#
			                AND    A01.PAY_CD       = 'B0150000'
			                AND    A01.SYSTEMKEY    = (SELECT SYSTEMKEY
			                                           FROM   PSNL0100
			                                           WHERE  DPOB_CD       = #dpobCd#
			                                           AND    RESN_REGN_NUM = REPLACE(#resnRegnNum#, '-', '')
			                                          )
			                AND    A01.PAY_ITEM_CD  = 'D0110100'
			                AND  EXISTS(
				                  SELECT *
				                  FROM   PAYR0301  BBB
				                  WHERE  BBB.PAY_CD = A01.PAY_CD
				                  AND    BBB.PYMT_YR_MNTH = A01.PYMT_YR_MNTH
				                  AND    BBB.PAYR_SEIL_NUM = A01.PAYR_SEIL_NUM
				                  AND    BBB.SYSTEMKEY = A01.SYSTEMKEY
				                  AND    BBB.PAY_DDLNE_YN = 'Y'
				            	) 
			               )
			            )
		]]>
		
		
<!-- 					INSERT INTO    INSR3200
			            (  SYSTEMKEY
			             , DPOB_CD
			             , NOFCT_YR_MNTH
			             , NOFCT_DSPTY
			             , EMYMT_SEIL_NUM
			             , DPOB_MANGE_NUM
			             , UNT_ISTUT_CD
			             , ACC_SGN
			             , HLTH_INSR_CERT_NUM
			             , HAN_NM
			             , RESN_REGN_NUM
			             , REDU_REAS_CD
			             , HLTH_INSR_TYP_OCCU_CD
			             , PAY_MNTH_AMNT_GRDE
			             , PAY_MNTH_AMNT
			             , DDUC_YR_MNTH
			             , CALC_PRMM
			             , CLUT_REAS_CD
			             , CLUT_APPTN_BGNN_YR_MNTH
			             , CLUT_APPTN_END_YR_MNTH
			             , CLUT_PRMM
			             , NOFCT_PRMM
			             , YRTX_PRMM
			             , AQTN_DT
			             , LSS_DT
			             , LGTM_RCPTN_CALC_PRMM
			             , LGTM_RCPTN_CLUT_REAS_CD
			             , LGTM_RCPTN_APPTN_BGNN_YR_MNTH
			             , LGTM_RCPTN_APPTN_END_YR_MNTH
			             , LGTM_RCPTN_CLUT_PRMM
			             , LGTM_RCPTN_NOFCT_PRMM
			             , LGTM_RCPTN_YRTX_PRMM
			             , HLTH_RCPTN_CALC_PRMM
			             , HLTH_RCPTN_CLUT_PRMM
			             , HLTH_RCPTN_NOFCT_PRMM
			             , HLTH_RCPTN_YRTX_PRMM
			             , HLTH_INSR_REFD_ITRT
			             , LGTM_RCPTN_REFD_ITRT
			             , TOT_PYMT_PRMM
			             , KYBDR
			             , INPT_DT
			             , INPT_ADDR
			             , ISMT
			             , REVN_DT
			             , REVN_ADDR)
			VALUES        ((SELECT SYSTEMKEY
			                 FROM   PSNL0100
			                 WHERE  DPOB_CD       = #dpobCd#
			                 AND    RESN_REGN_NUM = REPLACE(#resnRegnNum#, '-', '')
			               )
			             , #dpobCd#
			             , #nofctYrMnth#
			             , #nofctDspty#
			             , (SELECT MAX(EMYMT_SEIL_NUM) AS EMYMT_SEIL_NUM
			                FROM   INSR3000
			                WHERE  DPOB_CD   = #dpobCd#
			                AND    SYSTEMKEY = (SELECT SYSTEMKEY
			                                    FROM   PSNL0100
			                                    WHERE  DPOB_CD       = #dpobCd#
			                                    AND    RESN_REGN_NUM = REPLACE(#resnRegnNum#, '-', '')
			                                   )
			               )
			             , #dpobMangeNum#
			             , #untIstutCd#
			             , #accSgn#
			             , #hlthInsrCertNum#
			             , #hanNm#
			             , #resnRegnNum#
			             , (SELECT MANGE_ITEM11
							FROM   BASS0300 A03
							WHERE  A03.RPSTTV_CD  = 'I007'
							AND    A03.DPOB_CD	  = #dpobCd#
							AND    A03.COMM_CD_NM = #reduReasNm#
						   )
			             , #hlthInsrTypOccuCd#
			             , #payMnthAmntGrde#
			             , #payMnthAmnt#
			             , #dducYrMnth#
			             , (SELECT NVL(SUM(PYMT_DDUC_SUM), 0)
			                FROM   PAYR0302 A01
			                WHERE  A01.DPOB_CD      = #dpobCd#
			                AND    A01.PYMT_YR_MNTH = #nofctYrMnth#
			                AND    A01.PAY_CD       = 'B0150000'
			                AND    A01.SYSTEMKEY    = (SELECT SYSTEMKEY
			                                           FROM   PSNL0100
			                                           WHERE  DPOB_CD       = #dpobCd#
			                                           AND    RESN_REGN_NUM = REPLACE(#resnRegnNum#, '-', '')
			                                          )
			                AND    A01.PAY_ITEM_CD  = 'D0010100'
			               )
			             , #clutReasCd#
			             , #clutApptnBgnnYrMnth#
			             , #clutApptnEndYrMnth#
			             , #clutPrmm#
			             , #nofctPrmm#
			             , #yrtxPrmm#
			             , #aqtnDt#
			             , #lssDt#
			             , (SELECT NVL(SUM(PYMT_DDUC_SUM), 0)
			                FROM   PAYR0302 A01
			                WHERE  A01.DPOB_CD      = #dpobCd#
			                AND    A01.PYMT_YR_MNTH = #nofctYrMnth#
			                AND    A01.PAY_CD       = 'B0150000'
			                AND    A01.SYSTEMKEY    = (SELECT SYSTEMKEY
			                                           FROM   PSNL0100
			                                           WHERE  DPOB_CD       = #dpobCd#
			                                           AND    RESN_REGN_NUM = REPLACE(#resnRegnNum#, '-', '')
			                                          )
			                AND    A01.PAY_ITEM_CD  = 'D0110100'
			               )
			             , #lgtmRcptnClutReasCd#
			             , #lgtmRcptnApptnBgnnYrMnth#
			             , #lgtmRcptnApptnEndYrMnth#
			             , #lgtmRcptnClutPrmm#
			             , #lgtmRcptnNofctPrmm#
			             , #lgtmRcptnYrtxPrmm#
			             , #hlthRcptnCalcPrmm#
			             , #hlthRcptnClutPrmm#
			             , #hlthRcptnNofctPrmm#
			             , #hlthRcptnYrtxPrmm#
			             , #hlthInsrRefdItrt#
			             , #lgtmRcptnRefdItrt#
			             , #totPymtPrmm#
			             , #kybdr#
			             , TO_CHAR(SYSDATE, 'YYYYMMDDHHMISS')
			             , #inptAddr#
			             , #ismt#
			             , TO_CHAR(SYSDATE, 'YYYYMMDDHHMISS')
			             , #revnAddr#
			            ) -->
		
		
	</insert>
	
	<update id="insr3200DAO.updateInsr3200_S">
		<![CDATA[
			UPDATE INSR3200
			SET SYSTEMKEY=#systemkey#
				, DPOB_CD=#dpobCd#
				, NOFCT_YR_MNTH=#nofctYrMnth#
				, NOFCT_DSPTY=#nofctDspty#
				, EMYMT_SEIL_NUM=#emymtSeilNum#
				, DPOB_MANGE_NUM=#dpobMangeNum#
				, UNT_ISTUT_CD=#untIstutCd#
				, ACC_SGN=#accSgn#
				, HLTH_INSR_CERT_NUM=#hlthInsrCertNum#
				, HAN_NM=#hanNm#
				, RESN_REGN_NUM=#resnRegnNum#
				, REDU_REAS_CD=#reduReasCd#
				, HLTH_INSR_TYP_OCCU_CD=#hlthInsrTypOccuCd#
				, PAY_MNTH_AMNT_GRDE=#payMnthAmntGrde#
				, PAY_MNTH_AMNT=#payMnthAmnt#
				, CALC_PRMM=#calcPrmm#
				, CLUT_REAS_CD=#clutReasCd#
				, CLUT_APPTN_BGNN_YR_MNTH=#clutApptnBgnnYrMnth#
				, CLUT_APPTN_END_YR_MNTH=#clutApptnEndYrMnth#
				, CLUT_PRMM=#clutPrmm#
				, NOFCT_PRMM=#nofctPrmm#
				, YRTX_PRMM=#yrtxPrmm#
				, AQTN_DT=#aqtnDt#
				, LSS_DT=#lssDt#
				, LGTM_RCPTN_CALC_PRMM=#lgtmRcptnCalcPrmm#
				, LGTM_RCPTN_CLUT_REAS_CD=#lgtmRcptnClutReasCd#
				, LGTM_RCPTN_APPTN_BGNN_YR_MNTH=#lgtmRcptnApptnBgnnYrMnth#
				, LGTM_RCPTN_APPTN_END_YR_MNTH=#lgtmRcptnApptnEndYrMnth#
				, LGTM_RCPTN_CLUT_PRMM=#lgtmRcptnClutPrmm#
				, LGTM_RCPTN_NOFCT_PRMM=#lgtmRcptnNofctPrmm#
				, LGTM_RCPTN_YRTX_PRMM=#lgtmRcptnYrtxPrmm#
				, HLTH_RCPTN_CALC_PRMM=#hlthRcptnCalcPrmm#
				, HLTH_RCPTN_CLUT_PRMM=#hlthRcptnClutPrmm#
				, HLTH_RCPTN_NOFCT_PRMM=#hlthRcptnNofctPrmm#
				, HLTH_RCPTN_YRTX_PRMM=#hlthRcptnYrtxPrmm#
				, HLTH_INSR_REFD_ITRT=#hlthInsrRefdItrt#
				, LGTM_RCPTN_REFD_ITRT=#lgtmRcptnRefdItrt#
				, TOT_PYMT_PRMM=#totPymtPrmm#
				, DDUC_YR_MNTH=#dducYrMnth# 
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
						WHERE SYSTEMKEY=#systemkey#
								AND DPOB_CD=#dpobCd#
								AND NOFCT_YR_MNTH=#nofctYrMnth#
								AND NOFCT_DSPTY=#nofctDspty#
				]]>
	</update>
	
		<update id="insr3200DAO.updatePayCalcInsr3200_S">
		<![CDATA[
			UPDATE INSR3200
			SET   PAY_CALC_HLTH_INSR_SUM = (
			        		SELECT NVL(SUM(PYMT_DDUC_SUM), 0)
			                FROM   PAYR0302 A01
			                WHERE  A01.DPOB_CD      = #dpobCd#
			                AND    A01.PYMT_YR_MNTH = #nofctYrMnth#
			                AND    A01.PAY_CD       = 'B0150000'
			                AND    A01.SYSTEMKEY    = #systemkey#
			                AND    A01.PAY_ITEM_CD  = 'D0010100'
			        )
			       ,PAY_CALC_RCPTN_INSUR_SUM = (
			       			SELECT NVL(SUM(PYMT_DDUC_SUM), 0)
			                FROM   PAYR0302 A01
			                WHERE  A01.DPOB_CD      = #dpobCd#
			                AND    A01.PYMT_YR_MNTH = #nofctYrMnth#
			                AND    A01.PAY_CD       = 'B0150000'
			                AND    A01.SYSTEMKEY    = #systemkey#
			                AND    A01.PAY_ITEM_CD  = 'D0110100'
			       )
				  , ISMT		 = #ismt#										/* 수정자	*/
				  , REVN_DT		 = TO_CHAR(SYSDATE, 'YYYYMMDDHHMISS')			/* 수정일자	*/
				  , REVN_ADDR	 = #revnAddr#	
			 WHERE 	SYSTEMKEY=#systemkey#
			 AND 	DPOB_CD=#dpobCd#
			 AND 	NOFCT_YR_MNTH=#nofctYrMnth#
			 AND NOFCT_DSPTY=#nofctDspty#
				]]>
	</update>
	
	<delete id="insr3200DAO.deleteInsr3200_S">
		<![CDATA[
			DELETE FROM INSR3200 
						WHERE SYSTEMKEY=#systemkey#
								AND DPOB_CD=#dpobCd#
								AND NOFCT_YR_MNTH=#nofctYrMnth#
								AND NOFCT_DSPTY=#nofctDspty#
				]]>
	</delete>
	
	<select id="insr3200DAO.selectInsr3200_S" resultMap="insr3200">
		<![CDATA[
			SELECT
				SYSTEMKEY
				, DPOB_CD
				, NOFCT_YR_MNTH
				, NOFCT_DSPTY
				, EMYMT_SEIL_NUM
				, DPOB_MANGE_NUM
				, UNT_ISTUT_CD
				, ACC_SGN
				, HLTH_INSR_CERT_NUM
				, HAN_NM
				, RESN_REGN_NUM
				, REDU_REAS_CD
				, HLTH_INSR_TYP_OCCU_CD
				, PAY_MNTH_AMNT_GRDE
				, PAY_MNTH_AMNT
				, CALC_PRMM
				, CLUT_REAS_CD
				, CLUT_APPTN_BGNN_YR_MNTH
				, CLUT_APPTN_END_YR_MNTH
				, CLUT_PRMM
				, NOFCT_PRMM
				, YRTX_PRMM
				, AQTN_DT
				, LSS_DT
				, LGTM_RCPTN_CALC_PRMM
				, LGTM_RCPTN_CLUT_REAS_CD
				, LGTM_RCPTN_APPTN_BGNN_YR_MNTH
				, LGTM_RCPTN_APPTN_END_YR_MNTH
				, LGTM_RCPTN_CLUT_PRMM
				, LGTM_RCPTN_NOFCT_PRMM
				, LGTM_RCPTN_YRTX_PRMM
				, HLTH_RCPTN_CALC_PRMM
				, HLTH_RCPTN_CLUT_PRMM
				, HLTH_RCPTN_NOFCT_PRMM
				, HLTH_RCPTN_YRTX_PRMM
				, HLTH_INSR_REFD_ITRT
				, LGTM_RCPTN_REFD_ITRT
				, TOT_PYMT_PRMM
				, DDUC_YR_MNTH
				, KYBDR
				, INPT_DT
				, INPT_ADDR
				, ISMT
				, REVN_DT
				, REVN_ADDR
			FROM INSR3200
						WHERE SYSTEMKEY=#systemkey#
								AND DPOB_CD=#dpobCd#
								AND NOFCT_YR_MNTH=#nofctYrMnth#
								AND NOFCT_DSPTY=#nofctDspty#
				]]>
	</select>
	<!-- Insr4200 화면 월정산대사 화면 리스트 출력  -->
	<select id="insr3200DAO.selectInsr3200List_D" parameterClass="insr3200SerarchVO" resultClass="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (
				 SELECT 
					    II.NOFCT_YR_MNTH ,  
				        II.HLTH_INSR_CERT_NUM ,
				        II.HAN_NM ,
				        II.RESN_REGN_NUM ,
				        (
				          SELECT COMM_CD_NM
				          FROM BASS0300 A03
				          WHERE A03.RPSTTV_CD  = 'I007'
				          AND A03.DPOB_CD      = II.DPOB_CD
				          AND A03.MANGE_ITEM11 = II.REDU_REAS_CD
				        ) AS REDU_REAS_NM ,
				        II.PAY_MNTH_AMNT ,
				        II.DDUC_YR_MNTH ,
				        II.HLTH_INSR_PRCS_YN ,
				        II.CALC_PRMM ,
				        II.SAN_CALC_PRMM ,
				        <![CDATA[	
				       (
				        CASE
				          WHEN NVL(II.HLTH_INSR_PRMM_SRD,0) <> (NVL(II.SAN_CALC_PRMM,0) - NVL(II.CALC_PRMM,0) )
				          THEN (II.SAN_CALC_PRMM - II.CALC_PRMM )
				          ELSE NVL(II.HLTH_INSR_PRMM_SRD,0)
				        END) AS HLTH_INSR_PRMM_SRD , 
				         ]]>         
				        II.HLTH_INSR_REFD_ITRT ,
				        II.LGTM_RCPTN_CALC_PRMM ,
				        II.SAN_LGTM_RCPTN_CALC_PRMM , 
				         <![CDATA[      
				        (
				        CASE
				          WHEN NVL(II.LGTM_RCPTN_INSUR_SRD,0) <> ( NVL(II.SAN_LGTM_RCPTN_CALC_PRMM,0) -NVL(II.LGTM_RCPTN_CALC_PRMM,0) )
				          THEN ( NVL(II.SAN_LGTM_RCPTN_CALC_PRMM,0) -NVL(II.LGTM_RCPTN_CALC_PRMM,0)  )
				          ELSE NVL(II.LGTM_RCPTN_INSUR_SRD,0)
				        END) AS LGTM_RCPTN_INSUR_SRD ,        
				        II.LGTM_RCPTN_REFD_ITRT ,       
				        (
				        CASE
				          WHEN NVL(II.HLTH_INSR_PRMM_SRD,0) + NVL(II.LGTM_RCPTN_INSUR_SRD,0) <> ( NVL(II.SAN_CALC_PRMM,0)- NVL(II.CALC_PRMM,0)  + NVL(II.SAN_LGTM_RCPTN_CALC_PRMM,0) -NVL(II.LGTM_RCPTN_CALC_PRMM,0)  )
				          THEN ( NVL(II.SAN_CALC_PRMM,0)- NVL(II.CALC_PRMM,0) +  NVL(II.SAN_LGTM_RCPTN_CALC_PRMM,0) - NVL(II.LGTM_RCPTN_CALC_PRMM,0) + NVL( II.HLTH_INSR_REFD_ITRT,0) + NVL( II.LGTM_RCPTN_REFD_ITRT,0) )
				          ELSE NVL(II.HLTH_INSR_PRMM_SRD,0) + NVL(II.LGTM_RCPTN_INSUR_SRD,0) + NVL( II.HLTH_INSR_REFD_ITRT,0) + NVL( II.LGTM_RCPTN_REFD_ITRT,0)
				        END) AS SRD_AGGR_SUM ,
				     ]]>
						II.DPOB_CD ,
						II.SYSTEMKEY ,
						II.NOFCT_DSPTY ,
						II.EMYMT_SEIL_NUM ,
						II.DPOB_MANGE_NUM ,
						II.UNT_ISTUT_CD ,
						II.ACC_SGN ,
						II.REDU_REAS_CD ,
						II.HLTH_INSR_TYP_OCCU_CD ,
						II.PAY_MNTH_AMNT_GRDE ,
						II.CLUT_REAS_CD ,
						II.CLUT_APPTN_BGNN_YR_MNTH ,
						II.CLUT_APPTN_END_YR_MNTH ,
						II.CLUT_PRMM ,
						II.NOFCT_PRMM ,
						II.YRTX_PRMM ,
						II.AQTN_DT ,
						II.LSS_DT ,
						II.LGTM_RCPTN_CLUT_REAS_CD ,
						II.LGTM_RCPTN_APPTN_BGNN_YR_MNTH ,
						II.LGTM_RCPTN_APPTN_END_YR_MNTH ,
						II.LGTM_RCPTN_CLUT_PRMM ,
						II.LGTM_RCPTN_NOFCT_PRMM ,
						II.LGTM_RCPTN_YRTX_PRMM ,
						II.HLTH_RCPTN_CALC_PRMM ,
						II.HLTH_RCPTN_CLUT_PRMM ,
						II.HLTH_RCPTN_NOFCT_PRMM ,
						II.HLTH_RCPTN_YRTX_PRMM ,
						II.TOT_PYMT_PRMM ,
						II.EMYMT_DIV_CD ,
						II.EMYMT_DIV_NM ,
						II.DEPT_CD ,
						II.DEPT_NM ,
						II.TYP_OCCU_CD ,
						II.TYP_OCCU_NM ,
						II.PYSP_GRDE_CD ,
				    <!--   II.DTIL_OCCU_INTTN_CD , -->
				      II.DTIL_OCCU_CLS_DIV_NM ,
				      II.BUSIN_CD ,
				      II.BUSIN_NM ,
				      II.PAYR_MANG_DEPT_CD ,
				      II.PAYR_MANG_DEPT_NM ,
				      II.HLTH_INSR_PRCS_DT ,
				      II.DIVD_PYMT_DIV_CD ,
				      II.DIVD_PYMT 
					FROM 
					(SELECT 
					     AA.DPOB_CD
					   , AA.SYSTEMKEY,AA.NOFCT_YR_MNTH
					   , AA.NOFCT_DSPTY
					   , AA.EMYMT_SEIL_NUM
					   , AA.DPOB_MANGE_NUM
					   , AA.UNT_ISTUT_CD
					   , AA.ACC_SGN
					   , AA.HLTH_INSR_CERT_NUM
					   , AA.HAN_NM
					   , AA.RESN_REGN_NUM
					   , AA.REDU_REAS_CD
					   , AA.HLTH_INSR_TYP_OCCU_CD
					   , AA.PAY_MNTH_AMNT_GRDE
					   , AA.PAY_MNTH_AMNT
					   , (NVL(AA.NOFCT_PRMM,0) +  NVL(AA.YRTX_PRMM,0) )  AS SAN_CALC_PRMM
					   , AA.PAY_CALC_HLTH_INSR_SUM AS CALC_PRMM
					   , AA.CLUT_REAS_CD
					   , AA.CLUT_APPTN_BGNN_YR_MNTH
					   , AA.CLUT_APPTN_END_YR_MNTH
					   , AA.CLUT_PRMM
					   , AA.NOFCT_PRMM
					   , AA.YRTX_PRMM
					   , AA.AQTN_DT
					   , AA.LSS_DT
					   , (  NVL(AA.LGTM_RCPTN_NOFCT_PRMM,0)  + NVL(AA.LGTM_RCPTN_YRTX_PRMM,0)  )  AS SAN_LGTM_RCPTN_CALC_PRMM
					   , AA.PAY_CALC_RCPTN_INSUR_SUM AS LGTM_RCPTN_CALC_PRMM
					   , AA.LGTM_RCPTN_CLUT_REAS_CD
					   , AA.LGTM_RCPTN_APPTN_BGNN_YR_MNTH
					   , AA.LGTM_RCPTN_APPTN_END_YR_MNTH
					   , AA.LGTM_RCPTN_CLUT_PRMM 
					   , AA.LGTM_RCPTN_NOFCT_PRMM
					   , AA.LGTM_RCPTN_YRTX_PRMM 
					   , AA.HLTH_RCPTN_CALC_PRMM 
					   , AA.HLTH_RCPTN_CLUT_PRMM
					   , AA.HLTH_RCPTN_NOFCT_PRMM
					   , AA.HLTH_RCPTN_YRTX_PRMM
					   , AA.HLTH_INSR_REFD_ITRT
					   , AA.LGTM_RCPTN_REFD_ITRT
					   , AA.TOT_PYMT_PRMM 
					   , BB.DEPT_CD AS MAN_DEPT_CD
					   , BB.REPBTY_BUSIN_DIV_CD
					   , BB.EMYMT_DIV_CD
					    ,fcBass0300CDNM(BB.DPOB_CD,BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM
					    
					    ,BB.CURR_AFFN_DEPT_CD AS DEPT_CD
					    ,fcBass0400CDNM(BB.DPOB_CD,BB.DEPT_CD,'2') AS DEPT_NM 
					    ,BB.TYP_OCCU_CD 
					    , fcBass0320CDNM(BB.DPOB_CD,BB.TYP_OCCU_CD) AS TYP_OCCU_NM
					    ,NVL(BB.PYSP_GRDE_CD,'A0060000') AS PYSP_GRDE_CD
					    ,BB.BUSIN_CD
					    ,fcBass0500CDNM(BB.DPOB_CD,SUBSTR(BB.BUSIN_CD,1,4),BB.DEPT_CD,BB.BUSIN_CD) AS BUSIN_NM   
					     ,	 BB.DTIL_OCCU_INTTN_CD 
		                 , fcBassEx0350CDNM(BB.DPOB_CD,BB.TYP_OCCU_CD,BB.DTIL_OCCU_INTTN_CD,'1' ) AS DTIL_OCCU_CLS_DIV_NM 
					    ,GG.PAYR_MANG_DEPT_CD
					    ,fcBass0400CDNM(GG.DPOB_CD,GG.PAYR_MANG_DEPT_CD,'2') AS PAYR_MANG_DEPT_NM
					   , HH.DDUC_YR_MNTH
					   , HH.HLTH_INSR_PRCS_DT
					   , HH.HLTH_INSR_PRCS_YN
					   , HH.HLTH_INSR_PRMM_SRD
					   , HH.LGTM_RCPTN_INSUR_SRD
					   , HH.SRD_AGGR_SUM
					   , HH.DIVD_PYMT_DIV_CD
					   , HH.DIVD_PYMT 
					FROM  INSR3200 AA , PSNL0100 BB,BASS0400 GG, INSR3300 HH ,
					   (
					   SELECT  CC.DPOB_CD
	                         , CC.SYSTEMKEY 
	                         , CC.HLTH_INSUR_FLUC_DT             
	                         , CC.HLTH_INSR_PAY_TOT_AMNT            
	                         , CC.HLTH_INSR_MNTH_RUNTN_AMNT 
	                         , (CASE WHEN NVL(FF.EXPTN_PRCS_PYMT_RTO01,0) > 0  
	                                 THEN (TRUNC(((CC.HLTH_INSR_MNTH_RUNTN_AMNT * (HLTH_INSR_HMLF_BRDN_APMRT / 100)) * ((100 - FF.EXPTN_PRCS_PYMT_RTO01) / 100)), -1))
	                                 ELSE (TRUNC(CC.HLTH_INSR_MNTH_RUNTN_AMNT * (HLTH_INSR_HMLF_BRDN_APMRT / 100), -1))
	                            END
	                           ) AS HLTH_INSR_MNTH_AMNT
	                         , (CASE WHEN NVL(FF.EXPTN_PRCS_PYMT_RTO02,0) > 0
	                                 THEN (TRUNC((((CC.HLTH_INSR_MNTH_RUNTN_AMNT * (HLTH_INSR_HMLF_BRDN_APMRT / 100)) * (HLTH_RCPTN_HMLF_BRDN_APMRT / 100)) * ((100 - FF.EXPTN_PRCS_PYMT_RTO02)/100)), -1))
	                                 ELSE (TRUNC(((CC.HLTH_INSR_MNTH_RUNTN_AMNT * (HLTH_INSR_HMLF_BRDN_APMRT / 100)) * (HLTH_RCPTN_HMLF_BRDN_APMRT / 100)), -1))
	                            END
	                           ) AS HLTH_RCPTN_MNTH_AMNT
	                         , CC.HLTH_INSR_GRDE
	                         , CC.HLTH_INSR_CERT_NUM
	                         , CC.HLTH_INSR_APPTN_YN
					   FROM	   PSNL0127 CC
					   		 , (SELECT  DPOB_CD
									  , HLTH_INSR_MINM_MNTH_RUNTN_AMNT
									  , HLTH_INSR_BST_MNTH_RUNTN_AMNT
									  , HLTH_INSR_HMLF_BRDN_APMRT
									  , HLTH_RCPTN_HMLF_BRDN_APMRT
								FROM	INSR0240 A01
								WHERE	#nofctYrMnth# BETWEEN SUBSTR(A01.HLTH_INSR_BGNN_DT, 1, 6)
													  AND	  SUBSTR(A01.HLTH_INSR_END_DT,  1, 6)
							   ) DD
							 , (SELECT  DPOB_CD
									  ,	SYSTEMKEY
									  , MAX(DECODE(PAY_ITEM_CD, 'D0010100', EXPTN_DIV_CD, '')) AS EXPTN_DIV_CD01
									  , MAX(DECODE(PAY_ITEM_CD,'D0110100',EXPTN_DIV_CD,'')) AS EXPTN_DIV_CD02
									  , MAX(DECODE(PAY_ITEM_CD,'D0150100',EXPTN_DIV_CD,'')) AS EXPTN_DIV_CD03
									  , MAX(DECODE(PAY_ITEM_CD,'D0160100',EXPTN_DIV_CD,'')) AS EXPTN_DIV_CD04
									  , MAX(DECODE(PAY_ITEM_CD,'D0010100',EXPTN_PRCS_PYMT_RTO,0)) AS EXPTN_PRCS_PYMT_RTO01
									  , MAX(DECODE(PAY_ITEM_CD,'D0110100',EXPTN_PRCS_PYMT_RTO,0)) AS EXPTN_PRCS_PYMT_RTO02
									  , MAX(DECODE(PAY_ITEM_CD,'D0150100',EXPTN_PRCS_PYMT_RTO,0)) AS EXPTN_PRCS_PYMT_RTO03
									  , MAX(DECODE(PAY_ITEM_CD,'D0160100',EXPTN_PRCS_PYMT_RTO,0)) AS EXPTN_PRCS_PYMT_RTO04
								FROM	(SELECT	 DPOB_CD            
											   , SYSTEMKEY           
											   , EXPTN_PRCS_SEIL_NUM             
											   , EXPTN_DIV_CD            
											   , PYMT_DDUC_DIV_CD           
											   , EXMTN_YN       
											   , EXPTN_PRCS_PYMT_RTO           
											   , PAY_ITEM_CD  
										 FROM	 PAYR0540 A02
										 WHERE	 #nofctYrMnth# BETWEEN SUBSTR(A02.EXPTN_PRCS_BGNN_DT, 1, 6)
															   AND	   SUBSTR(A02.EXPTN_PRCS_END_DT,  1, 6)
										)
								GROUP BY  DPOB_CD
										, SYSTEMKEY
							   ) FF
						WHERE	CC.DPOB_CD	 = DD.DPOB_CD
						AND		CC.DPOB_CD	 = FF.DPOB_CD(+)
						AND		CC.SYSTEMKEY = FF.SYSTEMKEY(+)
					   ) EE
					   WHERE   AA.DPOB_CD			= BB.DPOB_CD
					   AND	   AA.SYSTEMKEY			= BB.SYSTEMKEY
					   AND	   BB.DPOB_CD			= GG.DPOB_CD
					   AND	   BB.CURR_AFFN_DEPT_CD = GG.DEPT_CD
					   AND	   AA.DPOB_CD			= EE.DPOB_CD(+)
					   AND	   AA.SYSTEMKEY			= EE.SYSTEMKEY(+)
					   AND	   AA.NOFCT_YR_MNTH		= HH.NOFCT_YR_MNTH(+)
					   AND	   AA.NOFCT_DSPTY		= HH.NOFCT_DSPTY(+)
					   AND	   AA.SYSTEMKEY			= HH.SYSTEMKEY(+)
					  ) II
					  WHERE 1=1
					  <isNotEmpty prepend="AND" property="dpobCd" >
			 	     II.DPOB_CD=#dpobCd#
		           </isNotEmpty> 
		           <isNotEmpty prepend="AND" property="mangeDeptCd" >
				         II.MAN_DEPT_CD=#mangeDeptCd#
				        </isNotEmpty>      
				        <isNotEmpty prepend="AND" property="repbtyBusinDivCd" >
				         II.REPBTY_BUSIN_DIV_CD=#repbtyBusinDivCd#
				        </isNotEmpty> 
					                AND EXISTS  (
			                      SELECT  C.DPOB_CD,
			                                 C.DTIL_OCCU_INTTN_CD,
			                                 C.TYP_OCCU_CD,
			                                 C.DEPT_CD FROM 
			                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' )) ) C
			                                            WHERE     C.DPOB_CD = II.DPOB_CD
									                        AND C.DEPT_CD = II.DEPT_CD
									                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(II.TYP_OCCU_CD,'TT') 
			                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(II.DTIL_OCCU_INTTN_CD,'TT')
                                               <isNotEmpty property="deptCd" prepend="AND">
												<![CDATA[
												 C.DEPT_CD
												]]>
												<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
												 #deptCdArr[]#
												</iterate>
												</isNotEmpty> 
				 
                                          ) 
				       <isNotEmpty prepend="AND" property="businCd" >
					 	II.BUSIN_CD=#businCd#
				       </isNotEmpty> 
				       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
					 	II.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
				       </isNotEmpty> 
				       <isNotEmpty prepend="AND" property="emymtDivCd" >
					 	II.EMYMT_DIV_CD=#emymtDivCd#
					 	</isNotEmpty> 
				         <isNotEmpty prepend="AND" property="nofctYrMnth" >
					 	II.NOFCT_YR_MNTH = #nofctYrMnth#
				       </isNotEmpty>  
 					<isNotEmpty property="typOccuCd" prepend="AND">
					<![CDATA[
					 II.TYP_OCCU_CD
					]]>
					<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
					 #typOccuCdArr[]#
					</iterate>
					</isNotEmpty>  
				   <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 II.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate>
					</isNotEmpty>  
					<!--   <isNotEmpty property="dtilOccuClsDivCd" prepend="AND">
					<![CDATA[
					 II.DTIL_OCCU_CLS_DIV_CD
					]]>
					<iterate prepend="IN" property="dtilOccuClsDivCdArr" open="(" close=")" conjunction=",">
					 #dtilOccuClsDivCdArr[]#
					</iterate>
					</isNotEmpty>   -->
					<!--  <isNotEmpty property="hdofcCodtnCd" prepend="AND">
				<![CDATA[
				 II.HDOFC_DIV_CD
				]]>
				<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
				 #hdofcCodtnCdArr[]#
				</iterate>
				</isNotEmpty>
				 --> 
				          <isNotEmpty prepend="AND" property="systemkey" >
					 	II.SYSTEMKEY=#systemkey#
				       </isNotEmpty>  
				       <isNotEmpty prepend="AND" property="hanNm" >
					 	II.HAN_NM LIKE '%' || #hanNm# || '%'
				       </isNotEmpty>  
					ORDER BY   II.NOFCT_YR_MNTH DESC
						    , II.PAYR_MANG_DEPT_CD DESC
							 ,(SELECT LPAD(DEPT_RANK,5,'0')  
                                   FROM BASS0400 DD
                                   WHERE DD.DEPT_CD =  II.DEPT_CD  
                                     AND DD.DPOB_CD = II.DPOB_CD) ASC 
						    , II.RESN_REGN_NUM ASC
							, II.SYSTEMKEY DESC 				 
		
		<![CDATA[					
	) A WHERE ROWNUM <= #lastIndex#
)WHERE RNUM >= #firstIndex#
]]>
	</select>	
	<!-- Insr4200 화면 월정산대사 화면 리스트 출력  -->
	<select id="insr3200DAO.selectInsr3200ListTotCnt_S" parameterClass="insr3200SerarchVO" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM  (
				 SELECT 
					    II.NOFCT_YR_MNTH ,  
				        II.HLTH_INSR_CERT_NUM ,
				        II.HAN_NM ,
				        II.RESN_REGN_NUM ,
				        (
				          SELECT COMM_CD_NM
				          FROM BASS0300 A03
				          WHERE A03.RPSTTV_CD  = 'I007'
				          AND A03.DPOB_CD      = II.DPOB_CD
				          AND A03.MANGE_ITEM11 = II.REDU_REAS_CD
				        ) AS REDU_REAS_NM ,
				        II.PAY_MNTH_AMNT ,
				        II.DDUC_YR_MNTH ,
				        II.HLTH_INSR_PRCS_YN ,
				        II.CALC_PRMM ,
				        II.SAN_CALC_PRMM ,
				        <![CDATA[	
				       (
				        CASE
				          WHEN NVL(II.HLTH_INSR_PRMM_SRD,0) <> (NVL(II.CALC_PRMM,0) - NVL(II.SAN_CALC_PRMM,0))
				          THEN (II.CALC_PRMM - II.SAN_CALC_PRMM)
				          ELSE NVL(II.HLTH_INSR_PRMM_SRD,0)
				        END) AS HLTH_INSR_PRMM_SRD , 
				         ]]>         
				        II.HLTH_INSR_REFD_ITRT ,
				        II.LGTM_RCPTN_CALC_PRMM ,
				        II.SAN_LGTM_RCPTN_CALC_PRMM , 
				         <![CDATA[      
				        (
				        CASE
				          WHEN NVL(II.LGTM_RCPTN_INSUR_SRD,0) <> (NVL(II.LGTM_RCPTN_CALC_PRMM,0) - NVL(II.SAN_LGTM_RCPTN_CALC_PRMM,0))
				          THEN (NVL(II.LGTM_RCPTN_CALC_PRMM,0) - NVL(II.SAN_LGTM_RCPTN_CALC_PRMM,0))
				          ELSE NVL(II.LGTM_RCPTN_INSUR_SRD,0)
				        END) AS LGTM_RCPTN_INSUR_SRD ,        
				        II.LGTM_RCPTN_REFD_ITRT ,       
				        (
				        CASE
				          WHEN NVL(II.HLTH_INSR_PRMM_SRD,0) + NVL(II.LGTM_RCPTN_INSUR_SRD,0) <> (NVL(II.CALC_PRMM,0) - NVL(II.SAN_CALC_PRMM,0) +NVL(II.LGTM_RCPTN_CALC_PRMM,0) - NVL(II.SAN_LGTM_RCPTN_CALC_PRMM,0) )
				          THEN ( NVL(II.CALC_PRMM,0)        - NVL(II.SAN_CALC_PRMM,0) +NVL(II.LGTM_RCPTN_CALC_PRMM,0) - NVL(II.SAN_LGTM_RCPTN_CALC_PRMM,0) + NVL( II.HLTH_INSR_REFD_ITRT,0) + NVL( II.LGTM_RCPTN_REFD_ITRT,0) )
				          ELSE NVL(II.HLTH_INSR_PRMM_SRD,0) + NVL(II.LGTM_RCPTN_INSUR_SRD,0) + NVL( II.HLTH_INSR_REFD_ITRT,0) + NVL( II.LGTM_RCPTN_REFD_ITRT,0)
				        END) AS SRD_AGGR_SUM ,
				     ]]>
						II.DPOB_CD ,
						II.SYSTEMKEY ,
						II.NOFCT_DSPTY ,
						II.EMYMT_SEIL_NUM ,
						II.DPOB_MANGE_NUM ,
						II.UNT_ISTUT_CD ,
						II.ACC_SGN ,
						II.REDU_REAS_CD ,
						II.HLTH_INSR_TYP_OCCU_CD ,
						II.PAY_MNTH_AMNT_GRDE ,
						II.CLUT_REAS_CD ,
						II.CLUT_APPTN_BGNN_YR_MNTH ,
						II.CLUT_APPTN_END_YR_MNTH ,
						II.CLUT_PRMM ,
						II.NOFCT_PRMM ,
						II.YRTX_PRMM ,
						II.AQTN_DT ,
						II.LSS_DT ,
						II.LGTM_RCPTN_CLUT_REAS_CD ,
						II.LGTM_RCPTN_APPTN_BGNN_YR_MNTH ,
						II.LGTM_RCPTN_APPTN_END_YR_MNTH ,
						II.LGTM_RCPTN_CLUT_PRMM ,
						II.LGTM_RCPTN_NOFCT_PRMM ,
						II.LGTM_RCPTN_YRTX_PRMM ,
						II.HLTH_RCPTN_CALC_PRMM ,
						II.HLTH_RCPTN_CLUT_PRMM ,
						II.HLTH_RCPTN_NOFCT_PRMM ,
						II.HLTH_RCPTN_YRTX_PRMM ,
						II.TOT_PYMT_PRMM ,
						II.EMYMT_DIV_CD ,
						II.EMYMT_DIV_NM ,
						II.DEPT_CD ,
						II.DEPT_NM ,
						II.TYP_OCCU_CD ,
						II.TYP_OCCU_NM ,
						II.PYSP_GRDE_CD ,
				    <!--   II.DTIL_OCCU_INTTN_CD , -->
				      II.DTIL_OCCU_CLS_DIV_NM ,
				      II.BUSIN_CD ,
				      II.BUSIN_NM ,
				      II.PAYR_MANG_DEPT_CD ,
				      II.PAYR_MANG_DEPT_NM ,
				      II.HLTH_INSR_PRCS_DT ,
				      II.DIVD_PYMT_DIV_CD ,
				      II.DIVD_PYMT 
					FROM 
					(SELECT 
					     AA.DPOB_CD
					   , AA.SYSTEMKEY,AA.NOFCT_YR_MNTH
					   , AA.NOFCT_DSPTY
					   , AA.EMYMT_SEIL_NUM
					   , AA.DPOB_MANGE_NUM
					   , AA.UNT_ISTUT_CD
					   , AA.ACC_SGN
					   , AA.HLTH_INSR_CERT_NUM
					   , AA.HAN_NM
					   , AA.RESN_REGN_NUM
					   , AA.REDU_REAS_CD
					   , AA.HLTH_INSR_TYP_OCCU_CD
					   , AA.PAY_MNTH_AMNT_GRDE
					   , AA.PAY_MNTH_AMNT
					   <![CDATA[	
					   , ( CASE
			                WHEN ( NVL(AA.CALC_PRMM,0)  - NVL(AA.CLUT_PRMM ,0) - NVL(AA.YRTX_PRMM ,0) ) <= 0
			                 THEN  0 
			                 ELSE ( NVL(AA.CALC_PRMM,0)  - NVL(AA.CLUT_PRMM ,0) - NVL(AA.YRTX_PRMM ,0) )
			                  END )AS SAN_CALC_PRMM
			            ]]>        
					     <![CDATA[	
					   ,(
				        CASE
				          WHEN  AA.PAY_CALC_RCPTN_INSUR_SUM <= 0 THEN 0
				          ELSE  AA.PAY_CALC_RCPTN_INSUR_SUM
				        END 
				        )  AS CALC_PRMM
					      ]]>  
					   , AA.CLUT_REAS_CD
					   , AA.CLUT_APPTN_BGNN_YR_MNTH
					   , AA.CLUT_APPTN_END_YR_MNTH
					   , AA.CLUT_PRMM
					   , AA.NOFCT_PRMM
					   , AA.YRTX_PRMM
					   , AA.AQTN_DT
					   , AA.LSS_DT
					   <![CDATA[	
					   , ( CASE
			                WHEN ( NVL(AA.LGTM_RCPTN_CALC_PRMM,0)  - NVL(AA.LGTM_RCPTN_CLUT_PRMM ,0) - NVL(AA.LGTM_RCPTN_YRTX_PRMM ,0) ) <= 0
			                 THEN  0 
			                 ELSE ( NVL(AA.LGTM_RCPTN_CALC_PRMM,0)  - NVL(AA.LGTM_RCPTN_CLUT_PRMM ,0) - NVL(AA.LGTM_RCPTN_YRTX_PRMM ,0) )
                  			END ) AS SAN_LGTM_RCPTN_CALC_PRMM 
                  	   ]]> 	
					    <![CDATA[	 
					    , (
					        CASE
					          WHEN  AA.PAY_CALC_RCPTN_INSUR_SUM <= 0 THEN 0
					          ELSE  AA.PAY_CALC_RCPTN_INSUR_SUM
					        END 
					      )  AS LGTM_RCPTN_CALC_PRMM
					   ]]>
					   , AA.LGTM_RCPTN_CLUT_REAS_CD
					   , AA.LGTM_RCPTN_APPTN_BGNN_YR_MNTH
					   , AA.LGTM_RCPTN_APPTN_END_YR_MNTH
					   , AA.LGTM_RCPTN_CLUT_PRMM 
					   , AA.LGTM_RCPTN_NOFCT_PRMM
					   , AA.LGTM_RCPTN_YRTX_PRMM 
					   , AA.HLTH_RCPTN_CALC_PRMM 
					   , AA.HLTH_RCPTN_CLUT_PRMM
					   , AA.HLTH_RCPTN_NOFCT_PRMM
					   , AA.HLTH_RCPTN_YRTX_PRMM
					   , AA.HLTH_INSR_REFD_ITRT
					   , AA.LGTM_RCPTN_REFD_ITRT
					   , AA.TOT_PYMT_PRMM 
					   , BB.DEPT_CD AS MAN_DEPT_CD
					   , BB.REPBTY_BUSIN_DIV_CD
					   , BB.EMYMT_DIV_CD
					    ,fcBass0300CDNM(BB.DPOB_CD,BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM
					    
					    ,BB.CURR_AFFN_DEPT_CD AS DEPT_CD
					    ,fcBass0400CDNM(BB.DPOB_CD,BB.DEPT_CD,'2') AS DEPT_NM 
					    ,BB.TYP_OCCU_CD 
					    , fcBass0320CDNM(BB.DPOB_CD,BB.TYP_OCCU_CD) AS TYP_OCCU_NM
					    ,NVL(BB.PYSP_GRDE_CD,'A0060000') AS PYSP_GRDE_CD
					    ,BB.BUSIN_CD
					    ,fcBass0500CDNM(BB.DPOB_CD,SUBSTR(BB.BUSIN_CD,1,4),BB.DEPT_CD,BB.BUSIN_CD) AS BUSIN_NM   
					    <!--  ,	 BB.DTIL_OCCU_INTTN_CD  -->
		                 , fcBassEx0350CDNM(BB.DPOB_CD,BB.TYP_OCCU_CD,BB.DTIL_OCCU_INTTN_CD,'1' ) AS DTIL_OCCU_CLS_DIV_NM 
					    ,GG.PAYR_MANG_DEPT_CD
					    ,fcBass0400CDNM(GG.DPOB_CD,GG.PAYR_MANG_DEPT_CD,'2') AS PAYR_MANG_DEPT_NM
					   , HH.DDUC_YR_MNTH
					   , HH.HLTH_INSR_PRCS_DT
					   , HH.HLTH_INSR_PRCS_YN
					   , HH.HLTH_INSR_PRMM_SRD
					   , HH.LGTM_RCPTN_INSUR_SRD
					   , HH.SRD_AGGR_SUM
					   , HH.DIVD_PYMT_DIV_CD
					   , HH.DIVD_PYMT
					   , BB.DTIL_OCCU_INTTN_CD 
					FROM  INSR3200 AA , PSNL0100 BB,BASS0400 GG, INSR3300 HH  
					WHERE AA.DPOB_CD=BB.DPOB_CD  
					  AND AA.SYSTEMKEY = BB.SYSTEMKEY 
					  AND BB.DPOB_CD=GG.DPOB_CD   
					  AND BB.CURR_AFFN_DEPT_CD = GG.DEPT_CD   
					  AND AA.NOFCT_YR_MNTH = HH.NOFCT_YR_MNTH(+)
					  AND AA.NOFCT_DSPTY = HH.NOFCT_DSPTY(+)  
					  AND AA.SYSTEMKEY = HH.SYSTEMKEY(+)
					  ) II
					  WHERE 1=1
					  
					  <isNotEmpty prepend="AND" property="dpobCd" >
			 	     II.DPOB_CD=#dpobCd#
		           </isNotEmpty> 
		             <isNotEmpty prepend="AND" property="mangeDeptCd" >
				         II.MAN_DEPT_CD=#mangeDeptCd#
				        </isNotEmpty>      
				        <isNotEmpty prepend="AND" property="repbtyBusinDivCd" >
				         II.REPBTY_BUSIN_DIV_CD=#repbtyBusinDivCd#
				        </isNotEmpty> 
					                AND EXISTS  (
		        SELECT  C.DPOB_CD,
			                                 C.DTIL_OCCU_INTTN_CD,
			                                 C.TYP_OCCU_CD,
			                                 C.DEPT_CD FROM 
			                                             (  SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' ))) C
			                                            WHERE     C.DPOB_CD = II.DPOB_CD
									                        AND C.DEPT_CD = II.DEPT_CD
									                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(II.TYP_OCCU_CD,'TT') 
			                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(II.DTIL_OCCU_INTTN_CD,'TT')
                                               <isNotEmpty property="deptCd" prepend="AND">
												<![CDATA[
												 C.DEPT_CD
												]]>
												<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
												 #deptCdArr[]#
												</iterate>
												</isNotEmpty> 
				 
                                          ) 
				       <isNotEmpty prepend="AND" property="businCd" >
					 	II.BUSIN_CD=#businCd#
				       </isNotEmpty> 
				       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
					 	II.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
				       </isNotEmpty> 
				       <isNotEmpty prepend="AND" property="emymtDivCd" >
					 	II.EMYMT_DIV_CD=#emymtDivCd#
					 	</isNotEmpty> 
				         <isNotEmpty prepend="AND" property="nofctYrMnth" >
					 	II.NOFCT_YR_MNTH = #nofctYrMnth#
				       </isNotEmpty>  
 					<isNotEmpty property="typOccuCd" prepend="AND">
					<![CDATA[
					 II.TYP_OCCU_CD
					]]>
					<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
					 #typOccuCdArr[]#
					</iterate>
					</isNotEmpty>  
				   <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 II.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate>
					</isNotEmpty>  
					<!--   <isNotEmpty property="dtilOccuClsDivCd" prepend="AND">
					<![CDATA[
					 II.DTIL_OCCU_CLS_DIV_CD
					]]>
					<iterate prepend="IN" property="dtilOccuClsDivCdArr" open="(" close=")" conjunction=",">
					 #dtilOccuClsDivCdArr[]#
					</iterate>
					</isNotEmpty>   -->
					<!--  <isNotEmpty property="hdofcCodtnCd" prepend="AND">
				<![CDATA[
				 II.HDOFC_DIV_CD
				]]>
				<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
				 #hdofcCodtnCdArr[]#
				</iterate>
				</isNotEmpty>
				 --> 
				          <isNotEmpty prepend="AND" property="systemkey" >
					 	II.SYSTEMKEY=#systemkey#
				       </isNotEmpty>  
				       <isNotEmpty prepend="AND" property="hanNm" >
					 	II.HAN_NM LIKE '%' || #hanNm# || '%'
				       </isNotEmpty>  
			)
	</select>
		<!-- Insr4200 화면 월정산대사 화면 엑셀 리스트 출력  -->
	<select id="insr3200DAO.selectXlsInsr4200ToInsr3200List_D" parameterClass="insr3200SerarchVO" resultClass="egovMap">
 

				 SELECT 
					    II.NOFCT_YR_MNTH ,  
				        II.HLTH_INSR_CERT_NUM ,
				        II.HAN_NM ,
				        II.RESN_REGN_NUM ,
				        (
				          SELECT COMM_CD_NM
				          FROM BASS0300 A03
				          WHERE A03.RPSTTV_CD  = 'I007'
				          AND A03.DPOB_CD      = II.DPOB_CD
				          AND A03.MANGE_ITEM11 = II.REDU_REAS_CD
				        ) AS REDU_REAS_NM ,
				        II.PAY_MNTH_AMNT ,
				        II.DDUC_YR_MNTH ,
				        II.HLTH_INSR_PRCS_YN ,
				        II.CALC_PRMM ,
				        II.SAN_CALC_PRMM ,
				        <![CDATA[	
				       (
				        CASE
				          WHEN NVL(II.HLTH_INSR_PRMM_SRD,0) <> (NVL(II.CALC_PRMM,0) - NVL(II.SAN_CALC_PRMM,0))
				          THEN (II.CALC_PRMM - II.SAN_CALC_PRMM)
				          ELSE NVL(II.HLTH_INSR_PRMM_SRD,0)
				        END) AS HLTH_INSR_PRMM_SRD , 
				         ]]>         
				        II.HLTH_INSR_REFD_ITRT ,
				        II.LGTM_RCPTN_CALC_PRMM ,
				        II.SAN_LGTM_RCPTN_CALC_PRMM , 
				         <![CDATA[      
				        (
				        CASE
				          WHEN NVL(II.LGTM_RCPTN_INSUR_SRD,0) <> (NVL(II.LGTM_RCPTN_CALC_PRMM,0) - NVL(II.SAN_LGTM_RCPTN_CALC_PRMM,0))
				          THEN (NVL(II.LGTM_RCPTN_CALC_PRMM,0) - NVL(II.SAN_LGTM_RCPTN_CALC_PRMM,0))
				          ELSE NVL(II.LGTM_RCPTN_INSUR_SRD,0)
				        END) AS LGTM_RCPTN_INSUR_SRD ,        
				        II.LGTM_RCPTN_REFD_ITRT ,       
				        (
				        CASE
				          WHEN NVL(II.HLTH_INSR_PRMM_SRD,0) + NVL(II.LGTM_RCPTN_INSUR_SRD,0) <> (NVL(II.CALC_PRMM,0) - NVL(II.SAN_CALC_PRMM,0) +NVL(II.LGTM_RCPTN_CALC_PRMM,0) - NVL(II.SAN_LGTM_RCPTN_CALC_PRMM,0) )
				          THEN ( NVL(II.CALC_PRMM,0)        - NVL(II.SAN_CALC_PRMM,0) +NVL(II.LGTM_RCPTN_CALC_PRMM,0) - NVL(II.SAN_LGTM_RCPTN_CALC_PRMM,0) + NVL( II.HLTH_INSR_REFD_ITRT,0) + NVL( II.LGTM_RCPTN_REFD_ITRT,0) )
				          ELSE NVL(II.HLTH_INSR_PRMM_SRD,0) + NVL(II.LGTM_RCPTN_INSUR_SRD,0) + NVL( II.HLTH_INSR_REFD_ITRT,0) + NVL( II.LGTM_RCPTN_REFD_ITRT,0)
				        END) AS SRD_AGGR_SUM ,
				     ]]>
						II.DPOB_CD ,
						II.SYSTEMKEY ,
						II.NOFCT_DSPTY ,
						II.EMYMT_SEIL_NUM ,
						II.DPOB_MANGE_NUM ,
						II.UNT_ISTUT_CD ,
						II.ACC_SGN ,
						II.REDU_REAS_CD ,
						II.HLTH_INSR_TYP_OCCU_CD ,
						II.PAY_MNTH_AMNT_GRDE ,
						II.CLUT_REAS_CD ,
						II.CLUT_APPTN_BGNN_YR_MNTH ,
						II.CLUT_APPTN_END_YR_MNTH ,
						II.CLUT_PRMM ,
						II.NOFCT_PRMM ,
						II.YRTX_PRMM ,
						II.AQTN_DT ,
						II.LSS_DT ,
						II.LGTM_RCPTN_CLUT_REAS_CD ,
						II.LGTM_RCPTN_APPTN_BGNN_YR_MNTH ,
						II.LGTM_RCPTN_APPTN_END_YR_MNTH ,
						II.LGTM_RCPTN_CLUT_PRMM ,
						II.LGTM_RCPTN_NOFCT_PRMM ,
						II.LGTM_RCPTN_YRTX_PRMM ,
						II.HLTH_RCPTN_CALC_PRMM ,
						II.HLTH_RCPTN_CLUT_PRMM ,
						II.HLTH_RCPTN_NOFCT_PRMM ,
						II.HLTH_RCPTN_YRTX_PRMM ,
						II.TOT_PYMT_PRMM ,
						II.EMYMT_DIV_CD ,
						II.EMYMT_DIV_NM ,
						II.DEPT_CD ,
						II.DEPT_NM ,
						II.TYP_OCCU_CD ,
						II.TYP_OCCU_NM ,
						II.PYSP_GRDE_CD ,
				    <!--   II.DTIL_OCCU_INTTN_CD , -->
				      II.DTIL_OCCU_CLS_DIV_NM ,
				      II.BUSIN_CD ,
				      II.BUSIN_NM ,
				      II.PAYR_MANG_DEPT_CD ,
				      II.PAYR_MANG_DEPT_NM ,
				      II.HLTH_INSR_PRCS_DT ,
				      II.DIVD_PYMT_DIV_CD ,
				      II.DIVD_PYMT 
					FROM 
					(SELECT 
					     AA.DPOB_CD
					   , AA.SYSTEMKEY,AA.NOFCT_YR_MNTH
					   , AA.NOFCT_DSPTY
					   , AA.EMYMT_SEIL_NUM
					   , AA.DPOB_MANGE_NUM
					   , AA.UNT_ISTUT_CD
					   , AA.ACC_SGN
					   , AA.HLTH_INSR_CERT_NUM
					   , AA.HAN_NM
					   , AA.RESN_REGN_NUM
					   , AA.REDU_REAS_CD
					   , AA.HLTH_INSR_TYP_OCCU_CD
					   , AA.PAY_MNTH_AMNT_GRDE
					   , AA.PAY_MNTH_AMNT
					   , (NVL(AA.NOFCT_PRMM,0) +  NVL(AA.YRTX_PRMM,0) )  AS SAN_CALC_PRMM
					   , AA.PAY_CALC_HLTH_INSR_SUM   AS CALC_PRMM
					   , AA.CLUT_REAS_CD
					   , AA.CLUT_APPTN_BGNN_YR_MNTH
					   , AA.CLUT_APPTN_END_YR_MNTH
					   , AA.CLUT_PRMM
					   , AA.NOFCT_PRMM
					   , AA.YRTX_PRMM
					   , AA.AQTN_DT
					   , AA.LSS_DT
					   , (  NVL(AA.LGTM_RCPTN_NOFCT_PRMM,0)  + NVL(AA.LGTM_RCPTN_YRTX_PRMM,0)  )  AS SAN_LGTM_RCPTN_CALC_PRMM
					   , AA.PAY_CALC_RCPTN_INSUR_SUM AS LGTM_RCPTN_CALC_PRMM
					   , AA.LGTM_RCPTN_CLUT_REAS_CD
					   , AA.LGTM_RCPTN_APPTN_BGNN_YR_MNTH
					   , AA.LGTM_RCPTN_APPTN_END_YR_MNTH
					   , AA.LGTM_RCPTN_CLUT_PRMM 
					   , AA.LGTM_RCPTN_NOFCT_PRMM
					   , AA.LGTM_RCPTN_YRTX_PRMM 
					   , AA.HLTH_RCPTN_CALC_PRMM 
					   , AA.HLTH_RCPTN_CLUT_PRMM
					   , AA.HLTH_RCPTN_NOFCT_PRMM
					   , AA.HLTH_RCPTN_YRTX_PRMM
					   , AA.HLTH_INSR_REFD_ITRT
					   , AA.LGTM_RCPTN_REFD_ITRT
					   , AA.TOT_PYMT_PRMM
					   , BB.DEPT_CD AS MAN_DEPT_CD
					   , BB.REPBTY_BUSIN_DIV_CD 
					   , BB.EMYMT_DIV_CD
					    ,fcBass0300CDNM(BB.DPOB_CD,BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM
					    
					    ,BB.CURR_AFFN_DEPT_CD AS DEPT_CD
					    ,fcBass0400CDNM(BB.DPOB_CD,BB.DEPT_CD,'2') AS DEPT_NM 
					    ,BB.TYP_OCCU_CD 
					    , fcBass0320CDNM(BB.DPOB_CD,BB.TYP_OCCU_CD) AS TYP_OCCU_NM
					    ,NVL(BB.PYSP_GRDE_CD,'A0060000') AS PYSP_GRDE_CD
					    ,BB.BUSIN_CD
					    ,fcBass0500CDNM(BB.DPOB_CD,SUBSTR(BB.BUSIN_CD,1,4),BB.DEPT_CD,BB.BUSIN_CD) AS BUSIN_NM   
					     ,	 BB.DTIL_OCCU_INTTN_CD 
		                 , fcBassEx0350CDNM(BB.DPOB_CD,BB.TYP_OCCU_CD,BB.DTIL_OCCU_INTTN_CD,'1' ) AS DTIL_OCCU_CLS_DIV_NM 
					    ,GG.PAYR_MANG_DEPT_CD
					    ,fcBass0400CDNM(GG.DPOB_CD,GG.PAYR_MANG_DEPT_CD,'2') AS PAYR_MANG_DEPT_NM
					   , HH.DDUC_YR_MNTH
					   , HH.HLTH_INSR_PRCS_DT
					   , HH.HLTH_INSR_PRCS_YN
					   , HH.HLTH_INSR_PRMM_SRD
					   , HH.LGTM_RCPTN_INSUR_SRD
					   , HH.SRD_AGGR_SUM
					   , HH.DIVD_PYMT_DIV_CD
					   , HH.DIVD_PYMT 
					FROM  INSR3200 AA , PSNL0100 BB,BASS0400 GG, INSR3300 HH ,
					   (
					   SELECT  CC.DPOB_CD
	                         , CC.SYSTEMKEY 
	                         , CC.HLTH_INSUR_FLUC_DT             
	                         , CC.HLTH_INSR_PAY_TOT_AMNT            
	                         , CC.HLTH_INSR_MNTH_RUNTN_AMNT 
	                         , (CASE WHEN NVL(FF.EXPTN_PRCS_PYMT_RTO01,0) > 0  
	                                 THEN (TRUNC(((CC.HLTH_INSR_MNTH_RUNTN_AMNT * (HLTH_INSR_HMLF_BRDN_APMRT / 100)) * ((100 - FF.EXPTN_PRCS_PYMT_RTO01) / 100)), -1))
	                                 ELSE (TRUNC(CC.HLTH_INSR_MNTH_RUNTN_AMNT * (HLTH_INSR_HMLF_BRDN_APMRT / 100), -1))
	                            END
	                           ) AS HLTH_INSR_MNTH_AMNT
	                         , (CASE WHEN NVL(FF.EXPTN_PRCS_PYMT_RTO02,0) > 0
	                                 THEN (TRUNC((((CC.HLTH_INSR_MNTH_RUNTN_AMNT * (HLTH_INSR_HMLF_BRDN_APMRT / 100)) * (HLTH_RCPTN_HMLF_BRDN_APMRT / 100)) * ((100 - FF.EXPTN_PRCS_PYMT_RTO02)/100)), -1))
	                                 ELSE (TRUNC(((CC.HLTH_INSR_MNTH_RUNTN_AMNT * (HLTH_INSR_HMLF_BRDN_APMRT / 100)) * (HLTH_RCPTN_HMLF_BRDN_APMRT / 100)), -1))
	                            END
	                           ) AS HLTH_RCPTN_MNTH_AMNT
	                         , CC.HLTH_INSR_GRDE
	                         , CC.HLTH_INSR_CERT_NUM
	                         , CC.HLTH_INSR_APPTN_YN
					   FROM	   PSNL0127 CC
					   		 , (SELECT  DPOB_CD
									  , HLTH_INSR_MINM_MNTH_RUNTN_AMNT
									  , HLTH_INSR_BST_MNTH_RUNTN_AMNT
									  , HLTH_INSR_HMLF_BRDN_APMRT
									  , HLTH_RCPTN_HMLF_BRDN_APMRT
								FROM	INSR0240 A01
								WHERE	#nofctYrMnth# BETWEEN SUBSTR(A01.HLTH_INSR_BGNN_DT, 1, 6)
													  AND	  SUBSTR(A01.HLTH_INSR_END_DT,  1, 6)
							   ) DD
							 , (SELECT  DPOB_CD
									  ,	SYSTEMKEY
									  , MAX(DECODE(PAY_ITEM_CD, 'D0010100', EXPTN_DIV_CD, '')) AS EXPTN_DIV_CD01
									  , MAX(DECODE(PAY_ITEM_CD,'D0110100',EXPTN_DIV_CD,'')) AS EXPTN_DIV_CD02
									  , MAX(DECODE(PAY_ITEM_CD,'D0150100',EXPTN_DIV_CD,'')) AS EXPTN_DIV_CD03
									  , MAX(DECODE(PAY_ITEM_CD,'D0160100',EXPTN_DIV_CD,'')) AS EXPTN_DIV_CD04
									  , MAX(DECODE(PAY_ITEM_CD,'D0010100',EXPTN_PRCS_PYMT_RTO,0)) AS EXPTN_PRCS_PYMT_RTO01
									  , MAX(DECODE(PAY_ITEM_CD,'D0110100',EXPTN_PRCS_PYMT_RTO,0)) AS EXPTN_PRCS_PYMT_RTO02
									  , MAX(DECODE(PAY_ITEM_CD,'D0150100',EXPTN_PRCS_PYMT_RTO,0)) AS EXPTN_PRCS_PYMT_RTO03
									  , MAX(DECODE(PAY_ITEM_CD,'D0160100',EXPTN_PRCS_PYMT_RTO,0)) AS EXPTN_PRCS_PYMT_RTO04
								FROM	(SELECT	 DPOB_CD            
											   , SYSTEMKEY           
											   , EXPTN_PRCS_SEIL_NUM             
											   , EXPTN_DIV_CD            
											   , PYMT_DDUC_DIV_CD           
											   , EXMTN_YN       
											   , EXPTN_PRCS_PYMT_RTO           
											   , PAY_ITEM_CD  
										 FROM	 PAYR0540 A02
										 WHERE	 #nofctYrMnth# BETWEEN SUBSTR(A02.EXPTN_PRCS_BGNN_DT, 1, 6)
															   AND	   SUBSTR(A02.EXPTN_PRCS_END_DT,  1, 6)
										)
								GROUP BY  DPOB_CD
										, SYSTEMKEY
							   ) FF
						WHERE	CC.DPOB_CD	 = DD.DPOB_CD
						AND		CC.DPOB_CD	 = FF.DPOB_CD(+)
						AND		CC.SYSTEMKEY = FF.SYSTEMKEY(+)
					   ) EE
					   WHERE   AA.DPOB_CD			= BB.DPOB_CD
					   AND	   AA.SYSTEMKEY			= BB.SYSTEMKEY
					   AND	   BB.DPOB_CD			= GG.DPOB_CD
					   AND	   BB.CURR_AFFN_DEPT_CD = GG.DEPT_CD
					   AND	   AA.DPOB_CD			= EE.DPOB_CD(+)
					   AND	   AA.SYSTEMKEY			= EE.SYSTEMKEY(+)
					   AND	   AA.NOFCT_YR_MNTH		= HH.NOFCT_YR_MNTH(+)
					   AND	   AA.NOFCT_DSPTY		= HH.NOFCT_DSPTY(+)
					   AND	   AA.SYSTEMKEY			= HH.SYSTEMKEY(+)
					  ) II
					  WHERE 1=1
					  <isNotEmpty prepend="AND" property="dpobCd" >
			 	     II.DPOB_CD=#dpobCd#
		           </isNotEmpty> 
		           <isNotEmpty prepend="AND" property="mangeDeptCd" >
			         II.MAN_DEPT_CD=#mangeDeptCd#
			        </isNotEmpty>      
			        <isNotEmpty prepend="AND" property="repbtyBusinDivCd" >
			         II.REPBTY_BUSIN_DIV_CD=#repbtyBusinDivCd#
			        </isNotEmpty>
		                AND EXISTS  (
                         SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' ))) C
                                            WHERE     C.DPOB_CD = II.DPOB_CD
						                        AND C.DEPT_CD = II.DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(II.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(II.DTIL_OCCU_INTTN_CD,'TT')
                                               <isNotEmpty property="deptCd" prepend="AND">
												<![CDATA[
												 C.DEPT_CD
												]]>
												<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
												 #deptCdArr[]#
												</iterate>
												</isNotEmpty> 
				 
                                          ) 
				       <isNotEmpty prepend="AND" property="businCd" >
					 	II.BUSIN_CD=#businCd#
				       </isNotEmpty> 
				       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
					 	II.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
				       </isNotEmpty> 
				       <isNotEmpty prepend="AND" property="emymtDivCd" >
					 	II.EMYMT_DIV_CD=#emymtDivCd#
					 	</isNotEmpty> 
				         <isNotEmpty prepend="AND" property="nofctYrMnth" >
					 	II.NOFCT_YR_MNTH = #nofctYrMnth#
				       </isNotEmpty>  
 					<isNotEmpty property="typOccuCd" prepend="AND">
					<![CDATA[
					 II.TYP_OCCU_CD
					]]>
					<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
					 #typOccuCdArr[]#
					</iterate>
					</isNotEmpty>  
				   <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 II.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate>
					</isNotEmpty>  
					<!--   <isNotEmpty property="dtilOccuClsDivCd" prepend="AND">
					<![CDATA[
					 II.DTIL_OCCU_CLS_DIV_CD
					]]>
					<iterate prepend="IN" property="dtilOccuClsDivCdArr" open="(" close=")" conjunction=",">
					 #dtilOccuClsDivCdArr[]#
					</iterate>
					</isNotEmpty>   -->
					<!--  <isNotEmpty property="hdofcCodtnCd" prepend="AND">
				<![CDATA[
				 II.HDOFC_DIV_CD
				]]>
				<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
				 #hdofcCodtnCdArr[]#
				</iterate>
				</isNotEmpty>
				 --> 
				          <isNotEmpty prepend="AND" property="systemkey" >
					 	II.SYSTEMKEY=#systemkey#
				       </isNotEmpty>  
				       <isNotEmpty prepend="AND" property="hanNm" >
					 	II.HAN_NM LIKE '%' || #hanNm# || '%'
				       </isNotEmpty>  
					ORDER BY   II.NOFCT_YR_MNTH DESC
						    , II.PAYR_MANG_DEPT_CD DESC
							 ,(SELECT LPAD(DEPT_RANK,5,'0')  
                                   FROM BASS0400 DD
                                   WHERE DD.DEPT_CD =  II.DEPT_CD  
                                     AND DD.DPOB_CD = II.DPOB_CD) ASC 
						    , II.RESN_REGN_NUM ASC
							, II.SYSTEMKEY DESC 				 
		 
		 
	</select>	

	
	<select id="insr3200DAO.selectInsrP420001ToInsr3200List_D" parameterClass="insr3200SerarchVO" resultClass="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (
		 SELECT
                         AA.DPOB_CD
                        , AA.PYMT_YR_MNTH
                        , AA.SYSTEMKEY 
                        , AA.EMYMT_DIV_CD                               
                        , fcBass0300CDNM(AA.DPOB_CD,AA.EMYMT_DIV_CD) AS EMYMT_DIV_NM
                        , AA.HAN_NM
                        , AA.RESN_REGN_NUM
                        , AA.DEPT_CD AS DEPT_CD
                        , fcBass0400CDNM(AA.DPOB_CD,AA.DEPT_CD,'2') AS DEPT_NM 
                        , NVL(CC.PYMT_DDUC_D0010100,0) AS HLTH_INSR_MNTH_AMNT 
                        , NVL(EE.BEFORE_PYMT_DDUC_D0010100,0) AS BEFORE_HLTH_INSR_MNTH_AMNT 
                        , NVL(EE.BEFORE_PYMT_DDUC_D0010100,0) - NVL(CC.PYMT_DDUC_D0010100,0) AS HLTH_INSR_GAP_AMNT
						, NVL(CC.PYMT_DDUC_D0110100,0) AS HLTH_RCPTN_MNTH_AMNT 
                        , NVL(EE.BEFORE_PYMT_DDUC_D0110100,0) AS BEFORE_HLTH_RCPTN_MNTH_AMNT 
                        , NVL(EE.BEFORE_PYMT_DDUC_D0110100,0) - NVL(CC.PYMT_DDUC_D0110100,0) AS HLTH_RCPTN_GAP_AMNT 
                        , DD.HLTH_INSR_MNTH_RUNTN_AMNT AS PAY_MNTH_AMNT
              FROM PAYR0304 AA, PAYR0300 BB,  
                     (
                     SELECT
                              DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                              PAYR_SEIL_NUM, SYSTEMKEY,
                              DECODE(PYMT_DDUC_D0010100 ,-1000000000,0,PYMT_DDUC_D0010100 ) AS  PYMT_DDUC_D0010100,
                              DECODE(PYMT_DDUC_D0110100 ,-1000000000,0,PYMT_DDUC_D0110100 ) AS  PYMT_DDUC_D0110100
                        FROM 
		                        (   SELECT
		                              DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
		                              PAYR_SEIL_NUM, SYSTEMKEY,
		                              MAX(DECODE(PAY_ITEM_CD ,'D0010100',PYMT_DDUC_SUM,-1000000000)) AS  PYMT_DDUC_D0010100,
		                              MAX(DECODE(PAY_ITEM_CD ,'D0110100',PYMT_DDUC_SUM,-1000000000)) AS  PYMT_DDUC_D0110100
			                        FROM 
				                        (SELECT 
				                           DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
				                           PAYR_SEIL_NUM, SYSTEMKEY, PAY_ITEM_CD ,  
				                           SUM(PYMT_DDUC_SUM) AS PYMT_DDUC_SUM 
				                        FROM PAYR0302 
				                        WHERE PAY_ITEM_CD IN ('D0010100','D0110100')
				                        GROUP BY DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
				                                 PAYR_SEIL_NUM, SYSTEMKEY, PAY_ITEM_CD) 
			                        GROUP BY DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
			                           PAYR_SEIL_NUM, SYSTEMKEY
                         )
                     ) CC, 
                     PAYR0309 DD,            
                     (
                     SELECT
                              DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                              PAYR_SEIL_NUM, SYSTEMKEY,
                              DECODE(BEFORE_PYMT_DDUC_D0010100 ,-1000000000,0,BEFORE_PYMT_DDUC_D0010100 ) AS  BEFORE_PYMT_DDUC_D0010100,
                              DECODE(BEFORE_PYMT_DDUC_D0110100 ,-1000000000,0,BEFORE_PYMT_DDUC_D0110100 ) AS  BEFORE_PYMT_DDUC_D0110100
                        FROM 
		                     (  SELECT
		                              DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
		                              PAYR_SEIL_NUM, SYSTEMKEY,
		                              MAX(DECODE(PAY_ITEM_CD ,'D0010100',PYMT_DDUC_SUM,-1000000000)) AS  BEFORE_PYMT_DDUC_D0010100,
		                              MAX(DECODE(PAY_ITEM_CD ,'D0110100',PYMT_DDUC_SUM,-1000000000)) AS  BEFORE_PYMT_DDUC_D0110100
		                         FROM 
				                        (SELECT 
				                           DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
				                           PAYR_SEIL_NUM, SYSTEMKEY, PAY_ITEM_CD ,  
				                           SUM(PYMT_DDUC_SUM) AS PYMT_DDUC_SUM 
				                         FROM PAYR0302 
				                         WHERE PAY_ITEM_CD IN ('D0010100','D0110100')
				                         GROUP BY DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
				                                 PAYR_SEIL_NUM, SYSTEMKEY, PAY_ITEM_CD
			                             ) 
		                         GROUP BY DPOB_CD, PYMT_YR_MNTH, PAY_CD, PAYR_SEIL_NUM, SYSTEMKEY
                             )
                         WHERE PYMT_YR_MNTH = TO_CHAR(ADD_MONTHS(TO_DATE(#pymtYrMnth#,'YYYYMM'),-1),'YYYYMM')
                         
                     ) EE
                     
                WHERE AA.DPOB_CD=BB.DPOB_CD 
                  AND AA.PYMT_YR_MNTH  = BB.PYMT_YR_MNTH
                  AND AA.PAY_CD  = BB.PAY_CD
                  AND AA.PAYR_SEIL_NUM  = BB.PAYR_SEIL_NUM(+) 
                  AND AA.PYMT_YR_MNTH = CC.PYMT_YR_MNTH(+)
                  AND AA.SYSTEMKEY = CC.SYSTEMKEY(+)
                  AND AA.DPOB_CD = CC.DPOB_CD(+)
                  AND AA.PAY_CD = CC.PAY_CD(+) 
                  AND AA.PAYR_SEIL_NUM  = CC.PAYR_SEIL_NUM(+)   
                  AND AA.PYMT_YR_MNTH = DD.PYMT_YR_MNTH(+)
                  AND AA.SYSTEMKEY = DD.SYSTEMKEY(+)
                  AND AA.DPOB_CD = DD.DPOB_CD(+)
                  AND AA.PAY_CD = DD.PAY_CD(+) 
                  AND AA.PAYR_SEIL_NUM  = DD.PAYR_SEIL_NUM(+) 
                  
                  AND TO_CHAR(ADD_MONTHS(TO_DATE(AA.PYMT_YR_MNTH,'YYYYMM'),-1),'YYYYMM') = EE.PYMT_YR_MNTH(+)
                  
                 <!--  AND AA.PYMT_YR_MNTH = EE.PYMT_YR_MNTH(+) -->
                  AND AA.SYSTEMKEY = EE.SYSTEMKEY(+)
                  AND AA.DPOB_CD = EE.DPOB_CD(+)
                  AND AA.PAY_CD = EE.PAY_CD(+) 
                  <!-- AND AA.PAYR_SEIL_NUM  = EE.PAYR_SEIL_NUM(+)  -->
                  
				  AND AA.PYMT_YR_MNTH  = #pymtYrMnth#
			 	   <isNotEmpty prepend="AND" property="dpobCd" >
			 	     AA.DPOB_CD=#dpobCd#
		           </isNotEmpty> 
<!-- 		                AND EXISTS  (
                          SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' ))) C
                                            WHERE     C.DPOB_CD = AA.DPOB_CD
						                        AND C.DEPT_CD = AA.DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(AA.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(AA.DTIL_OCCU_INTTN_CD,'TT')
                                               <isNotEmpty property="deptCd" prepend="AND">
												<![CDATA[
												 C.DEPT_CD
												]]>
												<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
												 #deptCdArr[]#
												</iterate>
												</isNotEmpty> 
                                          )  -->
				       <isNotEmpty prepend="AND" property="businCd" >
					 	AA.BUSIN_CD=#businCd#
				       </isNotEmpty> 
				       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
					 	AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
				       </isNotEmpty> 
				       <isNotEmpty prepend="AND" property="emymtDivCd" >
					 	AA.EMYMT_DIV_CD=#emymtDivCd#
					 	</isNotEmpty>
				     
				        
				       
				         
				         
 					<isNotEmpty property="typOccuCd" prepend="AND">
					<![CDATA[
					 AA.TYP_OCCU_CD
					]]>
					<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
					 #typOccuCdArr[]#
					</iterate>
					</isNotEmpty>  
				      <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 AA.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate>
					</isNotEmpty>  
					<!--   <isNotEmpty property="dtilOccuClsDivCd" prepend="AND">
					<![CDATA[
					 AA.DTIL_OCCU_CLS_DIV_CD
					]]>
					<iterate prepend="IN" property="dtilOccuClsDivCdArr" open="(" close=")" conjunction=",">
					 #dtilOccuClsDivCdArr[]#
					</iterate>
					</isNotEmpty>   -->
					 <isNotEmpty property="hdofcCodtnCd" prepend="AND">
				<![CDATA[
				 AA.HDOFC_DIV_CD
				]]>
				<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
				 #hdofcCodtnCdArr[]#
				</iterate>
				</isNotEmpty> 
				          <isNotEmpty prepend="AND" property="systemkey" >
					 	AA.SYSTEMKEY=#systemkey#
				       </isNotEmpty>  
				       <isNotEmpty prepend="AND" property="hanNm" >
					 	AA.HAN_NM LIKE '%' || #hanNm# || '%'
				       </isNotEmpty>  
					ORDER BY   AA.PYMT_YR_MNTH DESC
						    , AA.PAYR_MANG_DEPT_CD DESC
						    , AA.PAY_CD DESC 
							, AA.PAYR_SEIL_NUM DESC
							 ,(SELECT LPAD(DEPT_RANK,5,'0')  
                                   FROM BASS0400 DD
                                   WHERE DD.DEPT_CD =  AA.DEPT_CD  
                                     AND DD.DPOB_CD = AA.DPOB_CD) ASC 
						    , AA.RESN_REGN_NUM ASC
							, AA.SYSTEMKEY DESC 
		
		<![CDATA[					
	) A WHERE ROWNUM <= #lastIndex#
)WHERE RNUM >= #firstIndex#
]]>
    </select>
    
	
	<select id="insr3200DAO.selectXlsInsrP420001ToInsr3200List_D" parameterClass="insr3200SerarchVO" resultClass="egovMap">

	SELECT A.*, ROWNUM RNUM FROM (
		 SELECT
                         AA.DPOB_CD
                        , AA.PYMT_YR_MNTH
                        , AA.SYSTEMKEY 
                        , AA.EMYMT_DIV_CD                               
                        , fcBass0300CDNM(AA.DPOB_CD,AA.EMYMT_DIV_CD) AS EMYMT_DIV_NM
                        , AA.HAN_NM
                        , AA.RESN_REGN_NUM
                        , AA.DEPT_CD AS DEPT_CD
                        , fcBass0400CDNM(AA.DPOB_CD,AA.DEPT_CD,'2') AS DEPT_NM 
                        , NVL(CC.PYMT_DDUC_D0010100,0) AS HLTH_INSR_MNTH_AMNT 
                        , NVL(EE.BEFORE_PYMT_DDUC_D0010100,0) AS BEFORE_HLTH_INSR_MNTH_AMNT 
                        , NVL(EE.BEFORE_PYMT_DDUC_D0010100,0) - NVL(CC.PYMT_DDUC_D0010100,0) AS HLTH_INSR_GAP_AMNT
						, NVL(CC.PYMT_DDUC_D0110100,0) AS HLTH_RCPTN_MNTH_AMNT 
                        , NVL(EE.BEFORE_PYMT_DDUC_D0110100,0) AS BEFORE_HLTH_RCPTN_MNTH_AMNT 
                        , NVL(EE.BEFORE_PYMT_DDUC_D0110100,0) - NVL(CC.PYMT_DDUC_D0110100,0) AS HLTH_RCPTN_GAP_AMNT 
                        , DD.HLTH_INSR_MNTH_RUNTN_AMNT AS PAY_MNTH_AMNT
              FROM PAYR0304 AA, PAYR0300 BB,  
                     (
                     SELECT
                              DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                              PAYR_SEIL_NUM, SYSTEMKEY,
                              DECODE(PYMT_DDUC_D0010100 ,-1000000000,0,PYMT_DDUC_D0010100 ) AS  PYMT_DDUC_D0010100,
                              DECODE(PYMT_DDUC_D0110100 ,-1000000000,0,PYMT_DDUC_D0110100 ) AS  PYMT_DDUC_D0110100
                        FROM 
		                        (   SELECT
		                              DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
		                              PAYR_SEIL_NUM, SYSTEMKEY,
		                              MAX(DECODE(PAY_ITEM_CD ,'D0010100',PYMT_DDUC_SUM,-1000000000)) AS  PYMT_DDUC_D0010100,
		                              MAX(DECODE(PAY_ITEM_CD ,'D0110100',PYMT_DDUC_SUM,-1000000000)) AS  PYMT_DDUC_D0110100
			                        FROM 
				                        (SELECT 
				                           DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
				                           PAYR_SEIL_NUM, SYSTEMKEY, PAY_ITEM_CD ,  
				                           SUM(PYMT_DDUC_SUM) AS PYMT_DDUC_SUM 
				                        FROM PAYR0302 
				                        WHERE PAY_ITEM_CD IN ('D0010100','D0110100')
				                        GROUP BY DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
				                                 PAYR_SEIL_NUM, SYSTEMKEY, PAY_ITEM_CD) 
			                        GROUP BY DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
			                           PAYR_SEIL_NUM, SYSTEMKEY
                         )
                     ) CC, 
                     PAYR0309 DD,            
                     (
                     SELECT
                              DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                              PAYR_SEIL_NUM, SYSTEMKEY,
                              DECODE(BEFORE_PYMT_DDUC_D0010100 ,-1000000000,0,BEFORE_PYMT_DDUC_D0010100 ) AS  BEFORE_PYMT_DDUC_D0010100,
                              DECODE(BEFORE_PYMT_DDUC_D0110100 ,-1000000000,0,BEFORE_PYMT_DDUC_D0110100 ) AS  BEFORE_PYMT_DDUC_D0110100
                        FROM 
		                     (  SELECT
		                              DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
		                              PAYR_SEIL_NUM, SYSTEMKEY,
		                              MAX(DECODE(PAY_ITEM_CD ,'D0010100',PYMT_DDUC_SUM,-1000000000)) AS  BEFORE_PYMT_DDUC_D0010100,
		                              MAX(DECODE(PAY_ITEM_CD ,'D0110100',PYMT_DDUC_SUM,-1000000000)) AS  BEFORE_PYMT_DDUC_D0110100
		                         FROM 
				                        (SELECT 
				                           DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
				                           PAYR_SEIL_NUM, SYSTEMKEY, PAY_ITEM_CD ,  
				                           SUM(PYMT_DDUC_SUM) AS PYMT_DDUC_SUM 
				                         FROM PAYR0302 
				                         WHERE PAY_ITEM_CD IN ('D0010100','D0110100')
				                         GROUP BY DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
				                                 PAYR_SEIL_NUM, SYSTEMKEY, PAY_ITEM_CD
			                             ) 
		                         GROUP BY DPOB_CD, PYMT_YR_MNTH, PAY_CD, PAYR_SEIL_NUM, SYSTEMKEY
                             )
                         WHERE PYMT_YR_MNTH = TO_CHAR(ADD_MONTHS(TO_DATE(#pymtYrMnth#,'YYYYMM'),-1),'YYYYMM')
                         
                     ) EE
                     
                WHERE AA.DPOB_CD=BB.DPOB_CD 
                  AND AA.PYMT_YR_MNTH  = BB.PYMT_YR_MNTH
                  AND AA.PAY_CD  = BB.PAY_CD
                  AND AA.PAYR_SEIL_NUM  = BB.PAYR_SEIL_NUM(+) 
                  AND AA.PYMT_YR_MNTH = CC.PYMT_YR_MNTH(+)
                  AND AA.SYSTEMKEY = CC.SYSTEMKEY(+)
                  AND AA.DPOB_CD = CC.DPOB_CD(+)
                  AND AA.PAY_CD = CC.PAY_CD(+) 
                  AND AA.PAYR_SEIL_NUM  = CC.PAYR_SEIL_NUM(+)   
                  AND AA.PYMT_YR_MNTH = DD.PYMT_YR_MNTH(+)
                  AND AA.SYSTEMKEY = DD.SYSTEMKEY(+)
                  AND AA.DPOB_CD = DD.DPOB_CD(+)
                  AND AA.PAY_CD = DD.PAY_CD(+) 
                  AND AA.PAYR_SEIL_NUM  = DD.PAYR_SEIL_NUM(+) 
                                
                  AND TO_CHAR(ADD_MONTHS(TO_DATE(AA.PYMT_YR_MNTH,'YYYYMM'),-1),'YYYYMM') = EE.PYMT_YR_MNTH(+)
                  
                 <!--  AND AA.PYMT_YR_MNTH = EE.PYMT_YR_MNTH(+) -->
                  AND AA.SYSTEMKEY = EE.SYSTEMKEY(+)
                  AND AA.DPOB_CD = EE.DPOB_CD(+)
                  AND AA.PAY_CD = EE.PAY_CD(+) 
                  <!-- AND AA.PAYR_SEIL_NUM  = EE.PAYR_SEIL_NUM(+)  -->
                  
				  AND AA.PYMT_YR_MNTH  = #pymtYrMnth#
			 	   <isNotEmpty prepend="AND" property="dpobCd" >
			 	     AA.DPOB_CD=#dpobCd#
		           </isNotEmpty> 
		                AND EXISTS  (
                          SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' ))) C
                                            WHERE     C.DPOB_CD = AA.DPOB_CD
						                        AND C.DEPT_CD = AA.DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(AA.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(AA.DTIL_OCCU_INTTN_CD,'TT')
                                               <isNotEmpty property="deptCd" prepend="AND">
												<![CDATA[
												 C.DEPT_CD
												]]>
												<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
												 #deptCdArr[]#
												</iterate>
												</isNotEmpty> 
                                          ) 
				       <isNotEmpty prepend="AND" property="businCd" >
					 	AA.BUSIN_CD=#businCd#
				       </isNotEmpty> 
				       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
					 	AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
				       </isNotEmpty> 
				       <isNotEmpty prepend="AND" property="emymtDivCd" >
					 	AA.EMYMT_DIV_CD=#emymtDivCd#
					 	</isNotEmpty>
				     
				        
				       
				         
				         
 					<isNotEmpty property="typOccuCd" prepend="AND">
					<![CDATA[
					 AA.TYP_OCCU_CD
					]]>
					<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
					 #typOccuCdArr[]#
					</iterate>
					</isNotEmpty>  
				      <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 AA.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate>
					</isNotEmpty>  
					<!--   <isNotEmpty property="dtilOccuClsDivCd" prepend="AND">
					<![CDATA[
					 AA.DTIL_OCCU_CLS_DIV_CD
					]]>
					<iterate prepend="IN" property="dtilOccuClsDivCdArr" open="(" close=")" conjunction=",">
					 #dtilOccuClsDivCdArr[]#
					</iterate>
					</isNotEmpty>   -->
					 <isNotEmpty property="hdofcCodtnCd" prepend="AND">
				<![CDATA[
				 AA.HDOFC_DIV_CD
				]]>
				<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
				 #hdofcCodtnCdArr[]#
				</iterate>
				</isNotEmpty> 
				          <isNotEmpty prepend="AND" property="systemkey" >
					 	AA.SYSTEMKEY=#systemkey#
				       </isNotEmpty>  
				       <isNotEmpty prepend="AND" property="hanNm" >
					 	AA.HAN_NM LIKE '%' || #hanNm# || '%'
				       </isNotEmpty>  
					ORDER BY   AA.PYMT_YR_MNTH DESC
						    , AA.PAYR_MANG_DEPT_CD DESC
						    , AA.PAY_CD DESC 
							, AA.PAYR_SEIL_NUM DESC
							 ,(SELECT LPAD(DEPT_RANK,5,'0')  
                                   FROM BASS0400 DD
                                   WHERE DD.DEPT_CD =  AA.DEPT_CD  
                                     AND DD.DPOB_CD = AA.DPOB_CD) ASC 
						    , AA.RESN_REGN_NUM ASC
							, AA.SYSTEMKEY DESC 
		
		<![CDATA[					
	) A 
]]>
    </select>
	
	
    <select id="insr3200DAO.selectInsrP420001ToInsr3200ListTotCnt_S"  parameterClass="insr3200SerarchVO" resultClass="int">
        SELECT COUNT(*) totcnt
        FROM  (
			 SELECT
                         AA.DPOB_CD
                        , AA.PYMT_YR_MNTH
                        , AA.SYSTEMKEY 
                        , AA.EMYMT_DIV_CD                               
                        , fcBass0300CDNM(AA.DPOB_CD,AA.EMYMT_DIV_CD) AS EMYMT_DIV_NM
                        , AA.HAN_NM
                        , AA.RESN_REGN_NUM
                        , AA.DEPT_CD AS DEPT_CD
                        , fcBass0400CDNM(AA.DPOB_CD,AA.DEPT_CD,'2') AS DEPT_NM 
                        , NVL(CC.PYMT_DDUC_D0010100,0) AS HLTH_INSR_MNTH_AMNT 
                        , NVL(EE.BEFORE_PYMT_DDUC_D0010100,0) AS BEFORE_HLTH_INSR_MNTH_AMNT 
                        
                        
						, NVL(CC.PYMT_DDUC_D0110100,0) AS HLTH_RCPTN_MNTH_AMNT 
                        , NVL(EE.BEFORE_PYMT_DDUC_D0110100,0) AS BEFORE_HLTH_RCPTN_MNTH_AMNT 
                        
                        , DD.HLTH_INSR_MNTH_RUNTN_AMNT
                        , DD.NAT_PENN_GRDE
                FROM PAYR0304 AA, PAYR0300 BB,  
                     (
                     SELECT
                              DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                              PAYR_SEIL_NUM, SYSTEMKEY,
                              DECODE(PYMT_DDUC_D0010100 ,-1000000000,0,PYMT_DDUC_D0010100 ) AS  PYMT_DDUC_D0010100,
                              DECODE(PYMT_DDUC_D0110100 ,-1000000000,0,PYMT_DDUC_D0110100 ) AS  PYMT_DDUC_D0110100
                        FROM 
		                        (   SELECT
		                              DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
		                              PAYR_SEIL_NUM, SYSTEMKEY,
		                              MAX(DECODE(PAY_ITEM_CD ,'D0010100',PYMT_DDUC_SUM,-1000000000)) AS  PYMT_DDUC_D0010100,
		                              MAX(DECODE(PAY_ITEM_CD ,'D0110100',PYMT_DDUC_SUM,-1000000000)) AS  PYMT_DDUC_D0110100
			                        FROM 
				                        (SELECT 
				                           DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
				                           PAYR_SEIL_NUM, SYSTEMKEY, PAY_ITEM_CD ,  
				                           SUM(PYMT_DDUC_SUM) AS PYMT_DDUC_SUM 
				                        FROM PAYR0302 
				                        WHERE PAY_ITEM_CD IN ('D0010100','D0110100')
				                        GROUP BY DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
				                                 PAYR_SEIL_NUM, SYSTEMKEY, PAY_ITEM_CD) 
			                        GROUP BY DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
			                           PAYR_SEIL_NUM, SYSTEMKEY
                         )
                     ) CC, 
                     PAYR0309 DD,            
                     (
                     SELECT
                              DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
                              PAYR_SEIL_NUM, SYSTEMKEY,
                              DECODE(BEFORE_PYMT_DDUC_D0010100 ,-1000000000,0,BEFORE_PYMT_DDUC_D0010100 ) AS  BEFORE_PYMT_DDUC_D0010100,
                              DECODE(BEFORE_PYMT_DDUC_D0110100 ,-1000000000,0,BEFORE_PYMT_DDUC_D0110100 ) AS  BEFORE_PYMT_DDUC_D0110100
                        FROM 
		                     (  SELECT
		                              DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
		                              PAYR_SEIL_NUM, SYSTEMKEY,
		                              MAX(DECODE(PAY_ITEM_CD ,'D0010100',PYMT_DDUC_SUM,-1000000000)) AS  BEFORE_PYMT_DDUC_D0010100,
		                              MAX(DECODE(PAY_ITEM_CD ,'D0110100',PYMT_DDUC_SUM,-1000000000)) AS  BEFORE_PYMT_DDUC_D0110100
		                         FROM 
				                        (SELECT 
				                           DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
				                           PAYR_SEIL_NUM, SYSTEMKEY, PAY_ITEM_CD ,  
				                           SUM(PYMT_DDUC_SUM) AS PYMT_DDUC_SUM 
				                         FROM PAYR0302 
				                         WHERE PAY_ITEM_CD IN ('D0010100','D0110100')
				                         GROUP BY DPOB_CD, PYMT_YR_MNTH, PAY_CD, 
				                                 PAYR_SEIL_NUM, SYSTEMKEY, PAY_ITEM_CD
			                             ) 
		                         GROUP BY DPOB_CD, PYMT_YR_MNTH, PAY_CD, PAYR_SEIL_NUM, SYSTEMKEY
                             )
                        WHERE PYMT_YR_MNTH = TO_CHAR(ADD_MONTHS(TO_DATE(#pymtYrMnth#,'YYYYMM'),-1),'YYYYMM')
                         
                     ) EE
                     
                WHERE AA.DPOB_CD=BB.DPOB_CD 
                  AND AA.PYMT_YR_MNTH  = BB.PYMT_YR_MNTH
                  AND AA.PAY_CD  = BB.PAY_CD
                  AND AA.PAYR_SEIL_NUM  = BB.PAYR_SEIL_NUM(+) 
                  AND AA.PYMT_YR_MNTH = CC.PYMT_YR_MNTH(+)
                  AND AA.SYSTEMKEY = CC.SYSTEMKEY(+)
                  AND AA.DPOB_CD = CC.DPOB_CD(+)
                  AND AA.PAY_CD = CC.PAY_CD(+) 
                  AND AA.PAYR_SEIL_NUM  = CC.PAYR_SEIL_NUM(+)   
                  AND AA.PYMT_YR_MNTH = DD.PYMT_YR_MNTH(+)
                  AND AA.SYSTEMKEY = DD.SYSTEMKEY(+)
                  AND AA.DPOB_CD = DD.DPOB_CD(+)
                  AND AA.PAY_CD = DD.PAY_CD(+) 
                  AND AA.PAYR_SEIL_NUM  = DD.PAYR_SEIL_NUM(+) 
                  
                  AND AA.PYMT_YR_MNTH = EE.PYMT_YR_MNTH(+)
                  AND AA.SYSTEMKEY = EE.SYSTEMKEY(+)
                  AND AA.DPOB_CD = EE.DPOB_CD(+)
                  AND AA.PAY_CD = EE.PAY_CD(+) 
                  AND AA.PAYR_SEIL_NUM  = EE.PAYR_SEIL_NUM(+) 
                  
				  AND AA.PYMT_YR_MNTH  = #pymtYrMnth#
			 	   <isNotEmpty prepend="AND" property="dpobCd" >
			 	     AA.DPOB_CD=#dpobCd#
		           </isNotEmpty> 
<!-- 		                AND EXISTS  (
                          SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' )) ) C
                                            WHERE     C.DPOB_CD = AA.DPOB_CD
						                        AND C.DEPT_CD = AA.DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(AA.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(AA.DTIL_OCCU_INTTN_CD,'TT')
                                               <isNotEmpty property="deptCd" prepend="AND">
												<![CDATA[
												 C.DEPT_CD
												]]>
												<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
												 #deptCdArr[]#
												</iterate>
												</isNotEmpty> 
                                          )  -->
				       <isNotEmpty prepend="AND" property="businCd" >
					 	AA.BUSIN_CD=#businCd#
				       </isNotEmpty> 
				       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
					 	AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
				       </isNotEmpty> 
				       <isNotEmpty prepend="AND" property="emymtDivCd" >
					 	AA.EMYMT_DIV_CD=#emymtDivCd#
					 	</isNotEmpty>
				      
				        
				       
				         
				         
 					<isNotEmpty property="typOccuCd" prepend="AND">
					<![CDATA[
					 AA.TYP_OCCU_CD
					]]>
					<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
					 #typOccuCdArr[]#
					</iterate>
					</isNotEmpty>  
				      <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 AA.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate>
					</isNotEmpty>  
					<!--   <isNotEmpty property="dtilOccuClsDivCd" prepend="AND">
					<![CDATA[
					 AA.DTIL_OCCU_CLS_DIV_CD
					]]>
					<iterate prepend="IN" property="dtilOccuClsDivCdArr" open="(" close=")" conjunction=",">
					 #dtilOccuClsDivCdArr[]#
					</iterate>
					</isNotEmpty>   -->
					 <isNotEmpty property="hdofcCodtnCd" prepend="AND">
				<![CDATA[
				 AA.HDOFC_DIV_CD
				]]>
				<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
				 #hdofcCodtnCdArr[]#
				</iterate>
				</isNotEmpty> 
				          <isNotEmpty prepend="AND" property="systemkey" >
					 	AA.SYSTEMKEY=#systemkey#
				       </isNotEmpty>  
				       <isNotEmpty prepend="AND" property="hanNm" >
					 	AA.HAN_NM LIKE '%' || #hanNm# || '%'
				       </isNotEmpty>  
					ORDER BY   AA.PYMT_YR_MNTH DESC
						    , AA.PAYR_MANG_DEPT_CD DESC
						    , AA.PAY_CD DESC 
							, AA.PAYR_SEIL_NUM DESC
							 ,(SELECT LPAD(DEPT_RANK,5,'0')  
                                   FROM BASS0400 DD
                                   WHERE DD.DEPT_CD =  AA.DEPT_CD  
                                     AND DD.DPOB_CD = AA.DPOB_CD) ASC 
						    , AA.RESN_REGN_NUM ASC
							, AA.SYSTEMKEY DESC 
			
			)
    </select>

		<!-- Insr4200 건강보험 등록자인지 확인  -->
	<select id="insr3200DAO.selectInsr3000RegChkCnt" parameterClass="insr3200VO" resultClass="int">
			
			SELECT COUNT(*) totcnt
			FROM   INSR3000
			WHERE  1=1
			AND    SYSTEMKEY = (
				      SELECT SYSTEMKEY
				      FROM   PSNL0100
				      WHERE  1=1 
				      AND    RESN_REGN_NUM = REPLACE(#resnRegnNum#, '-', '')
				     <!--  AND    HDOFC_CODTN_CD IN( 'A0030010' ) --> <!-- 재직자 체크 -->
				      AND    ROWNUM = 1 
			)
			    	
	</select>



</sqlMap>
