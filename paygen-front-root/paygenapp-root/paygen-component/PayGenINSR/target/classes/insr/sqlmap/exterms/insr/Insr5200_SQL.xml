<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="Insr5200">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="insr5200SerarchVO" type="com.app.exterms.insurance.server.vo.Insr5200SrhVO"/>
	<typeAlias  alias="insr5200" type="com.app.exterms.insurance.server.vo.Insr5200VO"/>
	
	<resultMap id="insr5200" class="com.app.exterms.insurance.server.vo.Insr5200VO">
		<result property="dpobCd" column="DPOB_CD" columnIndex="1"/>
		<result property="systemkey" column="SYSTEMKEY" columnIndex="2"/>
		<result property="dducYrMnth" column="DDUC_YR_MNTH" columnIndex="3"/>
		<result property="emymtSeilNum" column="EMYMT_SEIL_NUM" columnIndex="4"/>
		<result property="iposYrMnth" column="IPOS_YR_MNTH" columnIndex="5"/>
		<result property="hanNm" column="HAN_NM" columnIndex="6"/>
		<result property="resnRegnNum" column="RESN_REGN_NUM" columnIndex="7"/>
		<result property="umytInsrBgnnDt" column="UMYT_INSR_BGNN_DT" columnIndex="8"/>
		<result property="umytInsrEndDt" column="UMYT_INSR_END_DT" columnIndex="9"/>
		<result property="mnthAvgPayMnthAmnt" column="MNTH_AVG_PAY_MNTH_AMNT" columnIndex="10"/>
		<result property="cmpttnWkppUneplrtSum" column="CMPTTN_WKPP_UNEPLRT_SUM" columnIndex="11"/>
		<result property="cmpttnEplrUneplrtSum" column="CMPTTN_EPLR_UNEPLRT_SUM" columnIndex="12"/>
		<result property="cmpttnEplrFncdsnInsurSum" column="CMPTTN_EPLR_FNCDSN_INSUR_SUM" columnIndex="13"/>
		<result property="recpttnWkppUneplrtSum" column="RECPTTN_WKPP_UNEPLRT_SUM" columnIndex="14"/>
		<result property="recpttnEplrUneplrtSum" column="RECPTTN_EPLR_UNEPLRT_SUM" columnIndex="15"/>
		<result property="recpttnEplrFncdsnSum" column="RECPTTN_EPLR_FNCDSN_SUM" columnIndex="16"/>
		<result property="clutPayTotAmnt" column="CLUT_PAY_TOT_AMNT" columnIndex="17"/>
		<result property="clutWkppUneplrtSum" column="CLUT_WKPP_UNEPLRT_SUM" columnIndex="18"/>
		<result property="clutEplrUneplrtSum" column="CLUT_EPLR_UNEPLRT_SUM" columnIndex="19"/>
		<result property="clutEplrFncdsnSum" column="CLUT_EPLR_FNCDSN_SUM" columnIndex="20"/>
		<result property="umytInsrApmrt" column="UMYT_INSR_APMRT" columnIndex="21"/>
		<result property="payCalcEmymtInsurSum" column="PAY_CALC_EMYMT_INSUR_SUM" columnIndex="22"/>
		<result property="indvUneplrtPymtAggrSum" column="INDV_UNEPLRT_PYMT_AGGR_SUM" columnIndex="23"/>
		<result property="eplrUneplrtPymtAggrSum" column="EPLR_UNEPLRT_PYMT_AGGR_SUM" columnIndex="24"/>
		<result property="eplrFncdsnAggrSum" column="EPLR_FNCDSN_AGGR_SUM" columnIndex="25"/>
		<result property="umytPayrDducYrMnth" column="UMYT_PAYR_DDUC_YR_MNTH" columnIndex="26"/>
		<result property="umytInsrPrcsDt" column="UMYT_INSR_PRCS_DT" columnIndex="27"/>
		<result property="umytInsrPrcsYn" column="UMYT_INSR_PRCS_YN" columnIndex="28"/>
		<result property="umytInsrPrmmSrd" column="UMYT_INSR_PRMM_SRD" columnIndex="29"/>
		<result property="divdPymtDivCd" column="DIVD_PYMT_DIV_CD" columnIndex="30"/>
		<result property="divdPymt" column="DIVD_PYMT" columnIndex="31"/>
		<result property="kybdr" column="KYBDR" columnIndex="32"/>
		<result property="inptDt" column="INPT_DT" columnIndex="33"/>
		<result property="inptAddr" column="INPT_ADDR" columnIndex="34"/>
		<result property="ismt" column="ISMT" columnIndex="35"/>
		<result property="revnDt" column="REVN_DT" columnIndex="36"/>
		<result property="revnAddr" column="REVN_ADDR" columnIndex="37"/>
	</resultMap>
	
	<insert id="insr5200DAO.insertInsr5200_S">
		<![CDATA[
			INSERT INTO INSR5200 
				( 	DPOB_CD
					,SYSTEMKEY
					,DDUC_YR_MNTH
					,EMYMT_SEIL_NUM
					,IPOS_YR_MNTH
					,HAN_NM
					,RESN_REGN_NUM
					,UMYT_INSR_BGNN_DT
					,UMYT_INSR_END_DT
					,MNTH_AVG_PAY_MNTH_AMNT
					,CMPTTN_WKPP_UNEPLRT_SUM
					,CMPTTN_EPLR_UNEPLRT_SUM
					,CMPTTN_EPLR_FNCDSN_INSUR_SUM
					,RECPTTN_WKPP_UNEPLRT_SUM
					,RECPTTN_EPLR_UNEPLRT_SUM
					,RECPTTN_EPLR_FNCDSN_SUM
					,CLUT_PAY_TOT_AMNT
					,CLUT_WKPP_UNEPLRT_SUM
					,CLUT_EPLR_UNEPLRT_SUM
					,CLUT_EPLR_FNCDSN_SUM
					,UMYT_INSR_APMRT
					,PAY_CALC_EMYMT_INSUR_SUM
					,INDV_UNEPLRT_PYMT_AGGR_SUM
					,EPLR_UNEPLRT_PYMT_AGGR_SUM
					,EPLR_FNCDSN_AGGR_SUM
					,UMYT_PAYR_DDUC_YR_MNTH
					,UMYT_INSR_PRCS_DT
					,UMYT_INSR_PRCS_YN
					,UMYT_INSR_PRMM_SRD
					,DIVD_PYMT_DIV_CD
					,DIVD_PYMT
					,KYBDR
					,INPT_DT
					,INPT_ADDR
					,ISMT
					,REVN_DT
					,REVN_ADDR )
			VALUES ( #dpobCd#
					, (
					  SELECT SYSTEMKEY 
						FROM  PSNL0100 
						WHERE DPOB_CD = #dpobCd#
						AND  RESN_REGN_NUM = REPLACE(#resnRegnNum#,'-','') 
					)
					, #dducYrMnth#
				    , (SELECT	MAX(EMYMT_SEIL_NUM) AS EMYMT_SEIL_NUM
					 FROM	PSNL0110
					 WHERE	DPOB_CD	  = #dpobCd#
					 AND	SYSTEMKEY = (
								 SELECT SYSTEMKEY 
								 FROM PSNL0100 
								 WHERE DPOB_CD	   = #dpobCd#
								 AND RESN_REGN_NUM = REPLACE(#resnRegnNum#, '-', '')
							 )
					)
					, #iposYrMnth#
					, #hanNm#
					, #resnRegnNum#
					, REPLACE(#umytInsrBgnnDt#, '-', '')
					, REPLACE(#umytInsrEndDt#, '-', '') 
					, #mnthAvgPayMnthAmnt#
					, #cmpttnWkppUneplrtSum#
					, #cmpttnEplrUneplrtSum#
					, #cmpttnEplrFncdsnInsurSum#
					, #recpttnWkppUneplrtSum#
					, #recpttnEplrUneplrtSum#
					, #recpttnEplrFncdsnSum#
					, #clutPayTotAmnt#
					, #clutWkppUneplrtSum#
					, #clutEplrUneplrtSum#
					, #clutEplrFncdsnSum#
					, #umytInsrApmrt#
					, ( SELECT	NVL (SUM (PYMT_DDUC_SUM), 0) 
						    FROM 	PAYR0302 A01 
							WHERE 	SYSTEMKEY = ( SELECT	SYSTEMKEY FROM PSNL0100 WHERE  DPOB_CD=#dpobCd# AND RESN_REGN_NUM = Replace(#resnRegnNum#,'-','') AND ROWNUM = 1 )
							AND 	PAY_CD='B0150000' 
							AND 	PAY_ITEM_CD IN ('D0160100','D0160200','D0160300','D9501600')
							AND		PYMT_YR_MNTH = #dducYrMnth# 
							AND  EXISTS(
				                  SELECT *
				                  FROM   PAYR0301  BBB
				                  WHERE  BBB.PAY_CD = A01.PAY_CD
				                  AND    BBB.PYMT_YR_MNTH = A01.PYMT_YR_MNTH
				                  AND    BBB.PAYR_SEIL_NUM = A01.PAYR_SEIL_NUM
				                  AND    BBB.SYSTEMKEY = A01.SYSTEMKEY
				                  AND    BBB.PAY_DDLNE_YN = 'Y'
				            )   
					)
					, #indvUneplrtPymtAggrSum#
					, #eplrUneplrtPymtAggrSum#
					, #eplrFncdsnAggrSum#
					, #dducYrMnth#
					, TO_CHAR(SYSDATE,'YYYYMMDD')
					, #umytInsrPrcsYn#
					, ( SELECT	CASE WHEN NVL(#indvUneplrtPymtAggrSum#,0) - NVL (SUM (PYMT_DDUC_SUM), 0) < 0 THEN 0
					                 ELSE   NVL(#indvUneplrtPymtAggrSum#,0) - NVL (SUM (PYMT_DDUC_SUM), 0) END  
						    FROM 	PAYR0302 A01 
							WHERE 	SYSTEMKEY = ( SELECT	SYSTEMKEY FROM PSNL0100 WHERE  DPOB_CD=#dpobCd# AND RESN_REGN_NUM = Replace(#resnRegnNum#,'-','') AND ROWNUM = 1 )
							AND 	PAY_CD='B0150000' 
							AND 	PAY_ITEM_CD IN ('D0160100','D0160200','D0160300','D9501600')
							AND		PYMT_YR_MNTH = #dducYrMnth# 
							AND  EXISTS(
				                  SELECT *
				                  FROM   PAYR0301  BBB
				                  WHERE  BBB.PAY_CD = A01.PAY_CD
				                  AND    BBB.PYMT_YR_MNTH = A01.PYMT_YR_MNTH
				                  AND    BBB.PAYR_SEIL_NUM = A01.PAYR_SEIL_NUM
				                  AND    BBB.SYSTEMKEY = A01.SYSTEMKEY
				                  AND    BBB.PAY_DDLNE_YN = 'Y'
				                  )
				       )
				    , #divdPymtDivCd#
					, #divdPymt#
					, #kybdr#
					, TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
					, #inptAddr#
					, #ismt#
					, TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
					, #revnAddr#)
		]]>
	</insert>
	
	<update id="insr5200DAO.updateInsr5200_S">
		<![CDATA[
			UPDATE INSR5200
			SET DPOB_CD=#dpobCd#
				, SYSTEMKEY=#systemkey#
				, EMYMT_SEIL_NUM=#emymtSeilNum#
				, DDUC_YR_MNTH=#dducYrMnth#
				, HAN_NM=#hanNm#
				, RESN_REGN_NUM=#resnRegnNum#
				, PAY_MNTH_AMNT=#payMnthAmnt#
				, UMYT_INSR_APMRT=#umytInsrApmrt#
				, INDV_PYMT_SUM=#indvPymtSum#
				, DPOB_BRDN_SUM=#dpobBrdnSum#
				, PYMT_SUM=#pymtSum#
				, KYBDR=#kybdr#
				, INPT_DT=#inptDt#
				, INPT_ADDR=#inptAddr#
				, ISMT=#ismt#
				, REVN_DT=#revnDt#
				, REVN_ADDR=#revnAddr#
						WHERE DPOB_CD=#dpobCd#
								AND SYSTEMKEY=#systemkey#
								AND EMYMT_SEIL_NUM=#emymtSeilNum#
								AND DDUC_YR_MNTH=#dducYrMnth#
				]]>
	</update>
	
	<delete id="insr5200DAO.deleteInsr5200_S">
		<![CDATA[
			DELETE FROM INSR5200 
						WHERE DPOB_CD=#dpobCd#
						AND SYSTEMKEY = (SELECT SYSTEMKEY 
									FROM   PSNL0100 
									WHERE  DPOB_CD		 = #dpobCd#
									AND	   RESN_REGN_NUM = REPLACE(#resnRegnNum#, '-', '') 
									AND    ROWNUM = 1
						)
						AND DDUC_YR_MNTH=#dducYrMnth#
				]]>
	</delete>
	
	<select id="insr5200DAO.selectInsr5200_S" resultMap="insr5200">
			SELECT * FROM (
				SELECT A.*, ROWNUM RNUM FROM (
							 SELECT  II.DDUC_YR_MNTH
							        ,II.DEPT_NM
							        ,II.HAN_NM
							        ,II.RESN_REGN_NUM
							        ,II.UMYT_PAYR_DDUC_YR_MNTH
							        ,II.UMYT_INSR_PRCS_YN
							        ,II.MNTH_AVG_PAY_MNTH_AMNT
							        ,II.PAY_CALC_EMYMT_INSUR_SUM
							        ,II.INDV_UNEPLRT_PYMT_AGGR_SUM
							       ,( II.INDV_UNEPLRT_PYMT_AGGR_SUM - II.PAY_CALC_EMYMT_INSUR_SUM ) AS UMYT_INSR_PRMM_SRD
								FROM 
								( 
									  AA.DDUC_YR_MNTH ,
							          fcBass0400CDNM(BB.DPOB_CD,BB.CURR_AFFN_DEPT_CD,'2') AS DEPT_NM ,
							          AA.HAN_NM ,
							          AA.RESN_REGN_NUM ,
							          AA.UMYT_PAYR_DDUC_YR_MNTH ,
							          AA.UMYT_INSR_PRCS_YN ,
							          NVL(AA.MNTH_AVG_PAY_MNTH_AMNT,0) AS MNTH_AVG_PAY_MNTH_AMNT,
							          	<![CDATA[
							          ( CASE WHEN NVL(AA.PAY_CALC_EMYMT_INSUR_SUM,0) <= 0 THEN 0  ELSE NVL(AA.PAY_CALC_EMYMT_INSUR_SUM,0)  END ) AS PAY_CALC_EMYMT_INSUR_SUM ,
							          ( CASE WHEN NVL(AA.INDV_UNEPLRT_PYMT_AGGR_SUM,0) <= 0 THEN 0  ELSE NVL(AA.INDV_UNEPLRT_PYMT_AGGR_SUM,0)  END ) AS INDV_UNEPLRT_PYMT_AGGR_SUM ,
							          ]]>
							          AA.DPOB_CD ,
							          AA.SYSTEMKEY ,
							          AA.EMYMT_SEIL_NUM ,
							          BB.EMYMT_DIV_CD ,
							          fcBass0300CDNM(BB.DPOB_CD,BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM ,
							          BB.CURR_AFFN_DEPT_CD                       AS DEPT_CD ,
							          BB.TYP_OCCU_CD ,
							          fcBass0320CDNM(BB.DPOB_CD,BB.TYP_OCCU_CD) AS TYP_OCCU_NM ,
							          BB.PYSP_GRDE_CD ,
							          BB.BUSIN_CD,
							          fcBass0500CDNM(BB.DPOB_CD,SUBSTR(BB.EMYMT_BGNN_DT,1,4),BB.CURR_AFFN_DEPT_CD,BB.BUSIN_CD) AS BUSIN_NM,
							          BB.HDOFC_CODTN_CD,
							          GG.PAYR_MANG_DEPT_CD
								FROM  INSR5200 AA , PSNL0100 BB,BASS0400 GG
									WHERE	CC.DPOB_CD	 = DD.DPOB_CD
									AND		CC.DPOB_CD	 = FF.DPOB_CD(+)
									AND		CC.SYSTEMKEY = FF.SYSTEMKEY(+)
								   ) EE
								   WHERE   AA.DPOB_CD			= BB.DPOB_CD
								   AND	   AA.SYSTEMKEY			= BB.SYSTEMKEY
								   AND	   BB.DPOB_CD			= GG.DPOB_CD
								   AND	   BB.CURR_AFFN_DEPT_CD = GG.DEPT_CD
								  ) II
								  WHERE 1=1
								  <isNotEmpty prepend="AND" property="dpobCd" >
						 	     II.DPOB_CD=#dpobCd#
					           </isNotEmpty> 
					                AND EXISTS  (
			                         SELECT  C.DPOB_CD,
			                                 C.DTIL_OCCU_INTTN_CD,
			                                 C.TYP_OCCU_CD,
			                                 C.DEPT_CD FROM 
			                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' )) ) C
			                                            WHERE     C.DPOB_CD = II.DPOB_CD
									                        AND C.DEPT_CD = II.DEPT_CD
									                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(II.TYP_OCCU_CD,'TT') 
			                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(II.DTIL_OCCU_INTTN_CD,'TT')
			                                               <isNotEmpty property="deptCd" prepend="AND">
															<![CDATA[
															 C.DEPT_CD
															]]>
															<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
															 #deptCdArr[]#
															</iterate>
															</isNotEmpty> 
							 
			                                          ) 
							       <isNotEmpty prepend="AND" property="businCd" >
								 	II.BUSIN_CD=#businCd#
							       </isNotEmpty> 
							       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
								 	II.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
							       </isNotEmpty> 
							       <isNotEmpty prepend="AND" property="emymtDivCd" >
								 	II.EMYMT_DIV_CD=#emymtDivCd#
								 	</isNotEmpty> 
							         <isNotEmpty prepend="AND" property="dducYrMnth" >
								 	II.DDUC_YR_MNTH = #dducYrMnth#
							       </isNotEmpty>  
			 					<isNotEmpty property="typOccuCd" prepend="AND">
								<![CDATA[
								 II.TYP_OCCU_CD
								]]>
								<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
								 #typOccuCdArr[]#
								</iterate>
								</isNotEmpty>  
							   <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
									<![CDATA[
										 II.DTIL_OCCU_INTTN_CD
									]]>
									<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
										 #dtilOccuInttnCdArr[]#
									</iterate>
								</isNotEmpty>  
								<!--   <isNotEmpty property="dtilOccuClsDivCd" prepend="AND">
								<![CDATA[
								 II.DTIL_OCCU_CLS_DIV_CD
								]]>
								<iterate prepend="IN" property="dtilOccuClsDivCdArr" open="(" close=")" conjunction=",">
								 #dtilOccuClsDivCdArr[]#
								</iterate>
								</isNotEmpty>   -->
								 <isNotEmpty property="hdofcCodtnCd" prepend="AND">
							<![CDATA[
							 II.HDOFC_CODTN_CD
							]]>
							<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
							 #hdofcCodtnCdArr[]#
							</iterate>
							</isNotEmpty>
							 
							          <isNotEmpty prepend="AND" property="systemkey" >
								 	II.SYSTEMKEY=#systemkey#
							       </isNotEmpty>  
							       <isNotEmpty prepend="AND" property="hanNm" >
								 	II.HAN_NM LIKE '%' || #hanNm# || '%'
							       </isNotEmpty>  
								ORDER BY   II.NOFCT_YR_MNTH DESC
									    , II.PAYR_MANG_DEPT_CD DESC
										 ,(SELECT LPAD(DEPT_RANK,5,'0')  
			                                   FROM BASS0400 DD
			                                   WHERE DD.DEPT_CD =  II.DEPT_CD  
			                                     AND DD.DPOB_CD = II.DPOB_CD) ASC 
									    , II.RESN_REGN_NUM ASC
										, II.SYSTEMKEY DESC 				 
					
					<![CDATA[					
				) A WHERE ROWNUM <= #lastIndex#
			)WHERE RNUM >= #firstIndex#
			]]>
	</select>	
	
	<select id="insr5200DAO.selectInsr5200List_D" parameterClass="insr5200SerarchVO" resultClass="egovMap">
			SELECT * FROM (
				SELECT A.*, ROWNUM RNUM FROM (
							 SELECT  II.DDUC_YR_MNTH
							        ,II.DEPT_NM
							        ,II.HAN_NM
							        ,II.RESN_REGN_NUM
							        ,II.UMYT_PAYR_DDUC_YR_MNTH
							        ,NVL(II.UMYT_INSR_PRCS_YN, 'N') AS UMYT_INSR_PRCS_YN
							        ,II.MNTH_AVG_PAY_MNTH_AMNT
							        ,II.PAY_CALC_EMYMT_INSUR_SUM
							        ,II.INDV_UNEPLRT_PYMT_AGGR_SUM
							        ,( II.INDV_UNEPLRT_PYMT_AGGR_SUM - II.PAY_CALC_EMYMT_INSUR_SUM ) AS UMYT_INSR_PRMM_SRD
							        ,II.SYSTEMKEY
							        ,II.DPOB_CD
        							,II.EMYMT_SEIL_NUM
								FROM 
								( SELECT
									  AA.DDUC_YR_MNTH ,
							          fcBass0400CDNM(BB.DPOB_CD,BB.CURR_AFFN_DEPT_CD,'2') AS DEPT_NM ,
							          AA.HAN_NM ,
							          AA.RESN_REGN_NUM ,
							          AA.UMYT_PAYR_DDUC_YR_MNTH ,
							          AA.UMYT_INSR_PRCS_YN ,
							          NVL(AA.MNTH_AVG_PAY_MNTH_AMNT,0) AS MNTH_AVG_PAY_MNTH_AMNT,
							          	<![CDATA[
							          ( CASE WHEN NVL(AA.PAY_CALC_EMYMT_INSUR_SUM,0) <= 0 THEN 0  ELSE NVL(AA.PAY_CALC_EMYMT_INSUR_SUM,0)  END ) AS PAY_CALC_EMYMT_INSUR_SUM ,
							          ( CASE WHEN NVL(AA.INDV_UNEPLRT_PYMT_AGGR_SUM,0) <= 0 THEN 0  ELSE NVL(AA.INDV_UNEPLRT_PYMT_AGGR_SUM,0)  END ) AS INDV_UNEPLRT_PYMT_AGGR_SUM ,
							          ]]>
							          AA.DPOB_CD ,
							          AA.SYSTEMKEY ,
							          AA.EMYMT_SEIL_NUM ,
							          BB.DEPT_CD AS MAN_DEPT_CD,
							          BB.REPBTY_BUSIN_DIV_CD,
							          BB.EMYMT_DIV_CD ,
							          fcBass0300CDNM(BB.DPOB_CD,BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM ,
							          BB.CURR_AFFN_DEPT_CD                       AS DEPT_CD ,
							          BB.TYP_OCCU_CD ,
							          fcBass0320CDNM(BB.DPOB_CD,BB.TYP_OCCU_CD) AS TYP_OCCU_NM ,
							          BB.PYSP_GRDE_CD ,
							          BB.BUSIN_CD,
							          fcBass0500CDNM(BB.DPOB_CD,SUBSTR(BB.EMYMT_BGNN_DT,1,4),BB.CURR_AFFN_DEPT_CD,BB.BUSIN_CD) AS BUSIN_NM,
							          BB.HDOFC_CODTN_CD,
							          BB.CURR_AFFN_DEPT_CD,
        							  BB.DTIL_OCCU_INTTN_CD,
        							  GG.PAYR_MANG_DEPT_CD
								FROM  INSR5200 AA , PSNL0100 BB,BASS0400 GG
								   WHERE   AA.DPOB_CD			= BB.DPOB_CD
								   AND	   AA.SYSTEMKEY			= BB.SYSTEMKEY
								   AND	   BB.DPOB_CD			= GG.DPOB_CD
								   AND	   BB.CURR_AFFN_DEPT_CD = GG.DEPT_CD
								  ) II
								  WHERE 1=1
								  <isNotEmpty prepend="AND" property="dpobCd" >
						 	     II.DPOB_CD=#dpobCd#
					           </isNotEmpty> 
					           <isNotEmpty prepend="AND" property="mangeDeptCd" >
						         II.MAN_DEPT_CD=#mangeDeptCd#
						        </isNotEmpty>      
						        <isNotEmpty prepend="AND" property="repbtyBusinDivCd" >
						         II.REPBTY_BUSIN_DIV_CD=#repbtyBusinDivCd#
						        </isNotEmpty>
					                AND EXISTS  (
			                         SELECT  C.DPOB_CD,
			                                 C.DTIL_OCCU_INTTN_CD,
			                                 C.TYP_OCCU_CD,
			                                 C.DEPT_CD FROM 
			                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' ))) C
			                                            WHERE     C.DPOB_CD = II.DPOB_CD
									                        AND C.DEPT_CD = II.DEPT_CD
									                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(II.TYP_OCCU_CD,'TT') 
			                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(II.DTIL_OCCU_INTTN_CD,'TT')
			                                               <isNotEmpty property="deptCd" prepend="AND">
															<![CDATA[
															 C.DEPT_CD
															]]>
															<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
															 #deptCdArr[]#
															</iterate>
															</isNotEmpty> 
							 
			                                          ) 
							       <isNotEmpty prepend="AND" property="businCd" >
								 	II.BUSIN_CD=#businCd#
							       </isNotEmpty> 
							       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
								 	II.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
							       </isNotEmpty> 
							       <isNotEmpty prepend="AND" property="emymtDivCd" >
								 	II.EMYMT_DIV_CD=#emymtDivCd#
								 	</isNotEmpty> 
							         <isNotEmpty prepend="AND" property="dducYrMnth" >
								 	II.DDUC_YR_MNTH = #dducYrMnth#
							       </isNotEmpty>  
			 					<isNotEmpty property="typOccuCd" prepend="AND">
								<![CDATA[
								 II.TYP_OCCU_CD
								]]>
								<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
								 #typOccuCdArr[]#
								</iterate>
								</isNotEmpty>  
							   <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
									<![CDATA[
										 II.DTIL_OCCU_INTTN_CD
									]]>
									<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
										 #dtilOccuInttnCdArr[]#
									</iterate>
								</isNotEmpty>  
								<!--   <isNotEmpty property="dtilOccuClsDivCd" prepend="AND">
								<![CDATA[
								 II.DTIL_OCCU_CLS_DIV_CD
								]]>
								<iterate prepend="IN" property="dtilOccuClsDivCdArr" open="(" close=")" conjunction=",">
								 #dtilOccuClsDivCdArr[]#
								</iterate>
								</isNotEmpty>   -->
								 <isNotEmpty property="hdofcCodtnCd" prepend="AND">
							<![CDATA[
							 II.HDOFC_CODTN_CD
							]]>
							<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
							 #hdofcCodtnCdArr[]#
							</iterate>
							</isNotEmpty>
							 
							          <isNotEmpty prepend="AND" property="systemkey" >
								 	II.SYSTEMKEY=#systemkey#
							       </isNotEmpty>  
							       <isNotEmpty prepend="AND" property="hanNm" >
								 	II.HAN_NM LIKE '%' || #hanNm# || '%'
							       </isNotEmpty>  
								ORDER BY   II.DDUC_YR_MNTH DESC 
    									   ,II.CURR_AFFN_DEPT_CD DESC 
										 ,(SELECT LPAD(DEPT_RANK,5,'0')  
			                                   FROM BASS0400 DD
			                                   WHERE DD.DEPT_CD =  II.DEPT_CD  
			                                     AND DD.DPOB_CD = II.DPOB_CD) ASC 
									    , II.RESN_REGN_NUM ASC
										, II.SYSTEMKEY DESC 				 
					
					<![CDATA[					
				) A WHERE ROWNUM <= #lastIndex#
			)WHERE RNUM >= #firstIndex#
			]]>

	</select>
	
<select id="insr5200DAO.selectXlsInsr5200List_D" parameterClass="insr5200SerarchVO" resultClass="egovMap">
           SELECT A.*, ROWNUM RNUM FROM (
							 SELECT  II.DDUC_YR_MNTH
							        ,II.DEPT_NM
							        ,II.HAN_NM
							        ,II.RESN_REGN_NUM
							        ,II.UMYT_PAYR_DDUC_YR_MNTH
							        ,NVL(II.UMYT_INSR_PRCS_YN, 'N') AS UMYT_INSR_PRCS_YN
							        ,II.MNTH_AVG_PAY_MNTH_AMNT
							        ,II.PAY_CALC_EMYMT_INSUR_SUM
							        ,II.INDV_UNEPLRT_PYMT_AGGR_SUM
							        ,( II.INDV_UNEPLRT_PYMT_AGGR_SUM - II.PAY_CALC_EMYMT_INSUR_SUM ) AS UMYT_INSR_PRMM_SRD
							        ,II.SYSTEMKEY
							        ,II.DPOB_CD
        							,II.EMYMT_SEIL_NUM
								FROM 
								( SELECT
									  AA.DDUC_YR_MNTH ,
							          fcBass0400CDNM(BB.DPOB_CD,BB.CURR_AFFN_DEPT_CD,'2') AS DEPT_NM ,
							          AA.HAN_NM ,
							          AA.RESN_REGN_NUM ,
							          AA.UMYT_PAYR_DDUC_YR_MNTH ,
							          AA.UMYT_INSR_PRCS_YN ,
							          NVL(AA.MNTH_AVG_PAY_MNTH_AMNT,0) AS MNTH_AVG_PAY_MNTH_AMNT,
							          	<![CDATA[
							          ( CASE WHEN NVL(AA.PAY_CALC_EMYMT_INSUR_SUM,0) <= 0 THEN 0  ELSE NVL(AA.PAY_CALC_EMYMT_INSUR_SUM,0)  END ) AS PAY_CALC_EMYMT_INSUR_SUM ,
							          ( CASE WHEN NVL(AA.INDV_UNEPLRT_PYMT_AGGR_SUM,0) <= 0 THEN 0  ELSE NVL(AA.INDV_UNEPLRT_PYMT_AGGR_SUM,0)  END ) AS INDV_UNEPLRT_PYMT_AGGR_SUM ,
							          ]]>
							          AA.DPOB_CD ,
							          AA.SYSTEMKEY ,
							          AA.EMYMT_SEIL_NUM ,
							          BB.DEPT_CD AS MAN_DEPT_CD, 
							          BB.REPBTY_BUSIN_DIV_CD,
							          BB.EMYMT_DIV_CD ,
							          fcBass0300CDNM(BB.DPOB_CD,BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM ,
							          BB.CURR_AFFN_DEPT_CD                       AS DEPT_CD ,
							          BB.TYP_OCCU_CD ,
							          fcBass0320CDNM(BB.DPOB_CD,BB.TYP_OCCU_CD) AS TYP_OCCU_NM ,
							          BB.PYSP_GRDE_CD ,
							          BB.BUSIN_CD,
							          fcBass0500CDNM(BB.DPOB_CD,SUBSTR(BB.EMYMT_BGNN_DT,1,4),BB.CURR_AFFN_DEPT_CD,BB.BUSIN_CD) AS BUSIN_NM,
							          BB.HDOFC_CODTN_CD,
							          BB.CURR_AFFN_DEPT_CD,
        							  BB.DTIL_OCCU_INTTN_CD,
        							  GG.PAYR_MANG_DEPT_CD
								FROM  INSR5200 AA , PSNL0100 BB,BASS0400 GG
								   WHERE   AA.DPOB_CD			= BB.DPOB_CD
								   AND	   AA.SYSTEMKEY			= BB.SYSTEMKEY
								   AND	   BB.DPOB_CD			= GG.DPOB_CD
								   AND	   BB.CURR_AFFN_DEPT_CD = GG.DEPT_CD
								  ) II
								  WHERE 1=1
								  <isNotEmpty prepend="AND" property="dpobCd" >
						 	     II.DPOB_CD=#dpobCd#
					           </isNotEmpty> 
					           <isNotEmpty prepend="AND" property="mangeDeptCd" >
						         II.MAN_DEPT_CD=#mangeDeptCd#
						        </isNotEmpty>      
						        <isNotEmpty prepend="AND" property="repbtyBusinDivCd" >
						         II.REPBTY_BUSIN_DIV_CD=#repbtyBusinDivCd#
						        </isNotEmpty> 
					                AND EXISTS  (
			                         SELECT  C.DPOB_CD,
			                                 C.DTIL_OCCU_INTTN_CD,
			                                 C.TYP_OCCU_CD,
			                                 C.DEPT_CD FROM 
			                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' ))) C
			                                            WHERE     C.DPOB_CD = II.DPOB_CD
									                        AND C.DEPT_CD = II.DEPT_CD
									                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(II.TYP_OCCU_CD,'TT') 
			                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(II.DTIL_OCCU_INTTN_CD,'TT')
			                                               <isNotEmpty property="deptCd" prepend="AND">
															<![CDATA[
															 C.DEPT_CD
															]]>
															<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
															 #deptCdArr[]#
															</iterate>
															</isNotEmpty> 
							 
			                                          ) 
							       <isNotEmpty prepend="AND" property="businCd" >
								 	II.BUSIN_CD=#businCd#
							       </isNotEmpty> 
							       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
								 	II.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
							       </isNotEmpty> 
							       <isNotEmpty prepend="AND" property="emymtDivCd" >
								 	II.EMYMT_DIV_CD=#emymtDivCd#
								 	</isNotEmpty> 
							         <isNotEmpty prepend="AND" property="dducYrMnth" >
								 	II.DDUC_YR_MNTH = #dducYrMnth#
							       </isNotEmpty>  
			 					<isNotEmpty property="typOccuCd" prepend="AND">
								<![CDATA[
								 II.TYP_OCCU_CD
								]]>
								<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
								 #typOccuCdArr[]#
								</iterate>
								</isNotEmpty>  
							   <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
									<![CDATA[
										 II.DTIL_OCCU_INTTN_CD
									]]>
									<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
										 #dtilOccuInttnCdArr[]#
									</iterate>
								</isNotEmpty>  
								<!--   <isNotEmpty property="dtilOccuClsDivCd" prepend="AND">
								<![CDATA[
								 II.DTIL_OCCU_CLS_DIV_CD
								]]>
								<iterate prepend="IN" property="dtilOccuClsDivCdArr" open="(" close=")" conjunction=",">
								 #dtilOccuClsDivCdArr[]#
								</iterate>
								</isNotEmpty>   -->
								 <isNotEmpty property="hdofcCodtnCd" prepend="AND">
							<![CDATA[
							 II.HDOFC_CODTN_CD
							]]>
							<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
							 #hdofcCodtnCdArr[]#
							</iterate>
							</isNotEmpty>
							 
							          <isNotEmpty prepend="AND" property="systemkey" >
								 	II.SYSTEMKEY=#systemkey#
							       </isNotEmpty>  
							       <isNotEmpty prepend="AND" property="hanNm" >
								 	II.HAN_NM LIKE '%' || #hanNm# || '%'
							       </isNotEmpty>  
								ORDER BY   II.DDUC_YR_MNTH DESC 
    									   ,II.CURR_AFFN_DEPT_CD DESC 
										 ,(SELECT LPAD(DEPT_RANK,5,'0')  
			                                   FROM BASS0400 DD
			                                   WHERE DD.DEPT_CD =  II.DEPT_CD  
			                                     AND DD.DPOB_CD = II.DPOB_CD) ASC 
									    , II.RESN_REGN_NUM ASC
										, II.SYSTEMKEY DESC 				 
					
					<![CDATA[					
				) A 
			]]>
	</select>	
	
		
	<select id="insr5200DAO.selectInsr5200ListTotCnt_S" parameterClass="insr5200SerarchVO" resultClass="int">
			          SELECT COUNT(*) totcnt FROM (
							 SELECT  II.DDUC_YR_MNTH
							        ,II.DEPT_NM
							        ,II.HAN_NM
							        ,II.RESN_REGN_NUM
							        ,II.UMYT_PAYR_DDUC_YR_MNTH
							        ,NVL(II.UMYT_INSR_PRCS_YN, 'N') AS UMYT_INSR_PRCS_YN
							        ,II.MNTH_AVG_PAY_MNTH_AMNT
							        ,II.PAY_CALC_EMYMT_INSUR_SUM
							        ,II.INDV_UNEPLRT_PYMT_AGGR_SUM
							        ,( II.INDV_UNEPLRT_PYMT_AGGR_SUM - II.PAY_CALC_EMYMT_INSUR_SUM ) AS UMYT_INSR_PRMM_SRD
							        ,II.SYSTEMKEY
							        ,II.DPOB_CD
        							,II.EMYMT_SEIL_NUM
								FROM 
								( SELECT
									  AA.DDUC_YR_MNTH ,
							          fcBass0400CDNM(BB.DPOB_CD,BB.CURR_AFFN_DEPT_CD,'2') AS DEPT_NM ,
							          AA.HAN_NM ,
							          AA.RESN_REGN_NUM ,
							          AA.UMYT_PAYR_DDUC_YR_MNTH ,
							          AA.UMYT_INSR_PRCS_YN ,
							          NVL(AA.MNTH_AVG_PAY_MNTH_AMNT,0) AS MNTH_AVG_PAY_MNTH_AMNT,
							          	<![CDATA[
							          ( CASE WHEN NVL(AA.PAY_CALC_EMYMT_INSUR_SUM,0) <= 0 THEN 0  ELSE NVL(AA.PAY_CALC_EMYMT_INSUR_SUM,0)  END ) AS PAY_CALC_EMYMT_INSUR_SUM ,
							          ( CASE WHEN NVL(AA.INDV_UNEPLRT_PYMT_AGGR_SUM,0) <= 0 THEN 0  ELSE NVL(AA.INDV_UNEPLRT_PYMT_AGGR_SUM,0)  END ) AS INDV_UNEPLRT_PYMT_AGGR_SUM ,
							          ]]>
							          AA.DPOB_CD ,
							          AA.SYSTEMKEY ,
							          AA.EMYMT_SEIL_NUM ,
							          BB.EMYMT_DIV_CD ,
							          BB.DEPT_CD AS MAN_DEPT_CD,
							          BB.REPBTY_BUSIN_DIV_CD,
							          fcBass0300CDNM(BB.DPOB_CD,BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM ,
							          BB.CURR_AFFN_DEPT_CD                       AS DEPT_CD ,
							          BB.TYP_OCCU_CD ,
							          fcBass0320CDNM(BB.DPOB_CD,BB.TYP_OCCU_CD) AS TYP_OCCU_NM ,
							          BB.PYSP_GRDE_CD ,
							          BB.BUSIN_CD,
							          fcBass0500CDNM(BB.DPOB_CD,SUBSTR(BB.EMYMT_BGNN_DT,1,4),BB.CURR_AFFN_DEPT_CD,BB.BUSIN_CD) AS BUSIN_NM,
							          BB.HDOFC_CODTN_CD,
							          BB.CURR_AFFN_DEPT_CD,
        							  BB.DTIL_OCCU_INTTN_CD,
        							  GG.PAYR_MANG_DEPT_CD
								FROM  INSR5200 AA , PSNL0100 BB,BASS0400 GG
								   WHERE   AA.DPOB_CD			= BB.DPOB_CD
								   AND	   AA.SYSTEMKEY			= BB.SYSTEMKEY
								   AND	   BB.DPOB_CD			= GG.DPOB_CD
								   AND	   BB.CURR_AFFN_DEPT_CD = GG.DEPT_CD
								  ) II
								  WHERE 1=1
								  <isNotEmpty prepend="AND" property="dpobCd" >
						 	     II.DPOB_CD=#dpobCd#
					           </isNotEmpty> 
					           <isNotEmpty prepend="AND" property="mangeDeptCd" >
						         II.MAN_DEPT_CD=#mangeDeptCd#
						        </isNotEmpty>      
						        <isNotEmpty prepend="AND" property="repbtyBusinDivCd" >
						         II.REPBTY_BUSIN_DIV_CD=#repbtyBusinDivCd#
						        </isNotEmpty>  
					                AND EXISTS  (
			                         SELECT  C.DPOB_CD,
			                                 C.DTIL_OCCU_INTTN_CD,
			                                 C.TYP_OCCU_CD,
			                                 C.DEPT_CD FROM 
			                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' ))) C
			                                            WHERE     C.DPOB_CD = II.DPOB_CD
									                        AND C.DEPT_CD = II.DEPT_CD
									                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(II.TYP_OCCU_CD,'TT') 
			                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(II.DTIL_OCCU_INTTN_CD,'TT')
			                                               <isNotEmpty property="deptCd" prepend="AND">
															<![CDATA[
															 C.DEPT_CD
															]]>
															<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
															 #deptCdArr[]#
															</iterate>
															</isNotEmpty> 
							 
			                                          ) 
							       <isNotEmpty prepend="AND" property="businCd" >
								 	II.BUSIN_CD=#businCd#
							       </isNotEmpty> 
							       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
								 	II.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
							       </isNotEmpty> 
							       <isNotEmpty prepend="AND" property="emymtDivCd" >
								 	II.EMYMT_DIV_CD=#emymtDivCd#
								 	</isNotEmpty> 
							         <isNotEmpty prepend="AND" property="dducYrMnth" >
								 	II.DDUC_YR_MNTH = #dducYrMnth#
							       </isNotEmpty>  
			 					<isNotEmpty property="typOccuCd" prepend="AND">
								<![CDATA[
								 II.TYP_OCCU_CD
								]]>
								<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
								 #typOccuCdArr[]#
								</iterate>
								</isNotEmpty>  
							   <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
									<![CDATA[
										 II.DTIL_OCCU_INTTN_CD
									]]>
									<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
										 #dtilOccuInttnCdArr[]#
									</iterate>
								</isNotEmpty>  
								<!--   <isNotEmpty property="dtilOccuClsDivCd" prepend="AND">
								<![CDATA[
								 II.DTIL_OCCU_CLS_DIV_CD
								]]>
								<iterate prepend="IN" property="dtilOccuClsDivCdArr" open="(" close=")" conjunction=",">
								 #dtilOccuClsDivCdArr[]#
								</iterate>
								</isNotEmpty>   -->
								 <isNotEmpty property="hdofcCodtnCd" prepend="AND">
							<![CDATA[
							 II.HDOFC_CODTN_CD
							]]>
							<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
							 #hdofcCodtnCdArr[]#
							</iterate>
							</isNotEmpty>
							 
							          <isNotEmpty prepend="AND" property="systemkey" >
								 	II.SYSTEMKEY=#systemkey#
							       </isNotEmpty>  
							       <isNotEmpty prepend="AND" property="hanNm" >
								 	II.HAN_NM LIKE '%' || #hanNm# || '%'
							       </isNotEmpty>  
								ORDER BY   II.DDUC_YR_MNTH DESC 
    									   ,II.CURR_AFFN_DEPT_CD DESC 
										 ,(SELECT LPAD(DEPT_RANK,5,'0')  
			                                   FROM BASS0400 DD
			                                   WHERE DD.DEPT_CD =  II.DEPT_CD  
			                                     AND DD.DPOB_CD = II.DPOB_CD) ASC 
									    , II.RESN_REGN_NUM ASC
										, II.SYSTEMKEY DESC 				 
					
					<![CDATA[					
				) A 
			]]>
	</select>
	
		<update id="insr5200DAO.insr5200MnthUpdate">
			UPDATE INSR5200
			SET 
				<isEqual property="umytPayrDducYrMnth" compareValue="This">
						UMYT_PAYR_DDUC_YR_MNTH = #dducYrMnth#
						, UMYT_INSR_PRMM_SRD = #umytInsrPrmmSrd#
						, UMYT_INSR_PRCS_DT = TO_CHAR(SYSDATE,'YYYYMMDD')
				</isEqual>
				<isEqual property="umytPayrDducYrMnth" compareValue="Next">
						UMYT_PAYR_DDUC_YR_MNTH = TO_CHAR(ADD_MONTHS(TO_DATE(#dducYrMnth#,'YYYYMM'), 1), 'YYYYMM')
						, UMYT_INSR_PRMM_SRD = #umytInsrPrmmSrd#
						, UMYT_INSR_PRCS_DT = TO_CHAR(SYSDATE,'YYYYMMDD')
				</isEqual>
				<isEqual property="umytPayrDducYrMnth" compareValue="Cancel">
						UMYT_PAYR_DDUC_YR_MNTH =  NULL
						, UMYT_INSR_PRMM_SRD = #umytInsrPrmmSrd#
						, UMYT_INSR_PRCS_DT = NULL
				</isEqual>
				<isEqual property="umytPayrDducYrMnth" compareValue="Pay">
						PAY_CALC_EMYMT_INSUR_SUM =  ( SELECT	NVL (SUM (PYMT_DDUC_SUM), 0) 
						    FROM 	PAYR0302 
							WHERE 	SYSTEMKEY = #systemkey#
							AND 		PAY_CD='B0150000' 
							AND 		PAY_ITEM_CD IN ('D0160100','D0160200','D0160300','D9501600')
							AND		PYMT_YR_MNTH = #dducYrMnth# 
						)
						, UMYT_INSR_PRMM_SRD = #umytInsrPrmmSrd#
				</isEqual>				
				
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
			WHERE DPOB_CD=#dpobCd#
			AND SYSTEMKEY=#systemkey#
			AND EMYMT_SEIL_NUM=#emymtSeilNum#
			AND DDUC_YR_MNTH = #dducYrMnth#
	</update>

		<!-- Insr5200 건강보험 등록자인지 확인  -->
	<select id="insr5200DAO.selectInsr5200RegChkCnt" parameterClass="insr5200" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM   INSR5100
			WHERE  1=1
			AND    SYSTEMKEY = (
				      SELECT SYSTEMKEY
				      FROM   PSNL0100
				      WHERE  1=1 
				      AND    RESN_REGN_NUM = REPLACE(#resnRegnNum#, '-', '')
				     <!--  AND    HDOFC_CODTN_CD IN( 'A0030010' ) --> <!-- 재직자 체크 -->
				      AND    ROWNUM = 1 
			)
	</select>
	
			<!-- 대사월 급여마감여부 체크  -->
	<select id="insr5200DAO.selectPayCloseChkCnt" parameterClass="insr5200" resultClass="int">
              <![CDATA[
               SELECT NVL(COUNT(*),0) CNT
               FROM   PAYR0301  BBB
               WHERE  BBB.PAY_CD = 'B0150000' 
               AND    BBB.PYMT_YR_MNTH =  #dducYrMnth#
               AND    BBB.SYSTEMKEY =  #systemkey#
               AND    BBB.PAY_DDLNE_YN = 'Y'
               ]]>
	</select>


</sqlMap>
