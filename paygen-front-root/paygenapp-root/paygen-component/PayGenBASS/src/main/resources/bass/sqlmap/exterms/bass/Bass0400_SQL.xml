<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="Bass0400">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="bass0400DTO" type="com.app.exterms.basis.client.dto.Bass0400DTO"/>
	<typeAlias  alias="bass0400VO" type="com.app.exterms.basis.server.vo.Bass0400VO"/>
	<typeAlias  alias="bass0400SrhVO" type="com.app.exterms.basis.server.vo.Bass0400SrhVO"/>
	
	<update id="bass0400DAO.saveBass0400" parameterClass="bass0400DTO">
	    
			MERGE INTO BASS0400
			     USING DUAL ON (DPOB_CD = #dpobCd# AND DEPT_CD = #deptCd# )
			WHEN MATCHED
			THEN
			   UPDATE 
			      SET  
			           DEPT_NM_HAN = #deptNmHan#,
				       DEPT_NM_RTCHNT = #deptNmRtchnt#,
				       DEPT_NM_ENG = #deptNmEng#,
				       TPLVL_DEPT_CD = #tplvlDeptCd#,
				       HHRK_DEPT_CD = #hhrkDeptCd#,
				       PAYR_MANG_DEPT_CD = #payrMangDeptCd#,
				       DEPT_USE_YN = #deptUseYn#,
				       NAT_PENN_SYM = #natPennSym#,
				       HLTH_INSR_SYM = #hlthInsrSym#,
				       UMYT_INSR_SYM = #umytInsrSym#,
				       IDTL_ACCDT_INSUR_SYM = #idtlAccdtInsurSym#,
				       DEPT_NOTE_CTNT = #deptNoteCtnt#,
				       DEPT_DSPY_YN = #deptDspyYn#,
				       MANGE_DEPT_CD = #mangeDeptCd#,
				       ISMT = #ismt#,
				       REVN_DT = to_char(sysdate,'yyyymmddhh24miss'),
				       REVN_ADDR = #revnAddr#,
				       DEPT_CRE_DT = #deptCreDt#,
				       DEPT_END_DT = #deptEndDt#,
				       BEF_DEPT_CD = #befDeptCd#,
				       BEF_DEPT_CD02 = #befDeptCd02#
       		WHEN NOT MATCHED
			THEN
			   INSERT 
						( DPOB_CD,
	                      DEPT_CD,
	                      DEPT_NM_HAN,
	                      DEPT_NM_RTCHNT,
	                      DEPT_NM_ENG,
	                      TPLVL_DEPT_CD,
	                      HHRK_DEPT_CD,
	                      PAYR_MANG_DEPT_CD,
	                      DEPT_USE_YN,
	                      NAT_PENN_SYM,
	                      HLTH_INSR_SYM,
	                      UMYT_INSR_SYM,
	                      IDTL_ACCDT_INSUR_SYM,
	                      DEPT_NOTE_CTNT,
	                      DEPT_DSPY_YN,
	                      MANGE_DEPT_CD,
	                      KYBDR,
	                      INPT_DT,
	                      INPT_ADDR,
	                      ISMT,
	                      REVN_DT,
	                      REVN_ADDR,
	                      DEPT_CRE_DT,
	                      DEPT_END_DT,
	                      BEF_DEPT_CD,
	                      BEF_DEPT_CD02)
				VALUES ( #dpobCd#,
			             #deptCd#,
			             #deptNmHan#,
			             #deptNmRtchnt#,
			             #deptNmEng#,
			             #tplvlDeptCd#,
			             #hhrkDeptCd#,
			             #payrMangDeptCd#,
			             #deptUseYn#,
			             #natPennSym#,
			             #hlthInsrSym#,
			             #umytInsrSym#,
			             #idtlAccdtInsurSym#,
			             #deptNoteCtnt#,
			             #deptDspyYn#,
			             #mangeDeptCd#,
			             #ismt#,
			             to_char(sysdate, 'yyyymmddhh24miss'),
			             #revnAddr#,
			             #ismt#,
			             to_char(sysdate, 'yyyymmddhh24miss'),
			             #revnAddr#,
			             #deptCreDt#,
			             #deptEndDt#,
			             #befDeptCd#,
			             #befDeptCd02#)
	</update>
	
	
	
	<delete id="bass0400DAO.deleteBass0400" parameterClass="bass0400DTO">
		<![CDATA[
			DELETE FROM BASS0400 
			WHERE DPOB_CD = #dpobCd# 
			  AND DEPT_CD = #deptCd# 
			]]>
	</delete>
	
	<select id="bass0400DAO.getBass0150List" parameterClass="bass0400DTO" resultClass="egovMap">
		SELECT 
			PAYR_MANG_DEPT_CD AS COMM_CD,
			PAY_MANGE_DEPT_NM AS COMM_CD_NM
		  FROM BASS0150
		 WHERE DPOB_CD = #dpobCd#
	  ORDER BY PAYR_MANG_DEPT_CD ASC 
	</select>
	
	<select id="bass0400DAO.selectBass0400List" parameterClass="bass0400DTO" resultClass="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (  
				     SELECT C.DPOB_CD,
                               (SELECT B.DPOB_NM FROM BASS0100 B WHERE B.DPOB_CD = C.DPOB_CD ) AS DPOB_NM,
                               C.DEPT_CD,
                               C.DEPT_NM_HAN,
                               C.DEPT_NM_RTCHNT,
                               C.DEPT_NM_ENG,
                               C.TPLVL_DEPT_CD,
                               fcBass0400CDNM(C.DPOB_CD,C.TPLVL_DEPT_CD, 2) AS TPLVL_DEPT_CD_NM,
                               C.HHRK_DEPT_CD,
                               fcBass0400CDNM(C.DPOB_CD,C.HHRK_DEPT_CD, 2) AS HHRK_DEPT_CD_NM,
                               C.PAYR_MANG_DEPT_CD,
                               C.DEPT_USE_YN,
                               C.NAT_PENN_SYM,
                               C.HLTH_INSR_SYM,
                               C.UMYT_INSR_SYM,
                               C.IDTL_ACCDT_INSUR_SYM,
                               C.DEPT_NOTE_CTNT,
                               C.DEPT_DSPY_YN,
                               C.MANGE_DEPT_CD,
                               fcBass0400CDNM(C.DPOB_CD,C.MANGE_DEPT_CD, 2) AS MANGE_DEPT_CD_NM, 
                               C.KYBDR,
                               C.INPT_DT,
                               C.INPT_ADDR,
                               C.ISMT,
                               C.REVN_DT,
                               C.REVN_ADDR,
                               C.DEPT_CRE_DT,
                               C.DEPT_END_DT,
                               C.BEF_DEPT_CD,
                               fcBass0400CDNM(C.DPOB_CD,C.BEF_DEPT_CD, 2) AS BEF_DEPT_NM,
                               C.BEF_DEPT_CD02,
                               fcBass0400CDNM(C.DPOB_CD,C.BEF_DEPT_CD02, 2) AS BEF_DEPT_NM02                              
                          FROM BASS0400 C
                        WHERE 1=1 
                  <isNotNull property="deptNmHan">
				    <isNotEmpty property="deptNmHan">
				        AND C.DEPT_NM_HAN like '%' || #deptNmHan# || '%'
				    </isNotEmpty>
				</isNotNull>
			    	    AND DEPT_USE_YN = NVL(#deptUseYn#,'Y') 
			    	
                        ORDER BY LPAD(DEPT_RANK,5,'0') ASC 
		<![CDATA[					
	) A WHERE ROWNUM <= #lastIndex#
)WHERE RNUM >= #firstIndex#
]]>
	</select>	
	<select id="bass0400DAO.selectBass0400ListTotCnt" parameterClass="bass0400DTO" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM BASS0400
			WHERE 1=1
			<isNotNull property="deptNmHan">
			    <isNotEmpty property="deptNmHan">
			        AND DEPT_NM_HAN like '%' || #deptNmHan# || '%'
			    </isNotEmpty>
			</isNotNull>
			        AND DEPT_USE_YN = NVL(#deptUseYn#,'Y') 
			   
	</select>
	
	
	
	<select id="bass0400DAO.selectBass0450ToBass0400List" parameterClass="bass0400SrhVO" resultClass="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (	          
				     SELECT C.DPOB_CD,
                               (SELECT B.DPOB_NM FROM BASS0100 B WHERE B.DPOB_CD = C.DPOB_CD ) AS DPOB_NM,
                               C.DEPT_CD,
                               C.DEPT_NM_HAN,
                               C.DEPT_NM_RTCHNT,
                               C.DEPT_NM_ENG,
                               C.TPLVL_DEPT_CD,
                               fcBass0400CDNM(C.DPOB_CD,C.TPLVL_DEPT_CD, 2) AS TPLVL_DEPT_CD_NM,
                               C.HHRK_DEPT_CD,
                               fcBass0400CDNM(C.DPOB_CD,C.HHRK_DEPT_CD, 2) AS HHRK_DEPT_CD_NM,
                               C.PAYR_MANG_DEPT_CD,
                               C.DEPT_USE_YN,
                               C.NAT_PENN_SYM,
                               C.HLTH_INSR_SYM,
                               C.UMYT_INSR_SYM,
                               C.IDTL_ACCDT_INSUR_SYM,
                               C.DEPT_NOTE_CTNT,
                               C.DEPT_DSPY_YN,
                               C.MANGE_DEPT_CD,
                               fcBass0400CDNM(C.DPOB_CD,C.MANGE_DEPT_CD, 2) AS MANGE_DEPT_CD_NM, 
                               C.KYBDR,
                               C.INPT_DT,
                               C.INPT_ADDR,
                               C.ISMT,
                               C.REVN_DT,
                               C.REVN_ADDR,                               
                               C.DEPT_CRE_DT,
                               C.DEPT_END_DT,
                               C.BEF_DEPT_CD,
                               fcBass0400CDNM(C.DPOB_CD,C.BEF_DEPT_CD, 2) AS BEF_DEPT_NM,
                               C.BEF_DEPT_CD02,
                               fcBass0400CDNM(C.DPOB_CD,C.BEF_DEPT_CD02, 2) AS BEF_DEPT_NM02
                          FROM BASS0400 C
                        WHERE  C.DEPT_DSPY_YN = 'Y' 
                           AND DEPT_USE_YN = 'Y'
                     <isNotEmpty prepend="AND" property="dpobCd" >
                      C.DPOB_CD=#dpobCd#
                   </isNotEmpty> 
                   <isNotEmpty prepend="AND"  property="deptNmHan" >
			         C.DEPT_NM_HAN like '%' || #deptNmHan# || '%'
			    </isNotEmpty> 
                        ORDER BY LPAD(DEPT_RANK,5,'0') ASC
	<![CDATA[
			) A WHERE ROWNUM <= #lastIndex#
 		)WHERE RNUM >= #firstIndex# 
 	]]>
</select>
	
	<select id="bass0400DAO.selectBass0450ToBass0400ListTotCnt" parameterClass="bass0400SrhVO" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM BASS0400
			WHERE DEPT_DSPY_YN = 'Y' 
		      AND DEPT_USE_YN = 'Y'
		          <isNotEmpty prepend="AND" property="dpobCd" >
                       DPOB_CD=#dpobCd#
                   </isNotEmpty> 
			    <isNotEmpty prepend="AND"  property="deptNmHan" >
			         DEPT_NM_HAN like '%' || #deptNmHan# || '%'
			    </isNotEmpty> 
	</select>		
	
	

</sqlMap>