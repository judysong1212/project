<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="Psnl0320">

	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>	
	<typeAlias  alias="psnl0320SrhVO" type="com.app.exterms.personal.server.vo.Psnl0320SrhVO"/>
	<typeAlias  alias="Psnl0320Vo" type="com.app.exterms.personal.server.vo.Psnl0320VO"/>
	<typeAlias  alias="Psnl0119Vo" type="com.app.exterms.personal.server.vo.Psnl0119VO"/>
	<typeAlias  alias="Psnl0122Vo" type="com.app.exterms.personal.server.vo.Psnl0122VO"/>
	
	<typeAlias  alias="psnl0320dto" type="com.app.exterms.personal.server.vo.Psnl0320DTO"/>

	<typeAlias alias="hashMap" type="java.util.HashMap" />
	<typeAlias alias="list" type="java.util.List" />
	<typeAlias alias="int" type="java.lang.Integer" />
	<typeAlias alias="string" type="java.lang.String" />
	<typeAlias alias="psnl0100dto" type="com.app.exterms.personal.client.dto.Psnl0100DTO" />

	<resultMap id="psnl0320" class="com.app.exterms.personal.server.vo.Psnl0320VO">
		<result property="dpobCd" column="DPOB_CD" columnIndex="1" />
		<result property="systemkey" column="SYSTEMKEY" columnIndex="2" />
		<result property="hanNm" column="HAN_NM" columnIndex="3" />
		<result property="engNm" column="ENG_NM" columnIndex="4" />
		<result property="chinCharNm" column="CHIN_CHAR_NM" columnIndex="5" />
		<result property="resnRegnNum" column="RESN_REGN_NUM" columnIndex="6" />
		<result property="sxDivCd" column="SX_DIV_CD" columnIndex="7" />
		<result property="yoobhMnthDay" column="YOOBH_MNTH_DAY" columnIndex="8" />
		<result property="sclcDivCd" column="SCLC_DIV_CD" columnIndex="9" />
		<result property="natnCd" column="NATN_CD" columnIndex="10" />
		<result property="deptCd" column="DEPT_CD" columnIndex="11" />
		<result property="businCd" column="BUSIN_CD" columnIndex="12" />
		<result property="currAffnDeptCd" column="CURR_AFFN_DEPT_CD" columnIndex="13" />
		<result property="repbtyBusinDivCd" column="REPBTY_BUSIN_DIV_CD" columnIndex="14" />
		<result property="typOccuCd" column="TYP_OCCU_CD" columnIndex="15" />
		<result property="odtyCd" column="ODTY_CD" columnIndex="16" />
		<result property="frstEmymtDt" column="FRST_EMYMT_DT" columnIndex="17" />
		<result property="emymtDivCd" column="EMYMT_DIV_CD" columnIndex="18" />
		<result property="emymtBgnnDt" column="EMYMT_BGNN_DT" columnIndex="19" />
		<result property="emymtEndDt" column="EMYMT_END_DT" columnIndex="20" />
		<result property="pyspCd" column="PYSP_CD" columnIndex="21" />
		<result property="hdofcCodtnCd" column="HDOFC_CODTN_CD" columnIndex="22" />
		<result property="retryDt" column="RETRY_DT" columnIndex="23" />
		<result property="retryReasCtnt" column="RETRY_REAS_CTNT" columnIndex="24" />
		<result property="frgnrDivCd" column="FRGNR_DIV_CD" columnIndex="25" />
		<result property="pyspReMrkSeilNum" column="PYSP_RE_MRK_SEIL_NUM" columnIndex="26" />
		
	</resultMap>

	<select id="psnl0320DAO.selectPsnl0100PagingTotCnt" parameterClass="psnl0320SrhVo" resultClass="int">
	   	SELECT COUNT(*) 
	   	 FROM PSNL0100 
	   	WHERE 1=1
	   	<isNotNull property="hanNm">
		     <isNotEmpty property="hanNm" prepend="AND">
				HAN_NM like '%'|| #hanNm# || '%' 
		     </isNotEmpty>
		 </isNotNull>
		 
		 <isNotNull property="resnRegnNum">
		     <isNotEmpty property="resnRegnNum" prepend="AND">
		         RESN_REGN_NUM like '%'|| REPLACE(#resnRegnNum#,'-','') || '%' 
		     </isNotEmpty>
		 </isNotNull>
		 <isNotEmpty property="hdofcCodtnCd" prepend="AND">
			<![CDATA[
				HDOFC_CODTN_CD
			]]>
			<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
				#hdofcCodtnCdArr[]#
			</iterate>
		</isNotEmpty> 
		 <!-- 
		<isNotNull property="hdofcCodtnCd">
			<isNotEmpty property="hdofcCodtnCd">
		         AND HDOFC_CODTN_CD = #hdofcCodtnCd#  
		</isNotEmpty>
		</isNotNull>
		 -->	
		 <isNotNull property="deptCd">
		     <isNotEmpty property="deptCd">
		         AND DEPT_CD = #deptCd#  
		     </isNotEmpty>
		 </isNotNull>		 
		 
		 <isNotNull property="mangeDeptCd">
		     <isNotEmpty property="mangeDeptCd">
		         AND DEPT_CD = #mangeDeptCd#  
		     </isNotEmpty>
		 </isNotNull>		 
		 <isNotEmpty prepend="AND" property="repbtyBusinDivCd" >
           REPBTY_BUSIN_DIV_CD=#repbtyBusinDivCd#
         </isNotEmpty> 
		 <isNotNull property="currAffnDeptCd">
		     <isNotEmpty property="currAffnDeptCd">
		         AND CURR_AFFN_DEPT_CD = #currAffnDeptCd#  
		     </isNotEmpty>
		 </isNotNull>			 
		 
		 <isNotNull property="typOccuCd">
		 	<isNotEmpty property="typOccuCd" >
			 	 AND TYP_OCCU_CD=#typOccuCd# 
		 	</isNotEmpty> 
		 </isNotNull> 

		<isNotEmpty property="dtilOccuInttnCd" prepend="AND">
			<![CDATA[
				DTIL_OCCU_INTTN_CD
			]]>
			<isNotNull property="dtilOccuInttnCdArr">
			<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
				#dtilOccuInttnCdArr[]#
			</iterate>
			</isNotNull>
		</isNotEmpty>
		
		<isNotNull property="deptCd">
			<isNotEmpty property="deptCd" prepend="AND">
				<![CDATA[
					DEPT_CD
				]]>
			<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
				#deptCdArr[]#
			</iterate>
			</isNotEmpty> 
 		</isNotNull>		 
		 
		  <isNotNull property="emymtDivCd">
		 	<isNotEmpty property="emymtDivCd" >
			 	 AND EMYMT_DIV_CD=#emymtDivCd# 
		 	</isNotEmpty>
		 </isNotNull> 
	</select>	

	<select id="psnl0320DAO.getPsnl0100ToPsnl0320DataList" parameterClass="psnl0320SrhVo" resultClass="egovMap">
		<![CDATA[
			SELECT * FROM (
				SELECT T.*, ROWNUM RNUM FROM (
					SELECT 
						A.DPOB_CD
			       		, A.SYSTEMKEY
			       		, A.HAN_NM
			       		, A.ENG_NM
			       		, A.CHIN_CHAR_NM
			       		, SUBSTR(A.RESN_REGN_NUM,0,6)||'-'||SUBSTR(A.RESN_REGN_NUM,7) AS RESN_REGN_NUM
			       		, A.SX_DIV_CD
				       	, A.YOOBH_MNTH_DAY
				       	, A.SCLC_DIV_CD
				      	, A.NATN_CD
				       	, fcBass0300CDNM(A.DPOB_CD, A.NATN_CD) AS NATN_NM
				       	, fcBass0300ITEMNM(A.DPOB_CD, A.NATN_CD, '12') AS NATN_ITEM
				       	, A.DEPT_CD
				       	, fcBass0400CDNM(A.DPOB_CD, A.DEPT_CD,'2') AS DEPT_NM
				       	, A.BUSIN_CD
				       	, A.CURR_AFFN_DEPT_CD
				       	, fcBass0400CDNM(A.DPOB_CD, A.CURR_AFFN_DEPT_CD,'2') AS CURR_AFFN_DEPT_NM
				       	, A.REPBTY_BUSIN_DIV_CD
				       	, A.REPBTY_BUSIN_NM
				       	, A.TYP_OCCU_CD 
				       	, A.ODTY_CD
				       	, A.FRST_EMYMT_DT
				       	, A.EMYMT_DIV_CD
				       	, A.EMYMT_BGNN_DT
				       	, A.EMYMT_END_DT
				       	, A.PYSP_CD
				       	
				       	,fcBass0300ITEMNM(A.DPOB_CD,A.PYSP_CD,'12') AS PYSP_NM
				       	
				       	
				       	, A.HDOFC_CODTN_CD
				      	, A.RETRY_DT
				        , A.RETRY_REAS_CTNT
				        , A.FRGNR_DIV_CD
				        , A.PSPT_NUM
				        , A.STY_BGNN_DT
				        , A.STY_END_DT
				        , A.END_SCHL
				        , A.END_DEGR_DIV_CD
				        , A. PMTN_SCDU_DT
				        , A.PYSP_PRMTN_SCDU_DT
				        , A.REYMN_SCDU_DT
				        , A.LOG_SVC_YR_NUM_CD
				        ,fcBass0300ITEMNM(A.DPOB_CD,A.LOG_SVC_YR_NUM_CD,'1') AS LOG_SVC_YR_NUM_NM
				        
				        
				        , A.LOG_SVC_MNTH_ICM_CD
				         ,fcBass0300ITEMNM(A.DPOB_CD,A.LOG_SVC_MNTH_ICM_CD,'1') AS LOG_SVC_MNTH_ICM_NM
				        
				        
				        , DTIL_OCCU_INTTN_CD 
			            , fcBassEx0350CDNM(A.DPOB_CD,A.TYP_OCCU_CD,A.DTIL_OCCU_INTTN_CD,'1' ) AS DTIL_OCCU_CLS_NM 
				        , (  (fcBass0300CDNM(A.DPOB_CD, A.LOG_SVC_YR_NUM_CD))  ||' '|| (fcBass0300CDNM(A.DPOB_CD, A.LOG_SVC_MNTH_ICM_CD)) ) AS WORKYM
				        , A.CURR_PYSP_APPMT_DT
				        , A.CURR_DEPT_APPMT_DT
				        , A.PERN_NOTE_CTNT
				        , A.KYBDR
				        , A.INPT_DT
				        , A.INPT_ADDR
				        , A.ISMT
				        , A.REVN_DT
				        , A.REVN_ADDR
				        ,  (
							SELECT B.CURR_PAE_WORK_NM
							FROM PSNL0110 B
							WHERE B.DPOB_CD = A.DPOB_CD
								AND B.SYSTEMKEY = A.SYSTEMKEY
								AND B.EMYMT_BGNN_DT = (
										                            SELECT MAX (C.EMYMT_BGNN_DT)
										                            FROM PSNL0110 C
										                            WHERE B.DPOB_CD = C.DPOB_CD
										                                AND B.SYSTEMKEY = C.SYSTEMKEY
										                                AND C.EMYMT_TYP_CD NOT IN ('A0030020', 'A0030030', 'A0420040', 'A0420990')
							                           				)
				        	)AS CURR_PAE_WORK_NM
				        , (SELECT C.PIC_FLNM FROM PSNL0125 C WHERE C.DPOB_CD = A.DPOB_CD AND C.SYSTEMKEY = A.SYSTEMKEY)AS PIC_FLNM
				        , NVL(A.PYSP_GRDE_CD,'A0060000') AS PYSP_GRDE_CD
				        , A.DTIL_OCCU_CLS_DIV_CD
				        , NVL2(A.BUSIN_CD, '(' || ( 
						        							SELECT E.BUSIN_APPTN_YR
			                               					FROM BASS0500 E
			                             					WHERE  A.DPOB_CD = E.DPOB_CD
			                                    				AND A.CURR_AFFN_DEPT_CD = E.DEPT_CD
			                                    				AND A.BUSIN_CD = E.BUSIN_CD
			                                    				AND SUBSTR (A.EMYMT_BGNN_DT, 1, 4) = E.BUSIN_APPTN_YR
			                                    		)
	                         						|| ')'
			                         				|| ( 
				                         					SELECT E.BUSIN_NM 
				                         					FROM BASS0500 E
				                             				WHERE  A.DPOB_CD = E.DPOB_CD
				                                    			AND A.CURR_AFFN_DEPT_CD = E.DEPT_CD
				                                    			AND A.BUSIN_CD = E.BUSIN_CD
				                                    			AND SUBSTR (A.EMYMT_BGNN_DT, 1, 4) = E.BUSIN_APPTN_YR
			                                    	   )
			              , '')AS BUSIN_NM
				        , fcBass0300CDNM(A.DPOB_CD, A.EMYMT_DIV_CD) AS EMYMT_DIV_NM
		                , fcBass0400CDNM(A.DPOB_CD, A.CURR_AFFN_DEPT_CD, '2') AS CURR_AFFN_DEPT_CD_NM
		                , fcBass0320CDNM(A.DPOB_CD, A.TYP_OCCU_CD)AS TYP_OCCU_NM
		                , fcBass0350CDNM(A.DPOB_CD, A.TYP_OCCU_CD, A.DTIL_OCCU_CLS_DIV_CD, '1')  DTIL_OCCU_CLS_DIV_NM /* 직종세명 */
		                , CASE WHEN A.RE_MRK_DT = NULL THEN ''
		                       ELSE NVL(A.RE_MRK_DT,'') 
		                       END AS  RE_MRK_DT/* 재획정일자 */
	            		/* 재획정일자=근속기준일 */
	            		, A.LOG_STD_DT  /* 근속기준일 */
	            		, G.ENRLNT_DT /* 입대일자 */
	            		, G.DSAGE_DT /* 제대일자 */
	            		, G.SERVC_RCGTN_PRID_CD /* 복무인정기간코드 */
					FROM PSNL0100 A, PAYR0500 D
						,PSNL0112 G /* 인사-병역 */
					WHERE 
						A.DPOB_CD = D.DPOB_CD
						AND A.SYSTEMKEY = D.SYSTEMKEY 
						AND A.DPOB_CD = G.DPOB_CD
						AND A.SYSTEMKEY = G.SYSTEMKEY
			]]>
						<isNotEmpty prepend="AND" property="dpobCd" >
						 	A.DPOB_CD=#dpobCd#
					    </isNotEmpty>
						<isNotEmpty prepend="AND" property="mangeDeptCd" >
						 	A.DEPT_CD=#mangeDeptCd#
					    </isNotEmpty>
					    <isNotEmpty prepend="AND" property="repbtyBusinDivCd" >
				         A.REPBTY_BUSIN_DIV_CD=#repbtyBusinDivCd#
				        </isNotEmpty> 
					     AND EXISTS  (
	                         SELECT  C.DPOB_CD,
	                                 C.DTIL_OCCU_INTTN_CD,
	                                 C.TYP_OCCU_CD,
	                                 C.DEPT_CD FROM 
	                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' ))) C
	                                            WHERE     C.DPOB_CD = A.DPOB_CD
							                        AND C.DEPT_CD = A.CURR_AFFN_DEPT_CD
							                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(A.TYP_OCCU_CD,'TT') 
	                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(A.DTIL_OCCU_INTTN_CD,'TT')
	                                               <isNotEmpty property="deptCd" prepend="AND">
													<![CDATA[
													 C.DEPT_CD
													]]>
													<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
													 #deptCdArr[]#
													</iterate>
													</isNotEmpty> 
	                                          )
	                    <isNotEmpty prepend="AND" property="businCd" >
						 	A.BUSIN_CD=#businCd#
					    </isNotEmpty> 
						<isNotEmpty prepend="AND" property="payrMangDeptCd" >
						 	D.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
					    </isNotEmpty> 
					    <isNotEmpty prepend="AND" property="emymtDivCd" >
						 	A.EMYMT_DIV_CD=#emymtDivCd#
						</isNotEmpty>
						<isNotEmpty property="hdofcCodtnCd" prepend="AND">
							<![CDATA[
								 A.HDOFC_CODTN_CD
							]]>
							<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
								 #hdofcCodtnCdArr[]#
							</iterate>
						</isNotEmpty>  
					    <isNotEmpty property="typOccuCd" prepend="AND">
							<![CDATA[
								 A.TYP_OCCU_CD
							]]>
							<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
							 	 #typOccuCdArr[]#
							</iterate>
						</isNotEmpty>  
						<isNotEmpty property="dtilOccuInttnCd" prepend="AND">
							<![CDATA[
								 A.DTIL_OCCU_INTTN_CD
							]]>
							<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
								 #dtilOccuInttnCdArr[]#
							</iterate>
						</isNotEmpty>  
					    <isNotEmpty prepend="AND" property="systemkey" >
						 	A.SYSTEMKEY=#systemkey#
					    </isNotEmpty>  
					    <isNotEmpty prepend="AND" property="hanNm" >
						 	A.HAN_NM LIKE '%' || #hanNm# || '%'
					    </isNotEmpty>                        
						ORDER BY 
							A.DPOB_CD DESC
							, (SELECT LPAD(DEPT_RANK,5,'0')  
	                                   FROM BASS0400 DD
	                                   WHERE DD.DEPT_CD = A.CURR_AFFN_DEPT_CD
	                                     AND DD.DPOB_CD = A.DPOB_CD) ASC
	                        , A.RESN_REGN_NUM ASC
						    , A.SYSTEMKEY DESC
			
		<isNotEqual  property="lastIndex" compareValue="-1">
	 	<![CDATA[					
					) T WHERE ROWNUM <= #lastIndex#
			)WHERE RNUM >= #firstIndex#
		]]>
		</isNotEqual>	
		<isEqual   property="lastIndex" compareValue="-1">
	  	<![CDATA[					
			) T  
		)
		]]>
		</isEqual>
	</select>

	<select id="psnl0320DAO.getPsnl0110ToPsnl0320DataList" parameterClass="psnl0320SrhVo" resultClass="egovMap">
		<![CDATA[
		SELECT
			SYSTEMKEY
			,DPOB_CD
			,EMYMT_SEIL_NUM /* 고용일련번호 */
			,EMYMT_DIV_CD /*고용구분코드*/
			,fcBass0300CDNM (DPOB_CD, EMYMT_DIV_CD) AS EMYMT_DIV_NM /*고용구분명*/
		    ,EMYMT_TYP_CD /*고용유형코드*/
		    ,FCBASS0300CDNM(DPOB_CD, EMYMT_TYP_CD) AS EMYMT_TYP_NM /*고용유형명*/
		    ,EMYMT_BGNN_DT /*고용시작일자*/
		    ,EMYMT_END_DT /*고용종료일자*/
		    ,DEPT_CD /* 부서코드 */
		    ,FCBASS0400CDNM(DPOB_CD, DEPT_CD, '2') DEPT_NM /*부서명*/
		    ,fcBass0320CDNM(DPOB_CD, TYP_OCCU_CD) TYP_OCCU_NM /* 직종명 */
		    ,fcBass0350CDNM(DPOB_CD, TYP_OCCU_CD, DTIL_OCCU_CLS_DIV_CD, '1')  DTIL_OCCU_CLS_DIV_NM /* 직종세명 */
			,CURR_PAE_WORK_NM /* 현근무지명*/
			,BUSIN_CD /* 사업코드*/
			,TYP_OCCU_CD /* 직종코드*/
			,DTIL_OCCU_CLS_DIV_CD /* 직종세구분코드*/
			,ODTY_CD /* 직책코드*/
			,PAY_PYMT_DIV_CD /* 급여지급구분코드*/
			,EMYMT_SUM /* 고용금액*/
			,EMYMT_REAS_CTNT /* 고용사유내용*/
			,CERT_NUM_HUHD /* 증번호*/
			,RDUC_BGNN_DT /* 경감시작일자*/
			,KYBDR /* 입력자*/
			,INPT_DT /* 입력일자*/
			,INPT_ADDR /* 입력주소*/
			,ISMT /* 수정자*/
			,REVN_DT /* 수정일자*/
			,REVN_ADDR /* 수정주소*/
			,RDUC_END_DT /* 경감종료일자*/
			,PYSP_GRDE_CD /* 호봉등급코드*/
			,DTIL_OCCU_INTTN_CD /* */
			/*,CVSN_RTO_DIV_CD*/ /* 환산비율구분코드*/
			,FCBASS0300CDNM(DPOB_CD,CVSN_RTO_DIV_CD) AS cvsnRtoDivCdcommCdNm
			,DUTY_YR_NUM /* 근무년수*/
			,DUTY_MNTH_ICM /* 근무월수*/
			,DUTY_DAY_NUM /* 근무일수*/
			,DUTY_TOT_DAY_NUM /* 근속전체일수*/
		FROM PSNL0110 /*인사_고용*/
		WHERE SYSTEMKEY = #systemkey#
			AND DPOB_CD = #dpobCd#
				 ]]>
					<isNotEmpty property="emymtDivCd">		 
				          <isEqual  prepend="AND"   property="emymtDivCd" compareValue="A0020020"> 
				           <![CDATA[
								    		  EMYMT_DIV_CD <>  'A0020010'  /* 고용구분코드 */
								    		  	 ]]>
							</isEqual>	
							  <isNotEqual  prepend="AND"    property="emymtDivCd" compareValue="A0020020"> 
								        EMYMT_DIV_CD  =   'A0020010'   /* 고용구분코드 */
							</isNotEqual>			 
					 </isNotEmpty>	 
				 <![CDATA[
		ORDER BY EMYMT_BGNN_DT DESC
		 ]]>
	</select>

	<select id="psnl0320DAO.getPsnl0119ToPsnl0320DataList" parameterClass="psnl0320SrhVo" resultClass="egovMap">
		<![CDATA[
		SELECT
		    DPOB_CD
		    ,SYSTEMKEY
		    ,CARR_RSPT_SEIL_NUM /* 경력사항일련번호 */
		    ,CARR_BGNN_DT /* 근무시작일자(경력시작일자) */
		    ,CARR_END_DT /* 근무종료일자(경력종료일자) */
		    ,PAE_WORK_NM /*근무처명*/
		    ,CARR_DIV_CD /* 경력구분코드 */
		    
		    , fcBass0300ITEMNM(DPOB_CD, CARR_DIV_CD,'0') AS CARR_DIV_NM /* 경력구분 */
		    
		    ,DUTY_DEPT_NM /* 근무부서명 */
		    
		    
		    
		    ,REPBTY_BUSIN_NM /* 담당업무명 */
			,ODTY_NM /*직책명*/
			,AMNT_DLYWAG_SUM /*임금일당금액*/
			,CARR_NOTE_CTNT /*경력비고내용*/
			,DUTY_YR_NUM /*근무년수*/
			,DUTY_MNTH_ICM /*근무월수*/
		    /*,CVSN_RTO_DIV_CD*/ /* 경력인정(환산비율) */
			,FCBASS0300CDNM(DPOB_CD,CVSN_RTO_DIV_CD) AS cvsnRtoDivCdcommCdNm
			,AJMT_MNTH_NUM /*가감월수*/
			,RCGTN_MNTH_NUM /*인정월수*/
			,KYBDR /*입력자*/
			,INPT_DT /*입력일자*/
			,INPT_ADDR /*입력주소*/
			,ISMT /*수정자*/
			,REVN_DT /*수정일자*/
			,REVN_ADDR /*수정주소*/
			,DUTY_DAY_NUM /*근속일수*/
			,DUTY_TOT_DAY_NUM /*근속전체일수*/
		    /* 근무일수 */
		FROM PSNL0119 /* 경력 */
		WHERE SYSTEMKEY = #systemkey#
			AND DPOB_CD = #dpobCd#
		ORDER BY CARR_RSPT_SEIL_NUM DESC
		 ]]>
	</select>

	<select id="psnl0320DAO.getPsnl0122ToPsnl0320DataList" parameterClass="psnl0320SrhVo" resultClass="egovMap">
		<![CDATA[
		SELECT
		    DPOB_CD /** 사업장코드 */
		    ,SYSTEMKEY /** SYSTEMKEY */
		    ,DSNY_ACT_SEIL_NUM /* 징계일련번호 */
		    ,DSNY_ACT_DSPL_DT /**징계처분일자*/
		    ,DSNY_ACT_DIV_CD /**징계구분코드*/
		    
		    ,DSNY_ACT_DIV_CD /**징계구분코드*/
		    , fcBass0300ITEMNM(DPOB_CD, DSNY_ACT_DIV_CD,'0') AS DSNY_ACT_DIV_NM /* 징계구분 */
		    
		    ,DSNY_ACT_NM /**징계명*/
		    ,DSNY_ACT_REAS_CTNT /**징계사유내용*/
		    ,DSNY_ACT_ECTG_ORGN /**시행기관(징계수행기관) */
		    ,DSNY_ACT_NOTE_CTNT /*징계비고내용*/
		    ,DSNY_ACT_BGNN_DT /**징계시작일자*/
		    ,DSNY_ACT_END_DT /**징계종료일자*/
			,DSNY_ACT_CTWP_RATE /*징계감봉율*/
		    ,DSNY_ACT_CTWP_MNTH_ICM /**징계감봉월수*/
		    ,DSNY_ACT_ANSTY_DT /**징계사면일자*/
			,DSNY_ACT_ANSTY_DIV_CD /*징계사면구분코드*/
			,KYBDR /*입력자*/
			,INPT_DT /*입력일자*/
			,INPT_ADDR /*입력주소*/
			,ISMT /*수정자*/
			,REVN_DT /*수정일자*/
			,REVN_ADDR /*수정주소*/
		FROM PSNL0122
		WHERE SYSTEMKEY = #systemkey#
			AND DPOB_CD = #dpobCd#
		ORDER BY DSNY_ACT_SEIL_NUM DESC
		 ]]>
	</select>

	<update id="psnl0320DAO.updatePsnl0110" parameterClass="Psnl0320Vo">
		UPDATE PSNL0110
		SET
			DPOB_CD = #dpobCd#
			,SYSTEMKEY = #systemkey#
		<isNotEmpty property="emymtDivCd">
			,EMYMT_DIV_CD = #emymtDivCd# /* 고용구분코드 */
		</isNotEmpty>
		<isNotEmpty property="emymtTypCd">
			,EMYMT_TYP_CD = #emymtTypCd# /* 고용유형코드 */
		</isNotEmpty>
		<isNotEmpty property="emymtBgnnDt">
			,EMYMT_BGNN_DT = #emymtBgnnDt# /* 시작일자 */
		</isNotEmpty>
		<isNotEmpty property="emymtEndDt">
			,EMYMT_END_DT = #emymtEndDt# /* 종료일자 */
		</isNotEmpty>
		<isNotEmpty property="deptCd">
			,DEPT_CD = #deptCd# /* 부서 */
		</isNotEmpty>
		<isNotEmpty property="typOccuCd">
			,TYP_OCCU_CD = #typOccuCd# /* 직종 */
		</isNotEmpty>
		<isNotEmpty property="dtilOccuClsDivCd">
			,DTIL_OCCU_CLS_DIV_CD = #dtilOccuClsDivCd# /* 직종세 */
		</isNotEmpty>
		<isNotEmpty>
		    ,CVSN_RTO_DIV_CD = #cvsnRtoDivCd# /* 환산비율구분코드 */
		</isNotEmpty>
		<isNotEmpty property="emymtBgnnDt">
		    <isNotEmpty property="emymtEndDt">
		    
	    <!-- 	         DUTY_DAY_NUM = TRUNC (
                    (  (  MONTHS_BETWEEN (TO_DATE (#emymtEndDt#, 'YYYYMMDD') + 1,TO_DATE (#emymtBgnnDt#, 'YYYYMMDD')) - TRUNC ( MONTHS_BETWEEN (TO_DATE (#emymtEndDt#,'YYYYMMDD') + 1,TO_DATE (#emymtBgnnDt#, 'YYYYMMDD')),0))
                     * 30.5),
                    0) -->
		<!--         ,DUTY_DAY_NUM = TRUNC(TO_DATE(#emymtEndDt#,'YYYYMMDD'))- TRUNC(TO_DATE(#emymtBgnnDt#,'YYYYMMDD'))+1 /* 근무일수 */ -->
		<!-- 		,DUTY_MNTH_ICM = TRUNC(MOD((TRUNC(MONTHS_BETWEEN(TO_DATE(#emymtEndDt#,'YYYYMMDD') + 1, TO_DATE(#emymtBgnnDt#,'YYYYMMDD')),0) ),12),0) /* 근무월수 */ -->
	    <!--        ,DUTY_YR_NUM = TRUNC(((TRUNC(MONTHS_BETWEEN(TO_DATE(#emymtEndDt#,'YYYYMMDD') + 1, TO_DATE(#emymtBgnnDt#,'YYYYMMDD')),0))/12),0) /* 근무년수 */ -->
			    ,DUTY_YR_NUM =  TRUNC((( TRUNC(TO_DATE(#emymtEndDt#,'YYYYMMDD'))- TRUNC(TO_DATE(#emymtBgnnDt#,'YYYYMMDD'))+1 ) * (SELECT MANGE_ITEM11 FROM BASS0300 WHERE COMM_CD = #cvsnRtoDivCd#)/100)/#yearDay#)
			    ,DUTY_MNTH_ICM =  TRUNC(MOD((( TRUNC(TO_DATE(#emymtEndDt#,'YYYYMMDD'))- TRUNC(TO_DATE(#emymtBgnnDt#,'YYYYMMDD'))+1 ) * (SELECT MANGE_ITEM11 FROM BASS0300 WHERE COMM_CD = #cvsnRtoDivCd#)/100),#yearDay#)/#monthDay#)
			    ,DUTY_DAY_NUM =  TRUNC(MOD(MOD((( TRUNC(TO_DATE(#emymtEndDt#,'YYYYMMDD'))- TRUNC(TO_DATE(#emymtBgnnDt#,'YYYYMMDD'))+1 ) * (SELECT MANGE_ITEM11 FROM BASS0300 WHERE COMM_CD = #cvsnRtoDivCd#)/100),#yearDay#),#monthDay#))
			    ,DUTY_TOT_DAY_NUM = TRUNC(( TRUNC(TO_DATE(#emymtEndDt#,'YYYYMMDD'))- TRUNC(TO_DATE(#emymtBgnnDt#,'YYYYMMDD'))+1 ) * (SELECT MANGE_ITEM11 FROM BASS0300 WHERE COMM_CD = #cvsnRtoDivCd#)/100)
			</isNotEmpty>
		</isNotEmpty>
		WHERE
			DPOB_CD = #dpobCd# /* 사업장코드 */
			AND SYSTEMKEY = #systemkey# /* SYSTEMKEY */
			AND EMYMT_SEIL_NUM = #emymtSeilNum# /* 고용일련번호 */
	</update>

	<update id="psnl0320DAO.updatePsnl0119" parameterClass="Psnl0119Vo">
		UPDATE PSNL0119 /* 경력 */
		SET
            DPOB_CD = #dpobCd#
            ,SYSTEMKEY = #systemkey#
		<isNotEmpty property="carrBgnnDt">
            ,CARR_BGNN_DT = #carrBgnnDt# /* 근무시작일자(경력시작일자) */
		</isNotEmpty>
		<isNotEmpty property="carrEndDt">
            ,CARR_END_DT = #carrEndDt# /* 근무종료일자(경력종료일자) */
		</isNotEmpty>
		<isNotEmpty property="dutyDeptNm">
			,DUTY_DEPT_NM = #dutyDeptNm# /* 근무부서명 */
		</isNotEmpty>
		<isNotEmpty property="carrDivCd">
			,CARR_DIV_CD = #carrDivCd# /* 경력구분코드 */
		</isNotEmpty>
		<isNotEmpty property="repbtyBusinNm">
			,REPBTY_BUSIN_NM = #repbtyBusinNm# /* 담당업무명 */
		</isNotEmpty>
		<isNotEmpty property="cvsnRtoDivCd">
			,CVSN_RTO_DIV_CD = #cvsnRtoDivCd# /* 경력인정 */
		</isNotEmpty>
		<isNotEmpty property="rcgtnMnthNum">
			,RCGTN_MNTH_NUM = #rcgtnMnthNum# /* 인정월수 */
		</isNotEmpty>
	    <isNotEmpty property="ajmtMnthNum">
			,AJMT_MNTH_NUM = #ajmtMnthNum# /* 가감월수 */
		</isNotEmpty>
		
		<isNotEmpty property="carrEndDt">
		    <isNotEmpty property="carrBgnnDt">
<!-- 			,DUTY_DAY_NUM = TRUNC(TO_DATE(#carrEndDt#,'YYYYMMDD'))-TRUNC(TO_DATE(#carrBgnnDt#,'YYYYMMDD'))+1 /* 근속일수(근무일수) */
			,DUTY_MNTH_ICM = TRUNC(MOD((TRUNC(MONTHS_BETWEEN(TO_DATE(#carrEndDt#,'YYYYMMDD') + 1, TO_DATE(#carrBgnnDt#,'YYYYMMDD')),0) ),12),0) /* 근무월수 */
			,DUTY_YR_NUM = TRUNC(((TRUNC(MONTHS_BETWEEN(TO_DATE(#carrEndDt#,'YYYYMMDD') + 1, TO_DATE(#carrBgnnDt#,'YYYYMMDD')),0))/12),0) /* 근무년수 */
			,DUTY_TOT_DAY_NUM = TRUNC(( TRUNC(TO_DATE(#carrEndDt#,'YYYYMMDD'))- TRUNC(TO_DATE(#carrBgnnDt#,'YYYYMMDD'))+1 ) * (SELECT REPLACE(COMM_CD_NM,'%','') COMM_CD_NM FROM BASS0300 WHERE COMM_CD = #cvsnRtoDivCd# AND COMM_CD_NM != '해당없음')/100)
 -->			
			
		    ,DUTY_YR_NUM =  CASE WHEN TRUNC((( (TRUNC(TO_DATE(#carrEndDt#,'YYYYMMDD'))- TRUNC(TO_DATE(#carrBgnnDt#,'YYYYMMDD'))+1) - (nvl(#ajmtMnthNum#,0)*#monthDay#) )
		                              * (SELECT MANGE_ITEM11 FROM BASS0300 WHERE COMM_CD = #cvsnRtoDivCd#)/100)/#yearDay#) > 0 
			                     THEN TRUNC((( (TRUNC(TO_DATE(#carrEndDt#,'YYYYMMDD'))- TRUNC(TO_DATE(#carrBgnnDt#,'YYYYMMDD'))+1) - (nvl(#ajmtMnthNum#,0)*#monthDay#) )
		                              * (SELECT MANGE_ITEM11 FROM BASS0300 WHERE COMM_CD = #cvsnRtoDivCd#)/100)/#yearDay#)
		                         ELSE 0
		                         END
			,DUTY_MNTH_ICM =  CASE WHEN TRUNC(MOD(((( TRUNC(TO_DATE(#carrEndDt#,'YYYYMMDD'))- TRUNC(TO_DATE(#carrBgnnDt#,'YYYYMMDD'))+1) - (nvl(#ajmtMnthNum#,0)*#monthDay#) ) 
			                            * (SELECT MANGE_ITEM11 FROM BASS0300 WHERE COMM_CD = #cvsnRtoDivCd#)/100),#yearDay#)/#monthDay#) > 0 
			                       THEN TRUNC(MOD(((( TRUNC(TO_DATE(#carrEndDt#,'YYYYMMDD'))- TRUNC(TO_DATE(#carrBgnnDt#,'YYYYMMDD'))+1) - (nvl(#ajmtMnthNum#,0)*#monthDay#) ) 
			                            * (SELECT MANGE_ITEM11 FROM BASS0300 WHERE COMM_CD = #cvsnRtoDivCd#)/100),#yearDay#)/#monthDay#)
			                       ELSE 0
			                       END 
			,DUTY_DAY_NUM =  CASE WHEN TRUNC(MOD(MOD(((( TRUNC(TO_DATE(#carrEndDt#,'YYYYMMDD'))- TRUNC(TO_DATE(#carrBgnnDt#,'YYYYMMDD'))+1) - (nvl(#ajmtMnthNum#,0)*#monthDay#) ) 
			                           * (SELECT MANGE_ITEM11 FROM BASS0300 WHERE COMM_CD = #cvsnRtoDivCd#)/100),#yearDay#),#monthDay#)) > 0
			                      THEN TRUNC(MOD(MOD(((( TRUNC(TO_DATE(#carrEndDt#,'YYYYMMDD'))- TRUNC(TO_DATE(#carrBgnnDt#,'YYYYMMDD'))+1) - (nvl(#ajmtMnthNum#,0)*#monthDay#) ) 
			                           * (SELECT MANGE_ITEM11 FROM BASS0300 WHERE COMM_CD = #cvsnRtoDivCd#)/100),#yearDay#),#monthDay#))
			                      ELSE 0
			                      END 
			
			,DUTY_TOT_DAY_NUM = CASE WHEN TRUNC((( TRUNC(TO_DATE(#carrEndDt#,'YYYYMMDD'))- TRUNC(TO_DATE(#carrBgnnDt#,'YYYYMMDD'))+1) - (nvl(#ajmtMnthNum#,0)*#monthDay#) ) 
			                              * (SELECT MANGE_ITEM11 FROM BASS0300 WHERE COMM_CD = #cvsnRtoDivCd#)/100) > 0
			                         THEN TRUNC((( TRUNC(TO_DATE(#carrEndDt#,'YYYYMMDD'))- TRUNC(TO_DATE(#carrBgnnDt#,'YYYYMMDD'))+1) - (nvl(#ajmtMnthNum#,0)*#monthDay#) ) 
			                              * (SELECT MANGE_ITEM11 FROM BASS0300 WHERE COMM_CD = #cvsnRtoDivCd#)/100)
			                         ELSE 0
			                         END
			</isNotEmpty>
		</isNotEmpty>  
		WHERE SYSTEMKEY = #systemkey#
		    AND DPOB_CD = #dpobCd#
		    AND CARR_RSPT_SEIL_NUM = #carrRsptSeilNum#/* 경력사항일련번호 */
	</update>

	<update id="psnl0320DAO.updatePsnl0122" parameterClass="Psnl0122Vo">
		UPDATE PSNL0122
		SET
			DPOB_CD = #dpobCd#
		<isNotEmpty property="dsnyActDsplDt">
		    ,DSNY_ACT_DSPL_DT = #dsnyActDsplDt# /*징계처분일자*/
		</isNotEmpty>
		<isNotEmpty property="dsnyActDivCd">
		    ,DSNY_ACT_DIV_CD = #dsnyActDivCd# /*징계구분코드*/
		</isNotEmpty>
		<isNotEmpty property="dsnyActNm">
		    ,DSNY_ACT_NM = #dsnyActNm# /*징계명*/
		</isNotEmpty>
		<isNotEmpty property="dsnyActReasCtnt">
		    ,DSNY_ACT_REAS_CTNT = #dsnyActReasCtnt# /*징계사유내용*/
		</isNotEmpty>
		<isNotEmpty property="dsnyActEctgOrgn">
		    ,DSNY_ACT_ECTG_ORGN = #dsnyActEctgOrgn# /*징계수행기관*/
		</isNotEmpty>
		<isNotEmpty property="dsnyActBgnnDt">
		    ,DSNY_ACT_BGNN_DT = #dsnyActBgnnDt# /*징계시작일자*/
		</isNotEmpty>
		<isNotEmpty property="dsnyActEndDt">
		    ,DSNY_ACT_END_DT = #dsnyActEndDt# /*징계종료일자*/
		</isNotEmpty>
		<isNotEmpty property="dsnyActAnstyDt">
		    ,DSNY_ACT_ANSTY_DT = #dsnyActAnstyDt# /*징계사면일자*/
		</isNotEmpty>
		<isNotEmpty property="dsnyActCtwpMnthIcm">
		    ,DSNY_ACT_CTWP_MNTH_ICM = #dsnyActCtwpMnthIcm# /*징계감봉월수*/
		</isNotEmpty>
		WHERE DPOB_CD = #dpobCd#
		    AND SYSTEMKEY = #systemkey#
		    AND DSNY_ACT_SEIL_NUM = #dsnyActSeilNum#
	</update>

	<select id="psnl0320DAO.getPyspReMrkSeilNum" parameterClass="Psnl0320Vo" resultClass="int">
	    SELECT NVL(MAX(PYSP_RE_MRK_SEIL_NUM),0)+1 FROM PSNL0320 WHERE DPOB_CD = #dpobCd# AND SYSTEMKEY = #systemkey#
	</select>

	<select id="psnl0320DAO.getLogSvcDysList" parameterClass="Psnl0320Vo" resultClass="egovMap">
SELECT 
	   <!-- TO_CHAR (TO_DATE (#pyspReMrkCalcDt#,'YYYYMMDD') - TRUNC(CC.ORI_CNT),'YYYYMMDD') AS LOG_STD_BGN_DT --> /* 근속기준시작일자*/
	   TO_CHAR (TO_DATE (#pyspReMrkCalcDt#,'YYYYMMDD') - TRUNC(CC.TOT_CNT),'YYYYMMDD') AS LOG_STD_BGN_DT /* 근속기준시작일자*/
	   
	   ,#pyspReMrkCalcDt# AS PYSP_RE_MRK_CALC_DT /* 호봉재획정계산일자*/
	   ,(SELECT COMM_CD FROM BASS0300 WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'A005' AND MANGE_ITEM12 = TO_CHAR (TRUNC(CC.TOT_CNT/#yearDay#))) AS PYSP_CD	/* 호봉코드*/
	   ,(SELECT COMM_CD FROM BASS0300 WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'A007' AND MANGE_ITEM01 = TO_CHAR (TRUNC(CC.TOT_CNT/#yearDay#))) AS LOG_SVC_YR_NUM_CD /* 근속년수코드*/
	   ,(SELECT COMM_CD FROM BASS0300 WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'A006' AND MANGE_ITEM01 = TO_CHAR (TRUNC(MOD(CC.TOT_CNT,#yearDay#)/#monthDay#))) AS LOG_SVC_MNTH_ICM_CD /* 근속월수코드*/
	   
	   ,CASE WHEN #calMode# = 'TRUNC' THEN  TRUNC(MOD (MOD (CC.TOT_CNT, #yearDay#), #monthDay#)) 
		     WHEN #calMode# = 'ROUND' THEN ROUND(MOD (MOD (CC.TOT_CNT, #yearDay#), #monthDay#)) 
		     WHEN #calMode# = 'CEIL' THEN CEIL(MOD (MOD (CC.TOT_CNT, #yearDay#), #monthDay#)) 
		     ELSE TRUNC(MOD (MOD (CC.TOT_CNT, #yearDay#), #monthDay#)) 
		     END AS LOG_SVC_DYS /* 근속일수 */
	   ,TRUNC(CC.TOT_CNT) AS TOT_LOG_SVC_DYS /*총근속일수*/
	   
	   ,(SELECT COMM_CD FROM BASS0300 WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'A007' AND MANGE_ITEM01 = TO_CHAR (TRUNC(CC.ORI_CNT/#yearDay#))) AS ORG_LOG_SVC_YR_CD /* 원근속년수코드*/
	   ,(SELECT COMM_CD FROM BASS0300 WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'A006' AND MANGE_ITEM01 = TO_CHAR (TRUNC(MOD(CC.ORI_CNT,#yearDay#)/#monthDay#))) AS ORG_LOG_SVC_MNTH_CD /* 원근속월수코드*/
	   
	   ,CASE WHEN #calMode# = 'TRUNC' THEN  TRUNC(MOD (MOD (CC.ORI_CNT, #yearDay#), #monthDay#)) 
		     WHEN #calMode# = 'ROUND' THEN ROUND(MOD (MOD (CC.ORI_CNT, #yearDay#), #monthDay#)) 
		     WHEN #calMode# = 'CEIL' THEN CEIL(MOD (MOD (CC.ORI_CNT, #yearDay#), #monthDay#)) 
		     ELSE TRUNC(MOD (MOD (CC.ORI_CNT, #yearDay#), #monthDay#)) 
		     END AS ORG_LOG_SVC_DYS /* 원근속일수 */
		     
		     
	   ,TRUNC(CC.ORI_CNT) AS ORG_TOT_LOG_SVC_DYS /*원총근속일수*/
	   
	   
	   ,TO_CHAR (TO_DATE (#pyspReMrkCalcDt#,'YYYYMMDD') - TRUNC(CC.TOT_CNT),'YYYYMMDD') AS RE_MRK_DT /* 재획정일자*/ 
	   
	   
	   ,TO_CHAR (ADD_MONTHS( TO_DATE (#pyspReMrkCalcDt#,'YYYYMMDD') , 12), 'YYYYMMDD') AS PMTN_SCDU_DT /* 승진예정일자*/ 
	   ,TO_CHAR (ADD_MONTHS( TO_DATE (#pyspReMrkCalcDt#,'YYYYMMDD') , 12), 'YYYYMMDD') AS PYSP_PRMTN_SCDU_DT /* 호봉승급예정일자*/
	   ,CC.EMYMT_RCGTN_LOG_SVC_YR_NUM 
	   ,CC.EMYMT_RCGTN_LOG_SVC_MNTH_NUM
	   ,CC.EMYMT_RCGTN_LOG_SVC_DYS
	   ,CC.CARR_RCGTN_LOG_SVC_YR_NUM
	   ,CC.CARR_RCGTN_LOG_SVC_MNTH_NUM
	   ,CC.CARR_RCGTN_LOG_SVC_DYS
	   ,CC.MITY_CARR_RCGTN_LOG_SVC_YR_NUM
	   ,CC.MITY_CARR_RCGTN_LOG_SVC_MNTH
	   ,CC.MITY_CARR_RCGTN_LOG_SVC_DYS
	   ,CC.DSNY_ACT_CTWP_MNTH_ICM
       ,CC.TOT_CNT
       ,CC.MITY_CARR_TOT_LOG_SVC_DYS
	FROM(

		    SELECT CASE WHEN (NVL(A.A_CNT,0) + NVL(B.B_CNT,0) + NVL(D.D_CNT,0)) - (NVL(C.C_CNT,0) * #monthDay#) > 0 THEN (NVL(A.A_CNT,0) + NVL(B.B_CNT,0) + NVL(D.D_CNT,0)) - (NVL(C.C_CNT,0)* #monthDay#)
		                ELSE 0 
		                END
		                 AS TOT_CNT /*총근속일수*/
		                
		           ,CASE WHEN (NVL(A.A_CNT,0) + NVL(B.B_CNT,0)) - (NVL(C.C_CNT,0) * #monthDay#) > 0 THEN (NVL(A.A_CNT,0) + NVL(B.B_CNT,0)) - (NVL(C.C_CNT,0)* #monthDay#)
		                ELSE 0 
		                END 
		                AS ORI_CNT /*원총근속일수*/     

		           , TRUNC(NVL(A.A_CNT,0)/ #yearDay#) AS EMYMT_RCGTN_LOG_SVC_YR_NUM 
		           , TRUNC(MOD (NVL(A.A_CNT,0), #yearDay#) / #monthDay#) AS EMYMT_RCGTN_LOG_SVC_MNTH_NUM
		           , CASE WHEN #calMode# = 'TRUNC' THEN  TRUNC(MOD (MOD (NVL(A.A_CNT,0), #yearDay#), #monthDay#)) 
		                  WHEN #calMode# = 'ROUND' THEN ROUND(MOD (MOD (NVL(A.A_CNT,0), #yearDay#), #monthDay#)) 
		                  WHEN #calMode# = 'CEIL' THEN CEIL(MOD (MOD (NVL(A.A_CNT,0), #yearDay#), #monthDay#)) 
		                  ELSE TRUNC(MOD (MOD (NVL(A.A_CNT,0), #yearDay#), #monthDay#)) 
		                  END AS EMYMT_RCGTN_LOG_SVC_DYS
		           
		           , TRUNC(NVL(B.B_CNT,0)/ #yearDay#) AS CARR_RCGTN_LOG_SVC_YR_NUM 
		           , TRUNC(MOD (NVL(B.B_CNT,0), #yearDay#) / #monthDay#) AS CARR_RCGTN_LOG_SVC_MNTH_NUM
		           , CASE WHEN #calMode# = 'TRUNC' THEN  TRUNC(MOD (MOD (NVL(B.B_CNT,0), #yearDay#), #monthDay#)) 
		                  WHEN #calMode# = 'ROUND' THEN ROUND(MOD (MOD (NVL(B.B_CNT,0), #yearDay#), #monthDay#)) 
		                  WHEN #calMode# = 'CEIL' THEN CEIL(MOD (MOD (NVL(B.B_CNT,0), #yearDay#), #monthDay#)) 
		                  ELSE TRUNC(MOD (MOD (NVL(B.B_CNT,0), #yearDay#), #monthDay#)) 
		                  END AS CARR_RCGTN_LOG_SVC_DYS

		           , NVL(C.C_CNT,0) AS DSNY_ACT_CTWP_MNTH_ICM
		           
		           , TRUNC(NVL(D.D_CNT,0)/ #yearDay#) AS MITY_CARR_RCGTN_LOG_SVC_YR_NUM 
		           , TRUNC(MOD (NVL(D.D_CNT,0), #yearDay#) / #monthDay#) AS MITY_CARR_RCGTN_LOG_SVC_MNTH
		           , CASE WHEN #calMode# = 'TRUNC' THEN  TRUNC(MOD (MOD (NVL(D.D_CNT,0), #yearDay#), #monthDay#)) 
		                  WHEN #calMode# = 'ROUND' THEN ROUND(MOD (MOD (NVL(D.D_CNT,0), #yearDay#), #monthDay#)) 
		                  WHEN #calMode# = 'CEIL' THEN CEIL(MOD (MOD (NVL(D.D_CNT,0), #yearDay#), #monthDay#)) 
		                  ELSE TRUNC(MOD (MOD (NVL(D.D_CNT,0), #yearDay#), #monthDay#)) 
		                  END AS MITY_CARR_RCGTN_LOG_SVC_DYS
		           , TRUNC(NVL(D.D_CNT,0)) AS MITY_CARR_TOT_LOG_SVC_DYS
		             
		    FROM 
		     PSNL0100 E
		    ,(SELECT DPOB_CD, SYSTEMKEY, NVL(SUM(DUTY_TOT_DAY_NUM),0) AS A_CNT FROM PSNL0110  WHERE DPOB_CD = #dpobCd# AND SYSTEMKEY = #systemkey#  GROUP BY DPOB_CD , SYSTEMKEY )A 
		    ,(SELECT DPOB_CD, SYSTEMKEY, NVL(SUM(DUTY_TOT_DAY_NUM),0) AS B_CNT FROM PSNL0119 WHERE DPOB_CD = #dpobCd# AND SYSTEMKEY = #systemkey#  GROUP BY DPOB_CD , SYSTEMKEY )B
		    ,(SELECT DPOB_CD, SYSTEMKEY, NVL(SUM(DSNY_ACT_CTWP_MNTH_ICM),0) AS C_CNT FROM PSNL0122 WHERE DPOB_CD = #dpobCd# AND SYSTEMKEY = #systemkey#  GROUP BY DPOB_CD , SYSTEMKEY )C
		    ,(SELECT            
		           CASE WHEN  (SELECT COMM_CD FROM BASS0300 WHERE COMM_CD = #servcRcgtnPridCd#) = 'A029000A' THEN (TO_DATE(D.DSAGE_DT,'YYYYMMDD')- TO_DATE(D.ENRLNT_DT,'YYYYMMDD')+1 ) 
		                 WHEN  (SELECT MANGE_ITEM11 FROM BASS0300 WHERE COMM_CD = #servcRcgtnPridCd#) = 'A0290000' THEN 0
		                 ELSE (
		                       CASE WHEN (TO_DATE(D.DSAGE_DT,'YYYYMMDD')- TO_DATE(D.ENRLNT_DT,'YYYYMMDD')+1 ) > ((SELECT MANGE_ITEM11 FROM BASS0300 WHERE COMM_CD = #servcRcgtnPridCd#) * #monthDay#)
		                                   THEN ((SELECT MANGE_ITEM11 FROM BASS0300 WHERE COMM_CD = #servcRcgtnPridCd#) * #monthDay#)
		                            ELSE (TO_DATE(D.DSAGE_DT,'YYYYMMDD')- TO_DATE(D.ENRLNT_DT,'YYYYMMDD')+1 )
		                            END
		                       )
		                 END AS D_CNT  , SYSTEMKEY, DPOB_CD
		        FROM PSNL0112 D                       
		        WHERE D.DPOB_CD = #dpobCd#
		          AND D.SYSTEMKEY =#systemkey#   )D
		          
		         WHERE E.DPOB_CD = #dpobCd#
		           AND E.SYSTEMKEY = #systemkey#  
		           AND E.DPOB_CD = A.DPOB_CD(+)
		           AND E.SYSTEMKEY = A.SYSTEMKEY(+)
		           AND E.DPOB_CD = B.DPOB_CD(+)
		           AND E.SYSTEMKEY = B.SYSTEMKEY(+)
		           AND E.DPOB_CD = C.DPOB_CD(+)
		           AND E.SYSTEMKEY = C.SYSTEMKEY(+)
		           AND E.DPOB_CD = D.DPOB_CD(+)
		           AND E.SYSTEMKEY = D.SYSTEMKEY(+)
	)CC

<!-- 		SELECT NVL(SUM(A.DUTY_TOT_DAY_NUM),0) + NVL(SUM(B.DUTY_TOT_DAY_NUM),0) AS LOG_SVC_DYS
				,TRUNC((NVL(SUM(A.DUTY_TOT_DAY_NUM),0) + NVL(SUM(B.DUTY_TOT_DAY_NUM),0) - NVL(SUM(C.DSNY_ACT_CTWP_MNTH_ICM),0))/30.5) AS LOG_SVC_MNTH_ICM
				,TRUNC(((NVL (SUM (A.DUTY_TOT_DAY_NUM), 0) + NVL (SUM (B.DUTY_TOT_DAY_NUM), 0) - NVL (SUM (C.DSNY_ACT_CTWP_MNTH_ICM), 0)) / 30.5)/12) AS LOG_SVC_YR_NUM_CD
		FROM 
		     PSNL0110 A
		    ,PSNL0119 B
		    ,PSNL0122 C
		    ,PSNL0112 D
		WHERE A.DPOB_CD = #dpobCd#
		    AND A.SYSTEMKEY = #systemkey#
		    AND A.DPOB_CD = B.DPOB_CD
		    AND A.SYSTEMKEY = B.SYSTEMKEY
		    AND A.DPOB_CD = C.DPOB_CD
		    AND A.SYSTEMKEY = C.SYSTEMKEY  -->
	</select>

	<insert id="psnl0320DAO.savePsnl0320" parameterClass="Psnl0320Vo">
		INSERT INTO PSNL0320
		(
			DPOB_CD
			,SYSTEMKEY
			,PYSP_RE_MRK_SEIL_NUM
			,LOG_STD_BGN_DT
			,PYSP_RE_MRK_CALC_DT /* 탭상단계산기준일 */
			,PYSP_CD
			,LOG_SVC_YR_NUM_CD /* 근속년수코드 */
			,LOG_SVC_MNTH_ICM_CD /* 근속월수코드 */
			,LOG_SVC_DYS /* 근속일수 */
			,TOT_LOG_SVC_DYS
			,ORG_LOG_SVC_YR_CD
			,ORG_LOG_SVC_MNTH_CD
			,ORG_LOG_SVC_DYS
			,ORG_TOT_LOG_SVC_DYS
			,RE_MRK_DT
			,PMTN_SCDU_DT
			,REYMN_SCDU_DT
			,PYSP_PRMTN_SCDU_DT
			,EMYMT_RCGTN_LOG_SVC_YR_NUM
			,EMYMT_RCGTN_LOG_SVC_MNTH_NUM
			,EMYMT_RCGTN_LOG_SVC_DYS
			,MITY_CARR_RCGTN_LOG_SVC_YR_NUM
			,MITY_CARR_RCGTN_LOG_SVC_MNTH
			,MITY_CARR_RCGTN_LOG_SVC_DYS
			,CARR_RCGTN_LOG_SVC_YR_NUM
			,CARR_RCGTN_LOG_SVC_MNTH_NUM
			,CARR_RCGTN_LOG_SVC_DYS
			,DSNY_ACT_CTWP_MNTH_ICM
			,KYBDR
		    ,INPT_DT
		    ,ISMT
		    ,INPT_ADDR
		    ,REVN_DT
		    ,REVN_ADDR 

		)VALUES
		(
			#dpobCd#
			,#systemkey#
			,#pyspReMrkSeilNum#
			,#logStdBgnDt#
			,#pyspReMrkCalcDt# /* 상단계산기준일 */
			,#pyspCd#
			,#logSvcYrNumCd# /* 근속년수코드 */
			,#logSvcMnthIcmCd# /* 근속월수코드 */
			,#logSvcDys# /* 근속일수 */
			,#totLogSvcDys#
			,#orgLogSvcYrCd#
			,#orgLogSvcMnthCd#
			,#orgLogSvcDys#
			,#orgTotLogSvcDys#
			,#reMrkDt#
			,#pmtnScduDt#
			,#reymnScduDt#
			,#pyspPrmtnScduDt#
			,#emymtRcgtnLogSvcYrNum#
			,#emymtRcgtnLogSvcMnthNum#
			,#emymtRcgtnLogSvcDys#
			,#mityCarrRcgtnLogSvcYrNum#
			,#mityCarrRcgtnLogSvcMnth#
			,#mityCarrRcgtnLogSvcDys#
			,#carrRcgtnLogSvcYrNum#
			,#carrRcgtnLogSvcMnthNum#
			,#carrRcgtnLogSvcDys#
			,#dsnyActCtwpMnthIcm#
			,#kybdr#
		    ,TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
		    ,#ismt#
		    ,#inptAddr#
		    ,TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
		    ,#revnAddr# 
		)
	</insert>

<select id="psnl0320DAO.getPsnl0320ListButtomResult" parameterClass="Psnl0320Vo" resultClass="egovMap">
		SELECT
		    DPOB_CD /* 사업장코드 */
		    ,SYSTEMKEY /* 시스템키 */
		    ,PYSP_RE_MRK_SEIL_NUM /* 호봉재획정일련번호 */
		    ,LOG_STD_BGN_DT /* 근속기준시작일자 */
		    ,PYSP_RE_MRK_CALC_DT /* 호봉재획정계산일자 */
		    
		    ,PYSP_CD /* 호봉코드 */
		    ,fcBass0300ITEMNM(DPOB_CD,PYSP_CD,'12') AS PYSP_NM
		    
		    ,fcBass0300ITEMNM(DPOB_CD,(SELECT A.PYSP_CD FROM PSNL0100 A WHERE A.DPOB_CD = #dpobCd# AND A.SYSTEMKEY = #systemkey#),'12') AS M_PYSP_NM
		    
		    
		    ,LOG_SVC_YR_NUM_CD /* 근속년수코드 */
		    ,fcBass0300ITEMNM(DPOB_CD,LOG_SVC_YR_NUM_CD,'1') AS LOG_SVC_YR_NUM_NM
		    
		    ,LOG_SVC_MNTH_ICM_CD /* 근속월수코드 */
		    ,fcBass0300ITEMNM(DPOB_CD,LOG_SVC_MNTH_ICM_CD,'1') AS LOG_SVC_MNTH_ICM_NM
		    
		    
		    ,LOG_SVC_DYS /* 근속일수 */
		    ,TOT_LOG_SVC_DYS /* 총근속일수 */
		    
		    ,ORG_LOG_SVC_YR_CD /* 원근속년수코드 */
		    ,fcBass0300ITEMNM(DPOB_CD,ORG_LOG_SVC_YR_CD,'1') AS ORG_LOG_SVC_YR_NM
		    
		    ,ORG_LOG_SVC_MNTH_CD /* 원근속월수코드 */
		    ,fcBass0300ITEMNM(DPOB_CD,ORG_LOG_SVC_MNTH_CD,'1') AS ORG_LOG_SVC_MNTH_NM
		    
		    ,ORG_LOG_SVC_DYS /* 원근속일수 */
		    ,ORG_TOT_LOG_SVC_DYS /* 원총근속일수 */
		    ,RE_MRK_DT /* 재획정일자 */
		    ,PMTN_SCDU_DT /* 승진예정일자 */
		    ,REYMN_SCDU_DT /* 재고용예정일자 */
		    ,PYSP_PRMTN_SCDU_DT /* 호봉승급예정일자 */
		    ,EMYMT_RCGTN_LOG_SVC_YR_NUM /* 고용인정근속년수 */
		    ,EMYMT_RCGTN_LOG_SVC_MNTH_NUM /* 고용인정근속월수 */
		    ,EMYMT_RCGTN_LOG_SVC_DYS /* 고용인정근속일수 */
		    
		    
		    ,MITY_CARR_RCGTN_LOG_SVC_YR_NUM /* 군경력인정근속년수 */
		    ,MITY_CARR_RCGTN_LOG_SVC_MNTH /* 군경력인정근속월수 */
		    ,MITY_CARR_RCGTN_LOG_SVC_DYS /* 군경력인정근속일수 */
		    	    
		    ,(SELECT A.COMM_CD FROM BASS0300 A WHERE A.DPOB_CD = DPOB_CD AND A.RPSTTV_CD = 'A007' AND A.MANGE_ITEM01 = MITY_CARR_RCGTN_LOG_SVC_YR_NUM) AS MITY_CARR_LOG_SVC_YR_NUM_CD                  
            ,(SELECT A.COMM_CD FROM BASS0300 A WHERE A.DPOB_CD = DPOB_CD AND A.RPSTTV_CD = 'A006' AND A.MANGE_ITEM01 = MITY_CARR_RCGTN_LOG_SVC_MNTH) AS MITY_CARR_LOG_SVC_MNTH_NUM_CD
		    
		    ,CARR_RCGTN_LOG_SVC_YR_NUM /* 경력인정근속년수 */
		    ,CARR_RCGTN_LOG_SVC_MNTH_NUM /* 경력인정근속월수 */
		    ,CARR_RCGTN_LOG_SVC_DYS /* 경력인정근속일수 */
		    ,DSNY_ACT_CTWP_MNTH_ICM /* 징계감봉월수 */
		    ,KYBDR /* 입력자 */
		    ,INPT_DT /* 입력일자 */
		    ,INPT_ADDR /* 입력주소 */
		    ,ISMT /* 수정자 */
		    ,REVN_DT /* 수정일자 */
		    ,REVN_ADDR /* 수정주소 */
		FROM PSNL0320 
		WHERE DPOB_CD = #dpobCd#
			AND SYSTEMKEY = #systemkey#

		   <isNotEmpty prepend="AND" property="pyspReMrkSeilNum">
			 PYSP_RE_MRK_SEIL_NUM = #pyspReMrkSeilNum#
		   </isNotEmpty>
		   <isEmpty prepend="AND" property="pyspReMrkSeilNum">
		     PYSP_RE_MRK_SEIL_NUM = ( SELECT PYSP_RE_MRK_SEIL_NUM FROM PSNL0320 WHERE DPOB_CD = #dpobCd# AND SYSTEMKEY = #systemkey# AND ROWNUM = 1 ORDER BY PYSP_RE_MRK_SEIL_NUM DESC)
		   </isEmpty>
			
			
			
	</select>

	<select id="psnl0320DAO.getPsnl0320ListButtomCnt" parameterClass="Psnl0320Vo" resultClass="int">
		SELECT
			COUNT(*)
		FROM PSNL0320
		WHERE DPOB_CD = #dpobCd#
			AND SYSTEMKEY = #systemkey#
		ORDER BY PYSP_RE_MRK_SEIL_NUM DESC
	</select>

	<select id="psnl0320DAO.getPsnl0320ListButtom" parameterClass="Psnl0320Vo" resultClass="egovMap">
		SELECT
		    DPOB_CD /* 사업장코드 */
		    ,SYSTEMKEY /* 시스템키 */
		    ,PYSP_RE_MRK_SEIL_NUM /* 호봉재획정일련번호 */
		    ,LOG_STD_BGN_DT /* 근속기준시작일자 */
		    ,PYSP_RE_MRK_CALC_DT /* 호봉재획정계산일자 */
		    
		    ,PYSP_CD /* 호봉코드 */
		    ,fcBass0300ITEMNM(DPOB_CD,PYSP_CD,'12') AS PYSP_NM
		    
		    ,fcBass0300ITEMNM(DPOB_CD,(SELECT A.PYSP_CD FROM PSNL0100 A WHERE A.DPOB_CD = #dpobCd# AND A.SYSTEMKEY = #systemkey#),'12') AS M_PYSP_NM
		    
		    
		    ,LOG_SVC_YR_NUM_CD /* 근속년수코드 */
		    ,fcBass0300ITEMNM(DPOB_CD,LOG_SVC_YR_NUM_CD,'1') AS LOG_SVC_YR_NUM_NM
		    
		    ,LOG_SVC_MNTH_ICM_CD /* 근속월수코드 */
		    ,fcBass0300ITEMNM(DPOB_CD,LOG_SVC_MNTH_ICM_CD,'1') AS LOG_SVC_MNTH_ICM_NM
		    
		    
		    ,LOG_SVC_DYS /* 근속일수 */
		    ,TOT_LOG_SVC_DYS /* 총근속일수 */
		    
		    ,ORG_LOG_SVC_YR_CD /* 원근속년수코드 */
		    ,fcBass0300ITEMNM(DPOB_CD,ORG_LOG_SVC_YR_CD,'1') AS ORG_LOG_SVC_YR_NM
		    
		    ,ORG_LOG_SVC_MNTH_CD /* 원근속월수코드 */
		    ,fcBass0300ITEMNM(DPOB_CD,ORG_LOG_SVC_MNTH_CD,'1') AS ORG_LOG_SVC_MNTH_NM
		    
		    ,ORG_LOG_SVC_DYS /* 원근속일수 */
		    ,ORG_TOT_LOG_SVC_DYS /* 원총근속일수 */
		    ,RE_MRK_DT /* 재획정일자 */
		    ,PMTN_SCDU_DT /* 승진예정일자 */
		    ,REYMN_SCDU_DT /* 재고용예정일자 */
		    ,PYSP_PRMTN_SCDU_DT /* 호봉승급예정일자 */
		    ,EMYMT_RCGTN_LOG_SVC_YR_NUM /* 고용인정근속년수 */
		    ,EMYMT_RCGTN_LOG_SVC_MNTH_NUM /* 고용인정근속월수 */
		    ,EMYMT_RCGTN_LOG_SVC_DYS /* 고용인정근속일수 */
		    ,MITY_CARR_RCGTN_LOG_SVC_YR_NUM /* 군경력인정근속년수 */
		    ,MITY_CARR_RCGTN_LOG_SVC_MNTH /* 군경력인정근속월수 */
		    ,MITY_CARR_RCGTN_LOG_SVC_DYS /* 군경력인정근속일수 */
		    ,CARR_RCGTN_LOG_SVC_YR_NUM /* 경력인정근속년수 */
		    ,CARR_RCGTN_LOG_SVC_MNTH_NUM /* 경력인정근속월수 */
		    ,CARR_RCGTN_LOG_SVC_DYS /* 경력인정근속일수 */
		    ,DSNY_ACT_CTWP_MNTH_ICM /* 징계감봉월수 */
		    ,KYBDR /* 입력자 */
		    ,INPT_DT /* 입력일자 */
		    ,INPT_ADDR /* 입력주소 */
		    ,ISMT /* 수정자 */
		    ,REVN_DT /* 수정일자 */
		    ,REVN_ADDR /* 수정주소 */
		FROM PSNL0320 
		WHERE DPOB_CD = #dpobCd#
			AND SYSTEMKEY = #systemkey#
		
		
		ORDER BY PYSP_RE_MRK_SEIL_NUM DESC
		
		
		
		
		
	</select>

	<select id="psnl0320DAO.selectPsnl0320" parameterClass="hashMap" resultClass="hashMap">
		<![CDATA[
		SELECT
		    DPOB_CD /* 사업장코드 */
		    ,SYSTEMKEY /* 시스템키 */
		    ,PYSP_RE_MRK_SEIL_NUM /* 호봉재획정일련번호 */
		    ,LOG_STD_BGN_DT /* 근속기준시작일자 */
		    ,PYSP_RE_MRK_CALC_DT /* 호봉재획정계산일자 */
		    ,PYSP_CD /* 호봉코드 */
		    ,LOG_SVC_YR_NUM_CD /* 근속년수코드 */
		    ,LOG_SVC_MNTH_ICM_CD /* 근속월수코드 */
		    ,LOG_SVC_DYS /* 근속일수 */
		    ,TOT_LOG_SVC_DYS /* 총근속일수 */
		    ,ORG_LOG_SVC_YR_CD /* 원근속년수코드 */
		    ,ORG_LOG_SVC_MNTH_CD /* 원근속월수코드 */
		    ,ORG_LOG_SVC_DYS /* 원근속일수 */
		    ,ORG_TOT_LOG_SVC_DYS /* 원총근속일수 */
		    ,RE_MRK_DT /* 재획정일자 */
		    ,PMTN_SCDU_DT /* 승진예정일자 */
		    ,REYMN_SCDU_DT /* 재고용예정일자 */
		    ,PYSP_PRMTN_SCDU_DT /* 호봉승급예정일자 */
		    ,EMYMT_RCGTN_LOG_SVC_YR_NUM /* 고용인정근속년수 */
		    ,EMYMT_RCGTN_LOG_SVC_MNTH_NUM /* 고용인정근속월수 */
		    ,EMYMT_RCGTN_LOG_SVC_DYS /* 고용인정근속일수 */
		    ,MITY_CARR_RCGTN_LOG_SVC_YR_NUM /* 군경력인정근속년수 */
		    ,MITY_CARR_RCGTN_LOG_SVC_MNTH /* 군경력인정근속월수 */
		    ,MITY_CARR_RCGTN_LOG_SVC_DYS /* 군경력인정근속일수 */
		    ,CARR_RCGTN_LOG_SVC_YR_NUM /* 경력인정근속년수 */
		    ,CARR_RCGTN_LOG_SVC_MNTH_NUM /* 경력인정근속월수 */
		    ,CARR_RCGTN_LOG_SVC_DYS /* 경력인정근속일수 */
		    ,DSNY_ACT_CTWP_MNTH_ICM /* 징계감봉월수 */
		    ,KYBDR /* 입력자 */
		    ,INPT_DT /* 입력일자 */
		    ,INPT_ADDR /* 입력주소 */
		    ,ISMT /* 수정자 */
		    ,REVN_DT /* 수정일자 */
		    ,REVN_ADDR /* 수정주소 */
		FROM PSNL0320
		WHERE DPOB_CD = #dpobCd#
			AND SYSTEMKEY = #systemkey#
    		AND ROWNUM = 1
		ORDER BY PYSP_RE_MRK_SEIL_NUM DESC
		]]>
	</select>
	
	<select id="psnl0320DAO.selectXlsPsnl0320List" parameterClass="psnl0320SrhVO" resultClass="egovMap">
	SELECT AA.*, ROWNUM RNUM
	FROM(
	    SELECT fcBass0400CDNM(A.DPOB_CD, A.DEPT_CD,'2') AS DEPT_NM
        , A.HAN_NM
        , CASE WHEN NVL(A.RE_MRK_DT,0) = 0 THEN ''
                      ELSE SUBSTR(A.RE_MRK_DT,1,4)||'년'||SUBSTR(A.RE_MRK_DT,5,2)||'월'||SUBSTR(A.RE_MRK_DT,7,2)||'일'                                   
                      END AS RE_MRK_DT /*군경력반영 재획정*/
        
        , CASE WHEN NVL(A.EMYMT_BGNN_DT,0) = 0 THEN ''
                      ELSE SUBSTR(A.EMYMT_BGNN_DT,1,4)||'년'||SUBSTR(A.EMYMT_BGNN_DT,5,2)||'월'||SUBSTR(A.EMYMT_BGNN_DT,7,2)||'일'                                   
                      END AS EMYMT_BGNN_DT /*당초호봉획정 시점*/       
                                                                
        , B.MITY_CARR_TOT_LOG_SVC_DYS /*군경력반영기간(일수)*/
        , NVL(fcBass0300ITEMNM(A.DPOB_CD,B.MITY_CARR_LOG_SVC_YR_NUM_CD,'1'),0) AS MITY_CARR_LOG_SVC_YR_NUM /*군경력근속년수*/
        , NVL(fcBass0300ITEMNM(A.DPOB_CD,B.MITY_CARR_LOG_SVC_MNTH_NUM_CD,'1'),0) AS MITY_CARR_LOG_SVC_MNTH_NUM /*군경력근속월수*/
        , NVL(B.MITY_CARR_LOG_SVC_DYS,0) AS MITY_CARR_LOG_SVC_DYS /*군경력근속일수*/
        , NVL(fcBass0300ITEMNM(A.DPOB_CD,B.MITY_CARR_LOG_SVC_YR_NUM_CD,'1'),0)||'년'||NVL(fcBass0300ITEMNM(A.DPOB_CD,B.MITY_CARR_LOG_SVC_MNTH_NUM_CD,'1'),0)||'개월'||NVL(B.MITY_CARR_LOG_SVC_DYS,0)||'일' AS MITY_TERM      
        , CASE WHEN NVL(B.ENRLNT_DT,0) = 0 THEN ''
               ELSE SUBSTR(B.ENRLNT_DT,1,4)||'-'||SUBSTR(B.ENRLNT_DT,5,2)||'-'||SUBSTR(B.ENRLNT_DT,7,2)
               END AS ENRLNT_DT
        , CASE WHEN NVL(B.DSAGE_DT,0) = 0 THEN ''
               ELSE SUBSTR(B.DSAGE_DT,1,4)||'-'||SUBSTR(B.DSAGE_DT,5,2)||'-'||SUBSTR(B.DSAGE_DT,7,2)
               END AS DSAGE_DT
        , A.LOG_SVC_YR_NUM_CD
        , A.LOG_SVC_MNTH_ICM_CD
        , A.LOG_SVC_DYS
        , NVL(fcBass0300ITEMNM(A.DPOB_CD,A.LOG_SVC_YR_NUM_CD,'1'),0)||'년'||NVL(fcBass0300ITEMNM(A.DPOB_CD,A.LOG_SVC_MNTH_ICM_CD,'1'),0)||'월'||NVL(A.LOG_SVC_DYS,0)||'일' AS LOG_SVC_TERM
        ,fcBass0300ITEMNM(A.DPOB_CD,A.PYSP_CD,'12') AS PYSP_NM
        ,SUBSTR(PYSP_PRMTN_SCDU_DT,5,2) AS PYSP_PRMTN_SCDU_MNTH /*정기승급월*/ 
    FROM PSNL0100 A
        ,PSNL0112 B 
        ,PAYR0500 C
    WHERE A.DPOB_CD = B.DPOB_CD
      AND A.SYSTEMKEY = B.SYSTEMKEY
      AND A.DPOB_CD = C.DPOB_CD
      AND A.SYSTEMKEY = C.SYSTEMKEY
      
      <isNotEmpty prepend="AND" property="dpobCd" >
						 	A.DPOB_CD=#dpobCd#
      </isNotEmpty>
      <isNotEmpty prepend="AND" property="mangeDeptCd" >
						 	A.DEPT_CD=#mangeDeptCd#
      </isNotEmpty>
      <isNotEmpty prepend="AND" property="repbtyBusinDivCd" >
         A.REPBTY_BUSIN_DIV_CD=#repbtyBusinDivCd#
      </isNotEmpty>
					     AND EXISTS  (
	                         SELECT  C.DPOB_CD,
	                                 C.DTIL_OCCU_INTTN_CD,
	                                 C.TYP_OCCU_CD,
	                                 C.DEPT_CD FROM 
	                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' ))) C
	                                            WHERE     C.DPOB_CD = A.DPOB_CD
							                        AND C.DEPT_CD = A.CURR_AFFN_DEPT_CD
							                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(A.TYP_OCCU_CD,'TT') 
	                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(A.DTIL_OCCU_INTTN_CD,'TT')
	                                               <isNotEmpty property="deptCd" prepend="AND">
													<![CDATA[
													 C.DEPT_CD
													]]>
													<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
													 #deptCdArr[]#
													</iterate>
													</isNotEmpty> 
	                                          )
	                    <isNotEmpty prepend="AND" property="businCd" >
						 	A.BUSIN_CD=#businCd#
					    </isNotEmpty> 
						<isNotEmpty prepend="AND" property="payrMangDeptCd" >
						 	C.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
					    </isNotEmpty> 
					    <isNotEmpty prepend="AND" property="emymtDivCd" >
						 	A.EMYMT_DIV_CD=#emymtDivCd#
						</isNotEmpty>
						<isNotEmpty property="hdofcCodtnCd" prepend="AND">
							<![CDATA[
								 A.HDOFC_CODTN_CD
							]]>
							<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
								 #hdofcCodtnCdArr[]#
							</iterate>
						</isNotEmpty>  
					    <isNotEmpty property="typOccuCd" prepend="AND">
							<![CDATA[
								 A.TYP_OCCU_CD
							]]>
							<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
							 	 #typOccuCdArr[]#
							</iterate>
						</isNotEmpty>  
						<isNotEmpty property="dtilOccuInttnCd" prepend="AND">
							<![CDATA[
								 A.DTIL_OCCU_INTTN_CD
							]]>
							<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
								 #dtilOccuInttnCdArr[]#
							</iterate>
						</isNotEmpty>  
					    <isNotEmpty prepend="AND" property="systemkey" >
						 	A.SYSTEMKEY=#systemkey#
					    </isNotEmpty>  
					    <isNotEmpty prepend="AND" property="hanNm" >
						 	A.HAN_NM LIKE '%' || #hanNm# || '%'
					    </isNotEmpty>                        
						ORDER BY 
							A.DPOB_CD DESC
							, (SELECT LPAD(DEPT_RANK,5,'0')  
	                                   FROM BASS0400 DD
	                                   WHERE DD.DEPT_CD = A.CURR_AFFN_DEPT_CD
	                                     AND DD.DPOB_CD = A.DPOB_CD) ASC
	                        , A.RESN_REGN_NUM ASC
						    , A.SYSTEMKEY DESC
			)AA
	</select>
	
	
</sqlMap>