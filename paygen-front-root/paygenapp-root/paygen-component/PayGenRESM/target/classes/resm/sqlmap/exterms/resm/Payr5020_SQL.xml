<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="Payr5020">
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="bass0350VO" type="com.app.exterms.payroll.server.vo.Bass0350VO"/>
	<typeAlias  alias="bass0350SrhVO" type="com.app.exterms.payroll.server.vo.Bass0350SrhVO"/>
		
	
	<update id="payr5020DAO.updateBass0350" parameterClass="bass0350VO">
		UPDATE BASS0350
			SET 
				 DTIL_OCCU_JBFML_DIV_CD = #dtilOccuJbfmlDivCd# 
				, ISMT = #ismt#
				, REVN_DT = TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR = #revnAddr#
		WHERE DPOB_CD = #dpobCd# 
			AND DTIL_OCCU_INTTN_CD = #dtilOccuInttnCd# 
	</update>	
		
	
	
	<select id="payr5020DAO.selectBass0350TopList" parameterClass="bass0350SrhVO" resultClass="egovMap">
		SELECT * FROM (
			SELECT A.*, ROWNUM RNUM FROM (
						SELECT C.DPOB_CD,
						       (SELECT B.DPOB_NM FROM BASS0100 B WHERE B.DPOB_CD = C.DPOB_CD ) AS DPOB_NM,
		                       C.TYP_OCCU_CD,
		                       FCBASS0320CDNM(C.DPOB_CD, C.TYP_OCCU_CD ) as TYP_OCCU_NM,
		                       C.PYSP_GRDE_CD,
		                       FCBASS0300CDNM(C.DPOB_CD, C.PYSP_GRDE_CD ) as PYSP_GRDE_NM,
		                       C.DTIL_OCCU_INTTN_CD,
		                       C.DTIL_OCCU_CLS_DIV_CD,
		                       C.DTIL_OCCU_CLS_NM,
		                       C.DTIL_OCCU_CLS_CTNT,
		                       C.DTIL_OCCU_CLS_USE_YN,
		                       C.CHNG_TGT_YN,
		                       C.KYBDR,
		                       C.INPT_DT,
		                       C.INPT_ADDR,
		                       C.ISMT,
		                       C.REVN_DT,
		                       C.REVN_ADDR,
		                       C.DTIL_OCCU_CLS_ORD,
		                       C.DTIL_OCCU_JBFML_DIV_CD,
		                       FCBASS0300CDNM(C.DPOB_CD, C.DTIL_OCCU_JBFML_DIV_CD ) as DTIL_OCCU_JBFML_DIV_NM,
		                       C.BGG_LOG_SVC_YR_NUM_CD,
		                       FCBASS0300CDNM(C.DPOB_CD, C.BGG_LOG_SVC_YR_NUM_CD ) as BGG_LOG_SVC_YR_NUM_NM 
						  FROM BASS0350 C
						WHERE 1=1
						<isNotNull property="dpobCd">
					    <isNotEmpty property="dpobCd">
					        AND C.DPOB_CD = #dpobCd#
					    </isNotEmpty>
						</isNotNull>
						<isNotNull property="dtilOccuJbfmlDivCd">
							<isNotEmpty property="dtilOccuJbfmlDivCd">
							    AND C.DTIL_OCCU_JBFML_DIV_CD = #dtilOccuJbfmlDivCd#
							</isNotEmpty>
						</isNotNull>
						
						<isNotNull property="dtilOccuClsNm">
							<isNotEmpty property="dtilOccuClsNm">
							    AND C.DTIL_OCCU_CLS_NM LIKE '%' || #dtilOccuClsNm# || '%'
							</isNotEmpty>
						</isNotNull>
						
						ORDER BY C.DPOB_CD, C.TYP_OCCU_CD, C.DTIL_OCCU_CLS_ORD ASC
				<![CDATA[					
			) A WHERE ROWNUM <= #lastIndex#
		)WHERE RNUM >= #firstIndex#
		]]>
	</select>	
	
	<select id="payr5020DAO.selectBass0350TopListTotCnt" parameterClass="bass0350SrhVO" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM BASS0350
			WHERE 1=1
			<isNotNull property="dpobCd">
			    <isNotEmpty property="dpobCd">
			        AND DPOB_CD = #dpobCd#
			    </isNotEmpty>
			</isNotNull>
			<!-- <isNotNull property="typOccuCd">
			    <isNotEmpty property="typOccuCd">
			        AND TYP_OCCU_CD = #typOccuCd#
			    </isNotEmpty>
			</isNotNull>     -->
			<isNotNull property="dtilOccuJbfmlDivCd">
				<isNotEmpty property="dtilOccuJbfmlDivCd">
				    AND DTIL_OCCU_JBFML_DIV_CD = #dtilOccuJbfmlDivCd#
				</isNotEmpty>
			</isNotNull>
			
			<isNotNull property="dtilOccuClsNm">
				<isNotEmpty property="dtilOccuClsNm">
				    AND DTIL_OCCU_CLS_NM LIKE '%' || #dtilOccuClsNm# || '%'
				</isNotEmpty>
			</isNotNull>
	</select>
	
		<select id="payr5020DAO.selectBass0350BottomList" parameterClass="bass0350SrhVO" resultClass="egovMap">
		SELECT * FROM (
			SELECT A.*, ROWNUM RNUM FROM (
						SELECT C.DPOB_CD,
						       (SELECT B.DPOB_NM FROM BASS0100 B WHERE B.DPOB_CD = C.DPOB_CD ) AS DPOB_NM,
		                       C.TYP_OCCU_CD,
		                       FCBASS0320CDNM(C.DPOB_CD, C.TYP_OCCU_CD ) as TYP_OCCU_NM,
		                       C.PYSP_GRDE_CD,
		                       FCBASS0300CDNM(C.DPOB_CD, C.PYSP_GRDE_CD ) as PYSP_GRDE_NM,
		                       C.DTIL_OCCU_INTTN_CD,
		                       C.DTIL_OCCU_CLS_DIV_CD,
		                       C.DTIL_OCCU_CLS_NM,
		                       C.DTIL_OCCU_CLS_CTNT,
		                       C.DTIL_OCCU_CLS_USE_YN,
		                       C.CHNG_TGT_YN,
		                       C.KYBDR,
		                       C.INPT_DT,
		                       C.INPT_ADDR,
		                       C.ISMT,
		                       C.REVN_DT,
		                       C.REVN_ADDR,
		                       C.DTIL_OCCU_CLS_ORD,
		                       C.DTIL_OCCU_JBFML_DIV_CD,
		                       FCBASS0300CDNM(C.DPOB_CD, C.DTIL_OCCU_JBFML_DIV_CD ) as DTIL_OCCU_JBFML_DIV_NM,
		                       C.BGG_LOG_SVC_YR_NUM_CD,
		                       FCBASS0300CDNM(C.DPOB_CD, C.BGG_LOG_SVC_YR_NUM_CD ) as BGG_LOG_SVC_YR_NUM_NM 
						  FROM BASS0350 C
						WHERE DTIL_OCCU_JBFML_DIV_CD IS NULL
						<isNotNull property="dtilOccuClsNm">
							<isNotEmpty property="dtilOccuClsNm">
							    AND C.DTIL_OCCU_CLS_NM LIKE '%' || #dtilOccuClsNm# || '%'
							</isNotEmpty>
						</isNotNull>
						ORDER BY C.DPOB_CD, C.TYP_OCCU_CD, C.DTIL_OCCU_CLS_ORD ASC
				<![CDATA[					
			) A WHERE ROWNUM <= #lastIndex#
		)WHERE RNUM >= #firstIndex#
		]]>
	</select>	
	
	<select id="payr5020DAO.selectBass0350BottomListTotCnt" parameterClass="bass0350SrhVO" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM BASS0350
			WHERE DTIL_OCCU_JBFML_DIV_CD IS NULL
			<isNotNull property="dtilOccuClsNm">
				<isNotEmpty property="dtilOccuClsNm">
				    AND DTIL_OCCU_CLS_NM LIKE '%' || #dtilOccuClsNm# || '%'
				</isNotEmpty>
			</isNotNull>
	</select>
	
	<!-- 
	
	<select id="bass0350DAO.selectBass0450ToBass0350List_D" parameterClass="bass0360SrhVO" resultClass="egovMap">
		SELECT
			C.DPOB_CD, C.TYP_OCCU_CD,C.DTIL_OCCU_INTTN_CD,
			fcBass0320CDNM(C.DPOB_CD, C.TYP_OCCU_CD) AS TYP_OCCU_NM,
			C.DTIL_OCCU_CLS_NM,
			C.DTIL_OCCU_CLS_USE_YN  
		FROM BASS0350 C
		WHERE C.DPOB_CD=#dpobCd# 
			<isNotNull property="dtilOccuClsNm">
			    <isNotEmpty property="dtilOccuClsNm">
			        AND C.DTIL_OCCU_CLS_NM LIKE '%' || #dtilOccuClsNm# || '%'
			    </isNotEmpty>
			</isNotNull>			  
			AND NOT EXISTS (SELECT 1 FROM BASS0360 D 
			                 WHERE D.DPOB_CD=#dpobCd#  
				<isNotEmpty property="deptCd">
					AND D.DEPT_CD = #deptCd#
				</isNotEmpty> 
		    AND  C.DPOB_CD =  D.DPOB_CD 
			AND C.TYP_OCCU_CD = D.TYP_OCCU_CD
			AND C.DTIL_OCCU_INTTN_CD = D.DTIL_OCCU_INTTN_CD)
	</select>	
	
	<select id="bass0350DAO.selectBass0450ToBass0350ListTotCnt_S" parameterClass="bass0360SrhVO" resultClass="int">
		SELECT COUNT(*) totcnt
			FROM BASS0350 C
			WHERE  C.DPOB_CD=#dpobCd# 		 
			    <isNotEmpty property="dtilOccuClsNm">
			        AND C.DTIL_OCCU_CLS_NM LIKE '%' || #dtilOccuClsNm# || '%'
			    </isNotEmpty> 
			AND NOT EXISTS (SELECT 1 FROM BASS0360 D 
			                 WHERE  D.DPOB_CD=#dpobCd#  
				<isNotEmpty property="deptCd">
					AND D.DEPT_CD = #deptCd#
				</isNotEmpty> 
		   AND  C.DPOB_CD =  D.DPOB_CD 	
			AND C.TYP_OCCU_CD = D.TYP_OCCU_CD
			AND C.DTIL_OCCU_INTTN_CD = D.DTIL_OCCU_INTTN_CD)
	</select>
	  -->
</sqlMap>
