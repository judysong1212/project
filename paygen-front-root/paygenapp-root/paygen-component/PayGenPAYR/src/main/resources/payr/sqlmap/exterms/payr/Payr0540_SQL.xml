<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="Payr0540">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="payr0540SrhVO" type="com.app.exterms.payroll.server.vo.Payr0540SrhVO"/>
	 
	<resultMap id="payr0540" class="com.app.exterms.payroll.server.vo.Payr0540VO">
		<result property="dpobCd" column="DPOB_CD" columnIndex="1"/>
		<result property="systemkey" column="SYSTEMKEY" columnIndex="2"/>
		<result property="exptnPrcsSeilNum" column="EXPTN_PRCS_SEIL_NUM" columnIndex="3"/>
		<result property="payItemCd" column="PAY_ITEM_CD" columnIndex="4"/>
		<result property="exptnDivCd" column="EXPTN_DIV_CD" columnIndex="5"/>
		<result property="pymtDducDivCd" column="PYMT_DDUC_DIV_CD" columnIndex="6"/>
		<result property="exmtnYn" column="EXMTN_YN" columnIndex="7"/>
		<result property="exptnPrcsPymtSum" column="EXPTN_PRCS_PYMT_SUM" columnIndex="8"/>
		<result property="exptnPrcsPymtRto" column="EXPTN_PRCS_PYMT_RTO" columnIndex="9"/>
		<result property="exptnPrcsBgnnDt" column="EXPTN_PRCS_BGNN_DT" columnIndex="10"/>
		<result property="exptnPrcsEndDt" column="EXPTN_PRCS_END_DT" columnIndex="11"/> 
		<result property="exptnPrcsNoteCtnt" column="EXPTN_PRCS_NOTE_CTNT" columnIndex="12"/>
		<result property="kybdr" column="KYBDR" columnIndex="13"/>
		<result property="inptDt" column="INPT_DT" columnIndex="14"/>
		<result property="inptAddr" column="INPT_ADDR" columnIndex="15"/>
		<result property="ismt" column="ISMT" columnIndex="16"/>
		<result property="revnDt" column="REVN_DT" columnIndex="17"/>
		<result property="revnAddr" column="REVN_ADDR" columnIndex="18"/> 
	</resultMap>
	
	<select id="payr0540DAO.getMaxSeilNum" parameterClass="java.util.HashMap" resultClass="java.lang.String">
	    SELECT 
	           NVL(MAX(EXPTN_PRCS_SEIL_NUM),0)+1 
	      FROM PAYR0540 
	     WHERE DPOB_CD = #dpobCd# 
	       AND SYSTEMKEY = #systemkey#
	</select>
	
	<insert id="payr0540DAO.insertPayr0540_S">
		<![CDATA[
			INSERT INTO PAYR0540 
				( DPOB_CD
				  , SYSTEMKEY
				  , EXPTN_PRCS_SEIL_NUM
				  , EXPTN_DIV_CD
				  , PYMT_DDUC_DIV_CD
				  , EXMTN_YN
				  , EXPTN_PRCS_PYMT_SUM
				  , EXPTN_PRCS_PYMT_RTO
				  , EXPTN_PRCS_BGNN_DT
				  , EXPTN_PRCS_END_DT
				  , KYBDR
				  , INPT_DT
				  , INPT_ADDR
				  , ISMT
				  , REVN_DT
				  , REVN_ADDR
				  , PAY_ITEM_CD
				  , EXPTN_PRCS_NOTE_CTNT )
			VALUES ( #dpobCd#
				  , #systemkey#
				  , (
				    SELECT 
				           NVL(MAX(EXPTN_PRCS_SEIL_NUM),0)+1 
				      FROM PAYR0540 
				     WHERE DPOB_CD = #dpobCd# 
				       AND SYSTEMKEY = #systemkey#
				  )
				  , #exptnDivCd#
				  , #pymtDducDivCd#
				  , #exmtnYn#
				  , #exptnPrcsPymtSum#
				  , #exptnPrcsPymtRto#
				  , #exptnPrcsBgnnDt#
				  , #exptnPrcsEndDt#
				  , #kybdr#
				  , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				  , #inptAddr#
				  , #ismt#
				  , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				  , #revnAddr#
				  , (
				   SELECT  MANGE_ITEM02 
					FROM BASS0300 
				   WHERE DPOB_CD = #dpobCd#
				     AND COMM_CD = #exptnDivCd#
				  )
				  , #exptnPrcsNoteCtnt# )
		]]>
	</insert>
	
	<update id="payr0540DAO.updatePayr0540_S">
		<![CDATA[
			UPDATE PAYR0540
			SET DPOB_CD=#dpobCd#
				, SYSTEMKEY=#systemkey#
				, EXPTN_PRCS_SEIL_NUM=#exptnPrcsSeilNum#
				, EXPTN_DIV_CD=#exptnDivCd#
				, PYMT_DDUC_DIV_CD=#pymtDducDivCd#
				, EXMTN_YN=#exmtnYn#
				, EXPTN_PRCS_PYMT_SUM=#exptnPrcsPymtSum#
				, EXPTN_PRCS_PYMT_RTO=#exptnPrcsPymtRto#
				, EXPTN_PRCS_BGNN_DT=#exptnPrcsBgnnDt#
				, EXPTN_PRCS_END_DT=#exptnPrcsEndDt#
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
				, PAY_ITEM_CD=#payItemCd#
				, EXPTN_PRCS_NOTE_CTNT=#exptnPrcsNoteCtnt#
						WHERE DPOB_CD=#dpobCd#
								AND SYSTEMKEY=#systemkey#
								AND EXPTN_PRCS_SEIL_NUM=#exptnPrcsSeilNum#
				]]>
	</update>
	
	<delete id="payr0540DAO.deletePayr0540_S">
		<![CDATA[
			DELETE FROM PAYR0540 
						WHERE DPOB_CD=#dpobCd#
								AND SYSTEMKEY=#systemkey#
								AND EXPTN_PRCS_SEIL_NUM=#exptnPrcsSeilNum#
				]]>
	</delete>
	
	<select id="payr0540DAO.selectPayr0540_S" resultMap="payr0540">
		<![CDATA[
			SELECT
				DPOB_CD
				, SYSTEMKEY
				, EXPTN_PRCS_SEIL_NUM
				, EXPTN_DIV_CD
				, PYMT_DDUC_DIV_CD
				, EXMTN_YN
				, EXPTN_PRCS_PYMT_SUM
				, EXPTN_PRCS_PYMT_RTO
				, EXPTN_PRCS_BGNN_DT
				, EXPTN_PRCS_END_DT
				, KYBDR
				, INPT_DT
				, INPT_ADDR
				, ISMT
				, REVN_DT
				, REVN_ADDR
				, PAY_ITEM_CD
				, EXPTN_PRCS_NOTE_CTNT
			FROM PAYR0540
						WHERE DPOB_CD=#dpobCd#
								AND SYSTEMKEY=#systemkey#
								AND EXPTN_PRCS_SEIL_NUM=#exptnPrcsSeilNum#
				]]>
	</select>
	
	<select id="payr0540DAO.selectPayr0540List_D" parameterClass="payr0540SrhVO" resultClass="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (
				SELECT
								SYSTEMKEY
								, DPOB_CD
								, EXPTN_PRCS_SEIL_NUM
								, EXPTN_DIV_CD
								, EXPTN_DIV_CD AS exptnDivCdcommCd
								, fcBass0300CDNM(DPOB_CD,EXPTN_DIV_CD) AS exptnDivCdcommCdNm
								, PYMT_DDUC_DIV_CD
								, PYMT_DDUC_DIV_CD  AS pymtDducDivCdcommCd
								, fcBass0300CDNM(DPOB_CD,PYMT_DDUC_DIV_CD) AS pymtDducDivCdcommCdNm 
								, EXMTN_YN
								, EXPTN_PRCS_PYMT_SUM
								, EXPTN_PRCS_PYMT_RTO
								, EXPTN_PRCS_BGNN_DT
								, EXPTN_PRCS_END_DT
								, KYBDR
								, INPT_DT
								, INPT_ADDR
								, ISMT
								, REVN_DT
								, REVN_ADDR
								, PAY_ITEM_CD
								, EXPTN_PRCS_NOTE_CTNT
						FROM PAYR0540
				WHERE 1=1
				<isNotEmpty prepend="AND" property="dpobCd" >
			 	DPOB_CD=#dpobCd#
		       </isNotEmpty>   
		       <isNotEmpty prepend="AND" property="systemkey" >
			 	SYSTEMKEY=#systemkey#
		       </isNotEmpty> 
		        <isNotEmpty prepend="AND" property="pymtDducDivCd" >
			 	PYMT_DDUC_DIV_CD=#pymtDducDivCd#
		       </isNotEmpty> 
		        <isNotEmpty prepend="AND" property="pymtDt" >
			 	   #pymtDt# BETWEEN EXPTN_PRCS_BGNN_DT AND EXPTN_PRCS_END_DT
		       </isNotEmpty> 
					ORDER BY 
					DPOB_CD  ASC
						, SYSTEMKEY DESC
							, EXPTN_PRCS_SEIL_NUM DESC
		
		<![CDATA[					
	) A WHERE ROWNUM <= #lastIndex#
)WHERE RNUM >= #firstIndex#
]]>
	</select>	
	<select id="payr0540DAO.selectPayr0540ListTotCnt_S" parameterClass="payr0540SrhVO" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM PAYR0540
			WHERE 1=1
				<isNotEmpty prepend="AND" property="dpobCd" >
			 	DPOB_CD=#dpobCd#
		       </isNotEmpty>   
		       <isNotEmpty prepend="AND" property="systemkey" >
			 	SYSTEMKEY=#systemkey#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="pymtDducDivCd" >
			 	PYMT_DDUC_DIV_CD=#pymtDducDivCd#
		       </isNotEmpty> 
		        <isNotEmpty prepend="AND" property="pymtDt" >
			 	   #pymtDt# BETWEEN EXPTN_PRCS_BGNN_DT AND EXPTN_PRCS_END_DT
		       </isNotEmpty>  
	</select>
	 
	<insert id="payr0540DAO.insertPayr0540ToPayr4100_S">
		<![CDATA[
			INSERT INTO PAYR0540 
				( DPOB_CD
				  , SYSTEMKEY
				  , EXPTN_PRCS_SEIL_NUM
				  , EXPTN_DIV_CD
				  , PYMT_DDUC_DIV_CD
				  , EXMTN_YN
				  , EXPTN_PRCS_PYMT_SUM
				  , EXPTN_PRCS_PYMT_RTO
				  , EXPTN_PRCS_BGNN_DT
				  , EXPTN_PRCS_END_DT
				  , KYBDR
				  , INPT_DT
				  , INPT_ADDR
				  , ISMT
				  , REVN_DT
				  , REVN_ADDR
				  , PAY_ITEM_CD
				  , EXPTN_PRCS_NOTE_CTNT )
			VALUES ( #dpobCd#
				  , #systemkey#
				  , (
				      SELECT 
				           NVL(MAX(EXPTN_PRCS_SEIL_NUM),0)+1 
				      FROM PAYR0540 
				     WHERE DPOB_CD = #dpobCd# 
				       AND SYSTEMKEY = #systemkey#
				  )
				  , #exptnDivCd#
				  , #pymtDducDivCd#
				  , #exmtnYn#
				  , #exptnPrcsPymtSum#
				  , #exptnPrcsPymtRto#
				  , #exptnPrcsBgnnDt#
				  , #exptnPrcsEndDt#
				  , #kybdr#
				  , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				  , #inptAddr#
				  , #ismt#
				  , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				  , #revnAddr#
				  , #payItemCd#
				  , #exptnPrcsNoteCtnt# )
		]]>
	</insert>
	
	<update id="payr0540DAO.updatePayr0540ToPayr4100_S">
		<![CDATA[
			UPDATE PAYR0540
			SET   EXPTN_DIV_CD=#exptnDivCd#
				, PYMT_DDUC_DIV_CD=#pymtDducDivCd#
				, EXMTN_YN=#exmtnYn#
				, EXPTN_PRCS_PYMT_SUM=#exptnPrcsPymtSum#
				, EXPTN_PRCS_PYMT_RTO=#exptnPrcsPymtRto#
				, EXPTN_PRCS_BGNN_DT=#exptnPrcsBgnnDt#
				, EXPTN_PRCS_END_DT=#exptnPrcsEndDt#
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
				, PAY_ITEM_CD=#payItemCd#
				, EXPTN_PRCS_NOTE_CTNT=#exptnPrcsNoteCtnt#
						WHERE DPOB_CD=#dpobCd#
								AND SYSTEMKEY=#systemkey#
								AND EXPTN_PRCS_SEIL_NUM=#exptnPrcsSeilNum#
				]]>
	</update>
	
	<delete id="payr0540DAO.deletePayr0540ToPayr4100_S">
		<![CDATA[
			DELETE FROM PAYR0540 
						WHERE DPOB_CD=#dpobCd#
								AND SYSTEMKEY=#systemkey#
								AND EXPTN_PRCS_SEIL_NUM=#exptnPrcsSeilNum#
				]]>
	</delete>
	
	<select id="payr0540DAO.selectPayr0540ToPayr4100_S" resultMap="payr0540">
		<![CDATA[
			SELECT
				DPOB_CD
				, SYSTEMKEY
				, EXPTN_PRCS_SEIL_NUM
				, EXPTN_DIV_CD
				, PYMT_DDUC_DIV_CD
				, EXMTN_YN
				, EXPTN_PRCS_PYMT_SUM
				, EXPTN_PRCS_PYMT_RTO
				, EXPTN_PRCS_BGNN_DT
				, EXPTN_PRCS_END_DT
				, KYBDR
				, INPT_DT
				, INPT_ADDR
				, ISMT
				, REVN_DT
				, REVN_ADDR
				, PAY_ITEM_CD
				, EXPTN_PRCS_NOTE_CTNT
			FROM PAYR0540
						WHERE DPOB_CD=#dpobCd#
								AND SYSTEMKEY=#systemkey#
								AND EXPTN_PRCS_SEIL_NUM=#exptnPrcsSeilNum#
				]]>
	</select>

</sqlMap>
