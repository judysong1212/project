<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="Ye17Ta2000_2022">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="ye17Ta2000Srh_2022_Vo" type="com.app.exterms.yearendtax.server.vo.Yeta2000Srh_2022_VO"/>
	<typeAlias  alias="ye17Ta2000_2022_Vo" type="com.app.exterms.yearendtax.server.vo.Yeta2000_2022_VO"/>
	<typeAlias  alias="infcPsnl0100Srh_2022_Vo" type="com.app.exterms.yearendtax.server.vo.InfcPsnl0100Srh_2022_VO"/>
	
	 
	<resultMap id="ye17Ta2000_2022" class="com.app.exterms.yearendtax.server.vo.Yeta2000_2022_VO">
		<result property="dpobCd" column="DPOB_CD" columnIndex="1"/>
		<result property="edacRvyy" column="EDAC_RVYY" columnIndex="2"/>
		<result property="settGbcd" column="SETT_GBCD" columnIndex="3"/>
		<result property="systemkey" column="SYSTEMKEY" columnIndex="4"/>
		<result property="edacSeilNum" column="EDAC_SEIL_NUM" columnIndex="5"/>
		<result property="payrMangDeptCd" column="PAYR_MANG_DEPT_CD" columnIndex="6"/>
		<result property="emymtDivCd" column="EMYMT_DIV_CD" columnIndex="7"/>
		<result property="hanNm" column="HAN_NM" columnIndex="8"/>
		<result property="resnRegnNum" column="RESN_REGN_NUM" columnIndex="9"/>
		<result property="deptCd" column="DEPT_CD" columnIndex="10"/>
		<result property="businCd" column="BUSIN_CD" columnIndex="11"/>
		<result property="typOccuCd" column="TYP_OCCU_CD" columnIndex="12"/>
		<result property="dtilOccuInttnCd" column="DTIL_OCCU_INTTN_CD" columnIndex="13"/>
		<result property="dtilOccuClsDivCd" column="DTIL_OCCU_CLS_DIV_CD" columnIndex="14"/>
		<result property="odtyCd" column="ODTY_CD" columnIndex="15"/>
		<result property="pyspCd" column="PYSP_CD" columnIndex="16"/>
		<result property="pyspGrdeCd" column="PYSP_GRDE_CD" columnIndex="17"/>
		<result property="logSvcYrNumCd" column="LOG_SVC_YR_NUM_CD" columnIndex="18"/>
		<result property="logSvcMnthIcmCd" column="LOG_SVC_MNTH_ICM_CD" columnIndex="19"/>
		<result property="frstEmymtDt" column="FRST_EMYMT_DT" columnIndex="20"/>
		<result property="emymtBgnnDt" column="EMYMT_BGNN_DT" columnIndex="21"/>
		<result property="emymtEndDt" column="EMYMT_END_DT" columnIndex="22"/>
		<result property="hdofcDivCd" column="HDOFC_DIV_CD" columnIndex="23"/>
		<result property="retryDt" column="RETRY_DT" columnIndex="24"/>
		<result property="yrtxApptnYrMnth" column="YRTX_APPTN_YR_MNTH" columnIndex="25"/>
		<result property="yrtxPrcsDt" column="YRTX_PRCS_DT" columnIndex="26"/>
		<result property="yrtxPrcsYn" column="YRTX_PRCS_YN" columnIndex="27"/>
		<result property="divdPymtDivCd" column="DIVD_PYMT_DIV_CD" columnIndex="28"/>
		<result property="divdPymt" column="DIVD_PYMT" columnIndex="29"/>
		<result property="gnanSgtf" column="GNAN_SGTF" columnIndex="30"/>
		<result property="frnrYeno" column="FRNR_YENO" columnIndex="31"/>
		<result property="reymStdt" column="REYM_STDT" columnIndex="32"/>
		<result property="reymEddt" column="REYM_EDDT" columnIndex="33"/>
		<result property="rutrEddt" column="RUTR_EDDT" columnIndex="34"/>
		<result property="rutrStdt" column="RUTR_STDT" columnIndex="35"/>
		<result property="resdFlag" column="RESD_FLAG" columnIndex="36"/>
		<result property="natnGbcd" column="NATN_GBCD" columnIndex="37"/>
		<result property="natnName" column="NATN_NAME" columnIndex="38"/>
		<result property="redtGbcd" column="REDT_GBCD" columnIndex="39"/>
		<result property="redtName" column="REDT_NAME" columnIndex="40"/>
		<result property="humnCgue" column="HUMN_CGUE" columnIndex="41"/>
		<result property="frnrSgyn" column="FRNR_SGYN" columnIndex="42"/>
		<result property="baseWiyn" column="BASE_WIYN" columnIndex="43"/>
		<result property="baseFmly" column="BASE_FMLY" columnIndex="44"/>
		<result property="addrCt70" column="ADDR_CT70" columnIndex="45"/>
		<result property="addrHdrc" column="ADDR_HDRC" columnIndex="46"/>
		<result property="addrFdsu" column="ADDR_FDSU" columnIndex="47"/>
		<result property="addrClct" column="ADDR_CLCT" columnIndex="48"/>
		<result property="addrBhct" column="ADDR_BHCT" columnIndex="49"/>
		<result property="pantOnsu" column="PANT_ONSU" columnIndex="50"/>
		<result property="addrMrct" column="ADDR_MRCT" columnIndex="51"/>
		<result property="bnatPsnf" column="BNAT_PSNF" columnIndex="52"/>
		<result property="jnatPsnf" column="JNAT_PSNF" columnIndex="53"/>
		<result property="bpssTech" column="BPSS_TECH" columnIndex="54"/>
		<result property="bpssPulc" column="BPSS_PULC" columnIndex="55"/>
		<result property="bpssFect" column="BPSS_FECT" columnIndex="56"/>
		<result property="bpssSold" column="BPSS_SOLD" columnIndex="57"/>
		<result property="jpssPulc" column="JPSS_PULC" columnIndex="58"/>
		<result property="jpssSold" column="JPSS_SOLD" columnIndex="59"/>
		<result property="jpssTech" column="JPSS_TECH" columnIndex="60"/>
		<result property="jpssFect" column="JPSS_FECT" columnIndex="61"/>
		<result property="brtrPsct" column="BRTR_PSCT" columnIndex="62"/>
		<result property="brtrCict" column="BRTR_CICT" columnIndex="63"/>
		<result property="brtrAnsv" column="BRTR_ANSV" columnIndex="64"/>
		<result property="jrtrCict" column="JRTR_CICT" columnIndex="65"/>
		<result property="jrtrCtar" column="JRTR_CTAR" columnIndex="66"/>
		<result property="jrtrPsct" column="JRTR_PSCT" columnIndex="67"/>
		<result property="jrtrPtar" column="JRTR_PTAR" columnIndex="68"/>
		<result property="jrtrAnsv" column="JRTR_ANSV" columnIndex="69"/>
		<result property="jrtrAtar" column="JRTR_ATAR" columnIndex="70"/>
		<result property="rrptAmnt" column="RRPT_AMNT" columnIndex="71"/>
		<result property="spciBhlh" column="SPCI_BHLH" columnIndex="72"/>
		<result property="spciHhlh" column="SPCI_HHLH" columnIndex="73"/>
		<result property="spciBepf" column="SPCI_BEPF" columnIndex="74"/>
		<result property="spciJepf" column="SPCI_JEPF" columnIndex="75"/>
		<result property="spciGurt" column="SPCI_GURT" columnIndex="76"/>
		<result property="spciHdrc" column="SPCI_HDRC" columnIndex="77"/>
		<result property="spciRttg" column="SPCI_RTTG" columnIndex="78"/>
		<result property="spciIuam" column="SPCI_IUAM" columnIndex="79"/>
		<result property="spciSelf" column="SPCI_SELF" columnIndex="80"/>
		<result property="spciAe65" column="SPCI_AE65" columnIndex="81"/>
		<result property="spciDbps" column="SPCI_DBPS" columnIndex="82"/>
		<result property="spciDetc" column="SPCI_DETC" columnIndex="83"/>
		<result property="spciDtar" column="SPCI_DTAR" columnIndex="84"/>
		<result property="spciEtam" column="SPCI_ETAM" columnIndex="85"/>
		<result property="spedSelf" column="SPED_SELF" columnIndex="86"/>
		<result property="spedEdsu" column="SPED_EDSU" columnIndex="87"/>
		<result property="spedEdam" column="SPED_EDAM" columnIndex="88"/>
		<result property="spedGdsu" column="SPED_GDSU" columnIndex="89"/>
		<result property="spedGdam" column="SPED_GDAM" columnIndex="90"/>
		<result property="spedCvsu" column="SPED_CVSU" columnIndex="91"/>
		<result property="spedCvam" column="SPED_CVAM" columnIndex="92"/>
		<result property="spciScsu" column="SPCI_SCSU" columnIndex="93"/>
		<result property="spciScam" column="SPCI_SCAM" columnIndex="94"/>
		<result property="spedEtar" column="SPED_ETAR" columnIndex="95"/>
		<result property="siedToam" column="SIED_TOAM" columnIndex="96"/>
		<result property="spciRefn" column="SPCI_REFN" columnIndex="97"/>
		<result property="spciResf" column="SPCI_RESF" columnIndex="98"/>
		<result property="spciHtam" column="SPCI_HTAM" columnIndex="99"/>
		<result property="spchRefn" column="SPCH_REFN" columnIndex="100"/>
		<result property="spchRe06" column="SPCH_RE06" columnIndex="101"/>
		<result property="spchRe10" column="SPCH_RE10" columnIndex="102"/>
		<result property="spchRe20" column="SPCH_RE20" columnIndex="103"/>
		<result property="spchRefx" column="SPCH_REFX" columnIndex="104"/>
		<result property="spchReec" column="SPCH_REEC" columnIndex="105"/>
		<result property="spch15fx" column="SPCH_15FX" columnIndex="106"/>
		<result property="spch15fb" column="SPCH_15FB" columnIndex="107"/>
		<result property="spch15ec" column="SPCH_15EC" columnIndex="108"/>
		<result property="spch10fb" column="SPCH_10FB" columnIndex="109"/>
		<result property="spch10ec" column="SPCH_10EC" columnIndex="110"/>
		<result property="taxdPltc" column="TAXD_PLTC" columnIndex="111"/>
		<result property="taxd10tg" column="TAXD_10TG" columnIndex="112"/>
		<result property="spciPltc" column="SPCI_PLTC" columnIndex="113"/>
		<result property="spciPltg" column="SPCI_PLTG" columnIndex="114"/>
		<result property="spciFbam" column="SPCI_FBAM" columnIndex="115"/>
		<result property="spciFbtg" column="SPCI_FBTG" columnIndex="116"/>
		<result property="spciExam" column="SPCI_EXAM" columnIndex="117"/>
		<result property="spciUnon" column="SPCI_UNON" columnIndex="118"/>
		<result property="spciHfam" column="SPCI_HFAM" columnIndex="119"/>
		<result property="spciYamt" column="SPCI_YAMT" columnIndex="120"/>
		<result property="spciNamt" column="SPCI_NAMT" columnIndex="121"/>
		<result property="spciDgtg" column="SPCI_DGTG" columnIndex="122"/>
		<result property="spciFnrl" column="SPCI_FNRL" columnIndex="123"/>
		<result property="prvm20be" column="PRVM_20BE" columnIndex="124"/>
		<result property="prvm21af" column="PRVM_21AF" columnIndex="125"/>
		<result property="etchPrep" column="ETCH_PREP" columnIndex="126"/>
		<result property="etcsComp" column="ETCS_COMP" columnIndex="127"/>
		<result property="etwkHsvm" column="ETWK_HSVM" columnIndex="128"/>
		<result property="etwkHsbm" column="ETWK_HSBM" columnIndex="129"/>
		<result property="etwkHlgm" column="ETWK_HLGM" columnIndex="130"/>
		<result property="etwkHbdm" column="ETWK_HBDM" columnIndex="131"/>
		<result property="etctConc" column="ETCT_CONC" columnIndex="132"/>
		<result property="etgdH09f" column="ETGD_H09F" columnIndex="133"/>
		<result property="etgdH13f" column="ETGD_H13F" columnIndex="134"/>
		<result property="etgdH14f" column="ETGD_H14F" columnIndex="135"/>
		<result property="etclH15f" column="ETCL_H15F" columnIndex="136"/>
		<result property="etgdHdam" column="ETGD_HDAM" columnIndex="137"/>
		<result property="etctCard" column="ETCT_CARD" columnIndex="138"/>
		<result property="etchBcbs" column="ETCH_BCBS" columnIndex="139"/>
		<result property="etchUeam" column="ETCH_UEAM" columnIndex="140"/>
		<result property="etchMgvd" column="ETCH_MGVD" columnIndex="141"/>
		<result property="etchBced" column="ETCH_BCED" columnIndex="142"/>
		<result property="cardEt13" column="CARD_ET13" columnIndex="143"/>
		<result property="cardEt14" column="CARD_ET14" columnIndex="144"/>
		<result property="etadDd13" column="ETAD_DD13" columnIndex="145"/>
		<result property="etadD14l" column="ETAD_D14L" columnIndex="146"/>
		<result property="etchBcue" column="ETCH_BCUE" columnIndex="147"/>
		<result property="etckUnon" column="ETCK_UNON" columnIndex="148"/>
		<result property="etckUncb" column="ETCK_UNCB" columnIndex="149"/>
		<result property="etepHsam" column="ETEP_HSAM" columnIndex="150"/>
		<result property="etgdCtra" column="ETGD_CTRA" columnIndex="151"/>
		<result property="etepSest" column="ETEP_SEST" columnIndex="152"/>
		<result property="etclHm01" column="ETCL_HM01" columnIndex="153"/>
		<result property="etclHm02" column="ETCL_HM02" columnIndex="154"/>
		<result property="etclHm03" column="ETCL_HM03" columnIndex="155"/>
		<result property="etclHmta" column="ETCL_HMTA" columnIndex="156"/>
		<result property="etclEttl" column="ETCL_ETTL" columnIndex="157"/>
		<result property="etclEtam" column="ETCL_ETAM" columnIndex="158"/>
		<result property="taxdIncd" column="TAXD_INCD" columnIndex="159"/>
		<result property="taxdWkdt" column="TAXD_WKDT" columnIndex="160"/>
		<result property="tamaEddt" column="TAMA_EDDT" columnIndex="161"/>
		<result property="tamaIndt" column="TAMA_INDT" columnIndex="162"/>
		<result property="tamaOudt" column="TAMA_OUDT" columnIndex="163"/>
		<result property="txlgFrrd" column="TXLG_FRRD" columnIndex="164"/>
		<result property="txlgFrid" column="TXLG_FRID" columnIndex="165"/>
		<result property="txlgWkid" column="TXLG_WKID" columnIndex="166"/>
		<result property="txlgTxtd" column="TXLG_TXTD" columnIndex="167"/>
		<result property="txlgBscd" column="TXLG_BSCD" columnIndex="168"/>
		<result property="txlgBcde" column="TXLG_BCDE" columnIndex="169"/>
		<result property="txlgItct" column="TXLG_ITCT" columnIndex="170"/>
		<result property="txlgBsta" column="TXLG_BSTA" columnIndex="171"/>
		<result property="txlgWkta" column="TXLG_WKTA" columnIndex="172"/>
		<result property="txlgClta" column="TXLG_CLTA" columnIndex="173"/>
		<result property="txlgFrta" column="TXLG_FRTA" columnIndex="174"/>
		<result property="txlgTxty" column="TXLG_TXTY" columnIndex="175"/>
		<result property="txlgInam" column="TXLG_INAM" columnIndex="176"/>
		<result property="txlgDlam" column="TXLG_DLAM" columnIndex="177"/>
		<result property="txlgWnam" column="TXLG_WNAM" columnIndex="178"/>
		<result property="txlgOtcy" column="TXLG_OTCY" columnIndex="179"/>
		<result property="txlgOtdt" column="TXLG_OTDT" columnIndex="180"/>
		<result property="txlgApdt" column="TXLG_APDT" columnIndex="181"/>
		<result property="txlgOuwk" column="TXLG_OUWK" columnIndex="182"/>
		<result property="txapStdt" column="TXAP_STDT" columnIndex="183"/>
		<result property="txapEddt" column="TXAP_EDDT" columnIndex="184"/>
		<result property="txapWkdy" column="TXAP_WKDY" columnIndex="185"/>
		<result property="taxdUnin" column="TAXD_UNIN" columnIndex="186"/>
		<result property="taxdLoaa" column="TAXD_LOAA" columnIndex="187"/>
		<result property="addcNtyn" column="ADDC_NTYN" columnIndex="188"/>
		<result property="addcMdyn" column="ADDC_MDYN" columnIndex="189"/>
		<result property="addcCtyn" column="ADDC_CTYN" columnIndex="190"/>
		<result property="addcPfyn" column="ADDC_PFYN" columnIndex="191"/>
		<result property="addfPvyn" column="ADDF_PVYN" columnIndex="192"/>
		<result property="spciReyn" column="SPCI_REYN" columnIndex="193"/>
		<result property="txlgMxtm" column="TXLG_MXTM" columnIndex="194"/>
		<result property="incoOudt" column="INCO_OUDT" columnIndex="195"/>
		<result property="incoOufg" column="INCO_OUFG" columnIndex="196"/>
		<result property="jdocFile" column="JDOC_FILE" columnIndex="197"/>
		<result property="jrtrAtom" column="JRTR_ATOM" columnIndex="198"/>
		<result property="jrtrTotr" column="JRTR_TOTR" columnIndex="199"/>
		<result property="spciHdtg" column="SPCI_HDTG" columnIndex="200"/>
		<result property="spciDetg" column="SPCI_DETG" columnIndex="201"/>
		<result property="spciRtto" column="SPCI_RTTO" columnIndex="202"/>
		<result property="spciSftg" column="SPCI_SFTG" columnIndex="203"/>
		<result property="spci65tg" column="SPCI_65TG" columnIndex="204"/>
		<result property="spciPstg" column="SPCI_PSTG" columnIndex="205"/>
		<result property="spciEtcg" column="SPCI_ETCG" columnIndex="206"/>
		<result property="spedSftr" column="SPED_SFTR" columnIndex="207"/>
		<result property="spedEdtr" column="SPED_EDTR" columnIndex="208"/>
		<result property="spedGdtr" column="SPED_GDTR" columnIndex="209"/>
		<result property="spedCvtr" column="SPED_CVTR" columnIndex="210"/>
		<result property="spciSctr" column="SPCI_SCTR" columnIndex="211"/>
		<result property="spciExtg" column="SPCI_EXTG" columnIndex="212"/>
		<result property="spciUntg" column="SPCI_UNTG" columnIndex="213"/>
		<result property="spciHftg" column="SPCI_HFTG" columnIndex="214"/>
		<result property="spciNatg" column="SPCI_NATG" columnIndex="215"/>
		<result property="spciYatg" column="SPCI_YATG" columnIndex="216"/>
		<result property="spciDgam" column="SPCI_DGAM" columnIndex="217"/>
		<result property="spciOnon" column="SPCI_ONON" columnIndex="218"/>
		<result property="spciObam" column="SPCI_OBAM" columnIndex="219"/>
		<result property="spciOyam" column="SPCI_OYAM" columnIndex="220"/>
		<result property="spciOnam" column="SPCI_ONAM" columnIndex="221"/>
		<result property="kybdr" column="KYBDR" columnIndex="222"/>
		<result property="inptDt" column="INPT_DT" columnIndex="223"/>
		<result property="inptAddr" column="INPT_ADDR" columnIndex="224"/>
		<result property="ismt" column="ISMT" columnIndex="225"/>
		<result property="revnDt" column="REVN_DT" columnIndex="226"/>
		<result property="revnAddr" column="REVN_ADDR" columnIndex="227"/>
	</resultMap>
	
	<insert id="ye17Ta2000_2022_DAO.insertYeta3000_S">
		<![CDATA[
			INSERT INTO YETA2000 
				( DPOB_CD
				  , EDAC_RVYY
				  , SETT_GBCD
				  , SYSTEMKEY
				  , EDAC_SEIL_NUM
				  , PAYR_MANG_DEPT_CD
				  , EMYMT_DIV_CD
				  , HAN_NM
				  , RESN_REGN_NUM
				  , DEPT_CD
				  , BUSIN_CD
				  , TYP_OCCU_CD
				  , DTIL_OCCU_INTTN_CD
				  , DTIL_OCCU_CLS_DIV_CD
				  , ODTY_CD
				  , PYSP_CD
				  , PYSP_GRDE_CD
				  , LOG_SVC_YR_NUM_CD
				  , LOG_SVC_MNTH_ICM_CD
				  , FRST_EMYMT_DT
				  , EMYMT_BGNN_DT
				  , EMYMT_END_DT
				  , HDOFC_DIV_CD
				  , RETRY_DT
				  , YRTX_APPTN_YR_MNTH
				  , YRTX_PRCS_DT
				  , YRTX_PRCS_YN
				  , DIVD_PYMT_DIV_CD
				  , DIVD_PYMT
				  , GNAN_SGTF
				  , FRNR_YENO
				  , REYM_STDT
				  , REYM_EDDT
				  , RUTR_EDDT
				  , RUTR_STDT
				  , RESD_FLAG
				  , NATN_GBCD
				  , NATN_NAME
				  , REDT_GBCD
				  , REDT_NAME
				  , HUMN_CGUE
				  , FRNR_SGYN
				  , BASE_WIYN
				  , BASE_FMLY
				  , ADDR_CT70
				  , ADDR_HDRC
				  , ADDR_FDSU
				  , ADDR_CLCT
				  , ADDR_BHCT
				  , PANT_ONSU
				  , ADDR_MRCT
				  , BNAT_PSNF
				  , JNAT_PSNF
				  , BPSS_TECH
				  , BPSS_PULC
				  , BPSS_FECT
				  , BPSS_SOLD
				  , JPSS_PULC
				  , JPSS_SOLD
				  , JPSS_TECH
				  , JPSS_FECT
				  , BRTR_PSCT
				  , BRTR_CICT
				  , BRTR_ANSV
				  , JRTR_CICT
				  , JRTR_CTAR
				  , JRTR_PSCT
				  , JRTR_PTAR
				  , JRTR_ANSV
				  , JRTR_ATAR
				  , RRPT_AMNT
				  , SPCI_BHLH
				  , SPCI_HHLH
				  , SPCI_BEPF
				  , SPCI_JEPF
				  , SPCI_GURT
				  , SPCI_HDRC
				  , SPCI_RTTG
				  , SPCI_IUAM
				  , SPCI_SELF
				  , SPCI_AE65
				  , SPCI_DBPS
				  , SPCI_DETC
				  , SPCI_DTAR
				  , SPCI_ETAM
				  , SPED_SELF
				  , SPED_EDSU
				  , SPED_EDAM
				  , SPED_GDSU
				  , SPED_GDAM
				  , SPED_CVSU
				  , SPED_CVAM
				  , SPCI_SCSU
				  , SPCI_SCAM
				  , SPED_ETAR
				  , SIED_TOAM
				  , SPCI_REFN
				  , SPCI_RESF
				  , SPCI_HTAM
				  , SPCH_REFN
				  , SPCH_RE06
				  , SPCH_RE10
				  , SPCH_RE20
				  , SPCH_REFX
				  , SPCH_REEC
				  , SPCH_15FX
				  , SPCH_15FB
				  , SPCH_15EC
				  , SPCH_10FB
				  , SPCH_10EC
				  , TAXD_PLTC
				  , TAXD_10TG
				  , SPCI_PLTC
				  , SPCI_PLTG
				  , SPCI_FBAM
				  , SPCI_FBTG
				  , SPCI_EXAM
				  , SPCI_UNON
				  , SPCI_HFAM
				  , SPCI_YAMT
				  , SPCI_NAMT
				  , SPCI_DGTG
				  , SPCI_FNRL
				  , PRVM_20BE
				  , PRVM_21AF
				  , ETCH_PREP
				  , ETCS_COMP
				  , ETWK_HSVM
				  , ETWK_HSBM
				  , ETWK_HLGM
				  , ETWK_HBDM
				  , ETCT_CONC
				  , ETGD_H09F
				  , ETGD_H13F
				  , ETGD_H14F
				  , ETCL_H15F
				  , ETGD_HDAM
				  , ETCT_CARD
				  , ETCH_BCBS
				  , ETCH_UEAM
				  , ETCH_MGVD
				  , ETCH_BCED
				  , CARD_ET13
				  , CARD_ET14
				  , ETAD_DD13
				  , ETAD_D14L
				  , ETCH_BCUE
				  , ETCK_UNON
				  , ETCK_UNCB
				  , ETEP_HSAM
				  , ETGD_CTRA
				  , ETEP_SEST
				  , ETCL_HM01
				  , ETCL_HM02
				  , ETCL_HM03
				  , ETCL_HMTA
				  , ETCL_ETTL
				  , ETCL_ETAM
				  , TAXD_INCD
				  , TAXD_WKDT
				  , TAMA_EDDT
				  , TAMA_INDT
				  , TAMA_OUDT
				  , TXLG_FRRD
				  , TXLG_FRID
				  , TXLG_WKID
				  , TXLG_TXTD
				  , TXLG_BSCD
				  , TXLG_BCDE
				  , TXLG_ITCT
				  , TXLG_BSTA
				  , TXLG_WKTA
				  , TXLG_CLTA
				  , TXLG_FRTA
				  , TXLG_TXTY
				  , TXLG_INAM
				  , TXLG_DLAM
				  , TXLG_WNAM
				  , TXLG_OTCY
				  , TXLG_OTDT
				  , TXLG_APDT
				  , TXLG_OUWK
				  , TXAP_STDT
				  , TXAP_EDDT
				  , TXAP_WKDY
				  , TAXD_UNIN
				  , TAXD_LOAA
				  , ADDC_NTYN
				  , ADDC_MDYN
				  , ADDC_CTYN
				  , ADDC_PFYN
				  , ADDF_PVYN
				  , SPCI_REYN
				  , TXLG_MXTM
				  , INCO_OUDT
				  , INCO_OUFG
				  , JDOC_FILE
				  , JRTR_ATOM
				  , JRTR_TOTR
				  , SPCI_HDTG
				  , SPCI_DETG
				  , SPCI_RTTO
				  , SPCI_SFTG
				  , SPCI_65TG
				  , SPCI_PSTG
				  , SPCI_ETCG
				  , SPED_SFTR
				  , SPED_EDTR
				  , SPED_GDTR
				  , SPED_CVTR
				  , SPCI_SCTR
				  , SPCI_EXTG
				  , SPCI_UNTG
				  , SPCI_HFTG
				  , SPCI_NATG
				  , SPCI_YATG
				  , SPCI_DGAM
				  , SPCI_ONON
				  , SPCI_OBAM
				  , SPCI_OYAM
				  , SPCI_ONAM
				  , KYBDR
				  , INPT_DT
				  , INPT_ADDR
				  , ISMT
				  , REVN_DT
				  , REVN_ADDR )
			VALUES ( #dpobCd#
				  , #edacRvyy#
				  , #settGbcd#
				  , #systemkey#
				  , #edacSeilNum#
				  , #payrMangDeptCd#
				  , #emymtDivCd#
				  , #hanNm#
				  , #resnRegnNum#
				  , #deptCd#
				  , #businCd#
				  , #typOccuCd#
				  , #dtilOccuInttnCd#
				  , #dtilOccuClsDivCd#
				  , #odtyCd#
				  , #pyspCd#
				  , #pyspGrdeCd#
				  , #logSvcYrNumCd#
				  , #logSvcMnthIcmCd#
				  , #frstEmymtDt#
				  , #emymtBgnnDt#
				  , #emymtEndDt#
				  , #hdofcDivCd#
				  , #retryDt#
				  , #yrtxApptnYrMnth#
				  , #yrtxPrcsDt#
				  , #yrtxPrcsYn#
				  , #divdPymtDivCd#
				  , #divdPymt#
				  , #gnanSgtf#
				  , #frnrYeno#
				  , #reymStdt#
				  , #reymEddt#
				  , #rutrEddt#
				  , #rutrStdt#
				  , #resdFlag#
				  , #natnGbcd#
				  , #natnName#
				  , #redtGbcd#
				  , #redtName#
				  , #humnCgue#
				  , #frnrSgyn#
				  , #baseWiyn#
				  , #baseFmly#
				  , #addrCt70#
				  , #addrHdrc#
				  , #addrFdsu#
				  , #addrClct#
				  , #addrBhct#
				  , #pantOnsu#
				  , #addrMrct#
				  , #bnatPsnf#
				  , #jnatPsnf#
				  , #bpssTech#
				  , #bpssPulc#
				  , #bpssFect#
				  , #bpssSold#
				  , #jpssPulc#
				  , #jpssSold#
				  , #jpssTech#
				  , #jpssFect#
				  , #brtrPsct#
				  , #brtrCict#
				  , #brtrAnsv#
				  , #jrtrCict#
				  , #jrtrCtar#
				  , #jrtrPsct#
				  , #jrtrPtar#
				  , #jrtrAnsv#
				  , #jrtrAtar#
				  , #rrptAmnt#
				  , #spciBhlh#
				  , #spciHhlh#
				  , #spciBepf#
				  , #spciJepf#
				  , #spciGurt#
				  , #spciHdrc#
				  , #spciRttg#
				  , #spciIuam#
				  , #spciSelf#
				  , #spciAe65#
				  , #spciDbps#
				  , #spciDetc#
				  , #spciDtar#
				  , #spciEtam#
				  , #spedSelf#
				  , #spedEdsu#
				  , #spedEdam#
				  , #spedGdsu#
				  , #spedGdam#
				  , #spedCvsu#
				  , #spedCvam#
				  , #spciScsu#
				  , #spciScam#
				  , #spedEtar#
				  , #siedToam#
				  , #spciRefn#
				  , #spciResf#
				  , #spciHtam#
				  , #spchRefn#
				  , #spchRe06#
				  , #spchRe10#
				  , #spchRe20#
				  , #spchRefx#
				  , #spchReec#
				  , #spch15fx#
				  , #spch15fb#
				  , #spch15ec#
				  , #spch10fb#
				  , #spch10ec#
				  , #taxdPltc#
				  , #taxd10tg#
				  , #spciPltc#
				  , #spciPltg#
				  , #spciFbam#
				  , #spciFbtg#
				  , #spciExam#
				  , #spciUnon#
				  , #spciHfam#
				  , #spciYamt#
				  , #spciNamt#
				  , #spciDgtg#
				  , #spciFnrl#
				  , #prvm20be#
				  , #prvm21af#
				  , #etchPrep#
				  , #etcsComp#
				  , #etwkHsvm#
				  , #etwkHsbm#
				  , #etwkHlgm#
				  , #etwkHbdm#
				  , #etctConc#
				  , #etgdH09f#
				  , #etgdH13f#
				  , #etgdH14f#
				  , #etclH15f#
				  , #etgdHdam#
				  , #etctCard#
				  , #etchBcbs#
				  , #etchUeam#
				  , #etchMgvd#
				  , #etchBced#
				  , #cardEt13#
				  , #cardEt14#
				  , #etadDd13#
				  , #etadD14l#
				  , #etchBcue#
				  , #etckUnon#
				  , #etckUncb#
				  , #etepHsam#
				  , #etgdCtra#
				  , #etepSest#
				  , #etclHm01#
				  , #etclHm02#
				  , #etclHm03#
				  , #etclHmta#
				  , #etclEttl#
				  , #etclEtam#
				  , #taxdIncd#
				  , #taxdWkdt#
				  , #tamaEddt#
				  , #tamaIndt#
				  , #tamaOudt#
				  , #txlgFrrd#
				  , #txlgFrid#
				  , #txlgWkid#
				  , #txlgTxtd#
				  , #txlgBscd#
				  , #txlgBcde#
				  , #txlgItct#
				  , #txlgBsta#
				  , #txlgWkta#
				  , #txlgClta#
				  , #txlgFrta#
				  , #txlgTxty#
				  , #txlgInam#
				  , #txlgDlam#
				  , #txlgWnam#
				  , #txlgOtcy#
				  , #txlgOtdt#
				  , #txlgApdt#
				  , #txlgOuwk#
				  , #txapStdt#
				  , #txapEddt#
				  , #txapWkdy#
				  , #taxdUnin#
				  , #taxdLoaa#
				  , #addcNtyn#
				  , #addcMdyn#
				  , #addcCtyn#
				  , #addcPfyn#
				  , #addfPvyn#
				  , #spciReyn#
				  , #txlgMxtm#
				  , #incoOudt#
				  , #incoOufg#
				  , #jdocFile#
				  , #jrtrAtom#
				  , #jrtrTotr#
				  , #spciHdtg#
				  , #spciDetg#
				  , #spciRtto#
				  , #spciSftg#
				  , #spci65tg#
				  , #spciPstg#
				  , #spciEtcg#
				  , #spedSftr#
				  , #spedEdtr#
				  , #spedGdtr#
				  , #spedCvtr#
				  , #spciSctr#
				  , #spciExtg#
				  , #spciUntg#
				  , #spciHftg#
				  , #spciNatg#
				  , #spciYatg#
				  , #spciDgam#
				  , #spciOnon#
				  , #spciObam#
				  , #spciOyam#
				  , #spciOnam#
				  , #kybdr#
				  , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				  , #inptAddr#
				  , #ismt#
				  , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				  , #revnAddr# )
		]]>
	</insert>
	
	<update id="ye17Ta2000_2022_DAO.updateYeta3000_S">
		<![CDATA[
			UPDATE YETA2000
			SET DPOB_CD=#dpobCd#
				, EDAC_RVYY=#edacRvyy#
				, SETT_GBCD=#settGbcd#
				, SYSTEMKEY=#systemkey#
				, EDAC_SEIL_NUM=#edacSeilNum#
				, PAYR_MANG_DEPT_CD=#payrMangDeptCd#
				, EMYMT_DIV_CD=#emymtDivCd#
				, HAN_NM=#hanNm#
				, RESN_REGN_NUM=#resnRegnNum#
				, DEPT_CD=#deptCd#
				, BUSIN_CD=#businCd#
				, TYP_OCCU_CD=#typOccuCd#
				, DTIL_OCCU_INTTN_CD=#dtilOccuInttnCd#
				, DTIL_OCCU_CLS_DIV_CD=#dtilOccuClsDivCd#
				, ODTY_CD=#odtyCd#
				, PYSP_CD=#pyspCd#
				, PYSP_GRDE_CD=#pyspGrdeCd#
				, LOG_SVC_YR_NUM_CD=#logSvcYrNumCd#
				, LOG_SVC_MNTH_ICM_CD=#logSvcMnthIcmCd#
				, FRST_EMYMT_DT=#frstEmymtDt#
				, EMYMT_BGNN_DT=#emymtBgnnDt#
				, EMYMT_END_DT=#emymtEndDt#
				, HDOFC_DIV_CD=#hdofcDivCd#
				, RETRY_DT=#retryDt#
				, YRTX_APPTN_YR_MNTH=#yrtxApptnYrMnth#
				, YRTX_PRCS_DT=#yrtxPrcsDt#
				, YRTX_PRCS_YN=#yrtxPrcsYn#
				, DIVD_PYMT_DIV_CD=#divdPymtDivCd#
				, DIVD_PYMT=#divdPymt#
				, GNAN_SGTF=#gnanSgtf#
				, FRNR_YENO=#frnrYeno#
				, REYM_STDT=#reymStdt#
				, REYM_EDDT=#reymEddt#
				, RUTR_EDDT=#rutrEddt#
				, RUTR_STDT=#rutrStdt#
				, RESD_FLAG=#resdFlag#
				, NATN_GBCD=#natnGbcd#
				, NATN_NAME=#natnName#
				, REDT_GBCD=#redtGbcd#
				, REDT_NAME=#redtName#
				, HUMN_CGUE=#humnCgue#
				, FRNR_SGYN=#frnrSgyn#
				, BASE_WIYN=#baseWiyn#
				, BASE_FMLY=#baseFmly#
				, ADDR_CT70=#addrCt70#
				, ADDR_HDRC=#addrHdrc#
				, ADDR_FDSU=#addrFdsu#
				, ADDR_CLCT=#addrClct#
				, ADDR_BHCT=#addrBhct#
				, PANT_ONSU=#pantOnsu#
				, ADDR_MRCT=#addrMrct#
				, BNAT_PSNF=#bnatPsnf#
				, JNAT_PSNF=#jnatPsnf#
				, BPSS_TECH=#bpssTech#
				, BPSS_PULC=#bpssPulc#
				, BPSS_FECT=#bpssFect#
				, BPSS_SOLD=#bpssSold#
				, JPSS_PULC=#jpssPulc#
				, JPSS_SOLD=#jpssSold#
				, JPSS_TECH=#jpssTech#
				, JPSS_FECT=#jpssFect#
				, BRTR_PSCT=#brtrPsct#
				, BRTR_CICT=#brtrCict#
				, BRTR_ANSV=#brtrAnsv#
				, JRTR_CICT=#jrtrCict#
				, JRTR_CTAR=#jrtrCtar#
				, JRTR_PSCT=#jrtrPsct#
				, JRTR_PTAR=#jrtrPtar#
				, JRTR_ANSV=#jrtrAnsv#
				, JRTR_ATAR=#jrtrAtar#
				, RRPT_AMNT=#rrptAmnt#
				, SPCI_BHLH=#spciBhlh#
				, SPCI_HHLH=#spciHhlh#
				, SPCI_BEPF=#spciBepf#
				, SPCI_JEPF=#spciJepf#
				, SPCI_GURT=#spciGurt#
				, SPCI_HDRC=#spciHdrc#
				, SPCI_RTTG=#spciRttg#
				, SPCI_IUAM=#spciIuam#
				, SPCI_SELF=#spciSelf#
				, SPCI_AE65=#spciAe65#
				, SPCI_DBPS=#spciDbps#
				, SPCI_DETC=#spciDetc#
				, SPCI_DTAR=#spciDtar#
				, SPCI_ETAM=#spciEtam#
				, SPED_SELF=#spedSelf#
				, SPED_EDSU=#spedEdsu#
				, SPED_EDAM=#spedEdam#
				, SPED_GDSU=#spedGdsu#
				, SPED_GDAM=#spedGdam#
				, SPED_CVSU=#spedCvsu#
				, SPED_CVAM=#spedCvam#
				, SPCI_SCSU=#spciScsu#
				, SPCI_SCAM=#spciScam#
				, SPED_ETAR=#spedEtar#
				, SIED_TOAM=#siedToam#
				, SPCI_REFN=#spciRefn#
				, SPCI_RESF=#spciResf#
				, SPCI_HTAM=#spciHtam#
				, SPCH_REFN=#spchRefn#
				, SPCH_RE06=#spchRe06#
				, SPCH_RE10=#spchRe10#
				, SPCH_RE20=#spchRe20#
				, SPCH_REFX=#spchRefx#
				, SPCH_REEC=#spchReec#
				, SPCH_15FX=#spch15fx#
				, SPCH_15FB=#spch15fb#
				, SPCH_15EC=#spch15ec#
				, SPCH_10FB=#spch10fb#
				, SPCH_10EC=#spch10ec#
				, TAXD_PLTC=#taxdPltc#
				, TAXD_10TG=#taxd10tg#
				, SPCI_PLTC=#spciPltc#
				, SPCI_PLTG=#spciPltg#
				, SPCI_FBAM=#spciFbam#
				, SPCI_FBTG=#spciFbtg#
				, SPCI_EXAM=#spciExam#
				, SPCI_UNON=#spciUnon#
				, SPCI_HFAM=#spciHfam#
				, SPCI_YAMT=#spciYamt#
				, SPCI_NAMT=#spciNamt#
				, SPCI_DGTG=#spciDgtg#
				, SPCI_FNRL=#spciFnrl#
				, PRVM_20BE=#prvm20be#
				, PRVM_21AF=#prvm21af#
				, ETCH_PREP=#etchPrep#
				, ETCS_COMP=#etcsComp#
				, ETWK_HSVM=#etwkHsvm#
				, ETWK_HSBM=#etwkHsbm#
				, ETWK_HLGM=#etwkHlgm#
				, ETWK_HBDM=#etwkHbdm#
				, ETCT_CONC=#etctConc#
				, ETGD_H09F=#etgdH09f#
				, ETGD_H13F=#etgdH13f#
				, ETGD_H14F=#etgdH14f#
				, ETCL_H15F=#etclH15f#
				, ETGD_HDAM=#etgdHdam#
				, ETCT_CARD=#etctCard#
				, ETCH_BCBS=#etchBcbs#
				, ETCH_UEAM=#etchUeam#
				, ETCH_MGVD=#etchMgvd#
				, ETCH_BCED=#etchBced#
				, CARD_ET13=#cardEt13#
				, CARD_ET14=#cardEt14#
				, ETAD_DD13=#etadDd13#
				, ETAD_D14L=#etadD14l#
				, ETCH_BCUE=#etchBcue#
				, ETCK_UNON=#etckUnon#
				, ETCK_UNCB=#etckUncb#
				, ETEP_HSAM=#etepHsam#
				, ETGD_CTRA=#etgdCtra#
				, ETEP_SEST=#etepSest#
				, ETCL_HM01=#etclHm01#
				, ETCL_HM02=#etclHm02#
				, ETCL_HM03=#etclHm03#
				, ETCL_HMTA=#etclHmta#
				, ETCL_ETTL=#etclEttl#
				, ETCL_ETAM=#etclEtam#
				, TAXD_INCD=#taxdIncd#
				, TAXD_WKDT=#taxdWkdt#
				, TAMA_EDDT=#tamaEddt#
				, TAMA_INDT=#tamaIndt#
				, TAMA_OUDT=#tamaOudt#
				, TXLG_FRRD=#txlgFrrd#
				, TXLG_FRID=#txlgFrid#
				, TXLG_WKID=#txlgWkid#
				, TXLG_TXTD=#txlgTxtd#
				, TXLG_BSCD=#txlgBscd#
				, TXLG_BCDE=#txlgBcde#
				, TXLG_ITCT=#txlgItct#
				, TXLG_BSTA=#txlgBsta#
				, TXLG_WKTA=#txlgWkta#
				, TXLG_CLTA=#txlgClta#
				, TXLG_FRTA=#txlgFrta#
				, TXLG_TXTY=#txlgTxty#
				, TXLG_INAM=#txlgInam#
				, TXLG_DLAM=#txlgDlam#
				, TXLG_WNAM=#txlgWnam#
				, TXLG_OTCY=#txlgOtcy#
				, TXLG_OTDT=#txlgOtdt#
				, TXLG_APDT=#txlgApdt#
				, TXLG_OUWK=#txlgOuwk#
				, TXAP_STDT=#txapStdt#
				, TXAP_EDDT=#txapEddt#
				, TXAP_WKDY=#txapWkdy#
				, TAXD_UNIN=#taxdUnin#
				, TAXD_LOAA=#taxdLoaa#
				, ADDC_NTYN=#addcNtyn#
				, ADDC_MDYN=#addcMdyn#
				, ADDC_CTYN=#addcCtyn#
				, ADDC_PFYN=#addcPfyn#
				, ADDF_PVYN=#addfPvyn#
				, SPCI_REYN=#spciReyn#
				, TXLG_MXTM=#txlgMxtm#
				, INCO_OUDT=#incoOudt#
				, INCO_OUFG=#incoOufg#
				, JDOC_FILE=#jdocFile#
				, JRTR_ATOM=#jrtrAtom#
				, JRTR_TOTR=#jrtrTotr#
				, SPCI_HDTG=#spciHdtg#
				, SPCI_DETG=#spciDetg#
				, SPCI_RTTO=#spciRtto#
				, SPCI_SFTG=#spciSftg#
				, SPCI_65TG=#spci65tg#
				, SPCI_PSTG=#spciPstg#
				, SPCI_ETCG=#spciEtcg#
				, SPED_SFTR=#spedSftr#
				, SPED_EDTR=#spedEdtr#
				, SPED_GDTR=#spedGdtr#
				, SPED_CVTR=#spedCvtr#
				, SPCI_SCTR=#spciSctr#
				, SPCI_EXTG=#spciExtg#
				, SPCI_UNTG=#spciUntg#
				, SPCI_HFTG=#spciHftg#
				, SPCI_NATG=#spciNatg#
				, SPCI_YATG=#spciYatg#
				, SPCI_DGAM=#spciDgam#
				, SPCI_ONON=#spciOnon#
				, SPCI_OBAM=#spciObam#
				, SPCI_OYAM=#spciOyam#
				, SPCI_ONAM=#spciOnam# 
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
						WHERE DPOB_CD=#dpobCd#
								AND EDAC_RVYY=#edacRvyy#
								AND SETT_GBCD=#settGbcd#
								AND SYSTEMKEY=#systemkey#
				]]>
	</update>
	
	<delete id="ye17Ta2000_2022_DAO.deleteYeta3000_S">
		<![CDATA[
			DELETE FROM YETA2000 
						WHERE DPOB_CD=#dpobCd#
								AND EDAC_RVYY=#edacRvyy#
								AND SETT_GBCD=#settGbcd#
								AND SYSTEMKEY=#systemkey#
				]]>
	</delete>
	 
	<!-- yeta0100 연말정산 대상자관리  -->
	<delete id="ye17Ta2000_2022_DAO.fnPayr06420_PAYR415_CREATE_Delete_S">
		<![CDATA[
			DELETE FROM YETA2000 
						WHERE DPOB_CD=#dpobCd#
								AND EDAC_RVYY=#edacRvyy#
								AND SETT_GBCD=#settGbcd# 
				]]>
				  <isNotEmpty prepend="AND" property="systemkey" >
                      SYSTEMKEY=#systemkey#
                   </isNotEmpty> 
				
	</delete>   
	<!-- yeta1100 연말정산 대상자관리  -->
	<delete id="ye17Ta2000_2022_DAO.fnYeta1100_YETA2000_2016_CREATE_Delete_S">
		<![CDATA[
			DELETE FROM YETA2000 
						WHERE DPOB_CD=#dpobCd#
								AND EDAC_RVYY=#edacRvyy#
								AND SETT_GBCD=#settGbcd# 
				]]>
				  <isNotEmpty prepend="AND" property="systemkey" >
                      SYSTEMKEY=#systemkey#
                   </isNotEmpty> 
				
	</delete>
	<select id="ye17Ta2000_2022_DAO.selectYeta3000_S" resultMap="ye17Ta2000_2022">
		<![CDATA[
			SELECT
				DPOB_CD
				, EDAC_RVYY
				, SETT_GBCD
				, SYSTEMKEY
				, EDAC_SEIL_NUM
				, PAYR_MANG_DEPT_CD
				, EMYMT_DIV_CD
				, HAN_NM
				, RESN_REGN_NUM
				, DEPT_CD
				, BUSIN_CD
				, TYP_OCCU_CD
				, DTIL_OCCU_INTTN_CD
				, DTIL_OCCU_CLS_DIV_CD
				, ODTY_CD
				, PYSP_CD
				, PYSP_GRDE_CD
				, LOG_SVC_YR_NUM_CD
				, LOG_SVC_MNTH_ICM_CD
				, FRST_EMYMT_DT
				, EMYMT_BGNN_DT
				, EMYMT_END_DT
				, HDOFC_DIV_CD
				, RETRY_DT
				, YRTX_APPTN_YR_MNTH
				, YRTX_PRCS_DT
				, YRTX_PRCS_YN
				, DIVD_PYMT_DIV_CD
				, DIVD_PYMT
				, GNAN_SGTF
				, FRNR_YENO
				, REYM_STDT
				, REYM_EDDT
				, RUTR_EDDT
				, RUTR_STDT
				, RESD_FLAG
				, NATN_GBCD
				, NATN_NAME
				, REDT_GBCD
				, REDT_NAME
				, HUMN_CGUE
				, FRNR_SGYN
				, BASE_WIYN
				, BASE_FMLY
				, ADDR_CT70
				, ADDR_HDRC
				, ADDR_FDSU
				, ADDR_CLCT
				, ADDR_BHCT
				, PANT_ONSU
				, ADDR_MRCT
				, BNAT_PSNF
				, JNAT_PSNF
				, BPSS_TECH
				, BPSS_PULC
				, BPSS_FECT
				, BPSS_SOLD
				, JPSS_PULC
				, JPSS_SOLD
				, JPSS_TECH
				, JPSS_FECT
				, BRTR_PSCT
				, BRTR_CICT
				, BRTR_ANSV
				, JRTR_CICT
				, JRTR_CTAR
				, JRTR_PSCT
				, JRTR_PTAR
				, JRTR_ANSV
				, JRTR_ATAR
				, RRPT_AMNT
				, SPCI_BHLH
				, SPCI_HHLH
				, SPCI_BEPF
				, SPCI_JEPF
				, SPCI_GURT
				, SPCI_HDRC
				, SPCI_RTTG
				, SPCI_IUAM
				, SPCI_SELF
				, SPCI_AE65
				, SPCI_DBPS
				, SPCI_DETC
				, SPCI_DTAR
				, SPCI_ETAM
				, SPED_SELF
				, SPED_EDSU
				, SPED_EDAM
				, SPED_GDSU
				, SPED_GDAM
				, SPED_CVSU
				, SPED_CVAM
				, SPCI_SCSU
				, SPCI_SCAM
				, SPED_ETAR
				, SIED_TOAM
				, SPCI_REFN
				, SPCI_RESF
				, SPCI_HTAM
				, SPCH_REFN
				, SPCH_RE06
				, SPCH_RE10
				, SPCH_RE20
				, SPCH_REFX
				, SPCH_REEC
				, SPCH_15FX
				, SPCH_15FB
				, SPCH_15EC
				, SPCH_10FB
				, SPCH_10EC
				, TAXD_PLTC
				, TAXD_10TG
				, SPCI_PLTC
				, SPCI_PLTG
				, SPCI_FBAM
				, SPCI_FBTG
				, SPCI_EXAM
				, SPCI_UNON
				, SPCI_HFAM
				, SPCI_YAMT
				, SPCI_NAMT
				, SPCI_DGTG
				, SPCI_FNRL
				, PRVM_20BE
				, PRVM_21AF
				, ETCH_PREP
				, ETCS_COMP
				, ETWK_HSVM
				, ETWK_HSBM
				, ETWK_HLGM
				, ETWK_HBDM
				, ETCT_CONC
				, ETGD_H09F
				, ETGD_H13F
				, ETGD_H14F
				, ETCL_H15F
				, ETGD_HDAM
				, ETCT_CARD
				, ETCH_BCBS
				, ETCH_UEAM
				, ETCH_MGVD
				, ETCH_BCED
				, CARD_ET13
				, CARD_ET14
				, ETAD_DD13
				, ETAD_D14L
				, ETCH_BCUE
				, ETCK_UNON
				, ETCK_UNCB
				, ETEP_HSAM
				, ETGD_CTRA
				, ETEP_SEST
				, ETCL_HM01
				, ETCL_HM02
				, ETCL_HM03
				, ETCL_HMTA
				, ETCL_ETTL
				, ETCL_ETAM
				, TAXD_INCD
				, TAXD_WKDT
				, TAMA_EDDT
				, TAMA_INDT
				, TAMA_OUDT
				, TXLG_FRRD
				, TXLG_FRID
				, TXLG_WKID
				, TXLG_TXTD
				, TXLG_BSCD
				, TXLG_BCDE
				, TXLG_ITCT
				, TXLG_BSTA
				, TXLG_WKTA
				, TXLG_CLTA
				, TXLG_FRTA
				, TXLG_TXTY
				, TXLG_INAM
				, TXLG_DLAM
				, TXLG_WNAM
				, TXLG_OTCY
				, TXLG_OTDT
				, TXLG_APDT
				, TXLG_OUWK
				, TXAP_STDT
				, TXAP_EDDT
				, TXAP_WKDY
				, TAXD_UNIN
				, TAXD_LOAA
				, ADDC_NTYN
				, ADDC_MDYN
				, ADDC_CTYN
				, ADDC_PFYN
				, ADDF_PVYN
				, SPCI_REYN
				, TXLG_MXTM
				, INCO_OUDT
				, INCO_OUFG
				, JDOC_FILE
				, JRTR_ATOM
				, JRTR_TOTR
				, SPCI_HDTG
				, SPCI_DETG
				, SPCI_RTTO
				, SPCI_SFTG
				, SPCI_65TG
				, SPCI_PSTG
				, SPCI_ETCG
				, SPED_SFTR
				, SPED_EDTR
				, SPED_GDTR
				, SPED_CVTR
				, SPCI_SCTR
				, SPCI_EXTG
				, SPCI_UNTG
				, SPCI_HFTG
				, SPCI_NATG
				, SPCI_YATG
				, SPCI_DGAM
				, SPCI_ONON
				, SPCI_OBAM
				, SPCI_OYAM
				, SPCI_ONAM
				, KYBDR
				, INPT_DT
				, INPT_ADDR
				, ISMT
				, REVN_DT
				, REVN_ADDR
			FROM YETA2000
						WHERE DPOB_CD=#dpobCd#
								AND EDAC_RVYY=#edacRvyy#
								AND SETT_GBCD=#settGbcd#
								AND SYSTEMKEY=#systemkey#
				]]>
	</select>
	
	
	 
	
	<select id="ye17Ta2000_2022_DAO.selectYeta3000List_D" parameterClass="ye17Ta2000Srh_2022_Vo" resultClass="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (
			SELECT
								DPOB_CD
								, EDAC_RVYY
								, SETT_GBCD
								, SYSTEMKEY
								, EDAC_SEIL_NUM
								, PAYR_MANG_DEPT_CD
								, EMYMT_DIV_CD
								, HAN_NM
								, RESN_REGN_NUM
								, DEPT_CD
								, BUSIN_CD
								, TYP_OCCU_CD
								, DTIL_OCCU_INTTN_CD
								, DTIL_OCCU_CLS_DIV_CD
								, ODTY_CD
								, PYSP_CD
								, PYSP_GRDE_CD
								, LOG_SVC_YR_NUM_CD
								, LOG_SVC_MNTH_ICM_CD
								, FRST_EMYMT_DT
								, EMYMT_BGNN_DT
								, EMYMT_END_DT
								, HDOFC_DIV_CD
								, RETRY_DT
								, YRTX_APPTN_YR_MNTH
								, YRTX_PRCS_DT
								, YRTX_PRCS_YN
								, DIVD_PYMT_DIV_CD
								, DIVD_PYMT
								, GNAN_SGTF
								, FRNR_YENO
								, REYM_STDT
								, REYM_EDDT
								, RUTR_EDDT
								, RUTR_STDT
								, RESD_FLAG
								, NATN_GBCD
								, NATN_NAME
								, REDT_GBCD
								, REDT_NAME
								, HUMN_CGUE
								, FRNR_SGYN
								, BASE_WIYN
								, BASE_FMLY
								, ADDR_CT70
								, ADDR_HDRC
								, ADDR_FDSU
								, ADDR_CLCT
								, ADDR_BHCT
								, PANT_ONSU
								, ADDR_MRCT
								, BNAT_PSNF
								, JNAT_PSNF
								, BPSS_TECH
								, BPSS_PULC
								, BPSS_FECT
								, BPSS_SOLD
								, JPSS_PULC
								, JPSS_SOLD
								, JPSS_TECH
								, JPSS_FECT
								, BRTR_PSCT
								, BRTR_CICT
								, BRTR_ANSV
								, JRTR_CICT
								, JRTR_CTAR
								, JRTR_PSCT
								, JRTR_PTAR
								, JRTR_ANSV
								, JRTR_ATAR
								, RRPT_AMNT
								, SPCI_BHLH
								, SPCI_HHLH
								, SPCI_BEPF
								, SPCI_JEPF
								, SPCI_GURT
								, SPCI_HDRC
								, SPCI_RTTG
								, SPCI_IUAM
								, SPCI_SELF
								, SPCI_AE65
								, SPCI_DBPS
								, SPCI_DETC
								, SPCI_DTAR
								, SPCI_ETAM
								, SPED_SELF
								, SPED_EDSU
								, SPED_EDAM
								, SPED_GDSU
								, SPED_GDAM
								, SPED_CVSU
								, SPED_CVAM
								, SPCI_SCSU
								, SPCI_SCAM
								, SPED_ETAR
								, SIED_TOAM
								, SPCI_REFN
								, SPCI_RESF
								, SPCI_HTAM
								, SPCH_REFN
								, SPCH_RE06
								, SPCH_RE10
								, SPCH_RE20
								, SPCH_REFX
								, SPCH_REEC
								, SPCH_15FX
								, SPCH_15FB
								, SPCH_15EC
								, SPCH_10FB
								, SPCH_10EC
								, TAXD_PLTC
								, TAXD_10TG
								, SPCI_PLTC
								, SPCI_PLTG
								, SPCI_FBAM
								, SPCI_FBTG
								, SPCI_EXAM
								, SPCI_UNON
								, SPCI_HFAM
								, SPCI_YAMT
								, SPCI_NAMT
								, SPCI_DGTG
								, SPCI_FNRL
								, PRVM_20BE
								, PRVM_21AF
								, ETCH_PREP
								, ETCS_COMP
								, ETWK_HSVM
								, ETWK_HSBM
								, ETWK_HLGM
								, ETWK_HBDM
								, ETCT_CONC
								, ETGD_H09F
								, ETGD_H13F
								, ETGD_H14F
								, ETCL_H15F
								, ETGD_HDAM
								, ETCT_CARD
								, ETCH_BCBS
								, ETCH_UEAM
								, ETCH_MGVD
								, ETCH_BCED
								, CARD_ET13
								, CARD_ET14
								, ETAD_DD13
								, ETAD_D14L
								, ETCH_BCUE
								, ETCK_UNON
								, ETCK_UNCB
								, ETEP_HSAM
								, ETGD_CTRA
								, ETEP_SEST
								, ETCL_HM01
								, ETCL_HM02
								, ETCL_HM03
								, ETCL_HMTA
								, ETCL_ETTL
								, ETCL_ETAM
								, TAXD_INCD
								, TAXD_WKDT
								, TAMA_EDDT
								, TAMA_INDT
								, TAMA_OUDT
								, TXLG_FRRD
								, TXLG_FRID
								, TXLG_WKID
								, TXLG_TXTD
								, TXLG_BSCD
								, TXLG_BCDE
								, TXLG_ITCT
								, TXLG_BSTA
								, TXLG_WKTA
								, TXLG_CLTA
								, TXLG_FRTA
								, TXLG_TXTY
								, TXLG_INAM
								, TXLG_DLAM
								, TXLG_WNAM
								, TXLG_OTCY
								, TXLG_OTDT
								, TXLG_APDT
								, TXLG_OUWK
								, TXAP_STDT
								, TXAP_EDDT
								, TXAP_WKDY
								, TAXD_UNIN
								, TAXD_LOAA
								, ADDC_NTYN
								, ADDC_MDYN
								, ADDC_CTYN
								, ADDC_PFYN
								, ADDF_PVYN
								, SPCI_REYN
								, TXLG_MXTM
								, INCO_OUDT
								, INCO_OUFG
								, JDOC_FILE
								, JRTR_ATOM
								, JRTR_TOTR
								, SPCI_HDTG
								, SPCI_DETG
								, SPCI_RTTO
								, SPCI_SFTG
								, SPCI_65TG
								, SPCI_PSTG
								, SPCI_ETCG
								, SPED_SFTR
								, SPED_EDTR
								, SPED_GDTR
								, SPED_CVTR
								, SPCI_SCTR
								, SPCI_EXTG
								, SPCI_UNTG
								, SPCI_HFTG
								, SPCI_NATG
								, SPCI_YATG
								, SPCI_DGAM
								, SPCI_ONON
								, SPCI_OBAM
								, SPCI_OYAM
								, SPCI_ONAM
								, KYBDR
								, INPT_DT
								, INPT_ADDR
								, ISMT
								, REVN_DT
								, REVN_ADDR
						FROM YETA2000
				WHERE 1=1
				<isEqual prepend="AND" property="searchCondition" compareValue="0">
					DPOB_CD = #searchKeyword#
				</isEqual>
				<isEqual prepend="AND" property="searchCondition" compareValue="1">
					EDAC_RVYY LIKE '%' || #searchKeyword# || '%'
				</isEqual>
					ORDER BY 
						DPOB_CD DESC
							, EDAC_RVYY DESC
							, SETT_GBCD DESC
							, SYSTEMKEY DESC
		
		<![CDATA[					
	) A WHERE ROWNUM <= #lastIndex#
)WHERE RNUM >= #firstIndex#
]]>
	</select>	
	
	<select id="ye17Ta2000_2022_DAO.selectYeta3000ListTotCnt_S" parameterClass="ye17Ta2000Srh_2022_Vo" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM YETA2000
			WHERE 
			<isEqual prepend="AND" property="searchCondition" compareValue="0">
				DPOB_CD = #searchKeyword#
			</isEqual>
			<isEqual prepend="AND" property="searchCondition" compareValue="1">
				EDAC_RVYY LIKE '%' || #searchKeyword# || '%'
			</isEqual>
	</select>
	
	
	<!-- 대상자정보 리스트를 구하는 쿼리 ( 기본정보는 PSNL0100에서 가져옴 ) 	--> <!-- , AA.ETCT_CONC -->
	<select id="ye17Ta2000_2022_DAO.selectYeta0300To2000List" parameterClass="ye17Ta2000Srh_2022_Vo" resultClass="egovMap">
		SELECT * FROM (
			SELECT A.*, ROWNUM RNUM FROM (
						SELECT
										  FF.DPOB_CD
										, AA.EDAC_RVYY
										, AA.SETT_GBCD
										, fcBass0300CDNM(AA.DPOB_CD, AA.SETT_GBCD) AS SETT_GBNM
										, FF.SYSTEMKEY
										, AA.EDAC_SEIL_NUM
										, FF.PAYR_MANG_DEPT_CD
										, FF.EMYMT_DIV_CD
										, FF.HAN_NM
										, FF.RESN_REGN_NUM
										, FF.DEPT_CD
										, fcBass0400CDNM(FF.DPOB_CD, FF.DEPT_CD,'2') AS DEPT_NM
										, FF.BUSIN_CD
										, FCBASS0500CDNM (FF.DPOB_CD, SUBSTR (FF.EMYMT_BGNN_DT, 1, 4), FF.DEPT_CD, FF.BUSIN_CD) AS BUSIN_NM
										, FF.TYP_OCCU_CD
										, fcBass0320CDNM(FF.DPOB_CD, FF.TYP_OCCU_CD) AS TYP_OCCU_NM
										, FF.DTIL_OCCU_INTTN_CD
										, fcBassEx0350CDNM(FF.DPOB_CD, FF.TYP_OCCU_CD, FF.DTIL_OCCU_INTTN_CD,'1' ) AS DTIL_OCCU_INTTN_NM 
										, FF.ODTY_CD
										, FF.PYSP_CD 
										, FF.LOG_SVC_YR_NUM_CD
										, FF.LOG_SVC_MNTH_ICM_CD
										, FF.FRST_EMYMT_DT
										, FF.EMYMT_BGNN_DT
										, FF.EMYMT_END_DT
										, AA.HDOFC_DIV_CD
										, FF.RETRY_DT
										, AA.YRTX_APPTN_YR_MNTH
										, AA.YRTX_PRCS_DT
										, AA.YRTX_PRCS_YN
										, AA.DIVD_PYMT_DIV_CD
										, AA.DIVD_PYMT
										, AA.GNAN_SGTF
										, AA.FRNR_YENO
										, AA.REYM_STDT
										, AA.REYM_EDDT
										, AA.RUTR_EDDT
										, AA.RUTR_STDT
										, AA.RESD_FLAG
										, AA.NATN_GBCD
										, fcBass0300ITEMNM(AA.DPOB_CD, AA.NATN_GBCD, '12')AS NATN_ITEM
										, AA.NATN_NAME
										, AA.REDT_GBCD
										, AA.REDT_NAME                                       
										, fcBass0300ITEMNM(AA.DPOB_CD, AA.REDT_GBCD, '12')AS REDT_ITEM
										, AA.HUMN_CGUE
										, AA.FRNR_SGYN
										, AA.BASE_WIYN
										, AA.BASE_FMLY
										, AA.ADDR_CT70
										, AA.ADDR_HDRC
										, AA.ADDR_FDSU
										, AA.ADDR_CLCT
										, AA.ADDR_BHCT
										, AA.PANT_ONSU
										, AA.ADDR_MRCT
										, AA.BNAT_PSNF
										, AA.JNAT_PSNF
										, AA.BPSS_FECT
										, AA.BPSS_PULC
										, AA.JPSS_PULC
										, AA.JPSS_SOLD
										, AA.JPSS_TECH
										, AA.JPSS_FECT
										, AA.BRTR_PSCT
										, AA.BRTR_CICT
										, AA.BRTR_ANSV
										, AA.JRTR_CICT
										, AA.JRTR_CTAR
										, AA.JRTR_PSCT
										, AA.JRTR_PTAR
										, AA.JRTR_ANSV
										, AA.JRTR_ATAR
										, AA.RRPT_AMNT
										, AA.SPCI_BHLH
										, AA.SPCI_HHLH
										, AA.SPCI_BEPF
										, AA.SPCI_JEPF
										, AA.SPCI_GURT
										, AA.SPCI_HDRC
										, AA.SPCI_RTTG
										, AA.SPCI_IUAM
										, AA.SPCI_SELF
										, AA.SPCI_AE65
										, AA.SPCI_DBPS
										, AA.SPCI_DETC
										, AA.SPCI_DTAR
										, AA.SPCI_ETAM
										, AA.SPED_SELF
										, AA.SPED_EDSU
										, AA.SPED_EDAM
										, AA.SPED_GDSU
										, AA.SPED_GDAM
										, AA.SPED_CVSU
										, AA.SPED_CVAM
										, AA.SPCI_SCSU
										, AA.SPCI_SCAM
										, AA.SPED_ETAR
										, AA.SIED_TOAM
										, AA.SPCI_REFN
										, AA.SPCI_RESF
										, AA.SPCI_HTAM
										, AA.SPCH_REFN
										, AA.SPCH_RE06
										, AA.SPCH_RE10
										, AA.SPCH_RE20
										, AA.SPCH_REFX
										, AA.SPCH_REEC
										, AA.SPCH_15FX
										, AA.SPCH_15FB
										, AA.SPCH_15EC
										, AA.SPCH_10FB
										, AA.SPCH_10EC
										, AA.TAXD_PLTC
										, AA.TAXD_10TG
										, AA.SPCI_PLTC
										, AA.SPCI_PLTG
										, AA.SPCI_FBAM
										, AA.SPCI_FBTG
										, AA.SPCI_EXAM
										, AA.SPCI_UNON
										, AA.SPCI_HFAM
										, AA.SPCI_YAMT
										, AA.SPCI_NAMT
										, AA.SPCI_DGTG
										, AA.SPCI_FNRL
										, AA.PRVM_20BE
										, AA.PRVM_21AF
										, AA.ETCH_PREP
										, AA.ETCS_COMP
										, AA.ETWK_HSVM
										, AA.ETWK_HSBM
										, AA.ETWK_HLGM
										, AA.ETWK_HBDM 
										, AA.ETGD_H09F
										, AA.ETGD_H13F
										, AA.ETGD_H14F
										, AA.ETCL_H15F
										, AA.ETGD_HDAM
										, AA.ETCT_CARD
										, AA.ETCH_BCBS
										, AA.ETCH_UEAM
										, AA.ETCH_MGVD
										, AA.ETCH_BCED
										, AA.CARD_ET13
										, AA.CARD_ET14
										, AA.ETAD_DD13
										, AA.ETAD_D14L
										, AA.ETCH_BCUE
										, AA.ETCK_UNON
										, AA.ETCK_UNCB
										, AA.ETEP_HSAM
										, AA.ETGD_CTRA
										, AA.ETEP_SEST
										, AA.ETCL_HM01
										, AA.ETCL_HM02
										, AA.ETCL_HM03
										, AA.ETCL_HMTA
										, AA.ETCL_ETTL
										, AA.ETCL_ETAM
										, AA.TAXD_INCD
										, AA.YREN_SGYN
										, AA.ADD_INCM_TX_APPTN_RTO_CD
										, AA.FRNR_RNYN
										, SUBSTR(NVL(AA.TAXD_INCD,'NNNN'),1,1) AS TAXD_INCD1
										, SUBSTR(NVL(AA.TAXD_INCD,'NNNN'),2,1) AS TAXD_INCD2
										, SUBSTR(NVL(AA.TAXD_INCD,'NNNN'),3,1) AS TAXD_INCD3
										, SUBSTR(NVL(AA.TAXD_INCD,'NNNN'),4,1) AS TAXD_INCD4
										, AA.TAXD_WKDT
										, AA.TAMA_EDDT
										, AA.TAMA_INDT
										, AA.TAMA_OUDT
										, AA.TXLG_FRRD
										, AA.TXLG_FRID
										, AA.TXLG_WKID
										, AA.TXLG_TXTD
										, AA.TXLG_BSCD
										, AA.TXLG_BCDE
										, AA.TXLG_ITCT
										, AA.TXLG_BSTA
										, AA.TXLG_WKTA
										, AA.TXLG_CLTA
										, AA.TXLG_FRTA
										, AA.TXLG_TXTY
										, AA.TXLG_INAM
										, AA.TXLG_DLAM
										, AA.TXLG_WNAM
										, AA.TXLG_OTCY
										, AA.TXLG_OTDT
										, AA.TXLG_APDT
										, AA.TXLG_OUWK
										, AA.TXAP_STDT
										, AA.TXAP_EDDT
										, AA.TXAP_WKDY
										, AA.TAXD_UNIN
										, AA.TAXD_LOAA
										, AA.ADDC_NTYN
										, AA.ADDC_MDYN
										, AA.ADDC_CTYN
										, AA.ADDC_PFYN
										, AA.ADDF_PVYN
										, AA.SPCI_REYN
										, AA.TXLG_MXTM
										, AA.INCO_OUDT
										, AA.INCO_OUFG
										, AA.JDOC_FILE
										, AA.JRTR_ATOM
										, AA.JRTR_TOTR
										, AA.SPCI_HDTG
										, AA.SPCI_DETG
										, AA.SPCI_RTTO
										, AA.SPCI_SFTG
										, AA.SPCI_65TG
										, AA.SPCI_PSTG
										, AA.SPCI_ETCG
										, AA.SPED_SFTR
										, AA.SPED_EDTR
										, AA.SPED_GDTR
										, AA.SPED_CVTR
										, AA.SPCI_SCTR
										, AA.SPCI_EXTG
										, AA.SPCI_UNTG
										, AA.SPCI_HFTG
										, AA.SPCI_NATG
										, AA.SPCI_YATG
										, AA.SPCI_DGAM
										, AA.SPCI_ONON
										, AA.SPCI_OBAM
										, AA.SPCI_OYAM
										, AA.SPCI_ONAM
										, AA.ETAD_D16L
										, AA.ETCL_H15B
										, AA.KYBDR
										, AA.INPT_DT
										, AA.INPT_ADDR
										, AA.ISMT
										, AA.REVN_DT
										, AA.REVN_ADDR							
										, AA.CARD_ET15
										, AA.ETAD_D15H
										, AA.ETAD_D15L
										, AA.ETGD_H14B
										, AA.ETCL_H16F
										, AA.ETCL_H16B
										, EE.BEFO_SCNT
										, EE.PAYR_TAMT
										, EE.BONS_TOAM
										, EE.DTMN_BSAM
										, EE.STCK_PRFT
										, EE.CURR_TOTS
										, EE.TAXM_SFAM
										, EE.TAXM_ETAM
										, EE.TAXM_BOIN
										, EE.TXEC_AMNT
										, EE.TOTL_SALA
										, EE.WKER_DDCT
										, EE.WKER_AMNT
										, EE.BASE_SELF
										, EE.BASE_WIFE
										, EE.BASE_FYAM
										, EE.ADDR_HDAM
										, EE.ADDR_RPT70
										, EE.ADDR_FAME
										, EE.ADDR_CHLD
										, EE.ADDR_BRTH
										, EE.PANT_ONAM
										, EE.ADDR_MCAM
										, EE.BNAT_DDCT
										, EE.JNAT_DDCT
										, EE.BPSS_DDCT
										, EE.BPSS_HSOL
										, EE.BPSS_HTEC
										, EE.BPSS_HPUL
										, EE.JPSS_DDCT
										, EE.JPSS_HSOL
										, EE.JPSS_HTEC
										, EE.JPSS_HPUL
										, EE.BRTR_HICT
										, EE.BRTR_PSRN
										, EE.BRTR_HNSV
										, EE.JRTR_HICT
										, EE.JRTR_PSRN
										, EE.JRTR_HNSV
										, EE.RRPT_YNAM
										, EE.SPCI_BHTH
										, EE.SPCI_JHTH
										, EE.SPCI_BEPF AS SPCI_BEPF01
										, EE.SPCI_JEPF AS SPCI_JEPF01
										, EE.SPCI_GURT AS SPCI_GURT01
										, EE.SPCI_HDRC AS SPCI_HDRC01
										, EE.SPCI_RTDE
										, EE.SPCI_HRTO 
										, EE.SPCI_SELF AS SPCI_SELF01
										, EE.SPCI_HE65
										, EE.SPCI_HBPS
										, EE.SPCI_DETC AS SPCI_DETC01
										, EE.SPCI_TXCR
										, EE.SPCI_METO
										, EE.SPED_SELF AS SPED_SELF01
										, EE.SPED_GRDE
										, EE.SPED_GDTO
										, EE.SPED_CLDV
										, EE.SPCI_SPEC
										, EE.SPED_TXCR
										, EE.SPED_TOAM
										, EE.SPCI_REFN AS SPCI_REFN01
										, EE.SPCI_RESF AS SPCI_RESF01
										, EE.SPCI_TGRT
										, EE.SPCI_RTAM
										, EE.SPCH_REFN AS SPCH_REFN01
										, EE.SPCH_RE15
										, EE.SPCH_RE29
										, EE.SPCH_RE30
										, EE.SPCI_REFX
										, EE.SPCI_REEC
										, EE.SPCI_15FX
										, EE.SPCI_15FB
										, EE.SPCI_15EC
										, EE.SPCI_10FB
										, EE.SPCI_10EC
										, EE.SPCH_RETO
										, EE.TAXD_PLTC AS TAXD_PLTC01
										, EE.SPCI_PLTC AS SPCI_PLTC01
										, EE.SPCI_FBAM AS SPCI_FBAM01
										, EE.SPCI_EXAM AS SPCI_EXAM01
										, EE.SPCI_UNON AS SPCI_UNON01
										, EE.SPCI_RFAM
										, EE.SPCI_YAMT AS SPCI_YAMT01
										, EE.SPCI_NAMT AS SPCI_NAMT01
										, EE.SPCI_DGCR
										, EE.SPCI_SSUM
										, EE.SPCI_DDCT
										, EE.SUBT_ERAM
										, EE.ETCP_PSNV
										, EE.ETCP_NSAV
										, EE.PRCM_TOAM
										, EE.ETCH_PREP AS ETCH_PREP01
										, EE.ETCS_COMP AS ETCS_COMP01
										, EE.ETWK_SBAM
										, EE.ETWK_SVAM
										, EE.ETWK_LGAM
										, EE.ETWK_BDAM
										, EE.ETGD_09AF
										, EE.ETGD_H13H
										, EE.ETGD_D14F
										, EE.ETGD_D14B
										, EE.ETGD_D15F
										, EE.ETGD_D15B
										, EE.ETGD_D16F
										, EE.ETGD_D16B
										, EE.ETGD_DDAM
										, EE.ETCC_CARD
										, EE.ETCK_UNON AS ETCK_UNON01
										, EE.ETCK_UNCR
										, EE.ETEP_MSAM
										, EE.ETGD_HTRA
										, EE.ETEP_SECR
										, EE.ETCL_TO01
										, EE.ETCL_TO02
										, EE.ETCL_TO03
										, EE.ETCL_HMTO
										, EE.ETCD_TSUM
										, EE.SPCH_EXLI
										, EE.STND_INCM
										, EE.PRDD_TAXN
										, EE.TAXD_ICAX
										, EE.TAXD_SPCT
										, EE.TXLG_CL30
										, EE.TXLG_HXTT
										, EE.TAXD_TSUM
										, EE.TAXD_WKEN
										, EE.TAXD_UNIN AS TAXD_UNIN_01
										, EE.TAXD_LOAN
										, EE.TAXD_PAID
										, EE.TAXD_REDU
										, EE.ADDR_MCCR
										, EE.SPCI_DCTO
										, EE.TAXD_CSUM
										, EE.DCSN_INCM
										, EE.DCSN_INHB
										, EE.DCSN_FAFV
										, EE.ALRY_PINX
										, EE.ALRY_PHBX
										, EE.ALRY_YVTX
										, EE.DCSN_TOTS
										, EE.DCSN_ITAX
										, EE.DCSN_BTAX
										, EE.FAFV_TAXI
										, EE.SUBT_ETAX
										, EE.SUBT_INHB
										, EE.SUBT_FAFV
										, EE.SUBT_AMSU
										, EE.JRTR_HNTO
										, EE.SPCI_OBAM AS SPCI_OBAM01
										, EE.SPCI_OYAM AS SPCI_OYAM01
										, EE.SPCI_ONAM AS SPCI_ONAM01
						FROM YETA2000 AA,   (
						SELECT    DISTINCT  AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD01.DTIL_OCCU_CLS_DIV_CD,  DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD01.DTIL_OCCU_CLS_DIV_CD,AD01.DTIL_OCCU_CLS_DIV_CD) ) AS DTIL_OCCU_CLS_DIV_CD 
                                          , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01,  (SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYMT_YR_MNTH, PAYR_SEIL_NUM, PAY_CD,
                                                                           PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PAYR0304
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYYT_YR_MNTH,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                            PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PYYT0304) AD02,
                                                ( SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #edacRvyy# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                    SELECT      MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304  
																		 WHERE   PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                          GROUP BY SYSTEMKEY
																      ) 
									                                            )
									                                              GROUP BY  DPOB_CD,  
                                                                                 SYSTEMKEY 
									                                            ) MM   
									                                             ) GG
									                            WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                               /*     AND NN.PAYR_SEIL_NUM =  GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #edacRvyy# ||'%'  
						
						 ) FF, YETA3000 EE
						WHERE   AA.DPOB_CD = FF.DPOB_CD
							AND AA.DPOB_CD = EE.DPOB_CD 
							AND AA.SYSTEMKEY = FF.SYSTEMKEY 
							AND AA.SYSTEMKEY = EE.SYSTEMKEY 
							AND AA.SETT_GBCD = EE.SETT_GBCD 
							AND AA.EDAC_RVYY = EE.EDAC_RVYY  
							<isNotEmpty prepend="AND" property="dpobCd" >
							 	FF.DPOB_CD=#dpobCd#
						    </isNotEmpty>
						    AND EXISTS  (
		                         SELECT  C.DPOB_CD,
		                                 C.DTIL_OCCU_INTTN_CD,
		                                 C.TYP_OCCU_CD,
		                                 C.DEPT_CD FROM 
		                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#edacRvyy# )) ) C
		                                            WHERE     C.DPOB_CD = FF.DPOB_CD
								                        AND C.DEPT_CD = FF.DEPT_CD
								                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(FF.TYP_OCCU_CD,'TT') 
		                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(FF.DTIL_OCCU_INTTN_CD,'TT')
		                                               <isNotEmpty property="deptCd" prepend="AND">
														<![CDATA[
														 C.DEPT_CD
														]]>
														<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
														 #deptCdArr[]#
														</iterate>
														</isNotEmpty> 
		                                          )
		                   
		                    <isNotEmpty prepend="AND" property="businCd" >
							 	FF.BUSIN_CD=#businCd#
						    </isNotEmpty> 
							<isNotEmpty prepend="AND" property="payrMangDeptCd" >
							 	FF.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
						    </isNotEmpty> 
						    <isNotEmpty prepend="AND" property="emymtDivCd" >
							 	FF.EMYMT_DIV_CD=#emymtDivCd#
							</isNotEmpty>
							<isNotEmpty prepend="AND" property="edacRvyy" >
							 	AA.EDAC_RVYY = #edacRvyy#
						    </isNotEmpty>  
						    <isNotEmpty property="typOccuCd" prepend="AND">
								<![CDATA[
									 FF.TYP_OCCU_CD
								]]>
								<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
								 	 #typOccuCdArr[]#
								</iterate>
							</isNotEmpty>  
						 <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
								<![CDATA[
									 FF.DTIL_OCCU_INTTN_CD
								]]>
								<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
									 #dtilOccuInttnCdArr[]#
								</iterate>
							</isNotEmpty>  
						    <isNotEmpty prepend="AND" property="systemkey" >
							 	FF.SYSTEMKEY=#systemkey#
						    </isNotEmpty>  
						    <isNotEmpty prepend="AND" property="hanNm" >
							 	FF.HAN_NM LIKE '%' || #hanNm# || '%'
						    </isNotEmpty> 
						    <isNotEmpty prepend="AND" property="settGbcd" >
							 	AA.SETT_GBCD=#settGbcd#
						    </isNotEmpty>
						    <isEqual prepend="AND" property="printType" compareValue="YETA3140">
								 EXISTS ( SELECT GG.SYSTEMKEY
									    	FROM YETA3140 GG
									    	WHERE AA.DPOB_CD = GG.DPOB_CD
									    		AND AA.SYSTEMKEY = GG.SYSTEMKEY 
									    	 	AND AA.SETT_GBCD = GG.SETT_GBCD 
									    	 	AND AA.EDAC_RVYY = GG.EDAC_RVYY 
						    	)
							</isEqual>
							<isEqual prepend="AND" property="printType" compareValue="YETA3170">
								 EXISTS ( SELECT GG.SYSTEMKEY
									    	FROM YETA3170 GG
									    	WHERE AA.DPOB_CD = GG.DPOB_CD
									    		AND AA.SYSTEMKEY = GG.SYSTEMKEY 
									    	 	AND AA.SETT_GBCD = GG.SETT_GBCD 
									    	 	AND AA.EDAC_RVYY = GG.EDAC_RVYY 
						    	)
							</isEqual>
						    ORDER BY 
								FF.DPOB_CD DESC
								, (SELECT LPAD(DEPT_RANK,5,'0')  
                                   FROM BASS0400 DD
                                   WHERE DD.DEPT_CD = FF.DEPT_CD
                                     AND DD.DPOB_CD = FF.DPOB_CD) ASC
		                        , FF.RESN_REGN_NUM ASC
							    , FF.SYSTEMKEY DESC 
				
				<![CDATA[					
			) A WHERE ROWNUM <= #lastIndex#
		)WHERE RNUM >= #firstIndex#
		]]>
	</select>	
	
	
	<!-- 대상자정보 갯수 구함 -->	<!-- , AA.ETCT_CONC -->
	<select id="ye17Ta2000_2022_DAO.selectYeta0300To2000ListTotCnt_S" parameterClass="ye17Ta2000Srh_2022_Vo" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM  (
			SELECT
										  FF.DPOB_CD
										, AA.EDAC_RVYY
										, AA.SETT_GBCD
										, fcBass0300CDNM(AA.DPOB_CD, AA.SETT_GBCD) AS SETT_GBNM
										, FF.SYSTEMKEY
										, AA.EDAC_SEIL_NUM
										, FF.PAYR_MANG_DEPT_CD
										, FF.EMYMT_DIV_CD
										, FF.HAN_NM
										, FF.RESN_REGN_NUM
										, FF.DEPT_CD
										, fcBass0400CDNM(FF.DPOB_CD, FF.DEPT_CD,'2') AS DEPT_NM
										, FF.BUSIN_CD
										, FCBASS0500CDNM (FF.DPOB_CD, SUBSTR (FF.EMYMT_BGNN_DT, 1, 4), FF.DEPT_CD, FF.BUSIN_CD) AS BUSIN_NM
										, FF.TYP_OCCU_CD
										, fcBass0320CDNM(FF.DPOB_CD, FF.TYP_OCCU_CD) AS TYP_OCCU_NM
										, FF.DTIL_OCCU_INTTN_CD
										, fcBassEx0350CDNM(FF.DPOB_CD, FF.TYP_OCCU_CD, FF.DTIL_OCCU_INTTN_CD,'1' ) AS DTIL_OCCU_INTTN_NM 
										, FF.ODTY_CD
										, FF.PYSP_CD 
										, FF.LOG_SVC_YR_NUM_CD
										, FF.LOG_SVC_MNTH_ICM_CD
										, FF.FRST_EMYMT_DT
										, FF.EMYMT_BGNN_DT
										, FF.EMYMT_END_DT
										, AA.HDOFC_DIV_CD
										, FF.RETRY_DT
										, AA.YRTX_APPTN_YR_MNTH
										, AA.YRTX_PRCS_DT
										, AA.YRTX_PRCS_YN
										, AA.DIVD_PYMT_DIV_CD
										, AA.DIVD_PYMT
										, AA.GNAN_SGTF
										, AA.FRNR_YENO
										, AA.REYM_STDT
										, AA.REYM_EDDT
										, AA.RUTR_EDDT
										, AA.RUTR_STDT
										, AA.RESD_FLAG
										, AA.NATN_GBCD
										, fcBass0300ITEMNM(AA.DPOB_CD, AA.NATN_GBCD, '11')AS NATN_ITEM
										, AA.NATN_NAME
										, AA.REDT_GBCD
										, AA.REDT_NAME
										, fcBass0300ITEMNM(AA.DPOB_CD, AA.REDT_NAME, '11')AS REDT_ITEM
										, AA.HUMN_CGUE
										, AA.FRNR_SGYN
										, AA.BASE_WIYN
										, AA.BASE_FMLY
										, AA.ADDR_CT70
										, AA.ADDR_HDRC
										, AA.ADDR_FDSU
										, AA.ADDR_CLCT
										, AA.ADDR_BHCT
										, AA.PANT_ONSU
										, AA.ADDR_MRCT
										, AA.BNAT_PSNF
										, AA.JNAT_PSNF
										, AA.BPSS_FECT
										, AA.BPSS_PULC
										, AA.JPSS_PULC
										, AA.JPSS_SOLD
										, AA.JPSS_TECH
										, AA.JPSS_FECT
										, AA.BRTR_PSCT
										, AA.BRTR_CICT
										, AA.BRTR_ANSV
										, AA.JRTR_CICT
										, AA.JRTR_CTAR
										, AA.JRTR_PSCT
										, AA.JRTR_PTAR
										, AA.JRTR_ANSV
										, AA.JRTR_ATAR
										, AA.RRPT_AMNT
										, AA.SPCI_BHLH
										, AA.SPCI_HHLH
										, AA.SPCI_BEPF
										, AA.SPCI_JEPF
										, AA.SPCI_GURT
										, AA.SPCI_HDRC
										, AA.SPCI_RTTG
										, AA.SPCI_IUAM
										, AA.SPCI_SELF
										, AA.SPCI_AE65
										, AA.SPCI_DBPS
										, AA.SPCI_DETC
										, AA.SPCI_DTAR
										, AA.SPCI_ETAM
										, AA.SPED_SELF
										, AA.SPED_EDSU
										, AA.SPED_EDAM
										, AA.SPED_GDSU
										, AA.SPED_GDAM
										, AA.SPED_CVSU
										, AA.SPED_CVAM
										, AA.SPCI_SCSU
										, AA.SPCI_SCAM
										, AA.SPED_ETAR
										, AA.SIED_TOAM
										, AA.SPCI_REFN
										, AA.SPCI_RESF
										, AA.SPCI_HTAM
										, AA.SPCH_REFN
										, AA.SPCH_RE06
										, AA.SPCH_RE10
										, AA.SPCH_RE20
										, AA.SPCH_REFX
										, AA.SPCH_REEC
										, AA.SPCH_15FX
										, AA.SPCH_15FB
										, AA.SPCH_15EC
										, AA.SPCH_10FB
										, AA.SPCH_10EC
										, AA.TAXD_PLTC
										, AA.TAXD_10TG
										, AA.SPCI_PLTC
										, AA.SPCI_PLTG
										, AA.SPCI_FBAM
										, AA.SPCI_FBTG
										, AA.SPCI_EXAM
										, AA.SPCI_UNON
										, AA.SPCI_HFAM
										, AA.SPCI_YAMT
										, AA.SPCI_NAMT
										, AA.SPCI_DGTG
										, AA.SPCI_FNRL
										, AA.PRVM_20BE
										, AA.PRVM_21AF
										, AA.ETCH_PREP
										, AA.ETCS_COMP
										, AA.ETWK_HSVM
										, AA.ETWK_HSBM
										, AA.ETWK_HLGM
										, AA.ETWK_HBDM 
										, AA.ETGD_H09F
										, AA.ETGD_H13F
										, NVL(AA.ETGD_H14F, 0)
										, NVL(AA.ETGD_HDAM, 0)
										, AA.ETCT_CARD
										, AA.ETCH_BCBS
										, AA.ETCH_UEAM
										, AA.ETCH_MGVD
										, AA.ETCH_BCED
										, AA.CARD_ET13
										, AA.CARD_ET14
										, AA.ETAD_DD13
										, AA.ETAD_D14L
										, AA.ETCH_BCUE
										, AA.ETCK_UNON
										, AA.ETCK_UNCB
										, AA.ETEP_HSAM
										, AA.ETGD_CTRA
										, AA.ETEP_SEST
										, AA.ETCL_HM01
										, AA.ETCL_HM02
										, AA.ETCL_HM03
										, AA.ETCL_HMTA
										, AA.ETCL_ETTL
										, AA.ETCL_ETAM
										, AA.TAXD_INCD
										, SUBSTR(NVL(AA.TAXD_INCD,'NNNN'),1,1) AS TAXD_INCD1
										, SUBSTR(NVL(AA.TAXD_INCD,'NNNN'),2,1) AS TAXD_INCD2
										, SUBSTR(NVL(AA.TAXD_INCD,'NNNN'),3,1) AS TAXD_INCD3
										, SUBSTR(NVL(AA.TAXD_INCD,'NNNN'),4,1) AS TAXD_INCD4
										, AA.TAXD_WKDT
										, AA.TAMA_EDDT
										, AA.TAMA_INDT
										, AA.TAMA_OUDT
										, AA.TXLG_FRRD
										, AA.TXLG_FRID
										, AA.TXLG_WKID
										, AA.TXLG_TXTD
										, AA.TXLG_BSCD
										, AA.TXLG_BCDE
										, AA.TXLG_ITCT
										, AA.TXLG_BSTA
										, AA.TXLG_WKTA
										, AA.TXLG_CLTA
										, AA.TXLG_FRTA
										, AA.TXLG_TXTY
										, AA.TXLG_INAM
										, AA.TXLG_DLAM
										, AA.TXLG_WNAM
										, AA.TXLG_OTCY
										, AA.TXLG_OTDT
										, AA.TXLG_APDT
										, AA.TXLG_OUWK
										, AA.TXAP_STDT
										, AA.TXAP_EDDT
										, AA.TXAP_WKDY
										, AA.TAXD_UNIN
										, AA.TAXD_LOAA
										, AA.ADDC_NTYN
										, AA.ADDC_MDYN
										, AA.ADDC_CTYN
										, AA.ADDC_PFYN
										, AA.ADDF_PVYN
										, AA.SPCI_REYN
										, AA.TXLG_MXTM
										, AA.INCO_OUDT
										, AA.INCO_OUFG
										, AA.JDOC_FILE
										, AA.JRTR_ATOM
										, AA.JRTR_TOTR
										, AA.SPCI_HDTG
										, AA.SPCI_DETG
										, AA.SPCI_RTTO
										, AA.SPCI_SFTG
										, AA.SPCI_65TG
										, AA.SPCI_PSTG
										, AA.SPCI_ETCG
										, AA.SPED_SFTR
										, AA.SPED_EDTR
										, AA.SPED_GDTR
										, AA.SPED_CVTR
										, AA.SPCI_SCTR
										, AA.SPCI_EXTG
										, AA.SPCI_UNTG
										, AA.SPCI_HFTG
										, AA.SPCI_NATG
										, AA.SPCI_YATG
										, AA.SPCI_DGAM
										, AA.SPCI_ONON
										, AA.SPCI_OBAM
										, AA.SPCI_OYAM
										, AA.SPCI_ONAM
										, AA.KYBDR
										, AA.INPT_DT
										, AA.INPT_ADDR
										, AA.ISMT
										, AA.REVN_DT
										, AA.REVN_ADDR							
										, AA.CARD_ET15
										, AA.ETAD_D15H
										, AA.ETAD_D15L
										, EE.BEFO_SCNT
										, EE.PAYR_TAMT
										, EE.BONS_TOAM
										, EE.DTMN_BSAM
										, EE.STCK_PRFT
										, EE.CURR_TOTS
										, EE.TAXM_SFAM
										, EE.TAXM_ETAM
										, EE.TAXM_BOIN
										, EE.TXEC_AMNT
										, EE.TOTL_SALA
										, EE.WKER_DDCT
										, EE.WKER_AMNT
										, EE.BASE_SELF
										, EE.BASE_WIFE
										, EE.BASE_FYAM
										, EE.ADDR_HDAM
										, EE.ADDR_RPT70
										, EE.ADDR_FAME
										, EE.ADDR_CHLD
										, EE.ADDR_BRTH
										, EE.PANT_ONAM
										, EE.ADDR_MCAM
										, EE.BNAT_DDCT
										, EE.JNAT_DDCT
										, EE.BPSS_DDCT
										, EE.BPSS_HSOL
										, EE.BPSS_HTEC
										, EE.BPSS_HPUL
										, EE.JPSS_DDCT
										, EE.JPSS_HSOL
										, EE.JPSS_HTEC
										, EE.JPSS_HPUL
										, EE.BRTR_HICT
										, EE.BRTR_PSRN
										, EE.BRTR_HNSV
										, EE.JRTR_HICT
										, EE.JRTR_PSRN
										, EE.JRTR_HNSV
										, EE.RRPT_YNAM
										, EE.SPCI_BHTH
										, EE.SPCI_JHTH
										, EE.SPCI_BEPF AS SPCI_BEPF01
										, EE.SPCI_JEPF AS SPCI_JEPF01
										, EE.SPCI_GURT AS SPCI_GURT01
										, EE.SPCI_HDRC AS SPCI_HDRC01
										, EE.SPCI_RTDE
										, EE.SPCI_HRTO 
										, EE.SPCI_SELF AS SPCI_SELF01
										, EE.SPCI_HE65
										, EE.SPCI_HBPS
										, EE.SPCI_DETC AS SPCI_DETC01
										, EE.SPCI_TXCR
										, EE.SPCI_METO
										, EE.SPED_SELF AS SPED_SELF01
										, EE.SPED_GRDE
										, EE.SPED_GDTO
										, EE.SPED_CLDV
										, EE.SPCI_SPEC
										, EE.SPED_TXCR
										, EE.SPED_TOAM
										, EE.SPCI_REFN AS SPCI_REFN01
										, EE.SPCI_RESF AS SPCI_RESF01
										, EE.SPCI_TGRT
										, EE.SPCI_RTAM
										, EE.SPCH_REFN AS SPCH_REFN01
										, EE.SPCH_RE15
										, EE.SPCH_RE29
										, EE.SPCH_RE30
										, EE.SPCI_REFX
										, EE.SPCI_REEC
										, EE.SPCI_15FX
										, EE.SPCI_15FB
										, EE.SPCI_15EC
										, EE.SPCI_10FB
										, EE.SPCI_10EC
										, EE.SPCH_RETO
										, EE.TAXD_PLTC AS TAXD_PLTC01
										, EE.SPCI_PLTC AS SPCI_PLTC01
										, EE.SPCI_FBAM AS SPCI_FBAM01
										, EE.SPCI_EXAM AS SPCI_EXAM01
										, EE.SPCI_UNON AS SPCI_UNON01
										, EE.SPCI_RFAM
										, EE.SPCI_YAMT AS SPCI_YAMT01
										, EE.SPCI_NAMT AS SPCI_NAMT01
										, EE.SPCI_DGCR
										, EE.SPCI_SSUM
										, EE.SPCI_DDCT
										, EE.SUBT_ERAM
										, EE.ETCP_PSNV
										, EE.ETCP_NSAV
										, EE.PRCM_TOAM
										, EE.ETCH_PREP AS ETCH_PREP01
										, EE.ETCS_COMP AS ETCS_COMP01
										, EE.ETWK_SBAM
										, EE.ETWK_SVAM
										, EE.ETWK_LGAM
										, EE.ETWK_BDAM
										, EE.ETGD_09AF
										, EE.ETGD_H13H
										, EE.ETGD_D14F
										, EE.ETGD_DDAM
										, EE.ETCC_CARD
										, EE.ETCK_UNON AS ETCK_UNON01
										, EE.ETCK_UNCR
										, EE.ETEP_MSAM
										, EE.ETGD_HTRA
										, EE.ETEP_SECR
										, EE.ETCL_TO01
										, EE.ETCL_TO02
										, EE.ETCL_TO03
										, EE.ETCL_HMTO
										, EE.ETCD_TSUM
										, EE.SPCH_EXLI
										, EE.STND_INCM
										, EE.PRDD_TAXN
										, EE.TAXD_ICAX
										, EE.TAXD_SPCT
										, EE.TXLG_CL30
										, EE.TXLG_HXTT
										, EE.TAXD_TSUM
										, EE.TAXD_WKEN
										, EE.TAXD_UNIN AS TAXD_UNIN_01
										, EE.TAXD_LOAN
										, EE.TAXD_PAID
										, EE.TAXD_REDU
										, EE.ADDR_MCCR
										, EE.SPCI_DCTO
										, EE.TAXD_CSUM
										, EE.DCSN_INCM
										, EE.DCSN_INHB
										, EE.DCSN_FAFV
										, EE.ALRY_PINX
										, EE.ALRY_PHBX
										, EE.ALRY_YVTX
										, EE.DCSN_TOTS
										, EE.DCSN_ITAX
										, EE.DCSN_BTAX
										, EE.FAFV_TAXI
										, EE.SUBT_ETAX
										, EE.SUBT_INHB
										, EE.SUBT_FAFV
										, EE.SUBT_AMSU
										, EE.JRTR_HNTO
										, EE.SPCI_OBAM AS SPCI_OBAM01
										, EE.SPCI_OYAM AS SPCI_OYAM01
										, EE.SPCI_ONAM AS SPCI_ONAM01
						FROM YETA2000 AA,   (
						SELECT  DISTINCT   AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD01.DTIL_OCCU_CLS_DIV_CD,  DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD01.DTIL_OCCU_CLS_DIV_CD,AD01.DTIL_OCCU_CLS_DIV_CD) ) AS DTIL_OCCU_CLS_DIV_CD 
                                             , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT  
                                                  FROM PSNL0100 AD01,  (SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYMT_YR_MNTH, PAYR_SEIL_NUM, PAY_CD,
                                                                           PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PAYR0304
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYYT_YR_MNTH,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                            PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PYYT0304) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #edacRvyy# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY 
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                    SELECT      MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304  
																		 WHERE   PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                          GROUP BY SYSTEMKEY
																      ) 
									                                            )
									                                              GROUP BY  DPOB_CD,  
                                                                                 SYSTEMKEY 
									                                            ) MM   
									                                             ) GG
									                           WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                               /*     AND NN.PAYR_SEIL_NUM = GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #edacRvyy# ||'%'   ) FF, YETA3000 EE
						WHERE   AA.DPOB_CD = FF.DPOB_CD
							AND AA.DPOB_CD = EE.DPOB_CD 
							AND AA.SYSTEMKEY = FF.SYSTEMKEY 
							AND AA.SYSTEMKEY = EE.SYSTEMKEY 
							AND AA.SETT_GBCD = EE.SETT_GBCD 
							AND AA.EDAC_RVYY = EE.EDAC_RVYY  
							<isNotEmpty prepend="AND" property="dpobCd" >
							 	FF.DPOB_CD=#dpobCd#
						    </isNotEmpty>
						    AND EXISTS  (
		                               SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#edacRvyy# )) ) C
		                                            WHERE     C.DPOB_CD = FF.DPOB_CD
								                        AND C.DEPT_CD = FF.DEPT_CD
								                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(FF.TYP_OCCU_CD,'TT') 
		                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(FF.DTIL_OCCU_INTTN_CD,'TT')
		                                               <isNotEmpty property="deptCd" prepend="AND">
														<![CDATA[
														 C.DEPT_CD
														]]>
														<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
														 #deptCdArr[]#
														</iterate>
														</isNotEmpty> 
		                                          )
		                   
		                    <isNotEmpty prepend="AND" property="businCd" >
							 	FF.BUSIN_CD=#businCd#
						    </isNotEmpty> 
							<isNotEmpty prepend="AND" property="payrMangDeptCd" >
							 	FF.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
						    </isNotEmpty> 
						    <isNotEmpty prepend="AND" property="emymtDivCd" >
							 	FF.EMYMT_DIV_CD=#emymtDivCd#
							</isNotEmpty>
							<isNotEmpty prepend="AND" property="edacRvyy" >
							 	AA.EDAC_RVYY = #edacRvyy#
						    </isNotEmpty>  
						    <isNotEmpty property="typOccuCd" prepend="AND">
								<![CDATA[
									 FF.TYP_OCCU_CD
								]]>
								<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
								 	 #typOccuCdArr[]#
								</iterate>
							</isNotEmpty>  
						 <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
								<![CDATA[
									 FF.DTIL_OCCU_INTTN_CD
								]]>
								<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
									 #dtilOccuInttnCdArr[]#
								</iterate>
							</isNotEmpty>  
						    <isNotEmpty prepend="AND" property="systemkey" >
							 	FF.SYSTEMKEY=#systemkey#
						    </isNotEmpty>  
						    <isNotEmpty prepend="AND" property="hanNm" >
							 	FF.HAN_NM LIKE '%' || #hanNm# || '%'
						    </isNotEmpty> 
						    <isNotEmpty prepend="AND" property="settGbcd" >
							 	AA.SETT_GBCD=#settGbcd#
						    </isNotEmpty>
						    <isEqual prepend="AND" property="printType" compareValue="YETA3140">
								 EXISTS ( SELECT GG.SYSTEMKEY
									    	FROM YETA3140 GG
									    	WHERE AA.DPOB_CD = GG.DPOB_CD
									    		AND AA.SYSTEMKEY = GG.SYSTEMKEY 
									    	 	AND AA.SETT_GBCD = GG.SETT_GBCD 
									    	 	AND AA.EDAC_RVYY = GG.EDAC_RVYY 
						    	)
							</isEqual>
							<isEqual prepend="AND" property="printType" compareValue="YETA3170">
								 EXISTS ( SELECT GG.SYSTEMKEY
									    	FROM YETA3170 GG
									    	WHERE AA.DPOB_CD = GG.DPOB_CD
									    		AND AA.SYSTEMKEY = GG.SYSTEMKEY 
									    	 	AND AA.SETT_GBCD = GG.SETT_GBCD 
									    	 	AND AA.EDAC_RVYY = GG.EDAC_RVYY 
						    	)
							</isEqual>
			)
	</select>
	
	
	<!-- ############################################################################### -->
	<!-- ############################# YETA0300 데이터 입력 쿼리 시작########################## -->
	<!-- ############################################################################### -->
	
	<!-- 기본사항tab 수정 쿼리 -->
	<update id="ye17Ta2000_2022_DAO.updateYeta0300To2000tabItem01">
		<![CDATA[
			UPDATE YETA2000
			SET GNAN_SGTF=#gnanSgtf#
				, RESD_FLAG=#resdFlag#
				, NATN_GBCD=#natnGbcd#
				, NATN_NAME=#natnName#
				, REYM_STDT=#reymStdt#
			    , REYM_EDDT=#reymEddt#
				, RUTR_STDT=#rutrStdt#
				, RUTR_EDDT=#rutrEddt#
				, REDT_GBCD=#redtGbcd#
				, REDT_NAME=#redtName#
				
				, YREN_SGYN   = #yrenSgyn#
				, ADD_INCM_TX_APPTN_RTO_CD = #addIncmTxApptnRtoCd#
				, FRNR_RNYN  = #frnrRnyn#
				
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
			WHERE DPOB_CD=#dpobCd#
				AND EDAC_RVYY=#edacRvyy#
				AND SETT_GBCD=#settGbcd#
				AND SYSTEMKEY=#systemkey#
		]]>
	</update>
	
	
	<!-- 인적공제tab 수정 쿼리 -->
	<update id="ye17Ta2000_2022_DAO.updateYeta0300To2000tabItem02">
		<![CDATA[
			UPDATE YETA2000
			SET ADDR_MRCT=#addrmrct#
				, HUMN_CGUE=#humnCgue#
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
			WHERE DPOB_CD=#dpobCd#
				AND EDAC_RVYY=#edacRvyy#
				AND SETT_GBCD=#settGbcd#
				AND SYSTEMKEY=#systemkey#
		]]>
	</update>
	
	<!-- 연금보험료공제tab 국민연금보험료외의 연금보험료 주근무지 금액 수정 쿼리 -->
	<update id="ye17Ta2000_2022_DAO.updateYeta0300To2000tabItem04">
		<![CDATA[
			UPDATE YETA2000
			SET JNAT_PSNF = #jnatPsnf#
				, JPSS_PULC = #jpssPulc#
				, JPSS_SOLD = #jpssSold#
				, JPSS_TECH = #jpssTech# 
				, JPSS_FECT = #jpssFect#  
				, ISMT = #ismt#
				, REVN_DT = TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR = #revnAddr#
			WHERE DPOB_CD = #dpobCd#
				AND EDAC_RVYY = #edacRvyy#
				AND SETT_GBCD = #settGbcd#
				AND SYSTEMKEY = #systemkey#
		]]>
	</update>
	
	
		<!-- 특별소득공제tab 보험료 금액 수정 쿼리 -->
	<update id="ye17Ta2000_2022_DAO.updateYeta0300To2000tabItem05_1">
		<![CDATA[
			UPDATE YETA2000
			SET SPCI_HHLH=#spciHhlh#
				, SPCI_JEPF=#spciJepf#
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
			WHERE DPOB_CD=#dpobCd#
				AND EDAC_RVYY=#edacRvyy#
				AND SETT_GBCD=#settGbcd#
				AND SYSTEMKEY=#systemkey#
		]]>
	</update>
	
	
	<!-- 특별소득공제tab 주택자금 금액 수정 쿼리 -->
	<update id="ye17Ta2000_2022_DAO.updateYeta0300To2000tabItem05_2">
		<![CDATA[
			UPDATE YETA2000
			SET SPCI_REFN=#spciRefn#
				, SPCI_HTAM=#spciHtam#
				, SPCH_RE06=#spchRe06#
				, SPCH_RE10=#spchRe10#
				, SPCH_RE20=#spchRe20#
				, SPCH_REFX=#spchRefx#
				, SPCH_REEC=#spchReec#
				, SPCH_15FX=#spch15fx#
				, SPCH_15FB=#spch15fb#
				, SPCH_15EC=#spch15ec# 
				, SPCH_10FB=#spch10fb#  
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
			WHERE DPOB_CD=#dpobCd#
				AND EDAC_RVYY=#edacRvyy#
				AND SETT_GBCD=#settGbcd#
				AND SYSTEMKEY=#systemkey#
		]]>
	</update>
	
	
	<!-- 그밖의소득공제1 tab 수정 쿼리 PRVM_20BE=#prvm20be# -->
	<update id="ye17Ta2000_2022_DAO.updateYeta0300To2000tabItem06">
		<![CDATA[
			UPDATE YETA2000
			SET   ETCH_PREP=#etchPrep#
				, ETCS_COMP=#etcsComp# 
				, ETWK_HSBM=#etwkHsbm#
				, ETWK_HSVM=#etwkHsvm#
				, ETWK_HBDM=#etwkHbdm#
				, ETGD_H09F=nvl(#etgdH09f#,0)
				, ETGD_H13F=nvl(#etgdH13f#,0)
				
				, ETGD_H14F=nvl(#etgdH14f#,0) 
				, ETGD_H14B=nvl(#etgdH14b#,0) 
				, ETCL_H15F=nvl(#etclH15f# ,0) 
				, ETCL_H15B=nvl(#etclH15b# ,0)
				
				, ETCL_H16F=nvl(#etclH16f# ,0) 
				, ETCL_H16B=nvl(#etclH16b# ,0)
				
				
				, CARD_ET13=nvl(#cardEt13# ,0)
				, CARD_ET14=nvl(#cardEt14#,0) 
				, CARD_ET15=nvl(#cardEt15#,0) 
				, ETAD_DD13=nvl(#etadDd13#,0) 
				, ETAD_D14L=nvl(#etadD14l#,0) 
				, ETAD_D15H=nvl(#etadD15h#,0) 
				, ETAD_D15L=nvl(#etadD15l#,0) 
				
				, ETAD_D16L=nvl(#etadD16l#,0) 
				
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
			WHERE DPOB_CD=#dpobCd#
				AND EDAC_RVYY=#edacRvyy#
				AND SETT_GBCD=#settGbcd#
				AND SYSTEMKEY=#systemkey#
		]]>
	</update>
	
	
	<!-- 그밖의소득공제7 tab 수정 쿼리 , ETCK_UNCB=#etckUncb#
		, ETGD_CTRA=#etgdCtra#
				, ETEP_SEST=#etepSest#
				-->
	<update id="ye17Ta2000_2022_DAO.updateYeta0300To2000tabItem07">
		<![CDATA[
			UPDATE YETA2000
			SET ETCK_UNON=#etckUnon# 
				, ETEP_HSAM=#etepHsam# 
				, ETCL_ETTL=#etclEttl# 
				, ETCL_ETAM=nvl(#etclEtam#,0)  
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr# 
			WHERE DPOB_CD=#dpobCd#
				AND EDAC_RVYY=#edacRvyy#
				AND SETT_GBCD=#settGbcd#
				AND SYSTEMKEY=#systemkey#
		]]>
	</update>
	
	
	<!-- 세액감면및세액공제1 tab 연금계좌및보험료 수정 쿼리 
	JRTR_CTAR=#jrtrCtar#
				, JRTR_PTAR=#jrtrPtar#
				, JRTR_ATAR=#jrtrAtar#
				-->
	<update id="ye17Ta2000_2022_DAO.updateYeta0300To2000tabItem08_1">
		<![CDATA[
			UPDATE YETA2000 
			SET   SPCI_GURT=#spciGurt#
				, SPCI_HDRC=#spciHdrc#  
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
			WHERE DPOB_CD=#dpobCd#
				AND EDAC_RVYY=#edacRvyy#
				AND SETT_GBCD=#settGbcd#
				AND SYSTEMKEY=#systemkey#
		]]>
	</update>
	
	<!-- 세액감면및세액공제1 tab 의료비 수정 쿼리 -->
	<update id="ye17Ta2000_2022_DAO.updateYeta0300To2000tabItem08_3">
		<![CDATA[
			UPDATE YETA2000 
			SET   SPED_SELF=#spedSelf#
				, SPCI_SCAM=#spciScam#  
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
			WHERE DPOB_CD=#dpobCd#
				AND EDAC_RVYY=#edacRvyy#
				AND SETT_GBCD=#settGbcd#
				AND SYSTEMKEY=#systemkey#
		]]>
	</update>
	  



	<!-- yeta0300 소득공제  -->
	<update id="ye17Ta2000_2022_DAO.updateYeta0300ToYeta3000_Item03">
		<![CDATA[
			UPDATE YETA2000 AA01
			SET   
			ETCT_CARD = (SELECT   SUM(NVL(CDTE_CARD,0) + NVL(CDTE_CDEC,0))  
										FROM YETA3220  BB01
										WHERE BB01.DPOB_CD = AA01.DPOB_CD                     
							            AND BB01.EDAC_RVYY = AA01.EDAC_RVYY                                      
							            AND BB01.SETT_GBCD = AA01.SETT_GBCD                                      
							            AND BB01.SYSTEMKEY = AA01.SYSTEMKEY
							            ),
			ETCH_BCBS = (SELECT  
						     SUM(NVL(JIBL_CARD,0) + NVL(JIBL_CDEC,0))
										FROM YETA3220  BB01
										WHERE BB01.DPOB_CD = AA01.DPOB_CD                     
							            AND BB01.EDAC_RVYY = AA01.EDAC_RVYY                                      
							            AND BB01.SETT_GBCD = AA01.SETT_GBCD                                      
							            AND BB01.SYSTEMKEY = AA01.SYSTEMKEY
							             ), 
			ETCH_UEAM = (SELECT  
						    SUM(NVL(CASH_RECE,0))    
										FROM YETA3220  BB01
										WHERE BB01.DPOB_CD = AA01.DPOB_CD                     
							            AND BB01.EDAC_RVYY = AA01.EDAC_RVYY                                      
							            AND BB01.SETT_GBCD = AA01.SETT_GBCD                                      
							            AND BB01.SYSTEMKEY = AA01.SYSTEMKEY
							            ),  
			ETCH_BCED = (SELECT   
						    SUM(NVL(GRPY_AMNT,0) + NVL(GRPY_ATEC,0) )  
										FROM YETA3220  BB01
										WHERE BB01.DPOB_CD = AA01.DPOB_CD                     
							            AND BB01.EDAC_RVYY = AA01.EDAC_RVYY                                      
							            AND BB01.SETT_GBCD = AA01.SETT_GBCD                                      
							            AND BB01.SYSTEMKEY = AA01.SYSTEMKEY
							            ),  
			ETCH_MGVD = (SELECT  SUM(NVL(BB01.MGNT_STVD,0) + NVL(BB01.MGNT_SDEC,0))  
										FROM YETA3220  BB01
										WHERE BB01.DPOB_CD = AA01.DPOB_CD                     
							            AND BB01.EDAC_RVYY = AA01.EDAC_RVYY                                      
							            AND BB01.SETT_GBCD = AA01.SETT_GBCD                                      
							            AND BB01.SYSTEMKEY = AA01.SYSTEMKEY  
							             ),  
			 
			SPCI_GURT = (CASE WHEN (SELECT  SUM(NVL(BB01.INSU_RTYR,0) + NVL(BB01.INSU_RTET,0))  
										FROM YETA3220  BB01
										WHERE BB01.DPOB_CD = AA01.DPOB_CD                     
							            AND BB01.EDAC_RVYY = AA01.EDAC_RVYY                                      
							            AND BB01.SETT_GBCD = AA01.SETT_GBCD                                      
							            AND BB01.SYSTEMKEY = AA01.SYSTEMKEY ) <= AA01.SPCI_GURT THEN AA01.SPCI_GURT
							            ELSE (SELECT  SUM(NVL(BB01.INSU_RTYR,0) + NVL(BB01.INSU_RTET,0))  
										FROM YETA3220  BB01
										WHERE BB01.DPOB_CD = AA01.DPOB_CD                     
							            AND BB01.EDAC_RVYY = AA01.EDAC_RVYY                                      
							            AND BB01.SETT_GBCD = AA01.SETT_GBCD                                      
							            AND BB01.SYSTEMKEY = AA01.SYSTEMKEY 
							            AND BB01.BASE_DDYN  = '1') END),  
			SPCI_HDRC = ( CASE WHEN (SELECT   
						    SUM(NVL(BB01.PSCL_IURR,0) + NVL(BB01.PSCL_IURT,0))   
										FROM YETA3220  BB01
										WHERE BB01.DPOB_CD = AA01.DPOB_CD                     
							            AND BB01.EDAC_RVYY = AA01.EDAC_RVYY                                      
							            AND BB01.SETT_GBCD = AA01.SETT_GBCD                                      
							            AND BB01.SYSTEMKEY = AA01.SYSTEMKEY 
							            AND BB01.BASE_DDYN  = '1') <= AA01.SPCI_HDRC THEN AA01.SPCI_HDRC
							            ELSE (SELECT   
						    SUM(NVL(BB01.PSCL_IURR,0) + NVL(BB01.PSCL_IURT,0))   
										FROM YETA3220  BB01
										WHERE BB01.DPOB_CD = AA01.DPOB_CD                     
							            AND BB01.EDAC_RVYY = AA01.EDAC_RVYY                                      
							            AND BB01.SETT_GBCD = AA01.SETT_GBCD                                      
							            AND BB01.SYSTEMKEY = AA01.SYSTEMKEY
							            AND BB01.BASE_DDYN  = '1' )  END),
				  ISMT=#ismt#,
				  REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS'),
				  REVN_ADDR=#revnAddr#
			WHERE DPOB_CD=#dpobCd#
				AND EDAC_RVYY=#edacRvyy#
				AND SETT_GBCD=#settGbcd#
				AND SYSTEMKEY=#systemkey#
		]]>
	</update>
	
	
	<!-- 세액감면및세액공제2 tab 의료비 수정 쿼리 -->
	<update id="ye17Ta2000_2022_DAO.updateYeta0300To2000tabItem09">
		<![CDATA[
			UPDATE YETA2000
			SET TAXD_INCD=#taxdIncd#
				, TAXD_WKDT=#taxdWkdt#
				, TAMA_EDDT=#tamaEddt#
				, TAMA_INDT=#tamaIndt#
				, TAMA_OUDT=#tamaOudt#
				, TXLG_FRRD=#txlgFrrd#
				, TXLG_FRID=#txlgFrid#
				, TXLG_WKID=#txlgWkid#
				, TXLG_TXTD=#txlgTxtd#
				, TXLG_BSCD=#txlgBscd#
				, TXLG_BCDE=#txlgBcde#
				, TXLG_ITCT=#txlgItct#
				, TXLG_BSTA=#txlgBsta#
				, TXLG_WKTA=#txlgWkta#
				, TXLG_FRTA=#txlgFrta#
				, TXLG_TXTY=#txlgTxty#
			    , TXLG_INAM=#txlgInam#
				, TXLG_DLAM=#txlgDlam#
				, TXLG_WNAM=#txlgWnam#
				, TXLG_OTCY=#txlgOtcy#
				, TXLG_OTDT=#txlgOtdt#
				, TXLG_APDT=#txlgApdt# 
				, TXLG_OUWK=#txlgOuwk#
				, TXAP_STDT=#txapStdt#
				, TXAP_EDDT=#txapEddt#
				, TXAP_WKDY=#txapWkdy#  
				, TAXD_UNIN=#taxdUnin# 
				, TAXD_LOAA=#taxdLoaa#  
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
			WHERE DPOB_CD=#dpobCd#
				AND EDAC_RVYY=#edacRvyy#
				AND SETT_GBCD=#settGbcd#
				AND SYSTEMKEY=#systemkey#
		]]>
	</update>
	
	<!-- 추가제출서류tab 수정 쿼리 -->
	<update id="ye17Ta2000_2022_DAO.updateYeta0300To2000tabItem10">
		<![CDATA[
			UPDATE YETA2000
			SET  FRNR_SGYN=#frnrSgyn#
				, ADDC_NTYN=#addcNtyn#
				, SPCI_REYN=#spciReyn#
				, ADDC_MDYN=#addcMdyn#
				, ADDC_CTYN=#addcCtyn#
				, ADDC_PFYN=#addcPfyn#
				, INCO_OUFG=#incoOufg# 
				, INCO_OUDT=#incoOudt#  
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
			WHERE DPOB_CD=#dpobCd#
				AND EDAC_RVYY=#edacRvyy#
				AND SETT_GBCD=#settGbcd#
				AND SYSTEMKEY=#systemkey#
		]]>
	</update>
	<!-- ############################################################################### -->
	<!-- ############################# YETA0300 데이터 입력 쿼리 종료 ########################## -->
	<!-- ############################################################################### -->
	
	
	<!-- yeta0100 화면 연말정산 대상자 생성결과 조회  -->
	<select id="ye17Ta2000_2022_DAO.selectYeta0100ToYeta3000List_D" parameterClass="ye17Ta2000Srh_2022_Vo" resultClass="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (
			 SELECT            
                      AA.DPOB_CD
                    , AA.SYSTEMKEY
                    , AA.SETT_GBCD
                    , AA.EDAC_SEIL_NUM
                    , fcBass0300CDNM(AA.DPOB_CD,AA.SETT_GBCD) AS SETT_GBNM
                    , AA.EDAC_RVYY 
                    , BB.DEPT_CD  
                    , fcBass0400CDNM(AA.DPOB_CD,BB.DEPT_CD,'2') AS DEPT_NM 
                    , AA.TYP_OCCU_CD 
                    , fcBass0320CDNM(AA.DPOB_CD, AA.TYP_OCCU_CD)  AS TYP_OCCU_NM
                    , NVL(AA.PYSP_GRDE_CD,'A0060000') AS PYSP_GRDE_CD
                    , AA.DTIL_OCCU_INTTN_CD 
                    , fcBassEx0350CDNM(AA.DPOB_CD,AA.TYP_OCCU_CD,AA.DTIL_OCCU_INTTN_CD,'1' ) AS DTIL_OCCU_INTTN_NM 
                    , AA.BUSIN_CD
                    , fcBass0500CDNM(AA.DPOB_CD,SUBSTR(AA.BUSIN_CD,1,4),BB.DEPT_CD,AA.BUSIN_CD) AS BUSIN_NM  
                    , BB.EMYMT_DIV_CD
                    , fcBass0300CDNM(BB.DPOB_CD,BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM
                    , BB.HAN_NM
                    , BB.RESN_REGN_NUM  
                    , AA.PAYR_MANG_DEPT_CD
                    , fcBass0400CDNM(AA.DPOB_CD,AA.PAYR_MANG_DEPT_CD,'2') AS PAYR_MANG_DEPT_NM
                    , AA.HDOFC_DIV_CD
                    , fcBass0300CDNM(AA.DPOB_CD,AA.HDOFC_DIV_CD) AS HDOFC_DIV_NM
                    , AA.REYM_STDT                                                                          
                    , AA.REYM_EDDT                                                                          
                    , CC.PAYR_TAMT                                                                          
                    , CC.BONS_TOAM                                                                          
                    , AA.JNAT_PSNF                                                                          
                    , AA.SPCI_HHLH                                                                          
                    , AA.SPCI_JEPF                                                                          
                    , CC.ALRY_PINX                                                                          
                    , CC.ALRY_PHBX  
                FROM YETA2000 AA, (
                SELECT  DISTINCT AD02.SYSTEMKEY
                                              ,  AD02.DPOB_CD 
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                 ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD  
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD01.DTIL_OCCU_CLS_DIV_CD,  DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD01.DTIL_OCCU_CLS_DIV_CD,AD01.DTIL_OCCU_CLS_DIV_CD) ) AS DTIL_OCCU_CLS_DIV_CD 
                                           , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01,  (SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYMT_YR_MNTH, PAYR_SEIL_NUM, PAY_CD,
                                                                           PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PAYR0304
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYYT_YR_MNTH,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                            PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PYYT0304) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #edacRvyy# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                      SELECT      MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #edacRvyy#  ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #edacRvyy#  ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                            )
									                                              GROUP BY  DPOB_CD,  
                                                                                 SYSTEMKEY 
									                                            ) MM  
									                                            
									                                             ) GG
									                           WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                              /*     AND NN.PAYR_SEIL_NUM =  GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #edacRvyy#  ||'%'   
                ) BB,YETA3000 CC  
                    WHERE AA.DPOB_CD=BB.DPOB_CD  
                      AND AA.SYSTEMKEY = BB.SYSTEMKEY 
                      AND AA.DPOB_CD=CC.DPOB_CD   
                      AND AA.SYSTEMKEY = CC.SYSTEMKEY   
                      AND AA.EDAC_RVYY = CC.EDAC_RVYY                                                       
                      AND AA.SETT_GBCD = CC.SETT_GBCD 
                      <isNotEmpty prepend="AND" property="edacRvyy" >
								 	AA.EDAC_RVYY = #edacRvyy#
							    </isNotEmpty>  
								<isNotEmpty prepend="AND" property="settGbcd" >
								 	AA.SETT_GBCD=#settGbcd#
							    </isNotEmpty>
                       <isNotEmpty prepend="AND" property="systemkey" >
                       AA.SYSTEMKEY=#systemkey#
             </isNotEmpty> 
                 AND EXISTS  (
                             SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#edacRvyy# ))) C
                                            WHERE     C.DPOB_CD = BB.DPOB_CD
						                        AND C.DEPT_CD = BB.DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
                                        	     <isNotEmpty property="deptCd" prepend="AND">
												<![CDATA[
												 C.DEPT_CD
												]]>
												<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
												 #deptCdArr[]#
												</iterate>
												</isNotEmpty>  
                                          ) 
                       <isNotEmpty prepend="AND" property="businCd" >
                         BB.BUSIN_CD=#businCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                         AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="emymtDivCd" >
                         BB.EMYMT_DIV_CD=#emymtDivCd#
                         </isNotEmpty>  
                     <isNotEmpty property="typOccuCd" prepend="AND">
                    <![CDATA[
                     BB.TYP_OCCU_CD
                    ]]>
                    <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
                     #typOccuCdArr[]#
                    </iterate>
                    </isNotEmpty>  
                  
                    <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 BB.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate> 
				  </isNotEmpty>	
		       ORDER BY   AA.EDAC_RVYY DESC
                            , CC.EDAC_RVYY DESC 
                             ,(SELECT LPAD(DEPT_RANK,5,'0')  
                                   FROM BASS0400 DD
                                   WHERE DD.DEPT_CD =  BB.DEPT_CD   
                                     AND DD.DPOB_CD = BB.DPOB_CD) ASC 
                            , BB.RESN_REGN_NUM ASC
                            , AA.SYSTEMKEY DESC   
		<![CDATA[					
	) A WHERE ROWNUM <= #lastIndex#
)WHERE RNUM >= #firstIndex#
]]>
	</select>	
	
	
	
	
	<!-- 연말정산대상자관리 엑셀출력 -->
	<select id="ye17Ta2000_2022_DAO.selectYeta0100ToYeta3000XlsList" parameterClass="ye17Ta2000Srh_2022_Vo" resultClass="egovMap">
		SELECT            
                      AA.DPOB_CD
                    , AA.SYSTEMKEY AS SYSTEMKEY
                    , AA.SETT_GBCD
                    , AA.EDAC_SEIL_NUM
                    , fcBass0300CDNM(AA.DPOB_CD,AA.SETT_GBCD) AS SETT_GBNM
                    , AA.EDAC_RVYY 
                    , BB.DEPT_CD  
                    , fcBass0400CDNM(AA.DPOB_CD,BB.DEPT_CD,'2') AS DEPT_NM 
                    , AA.TYP_OCCU_CD 
                    , fcBass0320CDNM(AA.DPOB_CD, AA.TYP_OCCU_CD)  AS TYP_OCCU_NM
                    , NVL(AA.PYSP_GRDE_CD,'A0060000') AS PYSP_GRDE_CD
                    , AA.DTIL_OCCU_INTTN_CD 
                    , fcBassEx0350CDNM(AA.DPOB_CD,AA.TYP_OCCU_CD,AA.DTIL_OCCU_INTTN_CD,'1' ) AS DTIL_OCCU_INTTN_NM 
                    , AA.BUSIN_CD
                    , fcBass0500CDNM(AA.DPOB_CD,SUBSTR(AA.BUSIN_CD,1,4),BB.DEPT_CD,AA.BUSIN_CD) AS BUSIN_NM  
                    , BB.EMYMT_DIV_CD
                    , fcBass0300CDNM(BB.DPOB_CD,BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM
                    , BB.HAN_NM
                    , BB.RESN_REGN_NUM  
                    , AA.PAYR_MANG_DEPT_CD
                    , fcBass0400CDNM(AA.DPOB_CD,AA.PAYR_MANG_DEPT_CD,'2') AS PAYR_MANG_DEPT_NM
                    , AA.HDOFC_DIV_CD
                    , fcBass0300CDNM(AA.DPOB_CD,AA.HDOFC_DIV_CD) AS HDOFC_DIV_NM
                    , AA.REYM_STDT                                                                          
                    , AA.REYM_EDDT                                                                          
                    , CC.PAYR_TAMT                                                                          
                    , CC.BONS_TOAM                                                                          
                    , AA.JNAT_PSNF                                                                          
                    , AA.SPCI_HHLH                                                                          
                    , AA.SPCI_JEPF                                                                          
                    , CC.ALRY_PINX                                                                          
                    , CC.ALRY_PHBX  
                FROM YETA2000 AA, (
                SELECT  DISTINCT   AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD01.DTIL_OCCU_CLS_DIV_CD,  DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD01.DTIL_OCCU_CLS_DIV_CD,AD01.DTIL_OCCU_CLS_DIV_CD) ) AS DTIL_OCCU_CLS_DIV_CD 
                                           , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01,  (SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYMT_YR_MNTH, PAYR_SEIL_NUM, PAY_CD,
                                                                           PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PAYR0304
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYYT_YR_MNTH,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                            PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PYYT0304) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #edacRvyy# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                      SELECT      MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                            )
									                                              GROUP BY  DPOB_CD,  
                                                                                 SYSTEMKEY 
									                                            ) MM  
									                                            
									                                             ) GG
									                           WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                              /*     AND NN.PAYR_SEIL_NUM = GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #edacRvyy# ||'%'   
                ) BB,YETA3000 CC  
                    WHERE AA.DPOB_CD=BB.DPOB_CD  
                      AND AA.SYSTEMKEY = BB.SYSTEMKEY 
                      AND AA.DPOB_CD=CC.DPOB_CD   
                      AND AA.SYSTEMKEY = CC.SYSTEMKEY   
                      AND AA.EDAC_RVYY = CC.EDAC_RVYY                                                       
                      AND AA.SETT_GBCD = CC.SETT_GBCD 
                      <isNotEmpty property="yetaDpcd" >
		         			<isEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
								AA.YETA_DPCD IS NULL
							</isEqual>
							<isNotEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
							AA.YETA_DPCD=#yetaDpcd#
							</isNotEqual>
	          			</isNotEmpty> 
                      <isNotEmpty prepend="AND" property="edacRvyy" >
								 	AA.EDAC_RVYY = #edacRvyy#
							    </isNotEmpty>  
								<isNotEmpty prepend="AND" property="settGbcd" >
								 	AA.SETT_GBCD=#settGbcd#
							    </isNotEmpty>
                       <isNotEmpty prepend="AND" property="systemkey" >
                       AA.SYSTEMKEY=#systemkey#
             </isNotEmpty> 
                 AND EXISTS  (
                             SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#edacRvyy# )) ) C
                                            WHERE     C.DPOB_CD = BB.DPOB_CD
						                        AND C.DEPT_CD = BB.DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
                                        	     <isNotEmpty property="deptCd" prepend="AND">
												<![CDATA[
												 C.DEPT_CD
												]]>
												<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
												 #deptCdArr[]#
												</iterate>
												</isNotEmpty>  
                                          ) 
                       <isNotEmpty prepend="AND" property="businCd" >
                         BB.BUSIN_CD=#businCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                         AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="emymtDivCd" >
                         BB.EMYMT_DIV_CD=#emymtDivCd#
                         </isNotEmpty>  
                     <isNotEmpty property="typOccuCd" prepend="AND">
                    <![CDATA[
                     BB.TYP_OCCU_CD
                    ]]>
                    <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
                     #typOccuCdArr[]#
                    </iterate>
                    </isNotEmpty>  
                  
                    <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 BB.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate> 
				  </isNotEmpty>	
		       ORDER BY   AA.EDAC_RVYY DESC
                            , CC.EDAC_RVYY DESC 
                             ,(SELECT LPAD(DEPT_RANK,5,'0')  
                                   FROM BASS0400 DD
                                   WHERE DD.DEPT_CD =  BB.DEPT_CD   
                                     AND DD.DPOB_CD = BB.DPOB_CD) ASC 
                            , BB.RESN_REGN_NUM ASC
                            , AA.SYSTEMKEY DESC   
	</select>
	
	
	<!-- 연말정산신고내역 리스트 YETA0400-->
	<select id="ye17Ta2000_2022_DAO.selectYeta0400ToYeta3000XlsList" parameterClass="ye17Ta2000Srh_2022_Vo" resultClass="egovMap">
		SELECT AA.DPOB_CD,
                   AA.EDAC_RVYY, 
                   AA.SYSTEMKEY,
                   AA.SETT_GBCD,
                   AA.EDAC_SEIL_NUM,
                   fcBass0300CDNM (AA.DPOB_CD, AA.SETT_GBCD) AS SETT_GBNM,
                   BB.DEPT_CD AS DEPT_CD,
                   fcBass0400CDNM (AA.DPOB_CD, BB.DEPT_CD, '2') AS DEPT_NM,
                   AA.TYP_OCCU_CD,
                   fcBass0320CDNM (AA.DPOB_CD, AA.TYP_OCCU_CD) AS TYP_OCCU_NM,
                   AA.DTIL_OCCU_INTTN_CD,
                   fcBassEx0350CDNM (AA.DPOB_CD, AA.TYP_OCCU_CD, AA.DTIL_OCCU_INTTN_CD, '1')AS DTIL_OCCU_INTTN_NM,
                   AA.BUSIN_CD,
                   fcBass0500CDNM (AA.DPOB_CD,  SUBSTR (AA.BUSIN_CD, 1, 4), BB.DEPT_CD, AA.BUSIN_CD)AS BUSIN_NM,
                   BB.EMYMT_DIV_CD,
                   fcBass0300CDNM (BB.DPOB_CD, BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM,
                   BB.HAN_NM,
                   BB.RESN_REGN_NUM,
                   AA.PAYR_MANG_DEPT_CD,
                   fcBass0400CDNM (AA.DPOB_CD, AA.PAYR_MANG_DEPT_CD, '2')
                      AS PAYR_MANG_DEPT_NM,
                   AA.HDOFC_DIV_CD,
                   fcBass0300CDNM (AA.DPOB_CD, AA.HDOFC_DIV_CD) AS HDOFC_DIV_NM,
                   AA.REYM_STDT,
                   AA.REYM_EDDT,
                   CC.TOTL_SALA AS ITEM01,
                   (0) AS ITEM02, 
                     NVL (CC.ALRY_PINX, 0) AS ITEM03,/* column 기납부세액_소득세 : ALRY_PINX */
                   NVL (CC.ALRY_PHBX, 0) AS ITEM04,/* column 기납부세액_주민세_지방소득세 : ALRY_PHBX */
                   NVL (CC.ALRY_YVTX, 0) AS ALRY_YVTX, /* column 기납부세액_농특세 : ALRY_YVTX */
                    (AA.SPCI_BHLH + AA.SPCI_HHLH) AS ITEM05,
                   (AA.BNAT_PSNF + AA.JNAT_PSNF) AS ITEM06,
                   (AA.SPCI_BEPF + AA.SPCI_JEPF) AS ITEM07,
                    CC.SUBT_ETAX AS ITEM08,  /* column 차감징수_소득세 : SUBT_ETAX */ 
                   CC.SUBT_INHB AS ITEM09, /* column 차감징수_주민세_지방소득세 : SUBT_INHB */ 
                   CC.SUBT_FAFV,/* column 차감징수_농특세 : SUBT_FAFV */ 
                   DECODE (NVL (CC.SUBT_AMSU, 0), 0, '', CC.SUBT_AMSU) AS ITEM10,/* column 차감징수_세액계 : SUBT_AMSU */ 
                   (0) AS ITEM11,
                    (0) AS ITEM12,
                   (0) AS ITEM13,
                    DECODE (NVL (CC.SUBT_AMSU, 0), 0, '', CC.SUBT_AMSU)  AS ITEM14 ,
     				NVL (CC.DCSN_INCM, 0)  AS ITEM15 ,		/** set 결정세액_소득세 : dcsnIncm */ 
           			NVL (CC.DCSN_INHB, 0)  AS ITEM16  		/** set 결정세액_주민세_지방소득세 : dcsnInhb */
              FROM YETA2000 AA, 
                   YETA3000 CC ,(
                                     SELECT  DISTINCT    AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD01.DTIL_OCCU_CLS_DIV_CD,  DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD01.DTIL_OCCU_CLS_DIV_CD,AD01.DTIL_OCCU_CLS_DIV_CD) ) AS DTIL_OCCU_CLS_DIV_CD 
                                            , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01,  (SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYMT_YR_MNTH, PAYR_SEIL_NUM, PAY_CD,
                                                                           PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PAYR0304
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYYT_YR_MNTH,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                            PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PYYT0304) AD02,
                                                ( 
                                                        SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #edacRvyy# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                     SELECT      MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                            )
									                                              GROUP BY  DPOB_CD,  
                                                                                 SYSTEMKEY 
									                                            ) MM  
									                                              
									                                             ) GG
									                             WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                                /*     AND NN.PAYR_SEIL_NUM = GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #edacRvyy# ||'%'   
                                             ) BB  
             WHERE     BB.SYSTEMKEY = AA.SYSTEMKEY
                   AND BB.DPOB_CD=AA.DPOB_CD   
                   AND CC.SYSTEMKEY = AA.SYSTEMKEY
                   AND CC.EDAC_RVYY = AA.EDAC_RVYY
                   AND CC.SETT_GBCD = AA.SETT_GBCD
                   AND CC.DPOB_CD=AA.DPOB_CD   
                   <isNotEmpty property="yetaDpcd" >
		         		<isEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
							AA.YETA_DPCD IS NULL
						</isEqual>
						<isNotEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
							AA.YETA_DPCD=#yetaDpcd#
						</isNotEqual>
	          		</isNotEmpty> 
                       <isNotEmpty prepend="AND" property="edacRvyy" >
                                     AA.EDAC_RVYY = #edacRvyy#
                                </isNotEmpty>  
                                <isNotEmpty prepend="AND" property="settGbcd" >
                                     AA.SETT_GBCD=#settGbcd#
                                </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="systemkey" >
                       AA.SYSTEMKEY=#systemkey#
                      </isNotEmpty> 
                 AND EXISTS  (
                             SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#edacRvyy# ))) C
                                            WHERE     C.DPOB_CD = BB.DPOB_CD
                                                AND C.DEPT_CD = BB.DEPT_CD
                                                AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
                                                 <isNotEmpty property="deptCd" prepend="AND">
                                                <![CDATA[
                                                 C.DEPT_CD
                                                ]]>
                                                <iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
                                                 #deptCdArr[]#
                                                </iterate>
                                                </isNotEmpty>  
                                          ) 
                       <isNotEmpty prepend="AND" property="businCd" >
                        <![CDATA[
                            BB.BUSIN_CD 
                        ]]>
                        <iterate prepend="IN" property="businCdArr" open="(" close=")" conjunction=",">
                            #businCdArr[]#
                        </iterate>
                          </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                         AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="emymtDivCd" >
                         BB.EMYMT_DIV_CD=#emymtDivCd#
                         </isNotEmpty>  
                     <isNotEmpty property="typOccuCd" prepend="AND">
                    <![CDATA[
                     BB.TYP_OCCU_CD
                    ]]>
                    <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
                     #typOccuCdArr[]#
                    </iterate>
                    </isNotEmpty>  
                  
                    <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
                        <![CDATA[
                             BB.DTIL_OCCU_INTTN_CD
                        ]]>
                        <iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
                             #dtilOccuInttnCdArr[]#
                        </iterate> 
                  </isNotEmpty> 
		               ORDER BY   AA.EDAC_RVYY DESC
		                            , CC.EDAC_RVYY DESC 
		                             ,(SELECT LPAD(DEPT_RANK,5,'0')  
		                                   FROM BASS0400 DD
		                                   WHERE DD.DEPT_CD =  BB.DEPT_CD   
		                                     AND DD.DPOB_CD = BB.DPOB_CD) ASC 
		                            , BB.RESN_REGN_NUM ASC
		                            , AA.SYSTEMKEY DESC   
	</select>
	
	<!-- 연말정산대상자관리 엑셀출력 2022 -->
	<select id="ye17Ta2000_2022_DAO.selectYeta7500ToYeta3000XlsList" parameterClass="ye17Ta2000Srh_2022_Vo" resultClass="egovMap">
 	SELECT AA.DPOB_CD,
                   AA.EDAC_RVYY, 
                   AA.SYSTEMKEY,
                   AA.SETT_GBCD,
                   AA.EDAC_SEIL_NUM,
                   fcBass0300CDNM (AA.DPOB_CD, AA.SETT_GBCD) AS SETT_GBNM,
                   BB.DEPT_CD AS DEPT_CD,
                   fcBass0400CDNM (AA.DPOB_CD, BB.DEPT_CD, '2') AS DEPT_NM,
                   AA.TYP_OCCU_CD,
                   fcBass0320CDNM (AA.DPOB_CD, AA.TYP_OCCU_CD) AS TYP_OCCU_NM,
                   AA.DTIL_OCCU_INTTN_CD,
                   fcBassEx0350CDNM (AA.DPOB_CD, AA.TYP_OCCU_CD, AA.DTIL_OCCU_INTTN_CD, '1')AS DTIL_OCCU_INTTN_NM,
                   AA.BUSIN_CD,
                   fcBass0500CDNM (AA.DPOB_CD,  SUBSTR (AA.BUSIN_CD, 1, 4), BB.DEPT_CD, AA.BUSIN_CD)AS BUSIN_NM,
                   BB.EMYMT_DIV_CD,
                   fcBass0300CDNM (BB.DPOB_CD, BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM,
                   BB.HAN_NM,
                   BB.RESN_REGN_NUM,
                   AA.YRTX_APPTN_YR_MNTH,                  
                   AA.YRTX_PRCS_YN,                        
                   AA.YRTX_PRCS_DT,                      
                   AA.DIVD_PYMT_DIV_CD,                   
                   fcBass0300CDNM(AA.DPOB_CD, AA.DIVD_PYMT_DIV_CD) AS DIVD_PYMT_DIV_NM,
                   AA.DIVD_PYMT_DIV_CD AS divdPymtDivCdcommCd ,
                   fcBass0300CDNM(AA.DPOB_CD, AA.DIVD_PYMT_DIV_CD) AS divdPymtDivCdcommCdNm ,
                   AA.DIVD_PYMT,                        
                   AA.PAYR_MANG_DEPT_CD,
                   fcBass0400CDNM (AA.DPOB_CD, AA.PAYR_MANG_DEPT_CD, '2')
                      AS PAYR_MANG_DEPT_NM,
                   AA.HDOFC_DIV_CD,
                   fcBass0300CDNM (AA.DPOB_CD, AA.HDOFC_DIV_CD) AS HDOFC_DIV_NM,
                   AA.REYM_STDT,
                   AA.REYM_EDDT,
                   CC.TOTL_SALA AS ITEM01,
                   (0) AS ITEM02, 
                     NVL (CC.ALRY_PINX, 0) AS ITEM03,/* column 기납부세액_소득세 : ALRY_PINX */
                   NVL (CC.ALRY_PHBX, 0) AS ITEM04,/* column 기납부세액_주민세_지방소득세 : ALRY_PHBX */
                   NVL (CC.ALRY_YVTX, 0) AS ALRY_YVTX, /* column 기납부세액_농특세 : ALRY_YVTX */
                    (AA.SPCI_BHLH + AA.SPCI_HHLH) AS ITEM05,
                   (AA.BNAT_PSNF + AA.JNAT_PSNF) AS ITEM06,
                   (AA.SPCI_BEPF + AA.SPCI_JEPF) AS ITEM07,
                    CC.SUBT_ETAX AS ITEM08,  /* column 차감징수_소득세 : SUBT_ETAX */ 
                   CC.SUBT_INHB AS ITEM09, /* column 차감징수_주민세_지방소득세 : SUBT_INHB */ 
                   CC.SUBT_FAFV,/* column 차감징수_농특세 : SUBT_FAFV */ 
                    DECODE(NVL (CC.SUBT_AMSU, 0), 0, '', CC.SUBT_AMSU) AS ITEM10,/* column 차감징수_세액계 : SUBT_AMSU */ 
                   (0) AS ITEM11,
                    (0) AS ITEM12,
                   (0) AS ITEM13,
                    DECODE (NVL (CC.SUBT_AMSU, 0), 0, '', CC.SUBT_AMSU)  AS ITEM14 
              FROM YETA2000 AA, 
                   YETA3000 CC ,(
                                     SELECT   DISTINCT  AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD01.DTIL_OCCU_CLS_DIV_CD,  DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD01.DTIL_OCCU_CLS_DIV_CD,AD01.DTIL_OCCU_CLS_DIV_CD) ) AS DTIL_OCCU_CLS_DIV_CD 
                                             , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01,  (SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYMT_YR_MNTH, PAYR_SEIL_NUM, PAY_CD,
                                                                           PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PAYR0304
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYYT_YR_MNTH,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                            PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PYYT0304) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #edacRvyy# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                     SELECT      MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                            )
									                                              GROUP BY  DPOB_CD,  
                                                                                 SYSTEMKEY
									                                            ) MM  
									                                             
									                                             ) GG
									                             WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                               /*     AND NN.PAYR_SEIL_NUM =  GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #edacRvyy# ||'%'   
                                             ) BB  
             WHERE     BB.SYSTEMKEY = AA.SYSTEMKEY
                   AND BB.DPOB_CD=AA.DPOB_CD   
                   AND CC.SYSTEMKEY = AA.SYSTEMKEY
                   AND CC.EDAC_RVYY = AA.EDAC_RVYY
                   AND CC.SETT_GBCD = AA.SETT_GBCD
                   AND CC.DPOB_CD=AA.DPOB_CD   
                       <isNotEmpty prepend="AND" property="edacRvyy" >
                                     AA.EDAC_RVYY = #edacRvyy#
                                </isNotEmpty>  
                                <isNotEmpty prepend="AND" property="settGbcd" >
                                     AA.SETT_GBCD=#settGbcd#
                                </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="systemkey" >
                       AA.SYSTEMKEY=#systemkey#
                      </isNotEmpty> 
                 AND EXISTS  (
                               SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#edacRvyy# ))) C
                                            WHERE     C.DPOB_CD = BB.DPOB_CD
                                                AND C.DEPT_CD = BB.DEPT_CD
                                                AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
                                                 <isNotEmpty property="deptCd" prepend="AND">
                                                <![CDATA[
                                                 C.DEPT_CD
                                                ]]>
                                                <iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
                                                 #deptCdArr[]#
                                                </iterate>
                                                </isNotEmpty>  
                                          ) 
                       <isNotEmpty prepend="AND" property="businCd" >
                        <![CDATA[
                            BB.BUSIN_CD 
                        ]]>
                        <iterate prepend="IN" property="businCdArr" open="(" close=")" conjunction=",">
                            #businCdArr[]#
                        </iterate>
                          </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                         AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="emymtDivCd" >
                         BB.EMYMT_DIV_CD=#emymtDivCd#
                         </isNotEmpty>  
                     <isNotEmpty property="typOccuCd" prepend="AND">
                    <![CDATA[
                     BB.TYP_OCCU_CD
                    ]]>
                    <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
                     #typOccuCdArr[]#
                    </iterate>
                    </isNotEmpty>  
                  
                    <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
                        <![CDATA[
                             BB.DTIL_OCCU_INTTN_CD
                        ]]>
                        <iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
                             #dtilOccuInttnCdArr[]#
                        </iterate> 
                  </isNotEmpty> 
		               ORDER BY   AA.EDAC_RVYY DESC
		                            , CC.EDAC_RVYY DESC 
		                             ,(SELECT LPAD(DEPT_RANK,5,'0')  
		                                   FROM BASS0400 DD
		                                   WHERE DD.DEPT_CD =  BB.DEPT_CD   
		                                     AND DD.DPOB_CD = BB.DPOB_CD) ASC 
		                            , BB.RESN_REGN_NUM ASC
		                            , AA.SYSTEMKEY DESC  
	</select>	
	
	
	
	<!-- yeta0100 화면 연말정산 대상자 생성결과 조회  -->
	<select id="ye17Ta2000_2022_DAO.selectYeta0100ToYeta3000ListTotCnt_S" parameterClass="infcPsnl0100Srh_2022_Vo" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM (
			 SELECT            
                      AA.DPOB_CD
                    , AA.SYSTEMKEY
                    , AA.SETT_GBCD
                    , AA.EDAC_SEIL_NUM
                    , fcBass0300CDNM(AA.DPOB_CD,AA.SETT_GBCD) AS SETT_GBNM
                    , AA.EDAC_RVYY 
                    , BB.DEPT_CD  
                    , fcBass0400CDNM(AA.DPOB_CD,BB.DEPT_CD,'2') AS DEPT_NM 
                    , AA.TYP_OCCU_CD 
                    , fcBass0320CDNM(AA.DPOB_CD, AA.TYP_OCCU_CD)  AS TYP_OCCU_NM
                    , NVL(AA.PYSP_GRDE_CD,'A0060000') AS PYSP_GRDE_CD
                    , AA.DTIL_OCCU_INTTN_CD 
                    , fcBassEx0350CDNM(AA.DPOB_CD,AA.TYP_OCCU_CD,AA.DTIL_OCCU_INTTN_CD,'1' ) AS DTIL_OCCU_INTTN_NM 
                    , AA.BUSIN_CD
                    , fcBass0500CDNM(AA.DPOB_CD,SUBSTR(AA.BUSIN_CD,1,4),BB.DEPT_CD,AA.BUSIN_CD) AS BUSIN_NM  
                    , BB.EMYMT_DIV_CD
                    , fcBass0300CDNM(BB.DPOB_CD,BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM
                    , BB.HAN_NM
                    , BB.RESN_REGN_NUM  
                    , AA.PAYR_MANG_DEPT_CD
                    , fcBass0400CDNM(AA.DPOB_CD,AA.PAYR_MANG_DEPT_CD,'2') AS PAYR_MANG_DEPT_NM
                    , AA.HDOFC_DIV_CD
                    , fcBass0300CDNM(AA.DPOB_CD,AA.HDOFC_DIV_CD) AS HDOFC_DIV_NM
                    , AA.REYM_STDT                                                                          
                    , AA.REYM_EDDT                                                                          
                    , CC.PAYR_TAMT                                                                          
                    , CC.BONS_TOAM                                                                          
                    , AA.JNAT_PSNF                                                                          
                    , AA.SPCI_HHLH                                                                          
                    , AA.SPCI_JEPF                                                                          
                    , CC.ALRY_PINX                                                                          
                    , CC.ALRY_PHBX  
                FROM YETA2000 AA, (
                 SELECT   DISTINCT  AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD01.DTIL_OCCU_CLS_DIV_CD,  DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD01.DTIL_OCCU_CLS_DIV_CD,AD01.DTIL_OCCU_CLS_DIV_CD) ) AS DTIL_OCCU_CLS_DIV_CD 
                                             , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT  
                                                  FROM PSNL0100 AD01,  (SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYMT_YR_MNTH, PAYR_SEIL_NUM, PAY_CD,
                                                                           PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PAYR0304
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYYT_YR_MNTH,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                            PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PYYT0304) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #edacRvyy# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                       SELECT      MAX(SEL_NUM)  AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                            )
									                                              GROUP BY  DPOB_CD,  
                                                                                 SYSTEMKEY
									                                            ) MM  
									                                         
									                                             ) GG
									                             WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                                 /*     AND NN.PAYR_SEIL_NUM = GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #edacRvyy# ||'%'   
                ) BB,YETA3000 CC  
                    WHERE AA.DPOB_CD=BB.DPOB_CD  
                      AND AA.SYSTEMKEY = BB.SYSTEMKEY 
                      AND AA.DPOB_CD=CC.DPOB_CD   
                      AND AA.SYSTEMKEY = CC.SYSTEMKEY   
                      AND AA.EDAC_RVYY = CC.EDAC_RVYY                                                       
                      AND AA.SETT_GBCD = CC.SETT_GBCD 
                      <isNotEmpty prepend="AND" property="edacRvyy" >
								 	AA.EDAC_RVYY = #edacRvyy#
							    </isNotEmpty>  
								<isNotEmpty prepend="AND" property="settGbcd" >
								 	AA.SETT_GBCD=#settGbcd#
							    </isNotEmpty>
                       <isNotEmpty prepend="AND" property="systemkey" >
                       AA.SYSTEMKEY=#systemkey#
             </isNotEmpty> 
                 AND EXISTS  (
                             SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#edacRvyy# )) ) C
                                            WHERE     C.DPOB_CD = BB.DPOB_CD
						                        AND C.DEPT_CD = BB.DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
                                        	     <isNotEmpty property="deptCd" prepend="AND">
												<![CDATA[
												 C.DEPT_CD
												]]>
												<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
												 #deptCdArr[]#
												</iterate>
												</isNotEmpty>  
                                          ) 
                       <isNotEmpty prepend="AND" property="businCd" >
                         BB.BUSIN_CD=#businCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                         AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="emymtDivCd" >
                         BB.EMYMT_DIV_CD=#emymtDivCd#
                         </isNotEmpty>  
                     <isNotEmpty property="typOccuCd" prepend="AND">
                    <![CDATA[
                     BB.TYP_OCCU_CD
                    ]]>
                    <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
                     #typOccuCdArr[]#
                    </iterate>
                    </isNotEmpty>  
                  
                    <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 BB.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate> 
				  </isNotEmpty>	
			) 
			
	</select>
	
	
	<!-- 2016년도변경 yeta1200 화면 연말정산 대상자 생성결과 조회  -->
	<select id="ye17Ta2000_2022_DAO.selectYeta1200ToYeta3000List_D" parameterClass="ye17Ta2000Srh_2022_Vo" resultClass="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (
			 SELECT          
                      AA.DPOB_CD
                    , AA.SYSTEMKEY
                    , AA.SETT_GBCD
                    , AA.EDAC_SEIL_NUM
                    , fcBass0300CDNM(AA.DPOB_CD,AA.SETT_GBCD) AS SETT_GBNM
                    , AA.EDAC_RVYY 
                    , BB.DEPT_CD 
                    , fcBass0400CDNM(AA.DPOB_CD,BB.DEPT_CD,'2') AS DEPT_NM 
                    , AA.TYP_OCCU_CD 
                    , fcBass0320CDNM(AA.DPOB_CD, AA.TYP_OCCU_CD)  AS TYP_OCCU_NM
                    , NVL(AA.PYSP_GRDE_CD,'A0060000') AS PYSP_GRDE_CD
                    , AA.DTIL_OCCU_INTTN_CD 
                    , fcBassEx0350CDNM(AA.DPOB_CD,AA.TYP_OCCU_CD,AA.DTIL_OCCU_INTTN_CD,'1' ) AS DTIL_OCCU_INTTN_NM 
                    , AA.BUSIN_CD
                    , fcBass0500CDNM(AA.DPOB_CD,SUBSTR(AA.BUSIN_CD,1,4),BB.DEPT_CD,AA.BUSIN_CD) AS BUSIN_NM  
                    , BB.EMYMT_DIV_CD
                    , fcBass0300CDNM(BB.DPOB_CD,BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM
                    , BB.HAN_NM
                    , BB.RESN_REGN_NUM  
                    , AA.PAYR_MANG_DEPT_CD
                    , fcBass0400CDNM(AA.DPOB_CD,AA.PAYR_MANG_DEPT_CD,'2') AS PAYR_MANG_DEPT_NM
                    , AA.HDOFC_DIV_CD
                    , fcBass0300CDNM(AA.DPOB_CD,AA.HDOFC_DIV_CD) AS HDOFC_DIV_NM
                    , DECODE(AA.JDOC_FILE,'Y','전자파일','문서') AS JDOC_FNNM 
                FROM YETA2000 AA, (
               SELECT  DISTINCT AD02.SYSTEMKEY
                                              ,  AD02.DPOB_CD 
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                 ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD01.DTIL_OCCU_CLS_DIV_CD,  DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD01.DTIL_OCCU_CLS_DIV_CD,AD01.DTIL_OCCU_CLS_DIV_CD) ) AS DTIL_OCCU_CLS_DIV_CD 
                                              , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01,  (SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYMT_YR_MNTH, PAYR_SEIL_NUM, PAY_CD,
                                                                           PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PAYR0304
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYYT_YR_MNTH,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                            PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PYYT0304) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #edacRvyy# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                      SELECT      MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #edacRvyy#  ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #edacRvyy#  ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                            )
									                                              GROUP BY  DPOB_CD,  
                                                                                 SYSTEMKEY 
									                                            ) MM  
									                                            
									                                             ) GG
									                           WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                              /*     AND NN.PAYR_SEIL_NUM =  GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #edacRvyy#  ||'%'   
                                             ) BB   , YE161005 DD 
                    WHERE AA.DPOB_CD=BB.DPOB_CD  
                      	AND AA.SYSTEMKEY = BB.SYSTEMKEY 
						AND AA.DPOB_CD=DD.DPOB_CD(+)
						    AND AA.YETA_DPCD = DD.WHDG_TX_REGRST_DEPT_CD(+)
						<isNotEmpty prepend="AND" property="busoprRgstnum" >
							DD.BUSOPR_RGSTNUM = #busoprRgstnum#
				    	</isNotEmpty> 
						<isNotEmpty property="yetaDpcd" >
		         			<isEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
								AA.YETA_DPCD IS NULL
							</isEqual>
							<isNotEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
							AA.YETA_DPCD=#yetaDpcd#
							</isNotEqual>
	          			</isNotEmpty> 
                  		<isNotEmpty prepend="AND" property="edacRvyy" >
							AA.EDAC_RVYY = #edacRvyy#
						</isNotEmpty>  
						<isNotEmpty prepend="AND" property="settGbcd" >
							AA.SETT_GBCD=#settGbcd#
						</isNotEmpty> 
                       	<isNotEmpty prepend="AND" property="systemkey" >
                       		AA.SYSTEMKEY=#systemkey#
                      	</isNotEmpty> 
                 AND EXISTS  (
                        SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#edacRvyy# ))) C 
                                            WHERE     C.DPOB_CD = BB.DPOB_CD
						                        AND C.DEPT_CD = BB.DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
                                        	     <isNotEmpty property="deptCd" prepend="AND">
												<![CDATA[
												 C.DEPT_CD
												]]>
												<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
												 #deptCdArr[]#
												</iterate>
												</isNotEmpty>  
                                          ) 
                       <isNotEmpty prepend="AND" property="businCd" >
                         BB.BUSIN_CD=#businCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                         AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="emymtDivCd" >
                         BB.EMYMT_DIV_CD=#emymtDivCd#
                         </isNotEmpty>  
                     <isNotEmpty property="typOccuCd" prepend="AND">
                    <![CDATA[
                     BB.TYP_OCCU_CD
                    ]]>
                    <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
                     #typOccuCdArr[]#
                    </iterate>
                    </isNotEmpty>  
                  
                    <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 BB.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate> 
				  </isNotEmpty>	
		       ORDER BY   AA.EDAC_RVYY DESC 
                             ,(SELECT LPAD(DEPT_RANK,5,'0')  
                                   FROM BASS0400 DD
                                   WHERE DD.DEPT_CD =  BB.DEPT_CD   
                                     AND DD.DPOB_CD = BB.DPOB_CD) ASC 
                            , BB.RESN_REGN_NUM ASC
                            , AA.SYSTEMKEY DESC   
		<![CDATA[					
	) A WHERE ROWNUM <= #lastIndex#
)WHERE RNUM >= #firstIndex#
]]>
	</select>	
	<!-- 2016년도로 변경  yeta1200 화면 연말정산 대상자 생성결과 조회  -->
	<select id="ye17Ta2000_2022_DAO.selectYeta1200ToYeta3000ListTotCnt_S" parameterClass="ye17Ta2000Srh_2022_Vo" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM (
			SELECT            
                      AA.DPOB_CD
                    , AA.SYSTEMKEY
                    , AA.SETT_GBCD
                    , AA.EDAC_SEIL_NUM
                    , fcBass0300CDNM(AA.DPOB_CD,AA.SETT_GBCD) AS SETT_GBNM
                    , AA.EDAC_RVYY 
                    , BB.DEPT_CD 
                    , fcBass0400CDNM(AA.DPOB_CD,BB.DEPT_CD,'2') AS DEPT_NM 
                    , AA.TYP_OCCU_CD 
                    , fcBass0320CDNM(AA.DPOB_CD, AA.TYP_OCCU_CD)  AS TYP_OCCU_NM
                    , NVL(AA.PYSP_GRDE_CD,'A0060000') AS PYSP_GRDE_CD
                    , AA.DTIL_OCCU_INTTN_CD 
                    , fcBassEx0350CDNM(AA.DPOB_CD,AA.TYP_OCCU_CD,AA.DTIL_OCCU_INTTN_CD,'1' ) AS DTIL_OCCU_INTTN_NM 
                    , AA.BUSIN_CD
                    , fcBass0500CDNM(AA.DPOB_CD,SUBSTR(AA.BUSIN_CD,1,4),BB.DEPT_CD,AA.BUSIN_CD) AS BUSIN_NM  
                    , BB.EMYMT_DIV_CD
                    , fcBass0300CDNM(BB.DPOB_CD,BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM
                    , BB.HAN_NM
                    , BB.RESN_REGN_NUM  
                    , AA.PAYR_MANG_DEPT_CD
                    , fcBass0400CDNM(AA.DPOB_CD,AA.PAYR_MANG_DEPT_CD,'2') AS PAYR_MANG_DEPT_NM
                    , AA.HDOFC_DIV_CD
                    , fcBass0300CDNM(AA.DPOB_CD,AA.HDOFC_DIV_CD) AS HDOFC_DIV_NM
                    , DECODE(AA.JDOC_FILE,'Y','전자파일','문서') AS JDOC_FNNM 
                FROM YETA2000 AA, (
                SELECT  DISTINCT   AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                 ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD01.DTIL_OCCU_CLS_DIV_CD,  DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD01.DTIL_OCCU_CLS_DIV_CD,AD01.DTIL_OCCU_CLS_DIV_CD) ) AS DTIL_OCCU_CLS_DIV_CD 
                                             , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01,  (SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYMT_YR_MNTH, PAYR_SEIL_NUM, PAY_CD,
                                                                           PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PAYR0304
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYYT_YR_MNTH,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                            PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PYYT0304) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #edacRvyy# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                    SELECT      MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304  
																		 WHERE   PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                          GROUP BY SYSTEMKEY
																      ) 
									                                            )
									                                              GROUP BY  DPOB_CD,  
                                                                                 SYSTEMKEY
									                                            ) MM   
									                                             ) GG
									                            WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                              /*     AND NN.PAYR_SEIL_NUM = GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #edacRvyy# ||'%'   
                                             ) BB  
                         ,  YE161005 DD 
                    WHERE AA.DPOB_CD=BB.DPOB_CD  
                      	AND AA.SYSTEMKEY = BB.SYSTEMKEY 
          				AND AA.DPOB_CD=DD.DPOB_CD(+)
          				    AND AA.YETA_DPCD = DD.WHDG_TX_REGRST_DEPT_CD(+)
						<isNotEmpty prepend="AND" property="busoprRgstnum" >
							DD.BUSOPR_RGSTNUM = #busoprRgstnum#
				    	</isNotEmpty> 
						<isNotEmpty property="yetaDpcd" >
		         			<isEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
								AA.YETA_DPCD IS NULL
							</isEqual>
							<isNotEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
							AA.YETA_DPCD=#yetaDpcd#
							</isNotEqual>
	          			</isNotEmpty> 
            			<isNotEmpty prepend="AND" property="edacRvyy" >
							AA.EDAC_RVYY = #edacRvyy#
						</isNotEmpty>  
						<isNotEmpty prepend="AND" property="settGbcd" >
							AA.SETT_GBCD=#settGbcd#
				 		</isNotEmpty> 
                       	<isNotEmpty prepend="AND" property="systemkey" >
                       		AA.SYSTEMKEY=#systemkey#
                      	</isNotEmpty> 
                 AND EXISTS  (
                            SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#edacRvyy# ))) C 
                                            WHERE     C.DPOB_CD = BB.DPOB_CD
						                        AND C.DEPT_CD = BB.DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
                                        	     <isNotEmpty property="deptCd" prepend="AND">
												<![CDATA[
												 C.DEPT_CD
												]]>
												<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
												 #deptCdArr[]#
												</iterate>
												</isNotEmpty>  
                                          ) 
                       <isNotEmpty prepend="AND" property="businCd" >
                         BB.BUSIN_CD=#businCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                         AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="emymtDivCd" >
                         BB.EMYMT_DIV_CD=#emymtDivCd#
                         </isNotEmpty>  
                     <isNotEmpty property="typOccuCd" prepend="AND">
                    <![CDATA[
                     BB.TYP_OCCU_CD
                    ]]>
                    <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
                     #typOccuCdArr[]#
                    </iterate>
                    </isNotEmpty>  
                  
                    <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 BB.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate> 
				  </isNotEmpty>	
			) 
			
	</select> 
	
	<!-- yeta0100 선택된 대상자나 신규 생성시 값을 가져와 삭제한다. --> 
	<select id="ye17Ta2000_2022_DAO.fnPayr06430_PAYR450_DelSelect_D" parameterClass="ye17Ta2000Srh_2022_Vo" resultClass="egovMap">
		 
			 SELECT            
                      AA.DPOB_CD
                    , AA.SYSTEMKEY
                    , AA.SETT_GBCD
                    , AA.EDAC_SEIL_NUM
                    , fcBass0300CDNM(AA.DPOB_CD,AA.SETT_GBCD) AS SETT_GBNM
                    , AA.EDAC_RVYY 
                    , BB.DEPT_CD
                    , fcBass0400CDNM(AA.DPOB_CD,BB.DEPT_CD,'2') AS DEPT_NM 
                    , AA.TYP_OCCU_CD 
                    , fcBass0320CDNM(AA.DPOB_CD, AA.TYP_OCCU_CD)  AS TYP_OCCU_NM
                    , NVL(AA.PYSP_GRDE_CD,'A0060000') AS PYSP_GRDE_CD
                    , AA.DTIL_OCCU_INTTN_CD 
                    , fcBassEx0350CDNM(AA.DPOB_CD,AA.TYP_OCCU_CD,AA.DTIL_OCCU_INTTN_CD,'1' ) AS DTIL_OCCU_INTTN_NM 
                    , AA.BUSIN_CD
                    , fcBass0500CDNM(AA.DPOB_CD,SUBSTR(AA.BUSIN_CD,1,4),BB.DEPT_CD,AA.BUSIN_CD) AS BUSIN_NM  
                    , BB.EMYMT_DIV_CD
                    , fcBass0300CDNM(BB.DPOB_CD,BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM
                    , BB.HAN_NM
                    , BB.RESN_REGN_NUM  
                    , AA.PAYR_MANG_DEPT_CD
                    , fcBass0400CDNM(AA.DPOB_CD,AA.PAYR_MANG_DEPT_CD,'2') AS PAYR_MANG_DEPT_NM
                    , AA.HDOFC_DIV_CD
                    , fcBass0300CDNM(AA.DPOB_CD,AA.HDOFC_DIV_CD) AS HDOFC_DIV_NM 
                FROM YETA2000 AA, (
                 SELECT  DISTINCT    AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD01.DTIL_OCCU_CLS_DIV_CD,  DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD01.DTIL_OCCU_CLS_DIV_CD,AD01.DTIL_OCCU_CLS_DIV_CD) ) AS DTIL_OCCU_CLS_DIV_CD 
                                             , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01,  (SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYMT_YR_MNTH, PAYR_SEIL_NUM, PAY_CD,
                                                                           PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PAYR0304
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYYT_YR_MNTH,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                            PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PYYT0304) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #edacRvyy# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                   SELECT      MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                            )
									                                              GROUP BY  DPOB_CD,  
                                                                                 SYSTEMKEY
									                                            ) MM  
									                                            
									                                             ) GG
									                             WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                               /*     AND NN.PAYR_SEIL_NUM = GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #edacRvyy# ||'%'   
                ) BB,YETA1000 CC  
                    WHERE AA.DPOB_CD=BB.DPOB_CD  
                      AND AA.SYSTEMKEY = BB.SYSTEMKEY 
                      AND AA.DPOB_CD=CC.DPOB_CD    
                      AND AA.EDAC_RVYY = CC.EDAC_RVYY                                                       
                      AND AA.SETT_GBCD = CC.SETT_GBCD 
                      AND AA.EDAC_SEIL_NUM = CC.EDAC_SEIL_NUM 
                          <isNotEmpty prepend="AND" property="edacRvyy" >
						 	AA.EDAC_RVYY = #edacRvyy#
					    </isNotEmpty>  
						<isNotEmpty prepend="AND" property="settGbcd" >
						 	AA.SETT_GBCD=#settGbcd#
					    </isNotEmpty>
                       <isNotEmpty prepend="AND" property="systemkey" >
                       AA.SYSTEMKEY=#systemkey#
                  </isNotEmpty> 
                 AND EXISTS  (
                            SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#edacRvyy# )) ) C
                                            WHERE     C.DPOB_CD = BB.DPOB_CD
						                        AND C.DEPT_CD = BB.DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
                                        	     <isNotEmpty property="deptCd" prepend="AND">
												<![CDATA[
												 C.DEPT_CD
												]]>
												<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
												 #deptCdArr[]#
												</iterate>
												</isNotEmpty>  
                                          ) 
                       <isNotEmpty prepend="AND" property="businCd" >
                         BB.BUSIN_CD=#businCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                         BB.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="emymtDivCd" >
                         BB.EMYMT_DIV_CD=#emymtDivCd#
                         </isNotEmpty>  
                     <isNotEmpty property="typOccuCd" prepend="AND">
                    <![CDATA[
                     BB.TYP_OCCU_CD
                    ]]>
                    <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
                     #typOccuCdArr[]#
                    </iterate>
                    </isNotEmpty>  
                  
                    <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 BB.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate> 
				  </isNotEmpty>	 
			
	</select>
	
	
	<!-- yeta0200 화면 연말정산 대상자 생성결과 조회  -->
	<select id="ye17Ta2000_2022_DAO.selectYeta0300ToYeta3000List" parameterClass="ye17Ta2000Srh_2022_Vo" resultClass="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (
			 SELECT            
                      AA.DPOB_CD
                    , AA.SYSTEMKEY
                    , AA.SETT_GBCD
                    , AA.EDAC_SEIL_NUM
                    , fcBass0300CDNM(AA.DPOB_CD,AA.SETT_GBCD) AS SETT_GBNM
                    , AA.EDAC_RVYY 
                    , BB.DEPT_CD 
                    , fcBass0400CDNM(AA.DPOB_CD,BB.DEPT_CD,'2') AS DEPT_NM 
                    , AA.TYP_OCCU_CD 
                    , fcBass0320CDNM(AA.DPOB_CD, AA.TYP_OCCU_CD)  AS TYP_OCCU_NM
                    , NVL(AA.PYSP_GRDE_CD,'A0060000') AS PYSP_GRDE_CD
                    , AA.DTIL_OCCU_INTTN_CD 
                    , fcBassEx0350CDNM(AA.DPOB_CD,AA.TYP_OCCU_CD,AA.DTIL_OCCU_INTTN_CD,'1' ) AS DTIL_OCCU_INTTN_NM 
                    , AA.BUSIN_CD
                    , fcBass0500CDNM(AA.DPOB_CD,SUBSTR(AA.BUSIN_CD,1,4),BB.DEPT_CD,AA.BUSIN_CD) AS BUSIN_NM  
                    , BB.EMYMT_DIV_CD
                    , fcBass0300CDNM(BB.DPOB_CD,BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM
                    , BB.HAN_NM
                    , BB.RESN_REGN_NUM  
                    , AA.PAYR_MANG_DEPT_CD
                    , fcBass0400CDNM(AA.DPOB_CD,AA.PAYR_MANG_DEPT_CD,'2') AS PAYR_MANG_DEPT_NM
                    , AA.HDOFC_DIV_CD
                    , fcBass0300CDNM(AA.DPOB_CD,AA.HDOFC_DIV_CD) AS HDOFC_DIV_NM
                    , DECODE(AA.JDOC_FILE,'Y','전자파일','문서') AS JDOC_FNNM 
                FROM YETA2000 AA, (
                SELECT  DISTINCT    AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD01.DTIL_OCCU_CLS_DIV_CD,  DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD01.DTIL_OCCU_CLS_DIV_CD,AD01.DTIL_OCCU_CLS_DIV_CD) ) AS DTIL_OCCU_CLS_DIV_CD 
                                              , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT   
                                                  FROM PSNL0100 AD01,  (SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYMT_YR_MNTH, PAYR_SEIL_NUM, PAY_CD,
                                                                           PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PAYR0304
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYYT_YR_MNTH,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                            PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PYYT0304) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #edacRvyy# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                  SELECT      MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                            )
									                                              GROUP BY  DPOB_CD,  
                                                                                 SYSTEMKEY
									                                            ) MM  
									                                            
									                                             ) GG
									                             WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                                 /*     AND NN.PAYR_SEIL_NUM =  GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #edacRvyy# ||'%'    
                                             ) BB   , YE161005 DD 
                    WHERE AA.DPOB_CD=BB.DPOB_CD  
                      	AND AA.SYSTEMKEY = BB.SYSTEMKEY 
               			AND AA.DPOB_CD=DD.DPOB_CD(+)
               			    AND AA.YETA_DPCD = DD.WHDG_TX_REGRST_DEPT_CD(+)
						<isNotEmpty prepend="AND" property="busoprRgstnum" >
							DD.BUSOPR_RGSTNUM = #busoprRgstnum#
				    	</isNotEmpty> 
						<isNotEmpty property="yetaDpcd" >
		         			<isEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
								AA.YETA_DPCD IS NULL
							</isEqual>
							<isNotEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
							AA.YETA_DPCD=#yetaDpcd#
							</isNotEqual>
	          			</isNotEmpty> 
                   		<isNotEmpty prepend="AND" property="edacRvyy" >
								 	AA.EDAC_RVYY = #edacRvyy#
							    </isNotEmpty>  
								<isNotEmpty prepend="AND" property="settGbcd" >
								 	AA.SETT_GBCD=#settGbcd#
							    </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="systemkey" >
                       AA.SYSTEMKEY=#systemkey#
                      </isNotEmpty> 
                 AND EXISTS  (
                        SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#edacRvyy# )) ) C
                                            WHERE     C.DPOB_CD = BB.DPOB_CD
						                        AND C.DEPT_CD = BB.DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
                                        	     <isNotEmpty property="deptCd" prepend="AND">
												<![CDATA[
												 C.DEPT_CD
												]]>
												<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
												 #deptCdArr[]#
												</iterate>
												</isNotEmpty>  
                                          ) 
                       <isNotEmpty prepend="AND" property="businCd" >
                         BB.BUSIN_CD=#businCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                         AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="emymtDivCd" >
                         BB.EMYMT_DIV_CD=#emymtDivCd#
                         </isNotEmpty>  
                     <isNotEmpty property="typOccuCd" prepend="AND">
                    <![CDATA[
                     BB.TYP_OCCU_CD
                    ]]>
                    <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
                     #typOccuCdArr[]#
                    </iterate>
                    </isNotEmpty>  
                  
                    <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 BB.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate> 
				  </isNotEmpty>	
				     <isNotEmpty prepend="AND" property="hanNm" >
							 	BB.HAN_NM LIKE '%' || #hanNm# || '%'
						    </isNotEmpty> 
		       ORDER BY   AA.EDAC_RVYY DESC 
                             ,(SELECT LPAD(DEPT_RANK,5,'0')  
                                   FROM BASS0400 DD
                                   WHERE DD.DEPT_CD =  BB.DEPT_CD   
                                     AND DD.DPOB_CD = BB.DPOB_CD) ASC 
                            , BB.RESN_REGN_NUM ASC
                            , AA.SYSTEMKEY DESC   
		<![CDATA[					
	) A WHERE ROWNUM <= #lastIndex#
)WHERE RNUM >= #firstIndex#
]]>
	</select>	
	<!-- yeta0200 화면 연말정산 대상자 생성결과 조회  -->
	<select id="ye17Ta2000_2022_DAO.selectYeta0300ToYeta3000ListTotCnt_S" parameterClass="ye17Ta2000Srh_2022_Vo" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM (
			SELECT            
                      AA.DPOB_CD
                    , AA.SYSTEMKEY
                    , AA.SETT_GBCD
                    , AA.EDAC_SEIL_NUM
                    , fcBass0300CDNM(AA.DPOB_CD,AA.SETT_GBCD) AS SETT_GBNM
                    , AA.EDAC_RVYY 
                    , BB.DEPT_CD 
                    , fcBass0400CDNM(AA.DPOB_CD,BB.DEPT_CD,'2') AS DEPT_NM 
                    , AA.TYP_OCCU_CD 
                    , fcBass0320CDNM(AA.DPOB_CD, AA.TYP_OCCU_CD)  AS TYP_OCCU_NM
                    , NVL(AA.PYSP_GRDE_CD,'A0060000') AS PYSP_GRDE_CD
                    , AA.DTIL_OCCU_INTTN_CD 
                    , fcBassEx0350CDNM(AA.DPOB_CD,AA.TYP_OCCU_CD,AA.DTIL_OCCU_INTTN_CD,'1' ) AS DTIL_OCCU_INTTN_NM 
                    , AA.BUSIN_CD
                    , fcBass0500CDNM(AA.DPOB_CD,SUBSTR(AA.BUSIN_CD,1,4),BB.DEPT_CD,AA.BUSIN_CD) AS BUSIN_NM  
                    , BB.EMYMT_DIV_CD
                    , fcBass0300CDNM(BB.DPOB_CD,BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM
                    , BB.HAN_NM
                    , BB.RESN_REGN_NUM  
                    , AA.PAYR_MANG_DEPT_CD
                    , fcBass0400CDNM(AA.DPOB_CD,AA.PAYR_MANG_DEPT_CD,'2') AS PAYR_MANG_DEPT_NM
                    , AA.HDOFC_DIV_CD
                    , fcBass0300CDNM(AA.DPOB_CD,AA.HDOFC_DIV_CD) AS HDOFC_DIV_NM
                    , DECODE(AA.JDOC_FILE,'Y','전자파일','문서') AS JDOC_FNNM 
                FROM YETA2000 AA, (
                SELECT  DISTINCT   AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                 ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD01.DTIL_OCCU_CLS_DIV_CD,  DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD01.DTIL_OCCU_CLS_DIV_CD,AD01.DTIL_OCCU_CLS_DIV_CD) ) AS DTIL_OCCU_CLS_DIV_CD 
                                         , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01,  (SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYMT_YR_MNTH, PAYR_SEIL_NUM, PAY_CD,
                                                                           PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PAYR0304
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYYT_YR_MNTH,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                            PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PYYT0304) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #edacRvyy# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                   SELECT      MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                            )
									                                              GROUP BY  DPOB_CD,  
                                                                                 SYSTEMKEY
									                                            ) MM   
									                                             ) GG
									                            WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                                  /*     AND NN.PAYR_SEIL_NUM =  GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #edacRvyy# ||'%'   
                                             ) BB   , YE161005 DD
                    WHERE AA.DPOB_CD=BB.DPOB_CD  
             			AND AA.SYSTEMKEY = BB.SYSTEMKEY
             			AND AA.DPOB_CD=DD.DPOB_CD(+)
             			    AND AA.YETA_DPCD = DD.WHDG_TX_REGRST_DEPT_CD(+)
						<isNotEmpty prepend="AND" property="busoprRgstnum" >
							DD.BUSOPR_RGSTNUM = #busoprRgstnum#
				    	</isNotEmpty> 
						<isNotEmpty property="yetaDpcd" >
		         			<isEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
								AA.YETA_DPCD IS NULL
							</isEqual>
							<isNotEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
							AA.YETA_DPCD=#yetaDpcd#
							</isNotEqual>
	          			</isNotEmpty>  
               			<isNotEmpty prepend="AND" property="edacRvyy" >
							AA.EDAC_RVYY = #edacRvyy#
						</isNotEmpty>  
						<isNotEmpty prepend="AND" property="settGbcd" >
							AA.SETT_GBCD=#settGbcd#
						</isNotEmpty> 
                       	<isNotEmpty prepend="AND" property="systemkey" >
                       		AA.SYSTEMKEY=#systemkey#
                      	</isNotEmpty> 
                 AND EXISTS  (
                         SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#edacRvyy# )) ) C
                                            WHERE     C.DPOB_CD = BB.DPOB_CD
						                        AND C.DEPT_CD = BB.DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
                                        	     <isNotEmpty property="deptCd" prepend="AND">
												<![CDATA[
												 C.DEPT_CD
												]]>
												<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
												 #deptCdArr[]#
												</iterate>
												</isNotEmpty>  
                                          ) 
                       <isNotEmpty prepend="AND" property="businCd" >
                         BB.BUSIN_CD=#businCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                         AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="emymtDivCd" >
                         BB.EMYMT_DIV_CD=#emymtDivCd#
                         </isNotEmpty>  
                     <isNotEmpty property="typOccuCd" prepend="AND">
                    <![CDATA[
                     BB.TYP_OCCU_CD
                    ]]>
                    <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
                     #typOccuCdArr[]#
                    </iterate>
                    </isNotEmpty>  
                  
                    <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 BB.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate> 
				  </isNotEmpty>	
				     <isNotEmpty prepend="AND" property="hanNm" >
							 	BB.HAN_NM LIKE '%' || #hanNm# || '%'
						    </isNotEmpty> 
			) 
			
	</select> 
	
	<select id="ye17Ta2000_2022_DAO.selectYeta0300AllToYeta3000List_D" parameterClass="ye17Ta2000Srh_2022_Vo"  resultMap="ye17Ta2000_2022">
		<![CDATA[
			SELECT
				DPOB_CD
				, EDAC_RVYY
				, SETT_GBCD
				, SYSTEMKEY
				, EDAC_SEIL_NUM
				, PAYR_MANG_DEPT_CD
				, EMYMT_DIV_CD
				, HAN_NM
				, RESN_REGN_NUM
				, DEPT_CD
				, BUSIN_CD
				, TYP_OCCU_CD
				, DTIL_OCCU_INTTN_CD
				, DTIL_OCCU_CLS_DIV_CD
				, ODTY_CD
				, PYSP_CD
				, PYSP_GRDE_CD
				, LOG_SVC_YR_NUM_CD
				, LOG_SVC_MNTH_ICM_CD
				, FRST_EMYMT_DT
				, EMYMT_BGNN_DT
				, EMYMT_END_DT
				, HDOFC_DIV_CD
				, RETRY_DT
				, YRTX_APPTN_YR_MNTH
				, YRTX_PRCS_DT
				, YRTX_PRCS_YN
				, DIVD_PYMT_DIV_CD
				, DIVD_PYMT
				, GNAN_SGTF
				, FRNR_YENO
				, REYM_STDT
				, REYM_EDDT
				, RUTR_EDDT
				, RUTR_STDT
				, RESD_FLAG
				, NATN_GBCD
				, NATN_NAME
				, REDT_GBCD
				, REDT_NAME
				, HUMN_CGUE
				, FRNR_SGYN
				, BASE_WIYN
				, BASE_FMLY
				, ADDR_CT70
				, ADDR_HDRC
				, ADDR_FDSU
				, ADDR_CLCT
				, ADDR_BHCT
				, PANT_ONSU
				, ADDR_MRCT
				, BNAT_PSNF
				, JNAT_PSNF
				, BPSS_TECH
				, BPSS_PULC
				, BPSS_FECT
				, BPSS_SOLD
				, JPSS_PULC
				, JPSS_SOLD
				, JPSS_TECH
				, JPSS_FECT
				, BRTR_PSCT
				, BRTR_CICT
				, BRTR_ANSV
				, JRTR_CICT
				, JRTR_CTAR
				, JRTR_PSCT
				, JRTR_PTAR
				, JRTR_ANSV
				, JRTR_ATAR
				, RRPT_AMNT
				, SPCI_BHLH
				, SPCI_HHLH
				, SPCI_BEPF
				, SPCI_JEPF
				, SPCI_GURT
				, SPCI_HDRC
				, SPCI_RTTG
				, SPCI_IUAM
				, SPCI_SELF
				, SPCI_AE65
				, SPCI_DBPS
				, SPCI_DETC
				, SPCI_DTAR
				, SPCI_ETAM
				, SPED_SELF
				, SPED_EDSU
				, SPED_EDAM
				, SPED_GDSU
				, SPED_GDAM
				, SPED_CVSU
				, SPED_CVAM
				, SPCI_SCSU
				, SPCI_SCAM
				, SPED_ETAR
				, SIED_TOAM
				, SPCI_REFN
				, SPCI_RESF
				, SPCI_HTAM
				, SPCH_REFN
				, SPCH_RE06
				, SPCH_RE10
				, SPCH_RE20
				, SPCH_REFX
				, SPCH_REEC
				, SPCH_15FX
				, SPCH_15FB
				, SPCH_15EC
				, SPCH_10FB
				, SPCH_10EC
				, TAXD_PLTC
				, TAXD_10TG
				, SPCI_PLTC
				, SPCI_PLTG
				, SPCI_FBAM
				, SPCI_FBTG
				, SPCI_EXAM
				, SPCI_UNON
				, SPCI_HFAM
				, SPCI_YAMT
				, SPCI_NAMT
				, SPCI_DGTG
				, SPCI_FNRL
				, PRVM_20BE
				, PRVM_21AF
				, ETCH_PREP
				, ETCS_COMP
				, ETWK_HSVM
				, ETWK_HSBM
				, ETWK_HLGM
				, ETWK_HBDM
				, ETCT_CONC
				, ETGD_H09F
				, ETGD_H13F
				, ETGD_H14F
				, ETCL_H15F
				, ETGD_HDAM
				, ETCT_CARD
				, ETCH_BCBS
				, ETCH_UEAM
				, ETCH_MGVD
				, ETCH_BCED
				, CARD_ET13
				, CARD_ET14
				, ETAD_DD13
				, ETAD_D14L
				, ETCH_BCUE
				, ETCK_UNON
				, ETCK_UNCB
				, ETEP_HSAM
				, ETGD_CTRA
				, ETEP_SEST
				, ETCL_HM01
				, ETCL_HM02
				, ETCL_HM03
				, ETCL_HMTA
				, ETCL_ETTL
				, ETCL_ETAM
				, TAXD_INCD
				, TAXD_WKDT
				, TAMA_EDDT
				, TAMA_INDT
				, TAMA_OUDT
				, TXLG_FRRD
				, TXLG_FRID
				, TXLG_WKID
				, TXLG_TXTD
				, TXLG_BSCD
				, TXLG_BCDE
				, TXLG_ITCT
				, TXLG_BSTA
				, TXLG_WKTA
				, TXLG_CLTA
				, TXLG_FRTA
				, TXLG_TXTY
				, TXLG_INAM
				, TXLG_DLAM
				, TXLG_WNAM
				, TXLG_OTCY
				, TXLG_OTDT
				, TXLG_APDT
				, TXLG_OUWK
				, TXAP_STDT
				, TXAP_EDDT
				, TXAP_WKDY
				, TAXD_UNIN
				, TAXD_LOAA
				, ADDC_NTYN
				, ADDC_MDYN
				, ADDC_CTYN
				, ADDC_PFYN
				, ADDF_PVYN
				, SPCI_REYN
				, TXLG_MXTM
				, INCO_OUDT
				, INCO_OUFG
				, JDOC_FILE
				, JRTR_ATOM
				, JRTR_TOTR
				, SPCI_HDTG
				, SPCI_DETG
				, SPCI_RTTO
				, SPCI_SFTG
				, SPCI_65TG
				, SPCI_PSTG
				, SPCI_ETCG
				, SPED_SFTR
				, SPED_EDTR
				, SPED_GDTR
				, SPED_CVTR
				, SPCI_SCTR
				, SPCI_EXTG
				, SPCI_UNTG
				, SPCI_HFTG
				, SPCI_NATG
				, SPCI_YATG
				, SPCI_DGAM
				, SPCI_ONON
				, SPCI_OBAM
				, SPCI_OYAM
				, SPCI_ONAM
				, KYBDR
				, INPT_DT
				, INPT_ADDR
				, ISMT
				, REVN_DT
				, REVN_ADDR
			FROM YETA2000
						WHERE DPOB_CD=#dpobCd#
								AND EDAC_RVYY=#edacRvyy#
								AND SETT_GBCD=#settGbcd# 
				]]>
	</select>
	
	
	<select id="ye17Ta2000_2022_DAO.selectPsnl0100List_D" parameterClass="infcPsnl0100Srh_2022_Vo" resultClass="egovMap">
		SELECT * FROM (
			SELECT T.*, ROWNUM RNUM FROM (
					SELECT AA.DPOB_CD
					        , AA.SYSTEMKEY
					        , BB.EMYMT_DIV_CD
					        , fcBass0300CDNM (AA.DPOB_CD, BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM
					        , AA.HAN_NM
					        , AA.RESN_REGN_NUM
					        , AA.NATN_CD
					        , fcBass0300CDNM (AA.DPOB_CD, AA.NATN_CD) AS NATN_NM
					        , BB.DEPT_CD
					        , fcBass0400CDNM (AA.DPOB_CD, BB.DEPT_CD, '2') AS DEPT_NM
					        , BB.TYP_OCCU_CD
					        , fcBass0320CDNM(AA.DPOB_CD, BB.TYP_OCCU_CD)AS TYP_OCCU_NM 
					        , BB.DTIL_OCCU_INTTN_CD
					        ,  (CASE WHEN BB.EMYMT_DIV_CD = 'A0020010'
					            THEN fcBassEx0350CDNM(AA.DPOB_CD, BB.TYP_OCCU_CD, BB.DTIL_OCCU_INTTN_CD, '1')
					           ELSE (SELECT B.BUSIN_NM 
					                        FROM BASS0500 B
					                        WHERE B.DPOB_CD = BB.DPOB_CD 
					                            AND B.DEPT_CD = BB.DEPT_CD 
					                            AND B.BUSIN_CD = BB.BUSIN_CD
					                            AND B.BUSIN_APPTN_YR =SUBSTR(BB.EMYMT_BGNN_DT,1,4)
					                  )         
					           END)AS DTIL_OCCU_INTTN_NM
					         , AA.FRST_EMYMT_DT
					         , BB.EMYMT_BGNN_DT
					         , BB.EMYMT_END_DT
					         , BB.BUSIN_CD
					         , AA.HDOFC_CODTN_CD
					         , fcBass0300CDNM (AA.DPOB_CD, AA.HDOFC_CODTN_CD) AS HDOFC_CODTN_NM
					         , CC.PAYR_MANG_DEPT_CD
					FROM PSNL0100 AA, PAYR0500 CC,
					(SELECT CC01.DPOB_CD
							, CC01.SYSTEMKEY
							, CC01.EMYMT_DIV_CD
					        , CC01.DEPT_CD
					        , CC01.TYP_OCCU_CD
					        , CC01.DTIL_OCCU_INTTN_CD
					        , CC01.BUSIN_CD
					        , MIN (CC01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT
					        , MAX (NVL (CC01.EMYMT_END_DT, TO_CHAR (SYSDATE, 'YYYYMMDD')))AS EMYMT_END_DT
					  FROM PSNL0110 CC01
					 WHERE     CC01.DPOB_CD = #dpobCd#
							<isNotEmpty prepend="AND" property="emymtDivCd" >
					 			CC01.EMYMT_DIV_CD=#emymtDivCd#
							</isNotEmpty>
							<isEqual prepend="AND" property="emymtDivCd" compareValue="A0020010">
								CC01.DTIL_OCCU_INTTN_CD IS NOT NULL
							</isEqual>
					       AND CC01.EMYMT_TYP_CD NOT IN ('A0420990')
					       AND CC01.EMYMT_BGNN_DT = ( SELECT MAX(CC02.EMYMT_BGNN_DT)
                                                                FROM PSNL0110 CC02
                                                              WHERE  CC02.EMYMT_TYP_CD NOT IN ('A0420990')  
                                                               AND  CC02.DPOB_CD = CC01.DPOB_CD 
                                                                AND CC02.SYSTEMKEY = CC01.SYSTEMKEY 
                                                                AND CC02.EMYMT_DIV_CD = CC01.EMYMT_DIV_CD
                                                                 AND SUBSTR(#emymtBgnnDt# ,1,4) BETWEEN  SUBSTR(CC02.EMYMT_BGNN_DT,1,4)  
                                                                AND SUBSTR(NVL (  CC02.EMYMT_END_DT,
                                                                 (CASE  WHEN TO_CHAR ( #emymtEndDt#) <![CDATA[	<= ]]> TO_CHAR ( SYSDATE, 'YYYYMMDD')
                                                                     THEN TO_CHAR (  SYSDATE, 'YYYYMMDD')
                                                                     ELSE TO_CHAR (#emymtEndDt#)  END)),1,4)  
					                               	 	)
					
					GROUP BY CC01.DPOB_CD
					         , CC01.SYSTEMKEY
					         , CC01.EMYMT_DIV_CD
					         , CC01.DEPT_CD
					         , CC01.TYP_OCCU_CD
					         , CC01.DTIL_OCCU_INTTN_CD
					         , CC01.BUSIN_CD) BB 
					WHERE AA.DPOB_CD = BB.DPOB_CD
					    AND AA.SYSTEMKEY = BB.SYSTEMKEY 
					    AND AA.DPOB_CD = CC.DPOB_CD 
					    AND AA.SYSTEMKEY = CC.SYSTEMKEY  
						<isNotEmpty prepend="AND" property="dpobCd" >
							AA.DPOB_CD=#dpobCd#
				    	</isNotEmpty> 
				    	<isNotEmpty property="deptCd" prepend="AND">
								<![CDATA[
							      DECODE(AA.CURR_AFFN_DEPT_CD,BB.DEPT_CD,BB.DEPT_CD,BB.DEPT_CD) 
								]]>
								<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
								 #deptCdArr[]#
								</iterate>
								</isNotEmpty> 
				       AND NOT EXISTS ( SELECT TA01.DPOB_CD , TA01.EDAC_RVYY , TA01.SETT_GBCD , TA01.SYSTEMKEY
				     				  FROM YETA2000 TA01
				     				  WHERE TA01.DPOB_CD = #dpobCd#
				     				  	AND TA01.EDAC_RVYY = #clutYr#
				     				  	AND TA01.SETT_GBCD = #clutSeptCd#
				     				  	AND TA01.SYSTEMKEY = AA.SYSTEMKEY
				     		         )
				     AND EXISTS  (
                         SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#emymtBgnnDt# )) ) C
                                            WHERE     C.DPOB_CD = AA.DPOB_CD
						                        AND C.DEPT_CD = AA.CURR_AFFN_DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(AA.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(AA.DTIL_OCCU_INTTN_CD,'TT')
                                             
                                          )
                    <isNotEmpty prepend="AND" property="businCd" >
					 	AA.BUSIN_CD=#businCd#
				    </isNotEmpty> 
					<isNotEmpty prepend="AND" property="payrMangDeptCd" >
					 	CC.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
				    </isNotEmpty> 
				    <isNotEmpty prepend="AND" property="emymtDivCd" >
					 	BB.EMYMT_DIV_CD=#emymtDivCd#
					</isNotEmpty>
					<isNotEmpty property="hdofcCodtnCd" prepend="AND">
						<![CDATA[
							 AA.HDOFC_CODTN_CD
						]]>
						<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
							 #hdofcCodtnCdArr[]#
						</iterate>
					</isNotEmpty>  
				    <isNotEmpty property="typOccuCd" prepend="AND">
						<![CDATA[
							 BB.TYP_OCCU_CD
						]]>
						<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
						 	 #typOccuCdArr[]#
						</iterate>
					</isNotEmpty>  
					<!-- 
					<isNotEmpty property="pyspGrdeCd" prepend="AND">
						<![CDATA[
							 NVL(A.PYSP_GRDE_CD,'A0060000')
						]]>
						<iterate prepend="IN" property="pyspGrdeCdArr" open="(" close=")" conjunction=",">
							 #pyspGrdeCdArr[]#
						</iterate>
					</isNotEmpty>  
					 -->
					<isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 BB.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate>
					</isNotEmpty>  
				    <isNotEmpty prepend="AND" property="systemkey" >
					 	AA.SYSTEMKEY=#systemkey#
				    </isNotEmpty>  
				    <isNotEmpty prepend="AND" property="hanNm" >
					 	AA.HAN_NM LIKE '%' || #hanNm# || '%'
				    </isNotEmpty> 					
					ORDER BY 
					    AA.DPOB_CD DESC
					    , ( SELECT LPAD(DEPT_RANK,5,'0')  
					            FROM BASS0400 DD
					        WHERE DD.DEPT_CD = BB.DEPT_CD
					            AND DD.DPOB_CD = BB.DPOB_CD) ASC
					    , AA.RESN_REGN_NUM ASC
					    , AA.SYSTEMKEY DESC 
		
	<isNotEqual  property="lastIndex" compareValue="-1">
 	<![CDATA[					
				) T WHERE ROWNUM <= #lastIndex#
		)WHERE RNUM >= #firstIndex#
	]]>
	</isNotEqual>	
	<isEqual   property="lastIndex" compareValue="-1">
  	<![CDATA[					
		) T  
	)
	]]>
	</isEqual>	
 </select>	
	
	<select id="ye17Ta2000_2022_DAO.selectPsnl0100ListCnt_S" parameterClass="infcPsnl0100Srh_2022_Vo" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM ( SELECT AA.DPOB_CD
					        , AA.SYSTEMKEY
					FROM PSNL0100 AA, PAYR0500 CC,
					( SELECT CC01.DPOB_CD
							, CC01.SYSTEMKEY
							, CC01.EMYMT_DIV_CD
					        , CC01.DEPT_CD
					        , CC01.TYP_OCCU_CD
					        , CC01.DTIL_OCCU_INTTN_CD
					        , CC01.BUSIN_CD
					        , MIN (CC01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT
					        , MAX (NVL (CC01.EMYMT_END_DT, TO_CHAR (SYSDATE, 'YYYYMMDD')))AS EMYMT_END_DT
					  FROM PSNL0110 CC01
					 WHERE     CC01.DPOB_CD = #dpobCd#
							<isNotEmpty prepend="AND" property="emymtDivCd" >
					 			CC01.EMYMT_DIV_CD=#emymtDivCd#
							</isNotEmpty> 
							<isEqual prepend="AND" property="emymtDivCd" compareValue="A0020010">
								CC01.DTIL_OCCU_INTTN_CD IS NOT NULL
							</isEqual>
							AND CC01.EMYMT_TYP_CD NOT IN ('A0420990')
					      	AND CC01.EMYMT_BGNN_DT = ( SELECT MAX(CC02.EMYMT_BGNN_DT)
                                                                FROM PSNL0110 CC02
                                                               WHERE  CC02.EMYMT_TYP_CD NOT IN ('A0420990')  
                                                               AND  CC02.DPOB_CD = CC01.DPOB_CD 
                                                                AND CC02.SYSTEMKEY = CC01.SYSTEMKEY 
                                                                AND CC02.EMYMT_DIV_CD = CC01.EMYMT_DIV_CD
                                                                 AND SUBSTR(#emymtBgnnDt# ,1,4) BETWEEN  SUBSTR(CC02.EMYMT_BGNN_DT,1,4)  
                                                                AND SUBSTR(NVL (  CC02.EMYMT_END_DT,
                                                                 (CASE  WHEN TO_CHAR ( #emymtEndDt#) 	<![CDATA[	<= ]]>TO_CHAR ( SYSDATE, 'YYYYMMDD')
                                                                     THEN TO_CHAR (  SYSDATE, 'YYYYMMDD')
                                                                     ELSE TO_CHAR (#emymtEndDt#)  END)),1,4)                                 						
					                                 	)			      
					GROUP BY CC01.DPOB_CD
					         , CC01.SYSTEMKEY
					         , CC01.EMYMT_DIV_CD
					         , CC01.DEPT_CD
					         , CC01.TYP_OCCU_CD
					         , CC01.DTIL_OCCU_INTTN_CD
					         , CC01.BUSIN_CD) BB
					WHERE AA.DPOB_CD = BB.DPOB_CD
					    AND AA.SYSTEMKEY = BB.SYSTEMKEY 
					    AND AA.DPOB_CD = CC.DPOB_CD 
					    AND AA.SYSTEMKEY = CC.SYSTEMKEY  
						<isNotEmpty prepend="AND" property="dpobCd" >
							AA.DPOB_CD=#dpobCd#
				    	</isNotEmpty> 
				      <isNotEmpty property="deptCd" prepend="AND">
								<![CDATA[
								  DECODE(AA.CURR_AFFN_DEPT_CD,BB.DEPT_CD,BB.DEPT_CD,BB.DEPT_CD) 
								]]>
								<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
								 #deptCdArr[]#
								</iterate>
								</isNotEmpty> 
				     AND NOT EXISTS ( SELECT TA01.DPOB_CD , TA01.EDAC_RVYY , TA01.SETT_GBCD , TA01.SYSTEMKEY
				     				  FROM YETA2000 TA01
				     				  WHERE	TA01.DPOB_CD = #dpobCd#
				     				  	AND TA01.EDAC_RVYY = #clutYr#
				     				  	AND TA01.SETT_GBCD = #clutSeptCd#
				     				  	AND TA01.SYSTEMKEY = AA.SYSTEMKEY
				     		         )			    	
				     AND EXISTS  (
                         SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#emymtBgnnDt# )) ) C
                                            WHERE     C.DPOB_CD = AA.DPOB_CD
						                        AND C.DEPT_CD = AA.CURR_AFFN_DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(AA.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(AA.DTIL_OCCU_INTTN_CD,'TT') 
                                          )
                    <isNotEmpty prepend="AND" property="businCd" >
					 	AA.BUSIN_CD=#businCd#
				    </isNotEmpty> 
					<isNotEmpty prepend="AND" property="payrMangDeptCd" >
					 	CC.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
				    </isNotEmpty> 
				    <isNotEmpty prepend="AND" property="emymtDivCd" >
					 	BB.EMYMT_DIV_CD=#emymtDivCd#
					</isNotEmpty>
					<isNotEmpty property="hdofcCodtnCd" prepend="AND">
						<![CDATA[
							 AA.HDOFC_CODTN_CD
						]]>
						<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
							 #hdofcCodtnCdArr[]#
						</iterate>
					</isNotEmpty>  
				    <isNotEmpty property="typOccuCd" prepend="AND">
						<![CDATA[
							 BB.TYP_OCCU_CD
						]]>
						<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
						 	 #typOccuCdArr[]#
						</iterate>
					</isNotEmpty>  
					<!-- 
					<isNotEmpty property="pyspGrdeCd" prepend="AND">
						<![CDATA[
							 NVL(A.PYSP_GRDE_CD,'A0060000')
						]]>
						<iterate prepend="IN" property="pyspGrdeCdArr" open="(" close=")" conjunction=",">
							 #pyspGrdeCdArr[]#
						</iterate>
					</isNotEmpty>  
					 -->
					<isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 BB.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate>
					</isNotEmpty>  
				    <isNotEmpty prepend="AND" property="systemkey" >
					 	AA.SYSTEMKEY=#systemkey#
				    </isNotEmpty>  
				    <isNotEmpty prepend="AND" property="hanNm" >
					 	AA.HAN_NM LIKE '%' || #hanNm# || '%'
				    </isNotEmpty> 					
					ORDER BY 
					    AA.DPOB_CD DESC
					    , ( SELECT LPAD(DEPT_RANK,5,'0')  
					            FROM BASS0400 DD
					        WHERE DD.DEPT_CD = BB.DEPT_CD
					            AND DD.DPOB_CD = BB.DPOB_CD) ASC
					    , AA.RESN_REGN_NUM ASC
					    , AA.SYSTEMKEY DESC
	)
	</select>	
	
		<!-- yeta1100 화면 연말정산 대상자 생성결과 조회  -->
	<select id="ye17Ta2000_2022_DAO.selectYeta1100ToYeta3000List_D" parameterClass="ye17Ta2000Srh_2022_Vo" resultClass="egovMap">
	SELECT * FROM (
		SELECT A.*, ROWNUM RNUM FROM (
				 SELECT            
	                      AA.DPOB_CD
	                    , AA.SYSTEMKEY
	                    , AA.SETT_GBCD
	                    , AA.EDAC_SEIL_NUM
	                    , fcBass0300CDNM(AA.DPOB_CD,AA.SETT_GBCD) AS SETT_GBNM
	                    , AA.EDAC_RVYY 
	                    , BB.DEPT_CD  
	                    , fcBass0400CDNM(AA.DPOB_CD,BB.DEPT_CD,'2') AS DEPT_NM 
	                    , AA.TYP_OCCU_CD 
	                    , fcBass0320CDNM(AA.DPOB_CD, AA.TYP_OCCU_CD)  AS TYP_OCCU_NM
	                    , NVL(AA.PYSP_GRDE_CD,'A0060000') AS PYSP_GRDE_CD
	                    , AA.DTIL_OCCU_INTTN_CD 
	                    , fcBassEx0350CDNM(AA.DPOB_CD,AA.TYP_OCCU_CD,AA.DTIL_OCCU_INTTN_CD,'1' ) AS DTIL_OCCU_INTTN_NM 
	                    , AA.BUSIN_CD
	                    , fcBass0500CDNM(AA.DPOB_CD,SUBSTR(AA.BUSIN_CD,1,4),BB.DEPT_CD,AA.BUSIN_CD) AS BUSIN_NM  
	                    , BB.EMYMT_DIV_CD
	                    , fcBass0300CDNM(BB.DPOB_CD,BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM
	                    , BB.HAN_NM
	                    , BB.RESN_REGN_NUM  
	                    , AA.PAYR_MANG_DEPT_CD
	                    , fcBass0400CDNM(AA.DPOB_CD,AA.PAYR_MANG_DEPT_CD,'2') AS PAYR_MANG_DEPT_NM
	                    , AA.HDOFC_DIV_CD
	                    , fcBass0300CDNM(AA.DPOB_CD,AA.HDOFC_DIV_CD) AS HDOFC_DIV_NM
	                    , AA.REYM_STDT                                                                          
	                    , AA.REYM_EDDT  
	                    , AA.EMYMT_BGNN_DT
	                    , AA.EMYMT_END_DT                                                                        
	                    , CC.PAYR_TAMT                                                                          
	                    , CC.BONS_TOAM                                                                          
	                    , AA.JNAT_PSNF                                                                          
	                    , AA.SPCI_HHLH                                                                          
	                    , AA.SPCI_JEPF   
	                    , fcBass0400CDNM (AA.DPOB_CD, AA.YETA_DPCD, '2') AS YETA_DP_NM              
	                    , AA.YETA_DPCD AS yetaDpcdDeptCd
                    	, fcBass0400CDNM (AA.DPOB_CD, AA.YETA_DPCD, '2') AS yetaDpcdDeptNmRtchnt                                                                      
	                    , CC.ALRY_PINX                                                                          
	                    , CC.ALRY_PHBX  
	                FROM YETA2000 AA, (
	                 SELECT  DISTINCT AD02.SYSTEMKEY
                                              ,  AD02.DPOB_CD 
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                 ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD01.DTIL_OCCU_CLS_DIV_CD,  DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD01.DTIL_OCCU_CLS_DIV_CD,AD01.DTIL_OCCU_CLS_DIV_CD) ) AS DTIL_OCCU_CLS_DIV_CD 
                                          , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01,  (SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYMT_YR_MNTH, PAYR_SEIL_NUM, PAY_CD,
                                                                           PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PAYR0304
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYYT_YR_MNTH,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                            PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PYYT0304) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #edacRvyy# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                      SELECT      MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #edacRvyy#  ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #edacRvyy#  ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                            )
									                                              GROUP BY  DPOB_CD,  
                                                                                 SYSTEMKEY 
									                                            ) MM  
									                                            
									                                             ) GG
									                           WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                              /*     AND NN.PAYR_SEIL_NUM = GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #edacRvyy#  ||'%'   
	                ) BB,YETA3000 CC, YE161005 DD  
	                    WHERE AA.DPOB_CD=BB.DPOB_CD  
	                      AND AA.SYSTEMKEY = BB.SYSTEMKEY 
	                      AND AA.DPOB_CD=CC.DPOB_CD   
	                      AND AA.SYSTEMKEY = CC.SYSTEMKEY   
	                      AND AA.EDAC_RVYY = CC.EDAC_RVYY                                                       
	                      AND AA.SETT_GBCD = CC.SETT_GBCD 
	         			  AND AA.DPOB_CD=DD.DPOB_CD(+)
	         			      AND AA.YETA_DPCD = DD.WHDG_TX_REGRST_DEPT_CD(+)
                 			<isNotEmpty prepend="AND" property="busoprRgstnum" >
								DD.BUSOPR_RGSTNUM = #busoprRgstnum#
				    		</isNotEmpty> 
	                     	<isNotEmpty prepend="AND" property="edacRvyy" >
						 		AA.EDAC_RVYY = #edacRvyy#
					 		</isNotEmpty>  
							 <isNotEmpty property="yetaDpcd" >
		             			<isEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
									AA.YETA_DPCD IS NULL
								</isEqual>
								<isNotEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
									AA.YETA_DPCD=#yetaDpcd#
								</isNotEqual>
	                       </isNotEmpty>  		    
							<isNotEmpty prepend="AND" property="settGbcd" >
								AA.SETT_GBCD=#settGbcd#
							</isNotEmpty>
	                       	<isNotEmpty prepend="AND" property="systemkey" >
	                       		AA.SYSTEMKEY=#systemkey#
	             		</isNotEmpty> 
	                 AND EXISTS  (
	                             SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#edacRvyy# ))) C 
	                                            WHERE     C.DPOB_CD = BB.DPOB_CD
							                        AND C.DEPT_CD = BB.DEPT_CD
							                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
	                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
	                                        	     <isNotEmpty property="deptCd" prepend="AND">
													<![CDATA[
													 C.DEPT_CD
													]]>
													<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
													 #deptCdArr[]#
													</iterate>
													</isNotEmpty>  
	                                          ) 
	                       <isNotEmpty prepend="AND" property="businCd" >
	                         BB.BUSIN_CD=#businCd#
	                       </isNotEmpty> 
	                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
	                         AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
	                       </isNotEmpty> 
	                       <isNotEmpty property="yetaDpcd" >
		             			<isEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
									AA.YETA_DPCD IS NULL
								</isEqual>
								<isNotEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
									AA.YETA_DPCD=#yetaDpcd#
								</isNotEqual>
	                       </isNotEmpty> 
	                       
	                       <isNotEmpty prepend="AND" property="emymtDivCd" >
	                         BB.EMYMT_DIV_CD=#emymtDivCd#
	                         </isNotEmpty>  
	                     <isNotEmpty property="typOccuCd" prepend="AND">
	                    <![CDATA[
	                     BB.TYP_OCCU_CD
	                    ]]>
	                    <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
	                     #typOccuCdArr[]#
	                    </iterate>
	                    </isNotEmpty>  
	                  
	                    <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
							<![CDATA[
								 BB.DTIL_OCCU_INTTN_CD
							]]>
							<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
								 #dtilOccuInttnCdArr[]#
							</iterate> 
					  </isNotEmpty>	
			       ORDER BY   AA.EDAC_RVYY DESC
	                            , CC.EDAC_RVYY DESC 
	                             ,(SELECT LPAD(DEPT_RANK,5,'0')  
	                                   FROM BASS0400 DD
	                                   WHERE DD.DEPT_CD =  BB.DEPT_CD   
	                                     AND DD.DPOB_CD = BB.DPOB_CD) ASC 
	                            , BB.RESN_REGN_NUM ASC
	                            , AA.SYSTEMKEY DESC   
			<![CDATA[					
		) A WHERE ROWNUM <= #lastIndex#
	)WHERE RNUM >= #firstIndex#
	]]>
	</select>	
	
	
	<!-- yeta1100 화면 연말정산 대상자 생성결과 조회  -->
	<select id="ye17Ta2000_2022_DAO.selectYeta3100ToYe161010ListTotCnt_S" parameterClass="ye17Ta2000Srh_2022_Vo" resultClass="int">
		SELECT COUNT(*) totcnt
			FROM (
			 SELECT            
                      AA.DPOB_CD
                    , AA.SYSTEMKEY
                    , AA.SETT_GBCD
                    , AA.EDAC_SEIL_NUM
                    , fcBass0300CDNM(AA.DPOB_CD,AA.SETT_GBCD) AS SETT_GBNM
                    , AA.EDAC_RVYY 
                    , BB.DEPT_CD  
                    , fcBass0400CDNM(AA.DPOB_CD,BB.DEPT_CD,'2') AS DEPT_NM 
                    , AA.TYP_OCCU_CD 
                    , fcBass0320CDNM(AA.DPOB_CD, AA.TYP_OCCU_CD)  AS TYP_OCCU_NM
                    , NVL(AA.PYSP_GRDE_CD,'A0060000') AS PYSP_GRDE_CD
                    , AA.DTIL_OCCU_INTTN_CD 
                    , fcBassEx0350CDNM(AA.DPOB_CD,AA.TYP_OCCU_CD,AA.DTIL_OCCU_INTTN_CD,'1' ) AS DTIL_OCCU_INTTN_NM 
                    , AA.BUSIN_CD
                    , fcBass0500CDNM(AA.DPOB_CD,SUBSTR(AA.BUSIN_CD,1,4),BB.DEPT_CD,AA.BUSIN_CD) AS BUSIN_NM  
                    , BB.EMYMT_DIV_CD
                    , fcBass0300CDNM(BB.DPOB_CD,BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM
                    , BB.HAN_NM
                    , BB.RESN_REGN_NUM  
                    , AA.PAYR_MANG_DEPT_CD
                    , fcBass0400CDNM(AA.DPOB_CD,AA.PAYR_MANG_DEPT_CD,'2') AS PAYR_MANG_DEPT_NM
                    , AA.HDOFC_DIV_CD
                    , fcBass0300CDNM(AA.DPOB_CD,AA.HDOFC_DIV_CD) AS HDOFC_DIV_NM
                    , AA.REYM_STDT                                                                          
                    , AA.REYM_EDDT                                                                          
                    , CC.PAYR_TAMT                                                                          
                    , CC.BONS_TOAM                                                                          
                    , AA.JNAT_PSNF                                                                          
                    , AA.SPCI_HHLH                                                                          
                    , AA.SPCI_JEPF
                    , AA.YETA_DPCD
                    , CC.ALRY_PINX                                                                          
                    , CC.ALRY_PHBX  
                FROM YETA2000 AA, (
               SELECT  DISTINCT AD02.SYSTEMKEY
                                              ,  AD02.DPOB_CD 
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                 ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD01.DTIL_OCCU_CLS_DIV_CD,  DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD01.DTIL_OCCU_CLS_DIV_CD,AD01.DTIL_OCCU_CLS_DIV_CD) ) AS DTIL_OCCU_CLS_DIV_CD 
                                          , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01,  (SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYMT_YR_MNTH, PAYR_SEIL_NUM, PAY_CD,
                                                                           PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PAYR0304
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYYT_YR_MNTH,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                            PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PYYT0304) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #edacRvyy# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                      SELECT      MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #edacRvyy#  ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #edacRvyy#  ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                            )
									                                              GROUP BY  DPOB_CD,  
                                                                                 SYSTEMKEY 
									                                            ) MM  
									                                            
									                                             ) GG
									                           WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                              /*     AND NN.PAYR_SEIL_NUM = GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #edacRvyy#  ||'%'   
                ) BB,YETA3000 CC , YE161005 DD 
                    WHERE AA.DPOB_CD=BB.DPOB_CD  
                      AND AA.SYSTEMKEY = BB.SYSTEMKEY 
                      AND AA.DPOB_CD=CC.DPOB_CD   
                      AND AA.SYSTEMKEY = CC.SYSTEMKEY   
                      AND AA.EDAC_RVYY = CC.EDAC_RVYY                                                       
                      AND AA.SETT_GBCD = CC.SETT_GBCD 
                      AND AA.DPOB_CD=DD.DPOB_CD(+)
                          AND AA.YETA_DPCD = DD.WHDG_TX_REGRST_DEPT_CD(+)
                      	<isNotEmpty prepend="AND" property="busoprRgstnum" >
							DD.BUSOPR_RGSTNUM = #busoprRgstnum#
				    	</isNotEmpty> 
                      	<isNotEmpty prepend="AND" property="edacRvyy" >
							AA.EDAC_RVYY = #edacRvyy#
				    	</isNotEmpty> 
				    	 <isNotEmpty property="yetaDpcd" >
		             			<isEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
									AA.YETA_DPCD IS NULL
								</isEqual>
								<isNotEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
									AA.YETA_DPCD=#yetaDpcd#
								</isNotEqual>
	                       </isNotEmpty> 
						<isNotEmpty prepend="AND" property="settGbcd" >
						 	AA.SETT_GBCD=#settGbcd#
					    </isNotEmpty>
                       	<isNotEmpty prepend="AND" property="systemkey" >
                       		AA.SYSTEMKEY=#systemkey#
             			</isNotEmpty> 
                 AND EXISTS  (
                          SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#edacRvyy# )) ) C 
                                            WHERE     C.DPOB_CD = BB.DPOB_CD
						                        AND C.DEPT_CD = BB.DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
                                        	     <isNotEmpty property="deptCd" prepend="AND">
												<![CDATA[
												 C.DEPT_CD
												]]>
												<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
												 #deptCdArr[]#
												</iterate>
												</isNotEmpty>  
                                          ) 
                       <isNotEmpty prepend="AND" property="businCd" >
                         BB.BUSIN_CD=#businCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                         AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
                       </isNotEmpty> 
      					<isNotEmpty property="yetaDpcd" >
		             			<isEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
									AA.YETA_DPCD IS NULL
								</isEqual>
								<isNotEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
									AA.YETA_DPCD=#yetaDpcd#
								</isNotEqual>
	                       </isNotEmpty>                        
                       <isNotEmpty prepend="AND" property="emymtDivCd" >
                         BB.EMYMT_DIV_CD=#emymtDivCd#
                         </isNotEmpty>  
                     <isNotEmpty property="typOccuCd" prepend="AND">
                    <![CDATA[
                     BB.TYP_OCCU_CD
                    ]]>
                    <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
                     #typOccuCdArr[]#
                    </iterate>
                    </isNotEmpty>  
                  
                    <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 BB.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate> 
				  </isNotEmpty>	
			) 
			
	</select>
	
	
	
	<!-- 원천징수부서코드와 명을 가져온다. -->
	<select id="ye17Ta2000_2022_DAO.selectYeta3000YetaDpcdList_D" parameterClass="ye17Ta2000Srh_2022_Vo" resultClass="egovMap">
	<![CDATA[
		SELECT DISTINCT YETA_DPCD
		       , fcBass0400CDNM (DPOB_CD, YETA_DPCD, '2') AS YETA_DPNM
		  FROM YETA2000	
		  WHERE	DPOB_CD = #dpobCd#
		  	AND YETA_DPCD IS NOT NULL
	]]>
			<isNotEmpty property="deptCd" prepend="AND">
				<![CDATA[
					DEPT_CD
				]]>
				<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
					#deptCdArr[]#
				</iterate>
			</isNotEmpty>  
		UNION ALL
		SELECT '000000000' AS YETA_DPCD
			   , '미선택' AS YETA_DPNM
	 	  FROM DUAL
	
	</select>
	<!-- 근로자의 원천징수부서코드를 수정한다. -->
	<update id="ye17Ta2000_2022_DAO.updateYeta3000YetaDpcd_S">
	UPDATE YETA2000
		SET YETA_DPCD=#yetaDpcd#
			, ISMT=#ismt#
			, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
			, REVN_ADDR=#revnAddr#
	WHERE DPOB_CD = #dpobCd#
		AND EDAC_RVYY = #edacRvyy#
		AND SETT_GBCD = #settGbcd#
		AND SYSTEMKEY = #systemkey#
	</update>
	
	<!-- 마감처리할 대상자 리스트를 가져온다. -->
	<select id="ye17Ta2000_2022_DAO.selectFinYeta3000List" parameterClass="ye17Ta2000_2022_Vo" resultClass="egovMap">
		SELECT AA.SYSTEMKEY
              FROM YETA2000 AA , 
                   YETA3000 CC ,(
                                     SELECT   DISTINCT   AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01,  (SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYMT_YR_MNTH, PAYR_SEIL_NUM, PAY_CD,
                                                                           PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PAYR0304
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYYT_YR_MNTH,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                            PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PYYT0304) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #edacRvyy# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                    SELECT   MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #edacRvyy# ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                             ) 
									                                          GROUP BY  DPOB_CD,    SYSTEMKEY     
									                                            ) MM  
									                                          
									                                             ) GG
									                            WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                                 /*     AND NN.PAYR_SEIL_NUM =   GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #edacRvyy# ||'%'   
                                             ) BB  , YE161005 DD
             WHERE     BB.SYSTEMKEY = AA.SYSTEMKEY
                   AND BB.DPOB_CD=AA.DPOB_CD   
                   AND CC.SYSTEMKEY = AA.SYSTEMKEY
                   AND CC.EDAC_RVYY = AA.EDAC_RVYY
                   AND CC.SETT_GBCD = AA.SETT_GBCD
                   AND CC.DPOB_CD = AA.DPOB_CD   
                   AND AA.DPOB_CD = DD.DPOB_CD(+)
                   AND AA.YETA_DPCD = DD.WHDG_TX_REGRST_DEPT_CD(+)
                   <isNotEmpty prepend="AND" property="busoprRgstnum" >
							DD.BUSOPR_RGSTNUM = #busoprRgstnum#
				    	</isNotEmpty> 
						<isNotEmpty property="yetaDpcd" >
		         			<isEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
								AA.YETA_DPCD IS NULL
							</isEqual>
							<isNotEqual prepend="AND" property="yetaDpcd" compareValue="000000000">
							AA.YETA_DPCD=#yetaDpcd#
							</isNotEqual>
	          			</isNotEmpty>  
                       <isNotEmpty prepend="AND" property="edacRvyy" >
                                     AA.EDAC_RVYY = #edacRvyy#
                                </isNotEmpty>  
                                <isNotEmpty prepend="AND" property="settGbcd" >
                                     AA.SETT_GBCD=#settGbcd#
                                </isNotEmpty> 
                 AND EXISTS  (
                        SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#edacRvyy# )) ) C
                                            WHERE     C.DPOB_CD = BB.DPOB_CD
                                                AND C.DEPT_CD = BB.DEPT_CD
                                                AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
                                                 <isNotEmpty property="deptCd" prepend="AND">
                                                <![CDATA[
                                                 C.DEPT_CD
                                                ]]>
                                                <iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
                                                 #deptCdArr[]#
                                                </iterate>
                                                </isNotEmpty>  
                                          ) 
                       <isNotEmpty prepend="AND" property="businCd" >
                        <![CDATA[
                            BB.BUSIN_CD 
                        ]]>
                        <iterate prepend="IN" property="businCdArr" open="(" close=")" conjunction=",">
                            #businCdArr[]#
                        </iterate>
                          </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                         AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="emymtDivCd" >
                         BB.EMYMT_DIV_CD=#emymtDivCd#
                         </isNotEmpty>  
                     <isNotEmpty property="typOccuCd" prepend="AND">
                    <![CDATA[
                     BB.TYP_OCCU_CD
                    ]]>
                    <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
                     #typOccuCdArr[]#
                    </iterate>
                    </isNotEmpty>  
                  
                    <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
                        <![CDATA[
                             BB.DTIL_OCCU_INTTN_CD
                        ]]>
                        <iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
                             #dtilOccuInttnCdArr[]#
                        </iterate> 
                  </isNotEmpty> 
	</select>
	
	<!-- 연말정산신고파일 마감/풀기 -->
	<update id="ye17Ta2000_2022_DAO.finishYeta3000_S">
		<![CDATA[
		UPDATE YETA2000
			SET CLOS_FLAG=#closFlag#
				, CLOS_DATE=#closDate#
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
		WHERE  DPOB_CD=#dpobCd#
			AND EDAC_RVYY=#edacRvyy#
			AND SETT_GBCD=#settGbcd#
			AND SYSTEMKEY = #systemkey#
		]]>
	</update>
	
</sqlMap>
