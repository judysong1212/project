<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="Ye161040_2020">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="ye161040Srh_2020_Vo" type="com.app.exterms.yearendtax.server.vo.Ye161040Srh_2020_VO"/>
	
	<resultMap id="ye161040_2020" class="com.app.exterms.yearendtax.server.vo.Ye161040_2020_VO">
		<result property="dpobCd" column="DPOB_CD" columnIndex="1"/>
		<result property="yrtxBlggYr" column="YRTX_BLGG_YR" columnIndex="2"/>
		<result property="clutSeptCd" column="CLUT_SEPT_CD" columnIndex="3"/>
		<result property="systemkey" column="SYSTEMKEY" columnIndex="4"/>
		<result property="txprDscmNoCntn" column="TXPR_DSCM_NO_CNTN" columnIndex="5"/>
		<result property="cdVvalKrnCd" column="CD_VVAL_KRN_CD" columnIndex="6"/>
		<result property="hifeDdcTrgtAmt" column="HIFE_DDC_TRGT_AMT" columnIndex="7"/>
		<result property="cvrgInscDdcTrgtAmt" column="CVRG_INSC_DDC_TRGT_AMT" columnIndex="8"/>
		<result property="dsbrDdcTrgtAmt" column="DSBR_DDC_TRGT_AMT" columnIndex="9"/>
		<result property="mdxpsDdcTrgtAmt" column="MDXPS_DDC_TRGT_AMT" columnIndex="10"/>
		<result property="scxpsDdcTrgtAmt" column="SCXPS_DDC_TRGT_AMT" columnIndex="11"/>
		<result property="crdcDdcTrgtAmt" column="CRDC_DDC_TRGT_AMT" columnIndex="12"/>
		<result property="drtpCardDdcTrgtAmt" column="DRTP_CARD_DDC_TRGT_AMT" columnIndex="13"/>
		<result property="cshptDdcTrgtAmt" column="CSHPT_DDC_TRGT_AMT" columnIndex="14"/>
		<result property="tdmrDdcTrgtAmt" column="TDMR_DDC_TRGT_AMT" columnIndex="15"/>
		<result property="pbtDdcTrgtAmt" column="PBT_DDC_TRGT_AMT" columnIndex="16"/>
		<result property="bookShowAmt" column="BOOK_SHOW_AMT" columnIndex="17"/>
		<result property="conbDdcTrgtAmt" column="CONB_DDC_TRGT_AMT" columnIndex="18"/>
		<result property="kybdr" column="KYBDR" columnIndex="19"/>
		<result property="inptDt" column="INPT_DT" columnIndex="20"/>
		<result property="inptAddr" column="INPT_ADDR" columnIndex="21"/>
		<result property="ismt" column="ISMT" columnIndex="22"/>
		<result property="revnDt" column="REVN_DT" columnIndex="23"/>
		<result property="revnAddr" column="REVN_ADDR" columnIndex="24"/>
	</resultMap>
	
	
	<typeAlias alias="infcPkgPayr0530_2020_Vo" type="com.app.smrmf.infc.payroll.server.vo.InfcPkgPayr0530VO"/>
	
	<resultMap id="infcPkgPayr0530_2020" class="com.app.smrmf.infc.payroll.server.vo.InfcPkgPayr0530VO">
	     <result property="dpobCd" column="DPOB_CD" columnIndex="1"/>
		<result property="systemkey" column="SYSTEMKEY" columnIndex="2"/>
		<result property="payFamyRsptSeilNum" column="PAY_FAMY_RSPT_SEIL_NUM" columnIndex="3"/>
		<result property="payFamyResnRegnNum" column="PAY_FAMY_RESN_REGN_NUM" columnIndex="4"/>
		<result property="hanNm" column="HAN_NM" columnIndex="5"/>
		<result property="famyRelaDivCd" column="FAMY_RELA_DIV_CD" columnIndex="6"/>
		<result property="famyAllwPymtYn" column="FAMY_ALLW_PYMT_YN" columnIndex="7"/>
		<result property="chdnChdRrgEpnsPymtYn" column="CHDN_CHD_RRG_EPNS_PYMT_YN" columnIndex="8"/>
		<result property="fndtnDducYn" column="FNDTN_DDUC_YN" columnIndex="9"/>
		<result property="spueDducYn" column="SPUE_DDUC_YN" columnIndex="10"/>
		<result property="wmnDducYn" column="WMN_DDUC_YN" columnIndex="11"/>
		<result property="rftaGvstDducYn" column="RFTA_GVST_DDUC_YN" columnIndex="12"/>
		<result property="dabpnDducYn" column="DABPN_DDUC_YN" columnIndex="13"/>
		<result property="sgpnFmlyDducYn" column="SGPN_FMLY_DDUC_YN" columnIndex="14"/>
		<result property="chdnChdRrgEpnsDducYn" column="CHDN_CHD_RRG_EPNS_DDUC_YN" columnIndex="15"/>
		<result property="famyExtpyDivCd" column="FAMY_EXTPY_DIV_CD" columnIndex="16"/>
		<result property="schlExpnAdmclExtpyDivCd" column="SCHL_EXPN_ADMCL_EXTPY_DIV_CD" columnIndex="17"/>
		<result property="schlExpnAdmclExtpySum" column="SCHL_EXPN_ADMCL_EXTPY_SUM" columnIndex="18"/>
		<result property="famyExtpySum" column="FAMY_EXTPY_SUM" columnIndex="19"/>
		<result property="schlExpnExtpyPymtBgnnDt" column="SCHL_EXPN_EXTPY_PYMT_BGNN_DT" columnIndex="20"/>
		<result property="schlExpnExtpyPymtEndDt" column="SCHL_EXPN_EXTPY_PYMT_END_DT" columnIndex="21"/>
		<result property="kybdr" column="KYBDR" columnIndex="22"/>
		<result property="inptDt" column="INPT_DT" columnIndex="23"/>
		<result property="inptAddr" column="INPT_ADDR" columnIndex="24"/>
		<result property="ismt" column="ISMT" columnIndex="25"/>
		<result property="revnDt" column="REVN_DT" columnIndex="26"/>
		<result property="revnAddr" column="REVN_ADDR" columnIndex="27"/>
	</resultMap>
	
	<!-- 
	#############################################################################
	######################## 2020년도 연말정산 로직 시작 ############################
	#############################################################################
	 -->
	 
	 <select id="infcPayr0530_2020_DAO.selectPayr0530Check_S" resultMap="infcPkgPayr0530_2020">
		<![CDATA[
			SELECT
				SYSTEMKEY
				, DPOB_CD
				, PAY_FAMY_RSPT_SEIL_NUM
				, PAY_FAMY_RESN_REGN_NUM
				, HAN_NM
				, FAMY_RELA_DIV_CD
				, FAMY_ALLW_PYMT_YN
				, CHDN_CHD_RRG_EPNS_PYMT_YN
				, FNDTN_DDUC_YN
				, SPUE_DDUC_YN
				, WMN_DDUC_YN
				, RFTA_GVST_DDUC_YN
				, DABPN_DDUC_YN
				, SGPN_FMLY_DDUC_YN
				, CHDN_CHD_RRG_EPNS_DDUC_YN
				, FAMY_EXTPY_DIV_CD
				, SCHL_EXPN_ADMCL_EXTPY_DIV_CD
				, SCHL_EXPN_ADMCL_EXTPY_SUM
				, FAMY_EXTPY_SUM
				, SCHL_EXPN_EXTPY_PYMT_BGNN_DT
				, SCHL_EXPN_EXTPY_PYMT_END_DT
				, KYBDR
				, INPT_DT
				, INPT_ADDR
				, ISMT
				, REVN_DT
				, REVN_ADDR
			FROM PAYR0530
						WHERE DPOB_CD=#dpobCd#
						AND SYSTEMKEY=#systemkey#
								AND PAY_FAMY_RESN_REGN_NUM=#payFamyResnRegnNum#
				]]>
	</select>
	
	
	<insert id="infcPayr0530_2020_DAO.insertPayr0530_S">
		<![CDATA[
			INSERT INTO PAYR0530 
				(  DPOB_CD
				  , SYSTEMKEY
				  , PAY_FAMY_RSPT_SEIL_NUM
				  , PAY_FAMY_RESN_REGN_NUM
				  , HAN_NM
				  , FAMY_RELA_DIV_CD
				  , FAMY_ALLW_PYMT_YN
				  , CHDN_CHD_RRG_EPNS_PYMT_YN
				  , FNDTN_DDUC_YN
				  , SPUE_DDUC_YN
				  , WMN_DDUC_YN
				  , RFTA_GVST_DDUC_YN
				  , DABPN_DDUC_YN
				  , SGPN_FMLY_DDUC_YN
				  , CHDN_CHD_RRG_EPNS_DDUC_YN
				  , FAMY_EXTPY_DIV_CD
				  , SCHL_EXPN_ADMCL_EXTPY_DIV_CD
				  , SCHL_EXPN_ADMCL_EXTPY_SUM
				  , FAMY_EXTPY_SUM
				  , SCHL_EXPN_EXTPY_PYMT_BGNN_DT
				  , SCHL_EXPN_EXTPY_PYMT_END_DT
				  , KYBDR
				  , INPT_DT
				  , INPT_ADDR
				  , ISMT
				  , REVN_DT
				  , REVN_ADDR )
			VALUES (  #dpobCd#
			      , #systemkey#
				  , (
				  	SELECT  NVL(MAX(PAY_FAMY_RSPT_SEIL_NUM),0) + 1
					  FROM PAYR0530
					 WHERE DPOB_CD=#dpobCd#
					   AND SYSTEMKEY=#systemkey#
				  ) 
				  , #payFamyResnRegnNum#
				  , #hanNm#
				  , #famyRelaDivCd#
				  , #famyAllwPymtYn#
				  , #chdnChdRrgEpnsPymtYn#
				  , #fndtnDducYn#
				  , #spueDducYn#
				  , #wmnDducYn#
				  , #rftaGvstDducYn#
				  , #dabpnDducYn#
				  , #sgpnFmlyDducYn#
				  , #chdnChdRrgEpnsDducYn#
				  , #famyExtpyDivCd#
				  , #schlExpnAdmclExtpyDivCd#
				  , #schlExpnAdmclExtpySum#
				  , #famyExtpySum#
				  , #schlExpnExtpyPymtBgnnDt#
				  , #schlExpnExtpyPymtEndDt#
				  , #kybdr#
				  , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				  , #inptAddr#
				  , #ismt#
				  , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				  , #revnAddr# )
		]]>
	</insert>	
	 
	 
	<insert id="ye161040_2020_DAO.yeta5300_YE161040_Insert01_S">
		<![CDATA[
			INSERT INTO YE161040 
				(   DPOB_CD		/* 	사업장코드         	 */
					,YRTX_BLGG_YR		/* 귀속연도		 */
					,CLUT_SEPT_CD		/* 연말정산구분코드		 */
					,SYSTEMKEY		/* SYSTEMKEY		 */
					,TXPR_DSCM_NO_CNTN	/* 주민등록번호		  */
					,CD_VVAL_KRN_CD		/* 소득공제명세자료구분코드  */
					,HIFE_DDC_TRGT_AMT	/* 건강등보험료		  */
					,MCUR_UI_TRGT_AMT	/* 고용보험료		 */
					,CVRG_INSC_DDC_TRGT_AMT	/* 보장성보험료		  */
					,DSBR_DDC_TRGT_AMT	/* 장애인전용보장성보험료	  */
					,MDXPS_DDC_TRGT_AMT	/* 의료비금액		 */
					,SCXPS_DDC_TRGT_AMT	/* 교육비금액		 */
					,CRDC_DDC_TRGT_AMT	/* 신용카드_전통대중도서제외금액	 */
					,DRTP_CARD_DDC_TRGT_AMT	/* 직불카드등_전통대중도서제외금액	 */
					,CSHPT_DDC_TRGT_AMT	/* 현금영수증_전통대중도서제외금액	 */
					,TDMR_DDC_TRGT_AMT	/* 전통시작사용금액		 */
					,PBT_DDC_TRGT_AMT	/* 대중교통이용금액		 */
					,BOOK_SHOW_AMT	/* 도서이용금액		 */
					,CONB_DDC_TRGT_AMT	/* 기부금액		 */
					,KYBDR			/* 입력자			  */
					,INPT_DT		/* 	입력일자		 */
					,INPT_ADDR		/* 입력주소		 */
					,ISMT			/* 수정자			  */
					,REVN_DT		/* 	수정일자		 */
					,REVN_ADDR		/* 수정주소		 */
 )
				  SELECT 	   AA.DPOB_CD		 /* 	사업장코드 	   */
								,AA.YRTX_BLGG_YR		/* 귀속연도	   */
								,AA.CLUT_SEPT_CD		/* 연말정산구분코드	   */
								,AA.SYSTEMKEY		/* SYSTEMKEY	   */                               
				              , BB.RSNO_NUMB    
				              ,'Y0140000'  /* 국세청 */           
				             ,0
				             ,0
				             ,0
				             ,0
				             ,0
				             ,0
				             ,0
				             ,0
				             ,0
				             ,0
				             ,0
				             ,0
							 ,0
					          , #kybdr#
							  , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
							  , #inptAddr#
							  , #ismt#
							  , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
							  , #revnAddr#                                                               
					FROM  YE161010 AA                                                       
						 , (                                                              
				           SELECT  A02.DPOB_CD,                                                      
				           A02.SYSTEMKEY,   A02.FAMY_RELA_DIV_CD,   A02.FAMY_SUPPT_RELA_DIV_CD  ,                                       
				           (CASE WHEN A02.DABPN_DDUC_YN = 'Y' THEN '1'  WHEN A02.FAMY_RELA_DIV_CD = 'A0190002' THEN '1'                 
				           ELSE CASE WHEN                                               
				                          (CASE WHEN (SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,7,1)) IN ('3','4') THEN '20' || SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,1,6)  
				                                ELSE '19' ||  SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,1,6) END) <= '19571231'  
				                     THEN '1' 
				                     ELSE  CASE WHEN  A02.FAMY_RELA_DIV_CD = 'A0190100'             
				                                THEN  CASE WHEN (CASE WHEN (SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,7,1)) IN ('3','4') THEN '20' || SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,1,6)  
				                                                      ELSE '19' ||  SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,1,6) END) >= '19990102'    
				                                           THEN '1'  ELSE '0' END
				                                ELSE  CASE WHEN (CASE WHEN (SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,7,1)) IN ('3','4') THEN '20' || SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,1,6)  
				                                                       ELSE '19' ||  SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,1,6) END) >= '19970101'    
				                                            THEN '1'  ELSE '0' END         
				           END       END          END ) AS BASE_DDYN,                          
				           A02.HAN_NM,                                             
				           A02.PAY_FAMY_RESN_REGN_NUM AS RSNO_NUMB,                                             
				           DECODE(TRIM(A02.DABPN_DDUC_YN),'Y','1','0') AS  DABPN_DDUC_YN  ,         
				            ('0') AS  BRDD_CTYN ,      
				               ( CASE WHEN (CASE WHEN (SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,7,1)) IN ('3','4') THEN '20' || SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,1,6)   
				                                    ELSE '19' ||  SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,1,6) END) <= '19471231'     
				                          THEN '1'  ELSE '0' END   ) AS  RPCT_DDYN , 
				  
				              ( '0' ) AS  BITH_DDYN  
				           FROM PSNL0100 A01, PAYR0530 A02                                          
				           WHERE A01.SYSTEMKEY = A02.SYSTEMKEY                    
				            AND A02.FAMY_RELA_DIV_CD != 'A0190001'  
				            AND   A01.SYSTEMKEY=#systemkey#
				          
				           UNION                                                              
				           SELECT   
						   A01.DPOB_CD,                                                          
				           A01.SYSTEMKEY,  
						   ('A0190001') AS DABTY_DIV_CD,    
						       ('Y0120000') AS FAMY_SUPPT_RELA_DIV_CD,                    
				           ('1') AS BASE_DDYN ,                                                        
				           A01.HAN_NM,                                                 
				           A01.RESN_REGN_NUM,                                                 
				           (CASE WHEN A02.DABTY_DIV_CD IS NULL THEN '0'                      
				           ELSE   DECODE(A02.DABTY_DIV_CD ,'A0370000','0','1') END) AS  OBST_GBCD     
				          , ('0') AS BRDD_CTYN                                                             
				          , ('0') AS RPCT_DDYN                                                            
				          , ('0') AS BITH_DDYN                                                            
				           FROM PSNL0100 A01, PSNL0113 A02                                                      
				           WHERE A01.SYSTEMKEY = A02.SYSTEMKEY(+)   
						     AND A01.DPOB_CD = A02.DPOB_CD(+)   
						     AND A01.SYSTEMKEY=#systemkey#     
						     	]]>  
				 <![CDATA[
				          ) BB                                                            
				          WHERE AA.DPOB_CD = BB.DPOB_CD
							AND  AA.SYSTEMKEY = BB.SYSTEMKEY                          
				           	AND BB.RSNO_NUMB IS NOT NULL  
				           	AND YRTX_BLGG_YR = #yrtxBlggYr#
				           	AND  CLUT_SEPT_CD = #clutSeptCd#
				           	AND AA.DPOB_CD=#dpobCd# 
				           	AND AA.SYSTEMKEY=#systemkey#  
				           	AND BB.RSNO_NUMB = #txprDscmNoCntn#
                    ]]>  
                 
		 
	</insert>
	
   
  
  	 <insert id="ye161040_2020_DAO.yeta5300_YE161040_Insert02_S">
		<![CDATA[
			INSERT INTO YE161040 
				(   DPOB_CD		/* 	사업장코드         	 */
					,YRTX_BLGG_YR		/* 귀속연도		 */
					,CLUT_SEPT_CD		/* 연말정산구분코드		 */
					,SYSTEMKEY		/* SYSTEMKEY		 */
					,TXPR_DSCM_NO_CNTN	/* 주민등록번호		  */
					,CD_VVAL_KRN_CD		/* 소득공제명세자료구분코드  */
					,HIFE_DDC_TRGT_AMT	/* 건강등보험료		  */
					,MCUR_UI_TRGT_AMT	/* 고용보험료		 */
					,CVRG_INSC_DDC_TRGT_AMT	/* 보장성보험료		  */
					,DSBR_DDC_TRGT_AMT	/* 장애인전용보장성보험료	  */
					,MDXPS_DDC_TRGT_AMT	/* 의료비금액		 */
					,SCXPS_DDC_TRGT_AMT	/* 교육비금액		 */
					,CRDC_DDC_TRGT_AMT	/* 신용카드_전통대중도서제외금액	 */
					,DRTP_CARD_DDC_TRGT_AMT	/* 직불카드등_전통대중도서제외금액	 */
					,CSHPT_DDC_TRGT_AMT	/* 현금영수증_전통대중도서제외금액	 */
					,TDMR_DDC_TRGT_AMT	/* 전통시작사용금액		 */
					,PBT_DDC_TRGT_AMT	/* 대중교통이용금액		 */
					,BOOK_SHOW_AMT	/* 도서이용금액		 */
					,CONB_DDC_TRGT_AMT	/* 기부금액		 */
					,KYBDR			/* 입력자			  */
					,INPT_DT		/* 	입력일자		 */
					,INPT_ADDR		/* 입력주소		 */
					,ISMT			/* 수정자			  */
					,REVN_DT		/* 	수정일자		 */
					,REVN_ADDR		/* 수정주소		 */
 )
				  SELECT 	   AA.DPOB_CD		 /* 	사업장코드 	   */
								,AA.YRTX_BLGG_YR		/* 귀속연도	   */
								,AA.CLUT_SEPT_CD		/* 연말정산구분코드	   */
								,AA.SYSTEMKEY		/* SYSTEMKEY	   */                               
				              , BB.RSNO_NUMB    
				              ,'Y0140001'  /* 국세청외 */           
				             ,0
				             ,0
				             ,0
				             ,0
				             ,0
				             ,0
				             ,0
				             ,0
				             ,0
				             ,0
				             ,0
				             ,0
							 ,0
					          , #kybdr#
							  , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
							  , #inptAddr#
							  , #ismt#
							  , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
							  , #revnAddr#                                                               
					FROM  YE161010 AA                                                       
						 , (                                                              
				           SELECT  A02.DPOB_CD,                                                      
				           A02.SYSTEMKEY,   A02.FAMY_RELA_DIV_CD,   A02.FAMY_SUPPT_RELA_DIV_CD  ,                                       
				           (CASE WHEN A02.DABPN_DDUC_YN = 'Y' THEN '1'  WHEN A02.FAMY_RELA_DIV_CD = 'A0190002' THEN '1'                 
				           ELSE CASE WHEN                                               
				                          (CASE WHEN (SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,7,1)) IN ('3','4') THEN '20' || SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,1,6)  
				                                ELSE '19' ||  SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,1,6) END) <= '19571231'  
				                     THEN '1' 
				                     ELSE  CASE WHEN  A02.FAMY_RELA_DIV_CD = 'A0190100'             
				                                THEN  CASE WHEN (CASE WHEN (SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,7,1)) IN ('3','4') THEN '20' || SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,1,6)  
				                                                      ELSE '19' ||  SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,1,6) END) >= '19990102'    
				                                           THEN '1'  ELSE '0' END
				                                ELSE  CASE WHEN (CASE WHEN (SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,7,1)) IN ('3','4') THEN '20' || SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,1,6)  
				                                                       ELSE '19' ||  SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,1,6) END) >= '19970101'    
				                                            THEN '1'  ELSE '0' END         
				           END       END          END ) AS BASE_DDYN,                          
				           A02.HAN_NM,                                             
				           A02.PAY_FAMY_RESN_REGN_NUM AS RSNO_NUMB,                                             
				           DECODE(TRIM(A02.DABPN_DDUC_YN),'Y','1','0') AS  DABPN_DDUC_YN  ,         
				            ('0') AS  BRDD_CTYN ,      
				               ( CASE WHEN (CASE WHEN (SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,7,1)) IN ('3','4') THEN '20' || SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,1,6)   
				                                    ELSE '19' ||  SUBSTR(A02.PAY_FAMY_RESN_REGN_NUM,1,6) END) <= '19471231'     
				                          THEN '1'  ELSE '0' END   ) AS  RPCT_DDYN , 
				  
				              ( '0' ) AS  BITH_DDYN  
				           FROM PSNL0100 A01, PAYR0530 A02                                          
				           WHERE A01.SYSTEMKEY = A02.SYSTEMKEY                    
				            AND A02.FAMY_RELA_DIV_CD != 'A0190001'  
				            AND   A01.SYSTEMKEY=#systemkey#
				          
				           UNION                                                              
				           SELECT   
						   A01.DPOB_CD,                                                          
				           A01.SYSTEMKEY,  
						   ('A0190001') AS DABTY_DIV_CD,    
						       ('Y0120000') AS FAMY_SUPPT_RELA_DIV_CD,                    
				           ('1') AS BASE_DDYN ,                                                        
				           A01.HAN_NM,                                                 
				           A01.RESN_REGN_NUM,                                                 
				           (CASE WHEN A02.DABTY_DIV_CD IS NULL THEN '0'                      
				           ELSE   DECODE(A02.DABTY_DIV_CD ,'A0370000','0','1') END) AS  OBST_GBCD     
				          , ('0') AS BRDD_CTYN                                                             
				          , ('0') AS RPCT_DDYN                                                            
				          , ('0') AS BITH_DDYN                                                            
				           FROM PSNL0100 A01, PSNL0113 A02                                                      
				           WHERE A01.SYSTEMKEY = A02.SYSTEMKEY(+)   
						     AND A01.DPOB_CD = A02.DPOB_CD(+)   
						     AND A01.SYSTEMKEY=#systemkey#     
						     	]]>  
				 <![CDATA[
				          ) BB                                                            
				          WHERE AA.DPOB_CD = BB.DPOB_CD
							AND  AA.SYSTEMKEY = BB.SYSTEMKEY                          
				           	AND BB.RSNO_NUMB IS NOT NULL  
				           	AND YRTX_BLGG_YR = #yrtxBlggYr#
				           	AND  CLUT_SEPT_CD = #clutSeptCd#
				           	AND AA.DPOB_CD=#dpobCd# 
				           	AND AA.SYSTEMKEY=#systemkey#  
				           	AND BB.RSNO_NUMB = #txprDscmNoCntn#
                    ]]>  
                 
		 
	</insert>	 
	 
	 
	 
	<insert id="ye161040_2020_DAO.insertYe161040_S">
		<![CDATA[
			INSERT INTO YE161040 
				( DPOB_CD
				  , YRTX_BLGG_YR
				  , CLUT_SEPT_CD
				  , SYSTEMKEY
				  , TXPR_DSCM_NO_CNTN
				  , CD_VVAL_KRN_CD
				  , HIFE_DDC_TRGT_AMT
				  , CVRG_INSC_DDC_TRGT_AMT
				  , DSBR_DDC_TRGT_AMT
				  , MDXPS_DDC_TRGT_AMT
				  , SCXPS_DDC_TRGT_AMT
				  , CRDC_DDC_TRGT_AMT
				  , DRTP_CARD_DDC_TRGT_AMT
				  , CSHPT_DDC_TRGT_AMT
				  , TDMR_DDC_TRGT_AMT
				  , PBT_DDC_TRGT_AMT
				  , BOOK_SHOW_AMT
				  , CONB_DDC_TRGT_AMT
				  , KYBDR
				  , INPT_DT
				  , INPT_ADDR
				  , ISMT
				  , REVN_DT
				  , REVN_ADDR )
			VALUES ( #dpobCd#
				  , #yrtxBlggYr#
				  , #clutSeptCd#
				  , #systemkey#
				  , #txprDscmNoCntn#
				  , #cdVvalKrnCd#
				  , #hifeDdcTrgtAmt#
				  , #cvrgInscDdcTrgtAmt#
				  , #dsbrDdcTrgtAmt#
				  , #mdxpsDdcTrgtAmt#
				  , #scxpsDdcTrgtAmt#
				  , #crdcDdcTrgtAmt#
				  , #drtpCardDdcTrgtAmt#
				  , #cshptDdcTrgtAmt#
				  , #tdmrDdcTrgtAmt#
				  , #pbtDdcTrgtAmt#
				  , #bookShowAmt#
				  , #conbDdcTrgtAmt#
				  , #kybdr#
				  , #inptDt#
				  , #inptAddr#
				  , #ismt#
				  , #revnDt#
				  , #revnAddr# )
		]]>
	</insert>
	
	<update id="ye161040_2020_DAO.updateYeta5300ToYe161040_S">
		<![CDATA[
			UPDATE YE161040
				SET HIFE_DDC_TRGT_AMT 		= #hifeDdcTrgtAmt#		
					, MCUR_UI_TRGT_AMT 		= #mcurUiTrgtAmt#		
					, CVRG_INSC_DDC_TRGT_AMT= #cvrgInscDdcTrgtAmt#	
					, DSBR_DDC_TRGT_AMT 	= #dsbrDdcTrgtAmt#		
					, MDXPS_DDC_TRGT_AMT 	= #mdxpsDdcTrgtAmt#		
					, SCXPS_DDC_TRGT_AMT 	= #scxpsDdcTrgtAmt#		
					, CRDC_DDC_TRGT_AMT 	= #crdcDdcTrgtAmt#		
					, DRTP_CARD_DDC_TRGT_AMT= #drtpCardDdcTrgtAmt#	
					, CSHPT_DDC_TRGT_AMT 	= #cshptDdcTrgtAmt#		
					, TDMR_DDC_TRGT_AMT 	= #tdmrDdcTrgtAmt#		
					, PBT_DDC_TRGT_AMT 		= #pbtDdcTrgtAmt#		
					, BOOK_SHOW_AMT 		= #bookShowAmt#		
					, CONB_DDC_TRGT_AMT 	= #conbDdcTrgtAmt#		
					, ISMT=#ismt#
					, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')	
					, REVN_ADDR=#revnAddr#
					
			WHERE DPOB_CD				=#dpobCd#
				AND YRTX_BLGG_YR		=#yrtxBlggYr#
				AND CLUT_SEPT_CD		=#clutSeptCd#
				AND SYSTEMKEY			=#systemkey#
				AND TXPR_DSCM_NO_CNTN	=#txprDscmNoCntn#
				AND CD_VVAL_KRN_CD		=#cdVvalKrnCd#
		]]>
	</update>
	
	<delete id="ye161040_2020_DAO.deleteYeta5300ToYe161040_S">
		<![CDATA[
			DELETE FROM YE161040 
				WHERE DPOB_CD=#dpobCd#
					AND YRTX_BLGG_YR=#yrtxBlggYr#
					AND CLUT_SEPT_CD=#clutSeptCd#
					AND SYSTEMKEY=#systemkey#
					AND TXPR_DSCM_NO_CNTN=#txprDscmNoCntn#
				]]>
	</delete>
	
	<select id="ye161040_2020_DAO.selectYe161040_S" resultMap="ye161040_2020">
		<![CDATA[
			SELECT
				DPOB_CD
				, YRTX_BLGG_YR
				, CLUT_SEPT_CD
				, SYSTEMKEY
				, TXPR_DSCM_NO_CNTN
				, CD_VVAL_KRN_CD
				, HIFE_DDC_TRGT_AMT
				, CVRG_INSC_DDC_TRGT_AMT
				, DSBR_DDC_TRGT_AMT
				, MDXPS_DDC_TRGT_AMT
				, SCXPS_DDC_TRGT_AMT
				, CRDC_DDC_TRGT_AMT
				, DRTP_CARD_DDC_TRGT_AMT
				, CSHPT_DDC_TRGT_AMT
				, TDMR_DDC_TRGT_AMT
				, PBT_DDC_TRGT_AMT
				, BOOK_SHOW_AMT
				, CONB_DDC_TRGT_AMT
				, KYBDR
				, INPT_DT
				, INPT_ADDR
				, ISMT
				, REVN_DT
				, REVN_ADDR
			FROM YE161040
						WHERE DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
								AND SYSTEMKEY=#systemkey#
								AND TXPR_DSCM_NO_CNTN=#txprDscmNoCntn#
								AND CD_VVAL_KRN_CD=#cdVvalKrnCd#
				]]>
	</select>
	
	<select id="ye161040_2020_DAO.seleteYeta5300ToYe161040_D" parameterClass="ye161040Srh_2020_Vo" resultClass="egovMap">
		SELECT * FROM (
			SELECT A.*, ROWNUM RNUM 
				FROM ( SELECT AA.DPOB_CD					
								, AA.YRTX_BLGG_YR			
								, AA.CLUT_SEPT_CD			
								, AA.SYSTEMKEY				
								, AA.CD_VVAL_KRN_CD			
								, AA.HIFE_DDC_TRGT_AMT		
								, AA.MCUR_UI_TRGT_AMT			
								, AA.CVRG_INSC_DDC_TRGT_AMT	
								, AA.DSBR_DDC_TRGT_AMT		
								, AA.MDXPS_DDC_TRGT_AMT		
								, AA.SCXPS_DDC_TRGT_AMT		
								, AA.CRDC_DDC_TRGT_AMT		
								, (AA.DRTP_CARD_DDC_TRGT_AMT + AA.ZRTD_DDC_TRGT_AMT) AS DRTP_CARD_DDC_TRGT_AMT
								, AA.CSHPT_DDC_TRGT_AMT		
								, AA.TDMR_DDC_TRGT_AMT		
								, AA.PBT_DDC_TRGT_AMT		
								, AA.BOOK_SHOW_AMT		
								, AA.CONB_DDC_TRGT_AMT		
								, AA.KYBDR					
								, AA.INPT_DT					
								, AA.INPT_ADDR				
								, AA.ISMT					
								, AA.REVN_DT					
								, AA.REVN_ADDR
								
								, BB.TXPR_DSCM_NO_CNTN
								, BB.TXPR_NM
								
							FROM YE161040 AA, YE161030 BB
						WHERE AA.DPOB_CD			= BB.DPOB_CD
							AND AA.YRTX_BLGG_YR		= BB.YRTX_BLGG_YR			
							AND AA.CLUT_SEPT_CD		= BB.CLUT_SEPT_CD			
							AND AA.SYSTEMKEY		= BB.SYSTEMKEY		
							AND AA.TXPR_DSCM_NO_CNTN= BB.TXPR_DSCM_NO_CNTN
							
							AND AA.DPOB_CD 			= #dpobCd#
							AND AA.YRTX_BLGG_YR		= #yrtxBlggYr#			
							AND AA.CLUT_SEPT_CD		= #clutSeptCd#			
							AND AA.SYSTEMKEY		= #systemkey#	
							AND AA.CD_VVAL_KRN_CD	= #cdVvalKrnCd#
							
						ORDER BY AA.DPOB_CD DESC
									, AA.YRTX_BLGG_YR DESC
									, AA.CLUT_SEPT_CD DESC
									, AA.SYSTEMKEY DESC
									, AA.TXPR_DSCM_NO_CNTN DESC
									, AA.CD_VVAL_KRN_CD DESC
				
				<![CDATA[					
			) A WHERE ROWNUM <= #lastIndex#
		)WHERE RNUM >= #firstIndex#
		]]>
	</select>	
	
	<select id="ye161040_2020_DAO.seleteYeta5300ToYe161040ListCnt_S" parameterClass="ye161040Srh_2020_Vo" resultClass="int">
			SELECT COUNT(AA.SYSTEMKEY) totcnt
				FROM YE161040 AA, YE161030 BB
			WHERE AA.DPOB_CD			= BB.DPOB_CD
				AND AA.YRTX_BLGG_YR		= BB.YRTX_BLGG_YR			
				AND AA.CLUT_SEPT_CD		= BB.CLUT_SEPT_CD			
				AND AA.SYSTEMKEY		= BB.SYSTEMKEY		
				AND AA.TXPR_DSCM_NO_CNTN= BB.TXPR_DSCM_NO_CNTN
							
				AND AA.DPOB_CD 			= #dpobCd#
				AND AA.YRTX_BLGG_YR		= #yrtxBlggYr#			
				AND AA.CLUT_SEPT_CD		= #clutSeptCd#			
				AND AA.SYSTEMKEY		= #systemkey#	
				AND AA.CD_VVAL_KRN_CD	= #cdVvalKrnCd#
							
	</select>	 
	 
	 
	 
	 <!-- 
	#############################################################################
	######################## 2020년도 연말정산 로직 종료 ############################
	#############################################################################
	 -->
	 	
<!-- +++++++++++++++++++++++++ 2020년도 귀속 로직  시작 ++++++++++++++++++++++++++++++ -->

	<delete id="ye161040_2020_DAO.deleteYetaP510001_Ye161040VO_2020_Delete_S">
		<![CDATA[
			DELETE FROM YE161040 
						WHERE DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
								AND SYSTEMKEY=#systemkey# 
				]]>
	</delete>

<!-- +++++++++++++++++++++++++ 2020년도 귀속 로직  종료 ++++++++++++++++++++++++++++++ -->	
	
	
	
	

</sqlMap>
