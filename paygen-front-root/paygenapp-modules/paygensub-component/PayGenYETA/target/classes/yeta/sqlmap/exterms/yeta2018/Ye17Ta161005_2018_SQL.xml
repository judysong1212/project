<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="Ye17Ta161005_2018">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="ye161005Srh_2018_Vo" type="com.app.exterms.yearendtax.server.vo.Ye161005Srh_2018_VO"/>
	<typeAlias  alias="ye161005_2018_Vo" type="com.app.exterms.yearendtax.server.vo.Ye161005_2018_VO"/>
	
	<resultMap id="ye161005_2018" class="com.app.exterms.yearendtax.server.vo.Ye161005_2018_VO">
		<result property="dpobCd" 				column="DPOB_CD" 					columnIndex="1"/>
		<result property="whdgTxRegrstDeptCd" 	column="WHDG_TX_REGRST_DEPT_CD" 	columnIndex="2"/>
		<result property="hhrkWhdgRegrstDeptCd" column="HHRK_WHDG_REGRST_DEPT_CD" 	columnIndex="3"/>
		<result property="txOffcCd" 			column="TX_OFFC_CD" 				columnIndex="4"/>
		<result property="pentrSeptCd" 			column="PENTR_SEPT_CD" 				columnIndex="5"/>
		<result property="txDeptyMangeNum" 		column="TX_DEPTY_MANGE_NUM" 		columnIndex="6"/>
		<result property="hmtxId" 				column="HMTX_ID" 					columnIndex="7"/>
		<result property="txPgmCd" 				column="TX_PGM_CD" 					columnIndex="8"/>
		<result property="busoprRgstnum" 		column="BUSOPR_RGSTNUM" 			columnIndex="9"/>
		<result property="corpFmnmNm" 			column="CORP_FMNM_NM" 				columnIndex="10"/>
		<result property="pernChrgDeptNm" 		column="PERN_CHRG_DEPT_NM" 			columnIndex="11"/>
		<result property="pernChrgNm" 			column="PERN_CHRG_NM" 				columnIndex="12"/>
		<result property="pernChrgPhnNum" 		column="PERN_CHRG_PHN_NUM" 			columnIndex="13"/>
		<result property="useHanCd" 			column="USE_HAN_CD" 				columnIndex="14"/>
		<result property="sumtTgtPridCd" 		column="SUMT_TGT_PRID_CD" 			columnIndex="15"/>
		<result property="corpNum" 				column="CORP_NUM" 					columnIndex="16"/>
		<result property="incmPost" 			column="INCM_POST" 					columnIndex="17"/>
		<result property="incmAddr" 			column="INCM_ADDR" 					columnIndex="18"/>
		<result property="incmAdtl" 			column="INCM_ADTL" 					columnIndex="19"/>
		<result property="kybdr" 				column="KYBDR" 						columnIndex="20"/>
		<result property="inptDt" 				column="INPT_DT" 					columnIndex="21"/>
		<result property="inptAddr" 			column="INPT_ADDR" 					columnIndex="22"/>
		<result property="ismt" 				column="ISMT" 						columnIndex="23"/>
		<result property="revnDt" 				column="REVN_DT" 					columnIndex="24"/>
		<result property="revnAddr"		 		column="REVN_ADDR" 					columnIndex="25"/>
		<result property="reprName" 			column="REPR_NAME" 					columnIndex="26"/>
		<result property="resuNumb" 			column="RESU_NUMB" 					columnIndex="27"/>
	</resultMap>
	

	<!-- 사업자번호를 가져온다. -->
	<select id="ye17Ta161005_2018_DAO.selectYeta3000busoprRgstnumList_D" parameterClass="ye161005Srh_2018_Vo" resultClass="egovMap">
	<![CDATA[
	SELECT DISTINCT REPLACE(BUSOPR_RGSTNUM, '-', '') AS BUSOPR_RGSTNUM
	  FROM YE161005
	 WHERE DPOB_CD = #dpobCd#
	    AND WHDG_TX_REGRST_DEPT_CD = #whdgTxRegrstDeptCd#
	]]>
	</select>
	
	<!-- 데이터 중복 확인  -->	
	<select id="ye17Ta161005_2018_DAO.selectYe161005ListCnt" parameterClass="ye161005_2018_Vo" resultClass="int">
		SELECT COUNT(*)
			FROM YE161005 
			WHERE DPOB_CD = #dpobCd#
				AND WHDG_TX_REGRST_DEPT_CD = #whdgTxRegrstDeptCd#
				AND REPLACE(BUSOPR_RGSTNUM, '-', '') = REPLACE(#busoprRgstnum#, '-', '')
    </select>
	
	<!-- 선택한 원천신고부서의 정보를 가져온다. -->
	<select id="ye17Ta161005_2018_DAO.selectYe161005List_L" resultMap="ye161005_2018">
		<![CDATA[
			SELECT DPOB_CD
				, WHDG_TX_REGRST_DEPT_CD
				, HHRK_WHDG_REGRST_DEPT_CD
				, TX_OFFC_CD
				, PENTR_SEPT_CD
				, TX_DEPTY_MANGE_NUM
				, HMTX_ID
				, TX_PGM_CD
				, BUSOPR_RGSTNUM
				, CORP_FMNM_NM
				, PERN_CHRG_DEPT_NM
				, PERN_CHRG_NM
				, PERN_CHRG_PHN_NUM
				, USE_HAN_CD
				, SUMT_TGT_PRID_CD
				, CORP_NUM
				, INCM_POST
				, INCM_ADDR
				, INCM_ADTL
				, KYBDR
				, INPT_DT
				, INPT_ADDR
				, ISMT
				, REVN_DT
				, REVN_ADDR
				, REPR_NAME
				, RESU_NUMB
			FROM YE161005 
			WHERE DPOB_CD = #dpobCd#
				AND WHDG_TX_REGRST_DEPT_CD = #whdgTxRegrstDeptCd#
				AND REPLACE(BUSOPR_RGSTNUM, '-', '') = REPLACE(#busoprRgstnum#, '-', '')
			
	]]>
	</select>
	
	<!-- 선택한 데이터를 삭제한다. -->
	<delete id="ye17Ta161005_2018_DAO.deleteYe161005Data">
		DELETE FROM YE161005 
			WHERE DPOB_CD = #dpobCd#
				AND WHDG_TX_REGRST_DEPT_CD = #whdgTxRegrstDeptCd#
				AND REPLACE(BUSOPR_RGSTNUM, '-', '') = REPLACE(#busoprRgstnum#, '-', '')
	</delete>
	
	<!-- 선택한 데이터를 수정한다. -->
	<update id="ye17Ta161005_2018_DAO.updateYe161005Data" parameterClass="ye161005_2018_Vo">
	    UPDATE YE161005
	       SET WHDG_TX_REGRST_DEPT_CD = #whdgTxRegrstDeptCd#
				, HHRK_WHDG_REGRST_DEPT_CD = #hhrkWhdgRegrstDeptCd#
				, TX_OFFC_CD = #txOffcCd#
				, PENTR_SEPT_CD = #pentrSeptCd#
				, TX_DEPTY_MANGE_NUM = #txDeptyMangeNum#
				, HMTX_ID = #hmtxId#
				, TX_PGM_CD = #txPgmCd#
				, BUSOPR_RGSTNUM = REPLACE(#busoprRgstnum#, '-', '')
				, CORP_FMNM_NM = #corpFmnmNm#
				, PERN_CHRG_DEPT_NM = #pernChrgDeptNm#
				, PERN_CHRG_NM = #pernChrgNm#
				, PERN_CHRG_PHN_NUM = #pernChrgPhnNum#
				, USE_HAN_CD = #useHanCd#
				, SUMT_TGT_PRID_CD = #sumtTgtPridCd#
				, CORP_NUM = REPLACE(#corpNum#, '-', '')
				, INCM_POST = #incmPost#
				, INCM_ADDR = #incmAddr#
				, INCM_ADTL = #incmAdtl#
				, ISMT = #ismt#
				, REVN_DT = TO_CHAR(SYSDATE, 'YYYYMMDD')
				, REVN_ADDR = #revnAddr#
				, REPR_NAME = #reprName#
				, RESU_NUMB = REPLACE(#resuNumb#, '-', '')
		WHERE DPOB_CD = #dpobCd#
			AND WHDG_TX_REGRST_DEPT_CD = #whdgTxRegrstDeptCd#
			AND REPLACE(BUSOPR_RGSTNUM, '-', '') = REPLACE(#busoprRgstnum#, '-', '')								
	</update>
	
	
	
	<!-- 데이터를 신규등록한다. -->
	<insert id="ye17Ta161005_2018_DAO.insertYe161005Data"  parameterClass="ye161005_2018_Vo">
		INSERT INTO YE161005 
				( DPOB_CD
					, WHDG_TX_REGRST_DEPT_CD
					, HHRK_WHDG_REGRST_DEPT_CD
					, TX_OFFC_CD
					, PENTR_SEPT_CD
					, TX_DEPTY_MANGE_NUM
					, HMTX_ID
					, TX_PGM_CD
					, BUSOPR_RGSTNUM
					, CORP_FMNM_NM
					, PERN_CHRG_DEPT_NM
					, PERN_CHRG_NM
					, PERN_CHRG_PHN_NUM
					, USE_HAN_CD
					, SUMT_TGT_PRID_CD
					, CORP_NUM
					, INCM_POST
					, INCM_ADDR
					, INCM_ADTL
					, KYBDR
					, INPT_DT
					, INPT_ADDR
					, ISMT
					, REVN_DT
					, REVN_ADDR
					, REPR_NAME
					, RESU_NUMB)
			VALUES (  #dpobCd#    
						 , #whdgTxRegrstDeptCd#                 
						 , #hhrkWhdgRegrstDeptCd#               
						 , #txOffcCd#                           
						 , #pentrSeptCd#                        
						 , #txDeptyMangeNum#                    
						 , #hmtxId#                             
						 , #txPgmCd#                            
						 , REPLACE(#busoprRgstnum#, '-', '')    
						 , #corpFmnmNm#                         
						 , #pernChrgDeptNm#                     
						 , #pernChrgNm#                         
						 , #pernChrgPhnNum#                     
						 , #useHanCd#                           
						 , #sumtTgtPridCd#                      
						 , REPLACE(#corpNum#, '-', '')                             
						 , #incmPost#                           
						 , #incmAddr#                           
						 , #incmAdtl#                           
						 , #kybdr#                              
						 , TO_CHAR(SYSDATE, 'YYYYMMDD')                
						 , #inptAddr#                           
						 , #ismt#                               
						 , TO_CHAR(SYSDATE, 'YYYYMMDD')         
						 , #revnAddr#                           
						 , #reprName#                           
						 , REPLACE(#resuNumb#, '-', '')   
					)
	</insert>
	
	

</sqlMap>
