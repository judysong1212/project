<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="Ye161010_2018">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="ye161010Srh_2018_Vo" type="com.app.exterms.yearendtax.server.vo.Ye161010Srh_2018_VO"/>
	<typeAlias  alias="ye161010_2018_Vo" type="com.app.exterms.yearendtax.server.vo.Ye161010_2018_VO"/>
	<typeAlias  alias="infcPsnl0100Srh_2018_Vo" type="com.app.exterms.yearendtax.server.vo.InfcPsnl0100Srh_2018_VO"/>
	
	<resultMap id="ye161010_2018" class="com.app.exterms.yearendtax.server.vo.Ye161010_2018_VO">
		<result property="dpobCd" column="DPOB_CD" columnIndex="1"/>
		<result property="yrtxBlggYr" column="YRTX_BLGG_YR" columnIndex="2"/>
		<result property="clutSeptCd" column="CLUT_SEPT_CD" columnIndex="3"/>
		<result property="systemkey" column="SYSTEMKEY" columnIndex="4"/>
		<result property="payrMangDeptCd" column="PAYR_MANG_DEPT_CD" columnIndex="5"/>
		<result property="emymtDivCd" column="EMYMT_DIV_CD" columnIndex="6"/>
		<result property="deptCd" column="DEPT_CD" columnIndex="7"/>
		<result property="typOccuCd" column="TYP_OCCU_CD" columnIndex="8"/>
		<result property="dtilOccuInttnCd" column="DTIL_OCCU_INTTN_CD" columnIndex="9"/>
		<result property="businCd" column="BUSIN_CD" columnIndex="10"/>
		<result property="pernChrgEmpIdenNum" column="PERN_CHRG_EMP_IDEN_NUM" columnIndex="11"/>
		<result property="closFlag" column="CLOS_FLAG" columnIndex="12"/>
		<result property="closCont" column="CLOS_CONT" columnIndex="13"/>
		<result property="closDate" column="CLOS_DATE" columnIndex="14"/>
		<result property="edacPrdt" column="EDAC_PRDT" columnIndex="15"/>
		<result property="kybdr" column="KYBDR" columnIndex="16"/>
		<result property="inptDt" column="INPT_DT" columnIndex="17"/>
		<result property="inptAddr" column="INPT_ADDR" columnIndex="18"/>
		<result property="ismt" column="ISMT" columnIndex="19"/>
		<result property="revnDt" column="REVN_DT" columnIndex="20"/>
		<result property="revnAddr" column="REVN_ADDR" columnIndex="21"/>
	</resultMap>
	
	<!-- 
	#############################################################################
	######################## 2018년도 연말정산 로직 시작 ############################
	#############################################################################
	 -->
	 
	 <update id="ye161010_2018_DAO.updateYetaP310002ToYe161010_S">
		<![CDATA[
			UPDATE YE161010
			SET UT_DPOB_CD=#utDpobCd#
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
			WHERE DPOB_CD=#dpobCd#
				AND YRTX_BLGG_YR=#yrtxBlggYr#
				AND CLUT_SEPT_CD=#clutSeptCd#
				AND SYSTEMKEY=#systemkey#
		]]>
	</update>
	 
	 
	 
	 <select id="ye161010_2018_DAO.selectYetaP310002ToYe161010ListTotCnt_S" parameterClass="ye161010Srh_2018_Vo" resultClass="int">
		SELECT COUNT(*) totcnt
			FROM ( SELECT AA.DPOB_CD
					        , AA.SYSTEMKEY
					FROM YE161010 AA, YE161020 BB            						 
					    WHERE AA.DPOB_CD 		= #dpobCd# 
					    	AND AA.YRTX_BLGG_YR	= #yrtxBlggYr#
							AND AA.CLUT_SEPT_CD	= #clutSeptCd#
					    	AND AA.SYSTEMKEY 	= BB.SYSTEMKEY
				     		AND EXISTS  (
		                         SELECT  C.DPOB_CD,
		                                 C.DTIL_OCCU_INTTN_CD,
		                                 C.TYP_OCCU_CD,
		                                 C.DEPT_CD FROM 
		                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' )) ) C
		                                            WHERE     C.DPOB_CD = AA.DPOB_CD
								                        AND C.DEPT_CD = AA.DEPT_CD
								                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(AA.TYP_OCCU_CD,'TT') 
		                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(AA.DTIL_OCCU_INTTN_CD,'TT')
		                                               <isNotEmpty property="deptCd" prepend="AND">
														<![CDATA[
														 C.DEPT_CD
														]]>
														<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
														 #deptCdArr[]#
														</iterate>
														</isNotEmpty> 
		                                          )
		                    <isNotEmpty prepend="AND" property="businCd" >
							 	AA.BUSIN_CD=#businCd#
						    </isNotEmpty> 
							<isNotEmpty prepend="AND" property="payrMangDeptCd" >
							 	AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
						    </isNotEmpty> 
						    <isNotEmpty prepend="AND" property="emymtDivCd" >
							 	AA.EMYMT_DIV_CD=#emymtDivCd#
							</isNotEmpty>
						    <isNotEmpty property="typOccuCd" prepend="AND">
								<![CDATA[
									 AA.TYP_OCCU_CD
								]]>
								<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
								 	 #typOccuCdArr[]#
								</iterate>
							</isNotEmpty>  
							<isNotEmpty property="dtilOccuInttnCd" prepend="AND">
								<![CDATA[
									 AA.DTIL_OCCU_INTTN_CD
								]]>
								<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
									 #dtilOccuInttnCdArr[]#
								</iterate>
							</isNotEmpty>  
						    <isNotEmpty prepend="AND" property="systemkey" >
							 	AA.SYSTEMKEY=#systemkey#
						    </isNotEmpty>  
						    <isNotEmpty prepend="AND" property="hanNm" >
							 	BB.FNM LIKE '%' || #hanNm# || '%'
						    </isNotEmpty> 	
						    
							<isEqual   property="utDpobChk" compareValue="1">
							  	<![CDATA[					
								 AND   AA.UT_DPOB_CD  IS NULL
								]]>
							</isEqual>	
					 		
							<isEqual   property="utDpobChk" compareValue="0">
								 <isNotEmpty prepend="AND" property="utDpobCd" >
									AA.UT_DPOB_CD  = #utDpobCd# 
								</isNotEmpty> 
							</isEqual>	    
					 		
				)
	</select>	
	 
	 
	 
	<select id="ye161010_2018_DAO.selectYetaP310002ToYe161010List_D" parameterClass="ye161010Srh_2018_Vo" resultClass="egovMap">
		SELECT * FROM (
			SELECT A.*, ROWNUM RNUM FROM 
			<![CDATA[		
				( SELECT AA.DPOB_CD										/*   사업장코드				*/	
							, AA.YRTX_BLGG_YR							/*   귀속연도				*/
							, AA.CLUT_SEPT_CD							/*   연말정산구분코드		*/
							, fcBass0300CDNM (AA.DPOB_CD, AA.CLUT_SEPT_CD) AS CLUT_SEPT_NM	
							, AA.SYSTEMKEY								/*   SYSTEMKEY			*/
							, AA.PAYR_MANG_DEPT_CD						/*   단위기관코드			*/
							, AA.UT_DPOB_CD								/*   단위사업장코드			*/
							, NVL(( SELECT UT_DPOB_NM FROM BASS0120 WHERE UT_DPOB_CD = AA.UT_DPOB_CD ), '') AS UT_DPOB_NM
							, AA.EMYMT_DIV_CD							/*   당시_고용구분코드		*/
							, fcBass0300CDNM (AA.DPOB_CD, AA.EMYMT_DIV_CD) AS EMYMT_DIV_NM		
							, AA.DEPT_CD								/*   당시_부서코드			*/
							, fcBass0400CDNM (AA.DPOB_CD, AA.DEPT_CD, '2') AS DEPT_NM	
							, AA.TYP_OCCU_CD							/*   당시_직종코드			*/
							, AA.DTIL_OCCU_INTTN_CD						/*   당시_직종세통합코드		*/
							, AA.BUSIN_CD								/*   당시_사업코드			*/
							, AA.PERN_CHRG_EMP_IDEN_NUM					/*   생성직원번호			*/
							, AA.CLOS_FLAG								/*   마감여부				*/
							, AA.CLOS_CONT								/*   마감건수				*/
							, AA.CLOS_DATE								/*   마감일자				*/
							, AA.EDAC_PRDT								/*   연말정산제출일자		*/
							, AA.KYBDR									/*   입력자				*/
							, AA.INPT_DT								/*   입력일자				*/
							, AA.INPT_ADDR								/*   입력주소				*/
							, AA.ISMT									/*   수정자				*/
							, AA.REVN_DT								/*   수정일자				*/
							, AA.REVN_ADDR								/*   수정주소				*/
							, AA.ODTY_CD								/*   직책코드				*/
							, AA.PYSP_CD								/*   호봉코드				*/
							, AA.LOG_SVC_YR_NUM_CD						/*   근속년수코드			*/
							, AA.LOG_SVC_MNTH_ICM_CD					/*   근속월수코드			*/
							, AA.FRST_EMYMT_DT							/*   최초고용일자			*/
							, AA.EMYMT_BGNN_DT							/*   고용시작일자			*/
							, AA.EMYMT_END_DT							/*   고용종료일자			*/
							, AA.HDOFC_DIV_CD							/*   재직구분코드			*/
							, AA.RETRY_DT								/*   퇴직일자				*/
							, AA.YRTX_APPTN_YR_MNTH						/*   연말정산적용년월		*/
							, AA.YRTX_PRCS_DT							/*   연말정산처리일자		*/
							, AA.YRTX_PRCS_YN							/*   연말정산처리여부		*/
							, AA.DIVD_PYMT		
							, AA.DIVD_PYMT_AMNT				
							, AA.DIVD_PYMT_DIV_CD		
							
							, BB.FNM									/*   소득자성명					*/
							, BB.RESNO_ENC_CNTN							/*   주민등록번호				*/
							, BB.NNF_CL_CD								/*   내외국인구분				*/
							, BB.TNM									/*   근무처명					*/
							, BB.BSNO_ENC_CNTN							/*   사업자등록번호				*/
							, BB.HSHR_CL_CD								/*   세대주여부					*/
							, BB.RSPL_NTN_INFR_NM						/*   국적						*/
							, BB.RSPL_NTN_INFR_CD						/*   국적코드					*/
							, BB.DTY_STRT_DT							/*   근무기간시작일자			*/
							, BB.DTY_END_DT								/*   근무기간종료일자			*/
							, BB.RE_STRT_DT								/*   감면기간시작일자			*/
							, BB.RE_END_DT								/*   감면기간종료일자			*/
							, BB.RSDT_CL_CD								/*   거주구분					*/
							, BB.RSPL_NTN_NM							/*   거주지국명					*/
							, BB.RSPL_NTN_CD							/*   거주지코드					*/
							, BB.INCTX_WHTX_TXAMT_METN_CD				/*   소득세원천징수세액조정구분코드	*/
							, BB.INPM_YN								/*   분납신청여부				*/
							, BB.PRIF_CHNG_YN							/*   인적공제항목변동여부			*/
							, BB.C152_STD_TX_DDC_YN						/*   표준세액공제적용여부			*/
							, BB.CHILD									/*   자녀인원수					*/
							, BB.BSC_DDCN_FP_CNT						/*   기본공제인원수				*/
							, BB.SCC_NFP_CNT							/*   경로우대인원수				*/
							, BB.CHBT_ADOP_NFP_CNT						/*   출산입양인원수				*/
							, BB.WMN_NFP_CNT							/*   부녀자인원수				*/
							, BB.SNPRNT_NFP_CNT							/*   한부모인원수				*/
							, BB.DSBR_NFP_CNT							/*   장애인인원수				*/
							, BB.AGE6LT_NFP_CNT							/*   6세이하인원수				*/
							, BB.FILE_SBT_YN							/*   소득공제신고전자파일제출여부	*/
							, BB.FILE_APP_YN							/*   소득공제신고전자파일적용여부	*/
							, BB.FORM_CD								/*   서식코드					*/
							, BB.ISS_DT_SEIL_NUM						/*   발급일자일련번호			*/
							, BB.BASE_WIYN								/*   기본공제배우자유무			*/
							, BB.TAX_ASSO_YN							/*   납세조합여부				*/

						     
						  FROM YE161010 AA, YE161020 BB            						 
					    WHERE AA.DPOB_CD 		= #dpobCd# 
					    	AND AA.YRTX_BLGG_YR	= #yrtxBlggYr#
							AND AA.CLUT_SEPT_CD	= #clutSeptCd#
					    	AND AA.SYSTEMKEY 	= BB.SYSTEMKEY
					    	
			]]>		    	
					    	
						    AND EXISTS  (
		                         SELECT  C.DPOB_CD,
		                                 C.DTIL_OCCU_INTTN_CD,
		                                 C.TYP_OCCU_CD,
		                                 C.DEPT_CD FROM 
		                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' )) ) C
		                                            WHERE     C.DPOB_CD = AA.DPOB_CD
								                        AND C.DEPT_CD = AA.DEPT_CD
								                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(AA.TYP_OCCU_CD,'TT') 
		                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(AA.DTIL_OCCU_INTTN_CD,'TT')
		                                               <isNotEmpty property="deptCd" prepend="AND">
														<![CDATA[
														 C.DEPT_CD
														]]>
														<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
														 #deptCdArr[]#
														</iterate>
														</isNotEmpty> 
		                                          )
		                    
		                    <isNotEmpty prepend="AND" property="businCd" >
							 	AA.BUSIN_CD=#businCd#
						    </isNotEmpty> 
						    
							<isNotEmpty prepend="AND" property="payrMangDeptCd" >
							 	AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
						    </isNotEmpty> 
						    
						    <isNotEmpty prepend="AND" property="emymtDivCd" >
							 	AA.EMYMT_DIV_CD=#emymtDivCd#
							</isNotEmpty>
							
						    <isNotEmpty property="typOccuCd" prepend="AND">
								<![CDATA[
									 AA.TYP_OCCU_CD
								]]>
								<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
								 	 #typOccuCdArr[]#
								</iterate>
							</isNotEmpty>  
							
							<isNotEmpty property="dtilOccuInttnCd" prepend="AND">
								<![CDATA[
									 AA.DTIL_OCCU_INTTN_CD
								]]>
								<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
									 #dtilOccuInttnCdArr[]#
								</iterate>
							</isNotEmpty> 
							 
						    <isNotEmpty prepend="AND" property="systemkey" >
							 	AA.SYSTEMKEY=#systemkey#
						    </isNotEmpty>  
						    
						    <isNotEmpty prepend="AND" property="hanNm" >
							 	BB.FNM LIKE '%' || #hanNm# || '%'
						    </isNotEmpty> 	
						    				
							<isEqual   property="utDpobChk" compareValue="1">
							  	<![CDATA[					
								 AND   AA.UT_DPOB_CD  IS NULL
								]]>
							</isEqual>	    
					 		
							<isEqual   property="utDpobChk" compareValue="0">
								 <isNotEmpty prepend="AND" property="utDpobCd" >
									AA.UT_DPOB_CD  = #utDpobCd# 
								</isNotEmpty> 
							</isEqual>	
							
						ORDER BY 
						    AA.DPOB_CD DESC
						    , ( SELECT LPAD(DEPT_RANK,5,'0')  
						            FROM BASS0400 DD
						        WHERE DD.DEPT_CD = AA.DEPT_CD
						            AND DD.DPOB_CD = AA.DPOB_CD) ASC
						    , BB.RESNO_ENC_CNTN ASC
						    , AA.SYSTEMKEY DESC			
				<![CDATA[					
			) A WHERE ROWNUM <= #lastIndex#
		)WHERE RNUM >= #firstIndex#
		]]>
	</select>	 
	 
	 
	 
	 
	 
	 
	<select id="ye161010_2018_DAO.selectYeta3300ToYe161010List_D" parameterClass="ye161010Srh_2018_Vo" resultClass="egovMap">
		SELECT * FROM (
			SELECT A.*, ROWNUM RNUM 
			  FROM ( SELECT AA.DPOB_CD					
							 , AA.YRTX_BLGG_YR			
							 , AA.CLUT_SEPT_CD			
							 , AA.SYSTEMKEY				
							 , AA.PAYR_MANG_DEPT_CD		
							 , AA.EMYMT_DIV_CD	
							 , fcBass0300CDNM (AA.DPOB_CD, AA.EMYMT_DIV_CD) AS EMYMT_DIV_NM		
							 , AA.DEPT_CD	
							 , fcBass0400CDNM (AA.DPOB_CD, AA.DEPT_CD, '2') AS DEPT_NM				
							 , AA.TYP_OCCU_CD	
							 , fcBass0320CDNM(AA.DPOB_CD, AA.TYP_OCCU_CD)AS TYP_OCCU_NM 			
							 , AA.DTIL_OCCU_INTTN_CD	
							 , fcBassEx0350CDNM(AA.DPOB_CD, AA.TYP_OCCU_CD, AA.DTIL_OCCU_INTTN_CD, '1')AS DTIL_OCCU_INTTN_NM		
							 , AA.BUSIN_CD	
							 , ( SELECT B.BUSIN_NM 
				                  FROM BASS0500 B
					            WHERE B.DPOB_CD 	= AA.DPOB_CD 
							 		AND B.DEPT_CD 	= AA.DEPT_CD 
					        		AND B.BUSIN_CD 	= AA.BUSIN_CD
					            )AS BUSIN_NM	
					         , ( CASE WHEN AA.EMYMT_DIV_CD = 'A0020010'
 								      	THEN fcBassEx0350CDNM(AA.DPOB_CD, AA.TYP_OCCU_CD, AA.DTIL_OCCU_INTTN_CD, '1')
 									ELSE ( SELECT B.BUSIN_NM 
						                  FROM BASS0500 B
							            WHERE B.DPOB_CD 	= AA.DPOB_CD 
									 		AND B.DEPT_CD 	= AA.DEPT_CD 
							        		AND B.BUSIN_CD 	= AA.BUSIN_CD
										)
 								  END
 								 )AS TYP_NM			
							 , AA.PERN_CHRG_EMP_IDEN_NUM	
							 , AA.CLOS_FLAG				
							 , AA.CLOS_CONT				
							 , AA.CLOS_DATE				
							 , AA.EDAC_PRDT				
							 , AA.KYBDR					
							 , AA.INPT_DT					
							 , AA.INPT_ADDR				
							 , AA.ISMT					
							 , AA.REVN_DT					
							 , AA.REVN_ADDR				
							 , AA.UT_DPOB_CD
						     
						     , BB.HAN_NM
						     , BB.RESN_REGN_NUM
						     
						  FROM YE161010 AA, PSNL0100 BB	            						 
					    WHERE AA.DPOB_CD 		= #dpobCd# 
					    	AND AA.YRTX_BLGG_YR	= #yrtxBlggYr#
							AND AA.CLUT_SEPT_CD	= #clutSeptCd#
					    	AND AA.SYSTEMKEY 	= BB.SYSTEMKEY
						    AND EXISTS  (
		                         SELECT  C.DPOB_CD,
		                                 C.DTIL_OCCU_INTTN_CD,
		                                 C.TYP_OCCU_CD,
		                                 C.DEPT_CD FROM 
		                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' )) ) C
		                                            WHERE     C.DPOB_CD = AA.DPOB_CD
								                        AND C.DEPT_CD = AA.DEPT_CD
								                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(AA.TYP_OCCU_CD,'TT') 
		                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(AA.DTIL_OCCU_INTTN_CD,'TT')
		                                               <isNotEmpty property="deptCd" prepend="AND">
														<![CDATA[
														 C.DEPT_CD
														]]>
														<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
														 #deptCdArr[]#
														</iterate>
														</isNotEmpty> 
		                                          )
		                    <isNotEmpty prepend="AND" property="businCd" >
							 	AA.BUSIN_CD=#businCd#
						    </isNotEmpty> 
							<isNotEmpty prepend="AND" property="payrMangDeptCd" >
							 	AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
						    </isNotEmpty> 
						    <isNotEmpty prepend="AND" property="emymtDivCd" >
							 	AA.EMYMT_DIV_CD=#emymtDivCd#
							</isNotEmpty>
						    <isNotEmpty property="typOccuCd" prepend="AND">
								<![CDATA[
									 AA.TYP_OCCU_CD
								]]>
								<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
								 	 #typOccuCdArr[]#
								</iterate>
							</isNotEmpty>  
							<isNotEmpty property="dtilOccuInttnCd" prepend="AND">
								<![CDATA[
									 AA.DTIL_OCCU_INTTN_CD
								]]>
								<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
									 #dtilOccuInttnCdArr[]#
								</iterate>
							</isNotEmpty>  
						    <isNotEmpty prepend="AND" property="systemkey" >
							 	AA.SYSTEMKEY=#systemkey#
						    </isNotEmpty>  
						    <isNotEmpty prepend="AND" property="hanNm" >
							 	BB.HAN_NM LIKE '%' || #hanNm# || '%'
						    </isNotEmpty> 					
						    <isNotEmpty prepend="AND" property="utDpobCd" >
								 	AA.UT_DPOB_CD  = #utDpobCd# 
							    </isNotEmpty> 
						ORDER BY 
						    AA.DPOB_CD DESC
						    , ( SELECT LPAD(DEPT_RANK,5,'0')  
						            FROM BASS0400 DD
						        WHERE DD.DEPT_CD = AA.DEPT_CD
						            AND DD.DPOB_CD = AA.DPOB_CD) ASC
						    , BB.RESN_REGN_NUM ASC
						    , AA.SYSTEMKEY DESC			
				<![CDATA[					
			) A WHERE ROWNUM <= #lastIndex#
		)WHERE RNUM >= #firstIndex#
		]]>
	</select>
	
	
	<select id="ye161010_2018_DAO.selectYeta3060ToYe161010ListTotCnt_S" parameterClass="ye161010Srh_2018_Vo" resultClass="int">
		SELECT COUNT(*) totcnt
			FROM ( SELECT DPOB_CD
					        , SYSTEMKEY
					FROM YE161010 	            						 
					    WHERE DPOB_CD 		= #dpobCd# 
					    	AND YRTX_BLGG_YR	= #yrtxBlggYr#
							AND CLUT_SEPT_CD	= #clutSeptCd#
							AND	UT_DPOB_CD  	= #utDpobCd# 
					)
	</select>
	
	
	
	<select id="ye161010_2018_DAO.selectYeta3300ToYe161010ListTotCnt_S" parameterClass="ye161010Srh_2018_Vo" resultClass="int">
		SELECT COUNT(*) totcnt
			FROM ( SELECT AA.DPOB_CD
					        , AA.SYSTEMKEY
					FROM YE161010 AA, PSNL0100 BB	            						 
					    WHERE AA.DPOB_CD 		= #dpobCd# 
					    	AND AA.YRTX_BLGG_YR	= #yrtxBlggYr#
							AND AA.CLUT_SEPT_CD	= #clutSeptCd#
					    	AND AA.SYSTEMKEY 	= BB.SYSTEMKEY        
					    	 
				     		AND EXISTS  (
		                         SELECT  C.DPOB_CD,
		                                 C.DTIL_OCCU_INTTN_CD,
		                                 C.TYP_OCCU_CD,
		                                 C.DEPT_CD FROM 
		                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' )) ) C
		                                            WHERE     C.DPOB_CD = AA.DPOB_CD
								                        AND C.DEPT_CD = AA.DEPT_CD
								                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(AA.TYP_OCCU_CD,'TT') 
		                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(AA.DTIL_OCCU_INTTN_CD,'TT')
		                                               <isNotEmpty property="deptCd" prepend="AND">
														<![CDATA[
														 C.DEPT_CD
														]]>
														<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
														 #deptCdArr[]#
														</iterate>
														</isNotEmpty> 
		                                          )
		                    <isNotEmpty prepend="AND" property="businCd" >
							 	AA.BUSIN_CD=#businCd#
						    </isNotEmpty> 
							<isNotEmpty prepend="AND" property="payrMangDeptCd" >
							 	AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
						    </isNotEmpty> 
						    <isNotEmpty prepend="AND" property="emymtDivCd" >
							 	AA.EMYMT_DIV_CD=#emymtDivCd#
							</isNotEmpty>
						    <isNotEmpty property="typOccuCd" prepend="AND">
								<![CDATA[
									 AA.TYP_OCCU_CD
								]]>
								<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
								 	 #typOccuCdArr[]#
								</iterate>
							</isNotEmpty>  
							<isNotEmpty property="dtilOccuInttnCd" prepend="AND">
								<![CDATA[
									 AA.DTIL_OCCU_INTTN_CD
								]]>
								<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
									 #dtilOccuInttnCdArr[]#
								</iterate>
							</isNotEmpty>  
						    <isNotEmpty prepend="AND" property="systemkey" >
							 	AA.SYSTEMKEY=#systemkey#
						    </isNotEmpty>  
						    <isNotEmpty prepend="AND" property="hanNm" >
							 	BB.HAN_NM LIKE '%' || #hanNm# || '%'
						    </isNotEmpty> 					
						    <isNotEmpty prepend="AND" property="utDpobCd" >
								 	AA.UT_DPOB_CD  = #utDpobCd# 
							    </isNotEmpty> 
					ORDER BY 
					    AA.DPOB_CD DESC
					    , ( SELECT LPAD(DEPT_RANK,5,'0')  
					            FROM BASS0400 DD
					        WHERE DD.DEPT_CD = BB.DEPT_CD
					            AND DD.DPOB_CD = BB.DPOB_CD) ASC
					    , BB.RESN_REGN_NUM ASC
					    , AA.SYSTEMKEY DESC
	)
	</select>		
		 
	<!-- 
	#############################################################################
	######################## 2018년도 연말정산 로직 종료 ############################
	#############################################################################
	 -->	 	
	
	
<!-- +++++++++++++++++++++++++ 2018년도 귀속 로직  시작 ++++++++++++++++++++++++++++++ -->

	<delete id="ye161010_2018_DAO.deleteYetaP310001_Ye161010VO_2018_Delete_S">
		<![CDATA[
	 	DECLARE BEGIN 
            
		  DELETE FROM YE160401  WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#; 
		  DELETE FROM YE160402  WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#; 
		  DELETE FROM YE160403 WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#;   
		  DELETE FROM YE160404 WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#; 
		  DELETE FROM YE160405  WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#; 
		  DELETE FROM YE160406 WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#; 
		  DELETE FROM YE160510  WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#; 
		  DELETE FROM YE161020 WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#;  
		  DELETE FROM YE161030  WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#; 
		
		  DELETE FROM YE161050  WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#; 
		  DELETE FROM YE161055 WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#; 
		  DELETE FROM YE161060 WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#; 
		
		  DELETE FROM YE161090 WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#;  
		  DELETE FROM YE162010 WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#;  
		  DELETE FROM YE162020 WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#; 
		  DELETE FROM YE162030 WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#; 
		  DELETE FROM YE162040 WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#;  
		  DELETE FROM YE162510 WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#;  
		  DELETE FROM YE162520 WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#; 
		  DELETE FROM YE162530  WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#; 
		  DELETE FROM YE164010 WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#; 
		  DELETE FROM YE165010  WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#; 
		  DELETE FROM YE165020  WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#; 
		  DELETE FROM YE165030 WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#; 
		  DELETE FROM YE165030_TEMP WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#;  
		 
		  DELETE FROM YE169010  WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#; 
		  DELETE FROM YE169010A  WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#; 
		  
          DELETE FROM YE161010 WHERE DPOB_CD=#dpobCd# AND YRTX_BLGG_YR=#yrtxBlggYr# AND CLUT_SEPT_CD=#clutSeptCd# AND SYSTEMKEY=#systemkey#;   

END; 
				]]>
	</delete>
	
	
<!-- +++++++++++++++++++++++++ 2018년도 귀속 로직  종료 ++++++++++++++++++++++++++++++ -->

	
	<insert id="ye161010_2018_DAO.insertYe161010_S">
		<![CDATA[
			INSERT INTO YE161010 
				( DPOB_CD
				  , YRTX_BLGG_YR
				  , CLUT_SEPT_CD
				  , SYSTEMKEY
				  , PAYR_MANG_DEPT_CD
				  , EMYMT_DIV_CD
				  , DEPT_CD
				  , TYP_OCCU_CD
				  , DTIL_OCCU_INTTN_CD
				  , BUSIN_CD
				  , PERN_CHRG_EMP_IDEN_NUM
				  , CLOS_FLAG
				  , CLOS_CONT
				  , CLOS_DATE
				  , EDAC_PRDT
				  , KYBDR
				  , INPT_DT
				  , INPT_ADDR
				  , ISMT
				  , REVN_DT
				  , REVN_ADDR )
			VALUES ( #dpobCd#
				  , #yrtxBlggYr#
				  , #clutSeptCd#
				  , #systemkey#
				  , #payrMangDeptCd#
				  , #emymtDivCd#
				  , #deptCd#
				  , #typOccuCd#
				  , #dtilOccuInttnCd#
				  , #businCd#
				  , #pernChrgEmpIdenNum#
				  , #closFlag#
				  , #closCont#
				  , #closDate#
				  , #edacPrdt#
				  , #kybdr#
				  , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				  , #inptAddr#
				  , #ismt#
				  , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				  , #revnAddr# )
		]]>
	</insert>
	
	<update id="ye161010_2018_DAO.updateYe161010_S">
		<![CDATA[
			UPDATE YE161010
			SET DPOB_CD=#dpobCd#
				, YRTX_BLGG_YR=#yrtxBlggYr#
				, CLUT_SEPT_CD=#clutSeptCd#
				, SYSTEMKEY=#systemkey#
				, PAYR_MANG_DEPT_CD=#payrMangDeptCd#
				, EMYMT_DIV_CD=#emymtDivCd#
				, DEPT_CD=#deptCd#
				, TYP_OCCU_CD=#typOccuCd#
				, DTIL_OCCU_INTTN_CD=#dtilOccuInttnCd#
				, BUSIN_CD=#businCd#
				, PERN_CHRG_EMP_IDEN_NUM=#pernChrgEmpIdenNum#
				, CLOS_FLAG=#closFlag#
				, CLOS_CONT=#closCont#
				, CLOS_DATE=#closDate#
				, EDAC_PRDT=#edacPrdt#
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
						WHERE DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
								AND SYSTEMKEY=#systemkey#
				]]>
	</update>
	
	<delete id="ye161010_2018_DAO.deleteYe161010_S">
		<![CDATA[
			DELETE FROM YE161010 
						WHERE DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
								AND SYSTEMKEY=#systemkey#
				]]>
	</delete>
	
	<select id="ye161010_2018_DAO.selectYe161010_S" resultMap="ye161010_2018">
		<![CDATA[
			SELECT
				DPOB_CD
				, YRTX_BLGG_YR
				, CLUT_SEPT_CD
				, SYSTEMKEY
				, PAYR_MANG_DEPT_CD
				, EMYMT_DIV_CD
				, DEPT_CD
				, TYP_OCCU_CD
				, DTIL_OCCU_INTTN_CD
				, BUSIN_CD
				, PERN_CHRG_EMP_IDEN_NUM
				, CLOS_FLAG
				, CLOS_CONT
				, CLOS_DATE
				, EDAC_PRDT
				, KYBDR
				, INPT_DT
				, INPT_ADDR
				, ISMT
				, REVN_DT
				, REVN_ADDR
			FROM YE161010
						WHERE DPOB_CD=#dpobCd#
								AND YRTX_BLGG_YR=#yrtxBlggYr#
								AND CLUT_SEPT_CD=#clutSeptCd#
								AND SYSTEMKEY=#systemkey#
				]]>
	</select>
	
	<select id="ye161010_2018_DAO.selectYe161010List_D" parameterClass="ye161010Srh_2018_Vo" resultClass="egovMap">
	SELECT * FROM (
		SELECT A.*, ROWNUM RNUM FROM (
				SELECT   AA.DPOB_CD
				        , AA.YRTX_BLGG_YR
				        , AA.CLUT_SEPT_CD
					    , EE.YOOBH_MNTH_DAY
				        , fcBass0300CDNM (AA.DPOB_CD, AA.CLUT_SEPT_CD) AS CLUT_SEPT_NM
				        , AA.SYSTEMKEY
				        , AA.PAYR_MANG_DEPT_CD
				        , AA.EMYMT_DIV_CD
				        , fcBass0300CDNM (AA.DPOB_CD, AA.EMYMT_DIV_CD) AS EMYMT_DIV_NM
				        , AA.DEPT_CD
				        , fcBass0400CDNM (AA.DPOB_CD, AA.DEPT_CD, '2') AS DEPT_NM
				        , AA.TYP_OCCU_CD
				        , fcBass0320CDNM(AA.DPOB_CD, AA.TYP_OCCU_CD)AS TYP_OCCU_NM 
				        , AA.DTIL_OCCU_INTTN_CD
						, fcBassEx0350CDNM(AA.DPOB_CD, AA.TYP_OCCU_CD, AA.DTIL_OCCU_INTTN_CD, '1')AS DTIL_OCCU_INTTN_NM				        
				        , AA.BUSIN_CD
				        , ( SELECT B.BUSIN_NM 
			                  FROM BASS0500 B
				            WHERE B.DPOB_CD = AA.DPOB_CD 
						         AND B.DEPT_CD = AA.DEPT_CD 
				                 AND B.BUSIN_CD = AA.BUSIN_CD
			                     AND B.BUSIN_APPTN_YR =SUBSTR(BB.DTY_STRT_DT,1,4)
				            )AS BUSIN_NM
				        , AA.PERN_CHRG_EMP_IDEN_NUM
				        , AA.CLOS_FLAG
				        , AA.CLOS_CONT
				        , AA.CLOS_DATE
				        , AA.EDAC_PRDT
				        , BB.FNM
				        , BB.RESNO_ENC_CNTN AS RESN_REGN_NUM
				        , BB.TNM
				        , BB.BSNO_ENC_CNTN
				        , BB.HSHR_CL_CD
				        , BB.RSPL_NTN_INFR_NM
				        , BB.RSPL_NTN_INFR_CD
				        , BB.DTY_STRT_DT
				        , BB.DTY_END_DT
				        , BB.RE_STRT_DT
				        , BB.RE_END_DT
				        , BB.RSDT_CL_CD
				        , BB.RSPL_NTN_NM
				        , BB.RSPL_NTN_CD
				        , BB.INCTX_WHTX_TXAMT_METN_CD
				        , BB.INPM_YN
				        , BB.PRIF_CHNG_YN
				        , BB.BSC_DDCN_FP_CNT
				        , BB.SCC_NFP_CNT
				        , BB.CHBT_ADOP_NFP_CNT
				        , BB.WMN_NFP_CNT
				        , BB.SNPRNT_NFP_CNT
				        , BB.DSBR_NFP_CNT
				        , BB.AGE6LT_NFP_CNT
				        , BB.FILE_SBT_YN
				        , DECODE(BB.FILE_SBT_YN, 'Y' , '전자파일' , '문서') AS FILE_SBT_NM
				        , BB.FILE_APP_YN
				        , FF.FILE_SBT_YN AS DDC_FILE_SBT_YN
				        , DECODE(FF.FILE_SBT_YN, 'Y' , '전자파일' , '문서') AS DDC_FILE_SBT_NM
				        , FF.FILE_APP_YN AS DDC_FILE_APP_YN
				        , BB.FORM_CD
				        , BB.ISS_DT_SEIL_NUM		
				        , NVL(CC.PAY_PYMT_SUM_TOT_AMNT , 0)AS PAY_PYMT_SUM_TOT_AMNT     	/* 급여 총계 */
				        , NVL(CC.BUAM_TXAM, 0)AS BUAM_TXAM                 					/* 상여 총계 */
				        , NVL(CC.NATN_PSNF, 0)AS NATN_PSNF                 					/* 국민연금 총계 */
				        , NVL(CC.CURR_WORK_RCP_AGGR_SUM, 0)AS CURR_WORK_RCP_AGGR_SUM     	/* 건강보험료 총계 */
				        , NVL(CC.SPCI_EMPF, 0)AS SPCI_EMPF                 					/* 고용보험료 총계 */
				        , NVL(CC.EARN_TAXN, 0)AS EARN_TAXN                 					/* 소득세 총계 */
				        , NVL(CC.IHTX_TAXN, 0)AS IHTX_TAXN                					/* 지방소득세 총계 */
				        , NVL(CC.NNKS_SSUM, 0)AS NNKS_SSUM                					/* 농특세 총계 */
				        , EE.HDOFC_CODTN_CD
						, fcBass0300CDNM (AA.DPOB_CD, EE.HDOFC_CODTN_CD) AS HDOFC_CODTN_NM
				FROM YE161010 AA, YE161020 BB, PSNL0100 EE, YE167010 FF,
				(
				    SELECT TA01.DPOB_CD
				           , TA01.YRTX_BLGG_YR
				           , TA01.CLUT_SEPT_CD
				           , TA01.SYSTEMKEY		
				           ,(SUM(NVL(TA01.PAY_PYMT_SUM_TOT_AMNT	, 0)) 	+ NVL(TA02.PRCSP_PAY_SUM			, 0) )	AS PAY_PYMT_SUM_TOT_AMNT    /* 급여 총계 */
				           ,(SUM(NVL(TA01.BUAM_TXAM				, 0))  	+ NVL(TA02.PRCSP_ALLW_BNUS_SUM		, 0) )	AS BUAM_TXAM                /* 상여 총계 */
				           , SUM(NVL(TA01.NATN_PSNF				, 0)  	+ NVL(TA03.NAT_PENN_PRMM_SUM		, 0) )  AS NATN_PSNF                /* 국민연금 총계 */
				           , SUM(NVL(TA01.CURR_WORK_RCP_AGGR_SUM, 0)    + NVL(TA02.PRCSP_HLTH_LGCPTN_AGGR	, 0) )	AS CURR_WORK_RCP_AGGR_SUM 	/* 건강보험료 총계 */
				           , SUM(NVL(TA01.SPCI_EMPF				, 0)  	+ NVL(TA02.PRCSP_EMYMT_PRMM_SUM		, 0) )	AS SPCI_EMPF                /* 고용보험료 총계 */
				           , SUM(NVL(TA01.EARN_TAXN				, 0) 	+ NVL(TA02.PRCSP_INCM_TX_SUM		, 0) )  AS EARN_TAXN                /* 소득세 총계 */
				           , SUM(NVL(TA01.IHTX_TAXN 			, 0) 	+ NVL(TA02.PRCSP_RGON_INCM_TX_SUM	, 0) )	AS IHTX_TAXN                /* 지방소득세 총계 */
				           , SUM(NVL(TA01.NNKS_SSUM 			, 0) 	+ NVL(TA02.PRCSP_NNKS_SUM			, 0) )  AS NNKS_SSUM    			/* 농특세 총계 */				           
				    FROM YE160401 TA01, YE160404 TA02, YE160406 TA03
				    WHERE TA01.DPOB_CD=#dpobCd#
				          AND TA01.YRTX_BLGG_YR = #yrtxBlggYr#
				     	 AND TA01.CLUT_SEPT_CD = #clutSeptCd#
				        AND TA01.DPOB_CD= TA02.DPOB_CD(+)
				        AND TA01.YRTX_BLGG_YR = TA02.YRTX_BLGG_YR (+)
				        AND TA01.CLUT_SEPT_CD = TA02.CLUT_SEPT_CD(+)
				        AND TA01.SYSTEMKEY = TA02.SYSTEMKEY(+)
				        AND TA01.DPOB_CD= TA03.DPOB_CD(+)
				        AND TA01.YRTX_BLGG_YR = TA03.YRTX_BLGG_YR(+)
				        AND TA01.CLUT_SEPT_CD = TA03.CLUT_SEPT_CD(+)
				        AND TA01.SYSTEMKEY = TA03.SYSTEMKEY(+)
				     GROUP BY TA01.DPOB_CD, TA01.YRTX_BLGG_YR , TA01.CLUT_SEPT_CD , TA01.SYSTEMKEY , TA02.PRCSP_PAY_SUM, TA02.PRCSP_ALLW_BNUS_SUM
				) CC
				WHERE AA.DPOB_CD = BB.DPOB_CD(+)
				    AND AA.YRTX_BLGG_YR = BB.YRTX_BLGG_YR(+)
				    AND AA.CLUT_SEPT_CD = BB.CLUT_SEPT_CD(+)
				    AND AA.SYSTEMKEY = BB.SYSTEMKEY(+)
				    AND AA.DPOB_CD = BB.DPOB_CD(+)
				    AND AA.YRTX_BLGG_YR = BB.YRTX_BLGG_YR(+)
				    AND AA.CLUT_SEPT_CD = BB.CLUT_SEPT_CD(+)
				    AND AA.SYSTEMKEY = BB.SYSTEMKEY(+)
					AND AA.DPOB_CD = CC.DPOB_CD(+)
               		AND AA.YRTX_BLGG_YR = CC.YRTX_BLGG_YR(+)
               		AND AA.CLUT_SEPT_CD = CC.CLUT_SEPT_CD(+)
               		AND AA.SYSTEMKEY = CC.SYSTEMKEY(+)
               			  AND AA.DPOB_CD = FF.DPOB_CD(+)
              AND AA.YRTX_BLGG_YR = FF.YRTX_BLGG_YR(+)
              AND AA.CLUT_SEPT_CD = FF.CLUT_SEPT_CD(+)
              AND AA.SYSTEMKEY = FF.SYSTEMKEY(+)
				    AND AA.DPOB_CD = EE.DPOB_CD(+)
				    AND AA.SYSTEMKEY = EE.SYSTEMKEY(+)
						<isNotEmpty prepend="AND" property="dpobCd" >
							AA.DPOB_CD=#dpobCd#
				    	</isNotEmpty> 
						<isNotEmpty prepend="AND" property="clutSeptCd" >
					 		AA.CLUT_SEPT_CD=#clutSeptCd#
						</isNotEmpty>	
				     AND EXISTS ( SELECT TA01.DPOB_CD , TA01.YRTX_BLGG_YR , TA01.CLUT_SEPT_CD , TA01.SYSTEMKEY
				     				  FROM YE161010 TA01, YE161020 TA02
				     				  WHERE TA01.DPOB_CD = TA02.DPOB_CD
				     				  	AND TA01.YRTX_BLGG_YR = TA02.YRTX_BLGG_YR
				     				  	AND TA01.CLUT_SEPT_CD = TA02.CLUT_SEPT_CD
				     				  	AND TA01.SYSTEMKEY = TA02.SYSTEMKEY
				     				  	AND TA01.DPOB_CD = #dpobCd#
				     				  	AND TA01.YRTX_BLGG_YR = #yrtxBlggYr#
				     				  	AND TA01.CLUT_SEPT_CD = #clutSeptCd#
				     				  	AND TA01.SYSTEMKEY = AA.SYSTEMKEY
				     		         )
				     AND EXISTS  (
                         SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' )) ) C
                                            WHERE     C.DPOB_CD = AA.DPOB_CD
						                        AND C.DEPT_CD = AA.DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(AA.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(AA.DTIL_OCCU_INTTN_CD,'TT')
                                               <isNotEmpty property="deptCd" prepend="AND">
												<![CDATA[
												 C.DEPT_CD
												]]>
												<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
												 #deptCdArr[]#
												</iterate>
												</isNotEmpty> 
                                          )
                    <isNotEmpty prepend="AND" property="businCd" >
					 	AA.BUSIN_CD=#businCd#
				    </isNotEmpty> 
					<isNotEmpty prepend="AND" property="payrMangDeptCd" >
					 	AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
				    </isNotEmpty> 
				    <isNotEmpty prepend="AND" property="emymtDivCd" >
					 	AA.EMYMT_DIV_CD=#emymtDivCd#
					</isNotEmpty>
				    <isNotEmpty property="typOccuCd" prepend="AND">
						<![CDATA[
							 AA.TYP_OCCU_CD
						]]>
						<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
						 	 #typOccuCdArr[]#
						</iterate>
					</isNotEmpty>  
					<isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 AA.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate>
					</isNotEmpty>  
				    <isNotEmpty prepend="AND" property="systemkey" >
					 	AA.SYSTEMKEY=#systemkey#
				    </isNotEmpty>  
				    <isNotEmpty prepend="AND" property="fnm" >
					 	BB.FNM LIKE '%' || #fnm# || '%'
				    </isNotEmpty> 					
				    <isNotEmpty prepend="AND" property="utDpobCd" >
						 	AA.UT_DPOB_CD  = #utDpobCd# 
					    </isNotEmpty> 
		             <isEmpty prepend="AND" property="utDpobCd" >	 
								<isEqual   property="utDpobChk" compareValue="1">
							  	<![CDATA[					
								   AA.UT_DPOB_CD  IS NULL
								]]>
								</isEqual>	    
					 </isEmpty> 			
					ORDER BY 
					    AA.DPOB_CD DESC
					    , ( SELECT LPAD(DEPT_RANK,5,'0')  
					            FROM BASS0400 DD
					        WHERE DD.DEPT_CD = AA.DEPT_CD
					            AND DD.DPOB_CD = AA.DPOB_CD) ASC
					    , BB.BSNO_ENC_CNTN ASC
					    , AA.SYSTEMKEY DESC			
			<![CDATA[					
		) A WHERE ROWNUM <= #lastIndex#
	)WHERE RNUM >= #firstIndex#
	]]>
	</select>	
	
	<!-- <isNotEqual  property="utDpobChk" compareValue="1">
							 	<![CDATA[					
								    AA.UT_DPOB_CD  IS NOT NULL
								]]>
								</isNotEqual>	 -->
								
	<select id="ye161010_2018_DAO.selectYe161010ListTotCnt_S" parameterClass="ye161010Srh_2018_Vo" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM  (
					SELECT   AA.DPOB_CD
					        , AA.SYSTEMKEY
					FROM YE161010 AA, YE161020 BB, PSNL0100 EE,YE167010 FF,
					(
					    SELECT TA01.DPOB_CD
					           , TA01.YRTX_BLGG_YR
					           , TA01.CLUT_SEPT_CD
					           , TA01.SYSTEMKEY
					           , SUM(NVL(TA01.PAY_PYMT_SUM_TOT_AMNT	, 0)	+ NVL(TA02.PRCSP_PAY_SUM			, 0) )	AS PAY_PYMT_SUM_TOT_AMNT    /* 급여 총계 */
					           , SUM(NVL(TA01.BUAM_TXAM				, 0)  	+ NVL(TA02.PRCSP_ALLW_BNUS_SUM		, 0) )	AS BUAM_TXAM                /* 상여 총계 */
					           , SUM(NVL(TA01.NATN_PSNF				, 0)  	+ NVL(TA03.NAT_PENN_PRMM_SUM		, 0) )  AS NATN_PSNF                /* 국민연금 총계 */
					           , SUM(NVL(TA01.CURR_WORK_RCP_AGGR_SUM, 0)    + NVL(TA02.PRCSP_HLTH_LGCPTN_AGGR	, 0) )	AS CURR_WORK_RCP_AGGR_SUM 	/* 건강보험료 총계 */
					           , SUM(NVL(TA01.SPCI_EMPF				, 0)  	+ NVL(TA02.PRCSP_EMYMT_PRMM_SUM		, 0) )	AS SPCI_EMPF                /* 고용보험료 총계 */
					           , SUM(NVL(TA01.EARN_TAXN				, 0) 	+ NVL(TA02.PRCSP_INCM_TX_SUM		, 0) )  AS EARN_TAXN                /* 소득세 총계 */
					           , SUM(NVL(TA01.IHTX_TAXN 			, 0) 	+ NVL(TA02.PRCSP_RGON_INCM_TX_SUM	, 0) )	AS IHTX_TAXN                /* 지방소득세 총계 */
					           , SUM(NVL(TA01.NNKS_SSUM 			, 0) 	+ NVL(TA02.PRCSP_NNKS_SUM			, 0) )  AS NNKS_SSUM    			/* 농특세 총계 */             
					    FROM YE160401 TA01, YE160404 TA02, YE160406 TA03
					    WHERE TA01.DPOB_CD= TA02.DPOB_CD(+)
					        AND TA01.YRTX_BLGG_YR = TA02.YRTX_BLGG_YR (+)
					        AND TA01.CLUT_SEPT_CD = TA02.CLUT_SEPT_CD(+)
					        AND TA01.SYSTEMKEY = TA02.SYSTEMKEY(+)
					        AND TA01.DPOB_CD= TA03.DPOB_CD(+)
					        AND TA01.YRTX_BLGG_YR = TA03.YRTX_BLGG_YR (+)
					        AND TA01.CLUT_SEPT_CD = TA03.CLUT_SEPT_CD(+)
					        AND TA01.SYSTEMKEY = TA03.SYSTEMKEY(+)
					    GROUP BY TA01.DPOB_CD, TA01.YRTX_BLGG_YR , TA01.CLUT_SEPT_CD , TA01.SYSTEMKEY 
					) CC
					WHERE AA.DPOB_CD = BB.DPOB_CD(+)
					    AND AA.YRTX_BLGG_YR = BB.YRTX_BLGG_YR(+)
					    AND AA.CLUT_SEPT_CD = BB.CLUT_SEPT_CD(+)
					    AND AA.SYSTEMKEY = BB.SYSTEMKEY(+)
					    AND AA.DPOB_CD = BB.DPOB_CD(+)
					    AND AA.YRTX_BLGG_YR = BB.YRTX_BLGG_YR(+)
					    AND AA.CLUT_SEPT_CD = BB.CLUT_SEPT_CD(+)
					    AND AA.SYSTEMKEY = BB.SYSTEMKEY(+)
						AND AA.DPOB_CD = CC.DPOB_CD(+)
               			AND AA.YRTX_BLGG_YR = CC.YRTX_BLGG_YR(+)
               			AND AA.CLUT_SEPT_CD = CC.CLUT_SEPT_CD(+)
               			AND AA.SYSTEMKEY = CC.SYSTEMKEY(+)
               				  AND AA.DPOB_CD = FF.DPOB_CD(+)
              AND AA.YRTX_BLGG_YR = FF.YRTX_BLGG_YR(+)
              AND AA.CLUT_SEPT_CD = FF.CLUT_SEPT_CD(+)
              AND AA.SYSTEMKEY = FF.SYSTEMKEY(+)
					    AND AA.DPOB_CD = EE.DPOB_CD(+)
					    AND AA.SYSTEMKEY = EE.SYSTEMKEY(+)
							<isNotEmpty prepend="AND" property="dpobCd" >
								AA.DPOB_CD=#dpobCd#
					    	</isNotEmpty> 
							<isNotEmpty prepend="AND" property="clutSeptCd" >
						 		AA.CLUT_SEPT_CD=#clutSeptCd#
							</isNotEmpty>	
<!-- junhee
 AND AA.YRTX_BLGG_YR=#yrtxBlggYr#
junhee -->
					     AND EXISTS ( SELECT TA01.DPOB_CD , TA01.YRTX_BLGG_YR , TA01.CLUT_SEPT_CD , TA01.SYSTEMKEY
					     				  FROM YE161010 TA01, YE161020 TA02
					     				  WHERE TA01.DPOB_CD = TA02.DPOB_CD
					     				  	AND TA01.YRTX_BLGG_YR = TA02.YRTX_BLGG_YR
					     				  	AND TA01.CLUT_SEPT_CD = TA02.CLUT_SEPT_CD
					     				  	AND TA01.SYSTEMKEY = TA02.SYSTEMKEY
					     				  	AND TA01.DPOB_CD = #dpobCd#
					     				  	AND TA01.YRTX_BLGG_YR = #yrtxBlggYr#
					     				  	AND TA01.CLUT_SEPT_CD = #clutSeptCd#
					     				  	AND TA01.SYSTEMKEY = AA.SYSTEMKEY
					     		         )
					     AND EXISTS  (
	                         SELECT  C.DPOB_CD,
	                                 C.DTIL_OCCU_INTTN_CD,
	                                 C.TYP_OCCU_CD,
	                                 C.DEPT_CD FROM 
	                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,'' )) ) C
	                                            WHERE     C.DPOB_CD = AA.DPOB_CD
							                        AND C.DEPT_CD = AA.DEPT_CD
							                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(AA.TYP_OCCU_CD,'TT') 
	                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(AA.DTIL_OCCU_INTTN_CD,'TT')
	                                               <isNotEmpty property="deptCd" prepend="AND">
													<![CDATA[
													 C.DEPT_CD
													]]>
													<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
													 #deptCdArr[]#
													</iterate>
													</isNotEmpty> 
	                                          )
	                    <isNotEmpty prepend="AND" property="businCd" >
						 	AA.BUSIN_CD=#businCd#
					    </isNotEmpty> 
						<isNotEmpty prepend="AND" property="payrMangDeptCd" >
						 	AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
					    </isNotEmpty> 
					    <isNotEmpty prepend="AND" property="emymtDivCd" >
						 	AA.EMYMT_DIV_CD=#emymtDivCd#
						</isNotEmpty>
					    <isNotEmpty property="typOccuCd" prepend="AND">
							<![CDATA[
								 AA.TYP_OCCU_CD
							]]>
							<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
							 	 #typOccuCdArr[]#
							</iterate>
						</isNotEmpty>  
						<isNotEmpty property="dtilOccuInttnCd" prepend="AND">
							<![CDATA[
								 AA.DTIL_OCCU_INTTN_CD
							]]>
							<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
								 #dtilOccuInttnCdArr[]#
							</iterate>
						</isNotEmpty>  
					    <isNotEmpty prepend="AND" property="systemkey" >
						 	AA.SYSTEMKEY=#systemkey#
					    </isNotEmpty>  
					    <isNotEmpty prepend="AND" property="fnm" >
						 	BB.FNM LIKE '%' || #fnm# || '%'
					    </isNotEmpty> 
					    <isNotEmpty prepend="AND" property="utDpobCd" >
						 	AA.UT_DPOB_CD  = #utDpobCd# 
					    </isNotEmpty> 
					)				    
	</select>
	
	<select id="ye161010_2018_DAO.selectYetaP31001ToPsnl0100List_D" parameterClass="infcPsnl0100Srh_2018_Vo" resultClass="egovMap">
		SELECT * FROM (
			SELECT T.*, ROWNUM RNUM FROM (
					SELECT AA.DPOB_CD
					        , AA.SYSTEMKEY
					        , BB.EMYMT_DIV_CD
					        , fcBass0300CDNM (AA.DPOB_CD, BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM
					        , AA.HAN_NM
					        , AA.RESN_REGN_NUM
					        , AA.NATN_CD
					        , fcBass0300CDNM (AA.DPOB_CD, AA.NATN_CD) AS NATN_NM
					        , BB.DEPT_CD
					        , fcBass0400CDNM (AA.DPOB_CD, BB.DEPT_CD, '2') AS DEPT_NM
					        , BB.TYP_OCCU_CD
					        , fcBass0320CDNM(AA.DPOB_CD, BB.TYP_OCCU_CD)AS TYP_OCCU_NM 
					        , BB.DTIL_OCCU_INTTN_CD
					        ,  (CASE WHEN BB.EMYMT_DIV_CD = 'A0020010'
					            THEN fcBassEx0350CDNM(AA.DPOB_CD, BB.TYP_OCCU_CD, BB.DTIL_OCCU_INTTN_CD, '1')
					           ELSE (SELECT B.BUSIN_NM 
					                        FROM BASS0500 B
					                        WHERE B.DPOB_CD = BB.DPOB_CD 
					                            AND B.DEPT_CD = BB.DEPT_CD 
					                            AND B.BUSIN_CD = BB.BUSIN_CD
					                            AND B.BUSIN_APPTN_YR =SUBSTR(BB.EMYMT_BGNN_DT,1,4)
					                  )         
					           END)AS DTIL_OCCU_INTTN_NM
					         , AA.FRST_EMYMT_DT
					         , BB.EMYMT_BGNN_DT
					         , BB.EMYMT_END_DT
					         , BB.BUSIN_CD
					         , AA.HDOFC_CODTN_CD
					         , fcBass0300CDNM (AA.DPOB_CD, AA.HDOFC_CODTN_CD) AS HDOFC_CODTN_NM
					         , CC.PAYR_MANG_DEPT_CD
					FROM PSNL0100 AA, PAYR0500 CC,
					( SELECT CC01.DPOB_CD
							, CC01.SYSTEMKEY
							, CC01.EMYMT_DIV_CD
					        , CC01.DEPT_CD
					        , CC01.TYP_OCCU_CD
					        , CC01.DTIL_OCCU_INTTN_CD
					        , CC01.BUSIN_CD
					        , MIN (CC01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT
					        , MAX (NVL (CC01.EMYMT_END_DT, TO_CHAR (SYSDATE, 'YYYYMMDD')))AS EMYMT_END_DT
					  FROM PSNL0110 CC01
					 WHERE     CC01.DPOB_CD = #dpobCd#
							<isNotEmpty prepend="AND" property="emymtDivCd" >
					 			CC01.EMYMT_DIV_CD=#emymtDivCd#
							</isNotEmpty> 
							<isEqual prepend="AND" property="emymtDivCd" compareValue="A0020010">
								CC01.DTIL_OCCU_INTTN_CD IS NOT NULL
							</isEqual>
							AND CC01.EMYMT_TYP_CD NOT IN ('A0420990')
					      	AND CC01.EMYMT_BGNN_DT = ( SELECT MAX(CC02.EMYMT_BGNN_DT)
                                                                FROM PSNL0110 CC02
                                                               WHERE  CC02.EMYMT_TYP_CD NOT IN ('A0420990')  
                                                               AND  CC02.DPOB_CD = CC01.DPOB_CD 
                                                                AND CC02.SYSTEMKEY = CC01.SYSTEMKEY 
                                                                AND CC02.EMYMT_DIV_CD = CC01.EMYMT_DIV_CD
                                                                 AND SUBSTR(#yrtxBlggYr# ,1,4) BETWEEN  SUBSTR(CC02.EMYMT_BGNN_DT,1,4)  
                                                                AND SUBSTR(NVL (  CC02.EMYMT_END_DT,
                                                                 (CASE  WHEN TO_CHAR ( #yrtxBlggYr#) 	<![CDATA[	<= ]]>TO_CHAR ( SYSDATE, 'YYYYMMDD')
                                                                     THEN TO_CHAR (  SYSDATE, 'YYYYMMDD')
                                                                     ELSE TO_CHAR (#yrtxBlggYr#)  END)),1,4)                                 						
					                                 	)			      
					GROUP BY CC01.DPOB_CD
					         , CC01.SYSTEMKEY
					         , CC01.EMYMT_DIV_CD
					         , CC01.DEPT_CD
					         , CC01.TYP_OCCU_CD
					         , CC01.DTIL_OCCU_INTTN_CD
					         , CC01.BUSIN_CD) BB,
					( SELECT   
				 	        DISTINCT DPOB_CD, SYSTEMKEY
					   FROM 
					  (SELECT DD01.DPOB_CD, DD01.SYSTEMKEY
	                      FROM PAYR0304 DD01
	                     WHERE DD01.PYMT_YR_MNTH LIKE #yrtxBlggYr# || '%'
	                       AND DD01.DPOB_CD = #dpobCd#  
	                  GROUP BY DD01.DPOB_CD, DD01.SYSTEMKEY
	                  UNION ALL
	                    SELECT DD02.DPOB_CD, DD02.SYSTEMKEY
	                      FROM PYYT0304 DD02
	                     WHERE DD02.PYYT_YR_MNTH LIKE #yrtxBlggYr# || '%'
	                   AND DD02.DPOB_CD = #dpobCd#  
	                  GROUP BY DD02.DPOB_CD, DD02.SYSTEMKEY)
	                  ) EE        
					WHERE AA.DPOB_CD = BB.DPOB_CD
					    AND AA.SYSTEMKEY = BB.SYSTEMKEY 
					    AND AA.DPOB_CD = CC.DPOB_CD 
					    AND AA.SYSTEMKEY = CC.SYSTEMKEY  
					    AND AA.DPOB_CD = EE.DPOB_CD
                		AND AA.SYSTEMKEY = EE.SYSTEMKEY
						<isNotEmpty prepend="AND" property="dpobCd" >
							AA.DPOB_CD=#dpobCd#
				    	</isNotEmpty> 
				        <isNotEmpty property="deptCd" prepend="AND">
								<![CDATA[
								  DECODE(AA.CURR_AFFN_DEPT_CD,BB.DEPT_CD,BB.DEPT_CD,BB.DEPT_CD) 
								]]>
								<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
								 #deptCdArr[]#
								</iterate>
					   </isNotEmpty> 	  
<!-- junhee
 AND AA.YRTX_BLGG_YR=#yrtxBlggYr#
junhee -->
				     	AND NOT EXISTS
                            (SELECT TA01.DPOB_CD,
                                    TA01.YRTX_BLGG_YR,
                                    TA01.CLUT_SEPT_CD,
                                    TA01.SYSTEMKEY,
                                    TA01.UT_DPOB_CD
                               FROM YE161010 TA01, YE161020 TA02
                              WHERE     TA01.DPOB_CD = TA02.DPOB_CD
                                    AND TA01.YRTX_BLGG_YR = TA02.YRTX_BLGG_YR
                                    AND TA01.CLUT_SEPT_CD = TA02.CLUT_SEPT_CD
                                    AND TA01.SYSTEMKEY = TA02.SYSTEMKEY
                                    AND TA01.DPOB_CD = #dpobCd#
                                    AND TA01.YRTX_BLGG_YR = #yrtxBlggYr#
                                    AND TA01.CLUT_SEPT_CD = #clutSeptCd#
                                    AND TA01.SYSTEMKEY = AA.SYSTEMKEY)	
				     AND EXISTS  ( SELECT  C.DPOB_CD,
		                                   C.DTIL_OCCU_INTTN_CD,
		                                   C.TYP_OCCU_CD,
		                                   C.DEPT_CD FROM 
                                             ( SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#emymtBgnnDt# ))
				                            ) C
                                            WHERE   C.DPOB_CD = AA.DPOB_CD
						                        AND C.DEPT_CD = AA.CURR_AFFN_DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(AA.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(AA.DTIL_OCCU_INTTN_CD,'TT')
                                             
                                          )
                    <isNotEmpty prepend="AND" property="businCd" >
					 	AA.BUSIN_CD=#businCd#
				    </isNotEmpty> 
					<isNotEmpty prepend="AND" property="payrMangDeptCd" >
					 	CC.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
				    </isNotEmpty> 
				    <isNotEmpty prepend="AND" property="emymtDivCd" >
					 	BB.EMYMT_DIV_CD=#emymtDivCd#
					</isNotEmpty>
					<isNotEmpty property="hdofcCodtnCd" prepend="AND">
						<![CDATA[
							 AA.HDOFC_CODTN_CD
						]]>
						<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
							 #hdofcCodtnCdArr[]#
						</iterate>
					</isNotEmpty>  
				    <isNotEmpty property="typOccuCd" prepend="AND">
						<![CDATA[
							 BB.TYP_OCCU_CD
						]]>
						<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
						 	 #typOccuCdArr[]#
						</iterate>
					</isNotEmpty>  
					<isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 BB.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate>
					</isNotEmpty>  
				    <isNotEmpty prepend="AND" property="systemkey" >
					 	AA.SYSTEMKEY=#systemkey#
				    </isNotEmpty>  
				    <isNotEmpty prepend="AND" property="hanNm" >
					 	AA.HAN_NM LIKE '%' || #hanNm# || '%'
				    </isNotEmpty> 					
					ORDER BY 
					    AA.DPOB_CD DESC
					    , ( SELECT LPAD(DEPT_RANK,5,'0')  
					            FROM BASS0400 DD
					        WHERE DD.DEPT_CD = BB.DEPT_CD
					            AND DD.DPOB_CD = BB.DPOB_CD) ASC
					    , AA.RESN_REGN_NUM ASC
					    , AA.SYSTEMKEY DESC 
		
	<isNotEqual  property="lastIndex" compareValue="-1">
 	<![CDATA[					
				) T WHERE ROWNUM <= #lastIndex#
		)WHERE RNUM >= #firstIndex#
	]]>
	</isNotEqual>	
	<isEqual   property="lastIndex" compareValue="-1">
  	<![CDATA[					
		) T  
	)
	]]>
	</isEqual>	
 </select>	
 
	<select id="ye161010_2018_DAO.selectP31001ToPsnl0100ListCnt_S" parameterClass="infcPsnl0100Srh_2018_Vo" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM ( SELECT AA.DPOB_CD
					        , AA.SYSTEMKEY
					FROM PSNL0100 AA, PAYR0500 CC,
					( SELECT CC01.DPOB_CD
							, CC01.SYSTEMKEY
							, CC01.EMYMT_DIV_CD
					        , CC01.DEPT_CD
					        , CC01.TYP_OCCU_CD
					        , CC01.DTIL_OCCU_INTTN_CD
					        , CC01.BUSIN_CD
					        , MIN (CC01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT
					        , MAX (NVL (CC01.EMYMT_END_DT, TO_CHAR (SYSDATE, 'YYYYMMDD')))AS EMYMT_END_DT
					  FROM PSNL0110 CC01
					 WHERE     CC01.DPOB_CD = #dpobCd#
							<isNotEmpty prepend="AND" property="emymtDivCd" >
					 			CC01.EMYMT_DIV_CD=#emymtDivCd#
							</isNotEmpty> 
							<isEqual prepend="AND" property="emymtDivCd" compareValue="A0020010">
								CC01.DTIL_OCCU_INTTN_CD IS NOT NULL
							</isEqual>
							AND CC01.EMYMT_TYP_CD NOT IN ('A0420990')
					      	AND CC01.EMYMT_BGNN_DT = ( SELECT MAX(CC02.EMYMT_BGNN_DT)
                                                                FROM PSNL0110 CC02
                                                               WHERE  CC02.EMYMT_TYP_CD NOT IN ('A0420990')  
                                                               AND  CC02.DPOB_CD = CC01.DPOB_CD 
                                                                AND CC02.SYSTEMKEY = CC01.SYSTEMKEY 
                                                                AND CC02.EMYMT_DIV_CD = CC01.EMYMT_DIV_CD
                                                                 AND SUBSTR(#yrtxBlggYr# ,1,4) BETWEEN  SUBSTR(CC02.EMYMT_BGNN_DT,1,4)  
                                                                AND SUBSTR(NVL (  CC02.EMYMT_END_DT,
                                                                 (CASE  WHEN TO_CHAR ( #yrtxBlggYr#) 	<![CDATA[	<= ]]>TO_CHAR ( SYSDATE, 'YYYYMMDD')
                                                                     THEN TO_CHAR (  SYSDATE, 'YYYYMMDD')
                                                                     ELSE TO_CHAR (#yrtxBlggYr#)  END)),1,4)                                 						
					                                 	)			      
					GROUP BY CC01.DPOB_CD
					         , CC01.SYSTEMKEY
					         , CC01.EMYMT_DIV_CD
					         , CC01.DEPT_CD
					         , CC01.TYP_OCCU_CD
					         , CC01.DTIL_OCCU_INTTN_CD
					         , CC01.BUSIN_CD) BB,
					(   SELECT   
				 	        DISTINCT DPOB_CD, SYSTEMKEY
					   FROM 
					  (SELECT DD01.DPOB_CD, DD01.SYSTEMKEY
	                      FROM PAYR0304 DD01
	                     WHERE DD01.PYMT_YR_MNTH LIKE #yrtxBlggYr# || '%'
	                       AND DD01.DPOB_CD = #dpobCd#  
	                  GROUP BY DD01.DPOB_CD, DD01.SYSTEMKEY
	                  UNION ALL
	                    SELECT DD02.DPOB_CD, DD02.SYSTEMKEY
	                      FROM PYYT0304 DD02
	                     WHERE DD02.PYYT_YR_MNTH LIKE #yrtxBlggYr# || '%'
	                   AND DD02.DPOB_CD = #dpobCd#  
	                  GROUP BY DD02.DPOB_CD, DD02.SYSTEMKEY)
	                  ) EE        
					WHERE AA.DPOB_CD = BB.DPOB_CD
					    AND AA.SYSTEMKEY = BB.SYSTEMKEY 
					    AND AA.DPOB_CD = CC.DPOB_CD 
					    AND AA.SYSTEMKEY = CC.SYSTEMKEY  
					    AND AA.DPOB_CD = EE.DPOB_CD
                		AND AA.SYSTEMKEY = EE.SYSTEMKEY
						<isNotEmpty prepend="AND" property="dpobCd" >
							AA.DPOB_CD=#dpobCd#
				    	</isNotEmpty> 
				        <isNotEmpty property="deptCd" prepend="AND">
								<![CDATA[
								  DECODE(AA.CURR_AFFN_DEPT_CD,BB.DEPT_CD,BB.DEPT_CD,BB.DEPT_CD) 
								]]>
								<iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
								 #deptCdArr[]#
								</iterate>
					   </isNotEmpty> 	    	
				     	AND NOT EXISTS
                            (SELECT TA01.DPOB_CD,
                                    TA01.YRTX_BLGG_YR,
                                    TA01.CLUT_SEPT_CD,
                                    TA01.SYSTEMKEY,
                                    TA01.UT_DPOB_CD
                               FROM YE161010 TA01, YE161020 TA02
                              WHERE     TA01.DPOB_CD = TA02.DPOB_CD
                                    AND TA01.YRTX_BLGG_YR = TA02.YRTX_BLGG_YR
                                    AND TA01.CLUT_SEPT_CD = TA02.CLUT_SEPT_CD
                                    AND TA01.SYSTEMKEY = TA02.SYSTEMKEY
                                    AND TA01.DPOB_CD = #dpobCd#
                                    AND TA01.YRTX_BLGG_YR = #yrtxBlggYr#
                                    AND TA01.CLUT_SEPT_CD = #clutSeptCd#
                                    AND TA01.SYSTEMKEY = AA.SYSTEMKEY)	         
				     AND EXISTS  (
                         SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#emymtBgnnDt# ))) C
                                            WHERE     C.DPOB_CD = AA.DPOB_CD
						                        AND C.DEPT_CD = AA.CURR_AFFN_DEPT_CD
						                        AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(AA.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(AA.DTIL_OCCU_INTTN_CD,'TT') 
                                          )
                    <isNotEmpty prepend="AND" property="businCd" >
					 	AA.BUSIN_CD=#businCd#
				    </isNotEmpty> 
					<isNotEmpty prepend="AND" property="payrMangDeptCd" >
					 	CC.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
				    </isNotEmpty> 
				    <isNotEmpty prepend="AND" property="emymtDivCd" >
					 	BB.EMYMT_DIV_CD=#emymtDivCd#
					</isNotEmpty>
					<isNotEmpty property="hdofcCodtnCd" prepend="AND">
						<![CDATA[
							 AA.HDOFC_CODTN_CD
						]]>
						<iterate prepend="IN" property="hdofcCodtnCdArr" open="(" close=")" conjunction=",">
							 #hdofcCodtnCdArr[]#
						</iterate>
					</isNotEmpty>  
				    <isNotEmpty property="typOccuCd" prepend="AND">
						<![CDATA[
							 BB.TYP_OCCU_CD
						]]>
						<iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
						 	 #typOccuCdArr[]#
						</iterate>
					</isNotEmpty>  
					<isNotEmpty property="dtilOccuInttnCd" prepend="AND">
						<![CDATA[
							 BB.DTIL_OCCU_INTTN_CD
						]]>
						<iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
							 #dtilOccuInttnCdArr[]#
						</iterate>
					</isNotEmpty>  
				    <isNotEmpty prepend="AND" property="systemkey" >
					 	AA.SYSTEMKEY=#systemkey#
				    </isNotEmpty>  
				    <isNotEmpty prepend="AND" property="hanNm" >
					 	AA.HAN_NM LIKE '%' || #hanNm# || '%'
				    </isNotEmpty>
					ORDER BY 
					    AA.DPOB_CD DESC
					    , ( SELECT LPAD(DEPT_RANK,5,'0')  
					            FROM BASS0400 DD
					        WHERE DD.DEPT_CD = BB.DEPT_CD
					            AND DD.DPOB_CD = BB.DPOB_CD) ASC
					    , AA.RESN_REGN_NUM ASC
					    , AA.SYSTEMKEY DESC
	)
	</select>	
	
	
	

<select id="ye161010_2018_DAO.selectYeta3200ResultListCnt_S" parameterClass="ye161010Srh_2018_Vo" resultClass="int">
	SELECT COUNT (*) totcnt
	  FROM (  SELECT BB.FILE_SBT_YN,
         CC.COMM_CD,
         (CASE (CC.COMM_CD)
             WHEN 'Y0190200'
             THEN
                (SELECT AA.COMM_CD_NM
                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
                           FROM BASS0300
                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
                  WHERE AA.COMM_CD = CC.COMM_CD)
             WHEN 'Y0190210'
             THEN
                (SELECT AA.COMM_CD_NM
                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
                           FROM BASS0300
                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
                  WHERE AA.COMM_CD = CC.COMM_CD)
             WHEN 'Y0190010'
             THEN
                (SELECT AA.COMM_CD_NM
                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
                           FROM BASS0300
                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
                  WHERE AA.COMM_CD = CC.COMM_CD)
             WHEN 'Y0190020'
             THEN
                (SELECT AA.COMM_CD_NM
                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
                           FROM BASS0300
                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
                  WHERE AA.COMM_CD = CC.COMM_CD)
             WHEN 'Y0190030'
             THEN
                (SELECT AA.COMM_CD_NM
                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
                           FROM BASS0300
                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
                  WHERE AA.COMM_CD = CC.COMM_CD)
             WHEN 'Y0190040'
             THEN
                (SELECT AA.COMM_CD_NM
                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
                           FROM BASS0300
                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
                  WHERE AA.COMM_CD = CC.COMM_CD)
             WHEN 'Y0190050'
             THEN
                (SELECT AA.COMM_CD_NM
                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
                           FROM BASS0300
                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
                  WHERE AA.COMM_CD = CC.COMM_CD)
             WHEN 'Y0190055'
             THEN
                (SELECT AA.COMM_CD_NM
                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
                           FROM BASS0300
                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
                  WHERE AA.COMM_CD = CC.COMM_CD)
             WHEN 'Y0190090'
             THEN
                (SELECT AA.COMM_CD_NM
                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
                           FROM BASS0300
                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
                  WHERE AA.COMM_CD = CC.COMM_CD)
             WHEN 'Y0190110'
             THEN
                (SELECT AA.COMM_CD_NM
                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
                           FROM BASS0300
                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
                  WHERE AA.COMM_CD = CC.COMM_CD)
             WHEN 'Y0190100'
             THEN
                (SELECT AA.COMM_CD_NM
                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
                           FROM BASS0300
                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
                  WHERE AA.COMM_CD = CC.COMM_CD)
             WHEN 'Y0190180'
             THEN
                (SELECT AA.COMM_CD_NM
                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
                           FROM BASS0300
                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
                  WHERE AA.COMM_CD = CC.COMM_CD)
             WHEN 'Y0190130'
             THEN
                (SELECT AA.COMM_CD_NM
                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
                           FROM BASS0300
                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
                  WHERE AA.COMM_CD = CC.COMM_CD)
             WHEN 'Y0190120'
             THEN
                (SELECT AA.COMM_CD_NM
                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
                           FROM BASS0300
                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
                  WHERE AA.COMM_CD = CC.COMM_CD)
             WHEN 'Y0190140'
             THEN
                (SELECT AA.COMM_CD_NM
                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
                           FROM BASS0300
                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
                  WHERE AA.COMM_CD = CC.COMM_CD)
             WHEN 'Y0190060'
             THEN
                (SELECT AA.COMM_CD_NM
                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
                           FROM BASS0300
                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
                  WHERE AA.COMM_CD = CC.COMM_CD)
             WHEN 'Y0190070'
             THEN
                (SELECT AA.COMM_CD_NM
                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
                           FROM BASS0300
                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
                  WHERE AA.COMM_CD = CC.COMM_CD)
             WHEN 'Y0190080'
             THEN
                (SELECT AA.COMM_CD_NM
                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
                           FROM BASS0300
                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
                  WHERE AA.COMM_CD = CC.COMM_CD)
             WHEN 'Y0190160'
             THEN
                (SELECT AA.COMM_CD_NM
                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
                           FROM BASS0300
                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
                  WHERE AA.COMM_CD = CC.COMM_CD)
             WHEN 'Y0190170'
             THEN
                (SELECT AA.COMM_CD_NM
                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
                           FROM BASS0300
                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
                  WHERE AA.COMM_CD = CC.COMM_CD)
          END)
            AS COMM_NM,
         (CASE WHEN (SUM (CC.CNT)) >= 1 THEN 'Y' END) AS PDF_DAT_APP_YN,
         DD.INPT_DT
    FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
            FROM BASS0300
           WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA01,
         (SELECT SUBSTR (INPT_DT, 0, 8) AS INPT_DT
            FROM PDF_O101Y
           WHERE     SYSTEMKEY = #systemkey#
                 AND YRTX_BLGG_YR = #yrtxBlggYr#
                 AND CLUT_SEPT_CD = #clutSeptCd#
                 AND DPOB_CD = #dpobCd#) DD,
         (SELECT DPOB_CD, FILE_SBT_YN
            FROM YE161020
           WHERE     SYSTEMKEY = #systemkey#
                 AND YRTX_BLGG_YR = #yrtxBlggYr#
                 AND CLUT_SEPT_CD = #clutSeptCd#
                 AND DPOB_CD = #dpobCd#) BB,
         (  SELECT ('Y0190200') AS COMM_CD, COUNT (*) AS CNT
              FROM PDF_O101Y
             WHERE     SYSTEMKEY = #systemkey#
                   AND YRTX_BLGG_YR = #yrtxBlggYr#
                   AND CLUT_SEPT_CD = #clutSeptCd#
                   AND DPOB_CD = #dpobCd#
          GROUP BY INPT_DT
          UNION ALL
            SELECT ('Y0190210') AS COMM_CD, COUNT (*) AS CNT
              FROM PDF_P102Y
             WHERE     SYSTEMKEY = #systemkey#
                   AND YRTX_BLGG_YR = #yrtxBlggYr#
                   AND CLUT_SEPT_CD = #clutSeptCd#
                   AND DPOB_CD = #dpobCd#
          GROUP BY INPT_DT
          UNION ALL
            SELECT ('Y0190010') AS COMN_CD, COUNT (*) AS CNT
              FROM PDF_A102Y
             WHERE     SYSTEMKEY = #systemkey#
                   AND YRTX_BLGG_YR = #yrtxBlggYr#
                   AND CLUT_SEPT_CD = #clutSeptCd#
                   AND DPOB_CD = #dpobCd#
          GROUP BY INPT_DT
          UNION ALL
            SELECT ('Y0190020') AS COMM_CD, COUNT (*) AS CNT
              FROM PDF_B101Y
             WHERE     SYSTEMKEY = #systemkey#
                   AND YRTX_BLGG_YR = #yrtxBlggYr#
                   AND CLUT_SEPT_CD = #clutSeptCd#
                   AND DPOB_CD = #dpobCd#
          GROUP BY INPT_DT
          UNION ALL
            SELECT ('Y0190030') AS COMM_CD, COUNT (*) AS CNT
              FROM PDF_C101Y
             WHERE     SYSTEMKEY = #systemkey#
                   AND YRTX_BLGG_YR = #yrtxBlggYr#
                   AND CLUT_SEPT_CD = #clutSeptCd#
                   AND DPOB_CD = #dpobCd#
          GROUP BY INPT_DT
          UNION ALL
            SELECT ('Y0190040') AS COMM_CD, COUNT (*) AS CNT
              FROM PDF_C202Y
             WHERE     SYSTEMKEY = #systemkey#
                   AND YRTX_BLGG_YR = #yrtxBlggYr#
                   AND CLUT_SEPT_CD = #clutSeptCd#
                   AND DPOB_CD = #dpobCd#
          GROUP BY INPT_DT
          UNION ALL
            SELECT ('Y0190050') AS COMM_CD, COUNT (*) AS CNT
              FROM PDF_C301Y
             WHERE     SYSTEMKEY = #systemkey#
                   AND YRTX_BLGG_YR = #yrtxBlggYr#
                   AND CLUT_SEPT_CD = #clutSeptCd#
                   AND DPOB_CD = #dpobCd#
          GROUP BY INPT_DT
          UNION ALL
            SELECT ('Y0190055') AS COMM_CD, COUNT (*) AS CNT
              FROM PDF_C401Y
             WHERE     SYSTEMKEY = #systemkey#
                   AND YRTX_BLGG_YR = #yrtxBlggYr#
                   AND CLUT_SEPT_CD = #clutSeptCd#
                   AND DPOB_CD = #dpobCd#
          GROUP BY INPT_DT
          UNION ALL
            SELECT ('Y0190090') AS COMM_CD, COUNT (*) AS CNT
              FROM PDF_G107Y
             WHERE     SYSTEMKEY = #systemkey#
                   AND YRTX_BLGG_YR = #yrtxBlggYr#
                   AND CLUT_SEPT_CD = #clutSeptCd#
                   AND DPOB_CD = #dpobCd#
          GROUP BY INPT_DT
          UNION ALL
            SELECT ('Y0190110') AS COMM_CD, COUNT (*) AS CNT
              FROM PDF_G307Y
             WHERE     SYSTEMKEY = #systemkey#
                   AND YRTX_BLGG_YR = #yrtxBlggYr#
                   AND CLUT_SEPT_CD = #clutSeptCd#
                   AND DPOB_CD = #dpobCd#
          GROUP BY INPT_DT
          UNION ALL
            SELECT ('Y0190100') AS COMM_CD, COUNT (*) AS CNT
              FROM PDF_G207Y
             WHERE     SYSTEMKEY = #systemkey#
                   AND YRTX_BLGG_YR = #yrtxBlggYr#
                   AND CLUT_SEPT_CD = #clutSeptCd#
                   AND DPOB_CD = #dpobCd#
          GROUP BY INPT_DT
          UNION ALL
            SELECT ('Y0190180') AS COMM_CD, COUNT (*) AS CNT
              FROM PDF_N101Y
             WHERE     SYSTEMKEY = #systemkey#
                   AND YRTX_BLGG_YR = #yrtxBlggYr#
                   AND CLUT_SEPT_CD = #clutSeptCd#
                   AND DPOB_CD = #dpobCd#
          GROUP BY INPT_DT
          UNION ALL
            SELECT ('Y0190130') AS COMM_CD, COUNT (*) AS CNT
              FROM PDF_J203Y
             WHERE     SYSTEMKEY = #systemkey#
                   AND YRTX_BLGG_YR = #yrtxBlggYr#
                   AND CLUT_SEPT_CD = #clutSeptCd#
                   AND DPOB_CD = #dpobCd#
          GROUP BY INPT_DT
          UNION ALL
            SELECT ('Y0190120') AS COMM_CD, COUNT (*) AS CNT
              FROM PDF_J101Y
             WHERE     SYSTEMKEY = #systemkey#
                   AND YRTX_BLGG_YR = #yrtxBlggYr#
                   AND CLUT_SEPT_CD = #clutSeptCd#
                   AND DPOB_CD = #dpobCd#
          GROUP BY INPT_DT
          UNION ALL
            SELECT ('Y0190140') AS COMM_CD, COUNT (*) AS CNT
              FROM PDF_J301Y
             WHERE     SYSTEMKEY = #systemkey#
                   AND YRTX_BLGG_YR = #yrtxBlggYr#
                   AND CLUT_SEPT_CD = #clutSeptCd#
                   AND DPOB_CD = #dpobCd#
          GROUP BY INPT_DT
          UNION ALL
            SELECT ('Y0190150') AS COMM_CD, COUNT (*) AS CNT
              FROM PDF_J401Y
             WHERE     SYSTEMKEY = #systemkey#
                   AND YRTX_BLGG_YR = #yrtxBlggYr#
                   AND CLUT_SEPT_CD = #clutSeptCd#
                   AND DPOB_CD = #dpobCd#
          GROUP BY INPT_DT
          UNION ALL
            SELECT ('Y0190060') AS COMM_CD, COUNT (*) AS CNT
              FROM PDF_D101Y
             WHERE     SYSTEMKEY = #systemkey#
                   AND YRTX_BLGG_YR = #yrtxBlggYr#
                   AND CLUT_SEPT_CD = #clutSeptCd#
                   AND DPOB_CD = #dpobCd#
          GROUP BY INPT_DT
          UNION ALL
            SELECT ('Y0190070') AS COMM_CD, COUNT (*) AS CNT
              FROM PDF_E102Y
             WHERE     SYSTEMKEY = #systemkey#
                   AND YRTX_BLGG_YR = #yrtxBlggYr#
                   AND CLUT_SEPT_CD = #clutSeptCd#
                   AND DPOB_CD = #dpobCd#
          GROUP BY INPT_DT
          UNION ALL
            SELECT ('Y0190080') AS COMM_CD, COUNT (*) AS CNT
              FROM PDF_F102Y
             WHERE     SYSTEMKEY = #systemkey#
                   AND YRTX_BLGG_YR = #yrtxBlggYr#
                   AND CLUT_SEPT_CD = #clutSeptCd#
                   AND DPOB_CD = #dpobCd#
          GROUP BY INPT_DT
          UNION ALL
            SELECT ('Y0190160') AS COMM_CD, COUNT (*) AS CNT
              FROM PDF_K101Y
             WHERE     SYSTEMKEY = #systemkey#
                   AND YRTX_BLGG_YR = #yrtxBlggYr#
                   AND CLUT_SEPT_CD = #clutSeptCd#
                   AND DPOB_CD = #dpobCd#
          GROUP BY INPT_DT
          UNION ALL
            SELECT ('Y0190170') AS COMM_CD, COUNT (*) AS CNT
              FROM PDF_L102Y
             WHERE     SYSTEMKEY = #systemkey#
                   AND YRTX_BLGG_YR = #yrtxBlggYr#
                   AND CLUT_SEPT_CD = #clutSeptCd#
                   AND DPOB_CD = #dpobCd#
          GROUP BY INPT_DT) CC
   WHERE AA01.DPOB_CD = BB.DPOB_CD AND AA01.COMM_CD = CC.COMM_CD
GROUP BY BB.FILE_SBT_YN, CC.COMM_CD, DD.INPT_DT
ORDER BY CC.COMM_CD ASC)
</select>
<select id="ye161010_2018_DAO.selectYeta3200ResultList_D" parameterClass="ye161010Srh_2018_Vo" resultClass="egovMap">
		SELECT * FROM (
			SELECT T.*, ROWNUM RNUM FROM (SELECT BB.FILE_SBT_YN,
	         CC.COMM_CD,
	         (CASE (CC.COMM_CD)
	             WHEN 'Y0190200'
	             THEN
	                (SELECT AA.COMM_CD_NM
	                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
	                           FROM BASS0300
	                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
	                  WHERE AA.COMM_CD = CC.COMM_CD)
	             WHEN 'Y0190210'
	             THEN
	                (SELECT AA.COMM_CD_NM
	                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
	                           FROM BASS0300
	                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
	                  WHERE AA.COMM_CD = CC.COMM_CD)
	             WHEN 'Y0190010'
	             THEN
	                (SELECT AA.COMM_CD_NM
	                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
	                           FROM BASS0300
	                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
	                  WHERE AA.COMM_CD = CC.COMM_CD)
	             WHEN 'Y0190020'
	             THEN
	                (SELECT AA.COMM_CD_NM
	                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
	                           FROM BASS0300
	                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
	                  WHERE AA.COMM_CD = CC.COMM_CD)
	             WHEN 'Y0190030'
	             THEN
	                (SELECT AA.COMM_CD_NM
	                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
	                           FROM BASS0300
	                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
	                  WHERE AA.COMM_CD = CC.COMM_CD)
	             WHEN 'Y0190040'
	             THEN
	                (SELECT AA.COMM_CD_NM
	                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
	                           FROM BASS0300
	                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
	                  WHERE AA.COMM_CD = CC.COMM_CD)
	             WHEN 'Y0190050'
	             THEN
	                (SELECT AA.COMM_CD_NM
	                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
	                           FROM BASS0300
	                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
	                  WHERE AA.COMM_CD = CC.COMM_CD)
	             WHEN 'Y0190055'
	             THEN
	                (SELECT AA.COMM_CD_NM
	                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
	                           FROM BASS0300
	                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
	                  WHERE AA.COMM_CD = CC.COMM_CD)
	             WHEN 'Y0190090'
	             THEN
	                (SELECT AA.COMM_CD_NM
	                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
	                           FROM BASS0300
	                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
	                  WHERE AA.COMM_CD = CC.COMM_CD)
	             WHEN 'Y0190110'
	             THEN
	                (SELECT AA.COMM_CD_NM
	                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
	                           FROM BASS0300
	                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
	                  WHERE AA.COMM_CD = CC.COMM_CD)
	             WHEN 'Y0190100'
	             THEN
	                (SELECT AA.COMM_CD_NM
	                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
	                           FROM BASS0300
	                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
	                  WHERE AA.COMM_CD = CC.COMM_CD)
	             WHEN 'Y0190180'
	             THEN
	                (SELECT AA.COMM_CD_NM
	                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
	                           FROM BASS0300
	                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
	                  WHERE AA.COMM_CD = CC.COMM_CD)
	             WHEN 'Y0190130'
	             THEN
	                (SELECT AA.COMM_CD_NM
	                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
	                           FROM BASS0300
	                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
	                  WHERE AA.COMM_CD = CC.COMM_CD)
	             WHEN 'Y0190120'
	             THEN
	                (SELECT AA.COMM_CD_NM
	                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
	                           FROM BASS0300
	                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
	                  WHERE AA.COMM_CD = CC.COMM_CD)
	             WHEN 'Y0190140'
	             THEN
	                (SELECT AA.COMM_CD_NM
	                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
	                           FROM BASS0300
	                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
	                  WHERE AA.COMM_CD = CC.COMM_CD)
	             WHEN 'Y0190060'
	             THEN
	                (SELECT AA.COMM_CD_NM
	                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
	                           FROM BASS0300
	                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
	                  WHERE AA.COMM_CD = CC.COMM_CD)
	             WHEN 'Y0190070'
	             THEN
	                (SELECT AA.COMM_CD_NM
	                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
	                           FROM BASS0300
	                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
	                  WHERE AA.COMM_CD = CC.COMM_CD)
	             WHEN 'Y0190080'
	             THEN
	                (SELECT AA.COMM_CD_NM
	                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
	                           FROM BASS0300
	                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
	                  WHERE AA.COMM_CD = CC.COMM_CD)
	             WHEN 'Y0190160'
	             THEN
	                (SELECT AA.COMM_CD_NM
	                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
	                           FROM BASS0300
	                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
	                  WHERE AA.COMM_CD = CC.COMM_CD)
	             WHEN 'Y0190170'
	             THEN
	                (SELECT AA.COMM_CD_NM
	                   FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
	                           FROM BASS0300
	                          WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA
	                  WHERE AA.COMM_CD = CC.COMM_CD)
	          END)
	            AS COMM_NM,
	         (CASE WHEN (SUM (CC.CNT)) >= 1 THEN 'Y' END) AS PDF_DAT_APP_YN,
	         DD.INPT_DT
	    FROM (SELECT DPOB_CD, COMM_CD, COMM_CD_NM
	            FROM BASS0300
	           WHERE DPOB_CD = #dpobCd# AND RPSTTV_CD = 'Y019') AA01,
	         (SELECT SUBSTR (INPT_DT, 0, 8) AS INPT_DT
	            FROM PDF_O101Y
	           WHERE     SYSTEMKEY = #systemkey#
	                 AND YRTX_BLGG_YR = #yrtxBlggYr#
	                 AND CLUT_SEPT_CD = #clutSeptCd#
	                 AND DPOB_CD = #dpobCd#) DD,
	         (SELECT DPOB_CD, FILE_SBT_YN
	            FROM YE161020
	           WHERE     SYSTEMKEY = #systemkey#
	                 AND YRTX_BLGG_YR = #yrtxBlggYr#
	                 AND CLUT_SEPT_CD = #clutSeptCd#
	                 AND DPOB_CD = #dpobCd#) BB,
	         (  SELECT ('Y0190200') AS COMM_CD, COUNT (*) AS CNT
	              FROM PDF_O101Y
	             WHERE     SYSTEMKEY = #systemkey#
	                   AND YRTX_BLGG_YR = #yrtxBlggYr#
	                   AND CLUT_SEPT_CD = #clutSeptCd#
	                   AND DPOB_CD = #dpobCd#
	          GROUP BY INPT_DT
	          UNION ALL
	            SELECT ('Y0190210') AS COMM_CD, COUNT (*) AS CNT
	              FROM PDF_P102Y
	             WHERE     SYSTEMKEY = #systemkey#
	                   AND YRTX_BLGG_YR = #yrtxBlggYr#
	                   AND CLUT_SEPT_CD = #clutSeptCd#
	                   AND DPOB_CD = #dpobCd#
	          GROUP BY INPT_DT
	          UNION ALL
	            SELECT ('Y0190010') AS COMN_CD, COUNT (*) AS CNT
	              FROM PDF_A102Y
	             WHERE     SYSTEMKEY = #systemkey#
	                   AND YRTX_BLGG_YR = #yrtxBlggYr#
	                   AND CLUT_SEPT_CD = #clutSeptCd#
	                   AND DPOB_CD = #dpobCd#
	          GROUP BY INPT_DT
	          UNION ALL
	            SELECT ('Y0190020') AS COMM_CD, COUNT (*) AS CNT
	              FROM PDF_B101Y
	             WHERE     SYSTEMKEY = #systemkey#
	                   AND YRTX_BLGG_YR = #yrtxBlggYr#
	                   AND CLUT_SEPT_CD = #clutSeptCd#
	                   AND DPOB_CD = #dpobCd#
	          GROUP BY INPT_DT
	          UNION ALL
	            SELECT ('Y0190030') AS COMM_CD, COUNT (*) AS CNT
	              FROM PDF_C101Y
	             WHERE     SYSTEMKEY = #systemkey#
	                   AND YRTX_BLGG_YR = #yrtxBlggYr#
	                   AND CLUT_SEPT_CD = #clutSeptCd#
	                   AND DPOB_CD = #dpobCd#
	          GROUP BY INPT_DT
	          UNION ALL
	            SELECT ('Y0190040') AS COMM_CD, COUNT (*) AS CNT
	              FROM PDF_C202Y
	             WHERE     SYSTEMKEY = #systemkey#
	                   AND YRTX_BLGG_YR = #yrtxBlggYr#
	                   AND CLUT_SEPT_CD = #clutSeptCd#
	                   AND DPOB_CD = #dpobCd#
	          GROUP BY INPT_DT
	          UNION ALL
	            SELECT ('Y0190050') AS COMM_CD, COUNT (*) AS CNT
	              FROM PDF_C301Y
	             WHERE     SYSTEMKEY = #systemkey#
	                   AND YRTX_BLGG_YR = #yrtxBlggYr#
	                   AND CLUT_SEPT_CD = #clutSeptCd#
	                   AND DPOB_CD = #dpobCd#
	          GROUP BY INPT_DT
	          UNION ALL
		          SELECT ('Y0190055') AS COMM_CD, COUNT (*) AS CNT
		              FROM PDF_C401Y
		             WHERE     SYSTEMKEY = #systemkey#
		                   AND YRTX_BLGG_YR = #yrtxBlggYr#
		                   AND CLUT_SEPT_CD = #clutSeptCd#
		                   AND DPOB_CD = #dpobCd#
		          GROUP BY INPT_DT
	          UNION ALL
	            SELECT ('Y0190090') AS COMM_CD, COUNT (*) AS CNT
	              FROM PDF_G107Y
	             WHERE     SYSTEMKEY = #systemkey#
	                   AND YRTX_BLGG_YR = #yrtxBlggYr#
	                   AND CLUT_SEPT_CD = #clutSeptCd#
	                   AND DPOB_CD = #dpobCd#
	          GROUP BY INPT_DT
	          UNION ALL
	            SELECT ('Y0190110') AS COMM_CD, COUNT (*) AS CNT
	              FROM PDF_G307Y
	             WHERE     SYSTEMKEY = #systemkey#
	                   AND YRTX_BLGG_YR = #yrtxBlggYr#
	                   AND CLUT_SEPT_CD = #clutSeptCd#
	                   AND DPOB_CD = #dpobCd#
	          GROUP BY INPT_DT
	          UNION ALL
	            SELECT ('Y0190100') AS COMM_CD, COUNT (*) AS CNT
	              FROM PDF_G207Y
	             WHERE     SYSTEMKEY = #systemkey#
	                   AND YRTX_BLGG_YR = #yrtxBlggYr#
	                   AND CLUT_SEPT_CD = #clutSeptCd#
	                   AND DPOB_CD = #dpobCd#
	          GROUP BY INPT_DT
	          UNION ALL
	            SELECT ('Y0190180') AS COMM_CD, COUNT (*) AS CNT
	              FROM PDF_N101Y
	             WHERE     SYSTEMKEY = #systemkey#
	                   AND YRTX_BLGG_YR = #yrtxBlggYr#
	                   AND CLUT_SEPT_CD = #clutSeptCd#
	                   AND DPOB_CD = #dpobCd#
	          GROUP BY INPT_DT
	          UNION ALL
	            SELECT ('Y0190130') AS COMM_CD, COUNT (*) AS CNT
	              FROM PDF_J203Y
	             WHERE     SYSTEMKEY = #systemkey#
	                   AND YRTX_BLGG_YR = #yrtxBlggYr#
	                   AND CLUT_SEPT_CD = #clutSeptCd#
	                   AND DPOB_CD = #dpobCd#
	          GROUP BY INPT_DT
	          UNION ALL
	            SELECT ('Y0190120') AS COMM_CD, COUNT (*) AS CNT
	              FROM PDF_J101Y
	             WHERE     SYSTEMKEY = #systemkey#
	                   AND YRTX_BLGG_YR = #yrtxBlggYr#
	                   AND CLUT_SEPT_CD = #clutSeptCd#
	                   AND DPOB_CD = #dpobCd#
	          GROUP BY INPT_DT
	          UNION ALL
	            SELECT ('Y0190140') AS COMM_CD, COUNT (*) AS CNT
	              FROM PDF_J301Y
	             WHERE     SYSTEMKEY = #systemkey#
	                   AND YRTX_BLGG_YR = #yrtxBlggYr#
	                   AND CLUT_SEPT_CD = #clutSeptCd#
	                   AND DPOB_CD = #dpobCd#
	          GROUP BY INPT_DT
	          UNION ALL
	            SELECT ('Y0190150') AS COMM_CD, COUNT (*) AS CNT
	              FROM PDF_J401Y
	             WHERE     SYSTEMKEY = #systemkey#
	                   AND YRTX_BLGG_YR = #yrtxBlggYr#
	                   AND CLUT_SEPT_CD = #clutSeptCd#
	                   AND DPOB_CD = #dpobCd#
	          GROUP BY INPT_DT
	          UNION ALL
	            SELECT ('Y0190060') AS COMM_CD, COUNT (*) AS CNT
	              FROM PDF_D101Y
	             WHERE     SYSTEMKEY = #systemkey#
	                   AND YRTX_BLGG_YR = #yrtxBlggYr#
	                   AND CLUT_SEPT_CD = #clutSeptCd#
	                   AND DPOB_CD = #dpobCd#
	          GROUP BY INPT_DT
	          UNION ALL
	            SELECT ('Y0190070') AS COMM_CD, COUNT (*) AS CNT
	              FROM PDF_E102Y
	             WHERE     SYSTEMKEY = #systemkey#
	                   AND YRTX_BLGG_YR = #yrtxBlggYr#
	                   AND CLUT_SEPT_CD = #clutSeptCd#
	                   AND DPOB_CD = #dpobCd#
	          GROUP BY INPT_DT
	          UNION ALL
	            SELECT ('Y0190080') AS COMM_CD, COUNT (*) AS CNT
	              FROM PDF_F102Y
	             WHERE     SYSTEMKEY = #systemkey#
	                   AND YRTX_BLGG_YR = #yrtxBlggYr#
	                   AND CLUT_SEPT_CD = #clutSeptCd#
	                   AND DPOB_CD = #dpobCd#
	          GROUP BY INPT_DT
	          UNION ALL
	            SELECT ('Y0190160') AS COMM_CD, COUNT (*) AS CNT
	              FROM PDF_K101Y
	             WHERE     SYSTEMKEY = #systemkey#
	                   AND YRTX_BLGG_YR = #yrtxBlggYr#
	                   AND CLUT_SEPT_CD = #clutSeptCd#
	                   AND DPOB_CD = #dpobCd#
	          GROUP BY INPT_DT
	          UNION ALL
	            SELECT ('Y0190170') AS COMM_CD, COUNT (*) AS CNT
	              FROM PDF_L102Y
	             WHERE     SYSTEMKEY = #systemkey#
	                   AND YRTX_BLGG_YR = #yrtxBlggYr#
	                   AND CLUT_SEPT_CD = #clutSeptCd#
	                   AND DPOB_CD = #dpobCd#
	          GROUP BY INPT_DT) CC
	   WHERE AA01.DPOB_CD = BB.DPOB_CD AND AA01.COMM_CD = CC.COMM_CD
	GROUP BY BB.FILE_SBT_YN, CC.COMM_CD, DD.INPT_DT
	ORDER BY CC.COMM_CD ASC
		<isNotEqual  property="lastIndex" compareValue="-1">
 	<![CDATA[					
				) T WHERE ROWNUM <= #lastIndex#
		)WHERE RNUM >= #firstIndex#
	]]>
	</isNotEqual>	
	<isEqual   property="lastIndex" compareValue="-1">
  	<![CDATA[					
		) T  
	)
	]]>
	</isEqual>	
</select>

<resultMap id="allYeta161010_2018" class="com.app.exterms.yearendtax.server.vo.Ye161010_2018_VO">
	<result property="dpobCd" column="DPOB_CD" columnIndex="1"/>
	<result property="yrtxBlggYr" column="YRTX_BLGG_YR" columnIndex="2"/>
	<result property="clutSeptCd" column="CLUT_SEPT_CD" columnIndex="3"/>
	<result property="systemkey" column="SYSTEMKEY" columnIndex="4"/>
	<result property="payrMangDeptCd" column="PAYR_MANG_DEPT_CD" columnIndex="5"/>
	<result property="utDpobCd" column="UT_DPOB_CD" columnIndex="6"/>
	<result property="emymtDivCd" column="EMYMT_DIV_CD" columnIndex="7"/>
	<result property="deptCd" column="DEPT_CD" columnIndex="8"/>
	<result property="typOccuCd" column="TYP_OCCU_CD" columnIndex="9"/>
	<result property="dtilOccuInttnCd" column="DTIL_OCCU_INTTN_CD" columnIndex="1"/>
	<result property="businCd" column="BUSIN_CD" columnIndex="11"/>
	<result property="pernChrgEmpIdenNum" column="PERN_CHRG_EMP_IDEN_NUM" columnIndex="12"/>
	<result property="closFlag" column="CLOS_FLAG" columnIndex="13"/>
	<result property="closCont" column="CLOS_CONT" columnIndex="14"/>
	<result property="closDate" column="CLOS_DATE" columnIndex="15"/>
	<result property="edacPrdt" column="EDAC_PRDT" columnIndex="16"/>
	<result property="kybdr" column="KYBDR" columnIndex="17"/>
	<result property="inptDt" column="INPT_DT" columnIndex="18"/>
	<result property="inptAddr" column="INPT_ADDR" columnIndex="19"/>
	<result property="ismt" column="ISMT" columnIndex="20"/>
	<result property="revnDt" column="REVN_DT" columnIndex="21"/>
	<result property="revnAddr" column="REVN_ADDR" columnIndex="22"/>
	<result property="odtyCd" column="ODTY_CD" columnIndex="23"/>
	<result property="pyspCd" column="PYSP_CD" columnIndex="24"/>
	<result property="logSvcYrNumCd" column="LOG_SVC_YR_NUM_CD" columnIndex="25"/>
	<result property="logSvcMnthIcmCd" column="LOG_SVC_MNTH_ICM_CD" columnIndex="26"/>
	<result property="frstEmymtDt" column="FRST_EMYMT_DT" columnIndex="27"/>
	<result property="emymtBgnnDt" column="EMYMT_BGNN_DT" columnIndex="28"/>
	<result property="emymtEndDt" column="EMYMT_END_DT" columnIndex="29"/>
	<result property="hdofcDivCd" column="HDOFC_DIV_CD" columnIndex="30"/>
	<result property="retryDt" column="RETRY_DT" columnIndex="31"/>
	<result property="yrtxApptnYrMnth" column="YRTX_APPTN_YR_MNTH" columnIndex="32"/>
	<result property="yrtxPrcsDt" column="YRTX_PRCS_DT" columnIndex="33"/>
	<result property="yrtxPrcsYn" column="YRTX_PRCS_YN" columnIndex="34"/>
</resultMap>

<select id="ye161010_2018_DAO.selectYeta3300ToYe161010AllList_D" parameterClass="ye161010Srh_2018_Vo" resultMap="allYeta161010_2018">
		SELECT DPOB_CD,
		       YRTX_BLGG_YR,
		       CLUT_SEPT_CD,
		       SYSTEMKEY,
		       PAYR_MANG_DEPT_CD,
		       UT_DPOB_CD,
		       EMYMT_DIV_CD,
		       DEPT_CD,
		       TYP_OCCU_CD,
		       DTIL_OCCU_INTTN_CD,
		       BUSIN_CD,
		       PERN_CHRG_EMP_IDEN_NUM,
		       CLOS_FLAG,
		       CLOS_CONT,
		       CLOS_DATE,
		       EDAC_PRDT,
		       KYBDR,
		       INPT_DT,
		       INPT_ADDR,
		       ISMT,
		       REVN_DT,
		       REVN_ADDR,
		       ODTY_CD,
		       PYSP_CD,
		       LOG_SVC_YR_NUM_CD,
		       LOG_SVC_MNTH_ICM_CD,
		       FRST_EMYMT_DT,
		       EMYMT_BGNN_DT,
		       EMYMT_END_DT,
		       HDOFC_DIV_CD,
		       RETRY_DT,
		       YRTX_APPTN_YR_MNTH,
		       YRTX_PRCS_DT,
		       YRTX_PRCS_YN
		  FROM YE161010
		 WHERE     DPOB_CD = #dpobCd#
		       AND YRTX_BLGG_YR = #yrtxBlggYr#
		       AND CLUT_SEPT_CD = #clutSeptCd#
</select>

<!-- 연말정산신고내역 리스트 YETA0400-->
	<select id="ye161010_2018_DAO.selectYeta0400GridToList_D" parameterClass="ye161010Srh_2018_Vo" resultClass="egovMap">
		SELECT * FROM (
			SELECT A.*, ROWNUM RNUM FROM (    
				   SELECT AA.DPOB_CD,
                   AA.YRTX_BLGG_YR, 
                   AA.SYSTEMKEY,
                   AA.CLUT_SEPT_CD,
                   fcBass0300CDNM (AA.DPOB_CD, AA.CLUT_SEPT_CD) AS SETT_GBNM,
                   BB.DEPT_CD AS DEPT_CD,
                   fcBass0400CDNM (AA.DPOB_CD, BB.DEPT_CD, '2') AS DEPT_NM,
                   AA.TYP_OCCU_CD,
                   fcBass0320CDNM (AA.DPOB_CD, AA.TYP_OCCU_CD) AS TYP_OCCU_NM,
                   AA.DTIL_OCCU_INTTN_CD,
                   fcBassEx0350CDNM (AA.DPOB_CD, AA.TYP_OCCU_CD, AA.DTIL_OCCU_INTTN_CD, '1')AS DTIL_OCCU_INTTN_NM,
                   AA.BUSIN_CD,
                   fcBass0500CDNM (AA.DPOB_CD,  SUBSTR (AA.BUSIN_CD, 1, 4), BB.DEPT_CD, AA.BUSIN_CD)AS BUSIN_NM,
                   BB.EMYMT_DIV_CD,
                   fcBass0300CDNM (BB.DPOB_CD, BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM,
                   BB.HAN_NM,
                   BB.RESN_REGN_NUM,
                   AA.PAYR_MANG_DEPT_CD,
                   fcBass0400CDNM (AA.DPOB_CD, AA.PAYR_MANG_DEPT_CD, '2')
                      AS PAYR_MANG_DEPT_NM,
                   AA.HDOFC_DIV_CD,
                   fcBass0300CDNM (AA.DPOB_CD, AA.HDOFC_DIV_CD) AS HDOFC_DIV_NM,
                   AA01.DTY_STRT_DT,
                   AA01.DTY_END_DT,
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_0C63  ,CC.YETA_0C63    ) AS ITEM01,           /*  C63_정산명세_총급여금액                          */ 
                   (0) AS ITEM02, 
                   
                    DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C162 + NVL(CC01.DCSN_ITAX, 0)   , CC.YETA_C162 + NVL(CC.DCSN_ITAX , 0)  ) AS ITEM03,   	/*  C162_주현근무지_기납부세액_소득세금액                */
					DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C163 + NVL(CC01.DCSN_BTAX, 0)   , CC.YETA_C163 + NVL(CC.DCSN_BTAX , 0)  ) AS ITEM04  ,     /*  C163_주현근무지_기납부세액_지방소득세금액              */
					DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C164 + NVL(CC01.FAFV_TAXI, 0)   , CC.YETA_C164 + NVL(CC.FAFV_TAXI , 0)  ) AS ALRY_YVTX , /*  C164_주현근무지_기납부세액_농특세금액                */ 
                   
             
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_0C81  ,CC.YETA_0C81    ) AS ITEM05,           /*  C81_특별소득공제_보험료_건강보험료                      */
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_0C76  ,CC.YETA_0C76    ) AS ITEM06,           /*  C76_연금보험료_국민연금보험료공제금액                         */
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_0C82  ,CC.YETA_0C82    ) AS ITEM07,           /*  C82_특별소득공제_보험료_고용보험료                      */
                   
                   
                   
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ) AS ITEM08,  /* column 차감징수_소득세 : SUBT_ETAX */ 
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ) AS ITEM09, /* column 차감징수_주민세_지방소득세 : SUBT_INHB */ 
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ) AS SUBT_FAFV,/* column 차감징수_농특세 : SUBT_FAFV */ 
                   
                      (NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0)) AS ITEM10,  /* column 차감징수_세액계 : SUBT_AMSU */ 
                   
                   (0) AS ITEM11,
                   (0) AS ITEM12,
                   (0) AS ITEM13,
                   
                     (NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0)) AS ITEM14 , 
                   
                    DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C159  ,CC.YETA_C159    ) AS ITEM15 ,          /*  C159_결정세액_소득세금액                          */
					DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C160  ,CC.YETA_C160    ) AS ITEM16,           /*  C160_결정세액_지방소득세금액                     */
					DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C161  ,CC.YETA_C161    ) AS YETA_C161           /*  C161_결정세액_농특세금액                       */
					 
              FROM YE161010 AA, 
                   YE161020 AA01, 
                   YE169010 CC ,
                   YE169010A CC01, (
                                     SELECT   DISTINCT   AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                     , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT 
	                                          ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01,  (SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYMT_YR_MNTH, PAYR_SEIL_NUM, PAY_CD,
                                                                           PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PAYR0304
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYYT_YR_MNTH,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                            PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PYYT0304) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                    SELECT   MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                             ) 
									                                          GROUP BY  DPOB_CD,    SYSTEMKEY     
									                                            ) MM  
									                                          
									                                             ) GG
									                            WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                                 /*     AND NN.PAYR_SEIL_NUM =  GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'   
                                             ) BB  , YE161005 DD
             WHERE     BB.SYSTEMKEY = AA.SYSTEMKEY
                   AND BB.DPOB_CD=AA.DPOB_CD  
                    
                   AND CC.SYSTEMKEY = AA.SYSTEMKEY
                   AND CC.YRTX_BLGG_YR = AA.YRTX_BLGG_YR
                   AND CC.CLUT_SEPT_CD = AA.CLUT_SEPT_CD
                   AND CC.DPOB_CD = AA.DPOB_CD
                   
                    AND CC.SYSTEMKEY = AA01.SYSTEMKEY
                   AND CC.YRTX_BLGG_YR = AA01.YRTX_BLGG_YR
                   AND CC.CLUT_SEPT_CD = AA01.CLUT_SEPT_CD
                   AND CC.DPOB_CD=AA01.DPOB_CD   
                   
                   AND AA.SYSTEMKEY  = CC01.SYSTEMKEY(+)
                   AND AA.YRTX_BLGG_YR  = CC01.YRTX_BLGG_YR(+)
                   AND AA.CLUT_SEPT_CD = CC01.CLUT_SEPT_CD(+) 
                   AND  AA.DPOB_CD = CC01.DPOB_CD(+)    
                   
                   AND AA.DPOB_CD = DD.DPOB_CD(+)   
                   AND AA.YRTX_BLGG_YR = DD.YRTX_BLGG_YR(+)
                   AND AA.UT_DPOB_CD = DD.WHDG_TX_REGRST_DEPT_CD(+)

		     	 <isNotEmpty prepend="AND" property="busoprRgstnum" >
							DD.BUSOPR_RGSTNUM(+) = #busoprRgstnum#
				    	</isNotEmpty> 
                       <isNotEmpty prepend="AND" property="utDpobCd" >  
							AA.UT_DPOB_CD=#utDpobCd# 
	          			</isNotEmpty>  
 
                       <isNotEmpty prepend="AND" property="yrtxBlggYr" >
                                     AA.YRTX_BLGG_YR = #yrtxBlggYr#
                                </isNotEmpty>  
                                <isNotEmpty prepend="AND" property="clutSeptCd" >
                                     AA.CLUT_SEPT_CD=#clutSeptCd#
                                </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="systemkey" >
                       AA.SYSTEMKEY=#systemkey#
                      </isNotEmpty> 
                 AND EXISTS  (
                        SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#yrtxBlggYr# )) ) C
                                            WHERE     C.DPOB_CD = BB.DPOB_CD
                                                AND C.DEPT_CD = BB.DEPT_CD
                                                AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
                                                 <isNotEmpty property="deptCd" prepend="AND">
                                                <![CDATA[
                                                 C.DEPT_CD
                                                ]]>
                                                <iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
                                                 #deptCdArr[]#
                                                </iterate>
                                                </isNotEmpty>  
                                          ) 
                       <isNotEmpty prepend="AND" property="businCd" >
                        <![CDATA[
                            BB.BUSIN_CD 
                        ]]>
                        <iterate prepend="IN" property="businCdArr" open="(" close=")" conjunction=",">
                            #businCdArr[]#
                        </iterate>
                          </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                         AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="emymtDivCd" >
                         BB.EMYMT_DIV_CD=#emymtDivCd#
                         </isNotEmpty>  
                     <isNotEmpty property="typOccuCd" prepend="AND">
                    <![CDATA[
                     BB.TYP_OCCU_CD
                    ]]>
                    <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
                     #typOccuCdArr[]#
                    </iterate>
                    </isNotEmpty>  
                  
                    <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
                        <![CDATA[
                             BB.DTIL_OCCU_INTTN_CD
                        ]]>
                        <iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
                             #dtilOccuInttnCdArr[]#
                        </iterate> 
                  </isNotEmpty> 
		               ORDER BY   AA.YRTX_BLGG_YR DESC
		                            , CC.YRTX_BLGG_YR DESC 
		                             ,(SELECT LPAD(DEPT_RANK,5,'0')  
		                                   FROM BASS0400 DD
		                                   WHERE DD.DEPT_CD =  BB.DEPT_CD   
		                                     AND DD.DPOB_CD = BB.DPOB_CD) ASC 
		                            , BB.RESN_REGN_NUM ASC
		                            , AA.SYSTEMKEY DESC   
			    
			    		<![CDATA[					
			) A WHERE ROWNUM <= #lastIndex#
		)WHERE RNUM >= #firstIndex#
		]]>
	</select>


	
	<!-- 연말정산신고내역 갯수 YETA0400 -->
	<select id="ye161010_2018_DAO.selectYeta0400GirdListTotCnt_S" parameterClass="ye161010Srh_2018_Vo" resultClass="int">
			SELECT COUNT(*) totcnt
  			FROM  (
  			    SELECT AA.DPOB_CD,
                   AA.YRTX_BLGG_YR, 
                   AA.SYSTEMKEY,
                   AA.CLUT_SEPT_CD,
                   fcBass0300CDNM (AA.DPOB_CD, AA.CLUT_SEPT_CD) AS SETT_GBNM,
                   BB.DEPT_CD AS DEPT_CD,
                   fcBass0400CDNM (AA.DPOB_CD, BB.DEPT_CD, '2') AS DEPT_NM,
                   AA.TYP_OCCU_CD,
                   fcBass0320CDNM (AA.DPOB_CD, AA.TYP_OCCU_CD) AS TYP_OCCU_NM,
                   AA.DTIL_OCCU_INTTN_CD,
                   fcBassEx0350CDNM (AA.DPOB_CD, AA.TYP_OCCU_CD, AA.DTIL_OCCU_INTTN_CD, '1')AS DTIL_OCCU_INTTN_NM,
                   AA.BUSIN_CD,
                   fcBass0500CDNM (AA.DPOB_CD,  SUBSTR (AA.BUSIN_CD, 1, 4), BB.DEPT_CD, AA.BUSIN_CD)AS BUSIN_NM,
                   BB.EMYMT_DIV_CD,
                   fcBass0300CDNM (BB.DPOB_CD, BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM,
                   BB.HAN_NM,
                   BB.RESN_REGN_NUM,
                   AA.PAYR_MANG_DEPT_CD,
                   fcBass0400CDNM (AA.DPOB_CD, AA.PAYR_MANG_DEPT_CD, '2')
                      AS PAYR_MANG_DEPT_NM,
                   AA.HDOFC_DIV_CD,
                   fcBass0300CDNM (AA.DPOB_CD, AA.HDOFC_DIV_CD) AS HDOFC_DIV_NM,
                   AA01.DTY_STRT_DT, 
                   AA01.DTY_END_DT 
              FROM YE161010 AA, 
            	   YE161020 AA01, 
                   YE169010 CC ,
                   YE169010A CC01 ,(
                                     SELECT   DISTINCT   AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD01.DTIL_OCCU_CLS_DIV_CD,  DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD01.DTIL_OCCU_CLS_DIV_CD,AD01.DTIL_OCCU_CLS_DIV_CD) ) AS DTIL_OCCU_CLS_DIV_CD 
                                             , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01,  (SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYMT_YR_MNTH, PAYR_SEIL_NUM, PAY_CD,
                                                                           PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PAYR0304
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYYT_YR_MNTH,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                            PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PYYT0304) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                     SELECT   MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                             ) 
									                                          GROUP BY  DPOB_CD,    SYSTEMKEY     
									                                            ) MM  
									                                         
									                                             ) GG
									                             WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                                  /*     AND NN.PAYR_SEIL_NUM =  GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'   
                                             ) BB  , YE161005 DD
             WHERE     BB.SYSTEMKEY = AA.SYSTEMKEY
                   AND BB.DPOB_CD=AA.DPOB_CD   
                   AND CC.SYSTEMKEY = AA.SYSTEMKEY
                   AND CC.YRTX_BLGG_YR = AA.YRTX_BLGG_YR
                   AND CC.CLUT_SEPT_CD = AA.CLUT_SEPT_CD
                   AND CC.DPOB_CD=AA.DPOB_CD   
                  AND CC.SYSTEMKEY = AA01.SYSTEMKEY
                   AND CC.YRTX_BLGG_YR = AA01.YRTX_BLGG_YR
                   AND CC.CLUT_SEPT_CD = AA01.CLUT_SEPT_CD
                   AND CC.DPOB_CD=AA01.DPOB_CD    
                   AND AA.SYSTEMKEY  = CC01.SYSTEMKEY(+)
                   AND AA.YRTX_BLGG_YR  = CC01.YRTX_BLGG_YR(+)
                   AND AA.CLUT_SEPT_CD = CC01.CLUT_SEPT_CD(+) 
                   AND  AA.DPOB_CD = CC01.DPOB_CD(+)    
                   AND AA.DPOB_CD = DD.DPOB_CD(+)
                    AND AA.YRTX_BLGG_YR = DD.YRTX_BLGG_YR(+)
               		AND AA.UT_DPOB_CD = DD.WHDG_TX_REGRST_DEPT_CD(+)
                    	 <isNotEmpty prepend="AND" property="busoprRgstnum" >
							DD.BUSOPR_RGSTNUM(+) = #busoprRgstnum#
				    	</isNotEmpty> 
                       <isNotEmpty prepend="AND" property="utDpobCd" >  
							AA.UT_DPOB_CD=#utDpobCd# 
	          			</isNotEmpty>  
                       <isNotEmpty prepend="AND" property="yrtxBlggYr" >
                                     AA.YRTX_BLGG_YR = #yrtxBlggYr#
                                </isNotEmpty>  
                                <isNotEmpty prepend="AND" property="clutSeptCd" >
                                     AA.CLUT_SEPT_CD=#clutSeptCd#
                                </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="systemkey" >
                       AA.SYSTEMKEY=#systemkey#
                      </isNotEmpty> 
                 AND EXISTS  (
                              SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#yrtxBlggYr# ))) C
                                            WHERE     C.DPOB_CD = BB.DPOB_CD
                                                AND C.DEPT_CD = BB.DEPT_CD
                                                AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
                                                 <isNotEmpty property="deptCd" prepend="AND">
                                                <![CDATA[
                                                 C.DEPT_CD
                                                ]]>
                                                <iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
                                                 #deptCdArr[]#
                                                </iterate>
                                                </isNotEmpty>  
                                          ) 
                       <isNotEmpty prepend="AND" property="businCd" >
                        <![CDATA[
                            BB.BUSIN_CD 
                        ]]>
                        <iterate prepend="IN" property="businCdArr" open="(" close=")" conjunction=",">
                            #businCdArr[]#
                        </iterate>
                          </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                         AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="emymtDivCd" >
                         BB.EMYMT_DIV_CD=#emymtDivCd#
                         </isNotEmpty>  
                     <isNotEmpty property="typOccuCd" prepend="AND">
                    <![CDATA[
                     BB.TYP_OCCU_CD
                    ]]>
                    <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
                     #typOccuCdArr[]#
                    </iterate>
                    </isNotEmpty>  
                  
                    <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
                        <![CDATA[
                             BB.DTIL_OCCU_INTTN_CD
                        ]]>
                        <iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
                             #dtilOccuInttnCdArr[]#
                        </iterate> 
                  </isNotEmpty>
  			)  

	</select>
	
	
	
	<!-- 연말정산급여반영 리스트 YETA0500 -->   <!-- AA.DIVD_PYMT_DIV_CD AS divdPymtDivCdcommCd , -->
	<select id="ye161010_2018_DAO.selectYeta0500GridToList_D" parameterClass="ye161010Srh_2018_Vo" resultClass="egovMap">
		SELECT * FROM (
			SELECT A.*, ROWNUM RNUM FROM (    
			    SELECT AA.DPOB_CD,
                   AA.YRTX_BLGG_YR, 
                   AA.SYSTEMKEY,
                   AA.CLUT_SEPT_CD,
                   fcBass0300CDNM (AA.DPOB_CD, AA.CLUT_SEPT_CD) AS SETT_GBNM,
                   BB.DEPT_CD AS DEPT_CD,
                   fcBass0400CDNM (AA.DPOB_CD, BB.DEPT_CD, '2') AS DEPT_NM,
                   AA.TYP_OCCU_CD,
                   fcBass0320CDNM (AA.DPOB_CD, AA.TYP_OCCU_CD) AS TYP_OCCU_NM,
                   AA.DTIL_OCCU_INTTN_CD,
                   fcBassEx0350CDNM (AA.DPOB_CD, AA.TYP_OCCU_CD, AA.DTIL_OCCU_INTTN_CD, '1')AS DTIL_OCCU_INTTN_NM,
                   AA.BUSIN_CD,
                   fcBass0500CDNM (AA.DPOB_CD,  SUBSTR (AA.BUSIN_CD, 1, 4), BB.DEPT_CD, AA.BUSIN_CD)AS BUSIN_NM,
                   BB.EMYMT_DIV_CD,
                   fcBass0300CDNM (BB.DPOB_CD, BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM,
                   BB.HAN_NM,
                   BB.RESN_REGN_NUM,
                   AA.YRTX_APPTN_YR_MNTH,                  
                   AA.YRTX_PRCS_YN,                        
                   AA.YRTX_PRCS_DT,                      
                   AA.DIVD_PYMT_DIV_CD,                   
                   fcBass0300CDNM(AA.DPOB_CD, AA.DIVD_PYMT_DIV_CD) AS DIVD_PYMT_DIV_NM,
                   DECODE(AA.DIVD_PYMT_DIV_CD, '', 'B0300010', AA.DIVD_PYMT_DIV_CD) AS divdPymtDivCdcommCd,  
                   fcBass0300CDNM(AA.DPOB_CD, AA.DIVD_PYMT_DIV_CD) AS divdPymtDivCdcommCdNm ,
                   AA.DIVD_PYMT,                        
                   AA.PAYR_MANG_DEPT_CD,
                   fcBass0400CDNM (AA.DPOB_CD, AA.PAYR_MANG_DEPT_CD, '2')
                      AS PAYR_MANG_DEPT_NM,
                   AA.HDOFC_DIV_CD,
                   fcBass0300CDNM (AA.DPOB_CD, AA.HDOFC_DIV_CD) AS HDOFC_DIV_NM,
                   AA01.DTY_STRT_DT,
                   AA01.DTY_END_DT,
                   
                DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_0C63  ,CC.YETA_0C63    ) AS ITEM01,           /*  C63_정산명세_총급여금액                          */ 
                   (0) AS ITEM02, 
                   
                    DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C162  ,CC.YETA_C162    ) AS ITEM03,           /*  C162_주현근무지_기납부세액_소득세금액                */
					DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C163  ,CC.YETA_C163    ) AS ITEM04  ,         /*  C163_주현근무지_기납부세액_지방소득세금액              */
					DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C164  ,CC.YETA_C164    ) AS ALRY_YVTX ,          /*  C164_주현근무지_기납부세액_농특세금액                */ 
              
             
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_0C81  ,CC.YETA_0C81    ) AS ITEM05,           /*  C81_특별소득공제_보험료_건강보험료                      */
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_0C76  ,CC.YETA_0C76    ) AS ITEM06,           /*  C76_연금보험료_국민연금보험료공제금액                         */
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_0C82  ,CC.YETA_0C82    ) AS ITEM07,           /*  C82_특별소득공제_보험료_고용보험료                      */
                   
                   
                   
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ) AS ITEM08,  /* column 차감징수_소득세 : SUBT_ETAX */ 
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ) AS ITEM09, /* column 차감징수_주민세_지방소득세 : SUBT_INHB */ 
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ) AS SUBT_FAFV,/* column 차감징수_농특세 : SUBT_FAFV */ 
                   
                      (NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0)) AS ITEM10,  /* column 차감징수_세액계 : SUBT_AMSU */ 
                   
                   (0) AS ITEM11,
                   (0) AS ITEM12,
                   (0) AS ITEM13,
                   
                     (NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0)) AS ITEM14 , 
                   
                    DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C159  ,CC.YETA_C159    ) AS ITEM15 ,          /*  C159_결정세액_소득세금액                          */
					DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C160  ,CC.YETA_C160    ) AS ITEM16,           /*  C160_결정세액_지방소득세금액                     */
					DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C161  ,CC.YETA_C161    ) AS YETA_C161           /*  C161_결정세액_농특세금액                       */
             FROM YE161010 AA, 
                   YE161020 AA01, 
                   YE169010 CC ,
                   YE169010A CC01, (	
	
                                     SELECT  DISTINCT    AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD01.DTIL_OCCU_CLS_DIV_CD,  DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD01.DTIL_OCCU_CLS_DIV_CD,AD01.DTIL_OCCU_CLS_DIV_CD) ) AS DTIL_OCCU_CLS_DIV_CD 
                                              , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01,  (SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYMT_YR_MNTH, PAYR_SEIL_NUM, PAY_CD,
                                                                           PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PAYR0304
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYYT_YR_MNTH,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                            PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PYYT0304) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                     SELECT   MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                             ) 
									                                          GROUP BY  DPOB_CD,    SYSTEMKEY     
									                                            ) MM  
									                                          
									                                             ) GG
									                            WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                               /*     AND NN.PAYR_SEIL_NUM =  GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */ 
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'   
                                             ) BB  
             WHERE     BB.SYSTEMKEY = AA.SYSTEMKEY
                   AND BB.DPOB_CD=AA.DPOB_CD   
                   AND CC.SYSTEMKEY = AA.SYSTEMKEY
                   AND CC.YRTX_BLGG_YR = AA.YRTX_BLGG_YR
                   AND CC.CLUT_SEPT_CD = AA.CLUT_SEPT_CD
                   AND CC.DPOB_CD=AA.DPOB_CD   
                    AND CC.SYSTEMKEY = AA01.SYSTEMKEY
                   AND CC.YRTX_BLGG_YR = AA01.YRTX_BLGG_YR
                   AND CC.CLUT_SEPT_CD = AA01.CLUT_SEPT_CD
                   AND CC.DPOB_CD=AA01.DPOB_CD   
                   AND AA.SYSTEMKEY  = CC01.SYSTEMKEY(+)
                   AND AA.YRTX_BLGG_YR  = CC01.YRTX_BLGG_YR(+)
                   AND AA.CLUT_SEPT_CD = CC01.CLUT_SEPT_CD(+) 
                   AND  AA.DPOB_CD = CC01.DPOB_CD(+)    
                   
				   <isNotEmpty prepend="AND" property="yrtxBlggYr" >
						AA.YRTX_BLGG_YR = #yrtxBlggYr#
    				</isNotEmpty>  
            		<isNotEmpty prepend="AND" property="clutSeptCd" >
           				AA.CLUT_SEPT_CD=#clutSeptCd#
            		</isNotEmpty> 
           			<isNotEmpty prepend="AND" property="systemkey" >
              			AA.SYSTEMKEY=#systemkey#
      				</isNotEmpty> 
                 AND EXISTS  (
                           SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#yrtxBlggYr# ))) C
                                            WHERE     C.DPOB_CD = BB.DPOB_CD
                                                AND C.DEPT_CD = BB.DEPT_CD
                                                AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
                                                 <isNotEmpty property="deptCd" prepend="AND">
                                                <![CDATA[
                                                 C.DEPT_CD
                                                ]]>
                                                <iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
                                                 #deptCdArr[]#
                                                </iterate>
                                                </isNotEmpty>  
                                          ) 
                       <isNotEmpty prepend="AND" property="businCd" >
                        <![CDATA[
                            BB.BUSIN_CD 
                        ]]>
                        <iterate prepend="IN" property="businCdArr" open="(" close=")" conjunction=",">
                            #businCdArr[]#
                        </iterate>
                   		</isNotEmpty> 
                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                         AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="emymtDivCd" >
                         BB.EMYMT_DIV_CD=#emymtDivCd#
                         </isNotEmpty>  
                     <isNotEmpty property="typOccuCd" prepend="AND">
                    <![CDATA[
                     BB.TYP_OCCU_CD
                    ]]>
                    <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
                     #typOccuCdArr[]#
                    </iterate>
                    </isNotEmpty>  
                  
                    <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
                        <![CDATA[
                             BB.DTIL_OCCU_INTTN_CD
                        ]]>
                        <iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
                             #dtilOccuInttnCdArr[]#
                        </iterate> 
                  </isNotEmpty> 
                  
                  
                  <isEqual prepend="AND" property="item14" compareValue="Y0100002">
            		<![CDATA[
						DECODE ((NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0)), 0, '', 
     				 (NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0))) >= 100000
					]]>
				  </isEqual>
				  
                  <isEqual prepend="AND" property="item14" compareValue="Y0100003">
           			<![CDATA[
						DECODE ( (NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0)), 0, '', 
     				(NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0))) < 100000
					]]>
				  </isEqual>
				  
                  <isEqual prepend="AND" property="item14" compareValue="Y0100004">
           			<![CDATA[
						DECODE ( (NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0)), 0, '',  
     				(NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0))) <= 0
					]]>
				  </isEqual>
				  
                  <isEqual prepend="AND" property="item14" compareValue="Y0100005">
           			<![CDATA[
					  DECODE ((NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0)), 0, '',
     				 (NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0))) > 0
					]]>
				  </isEqual>
                  
		               ORDER BY   AA.YRTX_BLGG_YR DESC
		                            , CC.YRTX_BLGG_YR DESC 
		                             ,(SELECT LPAD(DEPT_RANK,5,'0')  
		                                   FROM BASS0400 DD
		                                   WHERE DD.DEPT_CD =  BB.DEPT_CD   
		                                     AND DD.DPOB_CD = BB.DPOB_CD) ASC 
		                            , BB.RESN_REGN_NUM ASC
		                            , AA.SYSTEMKEY DESC   
			    
			    		<![CDATA[					
			) A WHERE ROWNUM <= #lastIndex#
		)WHERE RNUM >= #firstIndex#
		]]>
	</select>
	
	<!-- 연말정산급여반영 리스트 Excel -->   <!-- AA.DIVD_PYMT_DIV_CD AS divdPymtDivCdcommCd , -->
	<select id="ye161010_2018_DAO.selectYeta0500ToYeta3000XlsList" parameterClass="ye161010Srh_2018_Vo" resultClass="egovMap">
			    SELECT AA.DPOB_CD,
                   AA.YRTX_BLGG_YR, 
                   AA.SYSTEMKEY,
                   AA.CLUT_SEPT_CD,
                   fcBass0300CDNM (AA.DPOB_CD, AA.CLUT_SEPT_CD) AS SETT_GBNM,
                   BB.DEPT_CD AS DEPT_CD,
                   fcBass0400CDNM (AA.DPOB_CD, BB.DEPT_CD, '2') AS DEPT_NM,
                   AA.TYP_OCCU_CD,
                   fcBass0320CDNM (AA.DPOB_CD, AA.TYP_OCCU_CD) AS TYP_OCCU_NM,
                   AA.DTIL_OCCU_INTTN_CD,
                   fcBassEx0350CDNM (AA.DPOB_CD, AA.TYP_OCCU_CD, AA.DTIL_OCCU_INTTN_CD, '1')AS DTIL_OCCU_INTTN_NM,
                   AA.BUSIN_CD,
                   fcBass0500CDNM (AA.DPOB_CD,  SUBSTR (AA.BUSIN_CD, 1, 4), BB.DEPT_CD, AA.BUSIN_CD)AS BUSIN_NM,
                   BB.EMYMT_DIV_CD,
                   fcBass0300CDNM (BB.DPOB_CD, BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM,
                   BB.HAN_NM,
                   BB.RESN_REGN_NUM,
                   AA.YRTX_APPTN_YR_MNTH,                  
                   AA.YRTX_PRCS_YN,                        
                   AA.YRTX_PRCS_DT,                      
                   AA.DIVD_PYMT_DIV_CD,                   
                   fcBass0300CDNM(AA.DPOB_CD, AA.DIVD_PYMT_DIV_CD) AS DIVD_PYMT_DIV_NM,
                   DECODE(AA.DIVD_PYMT_DIV_CD, '', 'B0300010', AA.DIVD_PYMT_DIV_CD) AS divdPymtDivCdcommCd,  
                   fcBass0300CDNM(AA.DPOB_CD, AA.DIVD_PYMT_DIV_CD) AS divdPymtDivCdcommCdNm ,
                   AA.DIVD_PYMT,                        
                   AA.PAYR_MANG_DEPT_CD,
                   fcBass0400CDNM (AA.DPOB_CD, AA.PAYR_MANG_DEPT_CD, '2')
                      AS PAYR_MANG_DEPT_NM,
                   AA.HDOFC_DIV_CD,
                   fcBass0300CDNM (AA.DPOB_CD, AA.HDOFC_DIV_CD) AS HDOFC_DIV_NM,
                   AA01.DTY_STRT_DT,
                   AA01.DTY_END_DT,
                   
                DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_0C63  ,CC.YETA_0C63    ) AS ITEM01,           /*  C63_정산명세_총급여금액                          */ 
                   (0) AS ITEM02, 
                   
                    DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C162  ,CC.YETA_C162    ) AS ITEM03,           /*  C162_주현근무지_기납부세액_소득세금액                */
					DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C163  ,CC.YETA_C163    ) AS ITEM04  ,         /*  C163_주현근무지_기납부세액_지방소득세금액              */
					DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C164  ,CC.YETA_C164    ) AS ALRY_YVTX ,          /*  C164_주현근무지_기납부세액_농특세금액                */ 
              
             
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_0C81  ,CC.YETA_0C81    ) AS ITEM05,           /*  C81_특별소득공제_보험료_건강보험료                      */
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_0C76  ,CC.YETA_0C76    ) AS ITEM06,           /*  C76_연금보험료_국민연금보험료공제금액                         */
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_0C82  ,CC.YETA_0C82    ) AS ITEM07,           /*  C82_특별소득공제_보험료_고용보험료                      */
                   
                   
                   
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ) AS ITEM08,  /* column 차감징수_소득세 : SUBT_ETAX */ 
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ) AS ITEM09, /* column 차감징수_주민세_지방소득세 : SUBT_INHB */ 
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ) AS SUBT_FAFV,/* column 차감징수_농특세 : SUBT_FAFV */ 
                   
                      (NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0)) AS ITEM10,  /* column 차감징수_세액계 : SUBT_AMSU */ 
                   
                   (0) AS ITEM11,
                   (0) AS ITEM12,
                   (0) AS ITEM13,
                   
                     (NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0)) AS ITEM14 , 
                   
                    DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C159  ,CC.YETA_C159    ) AS ITEM15 ,          /*  C159_결정세액_소득세금액                          */
					DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C160  ,CC.YETA_C160    ) AS ITEM16,           /*  C160_결정세액_지방소득세금액                     */
					DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C161  ,CC.YETA_C161    ) AS YETA_C161           /*  C161_결정세액_농특세금액                       */
             FROM YE161010 AA, 
                   YE161020 AA01, 
                   YE169010 CC ,
                   YE169010A CC01, (	
	
                                     SELECT  DISTINCT    AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD01.DTIL_OCCU_CLS_DIV_CD,  DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD01.DTIL_OCCU_CLS_DIV_CD,AD01.DTIL_OCCU_CLS_DIV_CD) ) AS DTIL_OCCU_CLS_DIV_CD 
                                              , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01,  (SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYMT_YR_MNTH, PAYR_SEIL_NUM, PAY_CD,
                                                                           PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PAYR0304
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYYT_YR_MNTH,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                            PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PYYT0304) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                     SELECT   MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                             ) 
									                                          GROUP BY  DPOB_CD,    SYSTEMKEY     
									                                            ) MM  
									                                          
									                                             ) GG
									                            WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                               /*     AND NN.PAYR_SEIL_NUM =  GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */ 
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'   
                                             ) BB  
             WHERE     BB.SYSTEMKEY = AA.SYSTEMKEY
                   AND BB.DPOB_CD=AA.DPOB_CD   
                   AND CC.SYSTEMKEY = AA.SYSTEMKEY
                   AND CC.YRTX_BLGG_YR = AA.YRTX_BLGG_YR
                   AND CC.CLUT_SEPT_CD = AA.CLUT_SEPT_CD
                   AND CC.DPOB_CD=AA.DPOB_CD   
                    AND CC.SYSTEMKEY = AA01.SYSTEMKEY
                   AND CC.YRTX_BLGG_YR = AA01.YRTX_BLGG_YR
                   AND CC.CLUT_SEPT_CD = AA01.CLUT_SEPT_CD
                   AND CC.DPOB_CD=AA01.DPOB_CD   
                   AND AA.SYSTEMKEY  = CC01.SYSTEMKEY(+)
                   AND AA.YRTX_BLGG_YR  = CC01.YRTX_BLGG_YR(+)
                   AND AA.CLUT_SEPT_CD = CC01.CLUT_SEPT_CD(+) 
                   AND  AA.DPOB_CD = CC01.DPOB_CD(+)    
                   
				   <isNotEmpty prepend="AND" property="yrtxBlggYr" >
						AA.YRTX_BLGG_YR = #yrtxBlggYr#
    				</isNotEmpty>  
            		<isNotEmpty prepend="AND" property="clutSeptCd" >
           				AA.CLUT_SEPT_CD=#clutSeptCd#
            		</isNotEmpty> 
           			<isNotEmpty prepend="AND" property="systemkey" >
              			AA.SYSTEMKEY=#systemkey#
      				</isNotEmpty> 
                 AND EXISTS  (
                           SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#yrtxBlggYr# ))) C
                                            WHERE     C.DPOB_CD = BB.DPOB_CD
                                                AND C.DEPT_CD = BB.DEPT_CD
                                                AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
                                                 <isNotEmpty property="deptCd" prepend="AND">
                                                <![CDATA[
                                                 C.DEPT_CD
                                                ]]>
                                                <iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
                                                 #deptCdArr[]#
                                                </iterate>
                                                </isNotEmpty>  
                                          ) 
                       <isNotEmpty prepend="AND" property="businCd" >
                        <![CDATA[
                            BB.BUSIN_CD 
                        ]]>
                        <iterate prepend="IN" property="businCdArr" open="(" close=")" conjunction=",">
                            #businCdArr[]#
                        </iterate>
                   		</isNotEmpty> 
                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                         AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="emymtDivCd" >
                         BB.EMYMT_DIV_CD=#emymtDivCd#
                         </isNotEmpty>  
                     <isNotEmpty property="typOccuCd" prepend="AND">
                    <![CDATA[
                     BB.TYP_OCCU_CD
                    ]]>
                    <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
                     #typOccuCdArr[]#
                    </iterate>
                    </isNotEmpty>  
                  
                    <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
                        <![CDATA[
                             BB.DTIL_OCCU_INTTN_CD
                        ]]>
                        <iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
                             #dtilOccuInttnCdArr[]#
                        </iterate> 
                  </isNotEmpty> 
                  
                  
                  <isEqual prepend="AND" property="item14" compareValue="Y0100002">
            		<![CDATA[
						DECODE ((NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0)), 0, '', 
     				 (NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0))) >= 100000
					]]>
				  </isEqual>
				  
                  <isEqual prepend="AND" property="item14" compareValue="Y0100003">
           			<![CDATA[
						DECODE ( (NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0)), 0, '', 
     				(NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0))) < 100000
					]]>
				  </isEqual>
				  
                  <isEqual prepend="AND" property="item14" compareValue="Y0100004">
           			<![CDATA[
						DECODE ( (NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0)), 0, '',  
     				(NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0))) <= 0
					]]>
				  </isEqual>
				  
                  <isEqual prepend="AND" property="item14" compareValue="Y0100005">
           			<![CDATA[
					  DECODE ((NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0)), 0, '',
     				 (NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0))) > 0
					]]>
				  </isEqual>
                  
		               ORDER BY   AA.YRTX_BLGG_YR DESC
		                            , CC.YRTX_BLGG_YR DESC 
		                             ,(SELECT LPAD(DEPT_RANK,5,'0')  
		                                   FROM BASS0400 DD
		                                   WHERE DD.DEPT_CD =  BB.DEPT_CD   
		                                     AND DD.DPOB_CD = BB.DPOB_CD) ASC 
		                            , BB.RESN_REGN_NUM ASC
		                            , AA.SYSTEMKEY DESC   
			    
	</select>
			
	
		<!-- 연말정산신고내역 갯수 YETA0500 -->
	<select id="ye161010_2018_DAO.selectYeta0500GirdListTotCnt_S" parameterClass="ye161010Srh_2018_Vo" resultClass="int">
			SELECT COUNT(*) totcnt
  			FROM (
  			 SELECT AA.DPOB_CD,
                   AA.YRTX_BLGG_YR, 
                   AA.SYSTEMKEY,
                   AA.CLUT_SEPT_CD,
                   fcBass0300CDNM (AA.DPOB_CD, AA.CLUT_SEPT_CD) AS SETT_GBNM,
                   BB.DEPT_CD AS DEPT_CD,
                   fcBass0400CDNM (AA.DPOB_CD, BB.DEPT_CD, '2') AS DEPT_NM,
                   AA.TYP_OCCU_CD,
                   fcBass0320CDNM (AA.DPOB_CD, AA.TYP_OCCU_CD) AS TYP_OCCU_NM,
                   AA.DTIL_OCCU_INTTN_CD,
                   fcBassEx0350CDNM (AA.DPOB_CD, AA.TYP_OCCU_CD, AA.DTIL_OCCU_INTTN_CD, '1')AS DTIL_OCCU_INTTN_NM,
                   AA.BUSIN_CD,
                   fcBass0500CDNM (AA.DPOB_CD,  SUBSTR (AA.BUSIN_CD, 1, 4), BB.DEPT_CD, AA.BUSIN_CD)AS BUSIN_NM,
                   BB.EMYMT_DIV_CD,
                   fcBass0300CDNM (BB.DPOB_CD, BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM,
                   BB.HAN_NM,
                   BB.RESN_REGN_NUM,
                   AA.PAYR_MANG_DEPT_CD,
                   fcBass0400CDNM (AA.DPOB_CD, AA.PAYR_MANG_DEPT_CD, '2')
                      AS PAYR_MANG_DEPT_NM,
                   AA.HDOFC_DIV_CD,
                   fcBass0300CDNM (AA.DPOB_CD, AA.HDOFC_DIV_CD) AS HDOFC_DIV_NM,
                   AA01.DTY_STRT_DT,
                   AA01.DTY_END_DT 
                   FROM YE161010 AA, 
                   YE161020 AA01, 
                   YE169010 CC ,
                   YE169010A CC01, (	
                                     SELECT  DISTINCT    AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                 ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD01.DTIL_OCCU_CLS_DIV_CD,  DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD01.DTIL_OCCU_CLS_DIV_CD,AD01.DTIL_OCCU_CLS_DIV_CD) ) AS DTIL_OCCU_CLS_DIV_CD 
                                            , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01,  (SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYMT_YR_MNTH, PAYR_SEIL_NUM, PAY_CD,
                                                                           PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PAYR0304
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYYT_YR_MNTH,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                            PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PYYT0304) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                    SELECT   MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                             ) 
									                                          GROUP BY  DPOB_CD,    SYSTEMKEY     
									                                            ) MM  
									                                          
									                                             ) GG
									                            WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                                /*     AND NN.PAYR_SEIL_NUM = GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'   
                                             ) BB  
             WHERE     BB.SYSTEMKEY = AA.SYSTEMKEY
                   AND BB.DPOB_CD=AA.DPOB_CD   
                   AND CC.SYSTEMKEY = AA.SYSTEMKEY
                   AND CC.YRTX_BLGG_YR = AA.YRTX_BLGG_YR
                   AND CC.CLUT_SEPT_CD = AA.CLUT_SEPT_CD
                   AND CC.DPOB_CD=AA.DPOB_CD   
                      AND CC.SYSTEMKEY = AA01.SYSTEMKEY
                   AND CC.YRTX_BLGG_YR = AA01.YRTX_BLGG_YR
                   AND CC.CLUT_SEPT_CD = AA01.CLUT_SEPT_CD
                   AND CC.DPOB_CD=AA01.DPOB_CD   
                   AND AA.SYSTEMKEY  = CC01.SYSTEMKEY(+)
                   AND AA.YRTX_BLGG_YR  = CC01.YRTX_BLGG_YR(+)
                   AND AA.CLUT_SEPT_CD = CC01.CLUT_SEPT_CD(+) 
                   AND  AA.DPOB_CD = CC01.DPOB_CD(+)    
                   
                       <isNotEmpty prepend="AND" property="yrtxBlggYr" >
                                     AA.YRTX_BLGG_YR = #yrtxBlggYr#
                                </isNotEmpty>  
                                <isNotEmpty prepend="AND" property="clutSeptCd" >
                                     AA.CLUT_SEPT_CD=#clutSeptCd#
                                </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="systemkey" >
                       AA.SYSTEMKEY=#systemkey#
                      </isNotEmpty> 
                 AND EXISTS  (
                             SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#yrtxBlggYr# ))) C
                                            WHERE     C.DPOB_CD = BB.DPOB_CD
                                                AND C.DEPT_CD = BB.DEPT_CD
                                                AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
                                                 <isNotEmpty property="deptCd" prepend="AND">
                                                <![CDATA[
                                                 C.DEPT_CD
                                                ]]>
                                                <iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
                                                 #deptCdArr[]#
                                                </iterate>
                                                </isNotEmpty>  
                                          ) 
                       <isNotEmpty prepend="AND" property="businCd" >
                        <![CDATA[
                            BB.BUSIN_CD 
                        ]]>
                        <iterate prepend="IN" property="businCdArr" open="(" close=")" conjunction=",">
                            #businCdArr[]#
                        </iterate>
                          </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                         AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="emymtDivCd" >
                         BB.EMYMT_DIV_CD=#emymtDivCd#
                         </isNotEmpty>  
                     <isNotEmpty property="typOccuCd" prepend="AND">
                    <![CDATA[
                     BB.TYP_OCCU_CD
                    ]]>
                    <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
                     #typOccuCdArr[]#
                    </iterate>
                    </isNotEmpty>  
                  
                    <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
                        <![CDATA[
                             BB.DTIL_OCCU_INTTN_CD
                        ]]>
                        <iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
                             #dtilOccuInttnCdArr[]#
                        </iterate> 
                  </isNotEmpty>
                  
                     
                  <isEqual prepend="AND" property="item14" compareValue="Y0100002">
            		<![CDATA[
						DECODE ((NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0)), 0, '', 
     				 (NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0))) >= 100000
					]]>
				  </isEqual>
				  
                  <isEqual prepend="AND" property="item14" compareValue="Y0100003">
           			<![CDATA[
						DECODE ( (NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0)), 0, '', 
     				(NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0))) < 100000
					]]>
				  </isEqual>
				  
                  <isEqual prepend="AND" property="item14" compareValue="Y0100004">
           			<![CDATA[
						DECODE ( (NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0)), 0, '',  
     				(NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0))) <= 0
					]]>
				  </isEqual>
				  
                  <isEqual prepend="AND" property="item14" compareValue="Y0100005">
           			<![CDATA[
						DECODE ((NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0)), 0, '',
     				 (NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0))) > 0
					]]>
				  </isEqual>
                  
  			
  			)   

	</select>	
	 
	<!-- 마감처리할 대상자 리스트를 가져온다. -->
	<select id="ye161010_2018_DAO.selectFinYeta3000List" parameterClass="ye161010_2018_Vo" resultClass="egovMap">
		SELECT AA.SYSTEMKEY
              FROM  YE161010 AA,  
                   YE169010 CC , (
                                     SELECT   DISTINCT   AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01,  (SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYMT_YR_MNTH, PAYR_SEIL_NUM, PAY_CD,
                                                                           PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PAYR0304
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYYT_YR_MNTH,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                            PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PYYT0304) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                    SELECT   MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                             ) 
									                                          GROUP BY  DPOB_CD,    SYSTEMKEY     
									                                            ) MM  
									                                          
									                                             ) GG
									                            WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                                 /*     AND NN.PAYR_SEIL_NUM =   GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'   
                                             ) BB  , YE161005 DD
             WHERE     BB.SYSTEMKEY = AA.SYSTEMKEY
                   AND BB.DPOB_CD=AA.DPOB_CD   
                   AND CC.SYSTEMKEY = AA.SYSTEMKEY
                   AND CC.YRTX_BLGG_YR = AA.YRTX_BLGG_YR
                   AND CC.CLUT_SEPT_CD = AA.CLUT_SEPT_CD
                   AND CC.DPOB_CD = AA.DPOB_CD   
                   AND AA.DPOB_CD = DD.DPOB_CD(+)
                   AND AA.UT_DPOB_CD = DD.WHDG_TX_REGRST_DEPT_CD(+)
                  
		     	 <isNotEmpty prepend="AND" property="busoprRgstnum" >
							DD.BUSOPR_RGSTNUM(+) = #busoprRgstnum#
				    	</isNotEmpty> 
                       <isNotEmpty prepend="AND"  property="utDpobCd" >  
							AA.UT_DPOB_CD=#utDpobCd# 
	          			</isNotEmpty>  
                       <isNotEmpty prepend="AND" property="yrtxBlggYr" >
                                     AA.YRTX_BLGG_YR = #yrtxBlggYr#
                                </isNotEmpty>  
                                <isNotEmpty prepend="AND" property="clutSeptCd" >
                                     AA.CLUT_SEPT_CD=#clutSeptCd#
                                </isNotEmpty> 
                 AND EXISTS  (
                        SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#yrtxBlggYr# )) ) C
                                            WHERE     C.DPOB_CD = BB.DPOB_CD
                                                AND C.DEPT_CD = BB.DEPT_CD
                                                AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
                                                 <isNotEmpty property="deptCd" prepend="AND">
                                                <![CDATA[
                                                 C.DEPT_CD
                                                ]]>
                                                <iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
                                                 #deptCdArr[]#
                                                </iterate>
                                                </isNotEmpty>  
                                          ) 
                       <isNotEmpty prepend="AND" property="businCd" >
                        <![CDATA[
                            BB.BUSIN_CD 
                        ]]>
                        <iterate prepend="IN" property="businCdArr" open="(" close=")" conjunction=",">
                            #businCdArr[]#
                        </iterate>
                          </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                         AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="emymtDivCd" >
                         BB.EMYMT_DIV_CD=#emymtDivCd#
                         </isNotEmpty>  
                     <isNotEmpty property="typOccuCd" prepend="AND">
                    <![CDATA[
                     BB.TYP_OCCU_CD
                    ]]>
                    <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
                     #typOccuCdArr[]#
                    </iterate>
                    </isNotEmpty>  
                  
                    <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
                        <![CDATA[
                             BB.DTIL_OCCU_INTTN_CD
                        ]]>
                        <iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
                             #dtilOccuInttnCdArr[]#
                        </iterate> 
                  </isNotEmpty> 
	</select>
		<!-- 연말정산신고파일 마감/풀기 -->
	<update id="ye161010_2018_DAO.finishYeta3000Update_S">
		<![CDATA[
		UPDATE YE161010
			SET CLOS_FLAG=#closFlag#
				, CLOS_DATE=#closDate#
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
		WHERE  DPOB_CD=#dpobCd#
			AND YRTX_BLGG_YR=#yrtxBlggYr#
			AND CLUT_SEPT_CD=#clutSeptCd#
			AND SYSTEMKEY = #systemkey#
		]]>
	</update>
	
	
	<!-- 연말정산신고내역 리스트 YETA0400-->
	<select id="ye161010_2018_DAO.selectYeta0400ToYeta3000XlsList" parameterClass="ye161010Srh_2018_Vo" resultClass="egovMap">
		SELECT AA.DPOB_CD,
                   AA.YRTX_BLGG_YR, 
                   AA.SYSTEMKEY,
                   AA.CLUT_SEPT_CD,
                   fcBass0300CDNM (AA.DPOB_CD, AA.CLUT_SEPT_CD) AS SETT_GBNM,
                   BB.DEPT_CD AS DEPT_CD,
                   fcBass0400CDNM (AA.DPOB_CD, BB.DEPT_CD, '2') AS DEPT_NM,
                   AA.TYP_OCCU_CD,
                   fcBass0320CDNM (AA.DPOB_CD, AA.TYP_OCCU_CD) AS TYP_OCCU_NM,
                   AA.DTIL_OCCU_INTTN_CD,
                   fcBassEx0350CDNM (AA.DPOB_CD, AA.TYP_OCCU_CD, AA.DTIL_OCCU_INTTN_CD, '1')AS DTIL_OCCU_INTTN_NM,
                   AA.BUSIN_CD,
                   fcBass0500CDNM (AA.DPOB_CD,  SUBSTR (AA.BUSIN_CD, 1, 4), BB.DEPT_CD, AA.BUSIN_CD)AS BUSIN_NM,
                   BB.EMYMT_DIV_CD,
                   fcBass0300CDNM (BB.DPOB_CD, BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM,
                   BB.HAN_NM,
                   BB.RESN_REGN_NUM,
                   AA.PAYR_MANG_DEPT_CD,
                   fcBass0400CDNM (AA.DPOB_CD, AA.PAYR_MANG_DEPT_CD, '2')AS PAYR_MANG_DEPT_NM,
                   AA.HDOFC_DIV_CD,
                   fcBass0300CDNM (AA.DPOB_CD, AA.HDOFC_DIV_CD) AS HDOFC_DIV_NM,
                   AA01.DTY_STRT_DT,
                   AA01.DTY_END_DT,
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_0C63  ,CC.YETA_0C63    ) AS ITEM01,           /*  C63_정산명세_총급여금액                          */ 
                   (0) AS ITEM02, 
                   
                    DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C162 + NVL(CC01.DCSN_ITAX, 0)   , CC.YETA_C162 + NVL(CC.DCSN_ITAX , 0)  ) AS ITEM03,   	/*  C162_주현근무지_기납부세액_소득세금액                */
					DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C163 + NVL(CC01.DCSN_BTAX, 0)   , CC.YETA_C163 + NVL(CC.DCSN_BTAX , 0)  ) AS ITEM04  ,     /*  C163_주현근무지_기납부세액_지방소득세금액              */
					DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C164 + NVL(CC01.FAFV_TAXI, 0)   , CC.YETA_C164 + NVL(CC.FAFV_TAXI , 0)  ) AS ALRY_YVTX ,   /*  C164_주현근무지_기납부세액_농특세금액                */ 
              
             
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_0C81  ,CC.YETA_0C81    ) AS ITEM05,           /*  C81_특별소득공제_보험료_건강보험료                      */
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_0C76  ,CC.YETA_0C76    ) AS ITEM06,           /*  C76_연금보험료_국민연금보험료공제금액                         */
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_0C82  ,CC.YETA_0C82    ) AS ITEM07,           /*  C82_특별소득공제_보험료_고용보험료                      */
                   
                   
                   
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ) AS ITEM08,  /* column 차감징수_소득세 : SUBT_ETAX */ 
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ) AS ITEM09, /* column 차감징수_주민세_지방소득세 : SUBT_INHB */ 
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ) AS SUBT_FAFV,/* column 차감징수_농특세 : SUBT_FAFV */ 
                   
                   (NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0)) AS ITEM10,  /* column 차감징수_세액계 : SUBT_AMSU */ 
                   
                   (0) AS ITEM11,
                   (0) AS ITEM12,
                   (0) AS ITEM13,
                   
                     (NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0)) AS ITEM14 , 
                   
                    DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C159  ,CC.YETA_C159    ) AS ITEM15 ,          /*  C159_결정세액_소득세금액                          */
					DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C160  ,CC.YETA_C160    ) AS ITEM16,           /*  C160_결정세액_지방소득세금액                     */
					DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C161  ,CC.YETA_C161    ) AS YETA_C161           /*  C161_결정세액_농특세금액                       */
					 
              FROM YE161010 AA, 
                   YE161020 AA01, 
                   YE169010 CC ,
                   YE169010A CC01,(
                                     SELECT  DISTINCT    AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD01.DTIL_OCCU_CLS_DIV_CD,  DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD01.DTIL_OCCU_CLS_DIV_CD,AD01.DTIL_OCCU_CLS_DIV_CD) ) AS DTIL_OCCU_CLS_DIV_CD 
                                            , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01,  (SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYMT_YR_MNTH, PAYR_SEIL_NUM, PAY_CD,
                                                                           PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PAYR0304
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYYT_YR_MNTH,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                            PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PYYT0304) AD02,
                                                ( 
                                                        SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                     SELECT      MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                            )
									                                              GROUP BY  DPOB_CD,  
                                                                                 SYSTEMKEY 
									                                            ) MM  
									                                              
									                                             ) GG
									                             WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                                /*     AND NN.PAYR_SEIL_NUM = GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'   
                                             ) BB  
             WHERE     BB.SYSTEMKEY = AA.SYSTEMKEY
                   AND BB.DPOB_CD=AA.DPOB_CD   
                   AND CC.SYSTEMKEY = AA.SYSTEMKEY
                   AND CC.YRTX_BLGG_YR = AA.YRTX_BLGG_YR
                   AND CC.CLUT_SEPT_CD = AA.CLUT_SEPT_CD
                   AND CC.DPOB_CD=AA.DPOB_CD   
		           AND CC.SYSTEMKEY = AA01.SYSTEMKEY
                   AND CC.YRTX_BLGG_YR = AA01.YRTX_BLGG_YR
                   AND CC.CLUT_SEPT_CD = AA01.CLUT_SEPT_CD
                   AND CC.DPOB_CD=AA01.DPOB_CD   
                   AND AA.SYSTEMKEY  = CC01.SYSTEMKEY(+)
                   AND AA.YRTX_BLGG_YR  = CC01.YRTX_BLGG_YR(+)
                   AND AA.CLUT_SEPT_CD = CC01.CLUT_SEPT_CD(+) 
                   AND  AA.DPOB_CD = CC01.DPOB_CD(+)    
                  	 <isNotEmpty prepend="AND" property="busoprRgstnum" >
							DD.BUSOPR_RGSTNUM(+) = #busoprRgstnum#
				    	</isNotEmpty> 
                       <isNotEmpty prepend="AND" property="utDpobCd" >  
							AA.UT_DPOB_CD=#utDpobCd# 
	          			</isNotEmpty>  
                       <isNotEmpty prepend="AND" property="yrtxBlggYr" >
                                     AA.YRTX_BLGG_YR = #yrtxBlggYr#
                                </isNotEmpty>  
                                <isNotEmpty prepend="AND" property="clutSeptCd" >
                                     AA.CLUT_SEPT_CD=#clutSeptCd#
                                </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="systemkey" >
                       AA.SYSTEMKEY=#systemkey#
                      </isNotEmpty> 
                 AND EXISTS  (
                             SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#yrtxBlggYr# ))) C
                                            WHERE     C.DPOB_CD = BB.DPOB_CD
                                                AND C.DEPT_CD = BB.DEPT_CD
                                                AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
                                                 <isNotEmpty property="deptCd" prepend="AND">
                                                <![CDATA[
                                                 C.DEPT_CD
                                                ]]>
                                                <iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
                                                 #deptCdArr[]#
                                                </iterate>
                                                </isNotEmpty>  
                                          ) 
                       <isNotEmpty prepend="AND" property="businCd" >
                        <![CDATA[
                            BB.BUSIN_CD 
                        ]]>
                        <iterate prepend="IN" property="businCdArr" open="(" close=")" conjunction=",">
                            #businCdArr[]#
                        </iterate>
                          </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                         AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="emymtDivCd" >
                         BB.EMYMT_DIV_CD=#emymtDivCd#
                         </isNotEmpty>  
                     <isNotEmpty property="typOccuCd" prepend="AND">
                    <![CDATA[
                     BB.TYP_OCCU_CD
                    ]]>
                    <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
                     #typOccuCdArr[]#
                    </iterate>
                    </isNotEmpty>  
                  
                    <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
                        <![CDATA[
                             BB.DTIL_OCCU_INTTN_CD
                        ]]>
                        <iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
                             #dtilOccuInttnCdArr[]#
                        </iterate> 
                  </isNotEmpty> 
		               ORDER BY   AA.YRTX_BLGG_YR DESC
		                            , CC.YRTX_BLGG_YR DESC 
		                             ,(SELECT LPAD(DEPT_RANK,5,'0')  
		                                   FROM BASS0400 DD
		                                   WHERE DD.DEPT_CD =  BB.DEPT_CD   
		                                     AND DD.DPOB_CD = BB.DPOB_CD) ASC 
		                            , BB.RESN_REGN_NUM ASC
		                            , AA.SYSTEMKEY DESC   
	</select>
	
	<!-- 연말정산대상자관리 엑셀출력 2018 -->
	<select id="ye161010_2018_DAO.selectYeta3500ToYeta3000XlsList" parameterClass="ye161010Srh_2018_Vo" resultClass="egovMap">
 	SELECT AA.DPOB_CD,
                   AA.YRTX_BLGG_YR, 
                   AA.SYSTEMKEY,
                   AA.CLUT_SEPT_CD,
                   fcBass0300CDNM (AA.DPOB_CD, AA.CLUT_SEPT_CD) AS SETT_GBNM,
                   BB.DEPT_CD AS DEPT_CD,
                   fcBass0400CDNM (AA.DPOB_CD, BB.DEPT_CD, '2') AS DEPT_NM,
                   AA.TYP_OCCU_CD,
                   fcBass0320CDNM (AA.DPOB_CD, AA.TYP_OCCU_CD) AS TYP_OCCU_NM,
                   AA.DTIL_OCCU_INTTN_CD,
                   fcBassEx0350CDNM (AA.DPOB_CD, AA.TYP_OCCU_CD, AA.DTIL_OCCU_INTTN_CD, '1')AS DTIL_OCCU_INTTN_NM,
                   AA.BUSIN_CD,
                   fcBass0500CDNM (AA.DPOB_CD,  SUBSTR (AA.BUSIN_CD, 1, 4), BB.DEPT_CD, AA.BUSIN_CD)AS BUSIN_NM,
                   BB.EMYMT_DIV_CD,
                   fcBass0300CDNM (BB.DPOB_CD, BB.EMYMT_DIV_CD) AS EMYMT_DIV_NM,
                   BB.HAN_NM,
                   BB.RESN_REGN_NUM,
                   AA.YRTX_APPTN_YR_MNTH,                  
                   AA.YRTX_PRCS_YN,                        
                   AA.YRTX_PRCS_DT,                      
                   AA.DIVD_PYMT_DIV_CD,                   
                   fcBass0300CDNM(AA.DPOB_CD, AA.DIVD_PYMT_DIV_CD) AS DIVD_PYMT_DIV_NM,
                   AA.DIVD_PYMT_DIV_CD AS divdPymtDivCdcommCd ,
                   fcBass0300CDNM(AA.DPOB_CD, AA.DIVD_PYMT_DIV_CD) AS divdPymtDivCdcommCdNm ,
                   AA01.DIVD_PYMT,                        
                   AA01.PAYR_MANG_DEPT_CD,
                   fcBass0400CDNM (AA.DPOB_CD, AA.PAYR_MANG_DEPT_CD, '2')
                      AS PAYR_MANG_DEPT_NM,
                   AA.HDOFC_DIV_CD,
                   fcBass0300CDNM (AA.DPOB_CD, AA.HDOFC_DIV_CD) AS HDOFC_DIV_NM,
                   AA.DTY_STRT_DT,
                   AA.DTY_END_DT,
                    DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_0C63  ,CC.YETA_0C63    ) AS ITEM01,           /*  C63_정산명세_총급여금액                          */ 
                   (0) AS ITEM02, 
                   
                    DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C162  ,CC.YETA_C162    ) AS ITEM03,           /*  C162_주현근무지_기납부세액_소득세금액                */
					DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C163  ,CC.YETA_C163    ) AS ITEM04  ,         /*  C163_주현근무지_기납부세액_지방소득세금액              */
					DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C164  ,CC.YETA_C164    ) AS ALRY_YVTX ,          /*  C164_주현근무지_기납부세액_농특세금액                */ 
              
             
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_0C81  ,CC.YETA_0C81    ) AS ITEM05,           /*  C81_특별소득공제_보험료_건강보험료                      */
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_0C76  ,CC.YETA_0C76    ) AS ITEM06,           /*  C76_연금보험료_국민연금보험료공제금액                         */
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_0C82  ,CC.YETA_0C82    ) AS ITEM07,           /*  C82_특별소득공제_보험료_고용보험료                      */
                   
                   
                   
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ) AS ITEM08,  /* column 차감징수_소득세 : SUBT_ETAX */ 
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ) AS ITEM09, /* column 차감징수_주민세_지방소득세 : SUBT_INHB */ 
                   DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ) AS SUBT_FAFV,/* column 차감징수_농특세 : SUBT_FAFV */ 
                   
                   (NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0)) AS ITEM10,  /* column 차감징수_세액계 : SUBT_AMSU */ 
                   
                   (0) AS ITEM11,
                   (0) AS ITEM12,
                   (0) AS ITEM13,
                   
                     (NVL( DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C168  ,CC.YETA_C168 ),0)
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C169  ,CC.YETA_C169 ),0) 
     				+ NVL(DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C170  ,CC.YETA_C170 ),0)) AS ITEM14 , 
                   
                    DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C159  ,CC.YETA_C159    ) AS ITEM15 ,          /*  C159_결정세액_소득세금액                          */
					DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C160  ,CC.YETA_C160    ) AS ITEM16,           /*  C160_결정세액_지방소득세금액                     */
					DECODE(AA01.C152_STD_TX_DDC_YN,'Y',CC01.YETA_STD_C161  ,CC.YETA_C161    ) AS YETA_C161           /*  C161_결정세액_농특세금액                       */
					 
              FROM YE161010 AA, 
                   YE161020 AA01, 
                   YE169010 CC ,
                   YE169010A CC01, (
                                     SELECT   DISTINCT  AD02.DPOB_CD
                                              ,AD02.SYSTEMKEY
                                              ,AD02.PAYR_MANG_DEPT_CD
                                              ,AD02.EMYMT_DIV_CD
                                              ,AD02.HAN_NM
                                              ,AD02.RESN_REGN_NUM
                                              ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DEPT_CD,DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DEPT_CD,AD01.CURR_AFFN_DEPT_CD)) AS DEPT_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.BUSIN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.BUSIN_CD,AD01.BUSIN_CD) ) AS BUSIN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.TYP_OCCU_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.TYP_OCCU_CD,AD01.TYP_OCCU_CD) ) AS TYP_OCCU_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD02.DTIL_OCCU_INTTN_CD, DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD02.DTIL_OCCU_INTTN_CD,AD01.DTIL_OCCU_INTTN_CD) ) AS DTIL_OCCU_INTTN_CD 
							                  ,DECODE (AD02.EMYMT_DIV_CD, 'A0020020', AD01.DTIL_OCCU_CLS_DIV_CD,  DECODE(AD01.EMYMT_DIV_CD,'A0020020',AD01.DTIL_OCCU_CLS_DIV_CD,AD01.DTIL_OCCU_CLS_DIV_CD) ) AS DTIL_OCCU_CLS_DIV_CD 
                                             , DECODE (AD02.ODTY_CD,AD01.ODTY_CD, AD01.ODTY_CD,AD01.ODTY_CD) AS ODTY_CD 
												, DECODE (AD02.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD, AD01.PYSP_CD) AS PYSP_CD  
												, DECODE (AD02.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD, AD01.LOG_SVC_YR_NUM_CD) AS LOG_SVC_YR_NUM_CD 
												, DECODE (AD02.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD, AD01.LOG_SVC_MNTH_ICM_CD) AS LOG_SVC_MNTH_ICM_CD 
												, DECODE (AD02.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT, AD01.FRST_EMYMT_DT) AS FRST_EMYMT_DT 
												, DECODE (AD02.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT, AD01.EMYMT_BGNN_DT) AS EMYMT_BGNN_DT 
												, DECODE (AD02.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT, AD01.EMYMT_END_DT) AS EMYMT_END_DT
                                              ,AD01.NATN_CD
                                              ,AD01.HDOFC_CODTN_CD
                                              ,AD01.RETRY_DT 
                                                  FROM PSNL0100 AD01,  (SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYMT_YR_MNTH, PAYR_SEIL_NUM, PAY_CD,
                                                                           PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PAYR0304
                                                                        UNION ALL
                                                                        SELECT 
                                                                           DPOB_CD ,SYSTEMKEY ,PYYT_YR_MNTH,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
                                                                            PAYR_MANG_DEPT_CD ,EMYMT_DIV_CD,HAN_NM ,RESN_REGN_NUM ,DEPT_CD  ,BUSIN_CD ,TYP_OCCU_CD 
                                                                           ,DTIL_OCCU_INTTN_CD ,ODTY_CD ,PYSP_CD ,LOG_SVC_YR_NUM_CD 
                                                                           ,LOG_SVC_MNTH_ICM_CD ,FRST_EMYMT_DT ,EMYMT_BGNN_DT,EMYMT_END_DT  
                                                                        FROM PYYT0304) AD02,
                                                (  SELECT NN.DPOB_CD,
									                               NN.PYMT_YR_MNTH,
									                               NN.PAY_CD,
									                               NN.SYSTEMKEY,
									                               NN.PAYR_SEIL_NUM
									                     FROM    
									                     (SELECT           DPOB_CD,
										                                       PYMT_YR_MNTH,
										                                       PAY_CD,
										                                       SYSTEMKEY,
										                                       MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM  
										                                  FROM (SELECT 
																			   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																			   PAY_CD,  PAYR_MANG_DEPT_CD, 
																			   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																			   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																			     ODTY_CD, PYSP_CD, 
																			     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PAYR0304 
																			UNION ALL
																			SELECT 
																			   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																			   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																			   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																			   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																			   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																			   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																			   HDOFC_DIV_CD, RETRY_DT 
																			FROM  PYYT0304) PAYR0304
										                                 WHERE     PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'  
										                                     GROUP BY  DPOB_CD,  PYMT_YR_MNTH,
                                                                           PAY_CD, SYSTEMKEY
									                                 ) NN,
									                                  (  
									                                   SELECT        MM.DPOB_CD,
									                                                 MM.PYMT_YR_MNTH ,
									                                                 MM.PAY_CD , 
									                                                 MM.SYSTEMKEY ,
									                                                 MM.PAYR_SEIL_NUM ,    MM.SEL_NUM
									                                     FROM    
									                                     (  
									                                     SELECT      MAX(SEL_NUM)   AS SEL_NUM,
												                                         DPOB_CD,
												                                         MAX(PYMT_YR_MNTH) AS PYMT_YR_MNTH,
												                                         MAX(PAY_CD) AS PAY_CD,
												                                         SYSTEMKEY,
												                                         MAX(PAYR_SEIL_NUM) AS PAYR_SEIL_NUM
									                                     FROM 
									                                      (SELECT  ROW_NUMBER ()
									                                                 OVER (ORDER BY
									                                                          DPOB_CD,
									                                                          SYSTEMKEY,
									                                                          PYMT_YR_MNTH ASC,
									                                                          PAY_CD ASC,
									                                                          PAYR_SEIL_NUM DESC) AS SEL_NUM,
									                                                 DPOB_CD,
									                                                 PYMT_YR_MNTH ,
									                                                 PAY_CD , 
									                                                 SYSTEMKEY ,
									                                                 PAYR_SEIL_NUM
									                                            FROM (SELECT 
																		   DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY,  PAYR_SEIL_NUM,
																		   PAY_CD,  PAYR_MANG_DEPT_CD, 
																		   EMYMT_DIV_CD, HAN_NM, RESN_REGN_NUM, 
																		   DEPT_CD, BUSIN_CD, TYP_OCCU_CD,   DTIL_OCCU_INTTN_CD,
																		     ODTY_CD, PYSP_CD, 
																		     LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PAYR0304 
																		UNION ALL
																		SELECT 
																		   DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY,  (0) AS PAYR_SEIL_NUM,('B0150000') AS PAY_CD,
																		   PAYR_MANG_DEPT_CD, EMYMT_DIV_CD, HAN_NM, 
																		   RESN_REGN_NUM, DEPT_CD, BUSIN_CD, 
																		   TYP_OCCU_CD, DTIL_OCCU_INTTN_CD, ODTY_CD, 
																		   PYSP_CD, LOG_SVC_YR_NUM_CD, LOG_SVC_MNTH_ICM_CD, 
																		   FRST_EMYMT_DT, EMYMT_BGNN_DT, EMYMT_END_DT, 
																		   HDOFC_DIV_CD, RETRY_DT 
																		FROM  PYYT0304) PAYR0304   
																		 WHERE   PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                   AND (SYSTEMKEY,PYMT_YR_MNTH) IN (
																	                      SELECT SYSTEMKEY, MAX(PYMT_YR_MNTH)
																	                        FROM 
																	                         (SELECT DPOB_CD, PYMT_YR_MNTH, SYSTEMKEY
																	                         FROM PAYR0304
																	                         UNION ALL
																	                         SELECT DPOB_CD, PYYT_YR_MNTH, SYSTEMKEY
																	                         FROM PYYT0304) NNAA 
																	                        WHERE  NNAA.DPOB_CD = PAYR0304.DPOB_CD 
																	                          AND NNAA.PYMT_YR_MNTH = PAYR0304.PYMT_YR_MNTH
																	                          AND NNAA.SYSTEMKEY = PAYR0304.SYSTEMKEY
																	                          AND NNAA.PYMT_YR_MNTH  LIKE #yrtxBlggYr# ||'%'  
																	                          GROUP BY SYSTEMKEY
																      )
									                                            )
									                                              GROUP BY  DPOB_CD,  
                                                                                 SYSTEMKEY
									                                            ) MM  
									                                             
									                                             ) GG
									                             WHERE     NN.DPOB_CD = GG.DPOB_CD
                                         AND NN.SYSTEMKEY = GG.SYSTEMKEY 
                                         AND NN.PYMT_YR_MNTH = GG.PYMT_YR_MNTH
                                               /*     AND NN.PAYR_SEIL_NUM =  GG.PAYR_SEIL_NUM
                                                  AND NN.PAY_CD = GG.PAY_CD  */
                                                                            ) AD03 
                                               WHERE   AD02.DPOB_CD = AD01.DPOB_CD
                                                 AND AD02.SYSTEMKEY = AD01.SYSTEMKEY
                                                 AND AD02.DPOB_CD  = AD03.DPOB_CD
                                                 AND AD02.PYMT_YR_MNTH  = AD03.PYMT_YR_MNTH
                                                 AND AD02.SYSTEMKEY  = AD03.SYSTEMKEY  
                                                   AND AD02.PAY_CD  = AD03.PAY_CD
                                                 AND AD02.PAYR_SEIL_NUM  = AD03.PAYR_SEIL_NUM  
                                                  AND AD02.PYMT_YR_MNTH LIKE #yrtxBlggYr# ||'%'   
                                             ) BB  
             WHERE     BB.SYSTEMKEY = AA.SYSTEMKEY
                   AND BB.DPOB_CD=AA.DPOB_CD   
                   AND CC.SYSTEMKEY = AA.SYSTEMKEY
                   AND CC.YRTX_BLGG_YR = AA.YRTX_BLGG_YR
                   AND CC.CLUT_SEPT_CD = AA.CLUT_SEPT_CD
                   AND CC.DPOB_CD=AA.DPOB_CD   
		       AND CC.SYSTEMKEY = AA01.SYSTEMKEY
                   AND CC.YRTX_BLGG_YR = AA01.YRTX_BLGG_YR
                   AND CC.CLUT_SEPT_CD = AA01.CLUT_SEPT_CD
                   AND CC.DPOB_CD=AA01.DPOB_CD   
                   AND AA.SYSTEMKEY  = CC01.SYSTEMKEY(+)
                   AND AA.YRTX_BLGG_YR  = CC01.YRTX_BLGG_YR(+)
                   AND AA.CLUT_SEPT_CD = CC01.CLUT_SEPT_CD(+) 
                   AND  AA.DPOB_CD = CC01.DPOB_CD(+)    
                       <isNotEmpty prepend="AND" property="yrtxBlggYr" >
                                     AA.YRTX_BLGG_YR = #yrtxBlggYr#
                                </isNotEmpty>  
                                <isNotEmpty prepend="AND" property="clutSeptCd" >
                                     AA.CLUT_SEPT_CD=#clutSeptCd#
                                </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="systemkey" >
                       AA.SYSTEMKEY=#systemkey#
                      </isNotEmpty> 
                 AND EXISTS  (
                               SELECT  C.DPOB_CD,
                                 C.DTIL_OCCU_INTTN_CD,
                                 C.TYP_OCCU_CD,
                                 C.DEPT_CD FROM 
                                             (SELECT * 
                                                 FROM TABLE(PKG_DTIL_AUTH.FN_DTIL_AUTH_TB(#dpobCd#,#payrMangDeptYn#,#payrMangDeptCd#,#deptCd#,#usrId#,#deptCdAuth#,#yrtxBlggYr# ))) C
                                            WHERE     C.DPOB_CD = BB.DPOB_CD
                                                AND C.DEPT_CD = BB.DEPT_CD
                                                AND NVL(C.TYP_OCCU_CD,'TT')  = NVL(BB.TYP_OCCU_CD,'TT') 
                                                AND NVL(C.DTIL_OCCU_INTTN_CD,'TT')  = NVL(BB.DTIL_OCCU_INTTN_CD,'TT')
                                                 <isNotEmpty property="deptCd" prepend="AND">
                                                <![CDATA[
                                                 C.DEPT_CD
                                                ]]>
                                                <iterate prepend="IN" property="deptCdArr" open="(" close=")" conjunction=",">
                                                 #deptCdArr[]#
                                                </iterate>
                                                </isNotEmpty>  
                                          ) 
                       <isNotEmpty prepend="AND" property="businCd" >
                        <![CDATA[
                            BB.BUSIN_CD 
                        ]]>
                        <iterate prepend="IN" property="businCdArr" open="(" close=")" conjunction=",">
                            #businCdArr[]#
                        </iterate>
                          </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="payrMangDeptCd" >
                         AA.PAYR_MANG_DEPT_CD=#payrMangDeptCd#
                       </isNotEmpty> 
                       <isNotEmpty prepend="AND" property="emymtDivCd" >
                         BB.EMYMT_DIV_CD=#emymtDivCd#
                         </isNotEmpty>  
                     <isNotEmpty property="typOccuCd" prepend="AND">
                    <![CDATA[
                     BB.TYP_OCCU_CD
                    ]]>
                    <iterate prepend="IN" property="typOccuCdArr" open="(" close=")" conjunction=",">
                     #typOccuCdArr[]#
                    </iterate>
                    </isNotEmpty>  
                  
                    <isNotEmpty property="dtilOccuInttnCd" prepend="AND">
                        <![CDATA[
                             BB.DTIL_OCCU_INTTN_CD
                        ]]>
                        <iterate prepend="IN" property="dtilOccuInttnCdArr" open="(" close=")" conjunction=",">
                             #dtilOccuInttnCdArr[]#
                        </iterate> 
                  </isNotEmpty> 
		               ORDER BY   AA.YRTX_BLGG_YR DESC
		                            , CC.YRTX_BLGG_YR DESC 
		                             ,(SELECT LPAD(DEPT_RANK,5,'0')  
		                                   FROM BASS0400 DD
		                                   WHERE DD.DEPT_CD =  BB.DEPT_CD   
		                                     AND DD.DPOB_CD = BB.DPOB_CD) ASC 
		                            , BB.RESN_REGN_NUM ASC
		                            , AA.SYSTEMKEY DESC  
	</select>	
	
	
	<!-- 당월급여반영 form : YETA0500
	, DIVD_PYMT_DIV_CD = #divdPymtDivCd#
				, DIVD_PYMT=#divdPymt# -->
	<update id="ye161010_2018_DAO.activityOnYeta0500Update">
		<![CDATA[
			UPDATE YE161010
			SET YRTX_APPTN_YR_MNTH = #yrtxApptnYrMnth#
				, YRTX_PRCS_DT = #yrtxPrcsDt#
				, YRTX_PRCS_YN = #yrtxPrcsYn#
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
			WHERE DPOB_CD=#dpobCd#
				AND YRTX_BLGG_YR=#yrtxBlggYr#
				AND CLUT_SEPT_CD=#clutSeptCd#
				AND SYSTEMKEY=#systemkey#
		]]>
	</update>
	
	<!-- 분할납부코드 수정 form : YETA0500 -->
	<update id="ye161010_2018_DAO.updateYeta0500To2000_Y">
		<![CDATA[
			UPDATE YE161010
			SET DIVD_PYMT_DIV_CD = #divdPymtDivCd# 
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
			WHERE DPOB_CD=#dpobCd#
				AND YRTX_BLGG_YR=#yrtxBlggYr#
				AND CLUT_SEPT_CD=#clutSeptCd#
				AND SYSTEMKEY=#systemkey#
		]]>
	</update>
	
		<!-- 분할납부코드 수정 form : YETA0500 -->
	<update id="ye161010_2018_DAO.updateYeta0500To2000_N">
		<![CDATA[
			UPDATE YE161010
			SET DIVD_PYMT_DIV_CD = #divdPymtDivCd#
			    , DIVD_PYMT=#divdPymt#
				, ISMT=#ismt#
				, REVN_DT=TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
				, REVN_ADDR=#revnAddr#
			WHERE DPOB_CD=#dpobCd#
				AND YRTX_BLGG_YR=#yrtxBlggYr#
				AND CLUT_SEPT_CD=#clutSeptCd#
				AND SYSTEMKEY=#systemkey#
		]]>
	</update>
	
	
</sqlMap>
