<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="Ye16Ta3900">

    <typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="ye16Ta3900VO" type="com.app.exterms.yearendtax.server.vo.Yeta3900VO"/>

	<resultMap id="ye16Ta3900" class="com.app.exterms.yearendtax.server.vo.Yeta3900VO">
		<result property="dpobCd" column="DPOB_CD" columnIndex="1"/>
		<result property="pymtYrMnth" column="PYMT_YR_MNTH" columnIndex="2"/>
		<result property="payCd" column="PAY_CD" columnIndex="3"/>
		<result property="resnRegnNum" column="RESN_REGN_NUM" columnIndex="4"/>
		<result property="payItemCd" column="PAY_ITEM_CD" columnIndex="5"/>
		<result property="payItemSeilNum" column="PAY_ITEM_SEIL_NUM" columnIndex="6"/>
		<result property="systemkey" column="SYSTEMKEY" columnIndex="7"/>
		<result property="pymtDducDivCd" column="PYMT_DDUC_DIV_CD" columnIndex="8"/>
		<result property="pymtDducSum" column="PYMT_DDUC_SUM" columnIndex="9"/>
		<result property="pymtDducTxtnAmnt" column="PYMT_DDUC_TXTN_AMNT" columnIndex="10"/>
		<result property="pymtDducFreeDtySum" column="PYMT_DDUC_FREE_DTY_SUM" columnIndex="11"/>
		<result property="payPymtDt" column="PAY_PYMT_DT" columnIndex="12"/>
		<result property="payItemNm" column="PAY_ITEM_NM" columnIndex="13"/>
		<result property="kybdr" column="KYBDR" columnIndex="14"/>
		<result property="inptDt" column="INPT_DT" columnIndex="15"/>
		<result property="inptAddr" column="INPT_ADDR" columnIndex="16"/>
		<result property="ismt" column="ISMT" columnIndex="17"/>
		<result property="revnDt" column="REVN_DT" columnIndex="18"/>
		<result property="revnAddr" column="REVN_ADDR" columnIndex="19"/>
	</resultMap>
	
	<!-- 엑셀업로드(JXLS 사용)  -->
<insert id="ye16Ta3900DAO.insertXlsYeta3900_S">
		<![CDATA[
			INSERT INTO YETA3900 
				( DPOB_CD
					  , PYMT_YR_MNTH
					  , PAY_CD
					  , RESN_REGN_NUM
					  , PAY_ITEM_CD
					  , PAY_ITEM_SEIL_NUM
					  , SYSTEMKEY
					  , PYMT_DDUC_DIV_CD
					  , PYMT_DDUC_SUM
					  , PYMT_DDUC_TXTN_AMNT
					  , PYMT_DDUC_FREE_DTY_SUM
					  , PAY_PYMT_DT
					  , PAY_ITEM_NM
					  , KYBDR
					  , INPT_DT
					  , INPT_ADDR
					  , ISMT
					  , REVN_DT
					  , REVN_ADDR )
				VALUES (#dpobCd#
					  ,#pymtYrMnth#
					  ,#payCd#
					  ,#resnRegnNum#
					  ,#payItemCd#
					  ,#payItemSeilNum#
					  ,(SELECT SYSTEMKEY FROM PSNL0100 
						WHERE 
							RESN_REGN_NUM = REPLACE(#resnRegnNum#,'-',''))
					  ,#pymtDducDivCd#
					  ,#pymtDducSum#
					  ,#pymtDducTxtnAmnt#
					  ,#pymtDducFreeDtySum#
					  ,#payPymtDt#
					  ,#payItemNm#
					  , #kybdr#
					  , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
					  , #inptAddr#
					  , #ismt#
					  , TO_CHAR(SYSDATE,'YYYYMMDDHHMISS')
					  , #revnAddr#
					  )
		]]>
	</insert>
	
	<delete id="ye16Ta3900DAO.deleteXlsYeta3900_S">
		<![CDATA[
			DELETE FROM 	YETA3900
						WHERE SYSTEMKEY = (SELECT SYSTEMKEY FROM YETA3900 
						  					          WHERE 
						  						               RESN_REGN_NUM = REPLACE(#resnRegnNum#,'-',''))
						                                       AND PYMT_YR_MNTH=#pymtYrMnth#
       ]]>                    
	</delete>	
	
</sqlMap>