<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="PGRM_Payr0400">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="prgmPayr0400SrhVO" type="com.app.exterms.prgm.server.vo.PrgmPayr0400SrhVO"/>
	
	<resultMap id="prgmPayr0400" class="com.app.exterms.prgm.server.vo.PrgmPayr0400VO">
		<result property="dpobCd" column="DPOB_CD" columnIndex="1"/>
		<result property="typOccuGrdeMppgSeilNum" column="TYP_OCCU_GRDE_MPPG_SEIL_NUM" columnIndex="2"/>
		<result property="typOccuCd" column="TYP_OCCU_CD" columnIndex="3"/>
		<result property="dtilOccuClsDivCd" column="DTIL_OCCU_CLS_DIV_CD" columnIndex="4"/>
		<result property="pyspGrdeCd" column="PYSP_GRDE_CD" columnIndex="5"/>
		<result property="typOccuGrdeMppgCtnt" column="TYP_OCCU_GRDE_MPPG_CTNT" columnIndex="6"/>
		<result property="typOccuGrdeMppgDelYn" column="TYP_OCCU_GRDE_MPPG_DEL_YN" columnIndex="7"/>
		<result property="kybdr" column="KYBDR" columnIndex="8"/>
		<result property="inptDt" column="INPT_DT" columnIndex="9"/>
		<result property="inptAddr" column="INPT_ADDR" columnIndex="10"/>
		<result property="ismt" column="ISMT" columnIndex="11"/>
		<result property="revnDt" column="REVN_DT" columnIndex="12"/>
		<result property="revnAddr" column="REVN_ADDR" columnIndex="13"/>
	</resultMap>
	 
	
	<select id="prgmPayr0400DAO.selectPrgmPayr0400TypOccuCdList_D" parameterClass="prgmPayr0400SrhVO" resultClass="egovMap">
		SELECT * FROM (
			SELECT A.*, ROWNUM RNUM FROM (
						SELECT
									DISTINCT DPOB_CD
										, TYP_OCCU_CD
									    , (fcBass0300CDNM(DPOB_CD,TYP_OCCU_CD) || DECODE(PYSP_GRDE_CD, 'A0060000','','[' || fcBass0300CDNM(DPOB_CD,PYSP_GRDE_CD) || ']' )) AS TYP_OCCU_NM
		                                , PYSP_GRDE_CD
										, fcBass0300CDNM(#dpobCd#,PYSP_GRDE_CD) AS PYSP_GRDE_NM 
								FROM PAYR0400
						WHERE  TYP_OCCU_GRDE_MPPG_DEL_YN = 'N'
					  	<isNotEmpty prepend="AND" property="dpobCd" >
					 		DPOB_CD=#dpobCd#
				       	</isNotEmpty> 
							ORDER BY  DPOB_CD ASC
									, TYP_OCCU_CD ASC 
									, PYSP_GRDE_CD ASC
				
		<isNotEqual  property="lastIndex" compareValue="-1">
			 <![CDATA[					
				) A WHERE ROWNUM <= #lastIndex#
			)WHERE RNUM >= #firstIndex#
			]]>
		</isNotEqual>
			
		<isEqual   property="lastIndex" compareValue="-1">
			  <![CDATA[					
				) A  
			)
			]]>
		</isEqual>
	</select>	
	
	<select id="prgmPayr0400DAO.selectPrgmPayr0400TypOccuCdListTotCnt_S" parameterClass="prgmPayr0400SrhVO" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM 
               (     SELECT
							DISTINCT DPOB_CD
								, TYP_OCCU_CD
								, (fcBass0300CDNM(#dpobCd#,TYP_OCCU_CD) || '[' || fcBass0300CDNM(#dpobCd#,PYSP_GRDE_CD) || ']' ) AS TYP_OCCU_NM
								  , PYSP_GRDE_CD
								, fcBass0300CDNM(#dpobCd#,PYSP_GRDE_CD) AS PYSP_GRDE_NM
								 
						FROM PAYR0400
			WHERE  TYP_OCCU_GRDE_MPPG_DEL_YN = 'N'
			  	<isNotEmpty prepend="AND" property="dpobCd" >
			 		DPOB_CD=#dpobCd#
		       	</isNotEmpty> 
		       )
	</select> 

</sqlMap>
