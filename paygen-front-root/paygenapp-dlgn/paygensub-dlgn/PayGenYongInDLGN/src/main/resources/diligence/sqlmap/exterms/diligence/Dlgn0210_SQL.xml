<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="Dlgn0210">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="dlgn0210VO" type="com.app.exterms.diligence.server.vo.Dlgn0210VO"/>
	<typeAlias  alias="dlgn0210SerarchVO" type="com.app.exterms.diligence.server.vo.Dlgn0210SrhVO"/>
	<typeAlias  alias="dlgn0210ExlVO" type="com.app.exterms.diligence.server.vo.Dlgn0210ExlVO"/>
	<typeAlias  alias="dlgn0110ExlVO" type="com.app.exterms.diligence.server.vo.Dlgn0110ExlVO"/>
	<typeAlias  alias="dlgn0210Dto" type="com.app.exterms.diligence.client.dto.Dlgn0210DTO"/>
	<typeAlias  alias="dlgn0110Dto" type="com.app.exterms.diligence.client.dto.Dlgn0110DTO"/>
	
	<resultMap id="dlgn0210" class="com.app.exterms.diligence.server.vo.Dlgn0210VO">
		<result property="dpobCd" column="DPOB_CD" columnIndex="1"/>
		<result property="systemkey" column="SYSTEMKEY" columnIndex="2"/>
		<result property="dilnlazExceDutyYrMnth" column="DILNLAZ_EXCE_DUTY_YR_MNTH" columnIndex="3"/>
		<result property="payCd" column="PAY_CD" columnIndex="4"/>
		<result property="dilnlazApptnDt" column="DILNLAZ_APPTN_DT" columnIndex="5"/>
		<result property="dilnlazDutyYn" column="DILNLAZ_DUTY_YN" columnIndex="6"/>
		<result property="dilnlazDutyTm" column="DILNLAZ_DUTY_TM" columnIndex="7"/>
		<result property="dilnlazNtotYn" column="DILNLAZ_NTOT_YN" columnIndex="8"/>
		<result property="dilnlazNtotTm" column="DILNLAZ_NTOT_TM" columnIndex="9"/>
		<result property="dilnlazTmRstDutyYn" column="DILNLAZ_TM_RST_DUTY_YN" columnIndex="10"/>
		<result property="dilnlazTmRstDutyTm" column="DILNLAZ_TM_RST_DUTY_TM" columnIndex="11"/>
		<result property="kybdr" column="KYBDR" columnIndex="12"/>
		<result property="inptDt" column="INPT_DT" columnIndex="13"/>
		<result property="inptAddr" column="INPT_ADDR" columnIndex="14"/>
		<result property="ismt" column="ISMT" columnIndex="15"/>
		<result property="revnDt" column="REVN_DT" columnIndex="16"/>
		<result property="revnAddr" column="REVN_ADDR" columnIndex="17"/>
		<result property="dilnlazHodyDutyYn" column="DILNLAZ_HODY_DUTY_YN" columnIndex="18"/>
		<result property="dilnlazHodyDutyTm" column="DILNLAZ_HODY_DUTY_TM" columnIndex="19"/>
	</resultMap>
	
	<insert id="dlgn0210DAO.insertDlgn0210_S">
		<![CDATA[
			INSERT INTO DLGN0210 
				( DPOB_CD
				  , SYSTEMKEY
				  , DILNLAZ_EXCE_DUTY_YR_MNTH
				  , PAY_CD
				  , DILNLAZ_APPTN_DT
				  , DILNLAZ_DUTY_YN
				  , DILNLAZ_DUTY_TM
				  , DILNLAZ_NTOT_YN
				  , DILNLAZ_NTOT_TM
				  , DILNLAZ_TM_RST_DUTY_YN
				  , DILNLAZ_TM_RST_DUTY_TM
				  , KYBDR
				  , INPT_DT
				  , INPT_ADDR
				  , ISMT
				  , REVN_DT
				  , REVN_ADDR
				  , DILNLAZ_HODY_DUTY_YN
				  , DILNLAZ_HODY_DUTY_TM )
			VALUES ( #dpobCd#
				  , #systemkey#
				  , #dilnlazExceDutyYrMnth#
				  , #payCd#
				  , #dilnlazApptnDt#
				  , #dilnlazDutyYn#
				  , #dilnlazDutyTm#
				  , #dilnlazNtotYn#
				  , #dilnlazNtotTm#
				  , #dilnlazTmRstDutyYn#
				  , #dilnlazTmRstDutyTm#
				  , #kybdr#
				  , #inptDt#
				  , #inptAddr#
				  , #ismt#
				  , #revnDt#
				  , #revnAddr#
				  , #dilnlazHodyDutyYn#
				  , #dilnlazHodyDutyTm# )
		]]>
	</insert>
	
	<update id="dlgn0210DAO.updateDlgn0210_S">
		<![CDATA[
			UPDATE DLGN0210
			SET DPOB_CD=#dpobCd#
				, SYSTEMKEY=#systemkey#
				, DILNLAZ_EXCE_DUTY_YR_MNTH=#dilnlazExceDutyYrMnth#
				, PAY_CD=#payCd#
				, DILNLAZ_APPTN_DT=#dilnlazApptnDt#
				, DILNLAZ_DUTY_YN=#dilnlazDutyYn#
				, DILNLAZ_DUTY_TM=#dilnlazDutyTm#
				, DILNLAZ_NTOT_YN=#dilnlazNtotYn#
				, DILNLAZ_NTOT_TM=#dilnlazNtotTm#
				, DILNLAZ_TM_RST_DUTY_YN=#dilnlazTmRstDutyYn#
				, DILNLAZ_TM_RST_DUTY_TM=#dilnlazTmRstDutyTm#
				, KYBDR=#kybdr#
				, INPT_DT=#inptDt#
				, INPT_ADDR=#inptAddr#
				, ISMT=#ismt#
				, REVN_DT=#revnDt#
				, REVN_ADDR=#revnAddr#
				, DILNLAZ_HODY_DUTY_YN=#dilnlazHodyDutyYn#
				, DILNLAZ_HODY_DUTY_TM=#dilnlazHodyDutyTm#
						WHERE DPOB_CD=#dpobCd#
								AND SYSTEMKEY=#systemkey#
								AND DILNLAZ_EXCE_DUTY_YR_MNTH=#dilnlazExceDutyYrMnth#
								AND PAY_CD=#payCd#
								AND DILNLAZ_APPTN_DT=#dilnlazApptnDt#
				]]>
	</update>
	
	<delete id="dlgn0210DAO.deleteDlgn0210_S">
		<![CDATA[
			DELETE FROM DLGN0210 
						WHERE DPOB_CD=#dpobCd#
								AND SYSTEMKEY=#systemkey#
								AND DILNLAZ_EXCE_DUTY_YR_MNTH=#dilnlazExceDutyYrMnth#
								AND PAY_CD=#payCd# 
				]]>
						<isNotEmpty prepend="AND" property="dilnlazApptnDt" >
					 	          DILNLAZ_APPTN_DT=#dilnlazApptnDt#
				     	</isNotEmpty>
	</delete>
	
	<select id="dlgn0210DAO.selectDlgn0210_S" resultMap="dlgn0210">
		<![CDATA[
			SELECT
				DPOB_CD
				, SYSTEMKEY
				, DILNLAZ_EXCE_DUTY_YR_MNTH
				, PAY_CD
				, DILNLAZ_APPTN_DT
				, DILNLAZ_DUTY_YN
				, DILNLAZ_DUTY_TM
				, DILNLAZ_NTOT_YN
				, DILNLAZ_NTOT_TM
				, DILNLAZ_TM_RST_DUTY_YN
				, DILNLAZ_TM_RST_DUTY_TM
				, KYBDR
				, INPT_DT
				, INPT_ADDR
				, ISMT
				, REVN_DT
				, REVN_ADDR
				, DILNLAZ_HODY_DUTY_YN
				, DILNLAZ_HODY_DUTY_TM
			FROM DLGN0210
						WHERE DPOB_CD=#dpobCd#
								AND SYSTEMKEY=#systemkey#
								AND DILNLAZ_EXCE_DUTY_YR_MNTH=#dilnlazExceDutyYrMnth#
								AND PAY_CD=#payCd# 
								AND ROWNUM = 1
				]]>
	</select>
	<!-- 
								AND DILNLAZ_APPTN_DT=#dilnlazApptnDt#  -->
	<select id="dlgn0210DAO.selectDlgn0210List_D" parameterClass="dlgn0210SerarchVO" resultClass="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (
				SELECT
								DPOB_CD
								, SYSTEMKEY
								, DILNLAZ_EXCE_DUTY_YR_MNTH
								, PAY_CD
								, DILNLAZ_APPTN_DT
								, DILNLAZ_DUTY_YN
								, DILNLAZ_DUTY_TM
								, DILNLAZ_NTOT_YN
								, DILNLAZ_NTOT_TM
								, DILNLAZ_TM_RST_DUTY_YN
								, DILNLAZ_TM_RST_DUTY_TM
								, KYBDR
								, INPT_DT
								, INPT_ADDR
								, ISMT
								, REVN_DT
								, REVN_ADDR
								, DILNLAZ_HODY_DUTY_YN
								, DILNLAZ_HODY_DUTY_TM
						FROM DLGN0210
				WHERE 1=1
				<isEqual prepend="AND" property="searchCondition" compareValue="0">
					DPOB_CD = #searchKeyword#
				</isEqual>
				<isEqual prepend="AND" property="searchCondition" compareValue="1">
					SYSTEMKEY LIKE '%' || #searchKeyword# || '%'
				</isEqual>
					ORDER BY 
						DPOB_CD DESC
							, SYSTEMKEY DESC
							, DILNLAZ_EXCE_DUTY_YR_MNTH DESC
							, PAY_CD DESC
							, DILNLAZ_APPTN_DT DESC
		
		<![CDATA[					
	) A WHERE ROWNUM <= #lastIndex#
)WHERE RNUM > #firstIndex#
]]>
	</select>	
	<select id="dlgn0210DAO.selectDlgn0210ListTotCnt_S" parameterClass="dlgn0210SerarchVO" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM DLGN0210
			WHERE 1=1
			<isEqual prepend="AND" property="searchCondition" compareValue="0">
				DPOB_CD = #searchKeyword#
			</isEqual>
			<isEqual prepend="AND" property="searchCondition" compareValue="1">
				SYSTEMKEY LIKE '%' || #searchKeyword# || '%'
			</isEqual>
	</select>
	
	<update id="dlgn0210DAO.updateXlsDlgn0200ToDlgn0210" parameterClass="dlgn0210ExlVO">
		UPDATE DLGN0210 SET
		<isNotEmpty property="dilnlazDutyStTm" >
		   	<isNotEmpty property="dilnlazDutyEdTm" >
		   	<![CDATA[
              DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR = (SELECT DISTINCT SUBSTR (#dilnlazYrMnth#, 0, 4) FROM DLGN0210)
																					                               AND YYYYMM = #dilnlazYrMnth#
																					                               AND SUBSTR (CALENDAR_DATE, -2) = SUBSTR(#dilnlazApptnDt#, -2)) = '0'  
									                THEN
									                     (SELECT CASE WHEN ( (  (  SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60 + SUBSTR (#dilnlazDutyEdTm#, 4, 2)) - 1080)) <= 240
									                                  THEN ( (  (  SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60 + SUBSTR (#dilnlazDutyEdTm#, 4, 2)) - 1080))
									                                  ELSE TO_NUMBER ('240')
									                                  END AS DILNLAZ_TM_RST_DUTY_TM
									                      FROM DLGN0210
									                      WHERE SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100 WHERE RESN_REGN_NUM = #resnRegnNum#)
															                                                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
															                                                AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)
									               ELSE TO_NUMBER('')
									               END AS DILNLAZ_TM_RST_DUTY_TM FROM DLGN0210 WHERE SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100
									                                                											   WHERE RESN_REGN_NUM = #resnRegnNum#)
																                               AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
																                               AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 
        	 DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR = (SELECT DISTINCT SUBSTR (#dilnlazYrMnth#, 0, 4) FROM DLGN0210)
																			                                AND YYYYMM =  #dilnlazYrMnth#
																			                                AND SUBSTR (CALENDAR_DATE, -2) = SUBSTR(#dilnlazApptnDt#, -2)) = '0'
                         							THEN        
							                              (SELECT CASE WHEN (  (  SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60 + SUBSTR (#dilnlazDutyEdTm#, 4, 2)) - 1080) > 240
							                                           THEN (  (  SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60 + SUBSTR (#dilnlazDutyEdTm#, 4, 2)) - 1080)- 240
							                                           ELSE TO_NUMBER ('')
							                                           END AS DILNLAZ_NTOT_TM
							                                FROM DLGN0210
							                                WHERE SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100 WHERE RESN_REGN_NUM = #resnRegnNum#)
																		                                      AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
																		                                      AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)
							                        ELSE TO_NUMBER('')
							                     	END AS DILNLAZ_NTOT_TM FROM DLGN0210 WHERE SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100 WHERE RESN_REGN_NUM = #resnRegnNum#)
																											                              AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
																											                              AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 
    		 DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR = (SELECT DISTINCT SUBSTR (#dilnlazYrMnth#, 0, 4) FROM DLGN0210)
															                                AND YYYYMM = #dilnlazYrMnth#
															                                AND SUBSTR (CALENDAR_DATE, -2) = SUBSTR(#dilnlazApptnDt#, -2)) = '1'
                           						 THEN CASE WHEN (  SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60 + SUBSTR (#dilnlazDutyEdTm#, 4, 2)) >= 720
		                                         		   THEN CASE WHEN (  SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60  + SUBSTR (#dilnlazDutyEdTm#, 4, 2)) >= 1080
                                                		 	         THEN '480'
                                                                     ELSE TO_CHAR((SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60 + SUBSTR (#dilnlazDutyEdTm#, 4, 2)) - 60)
                                                                     END
                                                           ELSE TO_CHAR( SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60 + SUBSTR (#dilnlazDutyEdTm#, 4, 2))
                                                           END
                                                 ELSE TO_NUMBER('')
                                                 END AS DILNLAZ_HODY_DUTY_TM FROM DLGN0210 WHERE SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100 WHERE RESN_REGN_NUM = #resnRegnNum#)
																												                              AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
																												                              AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 
   			DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR = (SELECT DISTINCT SUBSTR (#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth#
                                																						   AND SUBSTR (CALENDAR_DATE, -2) = SUBSTR(#dilnlazApptnDt#, -2)) = '1'
                                                THEN CASE WHEN (  SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60+ SUBSTR (#dilnlazDutyEdTm#, 4, 2)) > 1080
                                                          THEN (SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60 + SUBSTR (#dilnlazDutyEdTm#, 4, 2)) - 1080
                                                          ELSE TO_NUMBER('')
                                                          END
                                                ELSE TO_NUMBER('')
                                                END AS DILNLAZ_HODY_NTOT_TM FROM DLGN0210 WHERE SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100 WHERE RESN_REGN_NUM = #resnRegnNum#)
																										                              AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
																										                              AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#),
		     DILNLAZ_DUTY_ST_TM = #dilnlazDutyStTm#,
		     DILNLAZ_DUTY_ED_TM = #dilnlazDutyEdTm#
                ]]>
                </isNotEmpty>
           </isNotEmpty>
          <isEmpty property="dilnlazDutyStTm" >
		   	<isEmpty property="dilnlazDutyEdTm" >
		   		<isEmpty property="dilnlazNtotTm" >
			   	  <isNotEmpty property="dilnlazTmRstDutyTm" >
	           	   <![CDATA[
	           	   DILNLAZ_TM_RST_DUTY_TM = (SELECT ((SUBSTR (#dilnlazTmRstDutyTm#, 0, 2)) * 60 + SUBSTR(#dilnlazTmRstDutyTm#, 4, 2)) AS DILNLAZ_TM_RST_DUTY_TM 
	                                  				FROM DLGN0210 WHERE SYSTEMKEY =(SELECT SYSTEMKEY FROM PSNL0100 WHERE RESN_REGN_NUM = #resnRegnNum#)
	                                   							  AND DILNLAZ_EXCE_DUTY_YR_MNTH =#dilnlazYrMnth#
	                                   							  AND DILNLAZ_APPTN_DT =  #dilnlazApptnDt#),
	               DILNLAZ_DUTY_ED_TM = (SELECT TRUNC(( SELECT  1080 + SUBSTR (#dilnlazTmRstDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazTmRstDutyTm#, 4, 2) 
						                          FROM DLGN0210  WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100  WHERE RESN_REGN_NUM = #resnRegnNum#)
						                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)/60) ||':'||
						      MOD(( SELECT  1080 + SUBSTR (#dilnlazTmRstDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazTmRstDutyTm#, 4, 2) 
						                          FROM DLGN0210  WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100  WHERE RESN_REGN_NUM = #resnRegnNum#)
						                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 60) 
						                            
						                            FROM DLGN0210  WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100  WHERE RESN_REGN_NUM = #resnRegnNum#)
						                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)
	               
	          	   ]]>
	          	  </isNotEmpty>
	          	</isEmpty>
	          	<isNotEmpty property="dilnlazNtotTm" >
	          	  <isNotEmpty property="dilnlazTmRstDutyTm" >
	          	   <![CDATA[
	          	   DILNLAZ_TM_RST_DUTY_TM = (SELECT ((SUBSTR (#dilnlazTmRstDutyTm#, 0, 2)) * 60 + SUBSTR(#dilnlazTmRstDutyTm#, 4, 2)) AS DILNLAZ_TM_RST_DUTY_TM 
	                                  				FROM DLGN0210 WHERE SYSTEMKEY =(SELECT SYSTEMKEY FROM PSNL0100 WHERE RESN_REGN_NUM = #resnRegnNum#)
	                                   							  AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
	                                   							  AND DILNLAZ_APPTN_DT =  #dilnlazApptnDt#),
	               DILNLAZ_NTOT_TM = (SELECT ((SUBSTR (#dilnlazNtotTm#, 0, 2)) * 60 + SUBSTR(#dilnlazNtotTm#, 4, 2)) AS DILNLAZ_NTOT_TM 
	                                           FROM DLGN0210 WHERE SYSTEMKEY =(SELECT SYSTEMKEY FROM PSNL0100 WHERE RESN_REGN_NUM = #resnRegnNum#)
	                                           AND DILNLAZ_EXCE_DUTY_YR_MNTH =#dilnlazYrMnth#
	                                           AND DILNLAZ_APPTN_DT =  #dilnlazApptnDt#),
	              DILNLAZ_DUTY_ED_TM = (SELECT CASE WHEN (SUBSTR (#dilnlazTmRstDutyTm#, 4, 2)+ SUBSTR (#dilnlazNtotTm#, 4, 2)) >= 60 
										             THEN  
										                 (SELECT (TRUNC(( SELECT  1080 + SUBSTR (#dilnlazTmRstDutyTm#, 0, 2)*60+ SUBSTR (#dilnlazNtotTm#, 0, 2)*60    
										                                          FROM DLGN0210  WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100  WHERE RESN_REGN_NUM = #resnRegnNum#)
										                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
										                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)/60) + 1)||':'|| 
										                     TO_NUMBER(( SELECT  SUBSTR (#dilnlazTmRstDutyTm#, 4, 2) + SUBSTR (#dilnlazNtotTm#, 4, 2)  
										                                          FROM DLGN0210  WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100  WHERE RESN_REGN_NUM = #resnRegnNum#)
										                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
										                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#) - 60 )
										                                            
										                                            FROM DLGN0210  WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100  WHERE RESN_REGN_NUM = #resnRegnNum#)
										                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
										                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)  
										                                    
										             ELSE (SELECT TRUNC(( SELECT  1080 + SUBSTR (#dilnlazTmRstDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazTmRstDutyTm#, 4, 2) + SUBSTR (#dilnlazNtotTm#, 0, 2)*60 + SUBSTR (#dilnlazNtotTm#, 4, 2)  
										                                          FROM DLGN0210  WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100  WHERE RESN_REGN_NUM = #resnRegnNum#)
										                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
										                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)/60) ||':'||
										                                            
										                                           
										                       (MOD(( SELECT  1080 + SUBSTR (#dilnlazTmRstDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazTmRstDutyTm#, 4, 2) + SUBSTR (#dilnlazNtotTm#, 0, 2)*60 + SUBSTR (#dilnlazNtotTm#, 4, 2)  
										                                          FROM DLGN0210  WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100  WHERE RESN_REGN_NUM = #resnRegnNum#)
										                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
										                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 60)) 
										                                            
										                                            FROM DLGN0210  WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100  WHERE RESN_REGN_NUM = #resnRegnNum#)
										                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
										                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)  
										             END AS DILNLAZ_DUTY_ED_TM                        
										                    
										                 FROM DLGN0210  WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100  WHERE RESN_REGN_NUM = #resnRegnNum#)
										                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
										                                            AND DILNLAZ_APPTN_DT =#dilnlazApptnDt#)
	               ]]>
	              </isNotEmpty>
	            </isNotEmpty>
	            <isEmpty property="dilnlazHodyNtotTm" >
	              <isNotEmpty property="dilnlazHodyDutyTm" >
	               <![CDATA[
	               	DILNLAZ_HODY_DUTY_TM = (SELECT ((SUBSTR (#dilnlazHodyDutyTm#, 0, 2) * 60 + SUBSTR(#dilnlazHodyDutyTm#, 4, 2))) AS DILNLAZ_HODY_DUTY_TM 
	                                           FROM DLGN0210 WHERE SYSTEMKEY =(SELECT SYSTEMKEY FROM PSNL0100 WHERE RESN_REGN_NUM = #resnRegnNum#)
	                                           AND DILNLAZ_EXCE_DUTY_YR_MNTH =#dilnlazYrMnth#
	                                           AND DILNLAZ_APPTN_DT =  #dilnlazApptnDt#),
	                DILNLAZ_DUTY_ED_TM = (SELECT CASE 
	                                                 WHEN (SUBSTR (#dilnlazHodyDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyDutyTm#, 4, 2) ) > 180
	                							     THEN TRUNC(( SELECT 600 + SUBSTR (#dilnlazHodyDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyDutyTm#, 4, 2) 
								                          FROM DLGN0210  WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100  WHERE RESN_REGN_NUM = #resnRegnNum#)
								                          AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
								                          AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)/60) ||':'||
						      							  MOD(( SELECT SUBSTR (#dilnlazHodyDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyDutyTm#, 4, 2)  
						                                        FROM DLGN0210  WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100  WHERE RESN_REGN_NUM = #resnRegnNum#)
						                            			AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                            			AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 60) 
						                            ELSE TRUNC(( SELECT 540 + SUBSTR (#dilnlazHodyDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyDutyTm#, 4, 2) 
						                          FROM DLGN0210  WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100  WHERE RESN_REGN_NUM = #resnRegnNum#)
						                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)/60) ||':'||
						      							MOD(( SELECT SUBSTR (#dilnlazHodyDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyDutyTm#, 4, 2)  
						                          FROM DLGN0210  WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100  WHERE RESN_REGN_NUM = #resnRegnNum#)
						                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 60) 
						                        END AS DILNLAZ_DUTY_ED_TM  
					                            
					                            FROM DLGN0210  WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100  WHERE RESN_REGN_NUM = #resnRegnNum#)
					                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)
	               ]]>
	              </isNotEmpty>
	             </isEmpty>
				<isNotEmpty property="dilnlazHodyNtotTm" >
	              <isNotEmpty property="dilnlazHodyDutyTm" >
	              <![CDATA[
	               	DILNLAZ_HODY_DUTY_TM = (SELECT ((SUBSTR (#dilnlazHodyDutyTm#, 0, 2) * 60 + SUBSTR(#dilnlazHodyDutyTm#, 4, 2))) AS DILNLAZ_HODY_DUTY_TM 
	                                           FROM DLGN0210 WHERE SYSTEMKEY =(SELECT SYSTEMKEY FROM PSNL0100 WHERE RESN_REGN_NUM = #resnRegnNum#)
	                                           AND DILNLAZ_EXCE_DUTY_YR_MNTH =#dilnlazYrMnth#
	                                           AND DILNLAZ_APPTN_DT =  #dilnlazApptnDt#),
					DILNLAZ_HODY_NTOT_TM = (SELECT ( (SUBSTR (#dilnlazHodyNtotTm#, 0, 2) * 60 + SUBSTR (#dilnlazHodyNtotTm#, 4, 2))) AS DILNLAZ_HODY_NTOT_TM
                                               FROM DLGN0210 WHERE SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100 WHERE RESN_REGN_NUM = #resnRegnNum#)
                                               AND DILNLAZ_EXCE_DUTY_YR_MNTH =#dilnlazYrMnth#
                                               AND DILNLAZ_APPTN_DT =  #dilnlazApptnDt#),
                                               
               	   DILNLAZ_DUTY_ED_TM = (SELECT CASE WHEN (SUBSTR (#dilnlazHodyDutyTm#, 4, 2)+ SUBSTR (#dilnlazHodyNtotTm#, 4, 2)) >= 60 
										             THEN  
										                 (SELECT (TRUNC(( SELECT 600 + SUBSTR (#dilnlazHodyDutyTm#, 0, 2)*60+ SUBSTR (#dilnlazHodyNtotTm#, 0, 2)*60    
										                                          FROM DLGN0210  WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100  WHERE RESN_REGN_NUM = #resnRegnNum#)
										                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
										                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)/60) + 1)||':'|| 
										                     TO_NUMBER(( SELECT  SUBSTR (#dilnlazHodyDutyTm#, 4, 2) + SUBSTR (#dilnlazHodyNtotTm#, 4, 2)  
										                                          FROM DLGN0210  WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100  WHERE RESN_REGN_NUM = #resnRegnNum#)
										                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
										                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#) - 60 )
										                                            
										                                            FROM DLGN0210  WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100  WHERE RESN_REGN_NUM = #resnRegnNum#)
										                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
										                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)  
										                                    
										             ELSE (SELECT TRUNC(( SELECT 600 + SUBSTR (#dilnlazHodyDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyDutyTm#, 4, 2) + SUBSTR (#dilnlazHodyNtotTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyNtotTm#, 4, 2)  
										                                          FROM DLGN0210  WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100  WHERE RESN_REGN_NUM = #resnRegnNum#)
										                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
										                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)/60) ||':'||
										                                            
										                                           
										                       CASE WHEN (MOD (( SELECT  SUBSTR (#dilnlazHodyDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyDutyTm#, 4, 2) + SUBSTR (#dilnlazHodyNtotTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyNtotTm#, 4, 2)  
										                                          FROM DLGN0210  WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100  WHERE RESN_REGN_NUM = #resnRegnNum#)
										                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
										                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 60)) = '0'
										                            THEN (MOD (( SELECT  SUBSTR (#dilnlazHodyDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyDutyTm#, 4, 2) + SUBSTR (#dilnlazHodyNtotTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyNtotTm#, 4, 2)  
										                                          FROM DLGN0210  WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100  WHERE RESN_REGN_NUM = #resnRegnNum#)
										                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
										                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 60))||'0'
										                            ELSE (SELECT   TO_CHAR(SUBSTR (#dilnlazHodyDutyTm#, 0, 2) * 60+ SUBSTR (#dilnlazHodyDutyTm#, 4, 2) + SUBSTR (#dilnlazHodyNtotTm#, 0, 2) * 60 + SUBSTR (#dilnlazHodyNtotTm#, 4, 2)) FROM DLGN0210
											                                         WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100 WHERE RESN_REGN_NUM = #resnRegnNum#)
																	                                               AND DILNLAZ_EXCE_DUTY_YR_MNTH =#dilnlazYrMnth#
																	                                               AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)              
										                            END                               
										                                            FROM DLGN0210  WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100  WHERE RESN_REGN_NUM = #resnRegnNum#)
										                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
										                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)  
										             END AS DILNLAZ_DUTY_ED_TM                        
										                    
										                 FROM DLGN0210  WHERE     SYSTEMKEY = (SELECT SYSTEMKEY FROM PSNL0100  WHERE RESN_REGN_NUM = #resnRegnNum#)
										                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
										                                            AND DILNLAZ_APPTN_DT =#dilnlazApptnDt#)	                                           
	              ]]>
	              </isNotEmpty>
	            </isNotEmpty>	             
           </isEmpty>
           </isEmpty>
           WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                    FROM PSNL0100 
                                    WHERE RESN_REGN_NUM = #resnRegnNum#)
           AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
           AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#
	</update> 
	
	<update id="dlgn0210DAO.updateXlsDlgn0200ToDlgn0210Yn" parameterClass="dlgn0210ExlVO">
		UPDATE DLGN0210 
	        SET
	            DILNLAZ_TM_RST_DUTY_YN = CASE WHEN DILNLAZ_TM_RST_DUTY_TM IS NULL THEN 'N' ELSE 'Y' END,
	            DILNLAZ_NTOT_YN = CASE WHEN DILNLAZ_NTOT_TM IS NULL THEN 'N' ELSE 'Y' END,
	            DILNLAZ_HODY_DUTY_YN = CASE WHEN DILNLAZ_HODY_DUTY_TM IS NULL THEN 'N' ELSE 'Y' END
	        WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
	                              FROM PSNL0100 
	                              WHERE RESN_REGN_NUM = #resnRegnNum#) 
	        AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
	</update>
	
	<update id="dlgn0210DAO.updateDlgn0210Grid_Yn" parameterClass="dlgn0210VO">
		UPDATE DLGN0210 
	        SET DILNLAZ_TM_RST_DUTY_YN 	= NVL ( ( CASE WHEN DILNLAZ_TM_RST_DUTY_TM IS NULL OR DILNLAZ_TM_RST_DUTY_TM ='0' THEN 'N' ELSE 'Y' END ) 					, 'N')
	            , DILNLAZ_NTOT_YN 		= NVL ( ( CASE WHEN DILNLAZ_NTOT_TM IS NULL OR DILNLAZ_NTOT_TM = '0' THEN 'N' ELSE 'Y' END ) 								, 'N')
	            , DILNLAZ_HODY_DUTY_YN 	= NVL ( ( CASE WHEN NVL(DILNLAZ_HODY_DUTY_TM, '0') = '0' AND NVL(DILNLAZ_HODY_NTOT_TM, '0') = '0'THEN 'N' ELSE 'Y' END )	, 'N')
	     WHERE SYSTEMKEY = #systemkey#
	        AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
	        AND PAY_CD = #payCd#
	</update>
	
	
	<!-- *********************************************************이전로직 : 시간:분 단위로 보여주는 쿼리 -->
	<!-- <select id="dlgn0210DAO.selectDlgn0200List" parameterClass="dlgn0210SerarchVO" resultClass="egovMap">
	<![CDATA[
		SELECT
                A.DPOB_CD
                , A.SYSTEMKEY
                , A.DILNLAZ_EXCE_DUTY_YR_MNTH
                , A.PAY_CD
                , TO_CHAR (TO_DATE (A.DILNLAZ_APPTN_DT, 'YYYYMMDD'), 'YYYY.MM.DD') AS DILNLAZ_APPTN_DT
                , A.DILNLAZ_DUTY_YN
                , CASE WHEN(A.DILNLAZ_DUTY_TM = '0' OR A.DILNLAZ_DUTY_TM IS NULL) THEN '' ELSE (CASE WHEN TRUNC(A.DILNLAZ_DUTY_TM / 60) > 0 AND TRUNC(A.DILNLAZ_DUTY_TM
                        / 60) < 10 THEN TO_CHAR('0'||TRUNC(A.DILNLAZ_DUTY_TM / 60)) ELSE TO_CHAR(TRUNC(A.DILNLAZ_DUTY_TM
                         / 60)) END) ||':'|| (CASE WHEN MOD(A.DILNLAZ_DUTY_TM, 60 )>= 0 AND MOD(A.DILNLAZ_DUTY_TM, 60) <10
                        THEN TO_CHAR('0'||MOD(A.DILNLAZ_DUTY_TM , 60)) ELSE TO_CHAR(MOD(A.DILNLAZ_DUTY_TM , 60)) END) END AS DILNLAZ_DUTY_TM    
                , A.DILNLAZ_NTOT_YN
                , CASE WHEN ( A.DILNLAZ_NTOT_TM = '0' OR A.DILNLAZ_NTOT_TM IS NULL ) THEN '' ELSE  (CASE WHEN TRUNC(A.DILNLAZ_NTOT_TM / 60) > 0 AND TRUNC(A.DILNLAZ_NTOT_TM
                        / 60) < 10 THEN TO_CHAR('0'||TRUNC(A.DILNLAZ_NTOT_TM / 60)) ELSE TO_CHAR(TRUNC(A.DILNLAZ_NTOT_TM
                         / 60)) END) ||':'|| (CASE WHEN MOD(A.DILNLAZ_NTOT_TM, 60 )>= 0 AND MOD(A.DILNLAZ_NTOT_TM, 60) <10
                        THEN TO_CHAR('0'||MOD(A.DILNLAZ_NTOT_TM , 60)) ELSE TO_CHAR(MOD(A.DILNLAZ_NTOT_TM , 60)) END)END AS DILNLAZ_NTOT_TM
                , A.DILNLAZ_TM_RST_DUTY_YN
                , CASE WHEN (SELECT(CASE WHEN
	                		( A.DILNLAZ_TM_RST_DUTY_TM = '0' OR A.DILNLAZ_TM_RST_DUTY_TM IS NULL ) THEN '' ELSE  (CASE WHEN TRUNC(A.DILNLAZ_TM_RST_DUTY_TM / 60) > 0 AND TRUNC(A.DILNLAZ_TM_RST_DUTY_TM
	                        / 60) < 10 THEN TO_CHAR('0'||TRUNC(A.DILNLAZ_TM_RST_DUTY_TM / 60)) ELSE TO_CHAR(TRUNC(A.DILNLAZ_TM_RST_DUTY_TM
	                         / 60)) END) ||':'|| (CASE WHEN MOD(A.DILNLAZ_TM_RST_DUTY_TM, 60 )>= 0 AND MOD(A.DILNLAZ_TM_RST_DUTY_TM, 60) <10
	                        THEN TO_CHAR('0'||MOD(A.DILNLAZ_TM_RST_DUTY_TM , 60)) ELSE TO_CHAR(MOD(A.DILNLAZ_TM_RST_DUTY_TM , 60)) END) 
	                        END)
				                        FROM DLGN0210 A 
			                    WHERE DPOB_CD=#dpobCd# AND SYSTEMKEY=#systemkey# AND DILNLAZ_EXCE_DUTY_YR_MNTH=#dilnlazExceDutyYrMnth#
			                    AND DILNLAZ_TM_RST_DUTY_TM  LIKE '%'||'-'||'%' )IS NOT NULL 
                       THEN ''
                       ELSE 
                           (CASE WHEN
	                		( A.DILNLAZ_TM_RST_DUTY_TM = '0' OR A.DILNLAZ_TM_RST_DUTY_TM IS NULL ) THEN '' ELSE  (CASE WHEN TRUNC(A.DILNLAZ_TM_RST_DUTY_TM / 60) > 0 AND TRUNC(A.DILNLAZ_TM_RST_DUTY_TM
	                        / 60) < 10 THEN TO_CHAR('0'||TRUNC(A.DILNLAZ_TM_RST_DUTY_TM / 60)) ELSE TO_CHAR(TRUNC(A.DILNLAZ_TM_RST_DUTY_TM
	                         / 60)) END) ||':'|| (CASE WHEN MOD(A.DILNLAZ_TM_RST_DUTY_TM, 60 )>= 0 AND MOD(A.DILNLAZ_TM_RST_DUTY_TM, 60) <10
	                        THEN TO_CHAR('0'||MOD(A.DILNLAZ_TM_RST_DUTY_TM , 60)) ELSE TO_CHAR(MOD(A.DILNLAZ_TM_RST_DUTY_TM , 60)) END) END )
	                   END AS DILNLAZ_TM_RST_DUTY_TM
                , A.KYBDR
                , A.INPT_DT
                , A.INPT_ADDR
                , A.ISMT
                , A.REVN_DT
                , A.REVN_ADDR
                , A.DILNLAZ_HODY_DUTY_YN
                , CASE WHEN ( A.DILNLAZ_HODY_DUTY_TM = '0' OR A.DILNLAZ_HODY_DUTY_TM IS NULL ) THEN '' ELSE  (CASE WHEN TRUNC(A.DILNLAZ_HODY_DUTY_TM / 60) > 0 AND TRUNC(A.DILNLAZ_HODY_DUTY_TM
                        / 60) < 10 THEN TO_CHAR('0'||TRUNC(A.DILNLAZ_HODY_DUTY_TM / 60)) ELSE TO_CHAR(TRUNC(A.DILNLAZ_HODY_DUTY_TM
                         / 60)) END) ||':'|| (CASE WHEN MOD(A.DILNLAZ_HODY_DUTY_TM, 60 )>= 0 AND MOD(A.DILNLAZ_HODY_DUTY_TM, 60) <10
                        THEN TO_CHAR('0'||MOD(A.DILNLAZ_HODY_DUTY_TM , 60)) ELSE TO_CHAR(MOD(A.DILNLAZ_HODY_DUTY_TM , 60)) END) END AS DILNLAZ_HODY_DUTY_TM
                                              
                , CASE WHEN ( A.DILNLAZ_HODY_NTOT_TM = '0' OR A.DILNLAZ_HODY_NTOT_TM IS NULL ) THEN '' ELSE  (CASE WHEN TRUNC(A.DILNLAZ_HODY_NTOT_TM / 60) > 0 AND TRUNC(A.DILNLAZ_HODY_NTOT_TM
                        / 60) < 10 THEN TO_CHAR('0'||TRUNC(A.DILNLAZ_HODY_NTOT_TM / 60)) ELSE TO_CHAR(TRUNC(A.DILNLAZ_HODY_NTOT_TM
                         / 60)) END) ||':'|| (CASE WHEN MOD(A.DILNLAZ_HODY_NTOT_TM, 60 )>= 0 AND MOD(A.DILNLAZ_HODY_NTOT_TM, 60) <10
                        THEN TO_CHAR('0'||MOD(A.DILNLAZ_HODY_NTOT_TM , 60)) ELSE TO_CHAR(MOD(A.DILNLAZ_HODY_NTOT_TM , 60)) END) END AS DILNLAZ_HODY_NTOT_TM 
                , CASE WHEN SUBSTR(DILNLAZ_DUTY_ED_TM, 4, 2) > 0 THEN
       				   CASE WHEN DILNLAZ_TM_RST_DUTY_TM IS NOT NULL THEN 
				            CASE WHEN SUBSTR(DILNLAZ_DUTY_ED_TM, 0, 2) >= 22
				                 THEN '22:00' 
				                 ELSE  A.DILNLAZ_DUTY_ED_TM
				                 END 
				        ELSE '' END 
				  ELSE '' END AS DILNLAZ_DUTY_ED_TM_RST
                , CASE WHEN SUBSTR(DILNLAZ_DUTY_ED_TM, 0, 2) > 18  THEN
				       CASE WHEN DILNLAZ_NTOT_TM IS NOT NULL THEN A.DILNLAZ_DUTY_ED_TM ELSE '' END 
				  ELSE '' END AS DILNLAZ_DUTY_ED_TM_DUTY
				, CASE WHEN SUBSTR(DILNLAZ_DUTY_ED_TM, 0, 2) > 0 THEN
				       CASE WHEN DILNLAZ_HODY_DUTY_TM IS NOT NULL THEN 
				            CASE WHEN SUBSTR(DILNLAZ_DUTY_ED_TM, 0, 2) >= 18
				                 THEN '18:00' 
				                 ELSE  A.DILNLAZ_DUTY_ED_TM
				                 END 
				       ELSE '' END 
				   ELSE '' END AS DILNLAZ_DUTY_ED_TM_HODY_DUTY  
				, CASE WHEN SUBSTR(DILNLAZ_DUTY_ED_TM, 0, 2) > 0 THEN
				       CASE WHEN DILNLAZ_HODY_NTOT_TM IS NULL OR DILNLAZ_HODY_NTOT_TM = '0' THEN '' ELSE A.DILNLAZ_DUTY_ED_TM END 
				  ELSE '' END AS DILNLAZ_DUTY_ED_TM_HODY_NTOT
				, A.DILNLAZ_DUTY_ST_TM
         		, A.DILNLAZ_DUTY_ED_TM
         		, DECODE(C.PUBC_HODY_YN, 'Y', 2, B.OFFDAY_KUBN ) AS OFFDAY_KUBN
                 FROM DLGN0210 A, CO_CALENDAR B,
			        (SELECT DPOB_CD, (PUBC_HODY_DT) AS YEAR_MNTH_DAY, PUBC_HODY_YN
			            FROM BASS0200) C
           		 WHERE A.DPOB_CD=#dpobCd#
                 AND A.SYSTEMKEY=#systemkey#
                 AND A.PAY_CD = #payCd#
                 AND A.DILNLAZ_EXCE_DUTY_YR_MNTH=#dilnlazExceDutyYrMnth#
		         AND A.DILNLAZ_APPTN_DT = B.CALENDAR_DATE(+)
		         AND A.DPOB_CD = C.DPOB_CD(+)
		         AND A.DILNLAZ_APPTN_DT = C.YEAR_MNTH_DAY(+)
			     ORDER BY A.DILNLAZ_APPTN_DT
     ]]>
	</select>-->
	<!-- *********************************************************시간단위 -->
	<select id="dlgn0210DAO.selectDlgn0200List" parameterClass="dlgn0210SerarchVO" resultClass="egovMap">
		<![CDATA[
			SELECT
				A.DPOB_CD
				, A.SYSTEMKEY
				, A.DILNLAZ_EXCE_DUTY_YR_MNTH
				, A.PAY_CD
				, A.DILNLAZ_APPTN_DT
				, A.DILNLAZ_DUTY_YN
				, A.DILNLAZ_DUTY_TM
				, A.DILNLAZ_NTOT_YN
				, A.DILNLAZ_NTOT_TM
				, A.DILNLAZ_TM_RST_DUTY_YN
				, A.DILNLAZ_TM_RST_DUTY_TM
				, A.KYBDR
				, A.INPT_DT
				, A.INPT_ADDR
				, A.ISMT
				, A.REVN_DT
				, A.REVN_ADDR
				, A.DILNLAZ_HODY_DUTY_YN
				, A.DILNLAZ_HODY_DUTY_TM
				, A.DILNLAZ_HODY_NTOT_TM
				, A.DILNLAZ_DUTY_ST_TM
				, A.DILNLAZ_DUTY_ED_TM
				, CASE WHEN SUBSTR(DILNLAZ_DUTY_ED_TM, 4, 2) > 0 AND DILNLAZ_TM_RST_DUTY_TM != '0' THEN
       				   CASE WHEN DILNLAZ_TM_RST_DUTY_TM IS NOT NULL THEN 
				            CASE WHEN SUBSTR(DILNLAZ_DUTY_ED_TM, 0, 2) >= 22
				                 THEN '22:00' 
				                 ELSE  A.DILNLAZ_DUTY_ED_TM
				                 END 
				        ELSE '' END 
				  ELSE '' END AS DILNLAZ_DUTY_ED_TM_RST
                , CASE WHEN SUBSTR(DILNLAZ_DUTY_ED_TM, 0, 2) > 18 AND DILNLAZ_NTOT_TM != '0' THEN
				       CASE WHEN DILNLAZ_NTOT_TM IS NOT NULL THEN A.DILNLAZ_DUTY_ED_TM ELSE '' END 
				  ELSE '' END AS DILNLAZ_DUTY_ED_TM_DUTY
				, CASE WHEN SUBSTR(DILNLAZ_DUTY_ED_TM, 0, 2) > 0 AND DILNLAZ_HODY_DUTY_TM != '0' THEN
				       CASE WHEN DILNLAZ_HODY_DUTY_TM IS NOT NULL THEN 
				            CASE WHEN SUBSTR(DILNLAZ_DUTY_ED_TM, 0, 2) >= 18
				                 THEN '18:00' 
				                 ELSE  A.DILNLAZ_DUTY_ED_TM
				                 END 
				       ELSE '' END 
				   ELSE '' END AS DILNLAZ_DUTY_ED_TM_HODY_DUTY  
				, CASE WHEN SUBSTR(DILNLAZ_DUTY_ED_TM, 0, 2) > 0 AND DILNLAZ_HODY_NTOT_TM != '0' THEN
				       CASE WHEN DILNLAZ_HODY_NTOT_TM IS NULL OR DILNLAZ_HODY_NTOT_TM = '0' THEN '' ELSE A.DILNLAZ_DUTY_ED_TM END 
				  ELSE '' END AS DILNLAZ_DUTY_ED_TM_HODY_NTOT
				, DECODE (C.PUBC_HODY_YN, 'Y', 2, B.OFFDAY_KUBN) AS OFFDAY_KUBN
			FROM DLGN0210 A, CO_CALENDAR B, (SELECT DPOB_CD, (PUBC_HODY_DT) AS YEAR_MNTH_DAY, PUBC_HODY_YN FROM BASS0200) C
			WHERE A.DPOB_CD=#dpobCd#
					AND A.SYSTEMKEY=#systemkey#
					AND A.DILNLAZ_EXCE_DUTY_YR_MNTH=#dilnlazExceDutyYrMnth#
					AND A.PAY_CD=#payCd# 
					AND A.DILNLAZ_APPTN_DT = B.CALENDAR_DATE(+)
                             AND A.DILNLAZ_APPTN_DT = C.YEAR_MNTH_DAY(+)
                             AND A.DPOB_CD = C.DPOB_CD(+)
                             ORDER BY A.DILNLAZ_APPTN_DT ASC
				]]>
	</select>	
	<select id="dlgn0210DAO.selectDlgn0200ListTotCnt" parameterClass="dlgn0210SerarchVO" resultClass="int">
		SELECT COUNT(*) totcnt
            FROM DLGN0210 A, CO_CALENDAR B,
			        (SELECT DPOB_CD, (PUBC_HODY_DT) AS YEAR_MNTH_DAY, PUBC_HODY_YN
			            FROM BASS0200) C
           		 WHERE A.DPOB_CD=#dpobCd#
                 AND A.SYSTEMKEY=#systemkey#
                 AND A.PAY_CD = #payCd#
                 AND A.DILNLAZ_EXCE_DUTY_YR_MNTH=#dilnlazExceDutyYrMnth#
		         AND A.DILNLAZ_APPTN_DT = B.CALENDAR_DATE(+)
		         AND A.DPOB_CD = C.DPOB_CD(+)
		         AND A.DILNLAZ_APPTN_DT = C.YEAR_MNTH_DAY(+)
			     ORDER BY A.DILNLAZ_APPTN_DT
	</select>
	
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_1" parameterClass="dlgn0110ExlVO">
	<![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm1#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm1#,
                
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '01') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm1#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm1#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm1#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm1#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm1#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm1#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							THEN ''
							ELSE TO_CHAR (CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR = (SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '01') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm1#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm1#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm1#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm1#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm1#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm1#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
						    END
			                     AS DILNLAZ_TM_RST_DUTY_TM
			                FROM DLGN0210 A              
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '01'),
							                
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '01') = '0'
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm1#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm1#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm1#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm1#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '01'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '01') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm1#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm1#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm1#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm1#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)< 0 
						     THEN ''
						     ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '01') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm1#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm1#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm1#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm1#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						      END              
				                     AS DILNLAZ_TM_RST_DUTY_TM
				                FROM DLGN0210              
				                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
				                                     FROM PSNL0100 
				                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
				                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
				                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '01'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '01') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm1#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm1#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm1#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm1#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '01')
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '01'
    ]]>                   
	</update>
	
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_2" parameterClass="dlgn0110ExlVO">
		<![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm2#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm2#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN (CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210)AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '02') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm2#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm2#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm2#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm2#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm2#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm2#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							   THEN ''
							   ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '02') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm2#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm2#, 4, 2)) - 1080)) <= 240
							                                   THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm2#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm2#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm2#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm2#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) 
							   END         		 
				                     AS DILNLAZ_TM_RST_DUTY_TM
				               FROM DLGN0210 A             
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '02'),
							                
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '02') = '0'
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm2#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm2#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm2#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm2#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '02'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210)AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '02') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm2#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm2#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm2#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm2#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						  THEN ''
						  ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '02') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm2#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm2#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm2#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm2#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						  END                   
			                      AS DILNLAZ_TM_RST_DUTY_TM
			                FROM DLGN0210              
			                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '02'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '02') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm2#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm2#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm2#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm2#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '02')              
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '02'
    ]]> 
	</update>
	
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_3" parameterClass="dlgn0110ExlVO">
	<![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm3#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm3#,
                 DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN (CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '03') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm3#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm3#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm3#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm3#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm3#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm3#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							      THEN ''
							      ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '03') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm3#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm3#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm3#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm3#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm3#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm3#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END )
							      END
					                AS DILNLAZ_TM_RST_DUTY_TM
					                FROM DLGN0210 A            
					                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '03'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '03') = '0'
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm3#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm3#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm3#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm3#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '03'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN (CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '03') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm3#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm3#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm3#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm3#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						 THEN ''
						 ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '03') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm3#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm3#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm3#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm3#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						 END                    
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '03'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '03') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm3#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm3#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm3#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm3#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '03')              
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '03'
    ]]> 
	</update>

	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_4" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm4#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm4#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '04') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm4#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm4#, 4, 2)) - 1080)) <= 240
							                                   THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm4#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm4#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm4#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm4#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							    THEN ''
							    ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '04') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm4#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm4#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm4#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm4#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm4#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm4#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
							    END                 
				                     AS DILNLAZ_TM_RST_DUTY_TM
				                FROM DLGN0210 A            
				                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
				                                     FROM PSNL0100 
				                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
				                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
				                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '04'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '04') = '0'
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm4#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm4#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm4#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm4#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '04'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '04') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm4#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm4#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm4#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm4#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)<0
						  THEN ''
						  ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '04') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm4#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm4#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm4#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm4#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						 END                   
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '04'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '04') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm4#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm4#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm4#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm4#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '04')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '04'
    ]]> 
	</update>

	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_5" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm5#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm5#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN( CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '05') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm5#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm5#, 4, 2)) - 1080)) <= 240
							                                     THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm5#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm5#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm5#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm5#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							        THEN ''
							        ELSE TO_CHAR( CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '05') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm5#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm5#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm5#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm5#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm5#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm5#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
							        END          
					                     AS DILNLAZ_TM_RST_DUTY_TM
					                FROM DLGN0210 A            
					                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '05'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '05') = '0' 
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm5#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm5#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm5#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm5#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '05'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '05') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm5#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm5#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm5#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm5#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0 
						                     
							THEN ''
							ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '05') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm5#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm5#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm5#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm5#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						   END
				                     AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '05'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '05') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm5#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm5#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm5#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm5#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '05')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '05' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_6" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm6#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm6#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '06') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm6#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm6#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm6#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm6#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm6#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm6#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							   THEN ''
							   ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '06') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm6#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm6#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm6#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm6#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm6#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm6#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
							   END                  
				                     AS DILNLAZ_TM_RST_DUTY_TM
				                FROM DLGN0210 A              
				                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
				                                     FROM PSNL0100 
				                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
				                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
				                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '06'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '06') = '0'
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm6#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm6#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm6#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm6#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '06'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '06') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm6#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm6#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm6#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm6#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						    THEN ''
						    ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '06') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm6#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm6#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm6#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm6#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						    END                 
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '06'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '06') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm6#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm6#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm6#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm6#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '06')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '06' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_7" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm7#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm7#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '07') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm7#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm7#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm7#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm7#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm7#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm7#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
						THEN ''
						ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '07') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm7#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm7#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm7#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm7#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm7#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm7#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
				        END	                     
		                      AS DILNLAZ_TM_RST_DUTY_TM
		              		 FROM DLGN0210 A          
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '07'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '07') = '0'
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm7#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm7#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm7#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm7#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '07'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '07') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm7#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm7#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm7#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm7#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						   THEN ''
						   ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '07') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm7#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm7#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm7#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm7#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						   END                  
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '07'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '07') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm7#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm7#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm7#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm7#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '07')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '07' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_8" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm8#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm8#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN (CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '08') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm8#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm8#, 4, 2)) - 1080)) <= 240
							                                     THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm8#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm8#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm8#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm8#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							THEN ''
							ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '08') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm8#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm8#, 4, 2)) - 1080)) <= 240
							                                     THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm8#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm8#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm8#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm8#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
							END                                       
			                      AS DILNLAZ_TM_RST_DUTY_TM
			                FROM DLGN0210 A            
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '08'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '08') = '0' 
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm8#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm8#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm8#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm8#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '08'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '08') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm8#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm8#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm8#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm8#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						   THEN ''
						   ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '08') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm8#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm8#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm8#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm8#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						   END                  
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '08'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '08') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm8#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm8#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm8#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm8#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '08')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '08' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_9" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm9#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm9#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '09') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm9#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm9#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm9#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm9#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm9#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm9#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							    THEN ''
							    ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '09') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm9#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm9#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm9#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm9#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm9#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm9#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
							    END                 
					                      AS DILNLAZ_TM_RST_DUTY_TM
					               FROM DLGN0210 A              
					                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '09'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '09') = '0'
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm9#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm9#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm9#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm9#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '09'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '09') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm9#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm9#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm9#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm9#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						   THEN ''
						   ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '09') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm9#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm9#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm9#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm9#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						   END
						                     
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '09'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '09') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm9#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm9#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm9#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm9#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '09')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '09' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_10" parameterClass="dlgn0110ExlVO">
 	<![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm10#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm10#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '10') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm10#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm10#, 4, 2)) - 1080)) <= 240
							                                     THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm9#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm9#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm9#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm9#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							 THEN ''
							 ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '10') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm10#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm10#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm9#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm9#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm9#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm9#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
							 END                   
			                     AS DILNLAZ_TM_RST_DUTY_TM
				                FROM DLGN0210 A           
				                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
				                                     FROM PSNL0100 
				                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
				                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
				                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '10'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '10') = '0'
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm10#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm10#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm10#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm10#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '10'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '10') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm10#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm10#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm10#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm10#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						   THEN ''
						   ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '10') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm10#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm10#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm10#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm10#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						  END
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '10'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '10') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm10#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm10#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm10#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm10#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '10')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '10' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_11" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm11#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm11#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN (CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '11') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm11#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm11#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm11#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm11#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm11#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm11#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
						THEN ''
						ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '11') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm11#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm11#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm11#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm11#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm11#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm11#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
						END	                     
			                      AS DILNLAZ_TM_RST_DUTY_TM
			               FROM DLGN0210 A          
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '11'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '11') = '0' 
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm11#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm11#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm11#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm11#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '11'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '11') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm11#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm11#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm11#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm11#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						  THEN ''
						  ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '11') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm11#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm11#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm11#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm11#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						  END						                     
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '11'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '11') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm11#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm11#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm11#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm11#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '11')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '11' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_12" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm12#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm12#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN (CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '12') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm12#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm12#, 4, 2)) - 1080)) <= 240
							                                   THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm12#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm12#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm12#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm12#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
						THEN ''
						ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '12') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm12#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm12#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm12#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm12#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm12#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm12#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
						END	                     
		                     AS DILNLAZ_TM_RST_DUTY_TM
		               FROM DLGN0210 A        
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '12'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '12') = '0'
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm12#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm12#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm12#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm12#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '12'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '12') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm12#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm12#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm12#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm12#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						 THEN ''
						 ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '12') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm12#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm12#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm12#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm12#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						 END                    
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '12'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '12') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm12#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm12#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm12#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm12#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '12')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '12' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_13" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm13#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm13#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '13') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm13#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm13#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm13#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm13#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm13#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm13#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							 THEN ''
							 ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '13') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm13#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm13#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm13#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm13#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm13#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm13#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)                    
							 END
				                     AS DILNLAZ_TM_RST_DUTY_TM
				                FROM DLGN0210 A              
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '13'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '13') = '0'
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm13#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm13#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm13#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm13#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '13'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '13') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm13#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm13#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm13#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm13#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0 
						    THEN ''
						    ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '13') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm13#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm13#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm13#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm13#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						   END                 
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '13'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '13') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm13#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm13#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm13#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm13#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '13')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '13' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_14" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm14#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm14#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '14') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm14#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm14#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm14#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm14#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm14#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm14#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							   THEN ''
							   ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '14') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm14#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm14#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm14#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm14#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm14#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm14#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
							   END							                  
				                      AS DILNLAZ_TM_RST_DUTY_TM
				               FROM DLGN0210 A           
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '14'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '14') = '0' 
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm14#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm14#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm14#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm14#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '14'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '14') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm14#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm14#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm14#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm14#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						     THEN ''
						     ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '14') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm14#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm14#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm14#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm14#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						                     
						     END                
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '14'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '14') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm14#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm14#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm14#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm14#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '14')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '14' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_15" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm15#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm15#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN (CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '15') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm15#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm15#, 4, 2)) - 1080)) <= 240
							                                     THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm15#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm15#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm15#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm15#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							   THEN ''
							   ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '15') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm15#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm15#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm15#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm15#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm15#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm15#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
							   END							                   
				                      AS DILNLAZ_TM_RST_DUTY_TM
				               FROM DLGN0210 A          
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '15'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '15') = '0'
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm15#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm15#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm15#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm15#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '15'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '15') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm15#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm15#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm15#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm15#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						    THEN ''
						    ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '15') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm15#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm15#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm15#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm15#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						   END                 
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '15'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '15') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm15#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm15#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm15#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm15#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '15')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '15' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_16" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm16#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm16#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '16') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm16#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm16#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm16#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm16#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm16#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm16#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							THEN ''
							ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '16') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm16#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm16#, 4, 2)) - 1080)) <= 240
							                                   THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm16#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm16#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm16#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm16#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
							END 
			                     AS DILNLAZ_TM_RST_DUTY_TM
			                FROM DLGN0210 A            
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '16'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '16') = '0'
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm16#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm16#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm16#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm16#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '16'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '16') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm16#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm16#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm16#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm16#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						   THEN ''
						   ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '16') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm16#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm16#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm16#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm16#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
							END						                     
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '16'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '16') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm16#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm16#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm16#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm16#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '16')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '16' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_17" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm17#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm17#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '17') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm17#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm17#, 4, 2)) - 1080)) <= 240
							                                     THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm17#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm17#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm17#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm17#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							 THEN ''
							 ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '17') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm17#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm17#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm17#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm17#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm17#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm17#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
							 END                    
				                      AS DILNLAZ_TM_RST_DUTY_TM
				               FROM DLGN0210 A            
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '17'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '17') = '0'
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm17#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm17#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm17#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm17#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '17'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '17') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm17#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm17#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm17#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm17#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						  THEN ''
						  ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '17') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm17#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm17#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm17#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm17#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						  END                   
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '17'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '17') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm17#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm17#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm17#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm17#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '17')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '17' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_18" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm18#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm18#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '18') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm18#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm18#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm18#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm18#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm18#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm18#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							   THEN ''
							   ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '18') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm18#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm18#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm18#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm18#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm18#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm18#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
							   END                  
				                      AS DILNLAZ_TM_RST_DUTY_TM
				                FROM DLGN0210 A          
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '18'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '18') = '0'
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm18#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm18#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm18#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm18#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '18'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '18') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm18#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm18#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm18#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm18#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						     THEN ''
						     ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '18') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm18#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm18#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm18#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm18#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						     END                
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '18'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '18') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm18#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm18#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm18#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm18#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '18')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '18' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_19" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm19#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm19#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '19') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm19#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm19#, 4, 2)) - 1080)) <= 240
							                                     THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm19#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm19#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm19#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm19#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							THEN ''
							ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '19') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm19#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm19#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm19#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm19#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm19#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm19#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
							END		                     
			                      AS DILNLAZ_TM_RST_DUTY_TM
			                FROM DLGN0210 A             
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '19'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '19') = '0' 
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm19#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm19#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm19#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm19#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '19'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '19') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm19#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm19#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm19#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm19#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						   THEN ''
						   ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '19') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm19#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm19#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm19#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm19#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						   END                  
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '19'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '19') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm19#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm19#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm19#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm19#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '19')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '19' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_20" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm20#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm20#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '20') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm20#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm20#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm20#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm20#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm20#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm20#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							  THEN ''
							  ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '20') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm20#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm20#, 4, 2)) - 1080)) <= 240
							                                  THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm20#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm20#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm20#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm20#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
							  END                   
				                      AS DILNLAZ_TM_RST_DUTY_TM
				               FROM DLGN0210 A            
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '20'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '20') = '0' 
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm20#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm20#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm20#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm20#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '20'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '20') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm20#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm20#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm20#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm20#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						      THEN ''
						      ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '20') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm20#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm20#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm20#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm20#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						      END               
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '20'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '20') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm20#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm20#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm20#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm20#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '20')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '20' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_21" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm21#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm21#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '21') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm21#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm21#, 4, 2)) - 1080)) <= 240
							                                     THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm21#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm21#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm21#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm21#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							  THEN ''
							  ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '21') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm21#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm21#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm21#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm21#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm21#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm21#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
							  END                   
				                      AS DILNLAZ_TM_RST_DUTY_TM
				                FROM DLGN0210 A            
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '21'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '21') = '0' 
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm21#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm21#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm21#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm21#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '21'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '21') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm21#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm21#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm21#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm21#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						     THEN ''
						     ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '21') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm21#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm21#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm21#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm21#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						    END                
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '21'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '21') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm21#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm21#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm21#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm21#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '21')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '21' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_22" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm22#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm22#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '22') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm22#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm22#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm22#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm22#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm22#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm22#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							THEN''
							ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '22') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm22#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm22#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm22#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm22#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm22#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm22#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
							END 
			                      AS DILNLAZ_TM_RST_DUTY_TM
			                FROM DLGN0210 A             
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '22'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '22') = '0'
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm22#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm22#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm22#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm22#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '22'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '22') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm22#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm22#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm22#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm22#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						    THEN ''
						    ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '22') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm22#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm22#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm22#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm22#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						    END						    
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '22'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '22') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm22#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm22#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm22#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm22#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '22')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '22' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_23" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm23#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm23#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '23') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm23#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm23#, 4, 2)) - 1080)) <= 240
							                                   THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm23#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm23#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm23#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm23#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							 THEN ''
							 ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '23') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm23#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm23#, 4, 2)) - 1080)) <= 240
							                                   THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm23#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm23#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm23#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm23#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
							 END                    
				                      AS DILNLAZ_TM_RST_DUTY_TM
				                FROM DLGN0210 A           
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '23'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '23') = '0'
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm23#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm23#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm23#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm23#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '23'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN (CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '23') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm23#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm23#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm23#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm23#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0 
						  THEN ''
						  ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '23') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm23#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm23#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm23#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm23#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						 END                   
						                     AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '23'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '23') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm23#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm23#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm23#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm23#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '23')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '23' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_24" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm24#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm24#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN (CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '24') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm24#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm24#, 4, 2)) - 1080)) <= 240
							                                     THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm24#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm24#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm24#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm24#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							 THEN ''
							 ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '24') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm24#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm24#, 4, 2)) - 1080)) <= 240
							                                     THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm24#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm24#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm24#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm24#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
							 END                    
				                      AS DILNLAZ_TM_RST_DUTY_TM
				                FROM DLGN0210 A        
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '24'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '24') = '0'
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm24#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm24#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm24#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm24#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '24'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '24') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm24#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm24#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm24#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm24#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						       THEN ''
						       ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '24') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm24#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm24#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm24#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm24#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						       END              
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '24'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '24') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm24#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm24#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm24#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm24#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '24')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '24' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_25" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm25#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm25#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '25') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm25#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm25#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm25#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm25#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm25#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm25#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							 THEN ''
							 ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '25') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm25#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm25#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm25#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm25#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm25#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm25#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
							END                    
			                      AS DILNLAZ_TM_RST_DUTY_TM
			               FROM DLGN0210 A             
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '25'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '25') = '0' 
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm25#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm25#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm25#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm25#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '25'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '25') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm25#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm25#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm25#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm25#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						      THEN ''
						      ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '25') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm25#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm25#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm25#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm25#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						      END               
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '25'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '25') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm25#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm25#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm25#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm25#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '25')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '25' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_26" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm26#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm26#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN (CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '26') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm26#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm26#, 4, 2)) - 1080)) <= 240
							                                   THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm26#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm26#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm26#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm26#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							THEN ''
							ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '26') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm26#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm26#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm26#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm26#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm26#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm26#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
							END                     
				                      AS DILNLAZ_TM_RST_DUTY_TM
				                FROM DLGN0210 A             
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '26'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '26') = '0'
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm26#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm26#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm26#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm26#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '26'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '26') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm26#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm26#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm26#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm26#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						       THEN ''
						       ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '26') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm26#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm26#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm26#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm26#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						      END              
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '26'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '26') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm26#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm26#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm26#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm26#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '26')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '26' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_27" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm27#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm27#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '27') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm27#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm27#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm27#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm27#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm27#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm27#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							THEN ''
							ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '27') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm27#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm27#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm27#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm27#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm27#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm27#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)                     
							END                     
			                      AS DILNLAZ_TM_RST_DUTY_TM
			                FROM DLGN0210 A             
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '27'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '27') = '0' 
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm27#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm27#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm27#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm27#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '27'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN (CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '27') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm27#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm27#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm27#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm27#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						   THEN ''
						   ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '27') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm27#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm27#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm27#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm27#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)                 
						    END                 
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '27'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '27') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm27#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm27#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm27#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm27#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '27')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '27' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_28" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm28#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm28#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN (CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '28') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm28#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm28#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm28#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm28#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm28#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm28#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							 THEN ''
							 ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '28') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm28#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm28#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm28#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm28#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm28#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm28#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
							 END                    
			                      AS DILNLAZ_TM_RST_DUTY_TM
			               FROM DLGN0210 A            
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '28'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '28') = '0'
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm28#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm28#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm28#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm28#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '28'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '28') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm28#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm28#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm28#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm28#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						     THEN ''
						     ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '28') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm28#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm28#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm28#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm28#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						     END                
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '28'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '28') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm28#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm28#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm28#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm28#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '28')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '28' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_29" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm29#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm29#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN (CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '29') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm29#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm29#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm29#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm29#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm29#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm29#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
					THEN ''
					ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '29') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm29#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm29#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm29#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm29#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm29#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm29#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
					END		                     
	                      AS DILNLAZ_TM_RST_DUTY_TM
	                FROM DLGN0210 A              
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '29'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '29') = '0'
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm29#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm29#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm29#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm29#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '29'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '29') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm29#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm29#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm29#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm29#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						    THEN ''
						    ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '29') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm29#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm29#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm29#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm29#, 4, 2))))- 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						    END                 
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '29'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '29') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm29#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm29#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm29#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm29#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '29')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '29' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_30" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm30#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm30#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '30') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm30#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm30#, 4, 2)) - 1080)) <= 240
							                                   THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm30#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm30#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm30#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm30#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							THEN ''
							ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '30') = '0' 
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm30#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm30#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm30#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm30#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm30#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm30#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
							END                    
			                      AS DILNLAZ_TM_RST_DUTY_TM
			                FROM DLGN0210 A             
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '30'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '30') = '0' 
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm30#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm30#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm30#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm30#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210 A             
					                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '30'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '30') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm30#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm30#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm30#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm30#, 4, 2)))) -540
						                                    ELSE TO_NUMBER('640')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						  THEN ''
						  ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '30') = '1'
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm30#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm30#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm30#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm30#, 4, 2)))) -540
						                                    ELSE TO_NUMBER('640')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						  END                   
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '30'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '30') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm30#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm30#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm30#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm30#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '30')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '30' 
	]]>
	</update>
	<update id="dlgn0210DAO.updateXlsDlgn0100ToDlgn0210_31" parameterClass="dlgn0110ExlVO">
	 <![CDATA[
		UPDATE DLGN0210 
            SET 
                DILNLAZ_DUTY_ST_TM = #dilnlazStTm31#,
                DILNLAZ_DUTY_ED_TM = #dilnlazEdTm31#,
                DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '31') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm31#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm31#, 4, 2)) - 1080)) <= 240
							                                   THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm31#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm31#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm31#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm31#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END) < 0
							THEN ''
							ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '31') = '0'
							                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm31#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm31#, 4, 2)) - 1080)) <= 240
							                                    THEN 
								                                    CASE WHEN  ( (  (  SUBSTR (#dilnlazEdTm31#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm31#, 4, 2))  - 1080)) = '0'
							                                             THEN ''
							                                             ELSE ( TO_CHAR(  (  SUBSTR (#dilnlazEdTm31#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm31#, 4, 2)) - 1080))
							                                             END
							                                    ELSE TO_CHAR('240')
							                                    END
							                     ELSE TO_CHAR('')
							                     END)
							END                     
			                      AS DILNLAZ_TM_RST_DUTY_TM
			                FROM DLGN0210 A            
			                WHERE A.SYSTEMKEY = (SELECT SYSTEMKEY 
			                                     FROM PSNL0100 
			                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
			                AND A.DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
			                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '31'),
              	DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '31') = '0'
					                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm31#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm31#, 4, 2)) - 1080)) > 240
					                                    THEN ( (  (SUBSTR (#dilnlazEdTm31#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm31#, 4, 2)) - 1080)) - 240
					                                    ELSE TO_NUMBER('')
					                                    END
					                     ELSE TO_NUMBER('')
					                     END AS DILNLAZ_NTOT_TM
					                FROM DLGN0210              
					                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
					                                     FROM PSNL0100 
					                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
					                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
					                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '31'),
               DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '31') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm31#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm31#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm31#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm31#, 4, 2)))) - 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END) < 0
						   THEN ''
						   ELSE TO_CHAR(CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND SUBSTR(CALENDAR_DATE, -2) = '31') = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm31#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm31#, 4, 2)))) <= 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm31#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm31#, 4, 2)))) - 540
						                                    ELSE TO_NUMBER('1080')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END)
						   END                  
						                      AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '31'),
               DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR =(SELECT DISTINCT SUBSTR(#dilnlazYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazYrMnth# AND CALENDAR_DATE = #dilnlazApptnDt#) = '1' 
						                          THEN CASE WHEN ( (  (SUBSTR (#dilnlazEdTm31#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm31#, 4, 2))))> 1080
						                                    THEN ( (  (SUBSTR (#dilnlazEdTm31#, 0, 2) * 60 + SUBSTR (#dilnlazEdTm31#, 4, 2)))) - 1080
						                                    ELSE TO_NUMBER('')
						                                    END
						                     ELSE TO_NUMBER('')
						                     END AS DILNLAZ_TM_RST_DUTY_TM
						                FROM DLGN0210              
						                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
						                                     FROM PSNL0100 
						                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
						                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
						                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '31')               
                WHERE SYSTEMKEY = (SELECT SYSTEMKEY 
                                     FROM PSNL0100 
                                    WHERE RESN_REGN_NUM =#resnRegnNum#) 
                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
                AND SUBSTR (DILNLAZ_APPTN_DT, -2) = '31' 
	]]>
	</update>
	<!-- *********************************************************이전로직 : 시간:분 단위로 보여주는 쿼리 -->
	<!--<update id="dlgn0210DAO.updateDlgn0210Grid_02" parameterClass="dlgn0210VO">
 		 UPDATE DLGN0210 SET
 		<isEmpty property="dilnlazNtotTm" >
	  	  <isNotEmpty property="dilnlazTmRstDutyTm" >
	  	  <isEmpty property="dilnlazHodyNtotTm" >
	  	  <isEmpty property="dilnlazHodyDutyTm" >
        	   <![CDATA[
        	   DILNLAZ_TM_RST_DUTY_TM = (SELECT ((SUBSTR (#dilnlazTmRstDutyTm#, 0, 2)) * 60 + SUBSTR(#dilnlazTmRstDutyTm#, 4, 2)) AS DILNLAZ_TM_RST_DUTY_TM 
                               				FROM DLGN0210 WHERE SYSTEMKEY =#systemkey#
                                							  AND DILNLAZ_EXCE_DUTY_YR_MNTH =#dilnlazExceDutyYrMnth#
                                							  AND DILNLAZ_APPTN_DT =  #dilnlazApptnDt#),
              DILNLAZ_DUTY_ED_TM = (SELECT TRUNC(( SELECT  1080 + SUBSTR (#dilnlazTmRstDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazTmRstDutyTm#, 4, 2) 
		                          FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
		                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
		                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)/60) ||':'||
					      CASE WHEN (MOD(( SELECT  1080 + SUBSTR (#dilnlazTmRstDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazTmRstDutyTm#, 4, 2) 
					                          FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
					                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
					                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 60)) < 10
		                  	   THEN '0'||(MOD(( SELECT  1080 + SUBSTR (#dilnlazTmRstDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazTmRstDutyTm#, 4, 2) 
					                          FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
					                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
					                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 60))
					                            
		                  	   ELSE TO_CHAR(MOD(( SELECT  1080 + SUBSTR (#dilnlazTmRstDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazTmRstDutyTm#, 4, 2) 
					                          FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
					                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
					                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 60))
					           END
		                            FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
		                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
		                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#),
		     DILNLAZ_DUTY_ST_TM = #dilnlazDutyStTm#   
		                            
       	   ]]>
       	   </isEmpty>
       	   </isEmpty>
       	  </isNotEmpty>
       	</isEmpty>
       	
       	<isNotEmpty property="dilnlazNtotTm" >
       	  <isNotEmpty property="dilnlazTmRstDutyTm" >
       	  <isEmpty property="dilnlazHodyNtotTm" >
	  	  <isEmpty property="dilnlazHodyDutyTm" >
       	   <![CDATA[
       	   DILNLAZ_TM_RST_DUTY_TM = (SELECT ((SUBSTR (#dilnlazTmRstDutyTm#, 0, 2)) * 60 + SUBSTR(#dilnlazTmRstDutyTm#, 4, 2)) AS DILNLAZ_TM_RST_DUTY_TM 
                               				FROM DLGN0210 WHERE SYSTEMKEY =#systemkey#
                                							  AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
                                							  AND DILNLAZ_APPTN_DT =  #dilnlazApptnDt#),
            DILNLAZ_NTOT_TM = (SELECT ((SUBSTR (#dilnlazNtotTm#, 0, 2)) * 60 + SUBSTR(#dilnlazNtotTm#, 4, 2)) AS DILNLAZ_NTOT_TM 
                                        FROM DLGN0210 WHERE SYSTEMKEY =#systemkey#
                                        AND DILNLAZ_EXCE_DUTY_YR_MNTH =#dilnlazExceDutyYrMnth#
                                        AND DILNLAZ_APPTN_DT =  #dilnlazApptnDt#),
           DILNLAZ_DUTY_ED_TM = (SELECT CASE WHEN (SUBSTR (#dilnlazTmRstDutyTm#, 4, 2)+ SUBSTR (#dilnlazNtotTm#, 4, 2)) >= 60 
						             THEN  
						                 (SELECT (TRUNC(( SELECT  1080 + SUBSTR (#dilnlazTmRstDutyTm#, 0, 2)*60+ SUBSTR (#dilnlazNtotTm#, 0, 2)*60    
						                                          FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
						                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
						                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)/60) + 1)||':'|| 
						                     TO_NUMBER(( SELECT  SUBSTR (#dilnlazTmRstDutyTm#, 4, 2) + SUBSTR (#dilnlazNtotTm#, 4, 2)  
						                                          FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
						                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
						                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#) - 60 )
						                                            
						                                            FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
						                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
						                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)  
						                                    
						             ELSE (SELECT TRUNC(( SELECT  1080 + SUBSTR (#dilnlazTmRstDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazTmRstDutyTm#, 4, 2) + SUBSTR (#dilnlazNtotTm#, 0, 2)*60 + SUBSTR (#dilnlazNtotTm#, 4, 2)  
						                                          FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
						                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
						                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)/60) ||':'||
						                                            
						                                           
						                     CASE WHEN (MOD(( SELECT  1080 + SUBSTR (#dilnlazTmRstDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazTmRstDutyTm#, 4, 2) + SUBSTR (#dilnlazNtotTm#, 0, 2)*60 + SUBSTR (#dilnlazNtotTm#, 4, 2)  
						                                          FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
						                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
						                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 60)) < 10
						                          THEN '0'||(MOD(( SELECT  1080 + SUBSTR (#dilnlazTmRstDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazTmRstDutyTm#, 4, 2) + SUBSTR (#dilnlazNtotTm#, 0, 2)*60 + SUBSTR (#dilnlazNtotTm#, 4, 2)  
						                                          FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
						                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
						                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 60))
						                                            
						                          ELSE TO_CHAR(MOD(( SELECT  1080 + SUBSTR (#dilnlazTmRstDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazTmRstDutyTm#, 4, 2) + SUBSTR (#dilnlazNtotTm#, 0, 2)*60 + SUBSTR (#dilnlazNtotTm#, 4, 2)  
						                                          FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
						                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
						                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 60))
						                          END
						                                            
						                                            FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
						                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
						                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)  
						             END AS DILNLAZ_DUTY_ED_TM                        
						                    
						                 FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
						                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
						                                            AND DILNLAZ_APPTN_DT =#dilnlazApptnDt#),
			DILNLAZ_DUTY_ST_TM = #dilnlazDutyStTm# 						                                            
						                                            
            ]]>
            </isEmpty>
            </isEmpty>
           </isNotEmpty>
         </isNotEmpty>
         
         <isEmpty property="dilnlazNtotTm" >
       	 <isEmpty property="dilnlazTmRstDutyTm" >
           <isNotEmpty property="dilnlazHodyDutyTm" >
         <isEmpty property="dilnlazHodyNtotTm" >
            <![CDATA[
            	DILNLAZ_HODY_DUTY_TM = (SELECT ((SUBSTR (#dilnlazHodyDutyTm#, 0, 2) * 60 + SUBSTR(#dilnlazHodyDutyTm#, 4, 2))) AS DILNLAZ_HODY_DUTY_TM 
                                        FROM DLGN0210 WHERE SYSTEMKEY =#systemkey#
                                        AND DILNLAZ_EXCE_DUTY_YR_MNTH =#dilnlazExceDutyYrMnth#
                                        AND DILNLAZ_APPTN_DT =  #dilnlazApptnDt#),
             DILNLAZ_DUTY_ED_TM = (SELECT CASE 
                                              WHEN (SUBSTR (#dilnlazHodyDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyDutyTm#, 4, 2) ) > 180
             							     THEN TRUNC(( SELECT 600 + SUBSTR (#dilnlazHodyDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyDutyTm#, 4, 2) 
				                          FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
				                          AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
				                          AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)/60) ||':'||
		      							  
		      							  CASE WHEN (MOD(( SELECT SUBSTR (#dilnlazHodyDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyDutyTm#, 4, 2)  
		                                        FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
		                            			AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
		                            			AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 60)) < 0
		                            		   THEN TO_NUMBER('')
		                            		   ELSE (MOD(( SELECT SUBSTR (#dilnlazHodyDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyDutyTm#, 4, 2)  
		                                        FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
		                            			AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
		                            			AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 60))
		                            		   END
		                            			 
		                            ELSE TRUNC(( SELECT 540 + SUBSTR (#dilnlazHodyDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyDutyTm#, 4, 2) 
		                          FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
		                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
		                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)/60) ||':'||
		      							
		      						CASE WHEN	(MOD(( SELECT SUBSTR (#dilnlazHodyDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyDutyTm#, 4, 2)  
						                          FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
						                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
						                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 60)) < 10
		                            THEN '0'||(MOD(( SELECT SUBSTR (#dilnlazHodyDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyDutyTm#, 4, 2)  
						                          FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
						                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
						                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 60))
		                            ELSE 
		                            	TO_CHAR(MOD(( SELECT SUBSTR (#dilnlazHodyDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyDutyTm#, 4, 2)  
						                          FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
						                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
						                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 60))
		                            END
		                             
		                        END AS DILNLAZ_DUTY_ED_TM  
	                            
	                            FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
	                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
	                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#),
			DILNLAZ_DUTY_ST_TM = #dilnlazDutyStTm# 	                            
	                                  
            ]]>
          </isEmpty>
           </isNotEmpty>
          	</isEmpty>
          	</isEmpty>
        
        <isEmpty property="dilnlazNtotTm" >
       	 <isEmpty property="dilnlazTmRstDutyTm" >  
		<isNotEmpty property="dilnlazHodyNtotTm" >
           <isNotEmpty property="dilnlazHodyDutyTm" >
           <![CDATA[
            	DILNLAZ_HODY_DUTY_TM = (SELECT ((SUBSTR (#dilnlazHodyDutyTm#, 0, 2) * 60 + SUBSTR(#dilnlazHodyDutyTm#, 4, 2))) AS DILNLAZ_HODY_DUTY_TM 
                                        FROM DLGN0210 WHERE SYSTEMKEY =#systemkey#
                                        AND DILNLAZ_EXCE_DUTY_YR_MNTH =#dilnlazExceDutyYrMnth#
                                        AND DILNLAZ_APPTN_DT =  #dilnlazApptnDt#),
				DILNLAZ_HODY_NTOT_TM = (SELECT ( (SUBSTR (#dilnlazHodyNtotTm#, 0, 2) * 60 + SUBSTR (#dilnlazHodyNtotTm#, 4, 2))) AS DILNLAZ_HODY_NTOT_TM
                                           FROM DLGN0210 WHERE SYSTEMKEY = #systemkey#
                                           AND DILNLAZ_EXCE_DUTY_YR_MNTH =#dilnlazExceDutyYrMnth#
                                           AND DILNLAZ_APPTN_DT =  #dilnlazApptnDt#),
                                           
           	   DILNLAZ_DUTY_ED_TM = (SELECT CASE WHEN (SUBSTR (#dilnlazHodyDutyTm#, 4, 2)+ SUBSTR (#dilnlazHodyNtotTm#, 4, 2)) >= 60 
						             THEN  
						                 (SELECT (TRUNC(( SELECT 600 + SUBSTR (#dilnlazHodyDutyTm#, 0, 2)*60+ SUBSTR (#dilnlazHodyNtotTm#, 0, 2)*60    
						                                          FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
						                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
						                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)/60) + 1)||':'|| 
						                     TO_NUMBER(( SELECT  SUBSTR (#dilnlazHodyDutyTm#, 4, 2) + SUBSTR (#dilnlazHodyNtotTm#, 4, 2)  
						                                          FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
						                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
						                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#) - 60 )
						                                            
						                                            FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
						                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
						                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)  
						                                    
						             ELSE  (SELECT TRUNC(( SELECT 600 + SUBSTR (#dilnlazHodyDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyDutyTm#, 4, 2) + SUBSTR (#dilnlazHodyNtotTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyNtotTm#, 4, 2)  
						                                          FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
						                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
						                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)/60) ||':'||
						                                            
						                                           
						                       CASE WHEN (MOD (( SELECT  SUBSTR (#dilnlazHodyDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyDutyTm#, 4, 2) + SUBSTR (#dilnlazHodyNtotTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyNtotTm#, 4, 2)  
						                                          FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
						                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
						                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 60)) = '0'
						                            THEN (MOD (( SELECT  SUBSTR (#dilnlazHodyDutyTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyDutyTm#, 4, 2) + SUBSTR (#dilnlazHodyNtotTm#, 0, 2)*60 + SUBSTR (#dilnlazHodyNtotTm#, 4, 2)  
						                                          FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
						                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
						                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 60))||'0'
						                            ELSE TO_CHAR(MOD ((SELECT   TO_CHAR(SUBSTR (#dilnlazHodyDutyTm#, 0, 2) * 60+ SUBSTR (#dilnlazHodyDutyTm#, 4, 2) + SUBSTR (#dilnlazHodyNtotTm#, 0, 2) * 60 + SUBSTR (#dilnlazHodyNtotTm#, 4, 2)) FROM DLGN0210
							                                         WHERE     SYSTEMKEY = #systemkey#
													                                               AND DILNLAZ_EXCE_DUTY_YR_MNTH =#dilnlazExceDutyYrMnth#
													                                               AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 60))               
						                            END                               
						                                            FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
						                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
						                                            AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#) 
						             END AS 	                        
						                    
						                 FROM DLGN0210  WHERE     SYSTEMKEY = #systemkey#
						                                            AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
						                                            AND DILNLAZ_APPTN_DT =#dilnlazApptnDt#),
			DILNLAZ_DUTY_ST_TM = #dilnlazDutyStTm# 						                                            
  
           ]]>
           </isNotEmpty>
         </isNotEmpty>
         </isEmpty>
         </isEmpty>
         
          <isEmpty property="dilnlazNtotTm" >
       	 <isEmpty property="dilnlazTmRstDutyTm" >  
		<isEmpty property="dilnlazHodyNtotTm" >
           <isEmpty property="dilnlazHodyDutyTm" >
           <![CDATA[
     		DILNLAZ_TM_RST_DUTY_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR = (SELECT DISTINCT SUBSTR (#dilnlazExceDutyYrMnth#, 0, 4) FROM DLGN0210)
																					                               AND YYYYMM = #dilnlazExceDutyYrMnth#
																					                               AND SUBSTR (CALENDAR_DATE, -2) = SUBSTR(#dilnlazApptnDt#, -2)) = '0'  
									                THEN
									                     CASE WHEN 
											                     (SELECT CASE WHEN ( (  (  SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60 + SUBSTR (#dilnlazDutyEdTm#, 4, 2)) - 1080)) <= 240
											                                  THEN ( (  (  SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60 + SUBSTR (#dilnlazDutyEdTm#, 4, 2)) - 1080))
											                                  ELSE TO_NUMBER ('240')
											                                  END AS DILNLAZ_TM_RST_DUTY_TM
											                      FROM DLGN0210
											                      WHERE SYSTEMKEY = #systemkey#
																	                                                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
																	                                                AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#) < 0
															  THEN TO_NUMBER('')
															  ELSE
															  	  (SELECT CASE WHEN ( (  (  SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60 + SUBSTR (#dilnlazDutyEdTm#, 4, 2)) - 1080)) <= 240
											                                  THEN ( (  (  SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60 + SUBSTR (#dilnlazDutyEdTm#, 4, 2)) - 1080))
											                                  ELSE TO_NUMBER ('240')
											                                  END AS DILNLAZ_TM_RST_DUTY_TM
											                      FROM DLGN0210
											                      WHERE SYSTEMKEY = #systemkey#
																	                                                AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
																	                                                AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)
															  END		                                                
									               ELSE TO_NUMBER('')
									               END AS DILNLAZ_TM_RST_DUTY_TM FROM DLGN0210 WHERE SYSTEMKEY = #systemkey#
																                               AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
																                               AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 
        	 DILNLAZ_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR = (SELECT DISTINCT SUBSTR (#dilnlazExceDutyYrMnth#, 0, 4) FROM DLGN0210)
																			                                AND YYYYMM =  #dilnlazExceDutyYrMnth#
																			                                AND SUBSTR (CALENDAR_DATE, -2) = SUBSTR(#dilnlazApptnDt#, -2)) = '0'
                         							THEN   
                         								CASE WHEN     
							                              (SELECT CASE WHEN (  (  SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60 + SUBSTR (#dilnlazDutyEdTm#, 4, 2)) - 1080) > 240
							                                           THEN (  (  SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60 + SUBSTR (#dilnlazDutyEdTm#, 4, 2)) - 1080)- 240
							                                           ELSE TO_NUMBER ('')
							                                           END AS DILNLAZ_NTOT_TM
							                                FROM DLGN0210
							                                WHERE SYSTEMKEY = #systemkey#
																		                                      AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
																		                                      AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#) < 0
															THEN TO_NUMBER('')
															ELSE
																(SELECT CASE WHEN (  (  SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60 + SUBSTR (#dilnlazDutyEdTm#, 4, 2)) - 1080) > 240
							                                           THEN (  (  SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60 + SUBSTR (#dilnlazDutyEdTm#, 4, 2)) - 1080)- 240
							                                           ELSE TO_NUMBER ('')
							                                           END AS DILNLAZ_NTOT_TM
								                                FROM DLGN0210
								                                WHERE SYSTEMKEY = #systemkey#
																			                                      AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
																			                                      AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#)	
															END				                                      		                                      
							                        ELSE TO_NUMBER('')
							                     	END AS DILNLAZ_NTOT_TM FROM DLGN0210 WHERE SYSTEMKEY = #systemkey#
																											                              AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
																											                              AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 
    		 DILNLAZ_HODY_DUTY_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR = (SELECT DISTINCT SUBSTR (#dilnlazExceDutyYrMnth#, 0, 4) FROM DLGN0210)
															                                AND YYYYMM = #dilnlazExceDutyYrMnth#
															                                AND SUBSTR (CALENDAR_DATE, -2) = SUBSTR(#dilnlazApptnDt#, -2)) = '1'
                           						 THEN CASE WHEN (  SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60 + SUBSTR (#dilnlazDutyEdTm#, 4, 2)) >= 720
		                                         		   THEN CASE WHEN (  SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60  + SUBSTR (#dilnlazDutyEdTm#, 4, 2)) >= 1080
                                                		 	         THEN '480'
                                                                     ELSE TO_CHAR((SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60 + SUBSTR (#dilnlazDutyEdTm#, 4, 2)) - 60)
                                                                     END
                                                           ELSE TO_CHAR( SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60 + SUBSTR (#dilnlazDutyEdTm#, 4, 2))
                                                           END
                                                 ELSE TO_NUMBER('')
                                                 END AS DILNLAZ_HODY_DUTY_TM FROM DLGN0210 WHERE SYSTEMKEY = #systemkey#
																												                              AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
																												                              AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#), 
   			DILNLAZ_HODY_NTOT_TM = (SELECT CASE WHEN (SELECT OFFDAY_KUBN FROM CO_CALENDAR WHERE YEAR = (SELECT DISTINCT SUBSTR (#dilnlazExceDutyYrMnth#, 0, 4) FROM DLGN0210) AND YYYYMM = #dilnlazExceDutyYrMnth#
                                																						   AND SUBSTR (CALENDAR_DATE, -2) = SUBSTR(#dilnlazApptnDt#, -2)) = '1'
                                                THEN CASE WHEN (  SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60+ SUBSTR (#dilnlazDutyEdTm#, 4, 2)) > 1080
                                                          THEN (SUBSTR (#dilnlazDutyEdTm#, 0, 2) * 60 + SUBSTR (#dilnlazDutyEdTm#, 4, 2)) - 1080
                                                          ELSE TO_NUMBER('')
                                                          END
                                                ELSE TO_NUMBER('')
                                                END AS DILNLAZ_HODY_NTOT_TM FROM DLGN0210 WHERE SYSTEMKEY = #systemkey#
																										                              AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
																										                              AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#),
		     DILNLAZ_DUTY_ST_TM = #dilnlazDutyStTm#,
		     DILNLAZ_DUTY_ED_TM = #dilnlazDutyEdTm#
		      ]]>
        </isEmpty>
        </isEmpty>
        </isEmpty>
		</isEmpty>
		
		WHERE SYSTEMKEY = #systemkey#
       AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazExceDutyYrMnth#
       AND DILNLAZ_APPTN_DT = #dilnlazApptnDt#        
	</update> -->
	
	<!-- ********************************************************* 시간단위 -->
	<update id="dlgn0210DAO.updateDlgn0210Grid_02" parameterClass="dlgn0210VO">
		<![CDATA[
			UPDATE DLGN0210
			SET DPOB_CD=#dpobCd#
				, SYSTEMKEY=#systemkey#
				, DILNLAZ_EXCE_DUTY_YR_MNTH=#dilnlazExceDutyYrMnth#
				, PAY_CD=#payCd#
				, DILNLAZ_APPTN_DT=#dilnlazApptnDt#
				, DILNLAZ_DUTY_YN=#dilnlazDutyYn#
				, DILNLAZ_DUTY_TM=#dilnlazDutyTm#
				, DILNLAZ_NTOT_YN=#dilnlazNtotYn#
				, DILNLAZ_NTOT_TM=#dilnlazNtotTm#
				, DILNLAZ_TM_RST_DUTY_YN=#dilnlazTmRstDutyYn#
				, DILNLAZ_TM_RST_DUTY_TM=#dilnlazTmRstDutyTm#
				, ISMT=#ismt#
				, REVN_ADDR=#revnAddr#
				, DILNLAZ_HODY_DUTY_YN=#dilnlazHodyDutyYn#
				, DILNLAZ_HODY_DUTY_TM=#dilnlazHodyDutyTm#
				, DILNLAZ_HODY_NTOT_TM=#dilnlazHodyNtotTm#
				, DILNLAZ_DUTY_ST_TM=#dilnlazDutyStTm#
				, DILNLAZ_DUTY_ED_TM=#dilnlazDutyEdTm#
						WHERE DPOB_CD=#dpobCd#
								AND SYSTEMKEY=#systemkey#
								AND DILNLAZ_EXCE_DUTY_YR_MNTH=#dilnlazExceDutyYrMnth#
								AND PAY_CD=#payCd#
								AND DILNLAZ_APPTN_DT=#dilnlazApptnDt#
				]]>
	</update>
	
	 <update id="dlgn0210DAO.updateDlgn0100Todlgn0210Tm" parameterClass="dlgn0110Dto">
	 	<![CDATA[
	 		UPDATE DLGN0210
				   SET DILNLAZ_DUTY_ED_TM = (SELECT CASE WHEN (SUBSTR(#dilnlazDutyTm#, 0, 1)*60 + SUBSTR(#dilnlazDutyTm#, 3, 2)) > 480 
				                                    THEN '18:00'
				                                    ELSE 
				                                        CASE WHEN (SUBSTR(#dilnlazDutyTm#, 0, 1)*60 + SUBSTR(#dilnlazDutyTm#, 3, 2)) > 180 
				                                             THEN TRUNC ((SUBSTR(#dilnlazDutyTm#, 0, 1)*60 + SUBSTR(#dilnlazDutyTm#, 3, 2)) / 60 )+10 
				                                                  ||':'|| 
				                                                  TO_CHAR(SUBSTR(#dilnlazDutyTm#, 3, 2))             
				                                             ELSE 
				                                                  TRUNC((SUBSTR(#dilnlazDutyTm#, 0, 1)*60 + SUBSTR(#dilnlazDutyTm#, 3, 2)) / 60 )+9 
				                                                  ||':'|| 
				                                                   TO_CHAR(SUBSTR(#dilnlazDutyTm#, 3, 2))
				                                             END
				                                    END
				                                FROM DLGN0210
				                                WHERE     DPOB_CD = #dpobCd#
				                               AND SYSTEMKEY = #systemkey#
				                               AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
				                               AND PAY_CD = #payCd#
				                               AND DILNLAZ_APPTN_DT =
				                                      REPLACE (REPLACE (#dilnlazApptnDt#, '-', ''), '.', '')),
				       ISMT = #ismt#,
				       REVN_DT = TO_CHAR (SYSDATE, 'YYYYMMDDHHMISS'),
				       REVN_ADDR = #revnAddr#
				 WHERE     DPOB_CD = #dpobCd#
				       AND SYSTEMKEY = #systemkey#
				       AND DILNLAZ_EXCE_DUTY_YR_MNTH = #dilnlazYrMnth#
				       AND PAY_CD = #payCd#
				       AND DILNLAZ_APPTN_DT =
				              REPLACE (REPLACE (#dilnlazApptnDt#, '-', ''), '.', '')
	 	]]>
	 </update>
	
</sqlMap>
