<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="BoardPage">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<!-- <typeAlias  alias="bord0300SerarchVO" type="com.web.exterms.mypage.board.service.Bord0300DefaultVO"/> -->
	<typeAlias  alias="boardSerarchVO" type="com.web.exterms.mypage.board.service.BoardPageDefaultVO"/>
	
	<resultMap id="bordPage" class="com.web.exterms.mypage.board.service.BoardPageVO">
		<result property="sysDivCd" column="SYS_DIV_CD"  />
		<result property="bullBordMsgeSeilNum" column="BULL_BORD_MSGE_SEIL_NUM"  />
		<result property="bullBordUid" column="BULL_BORD_UID"  />
		<result property="bullBordGrpId" column="BULL_BORD_GRP_ID"  />
		<result property="tplvlWrtnInfo" column="TPLVL_WRTN_INFO"  />
		<result property="wrtnAswrStge" column="WRTN_ASWR_STGE"  />
		<result property="wrtnRgstnOrd" column="WRTN_RGSTN_ORD"  />
		<result property="aswrWrtnNum" column="ASWR_WRTN_NUM"  />
		<result property="ppgPernNm" column="PPG_PERN_NM"  />
		<result property="usrId" column="USR_ID"  />
		<result property="bullBordMsgeTtl" column="BULL_BORD_MSGE_TTL"  />
		 <result property="bullBordMsgeCtnt" column="BULL_BORD_MSGE_CTNT" jdbcType="CLOB" javaType="java.lang.String"/>
		<result property="wrtnSecrNum" column="WRTN_SECR_NUM"  />
		<result property="ppgPernEmail" column="PPG_PERN_EMAIL"  />
		<result property="inqyNum" column="INQY_NUM"  />
		<result property="htmlUseYn" column="HTML_USE_YN"  />
		<result property="bullBordMsgeDelYn" column="BULL_BORD_MSGE_DEL_YN"  />
		<result property="notiBgnnDt" column="NOTI_BGNN_DT"  />
		<result property="notiEndDt" column="NOTI_END_DT"  />
		<result property="kybdr" column="KYBDR"  />
		<result property="inptDt" column="INPT_DT"  />
		<result property="inptAddr" column="INPT_ADDR"  />
		<result property="ismt" column="ISMT"  />
		<result property="revnDt" column="REVN_DT"  />
		<result property="revnAddr" column="REVN_ADDR"  /> 
	</resultMap>
	<resultMap id="bordResultMap" class="EgovMap"> 
	    <result property="sysDivCd" column="SYS_DIV_CD"  />
		<result property="bullBordMsgeSeilNum" column="BULL_BORD_MSGE_SEIL_NUM"  />
		<result property="bullBordUid" column="BULL_BORD_UID"  />
		<result property="bullBordGrpId" column="BULL_BORD_GRP_ID"  />
		<result property="tplvlWrtnInfo" column="TPLVL_WRTN_INFO"  />
		<result property="wrtnAswrStge" column="WRTN_ASWR_STGE"  />
		<result property="wrtnRgstnOrd" column="WRTN_RGSTN_ORD"  />
		<result property="aswrWrtnNum" column="ASWR_WRTN_NUM"  />
		<result property="ppgPernNm" column="PPG_PERN_NM"  />
		<result property="usrId" column="USR_ID"  />
		<result property="bullBordMsgeTtl" column="BULL_BORD_MSGE_TTL"  />
		 <result property="bullBordMsgeCtnt" column="BULL_BORD_MSGE_CTNT" jdbcType="CLOB" javaType="java.lang.String"/>
		<result property="wrtnSecrNum" column="WRTN_SECR_NUM"  />
		<result property="ppgPernEmail" column="PPG_PERN_EMAIL"  />
		<result property="inqyNum" column="INQY_NUM"  />
		<result property="htmlUseYn" column="HTML_USE_YN"  />
		<result property="bullBordMsgeDelYn" column="BULL_BORD_MSGE_DEL_YN"  />
		<result property="notiBgnnDt" column="NOTI_BGNN_DT"  />
		<result property="notiEndDt" column="NOTI_END_DT"  />
		<result property="kybdr" column="KYBDR"  />
		<result property="inptDt" column="INPT_DT"  />
		<result property="inptAddr" column="INPT_ADDR"  />
		<result property="ismt" column="ISMT"  />
		<result property="revnDt" column="REVN_DT"  />
		<result property="revnAddr" column="REVN_ADDR"  /> 

   </resultMap>
	<insert id="boardPageDAO.insertBoardPage_S">
		<![CDATA[
			INSERT INTO BORD0300
				( SYS_DIV_CD
				  , BULL_BORD_MSGE_SEIL_NUM
				  , BULL_BORD_UID
				  , BULL_BORD_GRP_ID
				  , TPLVL_WRTN_INFO
				  , WRTN_ASWR_STGE
				  , WRTN_RGSTN_ORD
				  , ASWR_WRTN_NUM
				  , PPG_PERN_NM
				  , USR_ID
				  , BULL_BORD_MSGE_TTL
				  , BULL_BORD_MSGE_CTNT
				  , WRTN_SECR_NUM
				  , PPG_PERN_EMAIL
				  , INQY_NUM
				  , HTML_USE_YN
				  , BULL_BORD_MSGE_DEL_YN
				  , NOTI_BGNN_DT
				  , NOTI_END_DT
				  , KYBDR
				  , INPT_DT
				  , INPT_ADDR
				  , ISMT
				  , REVN_DT
				  , REVN_ADDR
				   )
					  
			VALUES ( #sysDivCd#
				  ,
				  (SELECT NVL(MAX(BULL_BORD_MSGE_SEIL_NUM),0) + 1 
			           FROM BORD0300
			           WHERE SYS_DIV_CD=#sysDivCd#
								AND BULL_BORD_UID=#bullBordUid#
								AND BULL_BORD_GRP_ID=#bullBordGrpId#
			          	)
				  , #bullBordUid#
				  , #bullBordGrpId#
				  , #tplvlWrtnInfo#
				  , #wrtnAswrStge#
				  , (SELECT NVL(MAX(BULL_BORD_MSGE_SEIL_NUM),0) + 1 
			           FROM BORD0300
			           WHERE SYS_DIV_CD=#sysDivCd#
								AND BULL_BORD_UID=#bullBordUid#
								AND BULL_BORD_GRP_ID=#bullBordGrpId#
			          	)
				  , #aswrWrtnNum#
				  , #ppgPernNm#
				  , #usrId#
				  , #bullBordMsgeTtl#
				  , #bullBordMsgeCtnt#
				  , #wrtnSecrNum#
				  , #ppgPernEmail#
				  , #inqyNum#
				  , #htmlUseYn#
				  , #bullBordMsgeDelYn#
				  , #notiBgnnDt#
				  , #notiEndDt#
				  , #kybdr#
				  , SYSDATE
				  , #inptAddr#
				  , #ismt#
				  , #revnDt#
				  , #revnAddr#
				  )
		
		]]>
	</insert>

	<update id="boardPageDAO.updateBoardPage_S">
		<![CDATA[
			UPDATE BORD0300
			SET SYS_DIV_CD=#sysDivCd#
				, BULL_BORD_MSGE_SEIL_NUM=#bullBordMsgeSeilNum#
				, BULL_BORD_UID=#bullBordUid#
				, BULL_BORD_MSGE_TTL=#bullBordMsgeTtl#
				, BULL_BORD_MSGE_CTNT=#bullBordMsgeCtnt#
						WHERE SYS_DIV_CD=#sysDivCd#
								AND BULL_BORD_MSGE_SEIL_NUM=#bullBordMsgeSeilNum#
								AND BULL_BORD_UID=#bullBordUid#
								AND BULL_BORD_GRP_ID=#bullBordGrpId#
				]]>
	</update>
	
	<delete id="boardPageDAO.deleteBoardPage_S" >
		<![CDATA[
			DELETE FROM BORD0300 
						WHERE SYS_DIV_CD=#sysDivCd#
								AND BULL_BORD_MSGE_SEIL_NUM=#bullBordMsgeSeilNum#
								AND BULL_BORD_UID=#bullBordUid#
								AND BULL_BORD_GRP_ID=#bullBordGrpId#
				]]>
	</delete>
	
	<select id="boardPageDAO.selectBoardPage_S" parameterClass="boardSerarchVO" resultMap="bordPage">    		
 		SELECT AA.SYS_DIV_CD,
                       AA.BULL_BORD_MSGE_SEIL_NUM,
                       AA.BULL_BORD_UID,
                       AA.BULL_BORD_GRP_ID,
                       AA.TPLVL_WRTN_INFO,
                       AA.WRTN_ASWR_STGE,
                       AA.WRTN_RGSTN_ORD,
                       AA.ASWR_WRTN_NUM,
                       AA.PPG_PERN_NM,
                       AA.USR_ID,
                       AA.BULL_BORD_MSGE_TTL,
                       AA.BULL_BORD_MSGE_CTNT,
                       AA.WRTN_SECR_NUM,
                       AA.PPG_PERN_EMAIL,
                       AA.INQY_NUM,
                       AA.HTML_USE_YN,
                       AA.BULL_BORD_MSGE_DEL_YN,
                       AA.NOTI_BGNN_DT,
                       AA.NOTI_END_DT,
                       BB.FL_SZ, 
                       BB.FL_RFTA,
                       BB.FL_NM,
                       BB.BULL_BORD_MSGE_ATTC_FL_NUM,  
                       AA.KYBDR,
                       AA.INPT_DT,
                       AA.INPT_ADDR,
                       AA.ISMT,
                       AA.REVN_DT,
                       AA.REVN_ADDR 
                  FROM BORD0300 AA,BORD0400 BB 
                  WHERE AA.SYS_DIV_CD=BB.SYS_DIV_CD(+)
                  AND AA.BULL_BORD_MSGE_SEIL_NUM=BB.BULL_BORD_MSGE_SEIL_NUM(+)
                  AND AA.BULL_BORD_UID=BB.BULL_BORD_UID(+)
                  AND AA.BULL_BORD_GRP_ID=BB.BULL_BORD_GRP_ID(+)
                  				AND AA.SYS_DIV_CD=#sysDivCd#
								AND AA.BULL_BORD_MSGE_SEIL_NUM=#bullBordMsgeSeilNum#
								AND AA.BULL_BORD_UID=#bullBordUid#
								AND AA.BULL_BORD_GRP_ID=#bullBordGrpId#
	</select>
	
	<select id="boardPageDAO.selectBoardPageList_D" parameterClass="boardSerarchVO" resultClass="egovMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (
				SELECT
						AA.SYS_DIV_CD,
						AA.BULL_BORD_MSGE_SEIL_NUM,
                       	AA.BULL_BORD_UID,
                       	AA.BULL_BORD_GRP_ID,
                       	AA.TPLVL_WRTN_INFO,
                       	AA.WRTN_ASWR_STGE,
                       	AA.WRTN_RGSTN_ORD,
                       	AA.ASWR_WRTN_NUM,
                       	AA.PPG_PERN_NM,
                       	AA.USR_ID,
                       	AA.BULL_BORD_MSGE_TTL,
                       	AA.BULL_BORD_MSGE_CTNT,
                       	AA.WRTN_SECR_NUM,
                       	AA.PPG_PERN_EMAIL,
                       	AA.INQY_NUM,
                       	AA.HTML_USE_YN,
                       	AA.BULL_BORD_MSGE_DEL_YN,
                       	AA.NOTI_BGNN_DT,
                       	AA.NOTI_END_DT, 
                       	BB.FL_RFTA,
                       	BB.FL_NM,
                       	BB.FL_SZ, 
                       	AA.KYBDR,
                       	AA.INPT_DT,
                       	AA.INPT_ADDR,
                       	AA.ISMT,
                       	AA.REVN_DT,
                       	AA.REVN_ADDR 
				FROM BORD0300 AA,BORD0400 BB
				WHERE AA.SYS_DIV_CD=BB.SYS_DIV_CD(+)
                  AND AA.BULL_BORD_MSGE_SEIL_NUM=BB.BULL_BORD_MSGE_SEIL_NUM(+)
                  AND AA.BULL_BORD_UID=BB.BULL_BORD_UID(+)
                  AND AA.BULL_BORD_GRP_ID=BB.BULL_BORD_GRP_ID(+)
				<isNotEmpty prepend="AND" property="sysDivCd" >
					 	AA.SYS_DIV_CD=#sysDivCd#
				</isNotEmpty> 
				<isNotEmpty prepend="AND" property="bullBordUid" >
					    AA.BULL_BORD_UID=#bullBordUid#
				 </isNotEmpty> 
				 <isNotEmpty prepend="AND" property="bullBordGrpId" >
					 	AA.BULL_BORD_GRP_ID=#bullBordGrpId#
				 </isNotEmpty> 
				 <isEqual prepend="AND" property="searchCondition" compareValue="0">
						AA.SYS_DIV_CD = #searchKeyword#
				 </isEqual>
				 <isEqual prepend="AND" property="searchCondition" compareValue="1">
						AA.BULL_BORD_MSGE_SEIL_NUM LIKE '%' || #searchKeyword# || '%'
				 </isEqual>
					ORDER BY 
						AA.SYS_DIV_CD ASC
							, AA.BULL_BORD_MSGE_SEIL_NUM DESC
							, AA.BULL_BORD_UID DESC
							, AA.BULL_BORD_GRP_ID DESC 
		<![CDATA[					
	) A WHERE ROWNUM <= #lastIndex#
)WHERE RNUM > #firstIndex#
]]>
	</select>	
	<select id="boardPageDAO.selectBoardPageListTotCnt_S" parameterClass="boardSerarchVO" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM BORD0300 AA,BORD0400 BB
			WHERE AA.SYS_DIV_CD=BB.SYS_DIV_CD(+)
                  AND AA.BULL_BORD_MSGE_SEIL_NUM=BB.BULL_BORD_MSGE_SEIL_NUM(+)
                  AND AA.BULL_BORD_UID=BB.BULL_BORD_UID(+)
                  AND AA.BULL_BORD_GRP_ID=BB.BULL_BORD_GRP_ID(+)
                    <isNotEmpty prepend="AND" property="sysDivCd" >
					 	AA.SYS_DIV_CD=#sysDivCd#
				  </isNotEmpty> 
				 <isNotEmpty prepend="AND" property="bullBordUid" >
					    AA.BULL_BORD_UID=#bullBordUid#
				 </isNotEmpty> 
				  <isNotEmpty prepend="AND" property="bullBordGrpId" >
					 	AA.BULL_BORD_GRP_ID=#bullBordGrpId#
				  </isNotEmpty> 
			<isEqual prepend="AND" property="searchCondition" compareValue="0">
				AA.SYS_DIV_CD = #searchKeyword#
			</isEqual>
			<isEqual prepend="AND" property="searchCondition" compareValue="1">
				AA.BULL_BORD_MSGE_SEIL_NUM LIKE '%' || #searchKeyword# || '%'
			</isEqual>
	</select> 
	
	<!-- 메인화면공지사항처리  -->
	<select id="boardPageDAO.selectBoardPageViewList_D" parameterClass="boardSerarchVO"  resultMap="bordResultMap">
SELECT * FROM (
	SELECT A.*, ROWNUM RNUM FROM (
				 SELECT AA.SYS_DIV_CD,
                       AA.BULL_BORD_MSGE_SEIL_NUM,
                       AA.BULL_BORD_UID,
                       AA.BULL_BORD_GRP_ID,
                       AA.TPLVL_WRTN_INFO,
                       AA.WRTN_ASWR_STGE,
                       AA.WRTN_RGSTN_ORD,
                       AA.ASWR_WRTN_NUM,
                       AA.PPG_PERN_NM,
                       AA.USR_ID,
                       AA.BULL_BORD_MSGE_TTL,
                       AA.BULL_BORD_MSGE_CTNT,
                       AA.WRTN_SECR_NUM,
                       AA.PPG_PERN_EMAIL,
                       AA.INQY_NUM,
                       AA.HTML_USE_YN,
                       AA.BULL_BORD_MSGE_DEL_YN,
                       AA.NOTI_BGNN_DT,
                       AA.NOTI_END_DT, 
                       AA.ATTACH_FILE_COUNT,
                       AA.RECENTLY_FLAG  ,
                       BB.FL_RFTA,
                       BB.FL_NM, 
                       AA.KYBDR,
                       AA.INPT_DT,
                       AA.INPT_ADDR,
                       AA.ISMT,
                       AA.REVN_DT,
                       AA.REVN_ADDR 
                  FROM BORD0300 AA,BORD0400 BB
                WHERE   AA.SYS_DIV_CD=BB.SYS_DIV_CD(+)
                  AND AA.BULL_BORD_MSGE_SEIL_NUM=BB.BULL_BORD_MSGE_SEIL_NUM(+)
                  AND AA.BULL_BORD_UID=BB.BULL_BORD_UID(+)
                  AND AA.BULL_BORD_GRP_ID=BB.BULL_BORD_GRP_ID(+)
                   <isNotEmpty prepend="AND" property="sysDivCd" >
					 	AA.SYS_DIV_CD=#sysDivCd#
				  </isNotEmpty> 
				 <isNotEmpty prepend="AND" property="bullBordUid" >
					    AA.BULL_BORD_UID=#bullBordUid#
				 </isNotEmpty> 
				  <isNotEmpty prepend="AND" property="bullBordGrpId" >
					 	AA.BULL_BORD_GRP_ID=#bullBordGrpId#
				  </isNotEmpty> 
					ORDER BY 
						AA.SYS_DIV_CD ASC
							, AA.BULL_BORD_MSGE_SEIL_NUM DESC
							, AA.BULL_BORD_UID DESC
							, AA.BULL_BORD_GRP_ID DESC 
								
		<![CDATA[					
	) A WHERE ROWNUM <= #lastIndex#
)WHERE RNUM >= #firstIndex#
]]>
	</select>	
	<select id="boardPageDAO.selectBoardPageViewListTotCnt_S" parameterClass="boardSerarchVO" resultClass="int">
			SELECT COUNT(*) totcnt  
               FROM BORD0300 AA,BORD0400 BB
                WHERE   AA.SYS_DIV_CD=BB.SYS_DIV_CD(+)
                  AND AA.BULL_BORD_MSGE_SEIL_NUM=BB.BULL_BORD_MSGE_SEIL_NUM(+)
                  AND AA.BULL_BORD_UID=BB.BULL_BORD_UID(+)
                  AND AA.BULL_BORD_GRP_ID=BB.BULL_BORD_GRP_ID(+)
                   <isNotEmpty prepend="AND" property="sysDivCd" >
					 	AA.SYS_DIV_CD=#sysDivCd#
				  </isNotEmpty> 
				 <isNotEmpty prepend="AND" property="bullBordUid" >
					    AA.BULL_BORD_UID=#bullBordUid#
				 </isNotEmpty> 
				  <isNotEmpty prepend="AND" property="bullBordGrpId" >
					 	AA.BULL_BORD_GRP_ID=#bullBordGrpId#
				  </isNotEmpty> 
	</select>
</sqlMap>

