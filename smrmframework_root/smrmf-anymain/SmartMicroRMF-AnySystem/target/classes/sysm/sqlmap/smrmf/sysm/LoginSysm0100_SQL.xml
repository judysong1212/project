<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="MSFSysm0100">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	 <typeAlias  alias="msfSysm0100SerarchVO" type="com.app.smrmf.sysm.server.vo.SysIfSysm0100SrhVO"/>  
	 <typeAlias  alias="sysmLoginVO" type="com.app.smrmf.sysm.server.vo.system.LoginVO"/>
	
	<resultMap id="msfSysm0100" class="com.app.smrmf.sysm.server.vo.SysIfSysm0100VO">
	    <result property="dpobCd" column="DPOB_CD" />
		<result property="sysDivCd" column="SYS_DIV_CD"  />
		<result property="sysDivNm" column="SYS_DIV_NM"  />
		<result property="usrId" column="USR_ID" />
		<result property="usrNm" column="USR_NM" />
		<result property="usrDivCd" column="USR_DIV_CD" />
		<result property="usrDivNm" column="USR_DIV_NM" />
		<result property="systemkey" column="SYSTEMKEY" />
		<result property="deptCd" column="DEPT_CD" />
		<result property="deptNm" column="DEPT_NM" />
		<result property="usrTel" column="USR_TEL" />
		<result property="email" column="EMAIL" />
		<result property="pwd" column="PWD" />
		<result property="useYn" column="USE_YN" />
		<result property="kybdr" column="KYBDR" />
		<result property="inptDt" column="INPT_DT" />
		<result property="inptAddr" column="INPT_ADDR"  />
		<result property="ismt" column="ISMT" />
		<result property="revnDt" column="REVN_DT" />
		<result property="revnAddr" column="REVN_ADDR" />   
		<result property="payrMangDeptCd" column="PAYR_MANG_DEPT_CD" />
		<result property="payrMangDeptNm" column="PAYR_MANG_DEPT_NM" />
		<result property="mangeDeptCd" column="MANGE_DEPT_CD" />
		<result property="mangeDeptNm" column="MANGE_DEPT_NM" />
		<result property="tplvlDeptCd" column="TPLVL_DEPT_CD" />
		<result property="tplvlDeptNm" column="TPLVL_DEPT_NM" />
		<result property="payrMangDeptYn" column="PAYR_MANG_DEPT_YN" />
		<result property="usrAuthEepnYn" column="USR_AUTH_EEPN_YN" /> 
		<result property="pyspInsnYn" column="PYSP_INSN_YN" /> 
		<result property="notPyspInsnYn" column="NOT_PYSP_INSN_YN" /> 
		<result property="servcInptPrcsYn" column="SERVC_INPT_PRCS_YN" /> 
		<result property="yrtxInptPrcsYn" column="YRTX_INPT_PRCS_YN" /> 
		<result property="shttmInsnYn" column="SHTTM_INSN_YN" /> 
		<result property="usrAuthDivCd" column="USR_AUTH_DIV_CD" />
		<!-- 로그인 컬럼 추가 -->
		  <result property="lockat" column="LOCKAT" />
		  <result property="pwddate" column="PWD_DATE" />
		<result property="logincnt" column="LOGIN_CNT" />  
		<result property="admSysm0500" column="{usrId=USR_ID,sysDivCd=SYS_DIV_CD}"   select="LoginServiceDAO.getSelectSysm0500List_S"/>
		<result property="admUserInfo" column="{usrId=USR_ID,sysDivCd=SYS_DIV_CD,dpobCd=DPOB_CD}"   select="LoginServiceDAO.getSelectUserInfoList_S"/>
		<result property="admAuthCheckInfo" column="{usrId=USR_ID,sysDivCd=SYS_DIV_CD,dpobCd=DPOB_CD,payrMangDeptYn=PAYR_MANG_DEPT_YN}"   select="LoginServiceDAO.getSelectAuthCheck_S"/>
	</resultMap> 
	
	<!--  <result property="typOccuCd" column="TYP_OCCU_CD" />
	    <result property="typOccuNm" column="TYP_OCCU_NM" />
		<result property="pyspGrdeCd" column="PYSP_GRDE_CD" /> 
		<result property="pyspGrdeNm" column="PYSP_GRDE_NM" />  -->
	
	<resultMap id="msfUserInfo" class="com.app.smrmf.sysm.server.vo.system.MSFUserInfoVO">
	    <result property="dpobCd" column="DPOB_CD" />
		<result property="dpobNm" column="DPOB_NM" /> 
		<result property="sysDivCd" column="SYS_DIV_CD" />
		<result property="sysDivNm" column="SYS_DIV_NM" />
		<result property="accYr" column="ACC_YR" />
		<result property="systemkey" column="SYSTEMKEY" />
		<result property="hanNm" column="HAN_NM" />
		<result property="resnRegnNum" column="RESN_REGN_NUM" />
		<result property="deptCd" column="DEPT_CD" />
		<result property="deptNm" column="DEPT_NM" />
		<result property="businCd" column="BUSIN_CD" />
		<result property="businNm" column="BUSIN_NM" />
		<result property="payrMangDeptCd" column="PAYR_MANG_DEPT_CD" />
		<result property="payrMangDeptNm" column="PAY_MANGE_DEPT_NM" />
		<result property="authGrpSeilNum" column="AUTH_GRP_SEIL_NUM" />
		<result property="businDivCd" column="BUSIN_DIV_CD" />
		<result property="businDivNm" column="BUSIN_DIV_NM" />
		<result property="authGrpNm" column="AUTH_GRP_NM" />
		<result property="grde" column="GRDE" />  
		<result property="usrAuthEepnYn" column="USR_AUTH_EEPN_YN" /> 
		<result property="pyspInsnYn" column="PYSP_INSN_YN" /> 
		<result property="notPyspInsnYn" column="NOT_PYSP_INSN_YN" /> 
		<result property="servcInptPrcsYn" column="SERVC_INPT_PRCS_YN" /> 
		<result property="yrtxInptPrcsYn" column="YRTX_INPT_PRCS_YN" /> 
		<result property="shttmInsnYn" column="SHTTM_INSN_YN" /> 
		<result property="usrAuthDivCd" column="USR_AUTH_DIV_CD" />  
	</resultMap>  
	 
	
	<resultMap id="msfSysm0500" class="com.app.smrmf.sysm.server.vo.SysIfSysm0500VO"> 
	    <result property="sysDivCd" column="SYS_DIV_CD"/>
		<result property="authGrpSeilNum" column="AUTH_GRP_SEIL_NUM"/>
		<result property="usrId" column="USR_ID"/>
		<result property="usrAuthUseYn" column="USR_AUTH_USE_YN" />
		<result property="kybdr" column="KYBDR" />
		<result property="inptDt" column="INPT_DT" />
		<result property="ismt" column="ISMT" />
		<result property="revnDt" column="REVN_DT" />
		<result property="revnAddr" column="REVN_ADDR" />
	   <result property="inptAddr" column="INPT_ADDR" />   
	   <result property="admSysm0300" column="{authGrpSeilNum=AUTH_GRP_SEIL_NUM,sysDivCd=SYS_DIV_CD}"   select="LoginServiceDAO.getSelectSysm0300_S"/>  
	</resultMap>
	  
	
	<resultMap id="msfSysm0300" class="com.app.smrmf.sysm.server.vo.SysIfSysm0300VO">
		<result property="sysDivCd" column="SYS_DIV_CD" />
		<result property="authGrpSeilNum" column="AUTH_GRP_SEIL_NUM" />
		<result property="businDivCd" column="BUSIN_DIV_CD" />
		<result property="authGrpNm" column="AUTH_GRP_NM" />
		<result property="grde" column="GRDE" />
		<result property="authGrpUseYn" column="AUTH_GRP_USE_YN" />
		<result property="grpEpln" column="GRP_EPLN" />
		<result property="kybdr" column="KYBDR" />
		<result property="inptDt" column="INPT_DT" />
		<result property="ismt" column="ISMT"  />
		<result property="revnDt" column="REVN_DT" />
		<result property="revnAddr" column="REVN_ADDR" />
		<result property="inptAddr" column="INPT_ADDR"  />
	</resultMap>
	
	
	<resultMap id="msfAuthCheckVo" class="com.app.smrmf.sysm.server.vo.system.MSFAuthCheckVO">
	    <result property="dpobCd" column="DPOB_CD" />
		<result property="sysDivCd" column="SYS_DIV_CD"  /> 
		<result property="usrId" column="USR_ID" /> 
		<result property="usrDivCd" column="USR_DIV_CD" />
		
		<result property="authCheck01" column="AUTH_CHECK01" />
		<result property="authCheck02" column="AUTH_CHECK02" />
		<result property="authCheck03" column="AUTH_CHECK03" />
		<result property="authCheck04" column="AUTH_CHECK04" />
		<result property="authCheck05" column="AUTH_CHECK05" />
		<result property="authCheck06" column="AUTH_CHECK06" />
		<result property="authCheck07" column="AUTH_CHECK07" />
		<result property="authCheck08" column="AUTH_CHECK08" />
		<result property="authCheck09" column="AUTH_CHECK09" />
		<result property="authCheck10" column="AUTH_CHECK10" />
		
	</resultMap> 
	  
	  <!-- 로그인 정보 쿼리 -->
	<select id="LoginServiceDAO.selectSysm0100_S"  resultMap="msfSysm0100">
		<![CDATA[
			 SELECT
                  FF.DPOB_CD
                , FF.SYS_DIV_CD
                , FF.SYS_DIV_NM 
                , FF.USR_ID
                , FF.USR_NM
                , FF.USR_DIV_CD
                , FF.USR_DIV_NM
                , FF.SYSTEMKEY
                , FF.DEPT_CD
                , FF.DEPT_NM  
                , FF.USR_TEL
                , FF.EMAIL
                , FF.PWD
                , FF.USE_YN 
                , FF.USR_AUTH_EEPN_YN
			    , FF.PYSP_INSN_YN
			    , FF.NOT_PYSP_INSN_YN
			    , FF.SERVC_INPT_PRCS_YN
			    , FF.YRTX_INPT_PRCS_YN
			    , FF.SHTTM_INSN_YN
			    , FF.USR_AUTH_DIV_CD
                , CC.TPLVL_DEPT_CD
                , FF.INPT_DT
                , FF.LOCKAT
                , FF.PWD_DATE
                , FF.LOGIN_CNT
                , fcBass0400CDNM(CC.DPOB_CD,CC.TPLVL_DEPT_CD,'2') AS TPLVL_DEPT_NM
                 ,  (CASE
           WHEN DD.PAY_MANGE_DEPT_F_NDTN_USE_YN = 'Y'
           THEN
              DD.PAYR_MANG_DEPT_CD
           ELSE
              (CASE
                  WHEN CC.DEPT_CD =
                          (SELECT PAYR_MANG_DEPT_CD
                             FROM BASS0150 KK
                            WHERE     KK.DPOB_CD = CC.DPOB_CD
                                  AND KK.PAYR_MANG_DEPT_CD = FF.DEPT_CD)
                  THEN
                     CC.DEPT_CD
                  ELSE
                      (CASE
                          WHEN CC.HHRK_DEPT_CD =
                                  (SELECT PAYR_MANG_DEPT_CD
                                     FROM BASS0150 KK
                                    WHERE     KK.DPOB_CD = CC.DPOB_CD
                                          AND KK.PAYR_MANG_DEPT_CD = CC.HHRK_DEPT_CD)
                          THEN
                             CC.HHRK_DEPT_CD
                          ELSE
                             (CASE
                                 WHEN FF.USR_DIV_CD = 'D0010030'
                                 THEN
                                    CC.TPLVL_DEPT_CD
                                 ELSE
                                    CC.TPLVL_DEPT_CD
                              END)
                       END)
               END)
        END)
          AS PAYR_MANG_DEPT_CD 
      , (CASE
           WHEN DD.PAY_MANGE_DEPT_F_NDTN_USE_YN = 'Y'
           THEN
              fcBass0400CDNM (CC.DPOB_CD, DD.PAYR_MANG_DEPT_CD, '2')
           ELSE
           (CASE
                  WHEN CC.DEPT_CD =
                          (SELECT PAYR_MANG_DEPT_CD
                             FROM BASS0150 KK
                            WHERE     KK.DPOB_CD = CC.DPOB_CD
                                  AND KK.PAYR_MANG_DEPT_CD = FF.DEPT_CD)
                  THEN
                     fcBass0400CDNM (CC.DPOB_CD, CC.DEPT_CD, '2') 
                  ELSE
                      (CASE
                          WHEN CC.HHRK_DEPT_CD =
                                  (SELECT PAYR_MANG_DEPT_CD
                                     FROM BASS0150 KK
                                    WHERE     KK.DPOB_CD = CC.DPOB_CD
                                          AND KK.PAYR_MANG_DEPT_CD = CC.HHRK_DEPT_CD)
                          THEN
                               fcBass0400CDNM (CC.DPOB_CD, CC.HHRK_DEPT_CD, '2')
                          ELSE
                             (CASE
                                 WHEN FF.USR_DIV_CD = 'D0010030'
                                 THEN
                                     fcBass0400CDNM (CC.DPOB_CD,
                                            CC.TPLVL_DEPT_CD,
                                            '2')
                         ELSE
                               fcBass0400CDNM (CC.DPOB_CD,
                                            CC.TPLVL_DEPT_CD,
                                            '2')
                              END)
                       END)
               END) 
             
        END)
          AS PAYR_MANG_DEPT_NM
                , CC.MANGE_DEPT_CD 
                , fcBass0400CDNM(CC.DPOB_CD,CC.MANGE_DEPT_CD,'2') AS MANGE_DEPT_NM  
                , FF.KYBDR
                , FF.INPT_DT
                , FF.INPT_ADDR
                , FF.ISMT
                , FF.REVN_DT
                , FF.REVN_ADDR
                , (CASE WHEN DD.PAY_MANGE_DEPT_F_NDTN_USE_YN = 'Y' 
                        THEN  'Y'
                        ELSE  
                             (CASE WHEN FF.USR_DIV_CD = 'D0010025'  THEN 'Y' 
                                   WHEN FF.USR_DIV_CD = 'D0010030'  THEN 'P' 
                                   WHEN FF.USR_DIV_CD = 'D0010050'  THEN 'S' 
                                   WHEN FF.USR_DIV_CD = 'D0010090'  THEN 'A' 
                                  ELSE 'N' END)
                          END) AS  PAYR_MANG_DEPT_YN
            FROM  (
                       SELECT
                          BB.DPOB_CD
                        , AA.SYS_DIV_CD
                         ,fcBass0300CDNM(BB.DPOB_CD,AA.SYS_DIV_CD) AS SYS_DIV_NM 
                        , AA.USR_ID
                        , AA.USR_NM
                        , AA.USR_DIV_CD
                         ,fcBass0300CDNM(BB.DPOB_CD,AA.USR_DIV_CD) AS USR_DIV_NM
                        , AA.SYSTEMKEY
                        , AA.DEPT_CD
                        , fcBass0400CDNM(BB.DPOB_CD,AA.DEPT_CD,'2') AS DEPT_NM  
                        , AA.TYP_OCCU_CD
                        ,  fcBass0320CDNM(BB.DPOB_CD,AA.TYP_OCCU_CD)  AS TYP_OCCU_NM
                        , AA.PYSP_GRDE_CD
                        , fcBass0300CDNM(BB.DPOB_CD,AA.PYSP_GRDE_CD) AS PYSP_GRDE_NM 
                        , AA.USR_TEL
                        , AA.EMAIL
                        , AA.PWD
                        , AA.USE_YN 
                        , AA.USR_AUTH_EEPN_YN
					    , AA.PYSP_INSN_YN
					    , AA.NOT_PYSP_INSN_YN
					    , AA.SERVC_INPT_PRCS_YN
					    , AA.YRTX_INPT_PRCS_YN
					    , AA.SHTTM_INSN_YN
					    , AA.USR_AUTH_DIV_CD
                        , AA.KYBDR
                        , AA.INPT_DT
                        , AA.INPT_ADDR
                        , AA.ISMT
                        , AA.REVN_DT
                        , AA.REVN_ADDR
                        , AA.LOCKAT
                        , AA.PWD_DATE
                        , AA.LOGIN_CNT
                       FROM SYSM0100 AA, BASS0100 BB
                       WHERE  AA.SYS_DIV_CD = BB.SYS_DIV_CD
                         AND AA.USE_YN = 'Y'  
                   ) FF  , BASS0400 CC ,BASS0150 DD
                        WHERE FF.DEPT_CD = CC.DEPT_CD
                          AND FF.DPOB_CD = CC.DPOB_CD 
                          AND FF.DPOB_CD = DD.DPOB_CD(+)
                          AND FF.USR_ID  = DD.PAY_MANGE_DEPT_WHLE_PERN_CHRG(+) 
						  AND FF.USR_ID=#usrId# 
		]]>
		<isNotEmpty prepend="AND" property="sysDivCd">
				   FF.SYS_DIV_CD=#sysDivCd#  
		</isNotEmpty>    		
				
	</select> 
	
		<select  id="LoginServiceDAO.getSelectSysm0500List_S"  resultMap="msfSysm0500">
		<![CDATA[
		                      SELECT  
                                     AA.SYS_DIV_CD
                                   , AA.AUTH_GRP_SEIL_NUM
                                   , AA.USR_ID
                                   , AA.USR_AUTH_USE_YN
                                   , BB.BUSIN_DIV_CD 
                                   , BB.AUTH_GRP_NM
                                   , BB.GRDE
                                   , BB.AUTH_GRP_USE_YN
                                   , BB.GRP_EPLN  
                                   , BB.KYBDR
								   , BB.INPT_DT
								   , BB.ISMT
								   , BB.REVN_DT
								   , BB.REVN_ADDR
								   , BB.INPT_ADDR
                                FROM SYSM0500 AA, SYSM0300 BB  
                                WHERE  AA.USR_ID=#usrId#
				                  AND  AA.SYS_DIV_CD=#sysDivCd#  
                                  AND  BB.AUTH_GRP_USE_YN = 'Y'
                                  AND  AA.USR_AUTH_USE_YN = 'Y'
                                  AND  AA.SYS_DIV_CD = BB.SYS_DIV_CD
                                  AND  AA.AUTH_GRP_SEIL_NUM = BB.AUTH_GRP_SEIL_NUM 
                     
			]]>
	</select>
	 
	   <!-- TODO 설정값 중 로그인 사용자의 정보를 가지고 오는데 업무담당자와 기간제,무기계약직 구분하여 정보를 가지고 와야함 차후 수정 BASS0150 테이블 정보 추가 필요 급여 담당자 정보를 가져와야함...-->
		<select  id="LoginServiceDAO.getSelectUserInfoList_S"  resultMap="msfUserInfo">
		<![CDATA[
		         SELECT
                  BB.DPOB_CD
                , BB.DPOB_NM
                 , AA.SYS_DIV_CD
                 ,fcBass0300CDNM(BB.DPOB_CD,AA.SYS_DIV_CD) AS SYS_DIV_NM
                , (SELECT NVL(MAX(ACC_YR),SUBSTR(TO_CHAR(SYSDATE,'YYYYMMDD'),1,4)) FROM  BUGT0010 CC
                   WHERE CC.DPOB_CD = BB.DPOB_CD) AS ACC_YR 
                , AA.SYSTEMKEY
                , AA.USR_NM AS HAN_NM 
                , ('') AS RESN_REGN_NUM
                , AA.DEPT_CD
                , fcBass0400CDNM(BB.DPOB_CD,AA.DEPT_CD,'2') AS DEPT_NM
                , AA.USR_AUTH_EEPN_YN
			    , AA.PYSP_INSN_YN
			    , AA.NOT_PYSP_INSN_YN
			    , AA.SERVC_INPT_PRCS_YN
			    , AA.YRTX_INPT_PRCS_YN
			    , AA.SHTTM_INSN_YN
			    , AA.USR_AUTH_DIV_CD 
                , DD.BUSIN_CD
                , fcBass0500CDNM(BB.DPOB_CD,AA.DEPT_CD,SUBSTR(DD.BUSIN_CD,1,4),DD.BUSIN_CD) AS BUSIN_NM
                , FF.PAYR_MANG_DEPT_CD
                , FF.PAY_MANGE_DEPT_NM 
                , EE.AUTH_GRP_SEIL_NUM
                , EE.BUSIN_DIV_CD
                ,fcBass0300CDNM(BB.DPOB_CD,EE.BUSIN_DIV_CD) AS BUSIN_DIV_NM 
                , EE.AUTH_GRP_NM
                , EE.GRDE
            FROM SYSM0100 AA, BASS0100 BB , PSNL0100 DD,BASS0150 FF,
                 (SELECT  
                                     AA.SYS_DIV_CD
                                   , AA.AUTH_GRP_SEIL_NUM
                                   , AA.USR_ID
                                   , BB.BUSIN_DIV_CD 
                                   , BB.AUTH_GRP_NM
                                   , BB.GRDE
                                   , BB.AUTH_GRP_USE_YN
                                   , BB.GRP_EPLN   
                                FROM SYSM0500 AA, SYSM0300 BB   
                                 WHERE  AA.USR_AUTH_USE_YN = 'Y'
                                  AND  AA.SYS_DIV_CD = BB.SYS_DIV_CD
                                  AND  AA.AUTH_GRP_SEIL_NUM = BB.AUTH_GRP_SEIL_NUM ) EE
            WHERE AA.SYS_DIV_CD = BB.SYS_DIV_CD  
              AND AA.SYSTEMKEY = DD.SYSTEMKEY(+)
              AND AA.USR_ID = EE.USR_ID(+)
              AND AA.SYS_DIV_CD = EE.SYS_DIV_CD(+)
              AND AA.USE_YN  = 'Y'
              AND AA.USR_ID = FF.PAY_MANGE_DEPT_WHLE_PERN_CHRG(+)  
              AND DD.DPOB_CD(+) = #dpobCd#
              AND AA.USR_ID=#usrId#
              AND AA.SYS_DIV_CD=#sysDivCd#  
              AND BB.DPOB_CD = #dpobCd#   
			]]>
	</select>	
 
	 <select id="LoginServiceDAO.getSelectSysm0300_S"   resultMap="msfSysm0300">
		<![CDATA[
			SELECT
				  SYS_DIV_CD
				, AUTH_GRP_SEIL_NUM
				, BUSIN_DIV_CD
				, AUTH_GRP_NM
				, GRDE
				, AUTH_GRP_USE_YN
				, GRP_EPLN
				, KYBDR
				, INPT_DT
				, ISMT
				, REVN_DT
				, REVN_ADDR
				, INPT_ADDR
			FROM SYSM0300
					 	WHERE  AUTH_GRP_SEIL_NUM=#authGrpSeilNum#
						AND SYS_DIV_CD=#sysDivCd#  
				]]>
	</select> 
	<!-- 로그인 체크 쿼리 -->
	 	 <select id="LoginServiceDAO.getSelectAuthCheck_S"   resultMap="msfAuthCheckVo">
		<![CDATA[
		
		SELECT
                  (#dpobCd#) AS DPOB_CD
                , AA.SYS_DIV_CD 
                , AA.USR_ID 
                , AA.USR_DIV_CD  
                , (CASE WHEN #payrMangDeptYn# = 'Y' THEN  'FALSE' 
                        WHEN #payrMangDeptYn# = 'P' THEN  'TRUE' 
                        WHEN #payrMangDeptYn# IN ('S','A') THEN  'TRUE' 
                        ELSE 'FALSE'  END) AS  AUTH_CHECK01
                , (CASE WHEN #payrMangDeptYn# = 'Y' THEN 
                         (CASE WHEN  AA.USR_DIV_CD IN ('D0010020','D0010010')  THEN 'FALSE' 
                            WHEN  AA.USR_DIV_CD IN ('D0010030') THEN 'FALSE'
                            WHEN  AA.USR_DIV_CD IN ('D0010040') THEN 'FALSE'
                            WHEN  AA.USR_DIV_CD  IN  ('D0010090','D0010025','D0010050')  THEN 'TRUE' 
                            ELSE 'FALSE' END) 
                        WHEN #payrMangDeptYn# = 'P' THEN 
                         (CASE WHEN  AA.USR_DIV_CD IN ('D0010020','D0010010')  THEN 'FALSE' 
                            WHEN     AA.USR_DIV_CD IN ('D0010030') THEN 'FALSE'
                            WHEN     AA.USR_DIV_CD IN ('D0010040') THEN 'FALSE'
                            WHEN     AA.USR_DIV_CD IN  ('D0010090','D0010025','D0010050')  THEN 'TRUE' 
                            ELSE 'FALSE' END)      
                        WHEN #payrMangDeptYn# IN ('S','A') THEN   
                          (CASE WHEN  AA.USR_DIV_CD IN ('D0010020','D0010010')  THEN 'FALSE' 
                            WHEN  AA.USR_DIV_CD IN ('D0010030','D0010040') THEN 'FALSE'
                            WHEN  AA.USR_DIV_CD  IN  ('D0010090','D0010025','D0010050')  THEN 'TRUE' 
                            ELSE 'FALSE' END) 
                        ELSE  
                         (CASE WHEN  AA.USR_DIV_CD IN ('D0010020','D0010010')  THEN 'FALSE' 
                            WHEN  AA.USR_DIV_CD IN ('D0010030','D0010040') THEN 'FALSE'
                            WHEN  AA.USR_DIV_CD  IN  ('D0010090','D0010025','D0010050')  THEN 'TRUE' 
                            ELSE 'FALSE' END)  
                        END) AS  AUTH_CHECK02   
                , (CASE WHEN #payrMangDeptYn# = 'Y' THEN 
                         (CASE WHEN  AA.USR_DIV_CD IN ('D0010020','D0010010')  THEN 'TRUE' 
                            WHEN  AA.USR_DIV_CD IN ('D0010030','D0010040') THEN 'TRUE'
                              WHEN AA.USR_DIV_CD IN (  'D0010025' ) THEN  'FALSE'   
                 			 WHEN AA.USR_DIV_CD IN ('D0010090',   'D0010050') THEN  'TRUE'
                            ELSE 'FALSE' END) 
                        WHEN #payrMangDeptYn# = 'P' THEN   
                          (CASE WHEN  AA.USR_DIV_CD IN ('D0010020','D0010010')  THEN 'FALSE' 
                            WHEN  AA.USR_DIV_CD IN ('D0010040') THEN 'FALSE'
                            WHEN  AA.USR_DIV_CD IN ('D0010030') THEN 'TRUE'
                            WHEN  AA.USR_DIV_CD IN ('D0010025')     THEN 'FALSE'
                            WHEN  AA.USR_DIV_CD  IN  ('D0010090','D0010050' )  THEN 'TRUE' 
                            ELSE 'FALSE' END)      
                        WHEN #payrMangDeptYn# IN ('S','A') THEN   
                          (CASE WHEN  AA.USR_DIV_CD IN ('D0010020','D0010010')  THEN 'FALSE' 
                            WHEN  AA.USR_DIV_CD IN ('D0010030','D0010040') THEN 'FALSE'
                            WHEN  AA.USR_DIV_CD IN ('D0010025')     THEN 'FALSE'
                            WHEN  AA.USR_DIV_CD  IN  ('D0010090','D0010050' )  THEN 'TRUE' 
                            ELSE 'FALSE' END) 
                        ELSE  
                         (CASE WHEN  AA.USR_DIV_CD IN ('D0010020','D0010010')  THEN 'FALSE' 
                            WHEN  AA.USR_DIV_CD IN ('D0010030','D0010040') THEN 'FALSE'
                            WHEN  AA.USR_DIV_CD IN ('D0010025') THEN 'FALSE'
                            WHEN  AA.USR_DIV_CD  IN  ('D0010090','D0010050')  THEN 'TRUE' 
                            ELSE 'FALSE' END)  
                        END) AS  AUTH_CHECK03   
                  , (CASE WHEN #payrMangDeptYn# = 'Y' THEN 
                         (CASE WHEN  AA.USR_DIV_CD IN ('D0010030','D0010020')  THEN  
                                    'FALSE'
                            WHEN  AA.USR_DIV_CD IN ('D0010040','D0010010') THEN  
                                       (CASE WHEN BB.TYP_OCCU_CD_CNT > 1 THEN 'TRUE' ELSE 'FALSE' END)
                            WHEN  AA.USR_DIV_CD IN ('D0010025')     THEN 
                                   (CASE WHEN BB.TYP_OCCU_CD_CNT > 1 THEN 'TRUE' ELSE 'FALSE' END)
                            WHEN  AA.USR_DIV_CD  IN  ('D0010090','D0010025','D0010050')  THEN 'TRUE' 
                            ELSE 'FALSE' END) 
                         WHEN #payrMangDeptYn# = 'P' THEN   
                          (CASE WHEN  AA.USR_DIV_CD IN ('D0010010')  THEN  
                                   (CASE WHEN BB.TYP_OCCU_CD_CNT > 1 THEN 'TRUE' ELSE 'FALSE' END)
                            WHEN  AA.USR_DIV_CD IN ('D0010030') THEN 'TRUE' 
                            WHEN  AA.USR_DIV_CD IN ('D0010020' ,'D0010040') THEN 'FALSE' 
                            WHEN  AA.USR_DIV_CD IN ('D0010025')     THEN   
                                   (CASE WHEN BB.TYP_OCCU_CD_CNT > 1 THEN 'TRUE' ELSE 'FALSE' END)
                            WHEN  AA.USR_DIV_CD  IN  ('D0010090','D0010050' )  THEN 'TRUE' 
                            ELSE 'FALSE' END)      
                        WHEN #payrMangDeptYn# IN ('S','A') THEN   
                          (CASE WHEN  AA.USR_DIV_CD IN ('D0010010')  THEN  
                                   (CASE WHEN BB.TYP_OCCU_CD_CNT > 1 THEN 'TRUE' ELSE 'FALSE' END)
                            WHEN  AA.USR_DIV_CD IN ('D0010030') THEN  
                                   (CASE WHEN BB.TYP_OCCU_CD_CNT > 1 THEN 'TRUE' ELSE 'FALSE' END)
                            WHEN  AA.USR_DIV_CD IN ('D0010040','D0010020' ) THEN   'FALSE' 
                            WHEN  AA.USR_DIV_CD IN ('D0010025')     THEN   
                                   (CASE WHEN BB.TYP_OCCU_CD_CNT > 1 THEN 'TRUE' ELSE 'FALSE' END)
                            WHEN  AA.USR_DIV_CD  IN  ('D0010090','D0010050' )  THEN 'TRUE' 
                            ELSE 'FALSE' END) 
                        ELSE  
                         (CASE WHEN  AA.USR_DIV_CD IN ('D0010020','D0010040')  THEN  'FALSE' 
                            WHEN  AA.USR_DIV_CD IN ('D0010030','D0010010') THEN 
                                         (CASE WHEN BB.TYP_OCCU_CD_CNT > 1 THEN 'TRUE' ELSE 'FALSE' END)
                            WHEN  AA.USR_DIV_CD IN ('D0010025') THEN 
                                         (CASE WHEN BB.TYP_OCCU_CD_CNT > 1 THEN 'TRUE' ELSE 'FALSE' END)
                            WHEN  AA.USR_DIV_CD  IN  ('D0010090','D0010050')  THEN 'TRUE' 
                            ELSE 'FALSE' END)  
                        END) AS  AUTH_CHECK04  
                         , (CASE WHEN #payrMangDeptYn# = 'Y' THEN 
	                         (CASE WHEN  AA.USR_DIV_CD IN ('D0010020','D0010040')  THEN  
	                                   'FALSE' 
	                            WHEN  AA.USR_DIV_CD IN ('D0010030','D0010010') THEN  
	                             			(CASE WHEN BB.DTIL_OCCU_CNT > 1 THEN 'TRUE' ELSE 'FALSE' END)
	                            WHEN  AA.USR_DIV_CD IN ('D0010025')     THEN 
	                                   (CASE WHEN BB.DTIL_OCCU_CNT > 1 THEN 'TRUE' ELSE 'FALSE' END)
	                            WHEN  AA.USR_DIV_CD  IN  ('D0010090','D0010050' )  THEN 'TRUE' 
	                            ELSE 'FALSE' END) 
                          WHEN #payrMangDeptYn# = 'P' THEN   
	                          (CASE  WHEN AA.USR_DIV_CD IN ('D0010030','D0010010') THEN   
	                                   (CASE WHEN BB.DTIL_OCCU_CNT > 1 THEN 'TRUE' ELSE 'FALSE' END)
	                            WHEN  AA.USR_DIV_CD IN ('D0010020','D0010040') THEN  'FALSE'  
	                            WHEN  AA.USR_DIV_CD IN ('D0010025')     THEN  
	                                 (CASE WHEN BB.DTIL_OCCU_CNT > 1 THEN 'TRUE' ELSE 'FALSE' END)
	                            WHEN  AA.USR_DIV_CD  IN  ('D0010090','D0010050' )  THEN 'TRUE' 
	                            ELSE 'FALSE' END)     
                        WHEN #payrMangDeptYn# IN ('S','A') THEN   
                          (CASE WHEN  AA.USR_DIV_CD IN ('D0010020','D0010040')  THEN    'FALSE'  
                            WHEN  AA.USR_DIV_CD IN ('D0010030','D0010010') THEN  
                                   (CASE WHEN BB.DTIL_OCCU_CNT > 1 THEN 'TRUE' ELSE 'FALSE' END)
                            WHEN  AA.USR_DIV_CD IN ('D0010025')     THEN   
                                   (CASE WHEN BB.DTIL_OCCU_CNT > 1 THEN 'TRUE' ELSE 'FALSE' END)
                            WHEN  AA.USR_DIV_CD  IN  ('D0010090','D0010050' )  THEN 'TRUE' 
                            ELSE 'FALSE' END) 
                        ELSE  
                         (CASE WHEN  AA.USR_DIV_CD IN ('D0010020','D0010040')  THEN  'FALSE'  
                            WHEN  AA.USR_DIV_CD IN ('D0010030', 'D0010010') THEN 
                                         (CASE WHEN BB.DTIL_OCCU_CNT > 1 THEN 'TRUE' ELSE 'FALSE' END)
                            WHEN  AA.USR_DIV_CD IN ('D0010025') THEN 
                                         (CASE WHEN BB.DTIL_OCCU_CNT > 1 THEN 'TRUE' ELSE 'FALSE' END)
                            WHEN  AA.USR_DIV_CD  IN  ('D0010090','D0010050')  THEN 'TRUE' 
                            ELSE 'FALSE' END)  
                        END) AS  AUTH_CHECK05  
                      , (CASE WHEN #payrMangDeptYn# = 'Y' THEN 
                         (CASE WHEN  AA.USR_DIV_CD IN ('D0010020','D0010040')  THEN 'TRUE' 
                            WHEN  AA.USR_DIV_CD IN ('D0010030','D0010010') THEN 'FALSE'
                            WHEN  AA.USR_DIV_CD  IN  ('D0010090','D0010025','D0010050')  THEN 'TRUE' 
                            ELSE 'FALSE' END) 
                        WHEN #payrMangDeptYn# IN ('S','A') THEN   
                          (CASE WHEN  AA.USR_DIV_CD IN ('D0010020','D0010040')  THEN 'TRUE' 
                            WHEN  AA.USR_DIV_CD IN ('D0010030','D0010010') THEN 'FALSE'
                            WHEN  AA.USR_DIV_CD IN ('D0010025')     THEN 'TRUE'
                            WHEN  AA.USR_DIV_CD  IN  ('D0010090','D0010050' )  THEN 'TRUE' 
                            ELSE 'FALSE' END) 
                        ELSE  
                         (CASE WHEN  AA.USR_DIV_CD IN ('D0010020','D0010040')  THEN 'TRUE' 
                            WHEN  AA.USR_DIV_CD IN ('D0010030','D0010010') THEN 'FALSE'
                            WHEN  AA.USR_DIV_CD IN ('D0010025') THEN 'TRUE'
                            WHEN  AA.USR_DIV_CD  IN  ('D0010090','D0010050')  THEN 'TRUE' 
                            ELSE 'FALSE' END)  
                        END) AS  AUTH_CHECK06 
                       , ('') AS AUTH_CHECK07      
                        , ('') AS AUTH_CHECK08 
                        , ('') AS AUTH_CHECK09 
                        , ('') AS AUTH_CHECK10           
            FROM   SYSM0100 AA ,
                ( SELECT
                          BB01.DPOB_CD
                        , BB00.SYS_DIV_CD 
                        , BB00.USR_ID 
                        ,  (CASE WHEN BB01.PAYR_MANG_DEPT_CD IS NULL THEN 
                                  (SELECT COUNT(TYP_OCCU_CD) FROM 
                                         (SELECT  DPOB_CD
                                                 ,USR_ID
                                                 ,TYP_OCCU_CD  
                                              FROM  SYSM0700
                                              GROUP BY DPOB_CD, USR_ID, TYP_OCCU_CD)  AA02
                                             WHERE AA02.DPOB_CD = #dpobCd#
                                               AND AA02.USR_ID = BB00.USR_ID
                                              ) 
                               ELSE  
                                 (SELECT COUNT(TYP_OCCU_CD) FROM 
                                       (SELECT DPOB_CD,  PAYR_MANG_DEPT_CD,
                                             TYP_OCCU_CD   
                                          FROM  BASS0360 
                                        GROUP BY  DPOB_CD,  PAYR_MANG_DEPT_CD,  TYP_OCCU_CD ) AA01
                                         WHERE AA01.DPOB_CD = #dpobCd#
                                           AND AA01.PAYR_MANG_DEPT_CD = BB01.PAYR_MANG_DEPT_CD
                                         )
                              END ) AS TYP_OCCU_CD_CNT 
                           , (CASE WHEN BB01.PAYR_MANG_DEPT_CD IS NULL THEN 
                                     (SELECT 
                                           COUNT(DTIL_OCCU_INTTN_CD)   FROM 
                                          ( SELECT DPOB_CD,  USR_ID,  TYP_OCCU_CD, DTIL_OCCU_INTTN_CD  
                                           FROM  SYSM0700
                                         GROUP BY  DPOB_CD,  USR_ID,  TYP_OCCU_CD, DTIL_OCCU_INTTN_CD) AA02
                                         WHERE AA02.DPOB_CD = #dpobCd#
                                           AND AA02.USR_ID = BB00.USR_ID
                                         )
                               ELSE  
                                      (SELECT 
                                           COUNT(DTIL_OCCU_INTTN_CD)   FROM 
                                          ( SELECT DPOB_CD,  PAYR_MANG_DEPT_CD,  TYP_OCCU_CD, DTIL_OCCU_INTTN_CD  
                                           FROM  BASS0360
                                         GROUP BY  DPOB_CD,  PAYR_MANG_DEPT_CD,  TYP_OCCU_CD, DTIL_OCCU_INTTN_CD) AA01
                                         WHERE AA01.DPOB_CD = #dpobCd#
                                           AND AA01.PAYR_MANG_DEPT_CD = BB01.PAYR_MANG_DEPT_CD  )
                              END ) AS DTIL_OCCU_CNT     
                       
                       FROM SYSM0100 BB00, BASS0150 BB01
                        WHERE BB01.DPOB_CD(+) = #dpobCd#
                          AND BB00.USR_ID  = BB01.PAY_MANGE_DEPT_WHLE_PERN_CHRG(+) 
                          AND BB00.USR_ID =  #usrId#  
                          AND BB00.SYS_DIV_CD=#sysDivCd#  ) BB
           WHERE AA.USR_ID=  BB.USR_ID
             AND AA.SYS_DIV_CD= BB.SYS_DIV_CD
             AND AA.USR_ID=#usrId#
             AND AA.SYS_DIV_CD=#sysDivCd#  
             AND AA.USE_YN = 'Y'   
					 
				]]>
	</select> 
	
	 	 
	 	 <!-- 계정신청 쿼리 -->
	<insert id="LoginServiceDAO.insertConfSysm0100_S">
		<![CDATA[
			INSERT INTO SYSM0100 
				(  SYS_DIV_CD
				  , USR_ID
				  , USR_NM
				  , USR_DIV_CD
				  , SYSTEMKEY
				  , DEPT_CD
				  , TYP_OCCU_CD 
				  , PYSP_GRDE_CD
				  , USR_TEL
				  , EMAIL
				  , PWD
				  , USE_YN
				  , USR_AUTH_EEPN_YN
				    , PYSP_INSN_YN
				    , NOT_PYSP_INSN_YN
				    , SERVC_INPT_PRCS_YN
				    , YRTX_INPT_PRCS_YN
				    , SHTTM_INSN_YN
				    , USR_AUTH_DIV_CD
				  , KYBDR
				  , INPT_DT
				  , INPT_ADDR
				  , ISMT
				  , REVN_DT
				  , REVN_ADDR
				  , PWD_DATE
				   )
			VALUES ( #sysDivCd#
				  , #usrId#
				  , #usrNm#
				  , #usrDivCd#
				  , #systemkey#
				  , #deptCd#
				  , #typOccuCd# 
				  , #pyspGrdeCd#
				  , #usrTel#
				  , #email#
				  , #pwd#
				  , #useYn#
				  , #usrAuthEepnYn#
				    , #pyspInsnYn#
				    , #notPyspInsnYn#
				    , #servcInptPrcsYn#
				    , #yrtxInptPrcsYn#
				    , #shttmInsnYn#
				    , #usrAuthDivCd#
				  , #kybdr#
				  ,  SYSDATE 
				  , #inptAddr#
				  , #ismt#
				  , SYSDATE
				  , #revnAddr#
				  , #pwddate#
				   )
		]]>
	</insert> 
	
	<!-- 패스워드 변경을 위한 처리 로직  -->
	<update id="LoginServiceDAO.updatePwdSysm0100_S">
	<![CDATA[
		UPDATE SYSM0100
		SET SYS_DIV_CD = #sysDivCd#,
			USR_ID = #usrId#,
			USR_NM = #usrNm#,
			USR_DIV_CD = #usrDivCd#,
			SYSTEMKEY = #systemkey#,
			DEPT_CD = #deptCd#,
			TYP_OCCU_CD = #typOccuCd#,
			PYSP_GRDE_CD = #pyspGrdeCd#,
			USR_TEL = #usrTel#,
			EMAIL = #email#,
			PWD = #pwd#,
			USE_YN = #useYn#,
			USR_AUTH_EEPN_YN = #usrAuthEepnYn#,
			PYSP_INSN_YN = #pyspInsnYn#,
			NOT_PYSP_INSN_YN = #notPyspInsnYn#,
			SERVC_INPT_PRCS_YN = #servcInptPrcsYn#,
			YRTX_INPT_PRCS_YN = #yrtxInptPrcsYn#,
			SHTTM_INSN_YN = #shttmInsnYn#,
			USR_AUTH_DIV_CD = #usrAuthDivCd#,
			ISMT = #ismt#,
			REVN_DT = SYSDATE,
			REVN_ADDR = #revnAddr#,
			PWD_DATE = #pwddate#,  								
			INPT_DT= (SELECT INPT_DT FROM SYSM0100 WHERE SYS_DIV_CD = #sysDivCd# AND USR_ID = #usrId#)					
		WHERE SYS_DIV_CD = #sysDivCd#
			AND USR_ID = #usrId#
	]]>
</update>
	
	<!-- 로그인 실패횟수 업데이트 기능 추가_hieju_06.13 -->
	<update id="LoginServiceDAO.updateLoginCount">
	<![CDATA[
		UPDATE SYSM0100
		SET
		LOGIN_CNT = #logincnt#
		WHERE USR_ID = #usrId#
		]]>
	</update>
	
	<!-- 계정차단 쿼리_hieju_06.13_추가수정_sys_23.09.10 -->
	<update id="LoginServiceDAO.updateLoginLock">	
	<![CDATA[
		UPDATE SYSM0100
		SET
		LOCKAT = #lockat#,
		PWD = #pwd#
		WHERE USR_ID = #usrId#
		]]>
	</update>
	
	<!-- 임시로직  -->
	<update id="LoginServiceDAO.updateSysm040001_S">
		<![CDATA[
			 UPDATE BASS0400
				SET DEPT_CD              = '000000000', 
				    TPLVL_DEPT_CD        = '000000000' 
				WHERE DEPT_CD            = '641000000'  
				]]>
	</update>  
	<!-- 임시로직  -->
	<update id="LoginServiceDAO.updateSysm040002_S">
		<![CDATA[ 
				UPDATE BASS0400
				SET HHRK_DEPT_CD   =  '000000000' 
				WHERE HHRK_DEPT_CD  = '641000000' 
				]]>
	</update> 
</sqlMap>
